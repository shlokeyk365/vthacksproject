var mye=Object.defineProperty;var h$=e=>{throw TypeError(e)};var gye=(e,t,n)=>t in e?mye(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ni=(e,t,n)=>gye(e,typeof t!="symbol"?t+"":t,n),GM=(e,t,n)=>t.has(e)||h$("Cannot "+n);var Ft=(e,t,n)=>(GM(e,t,"read from private field"),n?n.call(e):t.get(e)),Mi=(e,t,n)=>t.has(e)?h$("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Yr=(e,t,n,r)=>(GM(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),Ts=(e,t,n)=>(GM(e,t,"access private method"),n);var SC=(e,t,n,r)=>({set _(a){Yr(e,t,a,n)},get _(){return Ft(e,t,r)}});function yye(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const l=Object.getOwnPropertyDescriptor(r,a);l&&Object.defineProperty(e,a,l.get?l:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const h of l.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();var vye=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ip(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var qY={exports:{}},h3={},GY={exports:{}},Gs={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m5=Symbol.for("react.element"),_ye=Symbol.for("react.portal"),xye=Symbol.for("react.fragment"),bye=Symbol.for("react.strict_mode"),wye=Symbol.for("react.profiler"),Sye=Symbol.for("react.provider"),Aye=Symbol.for("react.context"),Tye=Symbol.for("react.forward_ref"),Cye=Symbol.for("react.suspense"),Eye=Symbol.for("react.memo"),Pye=Symbol.for("react.lazy"),f$=Symbol.iterator;function kye(e){return e===null||typeof e!="object"?null:(e=f$&&e[f$]||e["@@iterator"],typeof e=="function"?e:null)}var HY={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},WY=Object.assign,ZY={};function xw(e,t,n){this.props=e,this.context=t,this.refs=ZY,this.updater=n||HY}xw.prototype.isReactComponent={};xw.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};xw.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function KY(){}KY.prototype=xw.prototype;function vO(e,t,n){this.props=e,this.context=t,this.refs=ZY,this.updater=n||HY}var _O=vO.prototype=new KY;_O.constructor=vO;WY(_O,xw.prototype);_O.isPureReactComponent=!0;var p$=Array.isArray,YY=Object.prototype.hasOwnProperty,xO={current:null},XY={key:!0,ref:!0,__self:!0,__source:!0};function JY(e,t,n){var r,a={},l=null,h=null;if(t!=null)for(r in t.ref!==void 0&&(h=t.ref),t.key!==void 0&&(l=""+t.key),t)YY.call(t,r)&&!XY.hasOwnProperty(r)&&(a[r]=t[r]);var i=arguments.length-2;if(i===1)a.children=n;else if(1<i){for(var y=Array(i),x=0;x<i;x++)y[x]=arguments[x+2];a.children=y}if(e&&e.defaultProps)for(r in i=e.defaultProps,i)a[r]===void 0&&(a[r]=i[r]);return{$$typeof:m5,type:e,key:l,ref:h,props:a,_owner:xO.current}}function Iye(e,t){return{$$typeof:m5,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function bO(e){return typeof e=="object"&&e!==null&&e.$$typeof===m5}function Nye(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var m$=/\/+/g;function HM(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Nye(""+e.key):t.toString(36)}function NE(e,t,n,r,a){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var h=!1;if(e===null)h=!0;else switch(l){case"string":case"number":h=!0;break;case"object":switch(e.$$typeof){case m5:case _ye:h=!0}}if(h)return h=e,a=a(h),e=r===""?"."+HM(h,0):r,p$(a)?(n="",e!=null&&(n=e.replace(m$,"$&/")+"/"),NE(a,t,n,"",function(x){return x})):a!=null&&(bO(a)&&(a=Iye(a,n+(!a.key||h&&h.key===a.key?"":(""+a.key).replace(m$,"$&/")+"/")+e)),t.push(a)),1;if(h=0,r=r===""?".":r+":",p$(e))for(var i=0;i<e.length;i++){l=e[i];var y=r+HM(l,i);h+=NE(l,t,n,y,a)}else if(y=kye(e),typeof y=="function")for(e=y.call(e),i=0;!(l=e.next()).done;)l=l.value,y=r+HM(l,i++),h+=NE(l,t,n,y,a);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return h}function AC(e,t,n){if(e==null)return e;var r=[],a=0;return NE(e,r,"","",function(l){return t.call(n,l,a++)}),r}function Mye(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var cd={current:null},ME={transition:null},Lye={ReactCurrentDispatcher:cd,ReactCurrentBatchConfig:ME,ReactCurrentOwner:xO};function QY(){throw Error("act(...) is not supported in production builds of React.")}Gs.Children={map:AC,forEach:function(e,t,n){AC(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return AC(e,function(){t++}),t},toArray:function(e){return AC(e,function(t){return t})||[]},only:function(e){if(!bO(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Gs.Component=xw;Gs.Fragment=xye;Gs.Profiler=wye;Gs.PureComponent=vO;Gs.StrictMode=bye;Gs.Suspense=Cye;Gs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Lye;Gs.act=QY;Gs.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=WY({},e.props),a=e.key,l=e.ref,h=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,h=xO.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var i=e.type.defaultProps;for(y in t)YY.call(t,y)&&!XY.hasOwnProperty(y)&&(r[y]=t[y]===void 0&&i!==void 0?i[y]:t[y])}var y=arguments.length-2;if(y===1)r.children=n;else if(1<y){i=Array(y);for(var x=0;x<y;x++)i[x]=arguments[x+2];r.children=i}return{$$typeof:m5,type:e.type,key:a,ref:l,props:r,_owner:h}};Gs.createContext=function(e){return e={$$typeof:Aye,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Sye,_context:e},e.Consumer=e};Gs.createElement=JY;Gs.createFactory=function(e){var t=JY.bind(null,e);return t.type=e,t};Gs.createRef=function(){return{current:null}};Gs.forwardRef=function(e){return{$$typeof:Tye,render:e}};Gs.isValidElement=bO;Gs.lazy=function(e){return{$$typeof:Pye,_payload:{_status:-1,_result:e},_init:Mye}};Gs.memo=function(e,t){return{$$typeof:Eye,type:e,compare:t===void 0?null:t}};Gs.startTransition=function(e){var t=ME.transition;ME.transition={};try{e()}finally{ME.transition=t}};Gs.unstable_act=QY;Gs.useCallback=function(e,t){return cd.current.useCallback(e,t)};Gs.useContext=function(e){return cd.current.useContext(e)};Gs.useDebugValue=function(){};Gs.useDeferredValue=function(e){return cd.current.useDeferredValue(e)};Gs.useEffect=function(e,t){return cd.current.useEffect(e,t)};Gs.useId=function(){return cd.current.useId()};Gs.useImperativeHandle=function(e,t,n){return cd.current.useImperativeHandle(e,t,n)};Gs.useInsertionEffect=function(e,t){return cd.current.useInsertionEffect(e,t)};Gs.useLayoutEffect=function(e,t){return cd.current.useLayoutEffect(e,t)};Gs.useMemo=function(e,t){return cd.current.useMemo(e,t)};Gs.useReducer=function(e,t,n){return cd.current.useReducer(e,t,n)};Gs.useRef=function(e){return cd.current.useRef(e)};Gs.useState=function(e){return cd.current.useState(e)};Gs.useSyncExternalStore=function(e,t,n){return cd.current.useSyncExternalStore(e,t,n)};Gs.useTransition=function(){return cd.current.useTransition()};Gs.version="18.3.1";GY.exports=Gs;var L=GY.exports;const ir=Ip(L),f3=yye({__proto__:null,default:ir},[L]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dye=L,Rye=Symbol.for("react.element"),jye=Symbol.for("react.fragment"),Oye=Object.prototype.hasOwnProperty,Fye=Dye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zye={key:!0,ref:!0,__self:!0,__source:!0};function eX(e,t,n){var r,a={},l=null,h=null;n!==void 0&&(l=""+n),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(h=t.ref);for(r in t)Oye.call(t,r)&&!zye.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:Rye,type:e,key:l,ref:h,props:a,_owner:Fye.current}}h3.Fragment=jye;h3.jsx=eX;h3.jsxs=eX;qY.exports=h3;var v=qY.exports,tX={exports:{}},Nh={},nX={exports:{}},rX={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(je,De){var Ct=je.length;je.push(De);e:for(;0<Ct;){var xt=Ct-1>>>1,me=je[xt];if(0<a(me,De))je[xt]=De,je[Ct]=me,Ct=xt;else break e}}function n(je){return je.length===0?null:je[0]}function r(je){if(je.length===0)return null;var De=je[0],Ct=je.pop();if(Ct!==De){je[0]=Ct;e:for(var xt=0,me=je.length,Ye=me>>>1;xt<Ye;){var nt=2*(xt+1)-1,vt=je[nt],gt=nt+1,dt=je[gt];if(0>a(vt,Ct))gt<me&&0>a(dt,vt)?(je[xt]=dt,je[gt]=Ct,xt=gt):(je[xt]=vt,je[nt]=Ct,xt=nt);else if(gt<me&&0>a(dt,Ct))je[xt]=dt,je[gt]=Ct,xt=gt;else break e}}return De}function a(je,De){var Ct=je.sortIndex-De.sortIndex;return Ct!==0?Ct:je.id-De.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var h=Date,i=h.now();e.unstable_now=function(){return h.now()-i}}var y=[],x=[],w=1,C=null,P=3,E=!1,j=!1,D=!1,B=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,$=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function H(je){for(var De=n(x);De!==null;){if(De.callback===null)r(x);else if(De.startTime<=je)r(x),De.sortIndex=De.expirationTime,t(y,De);else break;De=n(x)}}function J(je){if(D=!1,H(je),!j)if(n(y)!==null)j=!0,Qe(ee);else{var De=n(x);De!==null&&et(J,De.startTime-je)}}function ee(je,De){j=!1,D&&(D=!1,F(pe),pe=-1),E=!0;var Ct=P;try{for(H(De),C=n(y);C!==null&&(!(C.expirationTime>De)||je&&!fe());){var xt=C.callback;if(typeof xt=="function"){C.callback=null,P=C.priorityLevel;var me=xt(C.expirationTime<=De);De=e.unstable_now(),typeof me=="function"?C.callback=me:C===n(y)&&r(y),H(De)}else r(y);C=n(y)}if(C!==null)var Ye=!0;else{var nt=n(x);nt!==null&&et(J,nt.startTime-De),Ye=!1}return Ye}finally{C=null,P=Ct,E=!1}}var Q=!1,ne=null,pe=-1,he=5,we=-1;function fe(){return!(e.unstable_now()-we<he)}function ge(){if(ne!==null){var je=e.unstable_now();we=je;var De=!0;try{De=ne(!0,je)}finally{De?Ce():(Q=!1,ne=null)}}else Q=!1}var Ce;if(typeof $=="function")Ce=function(){$(ge)};else if(typeof MessageChannel<"u"){var xe=new MessageChannel,Re=xe.port2;xe.port1.onmessage=ge,Ce=function(){Re.postMessage(null)}}else Ce=function(){B(ge,0)};function Qe(je){ne=je,Q||(Q=!0,Ce())}function et(je,De){pe=B(function(){je(e.unstable_now())},De)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(je){je.callback=null},e.unstable_continueExecution=function(){j||E||(j=!0,Qe(ee))},e.unstable_forceFrameRate=function(je){0>je||125<je?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):he=0<je?Math.floor(1e3/je):5},e.unstable_getCurrentPriorityLevel=function(){return P},e.unstable_getFirstCallbackNode=function(){return n(y)},e.unstable_next=function(je){switch(P){case 1:case 2:case 3:var De=3;break;default:De=P}var Ct=P;P=De;try{return je()}finally{P=Ct}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(je,De){switch(je){case 1:case 2:case 3:case 4:case 5:break;default:je=3}var Ct=P;P=je;try{return De()}finally{P=Ct}},e.unstable_scheduleCallback=function(je,De,Ct){var xt=e.unstable_now();switch(typeof Ct=="object"&&Ct!==null?(Ct=Ct.delay,Ct=typeof Ct=="number"&&0<Ct?xt+Ct:xt):Ct=xt,je){case 1:var me=-1;break;case 2:me=250;break;case 5:me=1073741823;break;case 4:me=1e4;break;default:me=5e3}return me=Ct+me,je={id:w++,callback:De,priorityLevel:je,startTime:Ct,expirationTime:me,sortIndex:-1},Ct>xt?(je.sortIndex=Ct,t(x,je),n(y)===null&&je===n(x)&&(D?(F(pe),pe=-1):D=!0,et(J,Ct-xt))):(je.sortIndex=me,t(y,je),j||E||(j=!0,Qe(ee))),je},e.unstable_shouldYield=fe,e.unstable_wrapCallback=function(je){var De=P;return function(){var Ct=P;P=De;try{return je.apply(this,arguments)}finally{P=Ct}}}})(rX);nX.exports=rX;var Bye=nX.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uye=L,Ph=Bye;function cr(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var iX=new Set,cA={};function Ex(e,t){Vb(e,t),Vb(e+"Capture",t)}function Vb(e,t){for(cA[e]=t,e=0;e<t.length;e++)iX.add(t[e])}var Jg=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nD=Object.prototype.hasOwnProperty,Vye=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g$={},y$={};function $ye(e){return nD.call(y$,e)?!0:nD.call(g$,e)?!1:Vye.test(e)?y$[e]=!0:(g$[e]=!0,!1)}function qye(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Gye(e,t,n,r){if(t===null||typeof t>"u"||qye(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ud(e,t,n,r,a,l,h){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=h}var Zc={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Zc[e]=new ud(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Zc[t]=new ud(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Zc[e]=new ud(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Zc[e]=new ud(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Zc[e]=new ud(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Zc[e]=new ud(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Zc[e]=new ud(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Zc[e]=new ud(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Zc[e]=new ud(e,5,!1,e.toLowerCase(),null,!1,!1)});var wO=/[\-:]([a-z])/g;function SO(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(wO,SO);Zc[t]=new ud(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(wO,SO);Zc[t]=new ud(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(wO,SO);Zc[t]=new ud(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Zc[e]=new ud(e,1,!1,e.toLowerCase(),null,!1,!1)});Zc.xlinkHref=new ud("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Zc[e]=new ud(e,1,!1,e.toLowerCase(),null,!0,!0)});function AO(e,t,n,r){var a=Zc.hasOwnProperty(t)?Zc[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Gye(t,n,a,r)&&(n=null),r||a===null?$ye(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,r=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var my=Uye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,TC=Symbol.for("react.element"),B1=Symbol.for("react.portal"),U1=Symbol.for("react.fragment"),TO=Symbol.for("react.strict_mode"),rD=Symbol.for("react.profiler"),sX=Symbol.for("react.provider"),aX=Symbol.for("react.context"),CO=Symbol.for("react.forward_ref"),iD=Symbol.for("react.suspense"),sD=Symbol.for("react.suspense_list"),EO=Symbol.for("react.memo"),y0=Symbol.for("react.lazy"),oX=Symbol.for("react.offscreen"),v$=Symbol.iterator;function J2(e){return e===null||typeof e!="object"?null:(e=v$&&e[v$]||e["@@iterator"],typeof e=="function"?e:null)}var Yo=Object.assign,WM;function AS(e){if(WM===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);WM=t&&t[1]||""}return`
`+WM+e}var ZM=!1;function KM(e,t){if(!e||ZM)return"";ZM=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(x){var r=x}Reflect.construct(e,[],t)}else{try{t.call()}catch(x){r=x}e.call(t.prototype)}else{try{throw Error()}catch(x){r=x}e()}}catch(x){if(x&&r&&typeof x.stack=="string"){for(var a=x.stack.split(`
`),l=r.stack.split(`
`),h=a.length-1,i=l.length-1;1<=h&&0<=i&&a[h]!==l[i];)i--;for(;1<=h&&0<=i;h--,i--)if(a[h]!==l[i]){if(h!==1||i!==1)do if(h--,i--,0>i||a[h]!==l[i]){var y=`
`+a[h].replace(" at new "," at ");return e.displayName&&y.includes("<anonymous>")&&(y=y.replace("<anonymous>",e.displayName)),y}while(1<=h&&0<=i);break}}}finally{ZM=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?AS(e):""}function Hye(e){switch(e.tag){case 5:return AS(e.type);case 16:return AS("Lazy");case 13:return AS("Suspense");case 19:return AS("SuspenseList");case 0:case 2:case 15:return e=KM(e.type,!1),e;case 11:return e=KM(e.type.render,!1),e;case 1:return e=KM(e.type,!0),e;default:return""}}function aD(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case U1:return"Fragment";case B1:return"Portal";case rD:return"Profiler";case TO:return"StrictMode";case iD:return"Suspense";case sD:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case aX:return(e.displayName||"Context")+".Consumer";case sX:return(e._context.displayName||"Context")+".Provider";case CO:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case EO:return t=e.displayName||null,t!==null?t:aD(e.type)||"Memo";case y0:t=e._payload,e=e._init;try{return aD(e(t))}catch{}}return null}function Wye(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return aD(t);case 8:return t===TO?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function av(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function lX(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Zye(e){var t=lX(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,l=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(h){r=""+h,l.call(this,h)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(h){r=""+h},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function CC(e){e._valueTracker||(e._valueTracker=Zye(e))}function cX(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=lX(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function pP(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function oD(e,t){var n=t.checked;return Yo({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function _$(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=av(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function uX(e,t){t=t.checked,t!=null&&AO(e,"checked",t,!1)}function lD(e,t){uX(e,t);var n=av(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?cD(e,t.type,n):t.hasOwnProperty("defaultValue")&&cD(e,t.type,av(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function x$(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function cD(e,t,n){(t!=="number"||pP(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var TS=Array.isArray;function lb(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+av(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function uD(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(cr(91));return Yo({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function b$(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(cr(92));if(TS(n)){if(1<n.length)throw Error(cr(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:av(n)}}function dX(e,t){var n=av(t.value),r=av(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function w$(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function hX(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dD(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?hX(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var EC,fX=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(EC=EC||document.createElement("div"),EC.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=EC.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function uA(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var zS={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Kye=["Webkit","ms","Moz","O"];Object.keys(zS).forEach(function(e){Kye.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),zS[t]=zS[e]})});function pX(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||zS.hasOwnProperty(e)&&zS[e]?(""+t).trim():t+"px"}function mX(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=pX(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}var Yye=Yo({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hD(e,t){if(t){if(Yye[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(cr(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(cr(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(cr(61))}if(t.style!=null&&typeof t.style!="object")throw Error(cr(62))}}function fD(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pD=null;function PO(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var mD=null,cb=null,ub=null;function S$(e){if(e=v5(e)){if(typeof mD!="function")throw Error(cr(280));var t=e.stateNode;t&&(t=v3(t),mD(e.stateNode,e.type,t))}}function gX(e){cb?ub?ub.push(e):ub=[e]:cb=e}function yX(){if(cb){var e=cb,t=ub;if(ub=cb=null,S$(e),t)for(e=0;e<t.length;e++)S$(t[e])}}function vX(e,t){return e(t)}function _X(){}var YM=!1;function xX(e,t,n){if(YM)return e(t,n);YM=!0;try{return vX(e,t,n)}finally{YM=!1,(cb!==null||ub!==null)&&(_X(),yX())}}function dA(e,t){var n=e.stateNode;if(n===null)return null;var r=v3(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(cr(231,t,typeof n));return n}var gD=!1;if(Jg)try{var Q2={};Object.defineProperty(Q2,"passive",{get:function(){gD=!0}}),window.addEventListener("test",Q2,Q2),window.removeEventListener("test",Q2,Q2)}catch{gD=!1}function Xye(e,t,n,r,a,l,h,i,y){var x=Array.prototype.slice.call(arguments,3);try{t.apply(n,x)}catch(w){this.onError(w)}}var BS=!1,mP=null,gP=!1,yD=null,Jye={onError:function(e){BS=!0,mP=e}};function Qye(e,t,n,r,a,l,h,i,y){BS=!1,mP=null,Xye.apply(Jye,arguments)}function e0e(e,t,n,r,a,l,h,i,y){if(Qye.apply(this,arguments),BS){if(BS){var x=mP;BS=!1,mP=null}else throw Error(cr(198));gP||(gP=!0,yD=x)}}function Px(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function bX(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function A$(e){if(Px(e)!==e)throw Error(cr(188))}function t0e(e){var t=e.alternate;if(!t){if(t=Px(e),t===null)throw Error(cr(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var l=a.alternate;if(l===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===l.child){for(l=a.child;l;){if(l===n)return A$(a),e;if(l===r)return A$(a),t;l=l.sibling}throw Error(cr(188))}if(n.return!==r.return)n=a,r=l;else{for(var h=!1,i=a.child;i;){if(i===n){h=!0,n=a,r=l;break}if(i===r){h=!0,r=a,n=l;break}i=i.sibling}if(!h){for(i=l.child;i;){if(i===n){h=!0,n=l,r=a;break}if(i===r){h=!0,r=l,n=a;break}i=i.sibling}if(!h)throw Error(cr(189))}}if(n.alternate!==r)throw Error(cr(190))}if(n.tag!==3)throw Error(cr(188));return n.stateNode.current===n?e:t}function wX(e){return e=t0e(e),e!==null?SX(e):null}function SX(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=SX(e);if(t!==null)return t;e=e.sibling}return null}var AX=Ph.unstable_scheduleCallback,T$=Ph.unstable_cancelCallback,n0e=Ph.unstable_shouldYield,r0e=Ph.unstable_requestPaint,vl=Ph.unstable_now,i0e=Ph.unstable_getCurrentPriorityLevel,kO=Ph.unstable_ImmediatePriority,TX=Ph.unstable_UserBlockingPriority,yP=Ph.unstable_NormalPriority,s0e=Ph.unstable_LowPriority,CX=Ph.unstable_IdlePriority,p3=null,Dm=null;function a0e(e){if(Dm&&typeof Dm.onCommitFiberRoot=="function")try{Dm.onCommitFiberRoot(p3,e,void 0,(e.current.flags&128)===128)}catch{}}var _p=Math.clz32?Math.clz32:c0e,o0e=Math.log,l0e=Math.LN2;function c0e(e){return e>>>=0,e===0?32:31-(o0e(e)/l0e|0)|0}var PC=64,kC=4194304;function CS(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function vP(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,a=e.suspendedLanes,l=e.pingedLanes,h=n&268435455;if(h!==0){var i=h&~a;i!==0?r=CS(i):(l&=h,l!==0&&(r=CS(l)))}else h=n&~a,h!==0?r=CS(h):l!==0&&(r=CS(l));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,l=t&-t,a>=l||a===16&&(l&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-_p(t),a=1<<n,r|=e[n],t&=~a;return r}function u0e(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function d0e(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,l=e.pendingLanes;0<l;){var h=31-_p(l),i=1<<h,y=a[h];y===-1?(!(i&n)||i&r)&&(a[h]=u0e(i,t)):y<=t&&(e.expiredLanes|=i),l&=~i}}function vD(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function EX(){var e=PC;return PC<<=1,!(PC&4194240)&&(PC=64),e}function XM(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function g5(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-_p(t),e[t]=n}function h0e(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-_p(n),l=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~l}}function IO(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-_p(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var Ra=0;function PX(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var kX,NO,IX,NX,MX,_D=!1,IC=[],q0=null,G0=null,H0=null,hA=new Map,fA=new Map,w0=[],f0e="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function C$(e,t){switch(e){case"focusin":case"focusout":q0=null;break;case"dragenter":case"dragleave":G0=null;break;case"mouseover":case"mouseout":H0=null;break;case"pointerover":case"pointerout":hA.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":fA.delete(t.pointerId)}}function eS(e,t,n,r,a,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:l,targetContainers:[a]},t!==null&&(t=v5(t),t!==null&&NO(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function p0e(e,t,n,r,a){switch(t){case"focusin":return q0=eS(q0,e,t,n,r,a),!0;case"dragenter":return G0=eS(G0,e,t,n,r,a),!0;case"mouseover":return H0=eS(H0,e,t,n,r,a),!0;case"pointerover":var l=a.pointerId;return hA.set(l,eS(hA.get(l)||null,e,t,n,r,a)),!0;case"gotpointercapture":return l=a.pointerId,fA.set(l,eS(fA.get(l)||null,e,t,n,r,a)),!0}return!1}function LX(e){var t=C_(e.target);if(t!==null){var n=Px(t);if(n!==null){if(t=n.tag,t===13){if(t=bX(n),t!==null){e.blockedOn=t,MX(e.priority,function(){IX(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function LE(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=xD(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);pD=r,n.target.dispatchEvent(r),pD=null}else return t=v5(n),t!==null&&NO(t),e.blockedOn=n,!1;t.shift()}return!0}function E$(e,t,n){LE(e)&&n.delete(t)}function m0e(){_D=!1,q0!==null&&LE(q0)&&(q0=null),G0!==null&&LE(G0)&&(G0=null),H0!==null&&LE(H0)&&(H0=null),hA.forEach(E$),fA.forEach(E$)}function tS(e,t){e.blockedOn===t&&(e.blockedOn=null,_D||(_D=!0,Ph.unstable_scheduleCallback(Ph.unstable_NormalPriority,m0e)))}function pA(e){function t(a){return tS(a,e)}if(0<IC.length){tS(IC[0],e);for(var n=1;n<IC.length;n++){var r=IC[n];r.blockedOn===e&&(r.blockedOn=null)}}for(q0!==null&&tS(q0,e),G0!==null&&tS(G0,e),H0!==null&&tS(H0,e),hA.forEach(t),fA.forEach(t),n=0;n<w0.length;n++)r=w0[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<w0.length&&(n=w0[0],n.blockedOn===null);)LX(n),n.blockedOn===null&&w0.shift()}var db=my.ReactCurrentBatchConfig,_P=!0;function g0e(e,t,n,r){var a=Ra,l=db.transition;db.transition=null;try{Ra=1,MO(e,t,n,r)}finally{Ra=a,db.transition=l}}function y0e(e,t,n,r){var a=Ra,l=db.transition;db.transition=null;try{Ra=4,MO(e,t,n,r)}finally{Ra=a,db.transition=l}}function MO(e,t,n,r){if(_P){var a=xD(e,t,n,r);if(a===null)oL(e,t,r,xP,n),C$(e,r);else if(p0e(a,e,t,n,r))r.stopPropagation();else if(C$(e,r),t&4&&-1<f0e.indexOf(e)){for(;a!==null;){var l=v5(a);if(l!==null&&kX(l),l=xD(e,t,n,r),l===null&&oL(e,t,r,xP,n),l===a)break;a=l}a!==null&&r.stopPropagation()}else oL(e,t,r,null,n)}}var xP=null;function xD(e,t,n,r){if(xP=null,e=PO(r),e=C_(e),e!==null)if(t=Px(e),t===null)e=null;else if(n=t.tag,n===13){if(e=bX(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return xP=e,null}function DX(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(i0e()){case kO:return 1;case TX:return 4;case yP:case s0e:return 16;case CX:return 536870912;default:return 16}default:return 16}}var F0=null,LO=null,DE=null;function RX(){if(DE)return DE;var e,t=LO,n=t.length,r,a="value"in F0?F0.value:F0.textContent,l=a.length;for(e=0;e<n&&t[e]===a[e];e++);var h=n-e;for(r=1;r<=h&&t[n-r]===a[l-r];r++);return DE=a.slice(e,1<r?1-r:void 0)}function RE(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function NC(){return!0}function P$(){return!1}function Mh(e){function t(n,r,a,l,h){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=l,this.target=h,this.currentTarget=null;for(var i in e)e.hasOwnProperty(i)&&(n=e[i],this[i]=n?n(l):l[i]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?NC:P$,this.isPropagationStopped=P$,this}return Yo(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=NC)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=NC)},persist:function(){},isPersistent:NC}),t}var bw={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},DO=Mh(bw),y5=Yo({},bw,{view:0,detail:0}),v0e=Mh(y5),JM,QM,nS,m3=Yo({},y5,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:RO,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==nS&&(nS&&e.type==="mousemove"?(JM=e.screenX-nS.screenX,QM=e.screenY-nS.screenY):QM=JM=0,nS=e),JM)},movementY:function(e){return"movementY"in e?e.movementY:QM}}),k$=Mh(m3),_0e=Yo({},m3,{dataTransfer:0}),x0e=Mh(_0e),b0e=Yo({},y5,{relatedTarget:0}),eL=Mh(b0e),w0e=Yo({},bw,{animationName:0,elapsedTime:0,pseudoElement:0}),S0e=Mh(w0e),A0e=Yo({},bw,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),T0e=Mh(A0e),C0e=Yo({},bw,{data:0}),I$=Mh(C0e),E0e={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},P0e={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},k0e={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function I0e(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=k0e[e])?!!t[e]:!1}function RO(){return I0e}var N0e=Yo({},y5,{key:function(e){if(e.key){var t=E0e[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=RE(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?P0e[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:RO,charCode:function(e){return e.type==="keypress"?RE(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?RE(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),M0e=Mh(N0e),L0e=Yo({},m3,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),N$=Mh(L0e),D0e=Yo({},y5,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:RO}),R0e=Mh(D0e),j0e=Yo({},bw,{propertyName:0,elapsedTime:0,pseudoElement:0}),O0e=Mh(j0e),F0e=Yo({},m3,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),z0e=Mh(F0e),B0e=[9,13,27,32],jO=Jg&&"CompositionEvent"in window,US=null;Jg&&"documentMode"in document&&(US=document.documentMode);var U0e=Jg&&"TextEvent"in window&&!US,jX=Jg&&(!jO||US&&8<US&&11>=US),M$=" ",L$=!1;function OX(e,t){switch(e){case"keyup":return B0e.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function FX(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var V1=!1;function V0e(e,t){switch(e){case"compositionend":return FX(t);case"keypress":return t.which!==32?null:(L$=!0,M$);case"textInput":return e=t.data,e===M$&&L$?null:e;default:return null}}function $0e(e,t){if(V1)return e==="compositionend"||!jO&&OX(e,t)?(e=RX(),DE=LO=F0=null,V1=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return jX&&t.locale!=="ko"?null:t.data;default:return null}}var q0e={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function D$(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!q0e[e.type]:t==="textarea"}function zX(e,t,n,r){gX(r),t=bP(t,"onChange"),0<t.length&&(n=new DO("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var VS=null,mA=null;function G0e(e){YX(e,0)}function g3(e){var t=G1(e);if(cX(t))return e}function H0e(e,t){if(e==="change")return t}var BX=!1;if(Jg){var tL;if(Jg){var nL="oninput"in document;if(!nL){var R$=document.createElement("div");R$.setAttribute("oninput","return;"),nL=typeof R$.oninput=="function"}tL=nL}else tL=!1;BX=tL&&(!document.documentMode||9<document.documentMode)}function j$(){VS&&(VS.detachEvent("onpropertychange",UX),mA=VS=null)}function UX(e){if(e.propertyName==="value"&&g3(mA)){var t=[];zX(t,mA,e,PO(e)),xX(G0e,t)}}function W0e(e,t,n){e==="focusin"?(j$(),VS=t,mA=n,VS.attachEvent("onpropertychange",UX)):e==="focusout"&&j$()}function Z0e(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return g3(mA)}function K0e(e,t){if(e==="click")return g3(t)}function Y0e(e,t){if(e==="input"||e==="change")return g3(t)}function X0e(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ap=typeof Object.is=="function"?Object.is:X0e;function gA(e,t){if(Ap(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!nD.call(t,a)||!Ap(e[a],t[a]))return!1}return!0}function O$(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function F$(e,t){var n=O$(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=O$(n)}}function VX(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?VX(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function $X(){for(var e=window,t=pP();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=pP(e.document)}return t}function OO(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function J0e(e){var t=$X(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&VX(n.ownerDocument.documentElement,n)){if(r!==null&&OO(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,l=Math.min(r.start,a);r=r.end===void 0?l:Math.min(r.end,a),!e.extend&&l>r&&(a=r,r=l,l=a),a=F$(n,l);var h=F$(n,r);a&&h&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==h.node||e.focusOffset!==h.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),l>r?(e.addRange(t),e.extend(h.node,h.offset)):(t.setEnd(h.node,h.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Q0e=Jg&&"documentMode"in document&&11>=document.documentMode,$1=null,bD=null,$S=null,wD=!1;function z$(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;wD||$1==null||$1!==pP(r)||(r=$1,"selectionStart"in r&&OO(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),$S&&gA($S,r)||($S=r,r=bP(bD,"onSelect"),0<r.length&&(t=new DO("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=$1)))}function MC(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var q1={animationend:MC("Animation","AnimationEnd"),animationiteration:MC("Animation","AnimationIteration"),animationstart:MC("Animation","AnimationStart"),transitionend:MC("Transition","TransitionEnd")},rL={},qX={};Jg&&(qX=document.createElement("div").style,"AnimationEvent"in window||(delete q1.animationend.animation,delete q1.animationiteration.animation,delete q1.animationstart.animation),"TransitionEvent"in window||delete q1.transitionend.transition);function y3(e){if(rL[e])return rL[e];if(!q1[e])return e;var t=q1[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in qX)return rL[e]=t[n];return e}var GX=y3("animationend"),HX=y3("animationiteration"),WX=y3("animationstart"),ZX=y3("transitionend"),KX=new Map,B$="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xv(e,t){KX.set(e,t),Ex(t,[e])}for(var iL=0;iL<B$.length;iL++){var sL=B$[iL],eve=sL.toLowerCase(),tve=sL[0].toUpperCase()+sL.slice(1);xv(eve,"on"+tve)}xv(GX,"onAnimationEnd");xv(HX,"onAnimationIteration");xv(WX,"onAnimationStart");xv("dblclick","onDoubleClick");xv("focusin","onFocus");xv("focusout","onBlur");xv(ZX,"onTransitionEnd");Vb("onMouseEnter",["mouseout","mouseover"]);Vb("onMouseLeave",["mouseout","mouseover"]);Vb("onPointerEnter",["pointerout","pointerover"]);Vb("onPointerLeave",["pointerout","pointerover"]);Ex("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ex("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ex("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ex("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ex("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ex("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ES="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nve=new Set("cancel close invalid load scroll toggle".split(" ").concat(ES));function U$(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,e0e(r,t,void 0,e),e.currentTarget=null}function YX(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var l=void 0;if(t)for(var h=r.length-1;0<=h;h--){var i=r[h],y=i.instance,x=i.currentTarget;if(i=i.listener,y!==l&&a.isPropagationStopped())break e;U$(a,i,x),l=y}else for(h=0;h<r.length;h++){if(i=r[h],y=i.instance,x=i.currentTarget,i=i.listener,y!==l&&a.isPropagationStopped())break e;U$(a,i,x),l=y}}}if(gP)throw e=yD,gP=!1,yD=null,e}function bo(e,t){var n=t[ED];n===void 0&&(n=t[ED]=new Set);var r=e+"__bubble";n.has(r)||(XX(t,e,2,!1),n.add(r))}function aL(e,t,n){var r=0;t&&(r|=4),XX(n,e,r,t)}var LC="_reactListening"+Math.random().toString(36).slice(2);function yA(e){if(!e[LC]){e[LC]=!0,iX.forEach(function(n){n!=="selectionchange"&&(nve.has(n)||aL(n,!1,e),aL(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[LC]||(t[LC]=!0,aL("selectionchange",!1,t))}}function XX(e,t,n,r){switch(DX(t)){case 1:var a=g0e;break;case 4:a=y0e;break;default:a=MO}n=a.bind(null,t,n,e),a=void 0,!gD||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function oL(e,t,n,r,a){var l=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var h=r.tag;if(h===3||h===4){var i=r.stateNode.containerInfo;if(i===a||i.nodeType===8&&i.parentNode===a)break;if(h===4)for(h=r.return;h!==null;){var y=h.tag;if((y===3||y===4)&&(y=h.stateNode.containerInfo,y===a||y.nodeType===8&&y.parentNode===a))return;h=h.return}for(;i!==null;){if(h=C_(i),h===null)return;if(y=h.tag,y===5||y===6){r=l=h;continue e}i=i.parentNode}}r=r.return}xX(function(){var x=l,w=PO(n),C=[];e:{var P=KX.get(e);if(P!==void 0){var E=DO,j=e;switch(e){case"keypress":if(RE(n)===0)break e;case"keydown":case"keyup":E=M0e;break;case"focusin":j="focus",E=eL;break;case"focusout":j="blur",E=eL;break;case"beforeblur":case"afterblur":E=eL;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=k$;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=x0e;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=R0e;break;case GX:case HX:case WX:E=S0e;break;case ZX:E=O0e;break;case"scroll":E=v0e;break;case"wheel":E=z0e;break;case"copy":case"cut":case"paste":E=T0e;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=N$}var D=(t&4)!==0,B=!D&&e==="scroll",F=D?P!==null?P+"Capture":null:P;D=[];for(var $=x,H;$!==null;){H=$;var J=H.stateNode;if(H.tag===5&&J!==null&&(H=J,F!==null&&(J=dA($,F),J!=null&&D.push(vA($,J,H)))),B)break;$=$.return}0<D.length&&(P=new E(P,j,null,n,w),C.push({event:P,listeners:D}))}}if(!(t&7)){e:{if(P=e==="mouseover"||e==="pointerover",E=e==="mouseout"||e==="pointerout",P&&n!==pD&&(j=n.relatedTarget||n.fromElement)&&(C_(j)||j[Qg]))break e;if((E||P)&&(P=w.window===w?w:(P=w.ownerDocument)?P.defaultView||P.parentWindow:window,E?(j=n.relatedTarget||n.toElement,E=x,j=j?C_(j):null,j!==null&&(B=Px(j),j!==B||j.tag!==5&&j.tag!==6)&&(j=null)):(E=null,j=x),E!==j)){if(D=k$,J="onMouseLeave",F="onMouseEnter",$="mouse",(e==="pointerout"||e==="pointerover")&&(D=N$,J="onPointerLeave",F="onPointerEnter",$="pointer"),B=E==null?P:G1(E),H=j==null?P:G1(j),P=new D(J,$+"leave",E,n,w),P.target=B,P.relatedTarget=H,J=null,C_(w)===x&&(D=new D(F,$+"enter",j,n,w),D.target=H,D.relatedTarget=B,J=D),B=J,E&&j)t:{for(D=E,F=j,$=0,H=D;H;H=A1(H))$++;for(H=0,J=F;J;J=A1(J))H++;for(;0<$-H;)D=A1(D),$--;for(;0<H-$;)F=A1(F),H--;for(;$--;){if(D===F||F!==null&&D===F.alternate)break t;D=A1(D),F=A1(F)}D=null}else D=null;E!==null&&V$(C,P,E,D,!1),j!==null&&B!==null&&V$(C,B,j,D,!0)}}e:{if(P=x?G1(x):window,E=P.nodeName&&P.nodeName.toLowerCase(),E==="select"||E==="input"&&P.type==="file")var ee=H0e;else if(D$(P))if(BX)ee=Y0e;else{ee=Z0e;var Q=W0e}else(E=P.nodeName)&&E.toLowerCase()==="input"&&(P.type==="checkbox"||P.type==="radio")&&(ee=K0e);if(ee&&(ee=ee(e,x))){zX(C,ee,n,w);break e}Q&&Q(e,P,x),e==="focusout"&&(Q=P._wrapperState)&&Q.controlled&&P.type==="number"&&cD(P,"number",P.value)}switch(Q=x?G1(x):window,e){case"focusin":(D$(Q)||Q.contentEditable==="true")&&($1=Q,bD=x,$S=null);break;case"focusout":$S=bD=$1=null;break;case"mousedown":wD=!0;break;case"contextmenu":case"mouseup":case"dragend":wD=!1,z$(C,n,w);break;case"selectionchange":if(Q0e)break;case"keydown":case"keyup":z$(C,n,w)}var ne;if(jO)e:{switch(e){case"compositionstart":var pe="onCompositionStart";break e;case"compositionend":pe="onCompositionEnd";break e;case"compositionupdate":pe="onCompositionUpdate";break e}pe=void 0}else V1?OX(e,n)&&(pe="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(pe="onCompositionStart");pe&&(jX&&n.locale!=="ko"&&(V1||pe!=="onCompositionStart"?pe==="onCompositionEnd"&&V1&&(ne=RX()):(F0=w,LO="value"in F0?F0.value:F0.textContent,V1=!0)),Q=bP(x,pe),0<Q.length&&(pe=new I$(pe,e,null,n,w),C.push({event:pe,listeners:Q}),ne?pe.data=ne:(ne=FX(n),ne!==null&&(pe.data=ne)))),(ne=U0e?V0e(e,n):$0e(e,n))&&(x=bP(x,"onBeforeInput"),0<x.length&&(w=new I$("onBeforeInput","beforeinput",null,n,w),C.push({event:w,listeners:x}),w.data=ne))}YX(C,t)})}function vA(e,t,n){return{instance:e,listener:t,currentTarget:n}}function bP(e,t){for(var n=t+"Capture",r=[];e!==null;){var a=e,l=a.stateNode;a.tag===5&&l!==null&&(a=l,l=dA(e,n),l!=null&&r.unshift(vA(e,l,a)),l=dA(e,t),l!=null&&r.push(vA(e,l,a))),e=e.return}return r}function A1(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function V$(e,t,n,r,a){for(var l=t._reactName,h=[];n!==null&&n!==r;){var i=n,y=i.alternate,x=i.stateNode;if(y!==null&&y===r)break;i.tag===5&&x!==null&&(i=x,a?(y=dA(n,l),y!=null&&h.unshift(vA(n,y,i))):a||(y=dA(n,l),y!=null&&h.push(vA(n,y,i)))),n=n.return}h.length!==0&&e.push({event:t,listeners:h})}var rve=/\r\n?/g,ive=/\u0000|\uFFFD/g;function $$(e){return(typeof e=="string"?e:""+e).replace(rve,`
`).replace(ive,"")}function DC(e,t,n){if(t=$$(t),$$(e)!==t&&n)throw Error(cr(425))}function wP(){}var SD=null,AD=null;function TD(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var CD=typeof setTimeout=="function"?setTimeout:void 0,sve=typeof clearTimeout=="function"?clearTimeout:void 0,q$=typeof Promise=="function"?Promise:void 0,ave=typeof queueMicrotask=="function"?queueMicrotask:typeof q$<"u"?function(e){return q$.resolve(null).then(e).catch(ove)}:CD;function ove(e){setTimeout(function(){throw e})}function lL(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){e.removeChild(a),pA(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);pA(t)}function W0(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function G$(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ww=Math.random().toString(36).slice(2),Sm="__reactFiber$"+ww,_A="__reactProps$"+ww,Qg="__reactContainer$"+ww,ED="__reactEvents$"+ww,lve="__reactListeners$"+ww,cve="__reactHandles$"+ww;function C_(e){var t=e[Sm];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Qg]||n[Sm]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=G$(e);e!==null;){if(n=e[Sm])return n;e=G$(e)}return t}e=n,n=e.parentNode}return null}function v5(e){return e=e[Sm]||e[Qg],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function G1(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(cr(33))}function v3(e){return e[_A]||null}var PD=[],H1=-1;function bv(e){return{current:e}}function To(e){0>H1||(e.current=PD[H1],PD[H1]=null,H1--)}function uo(e,t){H1++,PD[H1]=e.current,e.current=t}var ov={},Eu=bv(ov),qd=bv(!1),rx=ov;function $b(e,t){var n=e.type.contextTypes;if(!n)return ov;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},l;for(l in n)a[l]=t[l];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Gd(e){return e=e.childContextTypes,e!=null}function SP(){To(qd),To(Eu)}function H$(e,t,n){if(Eu.current!==ov)throw Error(cr(168));uo(Eu,t),uo(qd,n)}function JX(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error(cr(108,Wye(e)||"Unknown",a));return Yo({},n,r)}function AP(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ov,rx=Eu.current,uo(Eu,e),uo(qd,qd.current),!0}function W$(e,t,n){var r=e.stateNode;if(!r)throw Error(cr(169));n?(e=JX(e,t,rx),r.__reactInternalMemoizedMergedChildContext=e,To(qd),To(Eu),uo(Eu,e)):To(qd),uo(qd,n)}var Lg=null,_3=!1,cL=!1;function QX(e){Lg===null?Lg=[e]:Lg.push(e)}function uve(e){_3=!0,QX(e)}function wv(){if(!cL&&Lg!==null){cL=!0;var e=0,t=Ra;try{var n=Lg;for(Ra=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Lg=null,_3=!1}catch(a){throw Lg!==null&&(Lg=Lg.slice(e+1)),AX(kO,wv),a}finally{Ra=t,cL=!1}}return null}var W1=[],Z1=0,TP=null,CP=0,uf=[],df=0,ix=null,Bg=1,Ug="";function y_(e,t){W1[Z1++]=CP,W1[Z1++]=TP,TP=e,CP=t}function eJ(e,t,n){uf[df++]=Bg,uf[df++]=Ug,uf[df++]=ix,ix=e;var r=Bg;e=Ug;var a=32-_p(r)-1;r&=~(1<<a),n+=1;var l=32-_p(t)+a;if(30<l){var h=a-a%5;l=(r&(1<<h)-1).toString(32),r>>=h,a-=h,Bg=1<<32-_p(t)+a|n<<a|r,Ug=l+e}else Bg=1<<l|n<<a|r,Ug=e}function FO(e){e.return!==null&&(y_(e,1),eJ(e,1,0))}function zO(e){for(;e===TP;)TP=W1[--Z1],W1[Z1]=null,CP=W1[--Z1],W1[Z1]=null;for(;e===ix;)ix=uf[--df],uf[df]=null,Ug=uf[--df],uf[df]=null,Bg=uf[--df],uf[df]=null}var Th=null,wh=null,Fo=!1,pp=null;function tJ(e,t){var n=pf(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Z$(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Th=e,wh=W0(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Th=e,wh=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ix!==null?{id:Bg,overflow:Ug}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=pf(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Th=e,wh=null,!0):!1;default:return!1}}function kD(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ID(e){if(Fo){var t=wh;if(t){var n=t;if(!Z$(e,t)){if(kD(e))throw Error(cr(418));t=W0(n.nextSibling);var r=Th;t&&Z$(e,t)?tJ(r,n):(e.flags=e.flags&-4097|2,Fo=!1,Th=e)}}else{if(kD(e))throw Error(cr(418));e.flags=e.flags&-4097|2,Fo=!1,Th=e}}}function K$(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Th=e}function RC(e){if(e!==Th)return!1;if(!Fo)return K$(e),Fo=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!TD(e.type,e.memoizedProps)),t&&(t=wh)){if(kD(e))throw nJ(),Error(cr(418));for(;t;)tJ(e,t),t=W0(t.nextSibling)}if(K$(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(cr(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){wh=W0(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}wh=null}}else wh=Th?W0(e.stateNode.nextSibling):null;return!0}function nJ(){for(var e=wh;e;)e=W0(e.nextSibling)}function qb(){wh=Th=null,Fo=!1}function BO(e){pp===null?pp=[e]:pp.push(e)}var dve=my.ReactCurrentBatchConfig;function rS(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(cr(309));var r=n.stateNode}if(!r)throw Error(cr(147,e));var a=r,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(h){var i=a.refs;h===null?delete i[l]:i[l]=h},t._stringRef=l,t)}if(typeof e!="string")throw Error(cr(284));if(!n._owner)throw Error(cr(290,e))}return e}function jC(e,t){throw e=Object.prototype.toString.call(t),Error(cr(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Y$(e){var t=e._init;return t(e._payload)}function rJ(e){function t(F,$){if(e){var H=F.deletions;H===null?(F.deletions=[$],F.flags|=16):H.push($)}}function n(F,$){if(!e)return null;for(;$!==null;)t(F,$),$=$.sibling;return null}function r(F,$){for(F=new Map;$!==null;)$.key!==null?F.set($.key,$):F.set($.index,$),$=$.sibling;return F}function a(F,$){return F=X0(F,$),F.index=0,F.sibling=null,F}function l(F,$,H){return F.index=H,e?(H=F.alternate,H!==null?(H=H.index,H<$?(F.flags|=2,$):H):(F.flags|=2,$)):(F.flags|=1048576,$)}function h(F){return e&&F.alternate===null&&(F.flags|=2),F}function i(F,$,H,J){return $===null||$.tag!==6?($=gL(H,F.mode,J),$.return=F,$):($=a($,H),$.return=F,$)}function y(F,$,H,J){var ee=H.type;return ee===U1?w(F,$,H.props.children,J,H.key):$!==null&&($.elementType===ee||typeof ee=="object"&&ee!==null&&ee.$$typeof===y0&&Y$(ee)===$.type)?(J=a($,H.props),J.ref=rS(F,$,H),J.return=F,J):(J=VE(H.type,H.key,H.props,null,F.mode,J),J.ref=rS(F,$,H),J.return=F,J)}function x(F,$,H,J){return $===null||$.tag!==4||$.stateNode.containerInfo!==H.containerInfo||$.stateNode.implementation!==H.implementation?($=yL(H,F.mode,J),$.return=F,$):($=a($,H.children||[]),$.return=F,$)}function w(F,$,H,J,ee){return $===null||$.tag!==7?($=K_(H,F.mode,J,ee),$.return=F,$):($=a($,H),$.return=F,$)}function C(F,$,H){if(typeof $=="string"&&$!==""||typeof $=="number")return $=gL(""+$,F.mode,H),$.return=F,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case TC:return H=VE($.type,$.key,$.props,null,F.mode,H),H.ref=rS(F,null,$),H.return=F,H;case B1:return $=yL($,F.mode,H),$.return=F,$;case y0:var J=$._init;return C(F,J($._payload),H)}if(TS($)||J2($))return $=K_($,F.mode,H,null),$.return=F,$;jC(F,$)}return null}function P(F,$,H,J){var ee=$!==null?$.key:null;if(typeof H=="string"&&H!==""||typeof H=="number")return ee!==null?null:i(F,$,""+H,J);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case TC:return H.key===ee?y(F,$,H,J):null;case B1:return H.key===ee?x(F,$,H,J):null;case y0:return ee=H._init,P(F,$,ee(H._payload),J)}if(TS(H)||J2(H))return ee!==null?null:w(F,$,H,J,null);jC(F,H)}return null}function E(F,$,H,J,ee){if(typeof J=="string"&&J!==""||typeof J=="number")return F=F.get(H)||null,i($,F,""+J,ee);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case TC:return F=F.get(J.key===null?H:J.key)||null,y($,F,J,ee);case B1:return F=F.get(J.key===null?H:J.key)||null,x($,F,J,ee);case y0:var Q=J._init;return E(F,$,H,Q(J._payload),ee)}if(TS(J)||J2(J))return F=F.get(H)||null,w($,F,J,ee,null);jC($,J)}return null}function j(F,$,H,J){for(var ee=null,Q=null,ne=$,pe=$=0,he=null;ne!==null&&pe<H.length;pe++){ne.index>pe?(he=ne,ne=null):he=ne.sibling;var we=P(F,ne,H[pe],J);if(we===null){ne===null&&(ne=he);break}e&&ne&&we.alternate===null&&t(F,ne),$=l(we,$,pe),Q===null?ee=we:Q.sibling=we,Q=we,ne=he}if(pe===H.length)return n(F,ne),Fo&&y_(F,pe),ee;if(ne===null){for(;pe<H.length;pe++)ne=C(F,H[pe],J),ne!==null&&($=l(ne,$,pe),Q===null?ee=ne:Q.sibling=ne,Q=ne);return Fo&&y_(F,pe),ee}for(ne=r(F,ne);pe<H.length;pe++)he=E(ne,F,pe,H[pe],J),he!==null&&(e&&he.alternate!==null&&ne.delete(he.key===null?pe:he.key),$=l(he,$,pe),Q===null?ee=he:Q.sibling=he,Q=he);return e&&ne.forEach(function(fe){return t(F,fe)}),Fo&&y_(F,pe),ee}function D(F,$,H,J){var ee=J2(H);if(typeof ee!="function")throw Error(cr(150));if(H=ee.call(H),H==null)throw Error(cr(151));for(var Q=ee=null,ne=$,pe=$=0,he=null,we=H.next();ne!==null&&!we.done;pe++,we=H.next()){ne.index>pe?(he=ne,ne=null):he=ne.sibling;var fe=P(F,ne,we.value,J);if(fe===null){ne===null&&(ne=he);break}e&&ne&&fe.alternate===null&&t(F,ne),$=l(fe,$,pe),Q===null?ee=fe:Q.sibling=fe,Q=fe,ne=he}if(we.done)return n(F,ne),Fo&&y_(F,pe),ee;if(ne===null){for(;!we.done;pe++,we=H.next())we=C(F,we.value,J),we!==null&&($=l(we,$,pe),Q===null?ee=we:Q.sibling=we,Q=we);return Fo&&y_(F,pe),ee}for(ne=r(F,ne);!we.done;pe++,we=H.next())we=E(ne,F,pe,we.value,J),we!==null&&(e&&we.alternate!==null&&ne.delete(we.key===null?pe:we.key),$=l(we,$,pe),Q===null?ee=we:Q.sibling=we,Q=we);return e&&ne.forEach(function(ge){return t(F,ge)}),Fo&&y_(F,pe),ee}function B(F,$,H,J){if(typeof H=="object"&&H!==null&&H.type===U1&&H.key===null&&(H=H.props.children),typeof H=="object"&&H!==null){switch(H.$$typeof){case TC:e:{for(var ee=H.key,Q=$;Q!==null;){if(Q.key===ee){if(ee=H.type,ee===U1){if(Q.tag===7){n(F,Q.sibling),$=a(Q,H.props.children),$.return=F,F=$;break e}}else if(Q.elementType===ee||typeof ee=="object"&&ee!==null&&ee.$$typeof===y0&&Y$(ee)===Q.type){n(F,Q.sibling),$=a(Q,H.props),$.ref=rS(F,Q,H),$.return=F,F=$;break e}n(F,Q);break}else t(F,Q);Q=Q.sibling}H.type===U1?($=K_(H.props.children,F.mode,J,H.key),$.return=F,F=$):(J=VE(H.type,H.key,H.props,null,F.mode,J),J.ref=rS(F,$,H),J.return=F,F=J)}return h(F);case B1:e:{for(Q=H.key;$!==null;){if($.key===Q)if($.tag===4&&$.stateNode.containerInfo===H.containerInfo&&$.stateNode.implementation===H.implementation){n(F,$.sibling),$=a($,H.children||[]),$.return=F,F=$;break e}else{n(F,$);break}else t(F,$);$=$.sibling}$=yL(H,F.mode,J),$.return=F,F=$}return h(F);case y0:return Q=H._init,B(F,$,Q(H._payload),J)}if(TS(H))return j(F,$,H,J);if(J2(H))return D(F,$,H,J);jC(F,H)}return typeof H=="string"&&H!==""||typeof H=="number"?(H=""+H,$!==null&&$.tag===6?(n(F,$.sibling),$=a($,H),$.return=F,F=$):(n(F,$),$=gL(H,F.mode,J),$.return=F,F=$),h(F)):n(F,$)}return B}var Gb=rJ(!0),iJ=rJ(!1),EP=bv(null),PP=null,K1=null,UO=null;function VO(){UO=K1=PP=null}function $O(e){var t=EP.current;To(EP),e._currentValue=t}function ND(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function hb(e,t){PP=e,UO=K1=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Bd=!0),e.firstContext=null)}function xf(e){var t=e._currentValue;if(UO!==e)if(e={context:e,memoizedValue:t,next:null},K1===null){if(PP===null)throw Error(cr(308));K1=e,PP.dependencies={lanes:0,firstContext:e}}else K1=K1.next=e;return t}var E_=null;function qO(e){E_===null?E_=[e]:E_.push(e)}function sJ(e,t,n,r){var a=t.interleaved;return a===null?(n.next=n,qO(t)):(n.next=a.next,a.next=n),t.interleaved=n,ey(e,r)}function ey(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var v0=!1;function GO(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function aJ(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Hg(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Z0(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,ua&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,ey(e,n)}return a=r.interleaved,a===null?(t.next=t,qO(r)):(t.next=a.next,a.next=t),r.interleaved=t,ey(e,n)}function jE(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,IO(e,n)}}function X$(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var h={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?a=l=h:l=l.next=h,n=n.next}while(n!==null);l===null?a=l=t:l=l.next=t}else a=l=t;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function kP(e,t,n,r){var a=e.updateQueue;v0=!1;var l=a.firstBaseUpdate,h=a.lastBaseUpdate,i=a.shared.pending;if(i!==null){a.shared.pending=null;var y=i,x=y.next;y.next=null,h===null?l=x:h.next=x,h=y;var w=e.alternate;w!==null&&(w=w.updateQueue,i=w.lastBaseUpdate,i!==h&&(i===null?w.firstBaseUpdate=x:i.next=x,w.lastBaseUpdate=y))}if(l!==null){var C=a.baseState;h=0,w=x=y=null,i=l;do{var P=i.lane,E=i.eventTime;if((r&P)===P){w!==null&&(w=w.next={eventTime:E,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var j=e,D=i;switch(P=t,E=n,D.tag){case 1:if(j=D.payload,typeof j=="function"){C=j.call(E,C,P);break e}C=j;break e;case 3:j.flags=j.flags&-65537|128;case 0:if(j=D.payload,P=typeof j=="function"?j.call(E,C,P):j,P==null)break e;C=Yo({},C,P);break e;case 2:v0=!0}}i.callback!==null&&i.lane!==0&&(e.flags|=64,P=a.effects,P===null?a.effects=[i]:P.push(i))}else E={eventTime:E,lane:P,tag:i.tag,payload:i.payload,callback:i.callback,next:null},w===null?(x=w=E,y=C):w=w.next=E,h|=P;if(i=i.next,i===null){if(i=a.shared.pending,i===null)break;P=i,i=P.next,P.next=null,a.lastBaseUpdate=P,a.shared.pending=null}}while(!0);if(w===null&&(y=C),a.baseState=y,a.firstBaseUpdate=x,a.lastBaseUpdate=w,t=a.shared.interleaved,t!==null){a=t;do h|=a.lane,a=a.next;while(a!==t)}else l===null&&(a.shared.lanes=0);ax|=h,e.lanes=h,e.memoizedState=C}}function J$(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(cr(191,a));a.call(r)}}}var _5={},Rm=bv(_5),xA=bv(_5),bA=bv(_5);function P_(e){if(e===_5)throw Error(cr(174));return e}function HO(e,t){switch(uo(bA,t),uo(xA,e),uo(Rm,_5),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:dD(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=dD(t,e)}To(Rm),uo(Rm,t)}function Hb(){To(Rm),To(xA),To(bA)}function oJ(e){P_(bA.current);var t=P_(Rm.current),n=dD(t,e.type);t!==n&&(uo(xA,e),uo(Rm,n))}function WO(e){xA.current===e&&(To(Rm),To(xA))}var Wo=bv(0);function IP(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var uL=[];function ZO(){for(var e=0;e<uL.length;e++)uL[e]._workInProgressVersionPrimary=null;uL.length=0}var OE=my.ReactCurrentDispatcher,dL=my.ReactCurrentBatchConfig,sx=0,Ko=null,Yl=null,Tc=null,NP=!1,qS=!1,wA=0,hve=0;function pu(){throw Error(cr(321))}function KO(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ap(e[n],t[n]))return!1;return!0}function YO(e,t,n,r,a,l){if(sx=l,Ko=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,OE.current=e===null||e.memoizedState===null?gve:yve,e=n(r,a),qS){l=0;do{if(qS=!1,wA=0,25<=l)throw Error(cr(301));l+=1,Tc=Yl=null,t.updateQueue=null,OE.current=vve,e=n(r,a)}while(qS)}if(OE.current=MP,t=Yl!==null&&Yl.next!==null,sx=0,Tc=Yl=Ko=null,NP=!1,t)throw Error(cr(300));return e}function XO(){var e=wA!==0;return wA=0,e}function ym(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tc===null?Ko.memoizedState=Tc=e:Tc=Tc.next=e,Tc}function bf(){if(Yl===null){var e=Ko.alternate;e=e!==null?e.memoizedState:null}else e=Yl.next;var t=Tc===null?Ko.memoizedState:Tc.next;if(t!==null)Tc=t,Yl=e;else{if(e===null)throw Error(cr(310));Yl=e,e={memoizedState:Yl.memoizedState,baseState:Yl.baseState,baseQueue:Yl.baseQueue,queue:Yl.queue,next:null},Tc===null?Ko.memoizedState=Tc=e:Tc=Tc.next=e}return Tc}function SA(e,t){return typeof t=="function"?t(e):t}function hL(e){var t=bf(),n=t.queue;if(n===null)throw Error(cr(311));n.lastRenderedReducer=e;var r=Yl,a=r.baseQueue,l=n.pending;if(l!==null){if(a!==null){var h=a.next;a.next=l.next,l.next=h}r.baseQueue=a=l,n.pending=null}if(a!==null){l=a.next,r=r.baseState;var i=h=null,y=null,x=l;do{var w=x.lane;if((sx&w)===w)y!==null&&(y=y.next={lane:0,action:x.action,hasEagerState:x.hasEagerState,eagerState:x.eagerState,next:null}),r=x.hasEagerState?x.eagerState:e(r,x.action);else{var C={lane:w,action:x.action,hasEagerState:x.hasEagerState,eagerState:x.eagerState,next:null};y===null?(i=y=C,h=r):y=y.next=C,Ko.lanes|=w,ax|=w}x=x.next}while(x!==null&&x!==l);y===null?h=r:y.next=i,Ap(r,t.memoizedState)||(Bd=!0),t.memoizedState=r,t.baseState=h,t.baseQueue=y,n.lastRenderedState=r}if(e=n.interleaved,e!==null){a=e;do l=a.lane,Ko.lanes|=l,ax|=l,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function fL(e){var t=bf(),n=t.queue;if(n===null)throw Error(cr(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,l=t.memoizedState;if(a!==null){n.pending=null;var h=a=a.next;do l=e(l,h.action),h=h.next;while(h!==a);Ap(l,t.memoizedState)||(Bd=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),n.lastRenderedState=l}return[l,r]}function lJ(){}function cJ(e,t){var n=Ko,r=bf(),a=t(),l=!Ap(r.memoizedState,a);if(l&&(r.memoizedState=a,Bd=!0),r=r.queue,JO(hJ.bind(null,n,r,e),[e]),r.getSnapshot!==t||l||Tc!==null&&Tc.memoizedState.tag&1){if(n.flags|=2048,AA(9,dJ.bind(null,n,r,a,t),void 0,null),Pc===null)throw Error(cr(349));sx&30||uJ(n,t,a)}return a}function uJ(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ko.updateQueue,t===null?(t={lastEffect:null,stores:null},Ko.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function dJ(e,t,n,r){t.value=n,t.getSnapshot=r,fJ(t)&&pJ(e)}function hJ(e,t,n){return n(function(){fJ(t)&&pJ(e)})}function fJ(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ap(e,n)}catch{return!0}}function pJ(e){var t=ey(e,1);t!==null&&xp(t,e,1,-1)}function Q$(e){var t=ym();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:SA,lastRenderedState:e},t.queue=e,e=e.dispatch=mve.bind(null,Ko,e),[t.memoizedState,e]}function AA(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ko.updateQueue,t===null?(t={lastEffect:null,stores:null},Ko.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function mJ(){return bf().memoizedState}function FE(e,t,n,r){var a=ym();Ko.flags|=e,a.memoizedState=AA(1|t,n,void 0,r===void 0?null:r)}function x3(e,t,n,r){var a=bf();r=r===void 0?null:r;var l=void 0;if(Yl!==null){var h=Yl.memoizedState;if(l=h.destroy,r!==null&&KO(r,h.deps)){a.memoizedState=AA(t,n,l,r);return}}Ko.flags|=e,a.memoizedState=AA(1|t,n,l,r)}function e9(e,t){return FE(8390656,8,e,t)}function JO(e,t){return x3(2048,8,e,t)}function gJ(e,t){return x3(4,2,e,t)}function yJ(e,t){return x3(4,4,e,t)}function vJ(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function _J(e,t,n){return n=n!=null?n.concat([e]):null,x3(4,4,vJ.bind(null,t,e),n)}function QO(){}function xJ(e,t){var n=bf();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&KO(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function bJ(e,t){var n=bf();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&KO(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function wJ(e,t,n){return sx&21?(Ap(n,t)||(n=EX(),Ko.lanes|=n,ax|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Bd=!0),e.memoizedState=n)}function fve(e,t){var n=Ra;Ra=n!==0&&4>n?n:4,e(!0);var r=dL.transition;dL.transition={};try{e(!1),t()}finally{Ra=n,dL.transition=r}}function SJ(){return bf().memoizedState}function pve(e,t,n){var r=Y0(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},AJ(e))TJ(t,n);else if(n=sJ(e,t,n,r),n!==null){var a=ad();xp(n,e,r,a),CJ(n,t,r)}}function mve(e,t,n){var r=Y0(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(AJ(e))TJ(t,a);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var h=t.lastRenderedState,i=l(h,n);if(a.hasEagerState=!0,a.eagerState=i,Ap(i,h)){var y=t.interleaved;y===null?(a.next=a,qO(t)):(a.next=y.next,y.next=a),t.interleaved=a;return}}catch{}finally{}n=sJ(e,t,a,r),n!==null&&(a=ad(),xp(n,e,r,a),CJ(n,t,r))}}function AJ(e){var t=e.alternate;return e===Ko||t!==null&&t===Ko}function TJ(e,t){qS=NP=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function CJ(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,IO(e,n)}}var MP={readContext:xf,useCallback:pu,useContext:pu,useEffect:pu,useImperativeHandle:pu,useInsertionEffect:pu,useLayoutEffect:pu,useMemo:pu,useReducer:pu,useRef:pu,useState:pu,useDebugValue:pu,useDeferredValue:pu,useTransition:pu,useMutableSource:pu,useSyncExternalStore:pu,useId:pu,unstable_isNewReconciler:!1},gve={readContext:xf,useCallback:function(e,t){return ym().memoizedState=[e,t===void 0?null:t],e},useContext:xf,useEffect:e9,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,FE(4194308,4,vJ.bind(null,t,e),n)},useLayoutEffect:function(e,t){return FE(4194308,4,e,t)},useInsertionEffect:function(e,t){return FE(4,2,e,t)},useMemo:function(e,t){var n=ym();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ym();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=pve.bind(null,Ko,e),[r.memoizedState,e]},useRef:function(e){var t=ym();return e={current:e},t.memoizedState=e},useState:Q$,useDebugValue:QO,useDeferredValue:function(e){return ym().memoizedState=e},useTransition:function(){var e=Q$(!1),t=e[0];return e=fve.bind(null,e[1]),ym().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ko,a=ym();if(Fo){if(n===void 0)throw Error(cr(407));n=n()}else{if(n=t(),Pc===null)throw Error(cr(349));sx&30||uJ(r,t,n)}a.memoizedState=n;var l={value:n,getSnapshot:t};return a.queue=l,e9(hJ.bind(null,r,l,e),[e]),r.flags|=2048,AA(9,dJ.bind(null,r,l,n,t),void 0,null),n},useId:function(){var e=ym(),t=Pc.identifierPrefix;if(Fo){var n=Ug,r=Bg;n=(r&~(1<<32-_p(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=wA++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=hve++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},yve={readContext:xf,useCallback:xJ,useContext:xf,useEffect:JO,useImperativeHandle:_J,useInsertionEffect:gJ,useLayoutEffect:yJ,useMemo:bJ,useReducer:hL,useRef:mJ,useState:function(){return hL(SA)},useDebugValue:QO,useDeferredValue:function(e){var t=bf();return wJ(t,Yl.memoizedState,e)},useTransition:function(){var e=hL(SA)[0],t=bf().memoizedState;return[e,t]},useMutableSource:lJ,useSyncExternalStore:cJ,useId:SJ,unstable_isNewReconciler:!1},vve={readContext:xf,useCallback:xJ,useContext:xf,useEffect:JO,useImperativeHandle:_J,useInsertionEffect:gJ,useLayoutEffect:yJ,useMemo:bJ,useReducer:fL,useRef:mJ,useState:function(){return fL(SA)},useDebugValue:QO,useDeferredValue:function(e){var t=bf();return Yl===null?t.memoizedState=e:wJ(t,Yl.memoizedState,e)},useTransition:function(){var e=fL(SA)[0],t=bf().memoizedState;return[e,t]},useMutableSource:lJ,useSyncExternalStore:cJ,useId:SJ,unstable_isNewReconciler:!1};function up(e,t){if(e&&e.defaultProps){t=Yo({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function MD(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Yo({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var b3={isMounted:function(e){return(e=e._reactInternals)?Px(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ad(),a=Y0(e),l=Hg(r,a);l.payload=t,n!=null&&(l.callback=n),t=Z0(e,l,a),t!==null&&(xp(t,e,a,r),jE(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ad(),a=Y0(e),l=Hg(r,a);l.tag=1,l.payload=t,n!=null&&(l.callback=n),t=Z0(e,l,a),t!==null&&(xp(t,e,a,r),jE(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ad(),r=Y0(e),a=Hg(n,r);a.tag=2,t!=null&&(a.callback=t),t=Z0(e,a,r),t!==null&&(xp(t,e,r,n),jE(t,e,r))}};function t9(e,t,n,r,a,l,h){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,l,h):t.prototype&&t.prototype.isPureReactComponent?!gA(n,r)||!gA(a,l):!0}function EJ(e,t,n){var r=!1,a=ov,l=t.contextType;return typeof l=="object"&&l!==null?l=xf(l):(a=Gd(t)?rx:Eu.current,r=t.contextTypes,l=(r=r!=null)?$b(e,a):ov),t=new t(n,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=b3,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=l),t}function n9(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&b3.enqueueReplaceState(t,t.state,null)}function LD(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},GO(e);var l=t.contextType;typeof l=="object"&&l!==null?a.context=xf(l):(l=Gd(t)?rx:Eu.current,a.context=$b(e,l)),a.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(MD(e,t,l,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&b3.enqueueReplaceState(a,a.state,null),kP(e,n,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Wb(e,t){try{var n="",r=t;do n+=Hye(r),r=r.return;while(r);var a=n}catch(l){a=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:a,digest:null}}function pL(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function DD(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var _ve=typeof WeakMap=="function"?WeakMap:Map;function PJ(e,t,n){n=Hg(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){DP||(DP=!0,qD=r),DD(e,t)},n}function kJ(e,t,n){n=Hg(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){DD(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){DD(e,t),typeof r!="function"&&(K0===null?K0=new Set([this]):K0.add(this));var h=t.stack;this.componentDidCatch(t.value,{componentStack:h!==null?h:""})}),n}function r9(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new _ve;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Lve.bind(null,e,t,n),t.then(e,e))}function i9(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function s9(e,t,n,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Hg(-1,1),t.tag=2,Z0(n,t,1))),n.lanes|=1),e)}var xve=my.ReactCurrentOwner,Bd=!1;function Wu(e,t,n,r){t.child=e===null?iJ(t,null,n,r):Gb(t,e.child,n,r)}function a9(e,t,n,r,a){n=n.render;var l=t.ref;return hb(t,a),r=YO(e,t,n,r,l,a),n=XO(),e!==null&&!Bd?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ty(e,t,a)):(Fo&&n&&FO(t),t.flags|=1,Wu(e,t,r,a),t.child)}function o9(e,t,n,r,a){if(e===null){var l=n.type;return typeof l=="function"&&!oF(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=l,IJ(e,t,l,r,a)):(e=VE(n.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&a)){var h=l.memoizedProps;if(n=n.compare,n=n!==null?n:gA,n(h,r)&&e.ref===t.ref)return ty(e,t,a)}return t.flags|=1,e=X0(l,r),e.ref=t.ref,e.return=t,t.child=e}function IJ(e,t,n,r,a){if(e!==null){var l=e.memoizedProps;if(gA(l,r)&&e.ref===t.ref)if(Bd=!1,t.pendingProps=r=l,(e.lanes&a)!==0)e.flags&131072&&(Bd=!0);else return t.lanes=e.lanes,ty(e,t,a)}return RD(e,t,n,r,a)}function NJ(e,t,n){var r=t.pendingProps,a=r.children,l=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},uo(X1,mh),mh|=n;else{if(!(n&1073741824))return e=l!==null?l.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,uo(X1,mh),mh|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=l!==null?l.baseLanes:n,uo(X1,mh),mh|=r}else l!==null?(r=l.baseLanes|n,t.memoizedState=null):r=n,uo(X1,mh),mh|=r;return Wu(e,t,a,n),t.child}function MJ(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function RD(e,t,n,r,a){var l=Gd(n)?rx:Eu.current;return l=$b(t,l),hb(t,a),n=YO(e,t,n,r,l,a),r=XO(),e!==null&&!Bd?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ty(e,t,a)):(Fo&&r&&FO(t),t.flags|=1,Wu(e,t,n,a),t.child)}function l9(e,t,n,r,a){if(Gd(n)){var l=!0;AP(t)}else l=!1;if(hb(t,a),t.stateNode===null)zE(e,t),EJ(t,n,r),LD(t,n,r,a),r=!0;else if(e===null){var h=t.stateNode,i=t.memoizedProps;h.props=i;var y=h.context,x=n.contextType;typeof x=="object"&&x!==null?x=xf(x):(x=Gd(n)?rx:Eu.current,x=$b(t,x));var w=n.getDerivedStateFromProps,C=typeof w=="function"||typeof h.getSnapshotBeforeUpdate=="function";C||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(i!==r||y!==x)&&n9(t,h,r,x),v0=!1;var P=t.memoizedState;h.state=P,kP(t,r,h,a),y=t.memoizedState,i!==r||P!==y||qd.current||v0?(typeof w=="function"&&(MD(t,n,w,r),y=t.memoizedState),(i=v0||t9(t,n,i,r,P,y,x))?(C||typeof h.UNSAFE_componentWillMount!="function"&&typeof h.componentWillMount!="function"||(typeof h.componentWillMount=="function"&&h.componentWillMount(),typeof h.UNSAFE_componentWillMount=="function"&&h.UNSAFE_componentWillMount()),typeof h.componentDidMount=="function"&&(t.flags|=4194308)):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=y),h.props=r,h.state=y,h.context=x,r=i):(typeof h.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{h=t.stateNode,aJ(e,t),i=t.memoizedProps,x=t.type===t.elementType?i:up(t.type,i),h.props=x,C=t.pendingProps,P=h.context,y=n.contextType,typeof y=="object"&&y!==null?y=xf(y):(y=Gd(n)?rx:Eu.current,y=$b(t,y));var E=n.getDerivedStateFromProps;(w=typeof E=="function"||typeof h.getSnapshotBeforeUpdate=="function")||typeof h.UNSAFE_componentWillReceiveProps!="function"&&typeof h.componentWillReceiveProps!="function"||(i!==C||P!==y)&&n9(t,h,r,y),v0=!1,P=t.memoizedState,h.state=P,kP(t,r,h,a);var j=t.memoizedState;i!==C||P!==j||qd.current||v0?(typeof E=="function"&&(MD(t,n,E,r),j=t.memoizedState),(x=v0||t9(t,n,x,r,P,j,y)||!1)?(w||typeof h.UNSAFE_componentWillUpdate!="function"&&typeof h.componentWillUpdate!="function"||(typeof h.componentWillUpdate=="function"&&h.componentWillUpdate(r,j,y),typeof h.UNSAFE_componentWillUpdate=="function"&&h.UNSAFE_componentWillUpdate(r,j,y)),typeof h.componentDidUpdate=="function"&&(t.flags|=4),typeof h.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof h.componentDidUpdate!="function"||i===e.memoizedProps&&P===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&P===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=j),h.props=r,h.state=j,h.context=y,r=x):(typeof h.componentDidUpdate!="function"||i===e.memoizedProps&&P===e.memoizedState||(t.flags|=4),typeof h.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&P===e.memoizedState||(t.flags|=1024),r=!1)}return jD(e,t,n,r,l,a)}function jD(e,t,n,r,a,l){MJ(e,t);var h=(t.flags&128)!==0;if(!r&&!h)return a&&W$(t,n,!1),ty(e,t,l);r=t.stateNode,xve.current=t;var i=h&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&h?(t.child=Gb(t,e.child,null,l),t.child=Gb(t,null,i,l)):Wu(e,t,i,l),t.memoizedState=r.state,a&&W$(t,n,!0),t.child}function LJ(e){var t=e.stateNode;t.pendingContext?H$(e,t.pendingContext,t.pendingContext!==t.context):t.context&&H$(e,t.context,!1),HO(e,t.containerInfo)}function c9(e,t,n,r,a){return qb(),BO(a),t.flags|=256,Wu(e,t,n,r),t.child}var OD={dehydrated:null,treeContext:null,retryLane:0};function FD(e){return{baseLanes:e,cachePool:null,transitions:null}}function DJ(e,t,n){var r=t.pendingProps,a=Wo.current,l=!1,h=(t.flags&128)!==0,i;if((i=h)||(i=e!==null&&e.memoizedState===null?!1:(a&2)!==0),i?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),uo(Wo,a&1),e===null)return ID(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(h=r.children,e=r.fallback,l?(r=t.mode,l=t.child,h={mode:"hidden",children:h},!(r&1)&&l!==null?(l.childLanes=0,l.pendingProps=h):l=A3(h,r,0,null),e=K_(e,r,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=FD(n),t.memoizedState=OD,e):eF(t,h));if(a=e.memoizedState,a!==null&&(i=a.dehydrated,i!==null))return bve(e,t,h,r,i,a,n);if(l){l=r.fallback,h=t.mode,a=e.child,i=a.sibling;var y={mode:"hidden",children:r.children};return!(h&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=y,t.deletions=null):(r=X0(a,y),r.subtreeFlags=a.subtreeFlags&14680064),i!==null?l=X0(i,l):(l=K_(l,h,n,null),l.flags|=2),l.return=t,r.return=t,r.sibling=l,t.child=r,r=l,l=t.child,h=e.child.memoizedState,h=h===null?FD(n):{baseLanes:h.baseLanes|n,cachePool:null,transitions:h.transitions},l.memoizedState=h,l.childLanes=e.childLanes&~n,t.memoizedState=OD,r}return l=e.child,e=l.sibling,r=X0(l,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function eF(e,t){return t=A3({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function OC(e,t,n,r){return r!==null&&BO(r),Gb(t,e.child,null,n),e=eF(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function bve(e,t,n,r,a,l,h){if(n)return t.flags&256?(t.flags&=-257,r=pL(Error(cr(422))),OC(e,t,h,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=r.fallback,a=t.mode,r=A3({mode:"visible",children:r.children},a,0,null),l=K_(l,a,h,null),l.flags|=2,r.return=t,l.return=t,r.sibling=l,t.child=r,t.mode&1&&Gb(t,e.child,null,h),t.child.memoizedState=FD(h),t.memoizedState=OD,l);if(!(t.mode&1))return OC(e,t,h,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var i=r.dgst;return r=i,l=Error(cr(419)),r=pL(l,r,void 0),OC(e,t,h,r)}if(i=(h&e.childLanes)!==0,Bd||i){if(r=Pc,r!==null){switch(h&-h){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|h)?0:a,a!==0&&a!==l.retryLane&&(l.retryLane=a,ey(e,a),xp(r,e,a,-1))}return aF(),r=pL(Error(cr(421))),OC(e,t,h,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Dve.bind(null,e),a._reactRetry=t,null):(e=l.treeContext,wh=W0(a.nextSibling),Th=t,Fo=!0,pp=null,e!==null&&(uf[df++]=Bg,uf[df++]=Ug,uf[df++]=ix,Bg=e.id,Ug=e.overflow,ix=t),t=eF(t,r.children),t.flags|=4096,t)}function u9(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),ND(e.return,t,n)}function mL(e,t,n,r,a){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=r,l.tail=n,l.tailMode=a)}function RJ(e,t,n){var r=t.pendingProps,a=r.revealOrder,l=r.tail;if(Wu(e,t,r.children,n),r=Wo.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&u9(e,n,t);else if(e.tag===19)u9(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(uo(Wo,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&IP(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),mL(t,!1,a,n,l);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&IP(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}mL(t,!0,n,null,l);break;case"together":mL(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function zE(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ty(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ax|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(cr(153));if(t.child!==null){for(e=t.child,n=X0(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=X0(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function wve(e,t,n){switch(t.tag){case 3:LJ(t),qb();break;case 5:oJ(t);break;case 1:Gd(t.type)&&AP(t);break;case 4:HO(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;uo(EP,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(uo(Wo,Wo.current&1),t.flags|=128,null):n&t.child.childLanes?DJ(e,t,n):(uo(Wo,Wo.current&1),e=ty(e,t,n),e!==null?e.sibling:null);uo(Wo,Wo.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return RJ(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),uo(Wo,Wo.current),r)break;return null;case 22:case 23:return t.lanes=0,NJ(e,t,n)}return ty(e,t,n)}var jJ,zD,OJ,FJ;jJ=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};zD=function(){};OJ=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,P_(Rm.current);var l=null;switch(n){case"input":a=oD(e,a),r=oD(e,r),l=[];break;case"select":a=Yo({},a,{value:void 0}),r=Yo({},r,{value:void 0}),l=[];break;case"textarea":a=uD(e,a),r=uD(e,r),l=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=wP)}hD(n,r);var h;n=null;for(x in a)if(!r.hasOwnProperty(x)&&a.hasOwnProperty(x)&&a[x]!=null)if(x==="style"){var i=a[x];for(h in i)i.hasOwnProperty(h)&&(n||(n={}),n[h]="")}else x!=="dangerouslySetInnerHTML"&&x!=="children"&&x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(cA.hasOwnProperty(x)?l||(l=[]):(l=l||[]).push(x,null));for(x in r){var y=r[x];if(i=a!=null?a[x]:void 0,r.hasOwnProperty(x)&&y!==i&&(y!=null||i!=null))if(x==="style")if(i){for(h in i)!i.hasOwnProperty(h)||y&&y.hasOwnProperty(h)||(n||(n={}),n[h]="");for(h in y)y.hasOwnProperty(h)&&i[h]!==y[h]&&(n||(n={}),n[h]=y[h])}else n||(l||(l=[]),l.push(x,n)),n=y;else x==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,i=i?i.__html:void 0,y!=null&&i!==y&&(l=l||[]).push(x,y)):x==="children"?typeof y!="string"&&typeof y!="number"||(l=l||[]).push(x,""+y):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&(cA.hasOwnProperty(x)?(y!=null&&x==="onScroll"&&bo("scroll",e),l||i===y||(l=[])):(l=l||[]).push(x,y))}n&&(l=l||[]).push("style",n);var x=l;(t.updateQueue=x)&&(t.flags|=4)}};FJ=function(e,t,n,r){n!==r&&(t.flags|=4)};function iS(e,t){if(!Fo)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function mu(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Sve(e,t,n){var r=t.pendingProps;switch(zO(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mu(t),null;case 1:return Gd(t.type)&&SP(),mu(t),null;case 3:return r=t.stateNode,Hb(),To(qd),To(Eu),ZO(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(RC(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,pp!==null&&(WD(pp),pp=null))),zD(e,t),mu(t),null;case 5:WO(t);var a=P_(bA.current);if(n=t.type,e!==null&&t.stateNode!=null)OJ(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(cr(166));return mu(t),null}if(e=P_(Rm.current),RC(t)){r=t.stateNode,n=t.type;var l=t.memoizedProps;switch(r[Sm]=t,r[_A]=l,e=(t.mode&1)!==0,n){case"dialog":bo("cancel",r),bo("close",r);break;case"iframe":case"object":case"embed":bo("load",r);break;case"video":case"audio":for(a=0;a<ES.length;a++)bo(ES[a],r);break;case"source":bo("error",r);break;case"img":case"image":case"link":bo("error",r),bo("load",r);break;case"details":bo("toggle",r);break;case"input":_$(r,l),bo("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!l.multiple},bo("invalid",r);break;case"textarea":b$(r,l),bo("invalid",r)}hD(n,l),a=null;for(var h in l)if(l.hasOwnProperty(h)){var i=l[h];h==="children"?typeof i=="string"?r.textContent!==i&&(l.suppressHydrationWarning!==!0&&DC(r.textContent,i,e),a=["children",i]):typeof i=="number"&&r.textContent!==""+i&&(l.suppressHydrationWarning!==!0&&DC(r.textContent,i,e),a=["children",""+i]):cA.hasOwnProperty(h)&&i!=null&&h==="onScroll"&&bo("scroll",r)}switch(n){case"input":CC(r),x$(r,l,!0);break;case"textarea":CC(r),w$(r);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(r.onclick=wP)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{h=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=hX(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=h.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=h.createElement(n,{is:r.is}):(e=h.createElement(n),n==="select"&&(h=e,r.multiple?h.multiple=!0:r.size&&(h.size=r.size))):e=h.createElementNS(e,n),e[Sm]=t,e[_A]=r,jJ(e,t,!1,!1),t.stateNode=e;e:{switch(h=fD(n,r),n){case"dialog":bo("cancel",e),bo("close",e),a=r;break;case"iframe":case"object":case"embed":bo("load",e),a=r;break;case"video":case"audio":for(a=0;a<ES.length;a++)bo(ES[a],e);a=r;break;case"source":bo("error",e),a=r;break;case"img":case"image":case"link":bo("error",e),bo("load",e),a=r;break;case"details":bo("toggle",e),a=r;break;case"input":_$(e,r),a=oD(e,r),bo("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=Yo({},r,{value:void 0}),bo("invalid",e);break;case"textarea":b$(e,r),a=uD(e,r),bo("invalid",e);break;default:a=r}hD(n,a),i=a;for(l in i)if(i.hasOwnProperty(l)){var y=i[l];l==="style"?mX(e,y):l==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,y!=null&&fX(e,y)):l==="children"?typeof y=="string"?(n!=="textarea"||y!=="")&&uA(e,y):typeof y=="number"&&uA(e,""+y):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(cA.hasOwnProperty(l)?y!=null&&l==="onScroll"&&bo("scroll",e):y!=null&&AO(e,l,y,h))}switch(n){case"input":CC(e),x$(e,r,!1);break;case"textarea":CC(e),w$(e);break;case"option":r.value!=null&&e.setAttribute("value",""+av(r.value));break;case"select":e.multiple=!!r.multiple,l=r.value,l!=null?lb(e,!!r.multiple,l,!1):r.defaultValue!=null&&lb(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=wP)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return mu(t),null;case 6:if(e&&t.stateNode!=null)FJ(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(cr(166));if(n=P_(bA.current),P_(Rm.current),RC(t)){if(r=t.stateNode,n=t.memoizedProps,r[Sm]=t,(l=r.nodeValue!==n)&&(e=Th,e!==null))switch(e.tag){case 3:DC(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&DC(r.nodeValue,n,(e.mode&1)!==0)}l&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Sm]=t,t.stateNode=r}return mu(t),null;case 13:if(To(Wo),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Fo&&wh!==null&&t.mode&1&&!(t.flags&128))nJ(),qb(),t.flags|=98560,l=!1;else if(l=RC(t),r!==null&&r.dehydrated!==null){if(e===null){if(!l)throw Error(cr(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(cr(317));l[Sm]=t}else qb(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;mu(t),l=!1}else pp!==null&&(WD(pp),pp=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Wo.current&1?tc===0&&(tc=3):aF())),t.updateQueue!==null&&(t.flags|=4),mu(t),null);case 4:return Hb(),zD(e,t),e===null&&yA(t.stateNode.containerInfo),mu(t),null;case 10:return $O(t.type._context),mu(t),null;case 17:return Gd(t.type)&&SP(),mu(t),null;case 19:if(To(Wo),l=t.memoizedState,l===null)return mu(t),null;if(r=(t.flags&128)!==0,h=l.rendering,h===null)if(r)iS(l,!1);else{if(tc!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(h=IP(e),h!==null){for(t.flags|=128,iS(l,!1),r=h.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)l=n,e=r,l.flags&=14680066,h=l.alternate,h===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=h.childLanes,l.lanes=h.lanes,l.child=h.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=h.memoizedProps,l.memoizedState=h.memoizedState,l.updateQueue=h.updateQueue,l.type=h.type,e=h.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return uo(Wo,Wo.current&1|2),t.child}e=e.sibling}l.tail!==null&&vl()>Zb&&(t.flags|=128,r=!0,iS(l,!1),t.lanes=4194304)}else{if(!r)if(e=IP(h),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),iS(l,!0),l.tail===null&&l.tailMode==="hidden"&&!h.alternate&&!Fo)return mu(t),null}else 2*vl()-l.renderingStartTime>Zb&&n!==1073741824&&(t.flags|=128,r=!0,iS(l,!1),t.lanes=4194304);l.isBackwards?(h.sibling=t.child,t.child=h):(n=l.last,n!==null?n.sibling=h:t.child=h,l.last=h)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=vl(),t.sibling=null,n=Wo.current,uo(Wo,r?n&1|2:n&1),t):(mu(t),null);case 22:case 23:return sF(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?mh&1073741824&&(mu(t),t.subtreeFlags&6&&(t.flags|=8192)):mu(t),null;case 24:return null;case 25:return null}throw Error(cr(156,t.tag))}function Ave(e,t){switch(zO(t),t.tag){case 1:return Gd(t.type)&&SP(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Hb(),To(qd),To(Eu),ZO(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return WO(t),null;case 13:if(To(Wo),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(cr(340));qb()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return To(Wo),null;case 4:return Hb(),null;case 10:return $O(t.type._context),null;case 22:case 23:return sF(),null;case 24:return null;default:return null}}var FC=!1,wu=!1,Tve=typeof WeakSet=="function"?WeakSet:Set,ci=null;function Y1(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){al(e,t,r)}else n.current=null}function BD(e,t,n){try{n()}catch(r){al(e,t,r)}}var d9=!1;function Cve(e,t){if(SD=_P,e=$X(),OO(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,l=r.focusNode;r=r.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var h=0,i=-1,y=-1,x=0,w=0,C=e,P=null;t:for(;;){for(var E;C!==n||a!==0&&C.nodeType!==3||(i=h+a),C!==l||r!==0&&C.nodeType!==3||(y=h+r),C.nodeType===3&&(h+=C.nodeValue.length),(E=C.firstChild)!==null;)P=C,C=E;for(;;){if(C===e)break t;if(P===n&&++x===a&&(i=h),P===l&&++w===r&&(y=h),(E=C.nextSibling)!==null)break;C=P,P=C.parentNode}C=E}n=i===-1||y===-1?null:{start:i,end:y}}else n=null}n=n||{start:0,end:0}}else n=null;for(AD={focusedElem:e,selectionRange:n},_P=!1,ci=t;ci!==null;)if(t=ci,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ci=e;else for(;ci!==null;){t=ci;try{var j=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var D=j.memoizedProps,B=j.memoizedState,F=t.stateNode,$=F.getSnapshotBeforeUpdate(t.elementType===t.type?D:up(t.type,D),B);F.__reactInternalSnapshotBeforeUpdate=$}break;case 3:var H=t.stateNode.containerInfo;H.nodeType===1?H.textContent="":H.nodeType===9&&H.documentElement&&H.removeChild(H.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(cr(163))}}catch(J){al(t,t.return,J)}if(e=t.sibling,e!==null){e.return=t.return,ci=e;break}ci=t.return}return j=d9,d9=!1,j}function GS(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var l=a.destroy;a.destroy=void 0,l!==void 0&&BD(t,n,l)}a=a.next}while(a!==r)}}function w3(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function UD(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function zJ(e){var t=e.alternate;t!==null&&(e.alternate=null,zJ(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Sm],delete t[_A],delete t[ED],delete t[lve],delete t[cve])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function BJ(e){return e.tag===5||e.tag===3||e.tag===4}function h9(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||BJ(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function VD(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=wP));else if(r!==4&&(e=e.child,e!==null))for(VD(e,t,n),e=e.sibling;e!==null;)VD(e,t,n),e=e.sibling}function $D(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for($D(e,t,n),e=e.sibling;e!==null;)$D(e,t,n),e=e.sibling}var Vc=null,fp=!1;function c0(e,t,n){for(n=n.child;n!==null;)UJ(e,t,n),n=n.sibling}function UJ(e,t,n){if(Dm&&typeof Dm.onCommitFiberUnmount=="function")try{Dm.onCommitFiberUnmount(p3,n)}catch{}switch(n.tag){case 5:wu||Y1(n,t);case 6:var r=Vc,a=fp;Vc=null,c0(e,t,n),Vc=r,fp=a,Vc!==null&&(fp?(e=Vc,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Vc.removeChild(n.stateNode));break;case 18:Vc!==null&&(fp?(e=Vc,n=n.stateNode,e.nodeType===8?lL(e.parentNode,n):e.nodeType===1&&lL(e,n),pA(e)):lL(Vc,n.stateNode));break;case 4:r=Vc,a=fp,Vc=n.stateNode.containerInfo,fp=!0,c0(e,t,n),Vc=r,fp=a;break;case 0:case 11:case 14:case 15:if(!wu&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var l=a,h=l.destroy;l=l.tag,h!==void 0&&(l&2||l&4)&&BD(n,t,h),a=a.next}while(a!==r)}c0(e,t,n);break;case 1:if(!wu&&(Y1(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(i){al(n,t,i)}c0(e,t,n);break;case 21:c0(e,t,n);break;case 22:n.mode&1?(wu=(r=wu)||n.memoizedState!==null,c0(e,t,n),wu=r):c0(e,t,n);break;default:c0(e,t,n)}}function f9(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Tve),t.forEach(function(r){var a=Rve.bind(null,e,r);n.has(r)||(n.add(r),r.then(a,a))})}}function ip(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var l=e,h=t,i=h;e:for(;i!==null;){switch(i.tag){case 5:Vc=i.stateNode,fp=!1;break e;case 3:Vc=i.stateNode.containerInfo,fp=!0;break e;case 4:Vc=i.stateNode.containerInfo,fp=!0;break e}i=i.return}if(Vc===null)throw Error(cr(160));UJ(l,h,a),Vc=null,fp=!1;var y=a.alternate;y!==null&&(y.return=null),a.return=null}catch(x){al(a,t,x)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)VJ(t,e),t=t.sibling}function VJ(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ip(t,e),pm(e),r&4){try{GS(3,e,e.return),w3(3,e)}catch(D){al(e,e.return,D)}try{GS(5,e,e.return)}catch(D){al(e,e.return,D)}}break;case 1:ip(t,e),pm(e),r&512&&n!==null&&Y1(n,n.return);break;case 5:if(ip(t,e),pm(e),r&512&&n!==null&&Y1(n,n.return),e.flags&32){var a=e.stateNode;try{uA(a,"")}catch(D){al(e,e.return,D)}}if(r&4&&(a=e.stateNode,a!=null)){var l=e.memoizedProps,h=n!==null?n.memoizedProps:l,i=e.type,y=e.updateQueue;if(e.updateQueue=null,y!==null)try{i==="input"&&l.type==="radio"&&l.name!=null&&uX(a,l),fD(i,h);var x=fD(i,l);for(h=0;h<y.length;h+=2){var w=y[h],C=y[h+1];w==="style"?mX(a,C):w==="dangerouslySetInnerHTML"?fX(a,C):w==="children"?uA(a,C):AO(a,w,C,x)}switch(i){case"input":lD(a,l);break;case"textarea":dX(a,l);break;case"select":var P=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!l.multiple;var E=l.value;E!=null?lb(a,!!l.multiple,E,!1):P!==!!l.multiple&&(l.defaultValue!=null?lb(a,!!l.multiple,l.defaultValue,!0):lb(a,!!l.multiple,l.multiple?[]:"",!1))}a[_A]=l}catch(D){al(e,e.return,D)}}break;case 6:if(ip(t,e),pm(e),r&4){if(e.stateNode===null)throw Error(cr(162));a=e.stateNode,l=e.memoizedProps;try{a.nodeValue=l}catch(D){al(e,e.return,D)}}break;case 3:if(ip(t,e),pm(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{pA(t.containerInfo)}catch(D){al(e,e.return,D)}break;case 4:ip(t,e),pm(e);break;case 13:ip(t,e),pm(e),a=e.child,a.flags&8192&&(l=a.memoizedState!==null,a.stateNode.isHidden=l,!l||a.alternate!==null&&a.alternate.memoizedState!==null||(rF=vl())),r&4&&f9(e);break;case 22:if(w=n!==null&&n.memoizedState!==null,e.mode&1?(wu=(x=wu)||w,ip(t,e),wu=x):ip(t,e),pm(e),r&8192){if(x=e.memoizedState!==null,(e.stateNode.isHidden=x)&&!w&&e.mode&1)for(ci=e,w=e.child;w!==null;){for(C=ci=w;ci!==null;){switch(P=ci,E=P.child,P.tag){case 0:case 11:case 14:case 15:GS(4,P,P.return);break;case 1:Y1(P,P.return);var j=P.stateNode;if(typeof j.componentWillUnmount=="function"){r=P,n=P.return;try{t=r,j.props=t.memoizedProps,j.state=t.memoizedState,j.componentWillUnmount()}catch(D){al(r,n,D)}}break;case 5:Y1(P,P.return);break;case 22:if(P.memoizedState!==null){m9(C);continue}}E!==null?(E.return=P,ci=E):m9(C)}w=w.sibling}e:for(w=null,C=e;;){if(C.tag===5){if(w===null){w=C;try{a=C.stateNode,x?(l=a.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(i=C.stateNode,y=C.memoizedProps.style,h=y!=null&&y.hasOwnProperty("display")?y.display:null,i.style.display=pX("display",h))}catch(D){al(e,e.return,D)}}}else if(C.tag===6){if(w===null)try{C.stateNode.nodeValue=x?"":C.memoizedProps}catch(D){al(e,e.return,D)}}else if((C.tag!==22&&C.tag!==23||C.memoizedState===null||C===e)&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===e)break e;for(;C.sibling===null;){if(C.return===null||C.return===e)break e;w===C&&(w=null),C=C.return}w===C&&(w=null),C.sibling.return=C.return,C=C.sibling}}break;case 19:ip(t,e),pm(e),r&4&&f9(e);break;case 21:break;default:ip(t,e),pm(e)}}function pm(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(BJ(n)){var r=n;break e}n=n.return}throw Error(cr(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(uA(a,""),r.flags&=-33);var l=h9(e);$D(e,l,a);break;case 3:case 4:var h=r.stateNode.containerInfo,i=h9(e);VD(e,i,h);break;default:throw Error(cr(161))}}catch(y){al(e,e.return,y)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Eve(e,t,n){ci=e,$J(e)}function $J(e,t,n){for(var r=(e.mode&1)!==0;ci!==null;){var a=ci,l=a.child;if(a.tag===22&&r){var h=a.memoizedState!==null||FC;if(!h){var i=a.alternate,y=i!==null&&i.memoizedState!==null||wu;i=FC;var x=wu;if(FC=h,(wu=y)&&!x)for(ci=a;ci!==null;)h=ci,y=h.child,h.tag===22&&h.memoizedState!==null?g9(a):y!==null?(y.return=h,ci=y):g9(a);for(;l!==null;)ci=l,$J(l),l=l.sibling;ci=a,FC=i,wu=x}p9(e)}else a.subtreeFlags&8772&&l!==null?(l.return=a,ci=l):p9(e)}}function p9(e){for(;ci!==null;){var t=ci;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:wu||w3(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!wu)if(n===null)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:up(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&J$(t,l,r);break;case 3:var h=t.updateQueue;if(h!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}J$(t,h,n)}break;case 5:var i=t.stateNode;if(n===null&&t.flags&4){n=i;var y=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":y.autoFocus&&n.focus();break;case"img":y.src&&(n.src=y.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var x=t.alternate;if(x!==null){var w=x.memoizedState;if(w!==null){var C=w.dehydrated;C!==null&&pA(C)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(cr(163))}wu||t.flags&512&&UD(t)}catch(P){al(t,t.return,P)}}if(t===e){ci=null;break}if(n=t.sibling,n!==null){n.return=t.return,ci=n;break}ci=t.return}}function m9(e){for(;ci!==null;){var t=ci;if(t===e){ci=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ci=n;break}ci=t.return}}function g9(e){for(;ci!==null;){var t=ci;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{w3(4,t)}catch(y){al(t,n,y)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(y){al(t,a,y)}}var l=t.return;try{UD(t)}catch(y){al(t,l,y)}break;case 5:var h=t.return;try{UD(t)}catch(y){al(t,h,y)}}}catch(y){al(t,t.return,y)}if(t===e){ci=null;break}var i=t.sibling;if(i!==null){i.return=t.return,ci=i;break}ci=t.return}}var Pve=Math.ceil,LP=my.ReactCurrentDispatcher,tF=my.ReactCurrentOwner,yf=my.ReactCurrentBatchConfig,ua=0,Pc=null,zl=null,Wc=0,mh=0,X1=bv(0),tc=0,TA=null,ax=0,S3=0,nF=0,HS=null,zd=null,rF=0,Zb=1/0,Mg=null,DP=!1,qD=null,K0=null,zC=!1,z0=null,RP=0,WS=0,GD=null,BE=-1,UE=0;function ad(){return ua&6?vl():BE!==-1?BE:BE=vl()}function Y0(e){return e.mode&1?ua&2&&Wc!==0?Wc&-Wc:dve.transition!==null?(UE===0&&(UE=EX()),UE):(e=Ra,e!==0||(e=window.event,e=e===void 0?16:DX(e.type)),e):1}function xp(e,t,n,r){if(50<WS)throw WS=0,GD=null,Error(cr(185));g5(e,n,r),(!(ua&2)||e!==Pc)&&(e===Pc&&(!(ua&2)&&(S3|=n),tc===4&&S0(e,Wc)),Hd(e,r),n===1&&ua===0&&!(t.mode&1)&&(Zb=vl()+500,_3&&wv()))}function Hd(e,t){var n=e.callbackNode;d0e(e,t);var r=vP(e,e===Pc?Wc:0);if(r===0)n!==null&&T$(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&T$(n),t===1)e.tag===0?uve(y9.bind(null,e)):QX(y9.bind(null,e)),ave(function(){!(ua&6)&&wv()}),n=null;else{switch(PX(r)){case 1:n=kO;break;case 4:n=TX;break;case 16:n=yP;break;case 536870912:n=CX;break;default:n=yP}n=XJ(n,qJ.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function qJ(e,t){if(BE=-1,UE=0,ua&6)throw Error(cr(327));var n=e.callbackNode;if(fb()&&e.callbackNode!==n)return null;var r=vP(e,e===Pc?Wc:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=jP(e,r);else{t=r;var a=ua;ua|=2;var l=HJ();(Pc!==e||Wc!==t)&&(Mg=null,Zb=vl()+500,Z_(e,t));do try{Nve();break}catch(i){GJ(e,i)}while(!0);VO(),LP.current=l,ua=a,zl!==null?t=0:(Pc=null,Wc=0,t=tc)}if(t!==0){if(t===2&&(a=vD(e),a!==0&&(r=a,t=HD(e,a))),t===1)throw n=TA,Z_(e,0),S0(e,r),Hd(e,vl()),n;if(t===6)S0(e,r);else{if(a=e.current.alternate,!(r&30)&&!kve(a)&&(t=jP(e,r),t===2&&(l=vD(e),l!==0&&(r=l,t=HD(e,l))),t===1))throw n=TA,Z_(e,0),S0(e,r),Hd(e,vl()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(cr(345));case 2:v_(e,zd,Mg);break;case 3:if(S0(e,r),(r&130023424)===r&&(t=rF+500-vl(),10<t)){if(vP(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){ad(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=CD(v_.bind(null,e,zd,Mg),t);break}v_(e,zd,Mg);break;case 4:if(S0(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var h=31-_p(r);l=1<<h,h=t[h],h>a&&(a=h),r&=~l}if(r=a,r=vl()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Pve(r/1960))-r,10<r){e.timeoutHandle=CD(v_.bind(null,e,zd,Mg),r);break}v_(e,zd,Mg);break;case 5:v_(e,zd,Mg);break;default:throw Error(cr(329))}}}return Hd(e,vl()),e.callbackNode===n?qJ.bind(null,e):null}function HD(e,t){var n=HS;return e.current.memoizedState.isDehydrated&&(Z_(e,t).flags|=256),e=jP(e,t),e!==2&&(t=zd,zd=n,t!==null&&WD(t)),e}function WD(e){zd===null?zd=e:zd.push.apply(zd,e)}function kve(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],l=a.getSnapshot;a=a.value;try{if(!Ap(l(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function S0(e,t){for(t&=~nF,t&=~S3,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-_p(t),r=1<<n;e[n]=-1,t&=~r}}function y9(e){if(ua&6)throw Error(cr(327));fb();var t=vP(e,0);if(!(t&1))return Hd(e,vl()),null;var n=jP(e,t);if(e.tag!==0&&n===2){var r=vD(e);r!==0&&(t=r,n=HD(e,r))}if(n===1)throw n=TA,Z_(e,0),S0(e,t),Hd(e,vl()),n;if(n===6)throw Error(cr(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,v_(e,zd,Mg),Hd(e,vl()),null}function iF(e,t){var n=ua;ua|=1;try{return e(t)}finally{ua=n,ua===0&&(Zb=vl()+500,_3&&wv())}}function ox(e){z0!==null&&z0.tag===0&&!(ua&6)&&fb();var t=ua;ua|=1;var n=yf.transition,r=Ra;try{if(yf.transition=null,Ra=1,e)return e()}finally{Ra=r,yf.transition=n,ua=t,!(ua&6)&&wv()}}function sF(){mh=X1.current,To(X1)}function Z_(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,sve(n)),zl!==null)for(n=zl.return;n!==null;){var r=n;switch(zO(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&SP();break;case 3:Hb(),To(qd),To(Eu),ZO();break;case 5:WO(r);break;case 4:Hb();break;case 13:To(Wo);break;case 19:To(Wo);break;case 10:$O(r.type._context);break;case 22:case 23:sF()}n=n.return}if(Pc=e,zl=e=X0(e.current,null),Wc=mh=t,tc=0,TA=null,nF=S3=ax=0,zd=HS=null,E_!==null){for(t=0;t<E_.length;t++)if(n=E_[t],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,l=n.pending;if(l!==null){var h=l.next;l.next=a,r.next=h}n.pending=r}E_=null}return e}function GJ(e,t){do{var n=zl;try{if(VO(),OE.current=MP,NP){for(var r=Ko.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}NP=!1}if(sx=0,Tc=Yl=Ko=null,qS=!1,wA=0,tF.current=null,n===null||n.return===null){tc=1,TA=t,zl=null;break}e:{var l=e,h=n.return,i=n,y=t;if(t=Wc,i.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){var x=y,w=i,C=w.tag;if(!(w.mode&1)&&(C===0||C===11||C===15)){var P=w.alternate;P?(w.updateQueue=P.updateQueue,w.memoizedState=P.memoizedState,w.lanes=P.lanes):(w.updateQueue=null,w.memoizedState=null)}var E=i9(h);if(E!==null){E.flags&=-257,s9(E,h,i,l,t),E.mode&1&&r9(l,x,t),t=E,y=x;var j=t.updateQueue;if(j===null){var D=new Set;D.add(y),t.updateQueue=D}else j.add(y);break e}else{if(!(t&1)){r9(l,x,t),aF();break e}y=Error(cr(426))}}else if(Fo&&i.mode&1){var B=i9(h);if(B!==null){!(B.flags&65536)&&(B.flags|=256),s9(B,h,i,l,t),BO(Wb(y,i));break e}}l=y=Wb(y,i),tc!==4&&(tc=2),HS===null?HS=[l]:HS.push(l),l=h;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var F=PJ(l,y,t);X$(l,F);break e;case 1:i=y;var $=l.type,H=l.stateNode;if(!(l.flags&128)&&(typeof $.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(K0===null||!K0.has(H)))){l.flags|=65536,t&=-t,l.lanes|=t;var J=kJ(l,i,t);X$(l,J);break e}}l=l.return}while(l!==null)}ZJ(n)}catch(ee){t=ee,zl===n&&n!==null&&(zl=n=n.return);continue}break}while(!0)}function HJ(){var e=LP.current;return LP.current=MP,e===null?MP:e}function aF(){(tc===0||tc===3||tc===2)&&(tc=4),Pc===null||!(ax&268435455)&&!(S3&268435455)||S0(Pc,Wc)}function jP(e,t){var n=ua;ua|=2;var r=HJ();(Pc!==e||Wc!==t)&&(Mg=null,Z_(e,t));do try{Ive();break}catch(a){GJ(e,a)}while(!0);if(VO(),ua=n,LP.current=r,zl!==null)throw Error(cr(261));return Pc=null,Wc=0,tc}function Ive(){for(;zl!==null;)WJ(zl)}function Nve(){for(;zl!==null&&!n0e();)WJ(zl)}function WJ(e){var t=YJ(e.alternate,e,mh);e.memoizedProps=e.pendingProps,t===null?ZJ(e):zl=t,tF.current=null}function ZJ(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Ave(n,t),n!==null){n.flags&=32767,zl=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{tc=6,zl=null;return}}else if(n=Sve(n,t,mh),n!==null){zl=n;return}if(t=t.sibling,t!==null){zl=t;return}zl=t=e}while(t!==null);tc===0&&(tc=5)}function v_(e,t,n){var r=Ra,a=yf.transition;try{yf.transition=null,Ra=1,Mve(e,t,n,r)}finally{yf.transition=a,Ra=r}return null}function Mve(e,t,n,r){do fb();while(z0!==null);if(ua&6)throw Error(cr(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(cr(177));e.callbackNode=null,e.callbackPriority=0;var l=n.lanes|n.childLanes;if(h0e(e,l),e===Pc&&(zl=Pc=null,Wc=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||zC||(zC=!0,XJ(yP,function(){return fb(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=yf.transition,yf.transition=null;var h=Ra;Ra=1;var i=ua;ua|=4,tF.current=null,Cve(e,n),VJ(n,e),J0e(AD),_P=!!SD,AD=SD=null,e.current=n,Eve(n),r0e(),ua=i,Ra=h,yf.transition=l}else e.current=n;if(zC&&(zC=!1,z0=e,RP=a),l=e.pendingLanes,l===0&&(K0=null),a0e(n.stateNode),Hd(e,vl()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(DP)throw DP=!1,e=qD,qD=null,e;return RP&1&&e.tag!==0&&fb(),l=e.pendingLanes,l&1?e===GD?WS++:(WS=0,GD=e):WS=0,wv(),null}function fb(){if(z0!==null){var e=PX(RP),t=yf.transition,n=Ra;try{if(yf.transition=null,Ra=16>e?16:e,z0===null)var r=!1;else{if(e=z0,z0=null,RP=0,ua&6)throw Error(cr(331));var a=ua;for(ua|=4,ci=e.current;ci!==null;){var l=ci,h=l.child;if(ci.flags&16){var i=l.deletions;if(i!==null){for(var y=0;y<i.length;y++){var x=i[y];for(ci=x;ci!==null;){var w=ci;switch(w.tag){case 0:case 11:case 15:GS(8,w,l)}var C=w.child;if(C!==null)C.return=w,ci=C;else for(;ci!==null;){w=ci;var P=w.sibling,E=w.return;if(zJ(w),w===x){ci=null;break}if(P!==null){P.return=E,ci=P;break}ci=E}}}var j=l.alternate;if(j!==null){var D=j.child;if(D!==null){j.child=null;do{var B=D.sibling;D.sibling=null,D=B}while(D!==null)}}ci=l}}if(l.subtreeFlags&2064&&h!==null)h.return=l,ci=h;else e:for(;ci!==null;){if(l=ci,l.flags&2048)switch(l.tag){case 0:case 11:case 15:GS(9,l,l.return)}var F=l.sibling;if(F!==null){F.return=l.return,ci=F;break e}ci=l.return}}var $=e.current;for(ci=$;ci!==null;){h=ci;var H=h.child;if(h.subtreeFlags&2064&&H!==null)H.return=h,ci=H;else e:for(h=$;ci!==null;){if(i=ci,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:w3(9,i)}}catch(ee){al(i,i.return,ee)}if(i===h){ci=null;break e}var J=i.sibling;if(J!==null){J.return=i.return,ci=J;break e}ci=i.return}}if(ua=a,wv(),Dm&&typeof Dm.onPostCommitFiberRoot=="function")try{Dm.onPostCommitFiberRoot(p3,e)}catch{}r=!0}return r}finally{Ra=n,yf.transition=t}}return!1}function v9(e,t,n){t=Wb(n,t),t=PJ(e,t,1),e=Z0(e,t,1),t=ad(),e!==null&&(g5(e,1,t),Hd(e,t))}function al(e,t,n){if(e.tag===3)v9(e,e,n);else for(;t!==null;){if(t.tag===3){v9(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(K0===null||!K0.has(r))){e=Wb(n,e),e=kJ(t,e,1),t=Z0(t,e,1),e=ad(),t!==null&&(g5(t,1,e),Hd(t,e));break}}t=t.return}}function Lve(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=ad(),e.pingedLanes|=e.suspendedLanes&n,Pc===e&&(Wc&n)===n&&(tc===4||tc===3&&(Wc&130023424)===Wc&&500>vl()-rF?Z_(e,0):nF|=n),Hd(e,t)}function KJ(e,t){t===0&&(e.mode&1?(t=kC,kC<<=1,!(kC&130023424)&&(kC=4194304)):t=1);var n=ad();e=ey(e,t),e!==null&&(g5(e,t,n),Hd(e,n))}function Dve(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),KJ(e,n)}function Rve(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(cr(314))}r!==null&&r.delete(t),KJ(e,n)}var YJ;YJ=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||qd.current)Bd=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Bd=!1,wve(e,t,n);Bd=!!(e.flags&131072)}else Bd=!1,Fo&&t.flags&1048576&&eJ(t,CP,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;zE(e,t),e=t.pendingProps;var a=$b(t,Eu.current);hb(t,n),a=YO(null,t,r,e,a,n);var l=XO();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Gd(r)?(l=!0,AP(t)):l=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,GO(t),a.updater=b3,t.stateNode=a,a._reactInternals=t,LD(t,r,e,n),t=jD(null,t,r,!0,l,n)):(t.tag=0,Fo&&l&&FO(t),Wu(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(zE(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=Ove(r),e=up(r,e),a){case 0:t=RD(null,t,r,e,n);break e;case 1:t=l9(null,t,r,e,n);break e;case 11:t=a9(null,t,r,e,n);break e;case 14:t=o9(null,t,r,up(r.type,e),n);break e}throw Error(cr(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:up(r,a),RD(e,t,r,a,n);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:up(r,a),l9(e,t,r,a,n);case 3:e:{if(LJ(t),e===null)throw Error(cr(387));r=t.pendingProps,l=t.memoizedState,a=l.element,aJ(e,t),kP(t,r,null,n);var h=t.memoizedState;if(r=h.element,l.isDehydrated)if(l={element:r,isDehydrated:!1,cache:h.cache,pendingSuspenseBoundaries:h.pendingSuspenseBoundaries,transitions:h.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){a=Wb(Error(cr(423)),t),t=c9(e,t,r,n,a);break e}else if(r!==a){a=Wb(Error(cr(424)),t),t=c9(e,t,r,n,a);break e}else for(wh=W0(t.stateNode.containerInfo.firstChild),Th=t,Fo=!0,pp=null,n=iJ(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(qb(),r===a){t=ty(e,t,n);break e}Wu(e,t,r,n)}t=t.child}return t;case 5:return oJ(t),e===null&&ID(t),r=t.type,a=t.pendingProps,l=e!==null?e.memoizedProps:null,h=a.children,TD(r,a)?h=null:l!==null&&TD(r,l)&&(t.flags|=32),MJ(e,t),Wu(e,t,h,n),t.child;case 6:return e===null&&ID(t),null;case 13:return DJ(e,t,n);case 4:return HO(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Gb(t,null,r,n):Wu(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:up(r,a),a9(e,t,r,a,n);case 7:return Wu(e,t,t.pendingProps,n),t.child;case 8:return Wu(e,t,t.pendingProps.children,n),t.child;case 12:return Wu(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,l=t.memoizedProps,h=a.value,uo(EP,r._currentValue),r._currentValue=h,l!==null)if(Ap(l.value,h)){if(l.children===a.children&&!qd.current){t=ty(e,t,n);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var i=l.dependencies;if(i!==null){h=l.child;for(var y=i.firstContext;y!==null;){if(y.context===r){if(l.tag===1){y=Hg(-1,n&-n),y.tag=2;var x=l.updateQueue;if(x!==null){x=x.shared;var w=x.pending;w===null?y.next=y:(y.next=w.next,w.next=y),x.pending=y}}l.lanes|=n,y=l.alternate,y!==null&&(y.lanes|=n),ND(l.return,n,t),i.lanes|=n;break}y=y.next}}else if(l.tag===10)h=l.type===t.type?null:l.child;else if(l.tag===18){if(h=l.return,h===null)throw Error(cr(341));h.lanes|=n,i=h.alternate,i!==null&&(i.lanes|=n),ND(h,n,t),h=l.sibling}else h=l.child;if(h!==null)h.return=l;else for(h=l;h!==null;){if(h===t){h=null;break}if(l=h.sibling,l!==null){l.return=h.return,h=l;break}h=h.return}l=h}Wu(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,hb(t,n),a=xf(a),r=r(a),t.flags|=1,Wu(e,t,r,n),t.child;case 14:return r=t.type,a=up(r,t.pendingProps),a=up(r.type,a),o9(e,t,r,a,n);case 15:return IJ(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:up(r,a),zE(e,t),t.tag=1,Gd(r)?(e=!0,AP(t)):e=!1,hb(t,n),EJ(t,r,a),LD(t,r,a,n),jD(null,t,r,!0,e,n);case 19:return RJ(e,t,n);case 22:return NJ(e,t,n)}throw Error(cr(156,t.tag))};function XJ(e,t){return AX(e,t)}function jve(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pf(e,t,n,r){return new jve(e,t,n,r)}function oF(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ove(e){if(typeof e=="function")return oF(e)?1:0;if(e!=null){if(e=e.$$typeof,e===CO)return 11;if(e===EO)return 14}return 2}function X0(e,t){var n=e.alternate;return n===null?(n=pf(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function VE(e,t,n,r,a,l){var h=2;if(r=e,typeof e=="function")oF(e)&&(h=1);else if(typeof e=="string")h=5;else e:switch(e){case U1:return K_(n.children,a,l,t);case TO:h=8,a|=8;break;case rD:return e=pf(12,n,t,a|2),e.elementType=rD,e.lanes=l,e;case iD:return e=pf(13,n,t,a),e.elementType=iD,e.lanes=l,e;case sD:return e=pf(19,n,t,a),e.elementType=sD,e.lanes=l,e;case oX:return A3(n,a,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case sX:h=10;break e;case aX:h=9;break e;case CO:h=11;break e;case EO:h=14;break e;case y0:h=16,r=null;break e}throw Error(cr(130,e==null?e:typeof e,""))}return t=pf(h,n,t,a),t.elementType=e,t.type=r,t.lanes=l,t}function K_(e,t,n,r){return e=pf(7,e,r,t),e.lanes=n,e}function A3(e,t,n,r){return e=pf(22,e,r,t),e.elementType=oX,e.lanes=n,e.stateNode={isHidden:!1},e}function gL(e,t,n){return e=pf(6,e,null,t),e.lanes=n,e}function yL(e,t,n){return t=pf(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Fve(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=XM(0),this.expirationTimes=XM(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=XM(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function lF(e,t,n,r,a,l,h,i,y){return e=new Fve(e,t,n,i,y),t===1?(t=1,l===!0&&(t|=8)):t=0,l=pf(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},GO(l),e}function zve(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B1,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function JJ(e){if(!e)return ov;e=e._reactInternals;e:{if(Px(e)!==e||e.tag!==1)throw Error(cr(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Gd(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(cr(171))}if(e.tag===1){var n=e.type;if(Gd(n))return JX(e,n,t)}return t}function QJ(e,t,n,r,a,l,h,i,y){return e=lF(n,r,!0,e,a,l,h,i,y),e.context=JJ(null),n=e.current,r=ad(),a=Y0(n),l=Hg(r,a),l.callback=t??null,Z0(n,l,a),e.current.lanes=a,g5(e,a,r),Hd(e,r),e}function T3(e,t,n,r){var a=t.current,l=ad(),h=Y0(a);return n=JJ(n),t.context===null?t.context=n:t.pendingContext=n,t=Hg(l,h),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Z0(a,t,h),e!==null&&(xp(e,a,h,l),jE(e,a,h)),h}function OP(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function _9(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function cF(e,t){_9(e,t),(e=e.alternate)&&_9(e,t)}function Bve(){return null}var eQ=typeof reportError=="function"?reportError:function(e){console.error(e)};function uF(e){this._internalRoot=e}C3.prototype.render=uF.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(cr(409));T3(e,t,null,null)};C3.prototype.unmount=uF.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ox(function(){T3(null,e,null,null)}),t[Qg]=null}};function C3(e){this._internalRoot=e}C3.prototype.unstable_scheduleHydration=function(e){if(e){var t=NX();e={blockedOn:null,target:e,priority:t};for(var n=0;n<w0.length&&t!==0&&t<w0[n].priority;n++);w0.splice(n,0,e),n===0&&LX(e)}};function dF(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function E3(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function x9(){}function Uve(e,t,n,r,a){if(a){if(typeof r=="function"){var l=r;r=function(){var x=OP(h);l.call(x)}}var h=QJ(t,r,e,0,null,!1,!1,"",x9);return e._reactRootContainer=h,e[Qg]=h.current,yA(e.nodeType===8?e.parentNode:e),ox(),h}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var i=r;r=function(){var x=OP(y);i.call(x)}}var y=lF(e,0,!1,null,null,!1,!1,"",x9);return e._reactRootContainer=y,e[Qg]=y.current,yA(e.nodeType===8?e.parentNode:e),ox(function(){T3(t,y,n,r)}),y}function P3(e,t,n,r,a){var l=n._reactRootContainer;if(l){var h=l;if(typeof a=="function"){var i=a;a=function(){var y=OP(h);i.call(y)}}T3(t,h,e,a)}else h=Uve(n,t,e,a,r);return OP(h)}kX=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=CS(t.pendingLanes);n!==0&&(IO(t,n|1),Hd(t,vl()),!(ua&6)&&(Zb=vl()+500,wv()))}break;case 13:ox(function(){var r=ey(e,1);if(r!==null){var a=ad();xp(r,e,1,a)}}),cF(e,1)}};NO=function(e){if(e.tag===13){var t=ey(e,134217728);if(t!==null){var n=ad();xp(t,e,134217728,n)}cF(e,134217728)}};IX=function(e){if(e.tag===13){var t=Y0(e),n=ey(e,t);if(n!==null){var r=ad();xp(n,e,t,r)}cF(e,t)}};NX=function(){return Ra};MX=function(e,t){var n=Ra;try{return Ra=e,t()}finally{Ra=n}};mD=function(e,t,n){switch(t){case"input":if(lD(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=v3(r);if(!a)throw Error(cr(90));cX(r),lD(r,a)}}}break;case"textarea":dX(e,n);break;case"select":t=n.value,t!=null&&lb(e,!!n.multiple,t,!1)}};vX=iF;_X=ox;var Vve={usingClientEntryPoint:!1,Events:[v5,G1,v3,gX,yX,iF]},sS={findFiberByHostInstance:C_,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$ve={bundleType:sS.bundleType,version:sS.version,rendererPackageName:sS.rendererPackageName,rendererConfig:sS.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:my.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=wX(e),e===null?null:e.stateNode},findFiberByHostInstance:sS.findFiberByHostInstance||Bve,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var BC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!BC.isDisabled&&BC.supportsFiber)try{p3=BC.inject($ve),Dm=BC}catch{}}Nh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Vve;Nh.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dF(t))throw Error(cr(200));return zve(e,t,null,n)};Nh.createRoot=function(e,t){if(!dF(e))throw Error(cr(299));var n=!1,r="",a=eQ;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=lF(e,1,!1,null,null,n,!1,r,a),e[Qg]=t.current,yA(e.nodeType===8?e.parentNode:e),new uF(t)};Nh.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(cr(188)):(e=Object.keys(e).join(","),Error(cr(268,e)));return e=wX(t),e=e===null?null:e.stateNode,e};Nh.flushSync=function(e){return ox(e)};Nh.hydrate=function(e,t,n){if(!E3(t))throw Error(cr(200));return P3(null,e,t,!0,n)};Nh.hydrateRoot=function(e,t,n){if(!dF(e))throw Error(cr(405));var r=n!=null&&n.hydratedSources||null,a=!1,l="",h=eQ;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(h=n.onRecoverableError)),t=QJ(t,null,e,1,n??null,a,!1,l,h),e[Qg]=t.current,yA(e),r)for(e=0;e<r.length;e++)n=r[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new C3(t)};Nh.render=function(e,t,n){if(!E3(t))throw Error(cr(200));return P3(null,e,t,!1,n)};Nh.unmountComponentAtNode=function(e){if(!E3(e))throw Error(cr(40));return e._reactRootContainer?(ox(function(){P3(null,null,e,!1,function(){e._reactRootContainer=null,e[Qg]=null})}),!0):!1};Nh.unstable_batchedUpdates=iF;Nh.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!E3(n))throw Error(cr(200));if(e==null||e._reactInternals===void 0)throw Error(cr(38));return P3(e,t,n,!1,r)};Nh.version="18.3.1-next-f1338f8080-20240426";function tQ(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tQ)}catch(e){console.error(e)}}tQ(),tX.exports=Nh;var Sv=tX.exports;const nQ=Ip(Sv);var rQ,b9=Sv;rQ=b9.createRoot,b9.hydrateRoot;const qve=1,Gve=1e6;let vL=0;function Hve(){return vL=(vL+1)%Number.MAX_SAFE_INTEGER,vL.toString()}const _L=new Map,w9=e=>{if(_L.has(e))return;const t=setTimeout(()=>{_L.delete(e),ZS({type:"REMOVE_TOAST",toastId:e})},Gve);_L.set(e,t)},Wve=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,qve)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(n=>n.id===t.toast.id?{...n,...t.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=t;return n?w9(n):e.toasts.forEach(r=>{w9(r.id)}),{...e,toasts:e.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(n=>n.id!==t.toastId)}}},$E=[];let qE={toasts:[]};function ZS(e){qE=Wve(qE,e),$E.forEach(t=>{t(qE)})}function Zve({...e}){const t=Hve(),n=a=>ZS({type:"UPDATE_TOAST",toast:{...a,id:t}}),r=()=>ZS({type:"DISMISS_TOAST",toastId:t});return ZS({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:a=>{a||r()}}}),{id:t,dismiss:r,update:n}}function Kve(){const[e,t]=L.useState(qE);return L.useEffect(()=>($E.push(t),()=>{const n=$E.indexOf(t);n>-1&&$E.splice(n,1)}),[e]),{...e,toast:Zve,dismiss:n=>ZS({type:"DISMISS_TOAST",toastId:n})}}function Sr(e,t,{checkForDefaultPrevented:n=!0}={}){return function(a){if(e==null||e(a),n===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function S9(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function k3(...e){return t=>{let n=!1;const r=e.map(a=>{const l=S9(a,t);return!n&&typeof l=="function"&&(n=!0),l});if(n)return()=>{for(let a=0;a<r.length;a++){const l=r[a];typeof l=="function"?l():S9(e[a],null)}}}}function _s(...e){return L.useCallback(k3(...e),e)}function Yve(e,t){const n=L.createContext(t),r=l=>{const{children:h,...i}=l,y=L.useMemo(()=>i,Object.values(i));return v.jsx(n.Provider,{value:y,children:h})};r.displayName=e+"Provider";function a(l){const h=L.useContext(n);if(h)return h;if(t!==void 0)return t;throw new Error(`\`${l}\` must be used within \`${e}\``)}return[r,a]}function dd(e,t=[]){let n=[];function r(l,h){const i=L.createContext(h),y=n.length;n=[...n,h];const x=C=>{var F;const{scope:P,children:E,...j}=C,D=((F=P==null?void 0:P[e])==null?void 0:F[y])||i,B=L.useMemo(()=>j,Object.values(j));return v.jsx(D.Provider,{value:B,children:E})};x.displayName=l+"Provider";function w(C,P){var D;const E=((D=P==null?void 0:P[e])==null?void 0:D[y])||i,j=L.useContext(E);if(j)return j;if(h!==void 0)return h;throw new Error(`\`${C}\` must be used within \`${l}\``)}return[x,w]}const a=()=>{const l=n.map(h=>L.createContext(h));return function(i){const y=(i==null?void 0:i[e])||l;return L.useMemo(()=>({[`__scope${e}`]:{...i,[e]:y}}),[i,y])}};return a.scopeName=e,[r,Xve(a,...t)]}function Xve(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const h=r.reduce((i,{useScope:y,scopeName:x})=>{const C=y(l)[`__scope${x}`];return{...i,...C}},{});return L.useMemo(()=>({[`__scope${t.scopeName}`]:h}),[h])}};return n.scopeName=t.scopeName,n}function lx(e){const t=Jve(e),n=L.forwardRef((r,a)=>{const{children:l,...h}=r,i=L.Children.toArray(l),y=i.find(Qve);if(y){const x=y.props.children,w=i.map(C=>C===y?L.Children.count(x)>1?L.Children.only(null):L.isValidElement(x)?x.props.children:null:C);return v.jsx(t,{...h,ref:a,children:L.isValidElement(x)?L.cloneElement(x,void 0,w):null})}return v.jsx(t,{...h,ref:a,children:l})});return n.displayName=`${e}.Slot`,n}var Sw=lx("Slot");function Jve(e){const t=L.forwardRef((n,r)=>{const{children:a,...l}=n;if(L.isValidElement(a)){const h=t_e(a),i=e_e(l,a.props);return a.type!==L.Fragment&&(i.ref=r?k3(r,h):h),L.cloneElement(a,i)}return L.Children.count(a)>1?L.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var iQ=Symbol("radix.slottable");function sQ(e){const t=({children:n})=>v.jsx(v.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=iQ,t}function Qve(e){return L.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===iQ}function e_e(e,t){const n={...t};for(const r in t){const a=e[r],l=t[r];/^on[A-Z]/.test(r)?a&&l?n[r]=(...i)=>{const y=l(...i);return a(...i),y}:a&&(n[r]=a):r==="style"?n[r]={...a,...l}:r==="className"&&(n[r]=[a,l].filter(Boolean).join(" "))}return{...e,...n}}function t_e(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function I3(e){const t=e+"CollectionProvider",[n,r]=dd(t),[a,l]=n(t,{collectionRef:{current:null},itemMap:new Map}),h=D=>{const{scope:B,children:F}=D,$=ir.useRef(null),H=ir.useRef(new Map).current;return v.jsx(a,{scope:B,itemMap:H,collectionRef:$,children:F})};h.displayName=t;const i=e+"CollectionSlot",y=lx(i),x=ir.forwardRef((D,B)=>{const{scope:F,children:$}=D,H=l(i,F),J=_s(B,H.collectionRef);return v.jsx(y,{ref:J,children:$})});x.displayName=i;const w=e+"CollectionItemSlot",C="data-radix-collection-item",P=lx(w),E=ir.forwardRef((D,B)=>{const{scope:F,children:$,...H}=D,J=ir.useRef(null),ee=_s(B,J),Q=l(w,F);return ir.useEffect(()=>(Q.itemMap.set(J,{ref:J,...H}),()=>void Q.itemMap.delete(J))),v.jsx(P,{[C]:"",ref:ee,children:$})});E.displayName=w;function j(D){const B=l(e+"CollectionConsumer",D);return ir.useCallback(()=>{const $=B.collectionRef.current;if(!$)return[];const H=Array.from($.querySelectorAll(`[${C}]`));return Array.from(B.itemMap.values()).sort((Q,ne)=>H.indexOf(Q.ref.current)-H.indexOf(ne.ref.current))},[B.collectionRef,B.itemMap])}return[{Provider:h,Slot:x,ItemSlot:E},j,r]}var n_e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ei=n_e.reduce((e,t)=>{const n=lx(`Primitive.${t}`),r=L.forwardRef((a,l)=>{const{asChild:h,...i}=a,y=h?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),v.jsx(y,{...i,ref:l})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function hF(e,t){e&&Sv.flushSync(()=>e.dispatchEvent(t))}function ll(e){const t=L.useRef(e);return L.useEffect(()=>{t.current=e}),L.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function r_e(e,t=globalThis==null?void 0:globalThis.document){const n=ll(e);L.useEffect(()=>{const r=a=>{a.key==="Escape"&&n(a)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var i_e="DismissableLayer",ZD="dismissableLayer.update",s_e="dismissableLayer.pointerDownOutside",a_e="dismissableLayer.focusOutside",A9,aQ=L.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Aw=L.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:l,onInteractOutside:h,onDismiss:i,...y}=e,x=L.useContext(aQ),[w,C]=L.useState(null),P=(w==null?void 0:w.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,E]=L.useState({}),j=_s(t,ne=>C(ne)),D=Array.from(x.layers),[B]=[...x.layersWithOutsidePointerEventsDisabled].slice(-1),F=D.indexOf(B),$=w?D.indexOf(w):-1,H=x.layersWithOutsidePointerEventsDisabled.size>0,J=$>=F,ee=l_e(ne=>{const pe=ne.target,he=[...x.branches].some(we=>we.contains(pe));!J||he||(a==null||a(ne),h==null||h(ne),ne.defaultPrevented||i==null||i())},P),Q=c_e(ne=>{const pe=ne.target;[...x.branches].some(we=>we.contains(pe))||(l==null||l(ne),h==null||h(ne),ne.defaultPrevented||i==null||i())},P);return r_e(ne=>{$===x.layers.size-1&&(r==null||r(ne),!ne.defaultPrevented&&i&&(ne.preventDefault(),i()))},P),L.useEffect(()=>{if(w)return n&&(x.layersWithOutsidePointerEventsDisabled.size===0&&(A9=P.body.style.pointerEvents,P.body.style.pointerEvents="none"),x.layersWithOutsidePointerEventsDisabled.add(w)),x.layers.add(w),T9(),()=>{n&&x.layersWithOutsidePointerEventsDisabled.size===1&&(P.body.style.pointerEvents=A9)}},[w,P,n,x]),L.useEffect(()=>()=>{w&&(x.layers.delete(w),x.layersWithOutsidePointerEventsDisabled.delete(w),T9())},[w,x]),L.useEffect(()=>{const ne=()=>E({});return document.addEventListener(ZD,ne),()=>document.removeEventListener(ZD,ne)},[]),v.jsx(Ei.div,{...y,ref:j,style:{pointerEvents:H?J?"auto":"none":void 0,...e.style},onFocusCapture:Sr(e.onFocusCapture,Q.onFocusCapture),onBlurCapture:Sr(e.onBlurCapture,Q.onBlurCapture),onPointerDownCapture:Sr(e.onPointerDownCapture,ee.onPointerDownCapture)})});Aw.displayName=i_e;var o_e="DismissableLayerBranch",oQ=L.forwardRef((e,t)=>{const n=L.useContext(aQ),r=L.useRef(null),a=_s(t,r);return L.useEffect(()=>{const l=r.current;if(l)return n.branches.add(l),()=>{n.branches.delete(l)}},[n.branches]),v.jsx(Ei.div,{...e,ref:a})});oQ.displayName=o_e;function l_e(e,t=globalThis==null?void 0:globalThis.document){const n=ll(e),r=L.useRef(!1),a=L.useRef(()=>{});return L.useEffect(()=>{const l=i=>{if(i.target&&!r.current){let y=function(){lQ(s_e,n,x,{discrete:!0})};const x={originalEvent:i};i.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=y,t.addEventListener("click",a.current,{once:!0})):y()}else t.removeEventListener("click",a.current);r.current=!1},h=window.setTimeout(()=>{t.addEventListener("pointerdown",l)},0);return()=>{window.clearTimeout(h),t.removeEventListener("pointerdown",l),t.removeEventListener("click",a.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function c_e(e,t=globalThis==null?void 0:globalThis.document){const n=ll(e),r=L.useRef(!1);return L.useEffect(()=>{const a=l=>{l.target&&!r.current&&lQ(a_e,n,{originalEvent:l},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function T9(){const e=new CustomEvent(ZD);document.dispatchEvent(e)}function lQ(e,t,n,{discrete:r}){const a=n.originalEvent.target,l=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),r?hF(a,l):a.dispatchEvent(l)}var u_e=Aw,d_e=oQ,Sl=globalThis!=null&&globalThis.document?L.useLayoutEffect:()=>{},h_e="Portal",x5=L.forwardRef((e,t)=>{var i;const{container:n,...r}=e,[a,l]=L.useState(!1);Sl(()=>l(!0),[]);const h=n||a&&((i=globalThis==null?void 0:globalThis.document)==null?void 0:i.body);return h?nQ.createPortal(v.jsx(Ei.div,{...r,ref:t}),h):null});x5.displayName=h_e;function f_e(e,t){return L.useReducer((n,r)=>t[n][r]??n,e)}var hd=e=>{const{present:t,children:n}=e,r=p_e(t),a=typeof n=="function"?n({present:r.isPresent}):L.Children.only(n),l=_s(r.ref,m_e(a));return typeof n=="function"||r.isPresent?L.cloneElement(a,{ref:l}):null};hd.displayName="Presence";function p_e(e){const[t,n]=L.useState(),r=L.useRef(null),a=L.useRef(e),l=L.useRef("none"),h=e?"mounted":"unmounted",[i,y]=f_e(h,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return L.useEffect(()=>{const x=UC(r.current);l.current=i==="mounted"?x:"none"},[i]),Sl(()=>{const x=r.current,w=a.current;if(w!==e){const P=l.current,E=UC(x);e?y("MOUNT"):E==="none"||(x==null?void 0:x.display)==="none"?y("UNMOUNT"):y(w&&P!==E?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,y]),Sl(()=>{if(t){let x;const w=t.ownerDocument.defaultView??window,C=E=>{const D=UC(r.current).includes(E.animationName);if(E.target===t&&D&&(y("ANIMATION_END"),!a.current)){const B=t.style.animationFillMode;t.style.animationFillMode="forwards",x=w.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=B)})}},P=E=>{E.target===t&&(l.current=UC(r.current))};return t.addEventListener("animationstart",P),t.addEventListener("animationcancel",C),t.addEventListener("animationend",C),()=>{w.clearTimeout(x),t.removeEventListener("animationstart",P),t.removeEventListener("animationcancel",C),t.removeEventListener("animationend",C)}}else y("ANIMATION_END")},[t,y]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:L.useCallback(x=>{r.current=x?getComputedStyle(x):null,n(x)},[])}}function UC(e){return(e==null?void 0:e.animationName)||"none"}function m_e(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var g_e=f3[" useInsertionEffect ".trim().toString()]||Sl;function ny({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[a,l,h]=y_e({defaultProp:t,onChange:n}),i=e!==void 0,y=i?e:a;{const w=L.useRef(e!==void 0);L.useEffect(()=>{const C=w.current;C!==i&&console.warn(`${r} is changing from ${C?"controlled":"uncontrolled"} to ${i?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),w.current=i},[i,r])}const x=L.useCallback(w=>{var C;if(i){const P=v_e(w)?w(e):w;P!==e&&((C=h.current)==null||C.call(h,P))}else l(w)},[i,e,l,h]);return[y,x]}function y_e({defaultProp:e,onChange:t}){const[n,r]=L.useState(e),a=L.useRef(n),l=L.useRef(t);return g_e(()=>{l.current=t},[t]),L.useEffect(()=>{var h;a.current!==n&&((h=l.current)==null||h.call(l,n),a.current=n)},[n,a]),[n,r,l]}function v_e(e){return typeof e=="function"}var cQ=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),__e="VisuallyHidden",N3=L.forwardRef((e,t)=>v.jsx(Ei.span,{...e,ref:t,style:{...cQ,...e.style}}));N3.displayName=__e;var x_e=N3,fF="ToastProvider",[pF,b_e,w_e]=I3("Toast"),[uQ,NXe]=dd("Toast",[w_e]),[S_e,M3]=uQ(fF),dQ=e=>{const{__scopeToast:t,label:n="Notification",duration:r=5e3,swipeDirection:a="right",swipeThreshold:l=50,children:h}=e,[i,y]=L.useState(null),[x,w]=L.useState(0),C=L.useRef(!1),P=L.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${fF}\`. Expected non-empty \`string\`.`),v.jsx(pF.Provider,{scope:t,children:v.jsx(S_e,{scope:t,label:n,duration:r,swipeDirection:a,swipeThreshold:l,toastCount:x,viewport:i,onViewportChange:y,onToastAdd:L.useCallback(()=>w(E=>E+1),[]),onToastRemove:L.useCallback(()=>w(E=>E-1),[]),isFocusedToastEscapeKeyDownRef:C,isClosePausedRef:P,children:h})})};dQ.displayName=fF;var hQ="ToastViewport",A_e=["F8"],KD="toast.viewportPause",YD="toast.viewportResume",fQ=L.forwardRef((e,t)=>{const{__scopeToast:n,hotkey:r=A_e,label:a="Notifications ({hotkey})",...l}=e,h=M3(hQ,n),i=b_e(n),y=L.useRef(null),x=L.useRef(null),w=L.useRef(null),C=L.useRef(null),P=_s(t,C,h.onViewportChange),E=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),j=h.toastCount>0;L.useEffect(()=>{const B=F=>{var H;r.length!==0&&r.every(J=>F[J]||F.code===J)&&((H=C.current)==null||H.focus())};return document.addEventListener("keydown",B),()=>document.removeEventListener("keydown",B)},[r]),L.useEffect(()=>{const B=y.current,F=C.current;if(j&&B&&F){const $=()=>{if(!h.isClosePausedRef.current){const Q=new CustomEvent(KD);F.dispatchEvent(Q),h.isClosePausedRef.current=!0}},H=()=>{if(h.isClosePausedRef.current){const Q=new CustomEvent(YD);F.dispatchEvent(Q),h.isClosePausedRef.current=!1}},J=Q=>{!B.contains(Q.relatedTarget)&&H()},ee=()=>{B.contains(document.activeElement)||H()};return B.addEventListener("focusin",$),B.addEventListener("focusout",J),B.addEventListener("pointermove",$),B.addEventListener("pointerleave",ee),window.addEventListener("blur",$),window.addEventListener("focus",H),()=>{B.removeEventListener("focusin",$),B.removeEventListener("focusout",J),B.removeEventListener("pointermove",$),B.removeEventListener("pointerleave",ee),window.removeEventListener("blur",$),window.removeEventListener("focus",H)}}},[j,h.isClosePausedRef]);const D=L.useCallback(({tabbingDirection:B})=>{const $=i().map(H=>{const J=H.ref.current,ee=[J,...O_e(J)];return B==="forwards"?ee:ee.reverse()});return(B==="forwards"?$.reverse():$).flat()},[i]);return L.useEffect(()=>{const B=C.current;if(B){const F=$=>{var ee,Q,ne;const H=$.altKey||$.ctrlKey||$.metaKey;if($.key==="Tab"&&!H){const pe=document.activeElement,he=$.shiftKey;if($.target===B&&he){(ee=x.current)==null||ee.focus();return}const ge=D({tabbingDirection:he?"backwards":"forwards"}),Ce=ge.findIndex(xe=>xe===pe);xL(ge.slice(Ce+1))?$.preventDefault():he?(Q=x.current)==null||Q.focus():(ne=w.current)==null||ne.focus()}};return B.addEventListener("keydown",F),()=>B.removeEventListener("keydown",F)}},[i,D]),v.jsxs(d_e,{ref:y,role:"region","aria-label":a.replace("{hotkey}",E),tabIndex:-1,style:{pointerEvents:j?void 0:"none"},children:[j&&v.jsx(XD,{ref:x,onFocusFromOutsideViewport:()=>{const B=D({tabbingDirection:"forwards"});xL(B)}}),v.jsx(pF.Slot,{scope:n,children:v.jsx(Ei.ol,{tabIndex:-1,...l,ref:P})}),j&&v.jsx(XD,{ref:w,onFocusFromOutsideViewport:()=>{const B=D({tabbingDirection:"backwards"});xL(B)}})]})});fQ.displayName=hQ;var pQ="ToastFocusProxy",XD=L.forwardRef((e,t)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...a}=e,l=M3(pQ,n);return v.jsx(N3,{"aria-hidden":!0,tabIndex:0,...a,ref:t,style:{position:"fixed"},onFocus:h=>{var x;const i=h.relatedTarget;!((x=l.viewport)!=null&&x.contains(i))&&r()}})});XD.displayName=pQ;var b5="Toast",T_e="toast.swipeStart",C_e="toast.swipeMove",E_e="toast.swipeCancel",P_e="toast.swipeEnd",mQ=L.forwardRef((e,t)=>{const{forceMount:n,open:r,defaultOpen:a,onOpenChange:l,...h}=e,[i,y]=ny({prop:r,defaultProp:a??!0,onChange:l,caller:b5});return v.jsx(hd,{present:n||i,children:v.jsx(N_e,{open:i,...h,ref:t,onClose:()=>y(!1),onPause:ll(e.onPause),onResume:ll(e.onResume),onSwipeStart:Sr(e.onSwipeStart,x=>{x.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Sr(e.onSwipeMove,x=>{const{x:w,y:C}=x.detail.delta;x.currentTarget.setAttribute("data-swipe","move"),x.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${w}px`),x.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${C}px`)}),onSwipeCancel:Sr(e.onSwipeCancel,x=>{x.currentTarget.setAttribute("data-swipe","cancel"),x.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),x.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),x.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),x.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Sr(e.onSwipeEnd,x=>{const{x:w,y:C}=x.detail.delta;x.currentTarget.setAttribute("data-swipe","end"),x.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),x.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),x.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${w}px`),x.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${C}px`),y(!1)})})})});mQ.displayName=b5;var[k_e,I_e]=uQ(b5,{onClose(){}}),N_e=L.forwardRef((e,t)=>{const{__scopeToast:n,type:r="foreground",duration:a,open:l,onClose:h,onEscapeKeyDown:i,onPause:y,onResume:x,onSwipeStart:w,onSwipeMove:C,onSwipeCancel:P,onSwipeEnd:E,...j}=e,D=M3(b5,n),[B,F]=L.useState(null),$=_s(t,xe=>F(xe)),H=L.useRef(null),J=L.useRef(null),ee=a||D.duration,Q=L.useRef(0),ne=L.useRef(ee),pe=L.useRef(0),{onToastAdd:he,onToastRemove:we}=D,fe=ll(()=>{var Re;(B==null?void 0:B.contains(document.activeElement))&&((Re=D.viewport)==null||Re.focus()),h()}),ge=L.useCallback(xe=>{!xe||xe===1/0||(window.clearTimeout(pe.current),Q.current=new Date().getTime(),pe.current=window.setTimeout(fe,xe))},[fe]);L.useEffect(()=>{const xe=D.viewport;if(xe){const Re=()=>{ge(ne.current),x==null||x()},Qe=()=>{const et=new Date().getTime()-Q.current;ne.current=ne.current-et,window.clearTimeout(pe.current),y==null||y()};return xe.addEventListener(KD,Qe),xe.addEventListener(YD,Re),()=>{xe.removeEventListener(KD,Qe),xe.removeEventListener(YD,Re)}}},[D.viewport,ee,y,x,ge]),L.useEffect(()=>{l&&!D.isClosePausedRef.current&&ge(ee)},[l,ee,D.isClosePausedRef,ge]),L.useEffect(()=>(he(),()=>we()),[he,we]);const Ce=L.useMemo(()=>B?wQ(B):null,[B]);return D.viewport?v.jsxs(v.Fragment,{children:[Ce&&v.jsx(M_e,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:Ce}),v.jsx(k_e,{scope:n,onClose:fe,children:Sv.createPortal(v.jsx(pF.ItemSlot,{scope:n,children:v.jsx(u_e,{asChild:!0,onEscapeKeyDown:Sr(i,()=>{D.isFocusedToastEscapeKeyDownRef.current||fe(),D.isFocusedToastEscapeKeyDownRef.current=!1}),children:v.jsx(Ei.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":l?"open":"closed","data-swipe-direction":D.swipeDirection,...j,ref:$,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Sr(e.onKeyDown,xe=>{xe.key==="Escape"&&(i==null||i(xe.nativeEvent),xe.nativeEvent.defaultPrevented||(D.isFocusedToastEscapeKeyDownRef.current=!0,fe()))}),onPointerDown:Sr(e.onPointerDown,xe=>{xe.button===0&&(H.current={x:xe.clientX,y:xe.clientY})}),onPointerMove:Sr(e.onPointerMove,xe=>{if(!H.current)return;const Re=xe.clientX-H.current.x,Qe=xe.clientY-H.current.y,et=!!J.current,je=["left","right"].includes(D.swipeDirection),De=["left","up"].includes(D.swipeDirection)?Math.min:Math.max,Ct=je?De(0,Re):0,xt=je?0:De(0,Qe),me=xe.pointerType==="touch"?10:2,Ye={x:Ct,y:xt},nt={originalEvent:xe,delta:Ye};et?(J.current=Ye,VC(C_e,C,nt,{discrete:!1})):C9(Ye,D.swipeDirection,me)?(J.current=Ye,VC(T_e,w,nt,{discrete:!1}),xe.target.setPointerCapture(xe.pointerId)):(Math.abs(Re)>me||Math.abs(Qe)>me)&&(H.current=null)}),onPointerUp:Sr(e.onPointerUp,xe=>{const Re=J.current,Qe=xe.target;if(Qe.hasPointerCapture(xe.pointerId)&&Qe.releasePointerCapture(xe.pointerId),J.current=null,H.current=null,Re){const et=xe.currentTarget,je={originalEvent:xe,delta:Re};C9(Re,D.swipeDirection,D.swipeThreshold)?VC(P_e,E,je,{discrete:!0}):VC(E_e,P,je,{discrete:!0}),et.addEventListener("click",De=>De.preventDefault(),{once:!0})}})})})}),D.viewport)})]}):null}),M_e=e=>{const{__scopeToast:t,children:n,...r}=e,a=M3(b5,t),[l,h]=L.useState(!1),[i,y]=L.useState(!1);return R_e(()=>h(!0)),L.useEffect(()=>{const x=window.setTimeout(()=>y(!0),1e3);return()=>window.clearTimeout(x)},[]),i?null:v.jsx(x5,{asChild:!0,children:v.jsx(N3,{...r,children:l&&v.jsxs(v.Fragment,{children:[a.label," ",n]})})})},L_e="ToastTitle",gQ=L.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return v.jsx(Ei.div,{...r,ref:t})});gQ.displayName=L_e;var D_e="ToastDescription",yQ=L.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return v.jsx(Ei.div,{...r,ref:t})});yQ.displayName=D_e;var vQ="ToastAction",_Q=L.forwardRef((e,t)=>{const{altText:n,...r}=e;return n.trim()?v.jsx(bQ,{altText:n,asChild:!0,children:v.jsx(mF,{...r,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${vQ}\`. Expected non-empty \`string\`.`),null)});_Q.displayName=vQ;var xQ="ToastClose",mF=L.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e,a=I_e(xQ,n);return v.jsx(bQ,{asChild:!0,children:v.jsx(Ei.button,{type:"button",...r,ref:t,onClick:Sr(e.onClick,a.onClose)})})});mF.displayName=xQ;var bQ=L.forwardRef((e,t)=>{const{__scopeToast:n,altText:r,...a}=e;return v.jsx(Ei.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...a,ref:t})});function wQ(e){const t=[];return Array.from(e.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&t.push(r.textContent),j_e(r)){const a=r.ariaHidden||r.hidden||r.style.display==="none",l=r.dataset.radixToastAnnounceExclude==="";if(!a)if(l){const h=r.dataset.radixToastAnnounceAlt;h&&t.push(h)}else t.push(...wQ(r))}}),t}function VC(e,t,n,{discrete:r}){const a=n.originalEvent.currentTarget,l=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),r?hF(a,l):a.dispatchEvent(l)}var C9=(e,t,n=0)=>{const r=Math.abs(e.x),a=Math.abs(e.y),l=r>a;return t==="left"||t==="right"?l&&r>n:!l&&a>n};function R_e(e=()=>{}){const t=ll(e);Sl(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[t])}function j_e(e){return e.nodeType===e.ELEMENT_NODE}function O_e(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function xL(e){const t=document.activeElement;return e.some(n=>n===t?!0:(n.focus(),document.activeElement!==t))}var F_e=dQ,SQ=fQ,AQ=mQ,TQ=gQ,CQ=yQ,EQ=_Q,PQ=mF;function kQ(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=kQ(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function ra(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=kQ(e))&&(r&&(r+=" "),r+=t);return r}const E9=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,P9=ra,kx=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return P9(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:a,defaultVariants:l}=t,h=Object.keys(a).map(x=>{const w=n==null?void 0:n[x],C=l==null?void 0:l[x];if(w===null)return null;const P=E9(w)||E9(C);return a[x][P]}),i=n&&Object.entries(n).reduce((x,w)=>{let[C,P]=w;return P===void 0||(x[C]=P),x},{}),y=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((x,w)=>{let{class:C,className:P,...E}=w;return Object.entries(E).every(j=>{let[D,B]=j;return Array.isArray(B)?B.includes({...l,...i}[D]):{...l,...i}[D]===B})?[...x,C,P]:x},[]);return P9(e,h,y,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z_e=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),IQ=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var B_e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U_e=L.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:l,iconNode:h,...i},y)=>L.createElement("svg",{ref:y,...B_e,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:IQ("lucide",a),...i},[...h.map(([x,w])=>L.createElement(x,w)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tr=(e,t)=>{const n=L.forwardRef(({className:r,...a},l)=>L.createElement(U_e,{ref:l,iconNode:t,className:IQ(`lucide-${z_e(e)}`,r),...a}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CA=Tr("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V_e=Tr("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $_e=Tr("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q_e=Tr("Battery",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lv=Tr("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G_e=Tr("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pb=Tr("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NQ=Tr("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MQ=Tr("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EA=Tr("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gF=Tr("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H_e=Tr("ChartArea",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M7 11.207a.5.5 0 0 1 .146-.353l2-2a.5.5 0 0 1 .708 0l3.292 3.292a.5.5 0 0 0 .708 0l4.292-4.292a.5.5 0 0 1 .854.353V16a1 1 0 0 1-1 1H8a1 1 0 0 1-1-1z",key:"q0gr47"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kb=Tr("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W_e=Tr("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=Tr("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=Tr("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z_e=Tr("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LQ=Tr("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DQ=Tr("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FP=Tr("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wl=Tr("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mb=Tr("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K_e=Tr("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y_e=Tr("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vF=Tr("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w5=Tr("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X_e=Tr("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GE=Tr("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tu=Tr("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D3=Tr("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J_e=Tr("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RQ=Tr("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q_e=Tr("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const exe=Tr("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const txe=Tr("Gamepad2",[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _F=Tr("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PA=Tr("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zP=Tr("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J0=Tr("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nxe=Tr("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k9=Tr("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const od=Tr("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R3=Tr("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rxe=Tr("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ixe=Tr("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jQ=Tr("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OQ=Tr("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FQ=Tr("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sxe=Tr("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const axe=Tr("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cx=Tr("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yb=Tr("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J1=Tr("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zQ=Tr("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gb=Tr("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oxe=Tr("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xF=Tr("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $m=Tr("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S5=Tr("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kA=Tr("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lxe=Tr("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BP=Tr("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bF=Tr("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BQ=Tr("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wd=Tr("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cxe=Tr("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uxe=Tr("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wF=Tr("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SF=Tr("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ju=Tr("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=Tr("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HE=Tr("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dxe=Tr("Unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hxe=Tr("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fxe=Tr("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UQ=Tr("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WE=Tr("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VQ=Tr("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pxe=Tr("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cv=Tr("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AF=Tr("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mxe=Tr("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gxe=Tr("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),TF="-",yxe=e=>{const t=_xe(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:h=>{const i=h.split(TF);return i[0]===""&&i.length!==1&&i.shift(),$Q(i,t)||vxe(h)},getConflictingClassGroupIds:(h,i)=>{const y=n[h]||[];return i&&r[h]?[...y,...r[h]]:y}}},$Q=(e,t)=>{var h;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),a=r?$Q(e.slice(1),r):void 0;if(a)return a;if(t.validators.length===0)return;const l=e.join(TF);return(h=t.validators.find(({validator:i})=>i(l)))==null?void 0:h.classGroupId},I9=/^\[(.+)\]$/,vxe=e=>{if(I9.test(e)){const t=I9.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},_xe=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return bxe(Object.entries(e.classGroups),n).forEach(([l,h])=>{JD(h,r,l,t)}),r},JD=(e,t,n,r)=>{e.forEach(a=>{if(typeof a=="string"){const l=a===""?t:N9(t,a);l.classGroupId=n;return}if(typeof a=="function"){if(xxe(a)){JD(a(r),t,n,r);return}t.validators.push({validator:a,classGroupId:n});return}Object.entries(a).forEach(([l,h])=>{JD(h,N9(t,l),n,r)})})},N9=(e,t)=>{let n=e;return t.split(TF).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},xxe=e=>e.isThemeGetter,bxe=(e,t)=>t?e.map(([n,r])=>{const a=r.map(l=>typeof l=="string"?t+l:typeof l=="object"?Object.fromEntries(Object.entries(l).map(([h,i])=>[t+h,i])):l);return[n,a]}):e,wxe=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const a=(l,h)=>{n.set(l,h),t++,t>e&&(t=0,r=n,n=new Map)};return{get(l){let h=n.get(l);if(h!==void 0)return h;if((h=r.get(l))!==void 0)return a(l,h),h},set(l,h){n.has(l)?n.set(l,h):a(l,h)}}},qQ="!",Sxe=e=>{const{separator:t,experimentalParseClassName:n}=e,r=t.length===1,a=t[0],l=t.length,h=i=>{const y=[];let x=0,w=0,C;for(let B=0;B<i.length;B++){let F=i[B];if(x===0){if(F===a&&(r||i.slice(B,B+l)===t)){y.push(i.slice(w,B)),w=B+l;continue}if(F==="/"){C=B;continue}}F==="["?x++:F==="]"&&x--}const P=y.length===0?i:i.substring(w),E=P.startsWith(qQ),j=E?P.substring(1):P,D=C&&C>w?C-w:void 0;return{modifiers:y,hasImportantModifier:E,baseClassName:j,maybePostfixModifierPosition:D}};return n?i=>n({className:i,parseClassName:h}):h},Axe=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(r=>{r[0]==="["?(t.push(...n.sort(),r),n=[]):n.push(r)}),t.push(...n.sort()),t},Txe=e=>({cache:wxe(e.cacheSize),parseClassName:Sxe(e),...yxe(e)}),Cxe=/\s+/,Exe=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:a}=t,l=[],h=e.trim().split(Cxe);let i="";for(let y=h.length-1;y>=0;y-=1){const x=h[y],{modifiers:w,hasImportantModifier:C,baseClassName:P,maybePostfixModifierPosition:E}=n(x);let j=!!E,D=r(j?P.substring(0,E):P);if(!D){if(!j){i=x+(i.length>0?" "+i:i);continue}if(D=r(P),!D){i=x+(i.length>0?" "+i:i);continue}j=!1}const B=Axe(w).join(":"),F=C?B+qQ:B,$=F+D;if(l.includes($))continue;l.push($);const H=a(D,j);for(let J=0;J<H.length;++J){const ee=H[J];l.push(F+ee)}i=x+(i.length>0?" "+i:i)}return i};function Pxe(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=GQ(t))&&(r&&(r+=" "),r+=n);return r}const GQ=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=GQ(e[r]))&&(n&&(n+=" "),n+=t);return n};function kxe(e,...t){let n,r,a,l=h;function h(y){const x=t.reduce((w,C)=>C(w),e());return n=Txe(x),r=n.cache.get,a=n.cache.set,l=i,i(y)}function i(y){const x=r(y);if(x)return x;const w=Exe(y,n);return a(y,w),w}return function(){return l(Pxe.apply(null,arguments))}}const xo=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},HQ=/^\[(?:([a-z-]+):)?(.+)\]$/i,Ixe=/^\d+\/\d+$/,Nxe=new Set(["px","full","screen"]),Mxe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Lxe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Dxe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Rxe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,jxe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Cg=e=>yb(e)||Nxe.has(e)||Ixe.test(e),u0=e=>Tw(e,"length",qxe),yb=e=>!!e&&!Number.isNaN(Number(e)),bL=e=>Tw(e,"number",yb),aS=e=>!!e&&Number.isInteger(Number(e)),Oxe=e=>e.endsWith("%")&&yb(e.slice(0,-1)),ys=e=>HQ.test(e),d0=e=>Mxe.test(e),Fxe=new Set(["length","size","percentage"]),zxe=e=>Tw(e,Fxe,WQ),Bxe=e=>Tw(e,"position",WQ),Uxe=new Set(["image","url"]),Vxe=e=>Tw(e,Uxe,Hxe),$xe=e=>Tw(e,"",Gxe),oS=()=>!0,Tw=(e,t,n)=>{const r=HQ.exec(e);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):n(r[2]):!1},qxe=e=>Lxe.test(e)&&!Dxe.test(e),WQ=()=>!1,Gxe=e=>Rxe.test(e),Hxe=e=>jxe.test(e),Wxe=()=>{const e=xo("colors"),t=xo("spacing"),n=xo("blur"),r=xo("brightness"),a=xo("borderColor"),l=xo("borderRadius"),h=xo("borderSpacing"),i=xo("borderWidth"),y=xo("contrast"),x=xo("grayscale"),w=xo("hueRotate"),C=xo("invert"),P=xo("gap"),E=xo("gradientColorStops"),j=xo("gradientColorStopPositions"),D=xo("inset"),B=xo("margin"),F=xo("opacity"),$=xo("padding"),H=xo("saturate"),J=xo("scale"),ee=xo("sepia"),Q=xo("skew"),ne=xo("space"),pe=xo("translate"),he=()=>["auto","contain","none"],we=()=>["auto","hidden","clip","visible","scroll"],fe=()=>["auto",ys,t],ge=()=>[ys,t],Ce=()=>["",Cg,u0],xe=()=>["auto",yb,ys],Re=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Qe=()=>["solid","dashed","dotted","double","none"],et=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],je=()=>["start","end","center","between","around","evenly","stretch"],De=()=>["","0",ys],Ct=()=>["auto","avoid","all","avoid-page","page","left","right","column"],xt=()=>[yb,ys];return{cacheSize:500,separator:":",theme:{colors:[oS],spacing:[Cg,u0],blur:["none","",d0,ys],brightness:xt(),borderColor:[e],borderRadius:["none","","full",d0,ys],borderSpacing:ge(),borderWidth:Ce(),contrast:xt(),grayscale:De(),hueRotate:xt(),invert:De(),gap:ge(),gradientColorStops:[e],gradientColorStopPositions:[Oxe,u0],inset:fe(),margin:fe(),opacity:xt(),padding:ge(),saturate:xt(),scale:xt(),sepia:De(),skew:xt(),space:ge(),translate:ge()},classGroups:{aspect:[{aspect:["auto","square","video",ys]}],container:["container"],columns:[{columns:[d0]}],"break-after":[{"break-after":Ct()}],"break-before":[{"break-before":Ct()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Re(),ys]}],overflow:[{overflow:we()}],"overflow-x":[{"overflow-x":we()}],"overflow-y":[{"overflow-y":we()}],overscroll:[{overscroll:he()}],"overscroll-x":[{"overscroll-x":he()}],"overscroll-y":[{"overscroll-y":he()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[D]}],"inset-x":[{"inset-x":[D]}],"inset-y":[{"inset-y":[D]}],start:[{start:[D]}],end:[{end:[D]}],top:[{top:[D]}],right:[{right:[D]}],bottom:[{bottom:[D]}],left:[{left:[D]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",aS,ys]}],basis:[{basis:fe()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ys]}],grow:[{grow:De()}],shrink:[{shrink:De()}],order:[{order:["first","last","none",aS,ys]}],"grid-cols":[{"grid-cols":[oS]}],"col-start-end":[{col:["auto",{span:["full",aS,ys]},ys]}],"col-start":[{"col-start":xe()}],"col-end":[{"col-end":xe()}],"grid-rows":[{"grid-rows":[oS]}],"row-start-end":[{row:["auto",{span:[aS,ys]},ys]}],"row-start":[{"row-start":xe()}],"row-end":[{"row-end":xe()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ys]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ys]}],gap:[{gap:[P]}],"gap-x":[{"gap-x":[P]}],"gap-y":[{"gap-y":[P]}],"justify-content":[{justify:["normal",...je()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...je(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...je(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[$]}],px:[{px:[$]}],py:[{py:[$]}],ps:[{ps:[$]}],pe:[{pe:[$]}],pt:[{pt:[$]}],pr:[{pr:[$]}],pb:[{pb:[$]}],pl:[{pl:[$]}],m:[{m:[B]}],mx:[{mx:[B]}],my:[{my:[B]}],ms:[{ms:[B]}],me:[{me:[B]}],mt:[{mt:[B]}],mr:[{mr:[B]}],mb:[{mb:[B]}],ml:[{ml:[B]}],"space-x":[{"space-x":[ne]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[ne]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ys,t]}],"min-w":[{"min-w":[ys,t,"min","max","fit"]}],"max-w":[{"max-w":[ys,t,"none","full","min","max","fit","prose",{screen:[d0]},d0]}],h:[{h:[ys,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ys,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ys,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ys,t,"auto","min","max","fit"]}],"font-size":[{text:["base",d0,u0]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",bL]}],"font-family":[{font:[oS]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ys]}],"line-clamp":[{"line-clamp":["none",yb,bL]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Cg,ys]}],"list-image":[{"list-image":["none",ys]}],"list-style-type":[{list:["none","disc","decimal",ys]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[F]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[F]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Qe(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Cg,u0]}],"underline-offset":[{"underline-offset":["auto",Cg,ys]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ge()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ys]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ys]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[F]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Re(),Bxe]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",zxe]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Vxe]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[j]}],"gradient-via-pos":[{via:[j]}],"gradient-to-pos":[{to:[j]}],"gradient-from":[{from:[E]}],"gradient-via":[{via:[E]}],"gradient-to":[{to:[E]}],rounded:[{rounded:[l]}],"rounded-s":[{"rounded-s":[l]}],"rounded-e":[{"rounded-e":[l]}],"rounded-t":[{"rounded-t":[l]}],"rounded-r":[{"rounded-r":[l]}],"rounded-b":[{"rounded-b":[l]}],"rounded-l":[{"rounded-l":[l]}],"rounded-ss":[{"rounded-ss":[l]}],"rounded-se":[{"rounded-se":[l]}],"rounded-ee":[{"rounded-ee":[l]}],"rounded-es":[{"rounded-es":[l]}],"rounded-tl":[{"rounded-tl":[l]}],"rounded-tr":[{"rounded-tr":[l]}],"rounded-br":[{"rounded-br":[l]}],"rounded-bl":[{"rounded-bl":[l]}],"border-w":[{border:[i]}],"border-w-x":[{"border-x":[i]}],"border-w-y":[{"border-y":[i]}],"border-w-s":[{"border-s":[i]}],"border-w-e":[{"border-e":[i]}],"border-w-t":[{"border-t":[i]}],"border-w-r":[{"border-r":[i]}],"border-w-b":[{"border-b":[i]}],"border-w-l":[{"border-l":[i]}],"border-opacity":[{"border-opacity":[F]}],"border-style":[{border:[...Qe(),"hidden"]}],"divide-x":[{"divide-x":[i]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[i]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[F]}],"divide-style":[{divide:Qe()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...Qe()]}],"outline-offset":[{"outline-offset":[Cg,ys]}],"outline-w":[{outline:[Cg,u0]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:Ce()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[F]}],"ring-offset-w":[{"ring-offset":[Cg,u0]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",d0,$xe]}],"shadow-color":[{shadow:[oS]}],opacity:[{opacity:[F]}],"mix-blend":[{"mix-blend":[...et(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":et()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[y]}],"drop-shadow":[{"drop-shadow":["","none",d0,ys]}],grayscale:[{grayscale:[x]}],"hue-rotate":[{"hue-rotate":[w]}],invert:[{invert:[C]}],saturate:[{saturate:[H]}],sepia:[{sepia:[ee]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[y]}],"backdrop-grayscale":[{"backdrop-grayscale":[x]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[w]}],"backdrop-invert":[{"backdrop-invert":[C]}],"backdrop-opacity":[{"backdrop-opacity":[F]}],"backdrop-saturate":[{"backdrop-saturate":[H]}],"backdrop-sepia":[{"backdrop-sepia":[ee]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[h]}],"border-spacing-x":[{"border-spacing-x":[h]}],"border-spacing-y":[{"border-spacing-y":[h]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ys]}],duration:[{duration:xt()}],ease:[{ease:["linear","in","out","in-out",ys]}],delay:[{delay:xt()}],animate:[{animate:["none","spin","ping","pulse","bounce",ys]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[J]}],"scale-x":[{"scale-x":[J]}],"scale-y":[{"scale-y":[J]}],rotate:[{rotate:[aS,ys]}],"translate-x":[{"translate-x":[pe]}],"translate-y":[{"translate-y":[pe]}],"skew-x":[{"skew-x":[Q]}],"skew-y":[{"skew-y":[Q]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ys]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ys]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ge()}],"scroll-mx":[{"scroll-mx":ge()}],"scroll-my":[{"scroll-my":ge()}],"scroll-ms":[{"scroll-ms":ge()}],"scroll-me":[{"scroll-me":ge()}],"scroll-mt":[{"scroll-mt":ge()}],"scroll-mr":[{"scroll-mr":ge()}],"scroll-mb":[{"scroll-mb":ge()}],"scroll-ml":[{"scroll-ml":ge()}],"scroll-p":[{"scroll-p":ge()}],"scroll-px":[{"scroll-px":ge()}],"scroll-py":[{"scroll-py":ge()}],"scroll-ps":[{"scroll-ps":ge()}],"scroll-pe":[{"scroll-pe":ge()}],"scroll-pt":[{"scroll-pt":ge()}],"scroll-pr":[{"scroll-pr":ge()}],"scroll-pb":[{"scroll-pb":ge()}],"scroll-pl":[{"scroll-pl":ge()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ys]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Cg,u0,bL]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Zxe=kxe(Wxe);function Xn(...e){return Zxe(ra(e))}const Kxe=F_e,ZQ=L.forwardRef(({className:e,...t},n)=>v.jsx(SQ,{ref:n,className:Xn("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));ZQ.displayName=SQ.displayName;const Yxe=kx("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border-gray-700 bg-gray-800 text-white",destructive:"border-red-700 bg-gray-800 text-white",success:"border-green-700 bg-gray-800 text-white",warning:"border-yellow-700 bg-gray-800 text-white"}},defaultVariants:{variant:"default"}}),KQ=L.forwardRef(({className:e,variant:t,...n},r)=>v.jsx(AQ,{ref:r,className:Xn(Yxe({variant:t}),e),...n}));KQ.displayName=AQ.displayName;const Xxe=L.forwardRef(({className:e,...t},n)=>v.jsx(EQ,{ref:n,className:Xn("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",e),...t}));Xxe.displayName=EQ.displayName;const YQ=L.forwardRef(({className:e,...t},n)=>v.jsx(PQ,{ref:n,className:Xn("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:v.jsx(cv,{className:"h-4 w-4"})}));YQ.displayName=PQ.displayName;const XQ=L.forwardRef(({className:e,...t},n)=>v.jsx(TQ,{ref:n,className:Xn("text-sm font-semibold",e),...t}));XQ.displayName=TQ.displayName;const JQ=L.forwardRef(({className:e,...t},n)=>v.jsx(CQ,{ref:n,className:Xn("text-sm opacity-90",e),...t}));JQ.displayName=CQ.displayName;function Jxe(){const{toasts:e}=Kve();return v.jsxs(Kxe,{children:[e.map(function({id:t,title:n,description:r,action:a,...l}){return v.jsxs(KQ,{...l,children:[v.jsxs("div",{className:"grid gap-1",children:[n&&v.jsx(XQ,{children:n}),r&&v.jsx(JQ,{children:r})]}),a,v.jsx(YQ,{})]},t)}),v.jsx(ZQ,{})]})}var M9=["light","dark"],Qxe="(prefers-color-scheme: dark)",e1e=L.createContext(void 0),t1e={setTheme:e=>{},themes:[]},n1e=()=>{var e;return(e=L.useContext(e1e))!=null?e:t1e};L.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:a,defaultTheme:l,value:h,attrs:i,nonce:y})=>{let x=l==="system",w=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${i.map(j=>`'${j}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,C=a?M9.includes(l)&&l?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${l}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",P=(j,D=!1,B=!0)=>{let F=h?h[j]:j,$=D?j+"|| ''":`'${F}'`,H="";return a&&B&&!D&&M9.includes(j)&&(H+=`d.style.colorScheme = '${j}';`),n==="class"?D||F?H+=`c.add(${$})`:H+="null":F&&(H+=`d[s](n,${$})`),H},E=e?`!function(){${w}${P(e)}}()`:r?`!function(){try{${w}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${x})){var t='${Qxe}',m=window.matchMedia(t);if(m.media!==t||m.matches){${P("dark")}}else{${P("light")}}}else if(e){${h?`var x=${JSON.stringify(h)};`:""}${P(h?"x[e]":"e",!0)}}${x?"":"else{"+P(l,!1,!1)+"}"}${C}}catch(e){}}()`:`!function(){try{${w}var e=localStorage.getItem('${t}');if(e){${h?`var x=${JSON.stringify(h)};`:""}${P(h?"x[e]":"e",!0)}}else{${P(l,!1,!1)};}${C}}catch(t){}}();`;return L.createElement("script",{nonce:y,dangerouslySetInnerHTML:{__html:E}})});var r1e=e=>{switch(e){case"success":return a1e;case"info":return l1e;case"warning":return o1e;case"error":return c1e;default:return null}},i1e=Array(12).fill(0),s1e=({visible:e,className:t})=>ir.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},ir.createElement("div",{className:"sonner-spinner"},i1e.map((n,r)=>ir.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),a1e=ir.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ir.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),o1e=ir.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ir.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),l1e=ir.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ir.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),c1e=ir.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ir.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),u1e=ir.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ir.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ir.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),d1e=()=>{let[e,t]=ir.useState(document.hidden);return ir.useEffect(()=>{let n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},QD=1,h1e=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;let{message:r,...a}=t,l=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:QD++,h=this.toasts.find(y=>y.id===l),i=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(l)&&this.dismissedToasts.delete(l),h?this.toasts=this.toasts.map(y=>y.id===l?(this.publish({...y,...t,id:l,title:r}),{...y,...t,id:l,dismissible:i,title:r}):y):this.addToast({title:r,...a,dismissible:i,id:l}),l},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),this.subscribers.forEach(n=>n({id:t,dismiss:!0})),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));let a=t instanceof Promise?t:t(),l=r!==void 0,h,i=a.then(async x=>{if(h=["resolve",x],ir.isValidElement(x))l=!1,this.create({id:r,type:"default",message:x});else if(p1e(x)&&!x.ok){l=!1;let w=typeof n.error=="function"?await n.error(`HTTP error! status: ${x.status}`):n.error,C=typeof n.description=="function"?await n.description(`HTTP error! status: ${x.status}`):n.description;this.create({id:r,type:"error",message:w,description:C})}else if(n.success!==void 0){l=!1;let w=typeof n.success=="function"?await n.success(x):n.success,C=typeof n.description=="function"?await n.description(x):n.description;this.create({id:r,type:"success",message:w,description:C})}}).catch(async x=>{if(h=["reject",x],n.error!==void 0){l=!1;let w=typeof n.error=="function"?await n.error(x):n.error,C=typeof n.description=="function"?await n.description(x):n.description;this.create({id:r,type:"error",message:w,description:C})}}).finally(()=>{var x;l&&(this.dismiss(r),r=void 0),(x=n.finally)==null||x.call(n)}),y=()=>new Promise((x,w)=>i.then(()=>h[0]==="reject"?w(h[1]):x(h[1])).catch(w));return typeof r!="string"&&typeof r!="number"?{unwrap:y}:Object.assign(r,{unwrap:y})},this.custom=(t,n)=>{let r=(n==null?void 0:n.id)||QD++;return this.create({jsx:t(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Rd=new h1e,f1e=(e,t)=>{let n=(t==null?void 0:t.id)||QD++;return Rd.addToast({title:e,...t,id:n}),n},p1e=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",m1e=f1e,g1e=()=>Rd.toasts,y1e=()=>Rd.getActiveToasts(),Gn=Object.assign(m1e,{success:Rd.success,info:Rd.info,warning:Rd.warning,error:Rd.error,custom:Rd.custom,message:Rd.message,promise:Rd.promise,dismiss:Rd.dismiss,loading:Rd.loading},{getHistory:g1e,getToasts:y1e});function v1e(e,{insertAt:t}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}v1e(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function $C(e){return e.label!==void 0}var _1e=3,x1e="32px",b1e="16px",L9=4e3,w1e=356,S1e=14,A1e=20,T1e=200;function sp(...e){return e.filter(Boolean).join(" ")}function C1e(e){let[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}var E1e=e=>{var t,n,r,a,l,h,i,y,x,w,C;let{invert:P,toast:E,unstyled:j,interacting:D,setHeights:B,visibleToasts:F,heights:$,index:H,toasts:J,expanded:ee,removeToast:Q,defaultRichColors:ne,closeButton:pe,style:he,cancelButtonStyle:we,actionButtonStyle:fe,className:ge="",descriptionClassName:Ce="",duration:xe,position:Re,gap:Qe,loadingIcon:et,expandByDefault:je,classNames:De,icons:Ct,closeButtonAriaLabel:xt="Close toast",pauseWhenPageIsHidden:me}=e,[Ye,nt]=ir.useState(null),[vt,gt]=ir.useState(null),[dt,At]=ir.useState(!1),[mt,Pt]=ir.useState(!1),[Ht,Ot]=ir.useState(!1),[Un,Kt]=ir.useState(!1),[st,Dr]=ir.useState(!1),[Or,Br]=ir.useState(0),[On,ht]=ir.useState(0),wt=ir.useRef(E.duration||xe||L9),Wt=ir.useRef(null),xn=ir.useRef(null),Rn=H===0,Sn=H+1<=F,Mn=E.type,Ar=E.dismissible!==!1,Pr=E.className||"",wr=E.descriptionClassName||"",Qr=ir.useMemo(()=>$.findIndex(Pi=>Pi.toastId===E.id)||0,[$,E.id]),dr=ir.useMemo(()=>{var Pi;return(Pi=E.closeButton)!=null?Pi:pe},[E.closeButton,pe]),Hi=ir.useMemo(()=>E.duration||xe||L9,[E.duration,xe]),Bi=ir.useRef(0),Cr=ir.useRef(0),fi=ir.useRef(0),Cn=ir.useRef(null),[bn,fr]=Re.split("-"),Ur=ir.useMemo(()=>$.reduce((Pi,zt,es)=>es>=Qr?Pi:Pi+zt.height,0),[$,Qr]),Xs=d1e(),_a=E.invert||P,ts=Mn==="loading";Cr.current=ir.useMemo(()=>Qr*Qe+Ur,[Qr,Ur]),ir.useEffect(()=>{wt.current=Hi},[Hi]),ir.useEffect(()=>{At(!0)},[]),ir.useEffect(()=>{let Pi=xn.current;if(Pi){let zt=Pi.getBoundingClientRect().height;return ht(zt),B(es=>[{toastId:E.id,height:zt,position:E.position},...es]),()=>B(es=>es.filter(ja=>ja.toastId!==E.id))}},[B,E.id]),ir.useLayoutEffect(()=>{if(!dt)return;let Pi=xn.current,zt=Pi.style.height;Pi.style.height="auto";let es=Pi.getBoundingClientRect().height;Pi.style.height=zt,ht(es),B(ja=>ja.find(qr=>qr.toastId===E.id)?ja.map(qr=>qr.toastId===E.id?{...qr,height:es}:qr):[{toastId:E.id,height:es,position:E.position},...ja])},[dt,E.title,E.description,B,E.id]);let _i=ir.useCallback(()=>{Pt(!0),Br(Cr.current),B(Pi=>Pi.filter(zt=>zt.toastId!==E.id)),setTimeout(()=>{Q(E)},T1e)},[E,Q,B,Cr]);ir.useEffect(()=>{if(E.promise&&Mn==="loading"||E.duration===1/0||E.type==="loading")return;let Pi;return ee||D||me&&Xs?(()=>{if(fi.current<Bi.current){let zt=new Date().getTime()-Bi.current;wt.current=wt.current-zt}fi.current=new Date().getTime()})():wt.current!==1/0&&(Bi.current=new Date().getTime(),Pi=setTimeout(()=>{var zt;(zt=E.onAutoClose)==null||zt.call(E,E),_i()},wt.current)),()=>clearTimeout(Pi)},[ee,D,E,Mn,me,Xs,_i]),ir.useEffect(()=>{E.delete&&_i()},[_i,E.delete]);function xs(){var Pi,zt,es;return Ct!=null&&Ct.loading?ir.createElement("div",{className:sp(De==null?void 0:De.loader,(Pi=E==null?void 0:E.classNames)==null?void 0:Pi.loader,"sonner-loader"),"data-visible":Mn==="loading"},Ct.loading):et?ir.createElement("div",{className:sp(De==null?void 0:De.loader,(zt=E==null?void 0:E.classNames)==null?void 0:zt.loader,"sonner-loader"),"data-visible":Mn==="loading"},et):ir.createElement(s1e,{className:sp(De==null?void 0:De.loader,(es=E==null?void 0:E.classNames)==null?void 0:es.loader),visible:Mn==="loading"})}return ir.createElement("li",{tabIndex:0,ref:xn,className:sp(ge,Pr,De==null?void 0:De.toast,(t=E==null?void 0:E.classNames)==null?void 0:t.toast,De==null?void 0:De.default,De==null?void 0:De[Mn],(n=E==null?void 0:E.classNames)==null?void 0:n[Mn]),"data-sonner-toast":"","data-rich-colors":(r=E.richColors)!=null?r:ne,"data-styled":!(E.jsx||E.unstyled||j),"data-mounted":dt,"data-promise":!!E.promise,"data-swiped":st,"data-removed":mt,"data-visible":Sn,"data-y-position":bn,"data-x-position":fr,"data-index":H,"data-front":Rn,"data-swiping":Ht,"data-dismissible":Ar,"data-type":Mn,"data-invert":_a,"data-swipe-out":Un,"data-swipe-direction":vt,"data-expanded":!!(ee||je&&dt),style:{"--index":H,"--toasts-before":H,"--z-index":J.length-H,"--offset":`${mt?Or:Cr.current}px`,"--initial-height":je?"auto":`${On}px`,...he,...E.style},onDragEnd:()=>{Ot(!1),nt(null),Cn.current=null},onPointerDown:Pi=>{ts||!Ar||(Wt.current=new Date,Br(Cr.current),Pi.target.setPointerCapture(Pi.pointerId),Pi.target.tagName!=="BUTTON"&&(Ot(!0),Cn.current={x:Pi.clientX,y:Pi.clientY}))},onPointerUp:()=>{var Pi,zt,es,ja;if(Un||!Ar)return;Cn.current=null;let qr=Number(((Pi=xn.current)==null?void 0:Pi.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),lt=Number(((zt=xn.current)==null?void 0:zt.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),de=new Date().getTime()-((es=Wt.current)==null?void 0:es.getTime()),_e=Ye==="x"?qr:lt,Ie=Math.abs(_e)/de;if(Math.abs(_e)>=A1e||Ie>.11){Br(Cr.current),(ja=E.onDismiss)==null||ja.call(E,E),gt(Ye==="x"?qr>0?"right":"left":lt>0?"down":"up"),_i(),Kt(!0),Dr(!1);return}Ot(!1),nt(null)},onPointerMove:Pi=>{var zt,es,ja,qr;if(!Cn.current||!Ar||((zt=window.getSelection())==null?void 0:zt.toString().length)>0)return;let lt=Pi.clientY-Cn.current.y,de=Pi.clientX-Cn.current.x,_e=(es=e.swipeDirections)!=null?es:C1e(Re);!Ye&&(Math.abs(de)>1||Math.abs(lt)>1)&&nt(Math.abs(de)>Math.abs(lt)?"x":"y");let Ie={x:0,y:0};Ye==="y"?(_e.includes("top")||_e.includes("bottom"))&&(_e.includes("top")&&lt<0||_e.includes("bottom")&&lt>0)&&(Ie.y=lt):Ye==="x"&&(_e.includes("left")||_e.includes("right"))&&(_e.includes("left")&&de<0||_e.includes("right")&&de>0)&&(Ie.x=de),(Math.abs(Ie.x)>0||Math.abs(Ie.y)>0)&&Dr(!0),(ja=xn.current)==null||ja.style.setProperty("--swipe-amount-x",`${Ie.x}px`),(qr=xn.current)==null||qr.style.setProperty("--swipe-amount-y",`${Ie.y}px`)}},dr&&!E.jsx?ir.createElement("button",{"aria-label":xt,"data-disabled":ts,"data-close-button":!0,onClick:ts||!Ar?()=>{}:()=>{var Pi;_i(),(Pi=E.onDismiss)==null||Pi.call(E,E)},className:sp(De==null?void 0:De.closeButton,(a=E==null?void 0:E.classNames)==null?void 0:a.closeButton)},(l=Ct==null?void 0:Ct.close)!=null?l:u1e):null,E.jsx||L.isValidElement(E.title)?E.jsx?E.jsx:typeof E.title=="function"?E.title():E.title:ir.createElement(ir.Fragment,null,Mn||E.icon||E.promise?ir.createElement("div",{"data-icon":"",className:sp(De==null?void 0:De.icon,(h=E==null?void 0:E.classNames)==null?void 0:h.icon)},E.promise||E.type==="loading"&&!E.icon?E.icon||xs():null,E.type!=="loading"?E.icon||(Ct==null?void 0:Ct[Mn])||r1e(Mn):null):null,ir.createElement("div",{"data-content":"",className:sp(De==null?void 0:De.content,(i=E==null?void 0:E.classNames)==null?void 0:i.content)},ir.createElement("div",{"data-title":"",className:sp(De==null?void 0:De.title,(y=E==null?void 0:E.classNames)==null?void 0:y.title)},typeof E.title=="function"?E.title():E.title),E.description?ir.createElement("div",{"data-description":"",className:sp(Ce,wr,De==null?void 0:De.description,(x=E==null?void 0:E.classNames)==null?void 0:x.description)},typeof E.description=="function"?E.description():E.description):null),L.isValidElement(E.cancel)?E.cancel:E.cancel&&$C(E.cancel)?ir.createElement("button",{"data-button":!0,"data-cancel":!0,style:E.cancelButtonStyle||we,onClick:Pi=>{var zt,es;$C(E.cancel)&&Ar&&((es=(zt=E.cancel).onClick)==null||es.call(zt,Pi),_i())},className:sp(De==null?void 0:De.cancelButton,(w=E==null?void 0:E.classNames)==null?void 0:w.cancelButton)},E.cancel.label):null,L.isValidElement(E.action)?E.action:E.action&&$C(E.action)?ir.createElement("button",{"data-button":!0,"data-action":!0,style:E.actionButtonStyle||fe,onClick:Pi=>{var zt,es;$C(E.action)&&((es=(zt=E.action).onClick)==null||es.call(zt,Pi),!Pi.defaultPrevented&&_i())},className:sp(De==null?void 0:De.actionButton,(C=E==null?void 0:E.classNames)==null?void 0:C.actionButton)},E.action.label):null))};function D9(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function P1e(e,t){let n={};return[e,t].forEach((r,a)=>{let l=a===1,h=l?"--mobile-offset":"--offset",i=l?b1e:x1e;function y(x){["top","right","bottom","left"].forEach(w=>{n[`${h}-${w}`]=typeof x=="number"?`${x}px`:x})}typeof r=="number"||typeof r=="string"?y(r):typeof r=="object"?["top","right","bottom","left"].forEach(x=>{r[x]===void 0?n[`${h}-${x}`]=i:n[`${h}-${x}`]=typeof r[x]=="number"?`${r[x]}px`:r[x]}):y(i)}),n}var k1e=L.forwardRef(function(e,t){let{invert:n,position:r="bottom-right",hotkey:a=["altKey","KeyT"],expand:l,closeButton:h,className:i,offset:y,mobileOffset:x,theme:w="light",richColors:C,duration:P,style:E,visibleToasts:j=_1e,toastOptions:D,dir:B=D9(),gap:F=S1e,loadingIcon:$,icons:H,containerAriaLabel:J="Notifications",pauseWhenPageIsHidden:ee}=e,[Q,ne]=ir.useState([]),pe=ir.useMemo(()=>Array.from(new Set([r].concat(Q.filter(me=>me.position).map(me=>me.position)))),[Q,r]),[he,we]=ir.useState([]),[fe,ge]=ir.useState(!1),[Ce,xe]=ir.useState(!1),[Re,Qe]=ir.useState(w!=="system"?w:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),et=ir.useRef(null),je=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),De=ir.useRef(null),Ct=ir.useRef(!1),xt=ir.useCallback(me=>{ne(Ye=>{var nt;return(nt=Ye.find(vt=>vt.id===me.id))!=null&&nt.delete||Rd.dismiss(me.id),Ye.filter(({id:vt})=>vt!==me.id)})},[]);return ir.useEffect(()=>Rd.subscribe(me=>{if(me.dismiss){ne(Ye=>Ye.map(nt=>nt.id===me.id?{...nt,delete:!0}:nt));return}setTimeout(()=>{nQ.flushSync(()=>{ne(Ye=>{let nt=Ye.findIndex(vt=>vt.id===me.id);return nt!==-1?[...Ye.slice(0,nt),{...Ye[nt],...me},...Ye.slice(nt+1)]:[me,...Ye]})})})}),[]),ir.useEffect(()=>{if(w!=="system"){Qe(w);return}if(w==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Qe("dark"):Qe("light")),typeof window>"u")return;let me=window.matchMedia("(prefers-color-scheme: dark)");try{me.addEventListener("change",({matches:Ye})=>{Qe(Ye?"dark":"light")})}catch{me.addListener(({matches:nt})=>{try{Qe(nt?"dark":"light")}catch(vt){console.error(vt)}})}},[w]),ir.useEffect(()=>{Q.length<=1&&ge(!1)},[Q]),ir.useEffect(()=>{let me=Ye=>{var nt,vt;a.every(gt=>Ye[gt]||Ye.code===gt)&&(ge(!0),(nt=et.current)==null||nt.focus()),Ye.code==="Escape"&&(document.activeElement===et.current||(vt=et.current)!=null&&vt.contains(document.activeElement))&&ge(!1)};return document.addEventListener("keydown",me),()=>document.removeEventListener("keydown",me)},[a]),ir.useEffect(()=>{if(et.current)return()=>{De.current&&(De.current.focus({preventScroll:!0}),De.current=null,Ct.current=!1)}},[et.current]),ir.createElement("section",{ref:t,"aria-label":`${J} ${je}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},pe.map((me,Ye)=>{var nt;let[vt,gt]=me.split("-");return Q.length?ir.createElement("ol",{key:me,dir:B==="auto"?D9():B,tabIndex:-1,ref:et,className:i,"data-sonner-toaster":!0,"data-theme":Re,"data-y-position":vt,"data-lifted":fe&&Q.length>1&&!l,"data-x-position":gt,style:{"--front-toast-height":`${((nt=he[0])==null?void 0:nt.height)||0}px`,"--width":`${w1e}px`,"--gap":`${F}px`,...E,...P1e(y,x)},onBlur:dt=>{Ct.current&&!dt.currentTarget.contains(dt.relatedTarget)&&(Ct.current=!1,De.current&&(De.current.focus({preventScroll:!0}),De.current=null))},onFocus:dt=>{dt.target instanceof HTMLElement&&dt.target.dataset.dismissible==="false"||Ct.current||(Ct.current=!0,De.current=dt.relatedTarget)},onMouseEnter:()=>ge(!0),onMouseMove:()=>ge(!0),onMouseLeave:()=>{Ce||ge(!1)},onDragEnd:()=>ge(!1),onPointerDown:dt=>{dt.target instanceof HTMLElement&&dt.target.dataset.dismissible==="false"||xe(!0)},onPointerUp:()=>xe(!1)},Q.filter(dt=>!dt.position&&Ye===0||dt.position===me).map((dt,At)=>{var mt,Pt;return ir.createElement(E1e,{key:dt.id,icons:H,index:At,toast:dt,defaultRichColors:C,duration:(mt=D==null?void 0:D.duration)!=null?mt:P,className:D==null?void 0:D.className,descriptionClassName:D==null?void 0:D.descriptionClassName,invert:n,visibleToasts:j,closeButton:(Pt=D==null?void 0:D.closeButton)!=null?Pt:h,interacting:Ce,position:me,style:D==null?void 0:D.style,unstyled:D==null?void 0:D.unstyled,classNames:D==null?void 0:D.classNames,cancelButtonStyle:D==null?void 0:D.cancelButtonStyle,actionButtonStyle:D==null?void 0:D.actionButtonStyle,removeToast:xt,toasts:Q.filter(Ht=>Ht.position==dt.position),heights:he.filter(Ht=>Ht.position==dt.position),setHeights:we,expandByDefault:l,gap:F,loadingIcon:$,expanded:fe,pauseWhenPageIsHidden:ee,swipeDirections:e.swipeDirections})})):null}))});const I1e=({...e})=>{const{theme:t="system"}=n1e();return v.jsx(k1e,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-gray-800 group-[.toaster]:text-white group-[.toaster]:border-gray-700 group-[.toaster]:shadow-lg group-[.toaster]:rounded-lg",description:"group-[.toast]:text-white group-[.toast]:text-sm",actionButton:"group-[.toast]:bg-green-600 group-[.toast]:text-white group-[.toast]:border-green-700 group-[.toast]:rounded-md",cancelButton:"group-[.toast]:bg-gray-600 group-[.toast]:text-white group-[.toast]:border-gray-700 group-[.toast]:rounded-md"}},...e})};var N1e=f3[" useId ".trim().toString()]||(()=>{}),M1e=0;function bp(e){const[t,n]=L.useState(N1e());return Sl(()=>{e||n(r=>r??String(M1e++))},[e]),e||(t?`radix-${t}`:"")}const L1e=["top","right","bottom","left"],uv=Math.min,vh=Math.max,UP=Math.round,qC=Math.floor,jm=e=>({x:e,y:e}),D1e={left:"right",right:"left",bottom:"top",top:"bottom"},R1e={start:"end",end:"start"};function eR(e,t,n){return vh(e,uv(t,n))}function ry(e,t){return typeof e=="function"?e(t):e}function iy(e){return e.split("-")[0]}function Cw(e){return e.split("-")[1]}function CF(e){return e==="x"?"y":"x"}function EF(e){return e==="y"?"height":"width"}const j1e=new Set(["top","bottom"]);function Cm(e){return j1e.has(iy(e))?"y":"x"}function PF(e){return CF(Cm(e))}function O1e(e,t,n){n===void 0&&(n=!1);const r=Cw(e),a=PF(e),l=EF(a);let h=a==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[l]>t.floating[l]&&(h=VP(h)),[h,VP(h)]}function F1e(e){const t=VP(e);return[tR(e),t,tR(t)]}function tR(e){return e.replace(/start|end/g,t=>R1e[t])}const R9=["left","right"],j9=["right","left"],z1e=["top","bottom"],B1e=["bottom","top"];function U1e(e,t,n){switch(e){case"top":case"bottom":return n?t?j9:R9:t?R9:j9;case"left":case"right":return t?z1e:B1e;default:return[]}}function V1e(e,t,n,r){const a=Cw(e);let l=U1e(iy(e),n==="start",r);return a&&(l=l.map(h=>h+"-"+a),t&&(l=l.concat(l.map(tR)))),l}function VP(e){return e.replace(/left|right|bottom|top/g,t=>D1e[t])}function $1e(e){return{top:0,right:0,bottom:0,left:0,...e}}function QQ(e){return typeof e!="number"?$1e(e):{top:e,right:e,bottom:e,left:e}}function $P(e){const{x:t,y:n,width:r,height:a}=e;return{width:r,height:a,top:n,left:t,right:t+r,bottom:n+a,x:t,y:n}}function O9(e,t,n){let{reference:r,floating:a}=e;const l=Cm(t),h=PF(t),i=EF(h),y=iy(t),x=l==="y",w=r.x+r.width/2-a.width/2,C=r.y+r.height/2-a.height/2,P=r[i]/2-a[i]/2;let E;switch(y){case"top":E={x:w,y:r.y-a.height};break;case"bottom":E={x:w,y:r.y+r.height};break;case"right":E={x:r.x+r.width,y:C};break;case"left":E={x:r.x-a.width,y:C};break;default:E={x:r.x,y:r.y}}switch(Cw(t)){case"start":E[h]-=P*(n&&x?-1:1);break;case"end":E[h]+=P*(n&&x?-1:1);break}return E}const q1e=async(e,t,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:l=[],platform:h}=n,i=l.filter(Boolean),y=await(h.isRTL==null?void 0:h.isRTL(t));let x=await h.getElementRects({reference:e,floating:t,strategy:a}),{x:w,y:C}=O9(x,r,y),P=r,E={},j=0;for(let D=0;D<i.length;D++){const{name:B,fn:F}=i[D],{x:$,y:H,data:J,reset:ee}=await F({x:w,y:C,initialPlacement:r,placement:P,strategy:a,middlewareData:E,rects:x,platform:h,elements:{reference:e,floating:t}});w=$??w,C=H??C,E={...E,[B]:{...E[B],...J}},ee&&j<=50&&(j++,typeof ee=="object"&&(ee.placement&&(P=ee.placement),ee.rects&&(x=ee.rects===!0?await h.getElementRects({reference:e,floating:t,strategy:a}):ee.rects),{x:w,y:C}=O9(x,P,y)),D=-1)}return{x:w,y:C,placement:P,strategy:a,middlewareData:E}};async function IA(e,t){var n;t===void 0&&(t={});const{x:r,y:a,platform:l,rects:h,elements:i,strategy:y}=e,{boundary:x="clippingAncestors",rootBoundary:w="viewport",elementContext:C="floating",altBoundary:P=!1,padding:E=0}=ry(t,e),j=QQ(E),B=i[P?C==="floating"?"reference":"floating":C],F=$P(await l.getClippingRect({element:(n=await(l.isElement==null?void 0:l.isElement(B)))==null||n?B:B.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(i.floating)),boundary:x,rootBoundary:w,strategy:y})),$=C==="floating"?{x:r,y:a,width:h.floating.width,height:h.floating.height}:h.reference,H=await(l.getOffsetParent==null?void 0:l.getOffsetParent(i.floating)),J=await(l.isElement==null?void 0:l.isElement(H))?await(l.getScale==null?void 0:l.getScale(H))||{x:1,y:1}:{x:1,y:1},ee=$P(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({elements:i,rect:$,offsetParent:H,strategy:y}):$);return{top:(F.top-ee.top+j.top)/J.y,bottom:(ee.bottom-F.bottom+j.bottom)/J.y,left:(F.left-ee.left+j.left)/J.x,right:(ee.right-F.right+j.right)/J.x}}const G1e=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:a,rects:l,platform:h,elements:i,middlewareData:y}=t,{element:x,padding:w=0}=ry(e,t)||{};if(x==null)return{};const C=QQ(w),P={x:n,y:r},E=PF(a),j=EF(E),D=await h.getDimensions(x),B=E==="y",F=B?"top":"left",$=B?"bottom":"right",H=B?"clientHeight":"clientWidth",J=l.reference[j]+l.reference[E]-P[E]-l.floating[j],ee=P[E]-l.reference[E],Q=await(h.getOffsetParent==null?void 0:h.getOffsetParent(x));let ne=Q?Q[H]:0;(!ne||!await(h.isElement==null?void 0:h.isElement(Q)))&&(ne=i.floating[H]||l.floating[j]);const pe=J/2-ee/2,he=ne/2-D[j]/2-1,we=uv(C[F],he),fe=uv(C[$],he),ge=we,Ce=ne-D[j]-fe,xe=ne/2-D[j]/2+pe,Re=eR(ge,xe,Ce),Qe=!y.arrow&&Cw(a)!=null&&xe!==Re&&l.reference[j]/2-(xe<ge?we:fe)-D[j]/2<0,et=Qe?xe<ge?xe-ge:xe-Ce:0;return{[E]:P[E]+et,data:{[E]:Re,centerOffset:xe-Re-et,...Qe&&{alignmentOffset:et}},reset:Qe}}}),H1e=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:a,middlewareData:l,rects:h,initialPlacement:i,platform:y,elements:x}=t,{mainAxis:w=!0,crossAxis:C=!0,fallbackPlacements:P,fallbackStrategy:E="bestFit",fallbackAxisSideDirection:j="none",flipAlignment:D=!0,...B}=ry(e,t);if((n=l.arrow)!=null&&n.alignmentOffset)return{};const F=iy(a),$=Cm(i),H=iy(i)===i,J=await(y.isRTL==null?void 0:y.isRTL(x.floating)),ee=P||(H||!D?[VP(i)]:F1e(i)),Q=j!=="none";!P&&Q&&ee.push(...V1e(i,D,j,J));const ne=[i,...ee],pe=await IA(t,B),he=[];let we=((r=l.flip)==null?void 0:r.overflows)||[];if(w&&he.push(pe[F]),C){const xe=O1e(a,h,J);he.push(pe[xe[0]],pe[xe[1]])}if(we=[...we,{placement:a,overflows:he}],!he.every(xe=>xe<=0)){var fe,ge;const xe=(((fe=l.flip)==null?void 0:fe.index)||0)+1,Re=ne[xe];if(Re&&(!(C==="alignment"?$!==Cm(Re):!1)||we.every(je=>je.overflows[0]>0&&Cm(je.placement)===$)))return{data:{index:xe,overflows:we},reset:{placement:Re}};let Qe=(ge=we.filter(et=>et.overflows[0]<=0).sort((et,je)=>et.overflows[1]-je.overflows[1])[0])==null?void 0:ge.placement;if(!Qe)switch(E){case"bestFit":{var Ce;const et=(Ce=we.filter(je=>{if(Q){const De=Cm(je.placement);return De===$||De==="y"}return!0}).map(je=>[je.placement,je.overflows.filter(De=>De>0).reduce((De,Ct)=>De+Ct,0)]).sort((je,De)=>je[1]-De[1])[0])==null?void 0:Ce[0];et&&(Qe=et);break}case"initialPlacement":Qe=i;break}if(a!==Qe)return{reset:{placement:Qe}}}return{}}}};function F9(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function z9(e){return L1e.some(t=>e[t]>=0)}const W1e=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...a}=ry(e,t);switch(r){case"referenceHidden":{const l=await IA(t,{...a,elementContext:"reference"}),h=F9(l,n.reference);return{data:{referenceHiddenOffsets:h,referenceHidden:z9(h)}}}case"escaped":{const l=await IA(t,{...a,altBoundary:!0}),h=F9(l,n.floating);return{data:{escapedOffsets:h,escaped:z9(h)}}}default:return{}}}}},eee=new Set(["left","top"]);async function Z1e(e,t){const{placement:n,platform:r,elements:a}=e,l=await(r.isRTL==null?void 0:r.isRTL(a.floating)),h=iy(n),i=Cw(n),y=Cm(n)==="y",x=eee.has(h)?-1:1,w=l&&y?-1:1,C=ry(t,e);let{mainAxis:P,crossAxis:E,alignmentAxis:j}=typeof C=="number"?{mainAxis:C,crossAxis:0,alignmentAxis:null}:{mainAxis:C.mainAxis||0,crossAxis:C.crossAxis||0,alignmentAxis:C.alignmentAxis};return i&&typeof j=="number"&&(E=i==="end"?j*-1:j),y?{x:E*w,y:P*x}:{x:P*x,y:E*w}}const K1e=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:a,y:l,placement:h,middlewareData:i}=t,y=await Z1e(t,e);return h===((n=i.offset)==null?void 0:n.placement)&&(r=i.arrow)!=null&&r.alignmentOffset?{}:{x:a+y.x,y:l+y.y,data:{...y,placement:h}}}}},Y1e=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:a}=t,{mainAxis:l=!0,crossAxis:h=!1,limiter:i={fn:B=>{let{x:F,y:$}=B;return{x:F,y:$}}},...y}=ry(e,t),x={x:n,y:r},w=await IA(t,y),C=Cm(iy(a)),P=CF(C);let E=x[P],j=x[C];if(l){const B=P==="y"?"top":"left",F=P==="y"?"bottom":"right",$=E+w[B],H=E-w[F];E=eR($,E,H)}if(h){const B=C==="y"?"top":"left",F=C==="y"?"bottom":"right",$=j+w[B],H=j-w[F];j=eR($,j,H)}const D=i.fn({...t,[P]:E,[C]:j});return{...D,data:{x:D.x-n,y:D.y-r,enabled:{[P]:l,[C]:h}}}}}},X1e=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:a,rects:l,middlewareData:h}=t,{offset:i=0,mainAxis:y=!0,crossAxis:x=!0}=ry(e,t),w={x:n,y:r},C=Cm(a),P=CF(C);let E=w[P],j=w[C];const D=ry(i,t),B=typeof D=="number"?{mainAxis:D,crossAxis:0}:{mainAxis:0,crossAxis:0,...D};if(y){const H=P==="y"?"height":"width",J=l.reference[P]-l.floating[H]+B.mainAxis,ee=l.reference[P]+l.reference[H]-B.mainAxis;E<J?E=J:E>ee&&(E=ee)}if(x){var F,$;const H=P==="y"?"width":"height",J=eee.has(iy(a)),ee=l.reference[C]-l.floating[H]+(J&&((F=h.offset)==null?void 0:F[C])||0)+(J?0:B.crossAxis),Q=l.reference[C]+l.reference[H]+(J?0:(($=h.offset)==null?void 0:$[C])||0)-(J?B.crossAxis:0);j<ee?j=ee:j>Q&&(j=Q)}return{[P]:E,[C]:j}}}},J1e=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:a,rects:l,platform:h,elements:i}=t,{apply:y=()=>{},...x}=ry(e,t),w=await IA(t,x),C=iy(a),P=Cw(a),E=Cm(a)==="y",{width:j,height:D}=l.floating;let B,F;C==="top"||C==="bottom"?(B=C,F=P===(await(h.isRTL==null?void 0:h.isRTL(i.floating))?"start":"end")?"left":"right"):(F=C,B=P==="end"?"top":"bottom");const $=D-w.top-w.bottom,H=j-w.left-w.right,J=uv(D-w[B],$),ee=uv(j-w[F],H),Q=!t.middlewareData.shift;let ne=J,pe=ee;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(pe=H),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(ne=$),Q&&!P){const we=vh(w.left,0),fe=vh(w.right,0),ge=vh(w.top,0),Ce=vh(w.bottom,0);E?pe=j-2*(we!==0||fe!==0?we+fe:vh(w.left,w.right)):ne=D-2*(ge!==0||Ce!==0?ge+Ce:vh(w.top,w.bottom))}await y({...t,availableWidth:pe,availableHeight:ne});const he=await h.getDimensions(i.floating);return j!==he.width||D!==he.height?{reset:{rects:!0}}:{}}}};function j3(){return typeof window<"u"}function Ew(e){return tee(e)?(e.nodeName||"").toLowerCase():"#document"}function Ch(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Km(e){var t;return(t=(tee(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function tee(e){return j3()?e instanceof Node||e instanceof Ch(e).Node:!1}function Tp(e){return j3()?e instanceof Element||e instanceof Ch(e).Element:!1}function qm(e){return j3()?e instanceof HTMLElement||e instanceof Ch(e).HTMLElement:!1}function B9(e){return!j3()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Ch(e).ShadowRoot}const Q1e=new Set(["inline","contents"]);function A5(e){const{overflow:t,overflowX:n,overflowY:r,display:a}=Cp(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!Q1e.has(a)}const ebe=new Set(["table","td","th"]);function tbe(e){return ebe.has(Ew(e))}const nbe=[":popover-open",":modal"];function O3(e){return nbe.some(t=>{try{return e.matches(t)}catch{return!1}})}const rbe=["transform","translate","scale","rotate","perspective"],ibe=["transform","translate","scale","rotate","perspective","filter"],sbe=["paint","layout","strict","content"];function kF(e){const t=IF(),n=Tp(e)?Cp(e):e;return rbe.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||ibe.some(r=>(n.willChange||"").includes(r))||sbe.some(r=>(n.contain||"").includes(r))}function abe(e){let t=dv(e);for(;qm(t)&&!Xb(t);){if(kF(t))return t;if(O3(t))return null;t=dv(t)}return null}function IF(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const obe=new Set(["html","body","#document"]);function Xb(e){return obe.has(Ew(e))}function Cp(e){return Ch(e).getComputedStyle(e)}function F3(e){return Tp(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function dv(e){if(Ew(e)==="html")return e;const t=e.assignedSlot||e.parentNode||B9(e)&&e.host||Km(e);return B9(t)?t.host:t}function nee(e){const t=dv(e);return Xb(t)?e.ownerDocument?e.ownerDocument.body:e.body:qm(t)&&A5(t)?t:nee(t)}function NA(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const a=nee(e),l=a===((r=e.ownerDocument)==null?void 0:r.body),h=Ch(a);if(l){const i=nR(h);return t.concat(h,h.visualViewport||[],A5(a)?a:[],i&&n?NA(i):[])}return t.concat(a,NA(a,[],n))}function nR(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function ree(e){const t=Cp(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=qm(e),l=a?e.offsetWidth:n,h=a?e.offsetHeight:r,i=UP(n)!==l||UP(r)!==h;return i&&(n=l,r=h),{width:n,height:r,$:i}}function NF(e){return Tp(e)?e:e.contextElement}function vb(e){const t=NF(e);if(!qm(t))return jm(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:l}=ree(t);let h=(l?UP(n.width):n.width)/r,i=(l?UP(n.height):n.height)/a;return(!h||!Number.isFinite(h))&&(h=1),(!i||!Number.isFinite(i))&&(i=1),{x:h,y:i}}const lbe=jm(0);function iee(e){const t=Ch(e);return!IF()||!t.visualViewport?lbe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function cbe(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==Ch(e)?!1:t}function ux(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const a=e.getBoundingClientRect(),l=NF(e);let h=jm(1);t&&(r?Tp(r)&&(h=vb(r)):h=vb(e));const i=cbe(l,n,r)?iee(l):jm(0);let y=(a.left+i.x)/h.x,x=(a.top+i.y)/h.y,w=a.width/h.x,C=a.height/h.y;if(l){const P=Ch(l),E=r&&Tp(r)?Ch(r):r;let j=P,D=nR(j);for(;D&&r&&E!==j;){const B=vb(D),F=D.getBoundingClientRect(),$=Cp(D),H=F.left+(D.clientLeft+parseFloat($.paddingLeft))*B.x,J=F.top+(D.clientTop+parseFloat($.paddingTop))*B.y;y*=B.x,x*=B.y,w*=B.x,C*=B.y,y+=H,x+=J,j=Ch(D),D=nR(j)}}return $P({width:w,height:C,x:y,y:x})}function MF(e,t){const n=F3(e).scrollLeft;return t?t.left+n:ux(Km(e)).left+n}function see(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),a=r.left+t.scrollLeft-(n?0:MF(e,r)),l=r.top+t.scrollTop;return{x:a,y:l}}function ube(e){let{elements:t,rect:n,offsetParent:r,strategy:a}=e;const l=a==="fixed",h=Km(r),i=t?O3(t.floating):!1;if(r===h||i&&l)return n;let y={scrollLeft:0,scrollTop:0},x=jm(1);const w=jm(0),C=qm(r);if((C||!C&&!l)&&((Ew(r)!=="body"||A5(h))&&(y=F3(r)),qm(r))){const E=ux(r);x=vb(r),w.x=E.x+r.clientLeft,w.y=E.y+r.clientTop}const P=h&&!C&&!l?see(h,y,!0):jm(0);return{width:n.width*x.x,height:n.height*x.y,x:n.x*x.x-y.scrollLeft*x.x+w.x+P.x,y:n.y*x.y-y.scrollTop*x.y+w.y+P.y}}function dbe(e){return Array.from(e.getClientRects())}function hbe(e){const t=Km(e),n=F3(e),r=e.ownerDocument.body,a=vh(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),l=vh(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let h=-n.scrollLeft+MF(e);const i=-n.scrollTop;return Cp(r).direction==="rtl"&&(h+=vh(t.clientWidth,r.clientWidth)-a),{width:a,height:l,x:h,y:i}}function fbe(e,t){const n=Ch(e),r=Km(e),a=n.visualViewport;let l=r.clientWidth,h=r.clientHeight,i=0,y=0;if(a){l=a.width,h=a.height;const x=IF();(!x||x&&t==="fixed")&&(i=a.offsetLeft,y=a.offsetTop)}return{width:l,height:h,x:i,y}}const pbe=new Set(["absolute","fixed"]);function mbe(e,t){const n=ux(e,!0,t==="fixed"),r=n.top+e.clientTop,a=n.left+e.clientLeft,l=qm(e)?vb(e):jm(1),h=e.clientWidth*l.x,i=e.clientHeight*l.y,y=a*l.x,x=r*l.y;return{width:h,height:i,x:y,y:x}}function U9(e,t,n){let r;if(t==="viewport")r=fbe(e,n);else if(t==="document")r=hbe(Km(e));else if(Tp(t))r=mbe(t,n);else{const a=iee(e);r={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return $P(r)}function aee(e,t){const n=dv(e);return n===t||!Tp(n)||Xb(n)?!1:Cp(n).position==="fixed"||aee(n,t)}function gbe(e,t){const n=t.get(e);if(n)return n;let r=NA(e,[],!1).filter(i=>Tp(i)&&Ew(i)!=="body"),a=null;const l=Cp(e).position==="fixed";let h=l?dv(e):e;for(;Tp(h)&&!Xb(h);){const i=Cp(h),y=kF(h);!y&&i.position==="fixed"&&(a=null),(l?!y&&!a:!y&&i.position==="static"&&!!a&&pbe.has(a.position)||A5(h)&&!y&&aee(e,h))?r=r.filter(w=>w!==h):a=i,h=dv(h)}return t.set(e,r),r}function ybe(e){let{element:t,boundary:n,rootBoundary:r,strategy:a}=e;const h=[...n==="clippingAncestors"?O3(t)?[]:gbe(t,this._c):[].concat(n),r],i=h[0],y=h.reduce((x,w)=>{const C=U9(t,w,a);return x.top=vh(C.top,x.top),x.right=uv(C.right,x.right),x.bottom=uv(C.bottom,x.bottom),x.left=vh(C.left,x.left),x},U9(t,i,a));return{width:y.right-y.left,height:y.bottom-y.top,x:y.left,y:y.top}}function vbe(e){const{width:t,height:n}=ree(e);return{width:t,height:n}}function _be(e,t,n){const r=qm(t),a=Km(t),l=n==="fixed",h=ux(e,!0,l,t);let i={scrollLeft:0,scrollTop:0};const y=jm(0);function x(){y.x=MF(a)}if(r||!r&&!l)if((Ew(t)!=="body"||A5(a))&&(i=F3(t)),r){const E=ux(t,!0,l,t);y.x=E.x+t.clientLeft,y.y=E.y+t.clientTop}else a&&x();l&&!r&&a&&x();const w=a&&!r&&!l?see(a,i):jm(0),C=h.left+i.scrollLeft-y.x-w.x,P=h.top+i.scrollTop-y.y-w.y;return{x:C,y:P,width:h.width,height:h.height}}function wL(e){return Cp(e).position==="static"}function V9(e,t){if(!qm(e)||Cp(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Km(e)===n&&(n=n.ownerDocument.body),n}function oee(e,t){const n=Ch(e);if(O3(e))return n;if(!qm(e)){let a=dv(e);for(;a&&!Xb(a);){if(Tp(a)&&!wL(a))return a;a=dv(a)}return n}let r=V9(e,t);for(;r&&tbe(r)&&wL(r);)r=V9(r,t);return r&&Xb(r)&&wL(r)&&!kF(r)?n:r||abe(e)||n}const xbe=async function(e){const t=this.getOffsetParent||oee,n=this.getDimensions,r=await n(e.floating);return{reference:_be(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function bbe(e){return Cp(e).direction==="rtl"}const wbe={convertOffsetParentRelativeRectToViewportRelativeRect:ube,getDocumentElement:Km,getClippingRect:ybe,getOffsetParent:oee,getElementRects:xbe,getClientRects:dbe,getDimensions:vbe,getScale:vb,isElement:Tp,isRTL:bbe};function lee(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Sbe(e,t){let n=null,r;const a=Km(e);function l(){var i;clearTimeout(r),(i=n)==null||i.disconnect(),n=null}function h(i,y){i===void 0&&(i=!1),y===void 0&&(y=1),l();const x=e.getBoundingClientRect(),{left:w,top:C,width:P,height:E}=x;if(i||t(),!P||!E)return;const j=qC(C),D=qC(a.clientWidth-(w+P)),B=qC(a.clientHeight-(C+E)),F=qC(w),H={rootMargin:-j+"px "+-D+"px "+-B+"px "+-F+"px",threshold:vh(0,uv(1,y))||1};let J=!0;function ee(Q){const ne=Q[0].intersectionRatio;if(ne!==y){if(!J)return h();ne?h(!1,ne):r=setTimeout(()=>{h(!1,1e-7)},1e3)}ne===1&&!lee(x,e.getBoundingClientRect())&&h(),J=!1}try{n=new IntersectionObserver(ee,{...H,root:a.ownerDocument})}catch{n=new IntersectionObserver(ee,H)}n.observe(e)}return h(!0),l}function Abe(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:l=!0,elementResize:h=typeof ResizeObserver=="function",layoutShift:i=typeof IntersectionObserver=="function",animationFrame:y=!1}=r,x=NF(e),w=a||l?[...x?NA(x):[],...NA(t)]:[];w.forEach(F=>{a&&F.addEventListener("scroll",n,{passive:!0}),l&&F.addEventListener("resize",n)});const C=x&&i?Sbe(x,n):null;let P=-1,E=null;h&&(E=new ResizeObserver(F=>{let[$]=F;$&&$.target===x&&E&&(E.unobserve(t),cancelAnimationFrame(P),P=requestAnimationFrame(()=>{var H;(H=E)==null||H.observe(t)})),n()}),x&&!y&&E.observe(x),E.observe(t));let j,D=y?ux(e):null;y&&B();function B(){const F=ux(e);D&&!lee(D,F)&&n(),D=F,j=requestAnimationFrame(B)}return n(),()=>{var F;w.forEach($=>{a&&$.removeEventListener("scroll",n),l&&$.removeEventListener("resize",n)}),C==null||C(),(F=E)==null||F.disconnect(),E=null,y&&cancelAnimationFrame(j)}}const Tbe=K1e,Cbe=Y1e,Ebe=H1e,Pbe=J1e,kbe=W1e,$9=G1e,Ibe=X1e,Nbe=(e,t,n)=>{const r=new Map,a={platform:wbe,...n},l={...a.platform,_c:r};return q1e(e,t,{...a,platform:l})};var Mbe=typeof document<"u",Lbe=function(){},ZE=Mbe?L.useLayoutEffect:Lbe;function qP(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!qP(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;r--!==0;){const l=a[r];if(!(l==="_owner"&&e.$$typeof)&&!qP(e[l],t[l]))return!1}return!0}return e!==e&&t!==t}function cee(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function q9(e,t){const n=cee(e);return Math.round(t*n)/n}function SL(e){const t=L.useRef(e);return ZE(()=>{t.current=e}),t}function Dbe(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:a,elements:{reference:l,floating:h}={},transform:i=!0,whileElementsMounted:y,open:x}=e,[w,C]=L.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[P,E]=L.useState(r);qP(P,r)||E(r);const[j,D]=L.useState(null),[B,F]=L.useState(null),$=L.useCallback(je=>{je!==Q.current&&(Q.current=je,D(je))},[]),H=L.useCallback(je=>{je!==ne.current&&(ne.current=je,F(je))},[]),J=l||j,ee=h||B,Q=L.useRef(null),ne=L.useRef(null),pe=L.useRef(w),he=y!=null,we=SL(y),fe=SL(a),ge=SL(x),Ce=L.useCallback(()=>{if(!Q.current||!ne.current)return;const je={placement:t,strategy:n,middleware:P};fe.current&&(je.platform=fe.current),Nbe(Q.current,ne.current,je).then(De=>{const Ct={...De,isPositioned:ge.current!==!1};xe.current&&!qP(pe.current,Ct)&&(pe.current=Ct,Sv.flushSync(()=>{C(Ct)}))})},[P,t,n,fe,ge]);ZE(()=>{x===!1&&pe.current.isPositioned&&(pe.current.isPositioned=!1,C(je=>({...je,isPositioned:!1})))},[x]);const xe=L.useRef(!1);ZE(()=>(xe.current=!0,()=>{xe.current=!1}),[]),ZE(()=>{if(J&&(Q.current=J),ee&&(ne.current=ee),J&&ee){if(we.current)return we.current(J,ee,Ce);Ce()}},[J,ee,Ce,we,he]);const Re=L.useMemo(()=>({reference:Q,floating:ne,setReference:$,setFloating:H}),[$,H]),Qe=L.useMemo(()=>({reference:J,floating:ee}),[J,ee]),et=L.useMemo(()=>{const je={position:n,left:0,top:0};if(!Qe.floating)return je;const De=q9(Qe.floating,w.x),Ct=q9(Qe.floating,w.y);return i?{...je,transform:"translate("+De+"px, "+Ct+"px)",...cee(Qe.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:De,top:Ct}},[n,i,Qe.floating,w.x,w.y]);return L.useMemo(()=>({...w,update:Ce,refs:Re,elements:Qe,floatingStyles:et}),[w,Ce,Re,Qe,et])}const Rbe=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:a}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?$9({element:r.current,padding:a}).fn(n):{}:r?$9({element:r,padding:a}).fn(n):{}}}},jbe=(e,t)=>({...Tbe(e),options:[e,t]}),Obe=(e,t)=>({...Cbe(e),options:[e,t]}),Fbe=(e,t)=>({...Ibe(e),options:[e,t]}),zbe=(e,t)=>({...Ebe(e),options:[e,t]}),Bbe=(e,t)=>({...Pbe(e),options:[e,t]}),Ube=(e,t)=>({...kbe(e),options:[e,t]}),Vbe=(e,t)=>({...Rbe(e),options:[e,t]});var $be="Arrow",uee=L.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...l}=e;return v.jsx(Ei.svg,{...l,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:v.jsx("polygon",{points:"0,0 30,0 15,10"})})});uee.displayName=$be;var qbe=uee;function dee(e){const[t,n]=L.useState(void 0);return Sl(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const l=a[0];let h,i;if("borderBoxSize"in l){const y=l.borderBoxSize,x=Array.isArray(y)?y[0]:y;h=x.inlineSize,i=x.blockSize}else h=e.offsetWidth,i=e.offsetHeight;n({width:h,height:i})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var LF="Popper",[hee,Pw]=dd(LF),[Gbe,fee]=hee(LF),pee=e=>{const{__scopePopper:t,children:n}=e,[r,a]=L.useState(null);return v.jsx(Gbe,{scope:t,anchor:r,onAnchorChange:a,children:n})};pee.displayName=LF;var mee="PopperAnchor",gee=L.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,l=fee(mee,n),h=L.useRef(null),i=_s(t,h);return L.useEffect(()=>{l.onAnchorChange((r==null?void 0:r.current)||h.current)}),r?null:v.jsx(Ei.div,{...a,ref:i})});gee.displayName=mee;var DF="PopperContent",[Hbe,Wbe]=hee(DF),yee=L.forwardRef((e,t)=>{var dt,At,mt,Pt,Ht,Ot;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:l="center",alignOffset:h=0,arrowPadding:i=0,avoidCollisions:y=!0,collisionBoundary:x=[],collisionPadding:w=0,sticky:C="partial",hideWhenDetached:P=!1,updatePositionStrategy:E="optimized",onPlaced:j,...D}=e,B=fee(DF,n),[F,$]=L.useState(null),H=_s(t,Un=>$(Un)),[J,ee]=L.useState(null),Q=dee(J),ne=(Q==null?void 0:Q.width)??0,pe=(Q==null?void 0:Q.height)??0,he=r+(l!=="center"?"-"+l:""),we=typeof w=="number"?w:{top:0,right:0,bottom:0,left:0,...w},fe=Array.isArray(x)?x:[x],ge=fe.length>0,Ce={padding:we,boundary:fe.filter(Kbe),altBoundary:ge},{refs:xe,floatingStyles:Re,placement:Qe,isPositioned:et,middlewareData:je}=Dbe({strategy:"fixed",placement:he,whileElementsMounted:(...Un)=>Abe(...Un,{animationFrame:E==="always"}),elements:{reference:B.anchor},middleware:[jbe({mainAxis:a+pe,alignmentAxis:h}),y&&Obe({mainAxis:!0,crossAxis:!1,limiter:C==="partial"?Fbe():void 0,...Ce}),y&&zbe({...Ce}),Bbe({...Ce,apply:({elements:Un,rects:Kt,availableWidth:st,availableHeight:Dr})=>{const{width:Or,height:Br}=Kt.reference,On=Un.floating.style;On.setProperty("--radix-popper-available-width",`${st}px`),On.setProperty("--radix-popper-available-height",`${Dr}px`),On.setProperty("--radix-popper-anchor-width",`${Or}px`),On.setProperty("--radix-popper-anchor-height",`${Br}px`)}}),J&&Vbe({element:J,padding:i}),Ybe({arrowWidth:ne,arrowHeight:pe}),P&&Ube({strategy:"referenceHidden",...Ce})]}),[De,Ct]=xee(Qe),xt=ll(j);Sl(()=>{et&&(xt==null||xt())},[et,xt]);const me=(dt=je.arrow)==null?void 0:dt.x,Ye=(At=je.arrow)==null?void 0:At.y,nt=((mt=je.arrow)==null?void 0:mt.centerOffset)!==0,[vt,gt]=L.useState();return Sl(()=>{F&&gt(window.getComputedStyle(F).zIndex)},[F]),v.jsx("div",{ref:xe.setFloating,"data-radix-popper-content-wrapper":"",style:{...Re,transform:et?Re.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:vt,"--radix-popper-transform-origin":[(Pt=je.transformOrigin)==null?void 0:Pt.x,(Ht=je.transformOrigin)==null?void 0:Ht.y].join(" "),...((Ot=je.hide)==null?void 0:Ot.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:v.jsx(Hbe,{scope:n,placedSide:De,onArrowChange:ee,arrowX:me,arrowY:Ye,shouldHideArrow:nt,children:v.jsx(Ei.div,{"data-side":De,"data-align":Ct,...D,ref:H,style:{...D.style,animation:et?void 0:"none"}})})})});yee.displayName=DF;var vee="PopperArrow",Zbe={top:"bottom",right:"left",bottom:"top",left:"right"},_ee=L.forwardRef(function(t,n){const{__scopePopper:r,...a}=t,l=Wbe(vee,r),h=Zbe[l.placedSide];return v.jsx("span",{ref:l.onArrowChange,style:{position:"absolute",left:l.arrowX,top:l.arrowY,[h]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[l.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[l.placedSide],visibility:l.shouldHideArrow?"hidden":void 0},children:v.jsx(qbe,{...a,ref:n,style:{...a.style,display:"block"}})})});_ee.displayName=vee;function Kbe(e){return e!==null}var Ybe=e=>({name:"transformOrigin",options:e,fn(t){var B,F,$;const{placement:n,rects:r,middlewareData:a}=t,h=((B=a.arrow)==null?void 0:B.centerOffset)!==0,i=h?0:e.arrowWidth,y=h?0:e.arrowHeight,[x,w]=xee(n),C={start:"0%",center:"50%",end:"100%"}[w],P=(((F=a.arrow)==null?void 0:F.x)??0)+i/2,E=((($=a.arrow)==null?void 0:$.y)??0)+y/2;let j="",D="";return x==="bottom"?(j=h?C:`${P}px`,D=`${-y}px`):x==="top"?(j=h?C:`${P}px`,D=`${r.floating.height+y}px`):x==="right"?(j=`${-y}px`,D=h?C:`${E}px`):x==="left"&&(j=`${r.floating.width+y}px`,D=h?C:`${E}px`),{data:{x:j,y:D}}}});function xee(e){const[t,n="center"]=e.split("-");return[t,n]}var RF=pee,jF=gee,OF=yee,FF=_ee,[z3,LXe]=dd("Tooltip",[Pw]),B3=Pw(),bee="TooltipProvider",Xbe=700,rR="tooltip.open",[Jbe,zF]=z3(bee),wee=e=>{const{__scopeTooltip:t,delayDuration:n=Xbe,skipDelayDuration:r=300,disableHoverableContent:a=!1,children:l}=e,h=L.useRef(!0),i=L.useRef(!1),y=L.useRef(0);return L.useEffect(()=>{const x=y.current;return()=>window.clearTimeout(x)},[]),v.jsx(Jbe,{scope:t,isOpenDelayedRef:h,delayDuration:n,onOpen:L.useCallback(()=>{window.clearTimeout(y.current),h.current=!1},[]),onClose:L.useCallback(()=>{window.clearTimeout(y.current),y.current=window.setTimeout(()=>h.current=!0,r)},[r]),isPointerInTransitRef:i,onPointerInTransitChange:L.useCallback(x=>{i.current=x},[]),disableHoverableContent:a,children:l})};wee.displayName=bee;var MA="Tooltip",[Qbe,U3]=z3(MA),See=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:a,onOpenChange:l,disableHoverableContent:h,delayDuration:i}=e,y=zF(MA,e.__scopeTooltip),x=B3(t),[w,C]=L.useState(null),P=bp(),E=L.useRef(0),j=h??y.disableHoverableContent,D=i??y.delayDuration,B=L.useRef(!1),[F,$]=ny({prop:r,defaultProp:a??!1,onChange:ne=>{ne?(y.onOpen(),document.dispatchEvent(new CustomEvent(rR))):y.onClose(),l==null||l(ne)},caller:MA}),H=L.useMemo(()=>F?B.current?"delayed-open":"instant-open":"closed",[F]),J=L.useCallback(()=>{window.clearTimeout(E.current),E.current=0,B.current=!1,$(!0)},[$]),ee=L.useCallback(()=>{window.clearTimeout(E.current),E.current=0,$(!1)},[$]),Q=L.useCallback(()=>{window.clearTimeout(E.current),E.current=window.setTimeout(()=>{B.current=!0,$(!0),E.current=0},D)},[D,$]);return L.useEffect(()=>()=>{E.current&&(window.clearTimeout(E.current),E.current=0)},[]),v.jsx(RF,{...x,children:v.jsx(Qbe,{scope:t,contentId:P,open:F,stateAttribute:H,trigger:w,onTriggerChange:C,onTriggerEnter:L.useCallback(()=>{y.isOpenDelayedRef.current?Q():J()},[y.isOpenDelayedRef,Q,J]),onTriggerLeave:L.useCallback(()=>{j?ee():(window.clearTimeout(E.current),E.current=0)},[ee,j]),onOpen:J,onClose:ee,disableHoverableContent:j,children:n})})};See.displayName=MA;var iR="TooltipTrigger",Aee=L.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=U3(iR,n),l=zF(iR,n),h=B3(n),i=L.useRef(null),y=_s(t,i,a.onTriggerChange),x=L.useRef(!1),w=L.useRef(!1),C=L.useCallback(()=>x.current=!1,[]);return L.useEffect(()=>()=>document.removeEventListener("pointerup",C),[C]),v.jsx(jF,{asChild:!0,...h,children:v.jsx(Ei.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...r,ref:y,onPointerMove:Sr(e.onPointerMove,P=>{P.pointerType!=="touch"&&!w.current&&!l.isPointerInTransitRef.current&&(a.onTriggerEnter(),w.current=!0)}),onPointerLeave:Sr(e.onPointerLeave,()=>{a.onTriggerLeave(),w.current=!1}),onPointerDown:Sr(e.onPointerDown,()=>{a.open&&a.onClose(),x.current=!0,document.addEventListener("pointerup",C,{once:!0})}),onFocus:Sr(e.onFocus,()=>{x.current||a.onOpen()}),onBlur:Sr(e.onBlur,a.onClose),onClick:Sr(e.onClick,a.onClose)})})});Aee.displayName=iR;var ewe="TooltipPortal",[DXe,twe]=z3(ewe,{forceMount:void 0}),Jb="TooltipContent",Tee=L.forwardRef((e,t)=>{const n=twe(Jb,e.__scopeTooltip),{forceMount:r=n.forceMount,side:a="top",...l}=e,h=U3(Jb,e.__scopeTooltip);return v.jsx(hd,{present:r||h.open,children:h.disableHoverableContent?v.jsx(Cee,{side:a,...l,ref:t}):v.jsx(nwe,{side:a,...l,ref:t})})}),nwe=L.forwardRef((e,t)=>{const n=U3(Jb,e.__scopeTooltip),r=zF(Jb,e.__scopeTooltip),a=L.useRef(null),l=_s(t,a),[h,i]=L.useState(null),{trigger:y,onClose:x}=n,w=a.current,{onPointerInTransitChange:C}=r,P=L.useCallback(()=>{i(null),C(!1)},[C]),E=L.useCallback((j,D)=>{const B=j.currentTarget,F={x:j.clientX,y:j.clientY},$=owe(F,B.getBoundingClientRect()),H=lwe(F,$),J=cwe(D.getBoundingClientRect()),ee=dwe([...H,...J]);i(ee),C(!0)},[C]);return L.useEffect(()=>()=>P(),[P]),L.useEffect(()=>{if(y&&w){const j=B=>E(B,w),D=B=>E(B,y);return y.addEventListener("pointerleave",j),w.addEventListener("pointerleave",D),()=>{y.removeEventListener("pointerleave",j),w.removeEventListener("pointerleave",D)}}},[y,w,E,P]),L.useEffect(()=>{if(h){const j=D=>{const B=D.target,F={x:D.clientX,y:D.clientY},$=(y==null?void 0:y.contains(B))||(w==null?void 0:w.contains(B)),H=!uwe(F,h);$?P():H&&(P(),x())};return document.addEventListener("pointermove",j),()=>document.removeEventListener("pointermove",j)}},[y,w,h,x,P]),v.jsx(Cee,{...e,ref:l})}),[rwe,iwe]=z3(MA,{isInside:!1}),swe=sQ("TooltipContent"),Cee=L.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":a,onEscapeKeyDown:l,onPointerDownOutside:h,...i}=e,y=U3(Jb,n),x=B3(n),{onClose:w}=y;return L.useEffect(()=>(document.addEventListener(rR,w),()=>document.removeEventListener(rR,w)),[w]),L.useEffect(()=>{if(y.trigger){const C=P=>{const E=P.target;E!=null&&E.contains(y.trigger)&&w()};return window.addEventListener("scroll",C,{capture:!0}),()=>window.removeEventListener("scroll",C,{capture:!0})}},[y.trigger,w]),v.jsx(Aw,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:l,onPointerDownOutside:h,onFocusOutside:C=>C.preventDefault(),onDismiss:w,children:v.jsxs(OF,{"data-state":y.stateAttribute,...x,...i,ref:t,style:{...i.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[v.jsx(swe,{children:r}),v.jsx(rwe,{scope:n,isInside:!0,children:v.jsx(x_e,{id:y.contentId,role:"tooltip",children:a||r})})]})})});Tee.displayName=Jb;var Eee="TooltipArrow",awe=L.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,a=B3(n);return iwe(Eee,n).isInside?null:v.jsx(FF,{...a,...r,ref:t})});awe.displayName=Eee;function owe(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),l=Math.abs(t.left-e.x);switch(Math.min(n,r,a,l)){case l:return"left";case a:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function lwe(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function cwe(e){const{top:t,right:n,bottom:r,left:a}=e;return[{x:a,y:t},{x:n,y:t},{x:n,y:r},{x:a,y:r}]}function uwe(e,t){const{x:n,y:r}=e;let a=!1;for(let l=0,h=t.length-1;l<t.length;h=l++){const i=t[l],y=t[h],x=i.x,w=i.y,C=y.x,P=y.y;w>r!=P>r&&n<(C-x)*(r-w)/(P-w)+x&&(a=!a)}return a}function dwe(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),hwe(t)}function hwe(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const a=e[r];for(;t.length>=2;){const l=t[t.length-1],h=t[t.length-2];if((l.x-h.x)*(a.y-h.y)>=(l.y-h.y)*(a.x-h.x))t.pop();else break}t.push(a)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const a=e[r];for(;n.length>=2;){const l=n[n.length-1],h=n[n.length-2];if((l.x-h.x)*(a.y-h.y)>=(l.y-h.y)*(a.x-h.x))n.pop();else break}n.push(a)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var fwe=wee,pwe=See,mwe=Aee,Pee=Tee;const kee=fwe,gwe=pwe,ywe=mwe,Iee=L.forwardRef(({className:e,sideOffset:t=4,...n},r)=>v.jsx(Pee,{ref:r,sideOffset:t,className:Xn("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md",e),...n}));Iee.displayName=Pee.displayName;var kw=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},dx=typeof window>"u"||"Deno"in globalThis;function Yu(){}function vwe(e,t){return typeof e=="function"?e(t):e}function sR(e){return typeof e=="number"&&e>=0&&e!==1/0}function Nee(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Q0(e,t){return typeof e=="function"?e(t):e}function cf(e,t){return typeof e=="function"?e(t):e}function G9(e,t){const{type:n="all",exact:r,fetchStatus:a,predicate:l,queryKey:h,stale:i}=e;if(h){if(r){if(t.queryHash!==BF(h,t.options))return!1}else if(!LA(t.queryKey,h))return!1}if(n!=="all"){const y=t.isActive();if(n==="active"&&!y||n==="inactive"&&y)return!1}return!(typeof i=="boolean"&&t.isStale()!==i||a&&a!==t.state.fetchStatus||l&&!l(t))}function H9(e,t){const{exact:n,status:r,predicate:a,mutationKey:l}=e;if(l){if(!t.options.mutationKey)return!1;if(n){if(hx(t.options.mutationKey)!==hx(l))return!1}else if(!LA(t.options.mutationKey,l))return!1}return!(r&&t.state.status!==r||a&&!a(t))}function BF(e,t){return((t==null?void 0:t.queryKeyHashFn)||hx)(e)}function hx(e){return JSON.stringify(e,(t,n)=>aR(n)?Object.keys(n).sort().reduce((r,a)=>(r[a]=n[a],r),{}):n)}function LA(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>LA(e[n],t[n])):!1}function Mee(e,t){if(e===t)return e;const n=W9(e)&&W9(t);if(n||aR(e)&&aR(t)){const r=n?e:Object.keys(e),a=r.length,l=n?t:Object.keys(t),h=l.length,i=n?[]:{},y=new Set(r);let x=0;for(let w=0;w<h;w++){const C=n?w:l[w];(!n&&y.has(C)||n)&&e[C]===void 0&&t[C]===void 0?(i[C]=void 0,x++):(i[C]=Mee(e[C],t[C]),i[C]===e[C]&&e[C]!==void 0&&x++)}return a===h&&x===a?e:i}return t}function GP(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function W9(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function aR(e){if(!Z9(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!Z9(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Z9(e){return Object.prototype.toString.call(e)==="[object Object]"}function _we(e){return new Promise(t=>{setTimeout(t,e)})}function oR(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?Mee(e,t):t}function xwe(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function bwe(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var UF=Symbol();function Lee(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===UF?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function Dee(e,t){return typeof e=="function"?e(...t):!!e}var z_,P0,Ib,DY,wwe=(DY=class extends kw{constructor(){super();Mi(this,z_);Mi(this,P0);Mi(this,Ib);Yr(this,Ib,t=>{if(!dx&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){Ft(this,P0)||this.setEventListener(Ft(this,Ib))}onUnsubscribe(){var t;this.hasListeners()||((t=Ft(this,P0))==null||t.call(this),Yr(this,P0,void 0))}setEventListener(t){var n;Yr(this,Ib,t),(n=Ft(this,P0))==null||n.call(this),Yr(this,P0,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){Ft(this,z_)!==t&&(Yr(this,z_,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof Ft(this,z_)=="boolean"?Ft(this,z_):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},z_=new WeakMap,P0=new WeakMap,Ib=new WeakMap,DY),VF=new wwe,Nb,k0,Mb,RY,Swe=(RY=class extends kw{constructor(){super();Mi(this,Nb,!0);Mi(this,k0);Mi(this,Mb);Yr(this,Mb,t=>{if(!dx&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){Ft(this,k0)||this.setEventListener(Ft(this,Mb))}onUnsubscribe(){var t;this.hasListeners()||((t=Ft(this,k0))==null||t.call(this),Yr(this,k0,void 0))}setEventListener(t){var n;Yr(this,Mb,t),(n=Ft(this,k0))==null||n.call(this),Yr(this,k0,t(this.setOnline.bind(this)))}setOnline(t){Ft(this,Nb)!==t&&(Yr(this,Nb,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return Ft(this,Nb)}},Nb=new WeakMap,k0=new WeakMap,Mb=new WeakMap,RY),HP=new Swe;function lR(){let e,t;const n=new Promise((a,l)=>{e=a,t=l});n.status="pending",n.catch(()=>{});function r(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{r({status:"fulfilled",value:a}),e(a)},n.reject=a=>{r({status:"rejected",reason:a}),t(a)},n}function Awe(e){return Math.min(1e3*2**e,3e4)}function Ree(e){return(e??"online")==="online"?HP.isOnline():!0}var jee=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function AL(e){return e instanceof jee}function Oee(e){let t=!1,n=0,r=!1,a;const l=lR(),h=D=>{var B;r||(P(new jee(D)),(B=e.abort)==null||B.call(e))},i=()=>{t=!0},y=()=>{t=!1},x=()=>VF.isFocused()&&(e.networkMode==="always"||HP.isOnline())&&e.canRun(),w=()=>Ree(e.networkMode)&&e.canRun(),C=D=>{var B;r||(r=!0,(B=e.onSuccess)==null||B.call(e,D),a==null||a(),l.resolve(D))},P=D=>{var B;r||(r=!0,(B=e.onError)==null||B.call(e,D),a==null||a(),l.reject(D))},E=()=>new Promise(D=>{var B;a=F=>{(r||x())&&D(F)},(B=e.onPause)==null||B.call(e)}).then(()=>{var D;a=void 0,r||(D=e.onContinue)==null||D.call(e)}),j=()=>{if(r)return;let D;const B=n===0?e.initialPromise:void 0;try{D=B??e.fn()}catch(F){D=Promise.reject(F)}Promise.resolve(D).then(C).catch(F=>{var Q;if(r)return;const $=e.retry??(dx?0:3),H=e.retryDelay??Awe,J=typeof H=="function"?H(n,F):H,ee=$===!0||typeof $=="number"&&n<$||typeof $=="function"&&$(n,F);if(t||!ee){P(F);return}n++,(Q=e.onFail)==null||Q.call(e,n,F),_we(J).then(()=>x()?void 0:E()).then(()=>{t?P(F):j()})})};return{promise:l,cancel:h,continue:()=>(a==null||a(),l),cancelRetry:i,continueRetry:y,canStart:w,start:()=>(w()?j():E().then(j),l)}}var Twe=e=>setTimeout(e,0);function Cwe(){let e=[],t=0,n=i=>{i()},r=i=>{i()},a=Twe;const l=i=>{t?e.push(i):a(()=>{n(i)})},h=()=>{const i=e;e=[],i.length&&a(()=>{r(()=>{i.forEach(y=>{n(y)})})})};return{batch:i=>{let y;t++;try{y=i()}finally{t--,t||h()}return y},batchCalls:i=>(...y)=>{l(()=>{i(...y)})},schedule:l,setNotifyFunction:i=>{n=i},setBatchNotifyFunction:i=>{r=i},setScheduler:i=>{a=i}}}var Ql=Cwe(),B_,jY,Fee=(jY=class{constructor(){Mi(this,B_)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),sR(this.gcTime)&&Yr(this,B_,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(dx?1/0:5*60*1e3))}clearGcTimeout(){Ft(this,B_)&&(clearTimeout(Ft(this,B_)),Yr(this,B_,void 0))}},B_=new WeakMap,jY),Lb,U_,lf,V_,xu,d5,$_,dp,Ng,OY,Ewe=(OY=class extends Fee{constructor(t){super();Mi(this,dp);Mi(this,Lb);Mi(this,U_);Mi(this,lf);Mi(this,V_);Mi(this,xu);Mi(this,d5);Mi(this,$_);Yr(this,$_,!1),Yr(this,d5,t.defaultOptions),this.setOptions(t.options),this.observers=[],Yr(this,V_,t.client),Yr(this,lf,Ft(this,V_).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Yr(this,Lb,Pwe(this.options)),this.state=t.state??Ft(this,Lb),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=Ft(this,xu))==null?void 0:t.promise}setOptions(t){this.options={...Ft(this,d5),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Ft(this,lf).remove(this)}setData(t,n){const r=oR(this.state.data,t,this.options);return Ts(this,dp,Ng).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){Ts(this,dp,Ng).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,a;const n=(r=Ft(this,xu))==null?void 0:r.promise;return(a=Ft(this,xu))==null||a.cancel(t),n?n.then(Yu).catch(Yu):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Ft(this,Lb))}isActive(){return this.observers.some(t=>cf(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===UF||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Q0(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Nee(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=Ft(this,xu))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=Ft(this,xu))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),Ft(this,lf).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(Ft(this,xu)&&(Ft(this,$_)?Ft(this,xu).cancel({revert:!0}):Ft(this,xu).cancelRetry()),this.scheduleGc()),Ft(this,lf).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ts(this,dp,Ng).call(this,{type:"invalidate"})}fetch(t,n){var x,w,C;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(Ft(this,xu))return Ft(this,xu).continueRetry(),Ft(this,xu).promise}if(t&&this.setOptions(t),!this.options.queryFn){const P=this.observers.find(E=>E.options.queryFn);P&&this.setOptions(P.options)}const r=new AbortController,a=P=>{Object.defineProperty(P,"signal",{enumerable:!0,get:()=>(Yr(this,$_,!0),r.signal)})},l=()=>{const P=Lee(this.options,n),j=(()=>{const D={client:Ft(this,V_),queryKey:this.queryKey,meta:this.meta};return a(D),D})();return Yr(this,$_,!1),this.options.persister?this.options.persister(P,j,this):P(j)},i=(()=>{const P={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:Ft(this,V_),state:this.state,fetchFn:l};return a(P),P})();(x=this.options.behavior)==null||x.onFetch(i,this),Yr(this,U_,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((w=i.fetchOptions)==null?void 0:w.meta))&&Ts(this,dp,Ng).call(this,{type:"fetch",meta:(C=i.fetchOptions)==null?void 0:C.meta});const y=P=>{var E,j,D,B;AL(P)&&P.silent||Ts(this,dp,Ng).call(this,{type:"error",error:P}),AL(P)||((j=(E=Ft(this,lf).config).onError)==null||j.call(E,P,this),(B=(D=Ft(this,lf).config).onSettled)==null||B.call(D,this.state.data,P,this)),this.scheduleGc()};return Yr(this,xu,Oee({initialPromise:n==null?void 0:n.initialPromise,fn:i.fetchFn,abort:r.abort.bind(r),onSuccess:P=>{var E,j,D,B;if(P===void 0){y(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(P)}catch(F){y(F);return}(j=(E=Ft(this,lf).config).onSuccess)==null||j.call(E,P,this),(B=(D=Ft(this,lf).config).onSettled)==null||B.call(D,P,this.state.error,this),this.scheduleGc()},onError:y,onFail:(P,E)=>{Ts(this,dp,Ng).call(this,{type:"failed",failureCount:P,error:E})},onPause:()=>{Ts(this,dp,Ng).call(this,{type:"pause"})},onContinue:()=>{Ts(this,dp,Ng).call(this,{type:"continue"})},retry:i.options.retry,retryDelay:i.options.retryDelay,networkMode:i.options.networkMode,canRun:()=>!0})),Ft(this,xu).start()}},Lb=new WeakMap,U_=new WeakMap,lf=new WeakMap,V_=new WeakMap,xu=new WeakMap,d5=new WeakMap,$_=new WeakMap,dp=new WeakSet,Ng=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...zee(r.data,this.options),fetchMeta:t.meta??null};case"success":return Yr(this,U_,void 0),{...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=t.error;return AL(a)&&a.revert&&Ft(this,U_)?{...Ft(this,U_),fetchStatus:"idle"}:{...r,error:a,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),Ql.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),Ft(this,lf).notify({query:this,type:"updated",action:t})})},OY);function zee(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Ree(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Pwe(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var _m,FY,kwe=(FY=class extends kw{constructor(t={}){super();Mi(this,_m);this.config=t,Yr(this,_m,new Map)}build(t,n,r){const a=n.queryKey,l=n.queryHash??BF(a,n);let h=this.get(l);return h||(h=new Ewe({client:t,queryKey:a,queryHash:l,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(a)}),this.add(h)),h}add(t){Ft(this,_m).has(t.queryHash)||(Ft(this,_m).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=Ft(this,_m).get(t.queryHash);n&&(t.destroy(),n===t&&Ft(this,_m).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Ql.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Ft(this,_m).get(t)}getAll(){return[...Ft(this,_m).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>G9(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>G9(t,r)):n}notify(t){Ql.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Ql.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Ql.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},_m=new WeakMap,FY),xm,Gu,q_,bm,p0,zY,Iwe=(zY=class extends Fee{constructor(t){super();Mi(this,bm);Mi(this,xm);Mi(this,Gu);Mi(this,q_);this.mutationId=t.mutationId,Yr(this,Gu,t.mutationCache),Yr(this,xm,[]),this.state=t.state||Bee(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Ft(this,xm).includes(t)||(Ft(this,xm).push(t),this.clearGcTimeout(),Ft(this,Gu).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Yr(this,xm,Ft(this,xm).filter(n=>n!==t)),this.scheduleGc(),Ft(this,Gu).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Ft(this,xm).length||(this.state.status==="pending"?this.scheduleGc():Ft(this,Gu).remove(this))}continue(){var t;return((t=Ft(this,q_))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var l,h,i,y,x,w,C,P,E,j,D,B,F,$,H,J,ee,Q,ne,pe;const n=()=>{Ts(this,bm,p0).call(this,{type:"continue"})};Yr(this,q_,Oee({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(he,we)=>{Ts(this,bm,p0).call(this,{type:"failed",failureCount:he,error:we})},onPause:()=>{Ts(this,bm,p0).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Ft(this,Gu).canRun(this)}));const r=this.state.status==="pending",a=!Ft(this,q_).canStart();try{if(r)n();else{Ts(this,bm,p0).call(this,{type:"pending",variables:t,isPaused:a}),await((h=(l=Ft(this,Gu).config).onMutate)==null?void 0:h.call(l,t,this));const we=await((y=(i=this.options).onMutate)==null?void 0:y.call(i,t));we!==this.state.context&&Ts(this,bm,p0).call(this,{type:"pending",context:we,variables:t,isPaused:a})}const he=await Ft(this,q_).start();return await((w=(x=Ft(this,Gu).config).onSuccess)==null?void 0:w.call(x,he,t,this.state.context,this)),await((P=(C=this.options).onSuccess)==null?void 0:P.call(C,he,t,this.state.context)),await((j=(E=Ft(this,Gu).config).onSettled)==null?void 0:j.call(E,he,null,this.state.variables,this.state.context,this)),await((B=(D=this.options).onSettled)==null?void 0:B.call(D,he,null,t,this.state.context)),Ts(this,bm,p0).call(this,{type:"success",data:he}),he}catch(he){try{throw await(($=(F=Ft(this,Gu).config).onError)==null?void 0:$.call(F,he,t,this.state.context,this)),await((J=(H=this.options).onError)==null?void 0:J.call(H,he,t,this.state.context)),await((Q=(ee=Ft(this,Gu).config).onSettled)==null?void 0:Q.call(ee,void 0,he,this.state.variables,this.state.context,this)),await((pe=(ne=this.options).onSettled)==null?void 0:pe.call(ne,void 0,he,t,this.state.context)),he}finally{Ts(this,bm,p0).call(this,{type:"error",error:he})}}finally{Ft(this,Gu).runNext(this)}}},xm=new WeakMap,Gu=new WeakMap,q_=new WeakMap,bm=new WeakSet,p0=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Ql.batch(()=>{Ft(this,xm).forEach(r=>{r.onMutationUpdate(t)}),Ft(this,Gu).notify({mutation:this,type:"updated",action:t})})},zY);function Bee(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var jg,hp,h5,BY,Nwe=(BY=class extends kw{constructor(t={}){super();Mi(this,jg);Mi(this,hp);Mi(this,h5);this.config=t,Yr(this,jg,new Set),Yr(this,hp,new Map),Yr(this,h5,0)}build(t,n,r){const a=new Iwe({mutationCache:this,mutationId:++SC(this,h5)._,options:t.defaultMutationOptions(n),state:r});return this.add(a),a}add(t){Ft(this,jg).add(t);const n=GC(t);if(typeof n=="string"){const r=Ft(this,hp).get(n);r?r.push(t):Ft(this,hp).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(Ft(this,jg).delete(t)){const n=GC(t);if(typeof n=="string"){const r=Ft(this,hp).get(n);if(r)if(r.length>1){const a=r.indexOf(t);a!==-1&&r.splice(a,1)}else r[0]===t&&Ft(this,hp).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=GC(t);if(typeof n=="string"){const r=Ft(this,hp).get(n),a=r==null?void 0:r.find(l=>l.state.status==="pending");return!a||a===t}else return!0}runNext(t){var r;const n=GC(t);if(typeof n=="string"){const a=(r=Ft(this,hp).get(n))==null?void 0:r.find(l=>l!==t&&l.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Ql.batch(()=>{Ft(this,jg).forEach(t=>{this.notify({type:"removed",mutation:t})}),Ft(this,jg).clear(),Ft(this,hp).clear()})}getAll(){return Array.from(Ft(this,jg))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>H9(n,r))}findAll(t={}){return this.getAll().filter(n=>H9(t,n))}notify(t){Ql.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Ql.batch(()=>Promise.all(t.map(n=>n.continue().catch(Yu))))}},jg=new WeakMap,hp=new WeakMap,h5=new WeakMap,BY);function GC(e){var t;return(t=e.options.scope)==null?void 0:t.id}function K9(e){return{onFetch:(t,n)=>{var w,C,P,E,j;const r=t.options,a=(P=(C=(w=t.fetchOptions)==null?void 0:w.meta)==null?void 0:C.fetchMore)==null?void 0:P.direction,l=((E=t.state.data)==null?void 0:E.pages)||[],h=((j=t.state.data)==null?void 0:j.pageParams)||[];let i={pages:[],pageParams:[]},y=0;const x=async()=>{let D=!1;const B=H=>{Object.defineProperty(H,"signal",{enumerable:!0,get:()=>(t.signal.aborted?D=!0:t.signal.addEventListener("abort",()=>{D=!0}),t.signal)})},F=Lee(t.options,t.fetchOptions),$=async(H,J,ee)=>{if(D)return Promise.reject();if(J==null&&H.pages.length)return Promise.resolve(H);const ne=(()=>{const fe={client:t.client,queryKey:t.queryKey,pageParam:J,direction:ee?"backward":"forward",meta:t.options.meta};return B(fe),fe})(),pe=await F(ne),{maxPages:he}=t.options,we=ee?bwe:xwe;return{pages:we(H.pages,pe,he),pageParams:we(H.pageParams,J,he)}};if(a&&l.length){const H=a==="backward",J=H?Mwe:Y9,ee={pages:l,pageParams:h},Q=J(r,ee);i=await $(ee,Q,H)}else{const H=e??l.length;do{const J=y===0?h[0]??r.initialPageParam:Y9(r,i);if(y>0&&J==null)break;i=await $(i,J),y++}while(y<H)}return i};t.options.persister?t.fetchFn=()=>{var D,B;return(B=(D=t.options).persister)==null?void 0:B.call(D,x,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=x}}}function Y9(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function Mwe(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var nl,I0,N0,Db,Rb,M0,jb,Ob,UY,Lwe=(UY=class{constructor(e={}){Mi(this,nl);Mi(this,I0);Mi(this,N0);Mi(this,Db);Mi(this,Rb);Mi(this,M0);Mi(this,jb);Mi(this,Ob);Yr(this,nl,e.queryCache||new kwe),Yr(this,I0,e.mutationCache||new Nwe),Yr(this,N0,e.defaultOptions||{}),Yr(this,Db,new Map),Yr(this,Rb,new Map),Yr(this,M0,0)}mount(){SC(this,M0)._++,Ft(this,M0)===1&&(Yr(this,jb,VF.subscribe(async e=>{e&&(await this.resumePausedMutations(),Ft(this,nl).onFocus())})),Yr(this,Ob,HP.subscribe(async e=>{e&&(await this.resumePausedMutations(),Ft(this,nl).onOnline())})))}unmount(){var e,t;SC(this,M0)._--,Ft(this,M0)===0&&((e=Ft(this,jb))==null||e.call(this),Yr(this,jb,void 0),(t=Ft(this,Ob))==null||t.call(this),Yr(this,Ob,void 0))}isFetching(e){return Ft(this,nl).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Ft(this,I0).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=Ft(this,nl).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=Ft(this,nl).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(Q0(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return Ft(this,nl).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),a=Ft(this,nl).get(r.queryHash),l=a==null?void 0:a.state.data,h=vwe(t,l);if(h!==void 0)return Ft(this,nl).build(this,r).setData(h,{...n,manual:!0})}setQueriesData(e,t,n){return Ql.batch(()=>Ft(this,nl).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=Ft(this,nl).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=Ft(this,nl);Ql.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=Ft(this,nl);return Ql.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=Ql.batch(()=>Ft(this,nl).findAll(e).map(a=>a.cancel(n)));return Promise.all(r).then(Yu).catch(Yu)}invalidateQueries(e,t={}){return Ql.batch(()=>(Ft(this,nl).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=Ql.batch(()=>Ft(this,nl).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let l=a.fetch(void 0,n);return n.throwOnError||(l=l.catch(Yu)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(r).then(Yu)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=Ft(this,nl).build(this,t);return n.isStaleByTime(Q0(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Yu).catch(Yu)}fetchInfiniteQuery(e){return e.behavior=K9(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Yu).catch(Yu)}ensureInfiniteQueryData(e){return e.behavior=K9(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return HP.isOnline()?Ft(this,I0).resumePausedMutations():Promise.resolve()}getQueryCache(){return Ft(this,nl)}getMutationCache(){return Ft(this,I0)}getDefaultOptions(){return Ft(this,N0)}setDefaultOptions(e){Yr(this,N0,e)}setQueryDefaults(e,t){Ft(this,Db).set(hx(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Ft(this,Db).values()],n={};return t.forEach(r=>{LA(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){Ft(this,Rb).set(hx(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Ft(this,Rb).values()],n={};return t.forEach(r=>{LA(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Ft(this,N0).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=BF(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===UF&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Ft(this,N0).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Ft(this,nl).clear(),Ft(this,I0).clear()}},nl=new WeakMap,I0=new WeakMap,N0=new WeakMap,Db=new WeakMap,Rb=new WeakMap,M0=new WeakMap,jb=new WeakMap,Ob=new WeakMap,UY),Md,ta,f5,Hu,G_,Fb,L0,D0,p5,zb,Bb,H_,W_,R0,Ub,Ea,PS,cR,uR,dR,hR,fR,pR,mR,Uee,VY,Dwe=(VY=class extends kw{constructor(t,n){super();Mi(this,Ea);Mi(this,Md);Mi(this,ta);Mi(this,f5);Mi(this,Hu);Mi(this,G_);Mi(this,Fb);Mi(this,L0);Mi(this,D0);Mi(this,p5);Mi(this,zb);Mi(this,Bb);Mi(this,H_);Mi(this,W_);Mi(this,R0);Mi(this,Ub,new Set);this.options=n,Yr(this,Md,t),Yr(this,D0,null),Yr(this,L0,lR()),this.options.experimental_prefetchInRender||Ft(this,L0).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(Ft(this,ta).addObserver(this),X9(Ft(this,ta),this.options)?Ts(this,Ea,PS).call(this):this.updateResult(),Ts(this,Ea,hR).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return gR(Ft(this,ta),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return gR(Ft(this,ta),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Ts(this,Ea,fR).call(this),Ts(this,Ea,pR).call(this),Ft(this,ta).removeObserver(this)}setOptions(t){const n=this.options,r=Ft(this,ta);if(this.options=Ft(this,Md).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof cf(this.options.enabled,Ft(this,ta))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Ts(this,Ea,mR).call(this),Ft(this,ta).setOptions(this.options),n._defaulted&&!GP(this.options,n)&&Ft(this,Md).getQueryCache().notify({type:"observerOptionsUpdated",query:Ft(this,ta),observer:this});const a=this.hasListeners();a&&J9(Ft(this,ta),r,this.options,n)&&Ts(this,Ea,PS).call(this),this.updateResult(),a&&(Ft(this,ta)!==r||cf(this.options.enabled,Ft(this,ta))!==cf(n.enabled,Ft(this,ta))||Q0(this.options.staleTime,Ft(this,ta))!==Q0(n.staleTime,Ft(this,ta)))&&Ts(this,Ea,cR).call(this);const l=Ts(this,Ea,uR).call(this);a&&(Ft(this,ta)!==r||cf(this.options.enabled,Ft(this,ta))!==cf(n.enabled,Ft(this,ta))||l!==Ft(this,R0))&&Ts(this,Ea,dR).call(this,l)}getOptimisticResult(t){const n=Ft(this,Md).getQueryCache().build(Ft(this,Md),t),r=this.createResult(n,t);return jwe(this,r)&&(Yr(this,Hu,r),Yr(this,Fb,this.options),Yr(this,G_,Ft(this,ta).state)),r}getCurrentResult(){return Ft(this,Hu)}trackResult(t,n){return new Proxy(t,{get:(r,a)=>(this.trackProp(a),n==null||n(a),Reflect.get(r,a))})}trackProp(t){Ft(this,Ub).add(t)}getCurrentQuery(){return Ft(this,ta)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=Ft(this,Md).defaultQueryOptions(t),r=Ft(this,Md).getQueryCache().build(Ft(this,Md),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return Ts(this,Ea,PS).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),Ft(this,Hu)))}createResult(t,n){var he;const r=Ft(this,ta),a=this.options,l=Ft(this,Hu),h=Ft(this,G_),i=Ft(this,Fb),x=t!==r?t.state:Ft(this,f5),{state:w}=t;let C={...w},P=!1,E;if(n._optimisticResults){const we=this.hasListeners(),fe=!we&&X9(t,n),ge=we&&J9(t,r,n,a);(fe||ge)&&(C={...C,...zee(w.data,t.options)}),n._optimisticResults==="isRestoring"&&(C.fetchStatus="idle")}let{error:j,errorUpdatedAt:D,status:B}=C;E=C.data;let F=!1;if(n.placeholderData!==void 0&&E===void 0&&B==="pending"){let we;l!=null&&l.isPlaceholderData&&n.placeholderData===(i==null?void 0:i.placeholderData)?(we=l.data,F=!0):we=typeof n.placeholderData=="function"?n.placeholderData((he=Ft(this,Bb))==null?void 0:he.state.data,Ft(this,Bb)):n.placeholderData,we!==void 0&&(B="success",E=oR(l==null?void 0:l.data,we,n),P=!0)}if(n.select&&E!==void 0&&!F)if(l&&E===(h==null?void 0:h.data)&&n.select===Ft(this,p5))E=Ft(this,zb);else try{Yr(this,p5,n.select),E=n.select(E),E=oR(l==null?void 0:l.data,E,n),Yr(this,zb,E),Yr(this,D0,null)}catch(we){Yr(this,D0,we)}Ft(this,D0)&&(j=Ft(this,D0),E=Ft(this,zb),D=Date.now(),B="error");const $=C.fetchStatus==="fetching",H=B==="pending",J=B==="error",ee=H&&$,Q=E!==void 0,pe={status:B,fetchStatus:C.fetchStatus,isPending:H,isSuccess:B==="success",isError:J,isInitialLoading:ee,isLoading:ee,data:E,dataUpdatedAt:C.dataUpdatedAt,error:j,errorUpdatedAt:D,failureCount:C.fetchFailureCount,failureReason:C.fetchFailureReason,errorUpdateCount:C.errorUpdateCount,isFetched:C.dataUpdateCount>0||C.errorUpdateCount>0,isFetchedAfterMount:C.dataUpdateCount>x.dataUpdateCount||C.errorUpdateCount>x.errorUpdateCount,isFetching:$,isRefetching:$&&!H,isLoadingError:J&&!Q,isPaused:C.fetchStatus==="paused",isPlaceholderData:P,isRefetchError:J&&Q,isStale:$F(t,n),refetch:this.refetch,promise:Ft(this,L0),isEnabled:cf(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const we=Ce=>{pe.status==="error"?Ce.reject(pe.error):pe.data!==void 0&&Ce.resolve(pe.data)},fe=()=>{const Ce=Yr(this,L0,pe.promise=lR());we(Ce)},ge=Ft(this,L0);switch(ge.status){case"pending":t.queryHash===r.queryHash&&we(ge);break;case"fulfilled":(pe.status==="error"||pe.data!==ge.value)&&fe();break;case"rejected":(pe.status!=="error"||pe.error!==ge.reason)&&fe();break}}return pe}updateResult(){const t=Ft(this,Hu),n=this.createResult(Ft(this,ta),this.options);if(Yr(this,G_,Ft(this,ta).state),Yr(this,Fb,this.options),Ft(this,G_).data!==void 0&&Yr(this,Bb,Ft(this,ta)),GP(n,t))return;Yr(this,Hu,n);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:a}=this.options,l=typeof a=="function"?a():a;if(l==="all"||!l&&!Ft(this,Ub).size)return!0;const h=new Set(l??Ft(this,Ub));return this.options.throwOnError&&h.add("error"),Object.keys(Ft(this,Hu)).some(i=>{const y=i;return Ft(this,Hu)[y]!==t[y]&&h.has(y)})};Ts(this,Ea,Uee).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Ts(this,Ea,hR).call(this)}},Md=new WeakMap,ta=new WeakMap,f5=new WeakMap,Hu=new WeakMap,G_=new WeakMap,Fb=new WeakMap,L0=new WeakMap,D0=new WeakMap,p5=new WeakMap,zb=new WeakMap,Bb=new WeakMap,H_=new WeakMap,W_=new WeakMap,R0=new WeakMap,Ub=new WeakMap,Ea=new WeakSet,PS=function(t){Ts(this,Ea,mR).call(this);let n=Ft(this,ta).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(Yu)),n},cR=function(){Ts(this,Ea,fR).call(this);const t=Q0(this.options.staleTime,Ft(this,ta));if(dx||Ft(this,Hu).isStale||!sR(t))return;const r=Nee(Ft(this,Hu).dataUpdatedAt,t)+1;Yr(this,H_,setTimeout(()=>{Ft(this,Hu).isStale||this.updateResult()},r))},uR=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(Ft(this,ta)):this.options.refetchInterval)??!1},dR=function(t){Ts(this,Ea,pR).call(this),Yr(this,R0,t),!(dx||cf(this.options.enabled,Ft(this,ta))===!1||!sR(Ft(this,R0))||Ft(this,R0)===0)&&Yr(this,W_,setInterval(()=>{(this.options.refetchIntervalInBackground||VF.isFocused())&&Ts(this,Ea,PS).call(this)},Ft(this,R0)))},hR=function(){Ts(this,Ea,cR).call(this),Ts(this,Ea,dR).call(this,Ts(this,Ea,uR).call(this))},fR=function(){Ft(this,H_)&&(clearTimeout(Ft(this,H_)),Yr(this,H_,void 0))},pR=function(){Ft(this,W_)&&(clearInterval(Ft(this,W_)),Yr(this,W_,void 0))},mR=function(){const t=Ft(this,Md).getQueryCache().build(Ft(this,Md),this.options);if(t===Ft(this,ta))return;const n=Ft(this,ta);Yr(this,ta,t),Yr(this,f5,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},Uee=function(t){Ql.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(Ft(this,Hu))}),Ft(this,Md).getQueryCache().notify({query:Ft(this,ta),type:"observerResultsUpdated"})})},VY);function Rwe(e,t){return cf(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function X9(e,t){return Rwe(e,t)||e.state.data!==void 0&&gR(e,t,t.refetchOnMount)}function gR(e,t,n){if(cf(t.enabled,e)!==!1&&Q0(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&$F(e,t)}return!1}function J9(e,t,n,r){return(e!==t||cf(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&$F(e,n)}function $F(e,t){return cf(t.enabled,e)!==!1&&e.isStaleByTime(Q0(t.staleTime,e))}function jwe(e,t){return!GP(e.getCurrentResult(),t)}var j0,O0,Ld,Og,Xg,KE,yR,$Y,Owe=($Y=class extends kw{constructor(n,r){super();Mi(this,Xg);Mi(this,j0);Mi(this,O0);Mi(this,Ld);Mi(this,Og);Yr(this,j0,n),this.setOptions(r),this.bindMethods(),Ts(this,Xg,KE).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var a;const r=this.options;this.options=Ft(this,j0).defaultMutationOptions(n),GP(this.options,r)||Ft(this,j0).getMutationCache().notify({type:"observerOptionsUpdated",mutation:Ft(this,Ld),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&hx(r.mutationKey)!==hx(this.options.mutationKey)?this.reset():((a=Ft(this,Ld))==null?void 0:a.state.status)==="pending"&&Ft(this,Ld).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=Ft(this,Ld))==null||n.removeObserver(this)}onMutationUpdate(n){Ts(this,Xg,KE).call(this),Ts(this,Xg,yR).call(this,n)}getCurrentResult(){return Ft(this,O0)}reset(){var n;(n=Ft(this,Ld))==null||n.removeObserver(this),Yr(this,Ld,void 0),Ts(this,Xg,KE).call(this),Ts(this,Xg,yR).call(this)}mutate(n,r){var a;return Yr(this,Og,r),(a=Ft(this,Ld))==null||a.removeObserver(this),Yr(this,Ld,Ft(this,j0).getMutationCache().build(Ft(this,j0),this.options)),Ft(this,Ld).addObserver(this),Ft(this,Ld).execute(n)}},j0=new WeakMap,O0=new WeakMap,Ld=new WeakMap,Og=new WeakMap,Xg=new WeakSet,KE=function(){var r;const n=((r=Ft(this,Ld))==null?void 0:r.state)??Bee();Yr(this,O0,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},yR=function(n){Ql.batch(()=>{var r,a,l,h,i,y,x,w;if(Ft(this,Og)&&this.hasListeners()){const C=Ft(this,O0).variables,P=Ft(this,O0).context;(n==null?void 0:n.type)==="success"?((a=(r=Ft(this,Og)).onSuccess)==null||a.call(r,n.data,C,P),(h=(l=Ft(this,Og)).onSettled)==null||h.call(l,n.data,null,C,P)):(n==null?void 0:n.type)==="error"&&((y=(i=Ft(this,Og)).onError)==null||y.call(i,n.error,C,P),(w=(x=Ft(this,Og)).onSettled)==null||w.call(x,void 0,n.error,C,P))}this.listeners.forEach(C=>{C(Ft(this,O0))})})},$Y),Vee=L.createContext(void 0),gy=e=>{const t=L.useContext(Vee);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Fwe=({client:e,children:t})=>(L.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),v.jsx(Vee.Provider,{value:e,children:t})),$ee=L.createContext(!1),zwe=()=>L.useContext($ee);$ee.Provider;function Bwe(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Uwe=L.createContext(Bwe()),Vwe=()=>L.useContext(Uwe),$we=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},qwe=e=>{L.useEffect(()=>{e.clearReset()},[e])},Gwe=({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(a&&e.data===void 0||Dee(n,[e.error,r])),Hwe=e=>{if(e.suspense){const t=r=>r==="static"?r:Math.max(r??1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...r)=>t(n(...r)):t(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},Wwe=(e,t)=>e.isLoading&&e.isFetching&&!t,Zwe=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,Q9=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function Kwe(e,t,n){var C,P,E,j,D;const r=zwe(),a=Vwe(),l=gy(),h=l.defaultQueryOptions(e);(P=(C=l.getDefaultOptions().queries)==null?void 0:C._experimental_beforeQuery)==null||P.call(C,h),h._optimisticResults=r?"isRestoring":"optimistic",Hwe(h),$we(h,a),qwe(a);const i=!l.getQueryCache().get(h.queryHash),[y]=L.useState(()=>new t(l,h)),x=y.getOptimisticResult(h),w=!r&&e.subscribed!==!1;if(L.useSyncExternalStore(L.useCallback(B=>{const F=w?y.subscribe(Ql.batchCalls(B)):Yu;return y.updateResult(),F},[y,w]),()=>y.getCurrentResult(),()=>y.getCurrentResult()),L.useEffect(()=>{y.setOptions(h)},[h,y]),Zwe(h,x))throw Q9(h,y,a);if(Gwe({result:x,errorResetBoundary:a,throwOnError:h.throwOnError,query:l.getQueryCache().get(h.queryHash),suspense:h.suspense}))throw x.error;if((j=(E=l.getDefaultOptions().queries)==null?void 0:E._experimental_afterQuery)==null||j.call(E,h,x),h.experimental_prefetchInRender&&!dx&&Wwe(x,r)){const B=i?Q9(h,y,a):(D=l.getQueryCache().get(h.queryHash))==null?void 0:D.promise;B==null||B.catch(Yu).finally(()=>{y.updateResult()})}return h.notifyOnChangeProps?x:y.trackResult(x)}function Lh(e,t){return Kwe(e,Dwe)}function Av(e,t){const n=gy(),[r]=L.useState(()=>new Owe(n,e));L.useEffect(()=>{r.setOptions(e)},[r,e]);const a=L.useSyncExternalStore(L.useCallback(h=>r.subscribe(Ql.batchCalls(h)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),l=L.useCallback((h,i)=>{r.mutate(h,i).catch(Yu)},[r]);if(a.error&&Dee(r.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:l,mutateAsync:a.mutate}}/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function DA(){return DA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},DA.apply(this,arguments)}var B0;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(B0||(B0={}));const eq="popstate";function Ywe(e){e===void 0&&(e={});function t(r,a){let{pathname:l,search:h,hash:i}=r.location;return vR("",{pathname:l,search:h,hash:i},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:WP(a)}return Jwe(t,n,null,e)}function cl(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function qee(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Xwe(){return Math.random().toString(36).substr(2,8)}function tq(e,t){return{usr:e.state,key:e.key,idx:t}}function vR(e,t,n,r){return n===void 0&&(n=null),DA({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Iw(t):t,{state:n,key:t&&t.key||r||Xwe()})}function WP(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Iw(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function Jwe(e,t,n,r){r===void 0&&(r={});let{window:a=document.defaultView,v5Compat:l=!1}=r,h=a.history,i=B0.Pop,y=null,x=w();x==null&&(x=0,h.replaceState(DA({},h.state,{idx:x}),""));function w(){return(h.state||{idx:null}).idx}function C(){i=B0.Pop;let B=w(),F=B==null?null:B-x;x=B,y&&y({action:i,location:D.location,delta:F})}function P(B,F){i=B0.Push;let $=vR(D.location,B,F);x=w()+1;let H=tq($,x),J=D.createHref($);try{h.pushState(H,"",J)}catch(ee){if(ee instanceof DOMException&&ee.name==="DataCloneError")throw ee;a.location.assign(J)}l&&y&&y({action:i,location:D.location,delta:1})}function E(B,F){i=B0.Replace;let $=vR(D.location,B,F);x=w();let H=tq($,x),J=D.createHref($);h.replaceState(H,"",J),l&&y&&y({action:i,location:D.location,delta:0})}function j(B){let F=a.location.origin!=="null"?a.location.origin:a.location.href,$=typeof B=="string"?B:WP(B);return $=$.replace(/ $/,"%20"),cl(F,"No window.location.(origin|href) available to create URL for href: "+$),new URL($,F)}let D={get action(){return i},get location(){return e(a,h)},listen(B){if(y)throw new Error("A history only accepts one active listener");return a.addEventListener(eq,C),y=B,()=>{a.removeEventListener(eq,C),y=null}},createHref(B){return t(a,B)},createURL:j,encodeLocation(B){let F=j(B);return{pathname:F.pathname,search:F.search,hash:F.hash}},push:P,replace:E,go(B){return h.go(B)}};return D}var nq;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(nq||(nq={}));function Qwe(e,t,n){return n===void 0&&(n="/"),e2e(e,t,n,!1)}function e2e(e,t,n,r){let a=typeof t=="string"?Iw(t):t,l=Qb(a.pathname||"/",n);if(l==null)return null;let h=Gee(e);t2e(h);let i=null;for(let y=0;i==null&&y<h.length;++y){let x=h2e(l);i=u2e(h[y],x,r)}return i}function Gee(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let a=(l,h,i)=>{let y={relativePath:i===void 0?l.path||"":i,caseSensitive:l.caseSensitive===!0,childrenIndex:h,route:l};y.relativePath.startsWith("/")&&(cl(y.relativePath.startsWith(r),'Absolute route path "'+y.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),y.relativePath=y.relativePath.slice(r.length));let x=ev([r,y.relativePath]),w=n.concat(y);l.children&&l.children.length>0&&(cl(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+x+'".')),Gee(l.children,t,w,x)),!(l.path==null&&!l.index)&&t.push({path:x,score:l2e(x,l.index),routesMeta:w})};return e.forEach((l,h)=>{var i;if(l.path===""||!((i=l.path)!=null&&i.includes("?")))a(l,h);else for(let y of Hee(l.path))a(l,h,y)}),t}function Hee(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(r.length===0)return a?[l,""]:[l];let h=Hee(r.join("/")),i=[];return i.push(...h.map(y=>y===""?l:[l,y].join("/"))),a&&i.push(...h),i.map(y=>e.startsWith("/")&&y===""?"/":y)}function t2e(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:c2e(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const n2e=/^:[\w-]+$/,r2e=3,i2e=2,s2e=1,a2e=10,o2e=-2,rq=e=>e==="*";function l2e(e,t){let n=e.split("/"),r=n.length;return n.some(rq)&&(r+=o2e),t&&(r+=i2e),n.filter(a=>!rq(a)).reduce((a,l)=>a+(n2e.test(l)?r2e:l===""?s2e:a2e),r)}function c2e(e,t){return e.length===t.length&&e.slice(0,-1).every((r,a)=>r===t[a])?e[e.length-1]-t[t.length-1]:0}function u2e(e,t,n){let{routesMeta:r}=e,a={},l="/",h=[];for(let i=0;i<r.length;++i){let y=r[i],x=i===r.length-1,w=l==="/"?t:t.slice(l.length)||"/",C=ZP({path:y.relativePath,caseSensitive:y.caseSensitive,end:x},w),P=y.route;if(!C&&x&&n&&!r[r.length-1].route.index&&(C=ZP({path:y.relativePath,caseSensitive:y.caseSensitive,end:!1},w)),!C)return null;Object.assign(a,C.params),h.push({params:a,pathname:ev([l,C.pathname]),pathnameBase:g2e(ev([l,C.pathnameBase])),route:P}),C.pathnameBase!=="/"&&(l=ev([l,C.pathnameBase]))}return h}function ZP(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=d2e(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let l=a[0],h=l.replace(/(.)\/+$/,"$1"),i=a.slice(1);return{params:r.reduce((x,w,C)=>{let{paramName:P,isOptional:E}=w;if(P==="*"){let D=i[C]||"";h=l.slice(0,l.length-D.length).replace(/(.)\/+$/,"$1")}const j=i[C];return E&&!j?x[P]=void 0:x[P]=(j||"").replace(/%2F/g,"/"),x},{}),pathname:l,pathnameBase:h,pattern:e}}function d2e(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),qee(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,i,y)=>(r.push({paramName:i,isOptional:y!=null}),y?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function h2e(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return qee(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Qb(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function f2e(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:a=""}=typeof e=="string"?Iw(e):e;return{pathname:n?n.startsWith("/")?n:p2e(n,t):t,search:y2e(r),hash:v2e(a)}}function p2e(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function TL(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function m2e(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Wee(e,t){let n=m2e(e);return t?n.map((r,a)=>a===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Zee(e,t,n,r){r===void 0&&(r=!1);let a;typeof e=="string"?a=Iw(e):(a=DA({},e),cl(!a.pathname||!a.pathname.includes("?"),TL("?","pathname","search",a)),cl(!a.pathname||!a.pathname.includes("#"),TL("#","pathname","hash",a)),cl(!a.search||!a.search.includes("#"),TL("#","search","hash",a)));let l=e===""||a.pathname==="",h=l?"/":a.pathname,i;if(h==null)i=n;else{let C=t.length-1;if(!r&&h.startsWith("..")){let P=h.split("/");for(;P[0]==="..";)P.shift(),C-=1;a.pathname=P.join("/")}i=C>=0?t[C]:"/"}let y=f2e(a,i),x=h&&h!=="/"&&h.endsWith("/"),w=(l||h===".")&&n.endsWith("/");return!y.pathname.endsWith("/")&&(x||w)&&(y.pathname+="/"),y}const ev=e=>e.join("/").replace(/\/\/+/g,"/"),g2e=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),y2e=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,v2e=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function _2e(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Kee=["post","put","patch","delete"];new Set(Kee);const x2e=["get",...Kee];new Set(x2e);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function RA(){return RA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},RA.apply(this,arguments)}const V3=L.createContext(null),Yee=L.createContext(null),Tv=L.createContext(null),$3=L.createContext(null),Cv=L.createContext({outlet:null,matches:[],isDataRoute:!1}),Xee=L.createContext(null);function b2e(e,t){let{relative:n}=t===void 0?{}:t;T5()||cl(!1);let{basename:r,navigator:a}=L.useContext(Tv),{hash:l,pathname:h,search:i}=q3(e,{relative:n}),y=h;return r!=="/"&&(y=h==="/"?r:ev([r,h])),a.createHref({pathname:y,search:i,hash:l})}function T5(){return L.useContext($3)!=null}function Ix(){return T5()||cl(!1),L.useContext($3).location}function Jee(e){L.useContext(Tv).static||L.useLayoutEffect(e)}function qF(){let{isDataRoute:e}=L.useContext(Cv);return e?j2e():w2e()}function w2e(){T5()||cl(!1);let e=L.useContext(V3),{basename:t,future:n,navigator:r}=L.useContext(Tv),{matches:a}=L.useContext(Cv),{pathname:l}=Ix(),h=JSON.stringify(Wee(a,n.v7_relativeSplatPath)),i=L.useRef(!1);return Jee(()=>{i.current=!0}),L.useCallback(function(x,w){if(w===void 0&&(w={}),!i.current)return;if(typeof x=="number"){r.go(x);return}let C=Zee(x,JSON.parse(h),l,w.relative==="path");e==null&&t!=="/"&&(C.pathname=C.pathname==="/"?t:ev([t,C.pathname])),(w.replace?r.replace:r.push)(C,w.state,w)},[t,r,h,l,e])}const S2e=L.createContext(null);function A2e(e){let t=L.useContext(Cv).outlet;return t&&L.createElement(S2e.Provider,{value:e},t)}function q3(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=L.useContext(Tv),{matches:a}=L.useContext(Cv),{pathname:l}=Ix(),h=JSON.stringify(Wee(a,r.v7_relativeSplatPath));return L.useMemo(()=>Zee(e,JSON.parse(h),l,n==="path"),[e,h,l,n])}function T2e(e,t){return C2e(e,t)}function C2e(e,t,n,r){T5()||cl(!1);let{navigator:a}=L.useContext(Tv),{matches:l}=L.useContext(Cv),h=l[l.length-1],i=h?h.params:{};h&&h.pathname;let y=h?h.pathnameBase:"/";h&&h.route;let x=Ix(),w;if(t){var C;let B=typeof t=="string"?Iw(t):t;y==="/"||(C=B.pathname)!=null&&C.startsWith(y)||cl(!1),w=B}else w=x;let P=w.pathname||"/",E=P;if(y!=="/"){let B=y.replace(/^\//,"").split("/");E="/"+P.replace(/^\//,"").split("/").slice(B.length).join("/")}let j=Qwe(e,{pathname:E}),D=N2e(j&&j.map(B=>Object.assign({},B,{params:Object.assign({},i,B.params),pathname:ev([y,a.encodeLocation?a.encodeLocation(B.pathname).pathname:B.pathname]),pathnameBase:B.pathnameBase==="/"?y:ev([y,a.encodeLocation?a.encodeLocation(B.pathnameBase).pathname:B.pathnameBase])})),l,n,r);return t&&D?L.createElement($3.Provider,{value:{location:RA({pathname:"/",search:"",hash:"",state:null,key:"default"},w),navigationType:B0.Pop}},D):D}function E2e(){let e=R2e(),t=_2e(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return L.createElement(L.Fragment,null,L.createElement("h2",null,"Unexpected Application Error!"),L.createElement("h3",{style:{fontStyle:"italic"}},t),n?L.createElement("pre",{style:a},n):null,null)}const P2e=L.createElement(E2e,null);class k2e extends L.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?L.createElement(Cv.Provider,{value:this.props.routeContext},L.createElement(Xee.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function I2e(e){let{routeContext:t,match:n,children:r}=e,a=L.useContext(V3);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),L.createElement(Cv.Provider,{value:t},r)}function N2e(e,t,n,r){var a;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var l;if(!n)return null;if(n.errors)e=n.matches;else if((l=r)!=null&&l.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let h=e,i=(a=n)==null?void 0:a.errors;if(i!=null){let w=h.findIndex(C=>C.route.id&&(i==null?void 0:i[C.route.id])!==void 0);w>=0||cl(!1),h=h.slice(0,Math.min(h.length,w+1))}let y=!1,x=-1;if(n&&r&&r.v7_partialHydration)for(let w=0;w<h.length;w++){let C=h[w];if((C.route.HydrateFallback||C.route.hydrateFallbackElement)&&(x=w),C.route.id){let{loaderData:P,errors:E}=n,j=C.route.loader&&P[C.route.id]===void 0&&(!E||E[C.route.id]===void 0);if(C.route.lazy||j){y=!0,x>=0?h=h.slice(0,x+1):h=[h[0]];break}}}return h.reduceRight((w,C,P)=>{let E,j=!1,D=null,B=null;n&&(E=i&&C.route.id?i[C.route.id]:void 0,D=C.route.errorElement||P2e,y&&(x<0&&P===0?(j=!0,B=null):x===P&&(j=!0,B=C.route.hydrateFallbackElement||null)));let F=t.concat(h.slice(0,P+1)),$=()=>{let H;return E?H=D:j?H=B:C.route.Component?H=L.createElement(C.route.Component,null):C.route.element?H=C.route.element:H=w,L.createElement(I2e,{match:C,routeContext:{outlet:w,matches:F,isDataRoute:n!=null},children:H})};return n&&(C.route.ErrorBoundary||C.route.errorElement||P===0)?L.createElement(k2e,{location:n.location,revalidation:n.revalidation,component:D,error:E,children:$(),routeContext:{outlet:null,matches:F,isDataRoute:!0}}):$()},null)}var Qee=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Qee||{}),KP=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(KP||{});function M2e(e){let t=L.useContext(V3);return t||cl(!1),t}function L2e(e){let t=L.useContext(Yee);return t||cl(!1),t}function D2e(e){let t=L.useContext(Cv);return t||cl(!1),t}function ete(e){let t=D2e(),n=t.matches[t.matches.length-1];return n.route.id||cl(!1),n.route.id}function R2e(){var e;let t=L.useContext(Xee),n=L2e(KP.UseRouteError),r=ete(KP.UseRouteError);return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function j2e(){let{router:e}=M2e(Qee.UseNavigateStable),t=ete(KP.UseNavigateStable),n=L.useRef(!1);return Jee(()=>{n.current=!0}),L.useCallback(function(a,l){l===void 0&&(l={}),n.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,RA({fromRouteId:t},l)))},[e,t])}function O2e(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function F2e(e){return A2e(e.context)}function op(e){cl(!1)}function z2e(e){let{basename:t="/",children:n=null,location:r,navigationType:a=B0.Pop,navigator:l,static:h=!1,future:i}=e;T5()&&cl(!1);let y=t.replace(/^\/*/,"/"),x=L.useMemo(()=>({basename:y,navigator:l,static:h,future:RA({v7_relativeSplatPath:!1},i)}),[y,i,l,h]);typeof r=="string"&&(r=Iw(r));let{pathname:w="/",search:C="",hash:P="",state:E=null,key:j="default"}=r,D=L.useMemo(()=>{let B=Qb(w,y);return B==null?null:{location:{pathname:B,search:C,hash:P,state:E,key:j},navigationType:a}},[y,w,C,P,E,j,a]);return D==null?null:L.createElement(Tv.Provider,{value:x},L.createElement($3.Provider,{children:n,value:D}))}function B2e(e){let{children:t,location:n}=e;return T2e(_R(t),n)}new Promise(()=>{});function _R(e,t){t===void 0&&(t=[]);let n=[];return L.Children.forEach(e,(r,a)=>{if(!L.isValidElement(r))return;let l=[...t,a];if(r.type===L.Fragment){n.push.apply(n,_R(r.props.children,l));return}r.type!==op&&cl(!1),!r.props.index||!r.props.children||cl(!1);let h={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(h.children=_R(r.props.children,l)),n.push(h)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function YP(){return YP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},YP.apply(this,arguments)}function tte(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,l;for(l=0;l<r.length;l++)a=r[l],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function U2e(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function V2e(e,t){return e.button===0&&(!t||t==="_self")&&!U2e(e)}const $2e=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],q2e=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],G2e="6";try{window.__reactRouterVersion=G2e}catch{}const H2e=L.createContext({isTransitioning:!1}),W2e="startTransition",iq=f3[W2e];function Z2e(e){let{basename:t,children:n,future:r,window:a}=e,l=L.useRef();l.current==null&&(l.current=Ywe({window:a,v5Compat:!0}));let h=l.current,[i,y]=L.useState({action:h.action,location:h.location}),{v7_startTransition:x}=r||{},w=L.useCallback(C=>{x&&iq?iq(()=>y(C)):y(C)},[y,x]);return L.useLayoutEffect(()=>h.listen(w),[h,w]),L.useEffect(()=>O2e(r),[r]),L.createElement(z2e,{basename:t,children:n,location:i.location,navigationType:i.action,navigator:h,future:r})}const K2e=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Y2e=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,X2e=L.forwardRef(function(t,n){let{onClick:r,relative:a,reloadDocument:l,replace:h,state:i,target:y,to:x,preventScrollReset:w,viewTransition:C}=t,P=tte(t,$2e),{basename:E}=L.useContext(Tv),j,D=!1;if(typeof x=="string"&&Y2e.test(x)&&(j=x,K2e))try{let H=new URL(window.location.href),J=x.startsWith("//")?new URL(H.protocol+x):new URL(x),ee=Qb(J.pathname,E);J.origin===H.origin&&ee!=null?x=ee+J.search+J.hash:D=!0}catch{}let B=b2e(x,{relative:a}),F=eSe(x,{replace:h,state:i,target:y,preventScrollReset:w,relative:a,viewTransition:C});function $(H){r&&r(H),H.defaultPrevented||F(H)}return L.createElement("a",YP({},P,{href:j||B,onClick:D||l?r:$,ref:n,target:y}))}),J2e=L.forwardRef(function(t,n){let{"aria-current":r="page",caseSensitive:a=!1,className:l="",end:h=!1,style:i,to:y,viewTransition:x,children:w}=t,C=tte(t,q2e),P=q3(y,{relative:C.relative}),E=Ix(),j=L.useContext(Yee),{navigator:D,basename:B}=L.useContext(Tv),F=j!=null&&tSe(P)&&x===!0,$=D.encodeLocation?D.encodeLocation(P).pathname:P.pathname,H=E.pathname,J=j&&j.navigation&&j.navigation.location?j.navigation.location.pathname:null;a||(H=H.toLowerCase(),J=J?J.toLowerCase():null,$=$.toLowerCase()),J&&B&&(J=Qb(J,B)||J);const ee=$!=="/"&&$.endsWith("/")?$.length-1:$.length;let Q=H===$||!h&&H.startsWith($)&&H.charAt(ee)==="/",ne=J!=null&&(J===$||!h&&J.startsWith($)&&J.charAt($.length)==="/"),pe={isActive:Q,isPending:ne,isTransitioning:F},he=Q?r:void 0,we;typeof l=="function"?we=l(pe):we=[l,Q?"active":null,ne?"pending":null,F?"transitioning":null].filter(Boolean).join(" ");let fe=typeof i=="function"?i(pe):i;return L.createElement(X2e,YP({},C,{"aria-current":he,className:we,ref:n,style:fe,to:y,viewTransition:x}),typeof w=="function"?w(pe):w)});var xR;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(xR||(xR={}));var sq;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(sq||(sq={}));function Q2e(e){let t=L.useContext(V3);return t||cl(!1),t}function eSe(e,t){let{target:n,replace:r,state:a,preventScrollReset:l,relative:h,viewTransition:i}=t===void 0?{}:t,y=qF(),x=Ix(),w=q3(e,{relative:h});return L.useCallback(C=>{if(V2e(C,n)){C.preventDefault();let P=r!==void 0?r:WP(x)===WP(w);y(e,{replace:P,state:a,preventScrollReset:l,relative:h,viewTransition:i})}},[x,y,w,r,a,n,e,l,h,i])}function tSe(e,t){t===void 0&&(t={});let n=L.useContext(H2e);n==null&&cl(!1);let{basename:r}=Q2e(xR.useViewTransitionState),a=q3(e,{relative:t.relative});if(!n.isTransitioning)return!1;let l=Qb(n.currentLocation.pathname,r)||n.currentLocation.pathname,h=Qb(n.nextLocation.pathname,r)||n.nextLocation.pathname;return ZP(a.pathname,h)!=null||ZP(a.pathname,l)!=null}const nSe="https://superconfidently-preallowable-wilber.ngrok-free.dev/api";class rSe{constructor(t){ni(this,"baseURL");ni(this,"token",null);ni(this,"getSpendingCaps",async()=>this.request("/caps"));ni(this,"createSpendingCap",async t=>this.request("/caps",{method:"POST",body:JSON.stringify(t)}));ni(this,"updateSpendingCap",async(t,n)=>this.request(`/caps/${t}`,{method:"PUT",body:JSON.stringify(n)}));ni(this,"toggleSpendingCap",async t=>this.request(`/caps/${t}/toggle`,{method:"PATCH"}));ni(this,"deleteSpendingCap",async t=>this.request(`/caps/${t}`,{method:"DELETE"}));ni(this,"getCapMerchants",async t=>{const n=new URLSearchParams;return t&&n.append("period",t),this.request(`/caps/merchants?${n.toString()}`)});this.baseURL=t,this.token=localStorage.getItem("authToken"),console.log("API Client initialized with baseURL:",t)}async request(t,n={}){const r=`${this.baseURL}${t}`,a={headers:{"Content-Type":"application/json",...this.token&&{Authorization:`Bearer ${this.token}`},...n.headers},...n};console.log("API Request:",{url:r,config:a});try{const l=await fetch(r,a);console.log("API Response:",{status:l.status,statusText:l.statusText});const h=await l.json();if(console.log("API Data:",h),!l.ok)throw new Error(h.error||`HTTP error! status: ${l.status}`);return h}catch(l){throw console.error("API request failed:",l),l}}async register(t){var r;const n=await this.request("/auth/register",{method:"POST",body:JSON.stringify(t)});return(r=n.data)!=null&&r.token&&(this.setToken(n.data.token),console.log("Token set after registration:",n.data.token)),n}async login(t){var r;const n=await this.request("/auth/login",{method:"POST",body:JSON.stringify(t)});return(r=n.data)!=null&&r.token&&(this.setToken(n.data.token),console.log("Token set after login:",n.data.token)),n}async getProfile(){return this.request("/auth/profile")}async updateProfile(t){return this.request("/auth/profile",{method:"PUT",body:JSON.stringify(t)})}async changePassword(t){return this.request("/auth/change-password",{method:"PUT",body:JSON.stringify(t)})}async setup2FA(){return this.request("/auth/2fa/setup",{method:"POST"})}async verify2FASetup(t){return this.request("/auth/2fa/verify-setup",{method:"POST",body:JSON.stringify({token:t})})}async disable2FA(t){return this.request("/auth/2fa/disable",{method:"POST",body:JSON.stringify({token:t})})}async get2FAStatus(){return this.request("/auth/2fa/status")}async exportData(){return this.request("/data/export")}async importData(t){return this.request("/data/import",{method:"POST",body:JSON.stringify({importData:t})})}async deleteAllData(){return this.request("/data/delete-all",{method:"DELETE"})}async getDataStats(){return this.request("/data/stats")}async logout(){try{await this.request("/auth/logout",{method:"POST"})}catch(t){console.log("Logout request failed (non-critical):",t)}finally{this.token=null,localStorage.removeItem("authToken")}return{success:!0,message:"Logout successful"}}async getTransactions(t){const n=new URLSearchParams;return t&&Object.entries(t).forEach(([r,a])=>{a!==void 0&&n.append(r,a.toString())}),this.request(`/transactions?${n.toString()}`)}async createTransaction(t){return this.request("/transactions",{method:"POST",body:JSON.stringify(t)})}async simulateTransaction(t){return this.request("/transactions/simulate",{method:"POST",body:JSON.stringify(t)})}async updateTransaction(t,n){return this.request(`/transactions/${t}`,{method:"PUT",body:JSON.stringify(n)})}async deleteTransaction(t){return this.request(`/transactions/${t}`,{method:"DELETE"})}async searchTransactions(t,n){const r=new URLSearchParams;return r.append("q",t),n&&r.append("limit",n.toString()),this.request(`/transactions/search?${r.toString()}`)}async getDashboardStats(){return this.request("/analytics/dashboard")}async getSpendingTrends(t,n){const r=new URLSearchParams;return t&&r.append("period",t),n&&r.append("groupBy",n),this.request(`/analytics/spending-trends?${r.toString()}`)}async getCategoryBreakdown(t){const n=new URLSearchParams;return t&&n.append("period",t),this.request(`/analytics/category-breakdown?${n.toString()}`)}async getMerchantAnalysis(t,n){const r=new URLSearchParams;return t&&r.append("period",t),n&&r.append("limit",n.toString()),this.request(`/analytics/merchant-analysis?${r.toString()}`)}async getInsights(){return this.request("/analytics/insights")}async getMapMerchants(t){const n=new URLSearchParams;return t&&n.append("period",t),this.request(`/map/merchants?${n.toString()}`)}async getHeatmapData(t){const n=new URLSearchParams;return t&&n.append("period",t),this.request(`/map/heatmap-data?${n.toString()}`)}async getLocationData(t){const n=new URLSearchParams;return t&&n.append("period",t),this.request(`/map/locations?${n.toString()}`)}async getLeaderboard(t,n){const r=new URLSearchParams;return t&&r.append("period",t),n&&r.append("type",n),this.request(`/leaderboard?${r.toString()}`)}async getFriends(){return this.request("/leaderboard/friends")}async getAvailableBanks(){return this.request("/plaid/banks")}async connectBank(t){return this.request("/plaid/connect",{method:"POST",body:JSON.stringify({bankId:t})})}async getPlaidTransactions(t,n){const r=new URLSearchParams;return t&&r.append("start_date",t),n&&r.append("end_date",n),this.request(`/plaid/transactions?${r.toString()}`)}async getPlaidAccounts(){return this.request("/plaid/accounts")}async removePlaidConnection(){return this.request("/plaid/connection",{method:"DELETE"})}async getSettings(){return this.request("/settings")}async updateSettings(t){return this.request("/settings",{method:"PUT",body:JSON.stringify(t)})}async getNotificationSettings(){return this.request("/settings/notifications")}async updateNotificationSettings(t){return this.request("/settings/notifications",{method:"PUT",body:JSON.stringify(t)})}async getMapSettings(){return this.request("/settings/map")}async updateMapSettings(t){return this.request("/settings/map",{method:"PUT",body:JSON.stringify(t)})}setToken(t){this.token=t,localStorage.setItem("authToken",t),console.log("Token stored in localStorage:",t)}clearToken(){this.token=null,localStorage.removeItem("authToken")}isAuthenticated(){return!!this.token}}const vs=new rSe(nSe);let iSe={data:""},sSe=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||iSe,aSe=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,oSe=/\/\*[^]*?\*\/|  +/g,aq=/\n+/g,A0=(e,t)=>{let n="",r="",a="";for(let l in e){let h=e[l];l[0]=="@"?l[1]=="i"?n=l+" "+h+";":r+=l[1]=="f"?A0(h,l):l+"{"+A0(h,l[1]=="k"?"":t)+"}":typeof h=="object"?r+=A0(h,t?t.replace(/([^,])+/g,i=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,y=>/&/.test(y)?y.replace(/&/g,i):i?i+" "+y:y)):l):h!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=A0.p?A0.p(l,h):l+":"+h+";")}return n+(t&&a?t+"{"+a+"}":a)+r},Eg={},nte=e=>{if(typeof e=="object"){let t="";for(let n in e)t+=n+nte(e[n]);return t}return e},lSe=(e,t,n,r,a)=>{let l=nte(e),h=Eg[l]||(Eg[l]=(y=>{let x=0,w=11;for(;x<y.length;)w=101*w+y.charCodeAt(x++)>>>0;return"go"+w})(l));if(!Eg[h]){let y=l!==e?e:(x=>{let w,C,P=[{}];for(;w=aSe.exec(x.replace(oSe,""));)w[4]?P.shift():w[3]?(C=w[3].replace(aq," ").trim(),P.unshift(P[0][C]=P[0][C]||{})):P[0][w[1]]=w[2].replace(aq," ").trim();return P[0]})(e);Eg[h]=A0(a?{["@keyframes "+h]:y}:y,n?"":"."+h)}let i=n&&Eg.g?Eg.g:null;return n&&(Eg.g=Eg[h]),((y,x,w,C)=>{C?x.data=x.data.replace(C,y):x.data.indexOf(y)===-1&&(x.data=w?y+x.data:x.data+y)})(Eg[h],t,r,i),h},cSe=(e,t,n)=>e.reduce((r,a,l)=>{let h=t[l];if(h&&h.call){let i=h(n),y=i&&i.props&&i.props.className||/^go/.test(i)&&i;h=y?"."+y:i&&typeof i=="object"?i.props?"":A0(i,""):i===!1?"":i}return r+a+(h??"")},"");function G3(e){let t=this||{},n=e.call?e(t.p):e;return lSe(n.unshift?n.raw?cSe(n,[].slice.call(arguments,1),t.p):n.reduce((r,a)=>Object.assign(r,a&&a.call?a(t.p):a),{}):n,sSe(t.target),t.g,t.o,t.k)}let rte,bR,wR;G3.bind({g:1});let sy=G3.bind({k:1});function uSe(e,t,n,r){A0.p=t,rte=e,bR=n,wR=r}function Ev(e,t){let n=this||{};return function(){let r=arguments;function a(l,h){let i=Object.assign({},l),y=i.className||a.className;n.p=Object.assign({theme:bR&&bR()},i),n.o=/ *go\d+/.test(y),i.className=G3.apply(n,r)+(y?" "+y:"");let x=e;return e[0]&&(x=i.as||e,delete i.as),wR&&x[0]&&wR(i),rte(x,i)}return a}}var dSe=e=>typeof e=="function",XP=(e,t)=>dSe(e)?e(t):e,hSe=(()=>{let e=0;return()=>(++e).toString()})(),ite=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),fSe=20,GF="default",ste=(e,t)=>{let{toastLimit:n}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,n)};case 1:return{...e,toasts:e.toasts.map(h=>h.id===t.toast.id?{...h,...t.toast}:h)};case 2:let{toast:r}=t;return ste(e,{type:e.toasts.find(h=>h.id===r.id)?1:0,toast:r});case 3:let{toastId:a}=t;return{...e,toasts:e.toasts.map(h=>h.id===a||a===void 0?{...h,dismissed:!0,visible:!1}:h)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(h=>h.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let l=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(h=>({...h,pauseDuration:h.pauseDuration+l}))}}},YE=[],ate={toasts:[],pausedAt:void 0,settings:{toastLimit:fSe}},Em={},ote=(e,t=GF)=>{Em[t]=ste(Em[t]||ate,e),YE.forEach(([n,r])=>{n===t&&r(Em[t])})},lte=e=>Object.keys(Em).forEach(t=>ote(e,t)),pSe=e=>Object.keys(Em).find(t=>Em[t].toasts.some(n=>n.id===e)),H3=(e=GF)=>t=>{ote(t,e)},mSe={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},gSe=(e={},t=GF)=>{let[n,r]=L.useState(Em[t]||ate),a=L.useRef(Em[t]);L.useEffect(()=>(a.current!==Em[t]&&r(Em[t]),YE.push([t,r]),()=>{let h=YE.findIndex(([i])=>i===t);h>-1&&YE.splice(h,1)}),[t]);let l=n.toasts.map(h=>{var i,y,x;return{...e,...e[h.type],...h,removeDelay:h.removeDelay||((i=e[h.type])==null?void 0:i.removeDelay)||(e==null?void 0:e.removeDelay),duration:h.duration||((y=e[h.type])==null?void 0:y.duration)||(e==null?void 0:e.duration)||mSe[h.type],style:{...e.style,...(x=e[h.type])==null?void 0:x.style,...h.style}}});return{...n,toasts:l}},ySe=(e,t="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:(n==null?void 0:n.id)||hSe()}),C5=e=>(t,n)=>{let r=ySe(t,e,n);return H3(r.toasterId||pSe(r.id))({type:2,toast:r}),r.id},ec=(e,t)=>C5("blank")(e,t);ec.error=C5("error");ec.success=C5("success");ec.loading=C5("loading");ec.custom=C5("custom");ec.dismiss=(e,t)=>{let n={type:3,toastId:e};t?H3(t)(n):lte(n)};ec.dismissAll=e=>ec.dismiss(void 0,e);ec.remove=(e,t)=>{let n={type:4,toastId:e};t?H3(t)(n):lte(n)};ec.removeAll=e=>ec.remove(void 0,e);ec.promise=(e,t,n)=>{let r=ec.loading(t.loading,{...n,...n==null?void 0:n.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let l=t.success?XP(t.success,a):void 0;return l?ec.success(l,{id:r,...n,...n==null?void 0:n.success}):ec.dismiss(r),a}).catch(a=>{let l=t.error?XP(t.error,a):void 0;l?ec.error(l,{id:r,...n,...n==null?void 0:n.error}):ec.dismiss(r)}),e};var vSe=1e3,_Se=(e,t="default")=>{let{toasts:n,pausedAt:r}=gSe(e,t),a=L.useRef(new Map).current,l=L.useCallback((C,P=vSe)=>{if(a.has(C))return;let E=setTimeout(()=>{a.delete(C),h({type:4,toastId:C})},P);a.set(C,E)},[]);L.useEffect(()=>{if(r)return;let C=Date.now(),P=n.map(E=>{if(E.duration===1/0)return;let j=(E.duration||0)+E.pauseDuration-(C-E.createdAt);if(j<0){E.visible&&ec.dismiss(E.id);return}return setTimeout(()=>ec.dismiss(E.id,t),j)});return()=>{P.forEach(E=>E&&clearTimeout(E))}},[n,r,t]);let h=L.useCallback(H3(t),[t]),i=L.useCallback(()=>{h({type:5,time:Date.now()})},[h]),y=L.useCallback((C,P)=>{h({type:1,toast:{id:C,height:P}})},[h]),x=L.useCallback(()=>{r&&h({type:6,time:Date.now()})},[r,h]),w=L.useCallback((C,P)=>{let{reverseOrder:E=!1,gutter:j=8,defaultPosition:D}=P||{},B=n.filter(H=>(H.position||D)===(C.position||D)&&H.height),F=B.findIndex(H=>H.id===C.id),$=B.filter((H,J)=>J<F&&H.visible).length;return B.filter(H=>H.visible).slice(...E?[$+1]:[0,$]).reduce((H,J)=>H+(J.height||0)+j,0)},[n]);return L.useEffect(()=>{n.forEach(C=>{if(C.dismissed)l(C.id,C.removeDelay);else{let P=a.get(C.id);P&&(clearTimeout(P),a.delete(C.id))}})},[n,l]),{toasts:n,handlers:{updateHeight:y,startPause:i,endPause:x,calculateOffset:w}}},xSe=sy`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,bSe=sy`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,wSe=sy`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,SSe=Ev("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${xSe} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${bSe} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${wSe} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,ASe=sy`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,TSe=Ev("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${ASe} 1s linear infinite;
`,CSe=sy`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,ESe=sy`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,PSe=Ev("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${CSe} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${ESe} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,kSe=Ev("div")`
  position: absolute;
`,ISe=Ev("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,NSe=sy`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,MSe=Ev("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${NSe} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,LSe=({toast:e})=>{let{icon:t,type:n,iconTheme:r}=e;return t!==void 0?typeof t=="string"?L.createElement(MSe,null,t):t:n==="blank"?null:L.createElement(ISe,null,L.createElement(TSe,{...r}),n!=="loading"&&L.createElement(kSe,null,n==="error"?L.createElement(SSe,{...r}):L.createElement(PSe,{...r})))},DSe=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,RSe=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,jSe="0%{opacity:0;} 100%{opacity:1;}",OSe="0%{opacity:1;} 100%{opacity:0;}",FSe=Ev("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,zSe=Ev("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,BSe=(e,t)=>{let n=e.includes("top")?1:-1,[r,a]=ite()?[jSe,OSe]:[DSe(n),RSe(n)];return{animation:t?`${sy(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${sy(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},USe=L.memo(({toast:e,position:t,style:n,children:r})=>{let a=e.height?BSe(e.position||t||"top-center",e.visible):{opacity:0},l=L.createElement(LSe,{toast:e}),h=L.createElement(zSe,{...e.ariaProps},XP(e.message,e));return L.createElement(FSe,{className:e.className,style:{...a,...n,...e.style}},typeof r=="function"?r({icon:l,message:h}):L.createElement(L.Fragment,null,l,h))});uSe(L.createElement);var VSe=({id:e,className:t,style:n,onHeightUpdate:r,children:a})=>{let l=L.useCallback(h=>{if(h){let i=()=>{let y=h.getBoundingClientRect().height;r(e,y)};i(),new MutationObserver(i).observe(h,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return L.createElement("div",{ref:l,className:t,style:n},a)},$Se=(e,t)=>{let n=e.includes("top"),r=n?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:ite()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(n?1:-1)}px)`,...r,...a}},qSe=G3`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,HC=16,GSe=({reverseOrder:e,position:t="top-center",toastOptions:n,gutter:r,children:a,toasterId:l,containerStyle:h,containerClassName:i})=>{let{toasts:y,handlers:x}=_Se(n,l);return L.createElement("div",{"data-rht-toaster":l||"",style:{position:"fixed",zIndex:9999,top:HC,left:HC,right:HC,bottom:HC,pointerEvents:"none",...h},className:i,onMouseEnter:x.startPause,onMouseLeave:x.endPause},y.map(w=>{let C=w.position||t,P=x.calculateOffset(w,{reverseOrder:e,gutter:r,defaultPosition:t}),E=$Se(C,P);return L.createElement(VSe,{id:w.id,key:w.id,onHeightUpdate:x.updateHeight,className:w.visible?qSe:"",style:E},w.type==="custom"?XP(w.message,w):a?a(w):L.createElement(USe,{toast:w,position:C}))}))},ay=ec;const ld={profile:["profile"],transactions:["transactions"],transactionsList:e=>["transactions","list",e],spendingCaps:["spendingCaps"],dashboard:["dashboard"],spendingTrends:e=>["spendingTrends",e],categoryBreakdown:e=>["categoryBreakdown",e],merchantAnalysis:(e,t)=>["merchantAnalysis",e,t],insights:["insights"],mapMerchants:e=>["mapMerchants",e],heatmapData:e=>["heatmapData",e],locationData:e=>["locationData",e],leaderboard:(e,t)=>["leaderboard",e,t],friends:["friends"],settings:["settings"],notificationSettings:["notificationSettings"],mapSettings:["mapSettings"]},cte=()=>Lh({queryKey:ld.profile,queryFn:()=>vs.getProfile(),enabled:vs.isAuthenticated(),select:e=>e.data}),HSe=()=>{const e=gy();return Av({mutationFn:vs.logout,onSuccess:()=>{e.clear()},onError:t=>{e.clear(),console.log("Logout API error (non-critical):",t.message)}})},WSe=e=>Lh({queryKey:ld.transactionsList(e),queryFn:()=>vs.getTransactions(e),select:t=>t.data}),ZSe=()=>Av({mutationFn:e=>vs.simulateTransaction(e),onError:e=>{ay.error(e.message||"Transaction simulation failed")}}),KSe=()=>Lh({queryKey:ld.spendingCaps,queryFn:()=>vs.getSpendingCaps(),select:e=>e.data}),YSe=()=>{const e=gy();return Av({mutationFn:vs.createSpendingCap,onSuccess:()=>{e.invalidateQueries({queryKey:ld.spendingCaps}),e.invalidateQueries({queryKey:ld.dashboard}),ay.success("Spending cap created successfully!")},onError:t=>{ay.error(t.message||"Failed to create spending cap")}})},XSe=()=>{const e=gy();return Av({mutationFn:({id:t,data:n})=>vs.updateSpendingCap(t,n),onSuccess:()=>{e.invalidateQueries({queryKey:ld.spendingCaps}),e.invalidateQueries({queryKey:ld.dashboard}),ay.success("Spending cap updated successfully!")},onError:t=>{ay.error(t.message||"Failed to update spending cap")}})},JSe=()=>{const e=gy();return Av({mutationFn:vs.toggleSpendingCap,onSuccess:()=>{e.invalidateQueries({queryKey:ld.spendingCaps}),ay.success("Spending cap toggled successfully!")},onError:t=>{ay.error(t.message||"Failed to toggle spending cap")}})},QSe=()=>{const e=gy();return Av({mutationFn:vs.deleteSpendingCap,onSuccess:()=>{e.invalidateQueries({queryKey:ld.spendingCaps}),e.invalidateQueries({queryKey:ld.dashboard}),ay.success("Spending cap deleted successfully!")},onError:t=>{ay.error(t.message||"Failed to delete spending cap")}})},eAe=e=>Lh({queryKey:["capMerchants",e],queryFn:()=>vs.getCapMerchants(e),select:t=>t.data}),ute=()=>Lh({queryKey:ld.dashboard,queryFn:()=>vs.getDashboardStats(),select:e=>e.data}),tAe=e=>Lh({queryKey:ld.spendingTrends(e),queryFn:()=>vs.getSpendingTrends(e),select:t=>t.data}),nAe=e=>Lh({queryKey:ld.categoryBreakdown(e),queryFn:()=>vs.getCategoryBreakdown(e),select:t=>t.data}),rAe=(e,t)=>Lh({queryKey:ld.leaderboard(e,t),queryFn:()=>vs.getLeaderboard(e,t),select:n=>n.data}),iAe=()=>Lh({queryKey:ld.friends,queryFn:()=>vs.getFriends(),select:e=>e.data}),dte=L.createContext(void 0),W3=()=>{const e=L.useContext(dte);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},sAe=({children:e})=>{const[t,n]=L.useState(null),[r,a]=L.useState(!0),[l,h]=L.useState(vs.isAuthenticated()),{data:i,isLoading:y}=cte(),x=HSe();L.useEffect(()=>{const j=vs.isAuthenticated();h(j),i?n(i):j||n(null),a(y)},[i,y]);const E={user:t,isLoading:r,isAuthenticated:l,login:async(j,D)=>{var B;console.log("AuthContext login called with:",{email:j});try{const F=await vs.login({email:j,password:D});return console.log("AuthContext login response:",F),(B=F.data)!=null&&B.user&&(n(F.data.user),h(!0),console.log("User set in context:",F.data.user)),F}catch(F){throw console.error("AuthContext login error:",F),F}},register:async j=>{var D;try{const B=await vs.register(j);return(D=B.data)!=null&&D.user&&(n(B.data.user),h(!0)),B}catch(B){throw B}},logout:()=>{x.mutate(void 0,{onSuccess:()=>{n(null),h(!1),vs.isAuthenticated()&&(console.warn("Token still exists after logout, clearing manually"),vs.clearToken()),Gn.success("Logged out successfully")},onError:()=>{n(null),h(!1),vs.clearToken(),Gn.success("Logged out successfully")}})}};return v.jsx(dte.Provider,{value:E,children:e})},hte=L.createContext(void 0);function aAe({children:e}){const[t,n]=L.useState("system"),[r,a]=L.useState("light"),[l,h]=L.useState("217 91% 60%"),i=[{name:"Financial Blue",primary:"217 91% 60%",primaryGlow:"217 91% 70%",primaryDark:"217 91% 45%",description:"Professional blue for financial apps"},{name:"Success Green",primary:"142 71% 45%",primaryGlow:"142 71% 55%",primaryDark:"142 71% 35%",description:"Growth and success focused"},{name:"Warning Orange",primary:"38 92% 50%",primaryGlow:"38 92% 60%",primaryDark:"38 92% 40%",description:"Alert and attention focused"},{name:"Danger Red",primary:"0 84% 60%",primaryGlow:"0 84% 70%",primaryDark:"0 84% 50%",description:"Urgent and critical alerts"},{name:"Purple Premium",primary:"262 83% 58%",primaryGlow:"262 83% 68%",primaryDark:"262 83% 48%",description:"Premium and luxury feel"},{name:"Teal Modern",primary:"173 80% 40%",primaryGlow:"173 80% 50%",primaryDark:"173 80% 30%",description:"Modern and clean aesthetic"},{name:"Pink Elegant",primary:"330 81% 60%",primaryGlow:"330 81% 70%",primaryDark:"330 81% 50%",description:"Elegant and sophisticated"},{name:"Indigo Deep",primary:"238 100% 67%",primaryGlow:"238 100% 77%",primaryDark:"238 100% 57%",description:"Deep and mysterious"},{name:"Forest Green",primary:"142 64% 24%",primaryGlow:"142 64% 34%",primaryDark:"142 64% 14%",description:"Natural and earthy"},{name:"Ocean Blue",primary:"188 94% 42%",primaryGlow:"188 94% 52%",primaryDark:"188 94% 32%",description:"Calm and refreshing"},{name:"Sunset Orange",primary:"25 95% 53%",primaryGlow:"25 95% 63%",primaryDark:"25 95% 43%",description:"Warm and energetic"},{name:"Slate Gray",primary:"215 25% 27%",primaryGlow:"215 25% 37%",primaryDark:"215 25% 17%",description:"Professional and neutral"}];L.useEffect(()=>{const w=localStorage.getItem("theme");w&&["light","dark","system"].includes(w)&&n(w);const C=localStorage.getItem("primaryColor");C&&h(C)},[]),L.useEffect(()=>{const w=()=>{if(t==="system"){const E=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";a(E)}else a(t)};w();const C=window.matchMedia("(prefers-color-scheme: dark)"),P=()=>{t==="system"&&w()};return C.addEventListener("change",P),()=>C.removeEventListener("change",P)},[t]),L.useEffect(()=>{const w=document.documentElement;w.classList.remove("light","dark"),w.classList.add(r);const C=i.find(P=>P.primary===l);if(C)w.style.setProperty("--primary",C.primary),w.style.setProperty("--primary-glow",C.primaryGlow),w.style.setProperty("--primary-dark",C.primaryDark),w.style.setProperty("--ring",C.primary),w.style.setProperty("--sidebar-primary",C.primary),w.style.setProperty("--sidebar-ring",C.primary),w.style.setProperty("--gradient-primary",`linear-gradient(135deg, hsl(${C.primary}) 0%, hsl(${C.primaryGlow}) 100%)`),w.style.setProperty("--gradient-hero",`linear-gradient(135deg, hsl(${C.primary}) 0%, hsl(${C.primaryDark}) 50%, hsl(${C.primaryDark}) 100%)`),w.style.setProperty("--shadow-card",`0 4px 6px -1px hsl(${C.primary} / 0.1), 0 2px 4px -1px hsl(${C.primary} / 0.06)`),w.style.setProperty("--shadow-card-hover",`0 10px 15px -3px hsl(${C.primary} / 0.1), 0 4px 6px -2px hsl(${C.primary} / 0.05)`),w.style.setProperty("--shadow-primary",`0 10px 25px -5px hsl(${C.primary} / 0.3)`);else{const P=l,E=P.match(/(\d+)\s+(\d+)%\s+(\d+)%/);if(E){const[,j,D,B]=E,F=parseInt(j),$=parseInt(D),H=parseInt(B),J=Math.min(100,H+15),ee=`${F} ${$}% ${J}%`,Q=Math.max(0,H-15),ne=`${F} ${$}% ${Q}%`;w.style.setProperty("--primary",P),w.style.setProperty("--primary-glow",ee),w.style.setProperty("--primary-dark",ne),w.style.setProperty("--ring",P),w.style.setProperty("--sidebar-primary",P),w.style.setProperty("--sidebar-ring",P),w.style.setProperty("--gradient-primary",`linear-gradient(135deg, hsl(${P}) 0%, hsl(${ee}) 100%)`),w.style.setProperty("--gradient-hero",`linear-gradient(135deg, hsl(${P}) 0%, hsl(${ne}) 50%, hsl(${ne}) 100%)`),w.style.setProperty("--shadow-card",`0 4px 6px -1px hsl(${P} / 0.1), 0 2px 4px -1px hsl(${P} / 0.06)`),w.style.setProperty("--shadow-card-hover",`0 10px 15px -3px hsl(${P} / 0.1), 0 4px 6px -2px hsl(${P} / 0.05)`),w.style.setProperty("--shadow-primary",`0 10px 25px -5px hsl(${P} / 0.3)`)}else{const j=i[0];w.style.setProperty("--primary",j.primary),w.style.setProperty("--primary-glow",j.primaryGlow),w.style.setProperty("--primary-dark",j.primaryDark),w.style.setProperty("--ring",j.primary),w.style.setProperty("--sidebar-primary",j.primary),w.style.setProperty("--sidebar-ring",j.primary),w.style.setProperty("--gradient-primary",`linear-gradient(135deg, hsl(${j.primary}) 0%, hsl(${j.primaryGlow}) 100%)`),w.style.setProperty("--gradient-hero",`linear-gradient(135deg, hsl(${j.primary}) 0%, hsl(${j.primaryDark}) 50%, hsl(${j.primaryDark}) 100%)`),w.style.setProperty("--shadow-card",`0 4px 6px -1px hsl(${j.primary} / 0.1), 0 2px 4px -1px hsl(${j.primary} / 0.06)`),w.style.setProperty("--shadow-card-hover",`0 10px 15px -3px hsl(${j.primary} / 0.1), 0 4px 6px -2px hsl(${j.primary} / 0.05)`),w.style.setProperty("--shadow-primary",`0 10px 25px -5px hsl(${j.primary} / 0.3)`)}}},[r,l,i]);const y=w=>{n(w),localStorage.setItem("theme",w)},x=w=>{h(w),localStorage.setItem("primaryColor",w)};return v.jsx(hte.Provider,{value:{theme:t,setTheme:y,resolvedTheme:r,primaryColor:l,setPrimaryColor:x,colorSchemes:i},children:e})}function fte(){const e=L.useContext(hte);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e}class oAe{constructor(){ni(this,"spendingHistory",[]);ni(this,"spendingPatterns",new Map);ni(this,"highRiskMerchants",new Set);ni(this,"userPreferences",{dailyLimit:200,weeklyLimit:1e3,monthlyLimit:4e3,enableLocationTracking:!0,enableRealTimeAlerts:!0});this.loadUserPreferences()}loadUserPreferences(){try{const t=localStorage.getItem("financialBodyguardPrefs");t&&(this.userPreferences={...this.userPreferences,...JSON.parse(t)})}catch(t){console.warn("Failed to load user preferences:",t)}}saveUserPreferences(){try{localStorage.setItem("financialBodyguardPrefs",JSON.stringify(this.userPreferences))}catch(t){console.warn("Failed to save user preferences:",t)}}addTransaction(t){this.spendingHistory.push(t),this.updateSpendingPatterns(t),this.analyzeRiskPatterns()}updateSpendingPatterns(t){const n=t.merchant,r=this.spendingPatterns.get(n)||{merchant:n,totalSpent:0,visitCount:0,averageAmount:0,lastVisit:0,riskLevel:"low"};r.totalSpent+=t.amount,r.visitCount+=1,r.averageAmount=r.totalSpent/r.visitCount,r.lastVisit=t.timestamp,r.riskLevel=this.calculateMerchantRiskLevel(r),this.spendingPatterns.set(n,r)}calculateMerchantRiskLevel(t){const n=(Date.now()-t.lastVisit)/864e5,r=this.getWeeklySpending(t.merchant),a=this.getMonthlySpending(t.merchant);let l=0;return t.visitCount>20?l+=30:t.visitCount>10?l+=20:t.visitCount>5&&(l+=10),t.averageAmount>200?l+=30:t.averageAmount>100?l+=20:t.averageAmount>50&&(l+=10),r>this.userPreferences.weeklyLimit*.7?l+=25:r>this.userPreferences.weeklyLimit*.5?l+=15:r>this.userPreferences.weeklyLimit*.3&&(l+=10),a>this.userPreferences.monthlyLimit*.5?l+=25:a>this.userPreferences.monthlyLimit*.3?l+=15:a>this.userPreferences.monthlyLimit*.1&&(l+=10),n<1?l+=15:n<3?l+=10:n<7&&(l+=5),l>=60?"high":l>=30?"medium":"low"}getWeeklySpending(t){const n=Date.now()-6048e5;return this.spendingHistory.filter(r=>r.merchant===t&&r.timestamp>=n).reduce((r,a)=>r+a.amount,0)}getMonthlySpending(t){const n=Date.now()-2592e6;return this.spendingHistory.filter(r=>r.merchant===t&&r.timestamp>=n).reduce((r,a)=>r+a.amount,0)}analyzeRiskPatterns(){this.highRiskMerchants.clear();for(const[t,n]of this.spendingPatterns)n.riskLevel==="high"&&this.highRiskMerchants.add(t)}assessRisk(t,n,r,a){const l=[];let h=0;const i=this.assessAmountRisk(t);l.push(i),h+=i.weight*this.getSeverityWeight(i.severity);const y=this.assessMerchantRisk(n);if(l.push(y),h+=y.weight*this.getSeverityWeight(y.severity),a){const j=this.assessLocationRisk(a,n);l.push(j),h+=j.weight*this.getSeverityWeight(j.severity)}const x=this.assessTimeRisk();l.push(x),h+=x.weight*this.getSeverityWeight(x.severity);const w=this.assessFrequencyRisk(n);l.push(w),h+=w.weight*this.getSeverityWeight(w.severity);const C=this.calculateRiskLevel(h),P=this.generateRecommendation(C,l),E=this.determineAction(C,h);return{score:Math.min(100,Math.max(0,h)),level:C,factors:l,recommendation:P,action:E}}assessAmountRisk(t){const n=this.getDailySpending(),r=this.getTotalWeeklySpending(),a=this.getTotalMonthlySpending(),l=this.userPreferences.dailyLimit-n,h=this.userPreferences.weeklyLimit-r,i=this.userPreferences.monthlyLimit-a;return t>this.userPreferences.dailyLimit||t>l?{type:"amount",severity:"critical",message:`Transaction amount ($${t.toFixed(2)}) exceeds daily limit ($${this.userPreferences.dailyLimit}) or remaining daily budget ($${l.toFixed(2)})`,weight:40}:t>this.userPreferences.weeklyLimit*.4||t>h*.6?{type:"amount",severity:"high",message:`Transaction amount ($${t.toFixed(2)}) is high relative to weekly limit ($${this.userPreferences.weeklyLimit})`,weight:25}:t>this.userPreferences.monthlyLimit*.15||t>i*.2?{type:"amount",severity:"high",message:`Transaction amount ($${t.toFixed(2)}) is high relative to monthly limit ($${this.userPreferences.monthlyLimit})`,weight:25}:t>this.userPreferences.weeklyLimit*.2?{type:"amount",severity:"medium",message:`Transaction amount ($${t.toFixed(2)}) is moderate relative to weekly limit`,weight:15}:t>this.userPreferences.monthlyLimit*.05?{type:"amount",severity:"medium",message:`Transaction amount ($${t.toFixed(2)}) is moderate relative to monthly limit`,weight:15}:{type:"amount",severity:"low",message:`Transaction amount ($${t.toFixed(2)}) is within safe limits`,weight:5}}assessMerchantRisk(t){const n=this.spendingPatterns.get(t);return this.highRiskMerchants.has(t)?{type:"history",severity:"high",message:`Merchant "${t}" has a history of high spending`,weight:25}:n&&n.riskLevel==="medium"?{type:"history",severity:"medium",message:`Merchant "${t}" has moderate spending history`,weight:15}:{type:"history",severity:"low",message:`Merchant "${t}" has safe spending history`,weight:5}}assessLocationRisk(t,n){const r=this.findNearbyMerchants(t);return r.length>0?{type:"location",severity:"medium",message:`You're near ${r.length} known merchant(s)`,weight:10}:{type:"location",severity:"low",message:"Location appears safe for spending",weight:5}}assessTimeRisk(){const t=new Date().getHours(),n=new Date().getDay();return t>=22||t<=6?{type:"time",severity:"high",message:"Late night/early morning spending is typically higher risk",weight:15}:n===0||n===6?{type:"time",severity:"medium",message:"Weekend spending patterns may be different",weight:8}:{type:"time",severity:"low",message:"Time of day appears safe for spending",weight:5}}assessFrequencyRisk(t){const n=this.spendingHistory.filter(r=>r.merchant===t&&Date.now()-r.timestamp<864e5);return n.length>=3?{type:"frequency",severity:"high",message:`Multiple transactions at "${t}" in the last 24 hours`,weight:20}:n.length>=2?{type:"frequency",severity:"medium",message:`Multiple transactions at "${t}" recently`,weight:10}:{type:"frequency",severity:"low",message:"Transaction frequency appears normal",weight:5}}findNearbyMerchants(t){return["Starbucks","Target","Kroger"]}calculateRiskLevel(t){const n=Math.min(100,Math.max(0,t));return n>=85?"critical":n>=70?"danger":n>=50?"warning":n>=25?"caution":"safe"}generateRecommendation(t,n){switch(t){case"critical":return" CRITICAL: This transaction poses significant financial risk. Consider alternatives or wait.";case"danger":return" DANGER: High risk transaction. Review your spending goals before proceeding.";case"warning":return" WARNING: Moderate risk detected. Consider if this purchase aligns with your budget.";case"caution":return" CAUTION: Low risk detected. Proceed with awareness of your spending patterns.";default:return" SAFE: Transaction appears to be within normal spending patterns."}}determineAction(t,n){return t==="critical"||n>=90?"block":t==="danger"||n>=70?"require_approval":t==="warning"||n>=50?"warn":"allow"}getSeverityWeight(t){switch(t){case"critical":return 4;case"high":return 3;case"medium":return 2;case"low":return 1;default:return 1}}getDailySpending(){const t=new Date;t.setHours(0,0,0,0);const n=t.getTime();return this.spendingHistory.filter(r=>r.timestamp>=n).reduce((r,a)=>r+a.amount,0)}getTotalWeeklySpending(){const t=Date.now()-6048e5;return this.spendingHistory.filter(n=>n.timestamp>=t).reduce((n,r)=>n+r.amount,0)}getTotalMonthlySpending(){const t=Date.now()-2592e6;return this.spendingHistory.filter(n=>n.timestamp>=t).reduce((n,r)=>n+r.amount,0)}getSpendingPatterns(){return Array.from(this.spendingPatterns.values())}getHighRiskMerchants(){return Array.from(this.highRiskMerchants)}updatePreferences(t){this.userPreferences={...this.userPreferences,...t},this.saveUserPreferences()}getPreferences(){return{...this.userPreferences}}}class pte{constructor(){ni(this,"currentLocation",null);ni(this,"locationHistory",[]);ni(this,"geofences",[]);ni(this,"watchId",null);ni(this,"isTracking",!1);ni(this,"onLocationUpdate");ni(this,"onGeofenceEnter");ni(this,"onGeofenceExit");this.loadGeofences()}startTracking(t,n,r){return new Promise((a,l)=>{if(!navigator.geolocation){l(new Error("Geolocation is not supported by this browser"));return}this.onLocationUpdate=t,this.onGeofenceEnter=n,this.onGeofenceExit=r;const h={enableHighAccuracy:!0,timeout:1e4,maximumAge:3e4};this.watchId=navigator.geolocation.watchPosition(i=>{const y={lat:i.coords.latitude,lng:i.coords.longitude,accuracy:i.coords.accuracy,timestamp:Date.now()};this.updateLocation(y),a(y)},i=>{console.error("Location tracking error:",i),l(i)},h),this.isTracking=!0})}stopTracking(){this.watchId!==null&&(navigator.geolocation.clearWatch(this.watchId),this.watchId=null),this.isTracking=!1}updateLocation(t){this.currentLocation=t,this.locationHistory.push({location:t,timestamp:Date.now(),accuracy:t.accuracy||0}),this.locationHistory.length>100&&(this.locationHistory=this.locationHistory.slice(-100)),this.checkGeofences(t),this.onLocationUpdate&&this.onLocationUpdate(t)}checkGeofences(t){for(const n of this.geofences){const a=this.calculateDistance(t,n.center)<=n.radius,l=this.wasInsideGeofence(n.id);a&&!l?this.onGeofenceEnter&&this.onGeofenceEnter(n):!a&&l&&this.onGeofenceExit&&this.onGeofenceExit(n)}}wasInsideGeofence(t){if(!this.currentLocation)return!1;const n=this.geofences.find(a=>a.id===t);return n?this.calculateDistance(this.currentLocation,n.center)<=n.radius:!1}calculateDistance(t,n){const a=t.lat*Math.PI/180,l=n.lat*Math.PI/180,h=(n.lat-t.lat)*Math.PI/180,i=(n.lng-t.lng)*Math.PI/180,y=Math.sin(h/2)*Math.sin(h/2)+Math.cos(a)*Math.cos(l)*Math.sin(i/2)*Math.sin(i/2);return 6371e3*(2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y)))}addGeofence(t){this.geofences.push(t),this.saveGeofences()}removeGeofence(t){this.geofences=this.geofences.filter(n=>n.id!==t),this.saveGeofences()}getCurrentLocation(){return this.currentLocation}getLocationHistory(){return[...this.locationHistory]}getGeofences(){return[...this.geofences]}isInsideGeofence(t){if(!this.currentLocation)return!1;const n=this.geofences.find(a=>a.id===t);return n?this.calculateDistance(this.currentLocation,n.center)<=n.radius:!1}getNearbyGeofences(t=1e3){return this.currentLocation?this.geofences.filter(n=>this.calculateDistance(this.currentLocation,n.center)<=t):[]}saveGeofences(){try{localStorage.setItem("locationTrackerGeofences",JSON.stringify(this.geofences))}catch(t){console.warn("Failed to save geofences:",t)}}loadGeofences(){try{const t=localStorage.getItem("locationTrackerGeofences");t&&(this.geofences=JSON.parse(t))}catch(t){console.warn("Failed to load geofences:",t)}}isTrackingActive(){return this.isTracking}getLocationAccuracy(){return this.currentLocation&&this.currentLocation.accuracy||null}isLocationAccurate(){const t=this.getLocationAccuracy();return t!==null&&t<=100}}class lAe{constructor(t){ni(this,"financialBodyguard");ni(this,"insights",[]);ni(this,"autonomousActions",[]);ni(this,"predictions",[]);ni(this,"learningRate",.1);ni(this,"decisionThreshold",.8);this.financialBodyguard=t,this.startAutonomousAnalysis()}startAutonomousAnalysis(){setInterval(()=>{this.performAutonomousAnalysis()},3e4),setInterval(()=>{this.performDeepAnalysis()},3e5)}performAutonomousAnalysis(){const t=this.financialBodyguard.getSpendingPatterns();this.financialBodyguard.getHighRiskMerchants(),this.analyzeSpendingTrends(t),this.detectAnomalies(t),this.generatePredictions(t),this.executeAutonomousActions()}performDeepAnalysis(){console.log(" Agentic AI: Performing deep analysis...");const t=this.financialBodyguard.getSpendingPatterns();this.identifyComplexPatterns(t),this.analyzeBehavioralPatterns(t),this.updateRiskModels(t),this.generateStrategicInsights(t)}analyzeSpendingTrends(t){const n=Date.now(),r=n-7*24*60*60*1e3,l=t.filter(x=>x.lastVisit>r).reduce((x,w)=>{const C=(n-w.lastVisit)/864e5,E=Math.min(7,w.visitCount*(7/Math.max(1,C)))*w.averageAmount;return x+E},0),h=t.reduce((x,w)=>{const C=(n-w.lastVisit)/864e5;if(C<=30){const P=Math.min(30,w.visitCount*(30/Math.max(1,C)));return x+P*w.averageAmount}return x},0),i=l/7,y=h/30;i>150?this.addInsight({id:`trend_high_daily_${Date.now()}`,type:"spending_trend",title:"High Daily Spending Detected",description:`Average daily spending is $${i.toFixed(2)}, which is significantly above normal levels.`,severity:"high",confidence:90,timestamp:n,actionable:!0,suggestedAction:"Consider setting daily spending limits or reviewing recent purchases."}):i>100&&this.addInsight({id:`trend_moderate_daily_${Date.now()}`,type:"spending_trend",title:"Moderate Daily Spending Increase",description:`Average daily spending is $${i.toFixed(2)}, which is above normal levels.`,severity:"medium",confidence:75,timestamp:n,actionable:!0,suggestedAction:"Monitor your spending patterns and consider setting daily limits."}),y>2e3&&this.addInsight({id:`trend_high_monthly_${Date.now()}`,type:"spending_trend",title:"High Monthly Spending Detected",description:`Projected monthly spending is $${y.toFixed(2)}, which may exceed your budget.`,severity:"high",confidence:80,timestamp:n,actionable:!0,suggestedAction:"Review your monthly budget and consider reducing discretionary spending."})}detectAnomalies(t){t.forEach(n=>{n.averageAmount>200&&n.visitCount>5&&this.addInsight({id:`anomaly_${n.merchant}_${Date.now()}`,type:"pattern_anomaly",title:`Unusual Spending Pattern at ${n.merchant}`,description:`High average spending of $${n.averageAmount.toFixed(2)} with ${n.visitCount} visits.`,severity:"medium",confidence:75,timestamp:Date.now(),actionable:!0,suggestedAction:"Review spending at this merchant and consider setting spending caps."});const r=(Date.now()-n.lastVisit)/(1e3*60*60*24);n.visitCount>10&&r<1&&this.addInsight({id:`frequency_${n.merchant}_${Date.now()}`,type:"pattern_anomaly",title:`Frequent Visits to ${n.merchant}`,description:`Multiple visits to ${n.merchant} in a short period.`,severity:"high",confidence:90,timestamp:Date.now(),actionable:!0,suggestedAction:"Consider if these visits are necessary or if spending is getting out of control."})})}generatePredictions(t){if(t.length===0)return;const n=Date.now(),r=t.reduce((C,P)=>{const E=(n-P.lastVisit)/864e5;if(E<=7){const j=Math.min(7,P.visitCount*(7/Math.max(1,E)));return C+j*P.averageAmount}return C},0),l=t.reduce((C,P)=>C+P.totalSpent,0)/Math.max(t.length,1),h=r>0?r/Math.max(l,1):1,y=(r>0?r:l)*Math.min(1.5,Math.max(.5,h));this.addPrediction({type:"spending_forecast",value:y,confidence:Math.min(95,60+t.length*5),timeframe:"next_week",factors:[`Recent spending: $${r.toFixed(2)}`,`Historical average: $${l.toFixed(2)}`,`Trend factor: ${h.toFixed(2)}x`]});const x=t.filter(C=>C.riskLevel==="high");if(x.length>0){const C=x.reduce((E,j)=>{const D=(n-j.lastVisit)/864e5;return E+j.visitCount/Math.max(1,D)},0)/x.length,P=Math.min(.9,Math.max(.1,C/7));this.addPrediction({type:"merchant_visit_probability",value:P,confidence:Math.min(90,50+x.length*10),timeframe:"next_3_days",factors:[`Visit frequency: ${C.toFixed(2)}/day`,`High-risk merchants: ${x.length}`,`Average spending: $${(x.reduce((E,j)=>E+j.averageAmount,0)/x.length).toFixed(2)}`]})}const w=t.reduce((C,P)=>{const E=P.riskLevel==="high"?3:P.riskLevel==="medium"?2:1;return C+E},0)/t.length;this.addPrediction({type:"risk_prediction",value:w,confidence:70,timeframe:"next_transaction",factors:[`Average merchant risk: ${w.toFixed(1)}/3`,`High-risk merchants: ${x.length}`,`Total patterns: ${t.length}`]})}identifyComplexPatterns(t){const n=this.analyzeTimePatterns(t);n.length>0&&this.addInsight({id:`time_pattern_${Date.now()}`,type:"spending_trend",title:"Time-Based Spending Pattern Detected",description:`Spending patterns show ${n[0]} behavior.`,severity:"low",confidence:80,timestamp:Date.now(),actionable:!1}),this.analyzeLocationPatterns(t).length>0&&this.addInsight({id:`location_pattern_${Date.now()}`,type:"spending_trend",title:"Location-Based Spending Pattern Detected",description:"Spending is concentrated in specific areas.",severity:"low",confidence:75,timestamp:Date.now(),actionable:!1})}analyzeBehavioralPatterns(t){t.filter(r=>r.averageAmount>50&&r.visitCount>3&&r.riskLevel==="high").length>0&&this.addInsight({id:`impulse_${Date.now()}`,type:"recommendation",title:"Potential Impulse Buying Detected",description:"Multiple merchants show signs of impulse buying behavior.",severity:"medium",confidence:70,timestamp:Date.now(),actionable:!0,suggestedAction:"Consider implementing a 24-hour cooling-off period for purchases over $50."})}updateRiskModels(t){t.reduce((r,a)=>r+a.averageAmount,0)/t.length>100&&this.addInsight({id:`risk_model_${Date.now()}`,type:"recommendation",title:"Risk Model Updated",description:"Risk thresholds have been adjusted based on your spending patterns.",severity:"low",confidence:85,timestamp:Date.now(),actionable:!1})}generateStrategicInsights(t){const n=t.reduce((a,l)=>a+l.totalSpent,0),r=this.categorizeSpending(t);r.food>n*.4&&this.addInsight({id:`budget_${Date.now()}`,type:"recommendation",title:"Food Spending Optimization",description:`Food spending represents ${(r.food/n*100).toFixed(1)}% of total spending.`,severity:"medium",confidence:80,timestamp:Date.now(),actionable:!0,suggestedAction:"Consider meal planning or cooking at home to reduce food expenses."})}executeAutonomousActions(){this.insights.filter(n=>Date.now()-n.timestamp<3e5&&n.severity==="critical").forEach(n=>{n.confidence>this.decisionThreshold&&this.createAutonomousAction(n)})}createAutonomousAction(t){const n={id:`action_${Date.now()}`,type:"auto_alert",description:`Autonomous action triggered by: ${t.title}`,executed:!1,timestamp:Date.now(),parameters:{insightId:t.id}};this.autonomousActions.push(n),this.executeAction(n)}executeAction(t){console.log(` Executing autonomous action: ${t.description}`),setTimeout(()=>{t.executed=!0,console.log(` Action executed: ${t.description}`)},1e3)}analyzeTimePatterns(t){return["evening_spending","weekend_splurges"]}analyzeLocationPatterns(t){return["downtown_concentration","mall_visits"]}categorizeSpending(t){return{food:t.filter(n=>n.merchant.includes("Starbucks")||n.merchant.includes("McDonald")).reduce((n,r)=>n+r.totalSpent,0),shopping:t.filter(n=>n.merchant.includes("Target")||n.merchant.includes("Amazon")).reduce((n,r)=>n+r.totalSpent,0),transportation:t.filter(n=>n.merchant.includes("Shell")||n.merchant.includes("Uber")).reduce((n,r)=>n+r.totalSpent,0)}}addInsight(t){this.insights.push(t),console.log(` AI Insight: ${t.title} (${t.severity})`)}addPrediction(t){this.predictions.push(t),console.log(` AI Prediction: ${t.type} - ${t.value} (${t.confidence}% confidence)`)}getInsights(){return[...this.insights]}getPredictions(){return[...this.predictions]}getAutonomousActions(){return[...this.autonomousActions]}assessRiskWithAI(t,n,r,a){const l=this.financialBodyguard.assessRisk(t,n,r,a);return this.insights.filter(i=>i.type==="pattern_anomaly"&&i.description.includes(n)).length>0&&(l.score+=10,l.factors.push({type:"history",severity:"medium",message:`AI detected unusual patterns at ${n}`,weight:15})),l}}const mte=L.createContext(void 0),cAe=({children:e})=>{const[t,n]=L.useState(!1),[r,a]=L.useState(!1),[l,h]=L.useState(null),[i,y]=L.useState(null),[x,w]=L.useState([]),[C,P]=L.useState(null),[E]=L.useState(()=>new oAe),[j]=L.useState(()=>new pte),[D]=L.useState(()=>new lAe(E));L.useEffect(()=>{localStorage.getItem("financialBodyguardActive")==="true"&&n(!0)},[]);const B=At=>{h(At),console.log("Location updated:",At)},F=At=>{console.log("Entered geofence:",At),je(`Entered ${At.name}`,"info"),At.id==="current_location_high_risk"?vt({title:" High Risk Location Detected!",message:"You've entered a high-risk spending zone! MoneyLens has detected unusual financial activity in this area. This location has been flagged for potential overspending risks.",severity:"critical",onConfirm:()=>{console.log("User confirmed to proceed with caution in high-risk area"),je("Proceeding with enhanced monitoring","warning")},onDismiss:()=>{console.log("User chose to avoid the high-risk area"),je("Smart choice! Avoiding high-risk spending area","success")},confirmText:"Proceed with Caution",dismissText:"Turn Back",showDismiss:!0}):At.id==="downtown_blacksburg"?vt({title:" Downtown Blacksburg - High Spending Zone",message:"You've entered downtown Blacksburg, a high-spending area with many restaurants and shops. Consider setting a daily spending limit to avoid overspending.",severity:"high",onConfirm:()=>{console.log("User confirmed to proceed in downtown area"),je("Proceeding with spending monitoring","info")},onDismiss:()=>{console.log("User chose to avoid downtown area"),je("Avoiding downtown spending area","info")},confirmText:"Set Spending Limit",dismissText:"Avoid Area",showDismiss:!0}):At.id==="squires_student_center"&&vt({title:" Squires Student Center",message:"You've entered Squires Student Center. This area has multiple dining options and shops. Consider setting a budget for your visit.",severity:"warning",onConfirm:()=>{console.log("User confirmed to proceed in Squires"),je("Proceeding with budget monitoring","info")},onDismiss:()=>{console.log("User chose to avoid Squires"),je("Avoiding Squires area","info")},confirmText:"Set Budget",dismissText:"Continue",showDismiss:!0}),At.type==="merchant"&&At.merchantId&&ne(0,At.name,"merchant").level!=="safe"&&je(`High-risk area detected: ${At.name}`,"warning")},$=At=>{console.log("Exited geofence:",At),je(`Exited ${At.name}`,"info")},H=()=>{n(!0),localStorage.setItem("financialBodyguardActive","true"),je("Financial Bodyguard activated! ","success")},J=()=>{n(!1),Q(),localStorage.setItem("financialBodyguardActive","false"),je("Financial Bodyguard deactivated","info")},ee=async()=>{try{await j.startTracking(B,F,$),a(!0),je("Location tracking started","success")}catch(At){console.error("Failed to start location tracking:",At),je("Failed to start location tracking","error")}},Q=()=>{j.stopTracking(),a(!1),je("Location tracking stopped","info")},ne=(At,mt,Pt)=>{const Ht=D.assessRiskWithAI(At,mt,Pt,l);return y(Ht),Ht.level==="critical"||Ht.level==="danger"?je(Ht.recommendation,"error"):Ht.level==="warning"&&je(Ht.recommendation,"warning"),Ht},pe=At=>{try{E.addTransaction(At),console.log("Transaction added:",At)}catch(mt){console.error("Error adding transaction:",mt)}},he=()=>E.getSpendingPatterns(),we=()=>E.getHighRiskMerchants(),fe=()=>j.getLocationHistory().map(At=>At.location),ge=At=>{E.updatePreferences(At),je("Preferences updated","success")},Ce=()=>E.getPreferences(),xe=At=>{j.addGeofence(At),je(`Geofence added: ${At.name}`,"success")},Re=At=>{j.removeGeofence(At),je("Geofence removed","info")},Qe=()=>j.getGeofences(),et=(At=1e3)=>j.getNearbyGeofences(At),je=(At,mt)=>{const Pt={id:Date.now().toString(),message:At,type:mt,timestamp:Date.now(),dismissed:!1};w(Ht=>[...Ht,Pt]),mt!=="error"&&setTimeout(()=>{De(Pt.id)},5e3)},De=At=>{w(mt=>mt.map(Pt=>Pt.id===At?{...Pt,dismissed:!0}:Pt))},Ct=()=>{w([])},xt=()=>D.getInsights(),me=()=>D.getPredictions(),Ye=()=>D.getAutonomousActions(),nt=()=>{console.log(" Running manual AI analysis..."),je("AI analysis started","info")},vt=At=>{const mt={...At,id:Date.now().toString(),isVisible:!0};P(mt)},gt=At=>{P(null)};L.useEffect(()=>{t&&!r&&ee()},[t]);const dt={isActive:t,isTracking:r,currentLocation:l,lastRiskAssessment:i,activateAgent:H,deactivateAgent:J,startLocationTracking:ee,stopLocationTracking:Q,assessTransactionRisk:ne,addTransaction:pe,getSpendingPatterns:he,getHighRiskMerchants:we,getLocationHistory:fe,updatePreferences:ge,getPreferences:Ce,addGeofence:xe,removeGeofence:Re,getGeofences:Qe,getNearbyGeofences:et,showAlert:je,clearAlerts:Ct,alerts:x,showBlockingNotification:vt,dismissBlockingNotification:gt,currentBlockingNotification:C,getAIInsights:xt,getAIPredictions:me,getAutonomousActions:Ye,runAIAnalysis:nt};return v.jsx(mte.Provider,{value:dt,children:e})},yy=()=>{const e=L.useContext(mte);if(e===void 0)throw new Error("useFinancialBodyguard must be used within a FinancialBodyguardProvider");return e},gte=L.createContext(void 0);function uAe({children:e}){const[t,n]=L.useState(null),[r,a]=L.useState(!0),[l,h]=L.useState(null);L.useEffect(()=>{try{const x=localStorage.getItem("mapbox_token");if(x)n(x);else{const w="pk.eyJ1Ijoic2hsb2tleWsiLCJhIjoiY21nMXV0dzMzMHNnNjJscHRjeWtramV0dSJ9.G_oGQ6qXclMTJz3T-BacPg";n(w),localStorage.setItem("mapbox_token",w)}}catch(x){h("Failed to load Mapbox configuration"),console.error("Error loading Mapbox token:",x)}finally{a(!1)}},[]);const i=x=>{try{if(!x||x.length<10)throw new Error("Invalid Mapbox token format");localStorage.setItem("mapbox_token",x),n(x),h(null)}catch(w){h(w instanceof Error?w.message:"Failed to save Mapbox token"),console.error("Error saving Mapbox token:",w)}},y=!!t;return v.jsx(gte.Provider,{value:{mapboxToken:t,setMapboxToken:i,isMapboxConfigured:y,isLoading:r,error:l},children:e})}function dAe(){const e=L.useContext(gte);if(e===void 0)throw new Error("useMapbox must be used within a MapboxProvider");return e}const yte=L.createContext(void 0),E5=()=>{const e=L.useContext(yte);if(!e)throw new Error("useNotifications must be used within a NotificationProvider");return e},hAe=({children:e})=>{const[t,n]=L.useState([]),r=t.filter(P=>!P.read).length,a=L.useCallback(P=>{const E={...P,id:Date.now().toString(),timestamp:new Date,read:!1};n(D=>[E,...D]);const j=P.type==="error"?"error":P.type==="warning"?"warning":P.type==="success"?"success":"info";Gn[j](P.title,{description:P.message,duration:5e3,style:{borderRadius:"0.5rem",padding:"0.75rem 1rem",margin:"0.5rem",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)"}})},[]),l=L.useCallback(P=>{n(E=>E.map(j=>j.id===P?{...j,read:!0}:j))},[]),h=L.useCallback(()=>{n(P=>P.map(E=>({...E,read:!0})))},[]),i=L.useCallback(P=>{n(E=>E.filter(j=>j.id!==P))},[]),y=L.useCallback(()=>{n([])},[]),x=L.useCallback((P,E)=>{E.forEach(j=>{const D=P/j.amount*100;D>=100?a({type:"error",title:"Budget Exceeded!",message:`You've exceeded your ${j.category} budget of $${j.amount}. Current spending: $${P.toFixed(2)}`,category:"spending",actionUrl:"/caps"}):D>=90?a({type:"warning",title:"Budget Warning",message:`You're at ${D.toFixed(1)}% of your ${j.category} budget. Only $${(j.amount-P).toFixed(2)} remaining.`,category:"spending",actionUrl:"/caps"}):D>=75&&a({type:"info",title:"Budget Update",message:`You've used ${D.toFixed(1)}% of your ${j.category} budget. $${(j.amount-P).toFixed(2)} remaining.`,category:"spending",actionUrl:"/caps"})})},[a]),w=L.useCallback(P=>{P.monthlySpending>P.monthlyBudget?a({type:"error",title:"Monthly Budget Exceeded",message:`You've exceeded your monthly budget by $${(P.monthlySpending-P.monthlyBudget).toFixed(2)}`,category:"budget",actionUrl:"/analytics"}):P.monthlySpending>P.monthlyBudget*.9&&a({type:"warning",title:"Monthly Budget Warning",message:`You're at ${(P.monthlySpending/P.monthlyBudget*100).toFixed(1)}% of your monthly budget`,category:"budget",actionUrl:"/analytics"})},[a]);L.useEffect(()=>{setTimeout(()=>{a({type:"info",title:"Welcome to MoneyLens!",message:"Your financial tracking dashboard is ready. Start by setting up your spending caps.",category:"system",actionUrl:"/caps"})},2e3),setTimeout(()=>{a({type:"success",title:"Transaction Processed",message:"Your recent transaction at Starbucks has been recorded successfully.",category:"spending",actionUrl:"/transactions"})},5e3)},[a]);const C={notifications:t,unreadCount:r,addNotification:a,markAsRead:l,markAllAsRead:h,removeNotification:i,clearAllNotifications:y,checkSpendingAlerts:x,checkBudgetAlerts:w};return v.jsx(yte.Provider,{value:C,children:e})},HF=L.createContext({});function WF(e){const t=L.useRef(null);return t.current===null&&(t.current=e()),t.current}const ZF=typeof window<"u",vte=ZF?L.useLayoutEffect:L.useEffect,Z3=L.createContext(null);function KF(e,t){e.indexOf(t)===-1&&e.push(t)}function YF(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const oy=(e,t,n)=>n>t?t:n<e?e:n;let JP=()=>{};const ly={},_te=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function xte(e){return typeof e=="object"&&e!==null}const bte=e=>/^0[^.\s]+$/u.test(e);function XF(e){let t;return()=>(t===void 0&&(t=e()),t)}const vf=e=>e,fAe=(e,t)=>n=>t(e(n)),P5=(...e)=>e.reduce(fAe),jA=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r};class JF{constructor(){this.subscriptions=[]}add(t){return KF(this.subscriptions,t),()=>YF(this.subscriptions,t)}notify(t,n,r){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](t,n,r);else for(let l=0;l<a;l++){const h=this.subscriptions[l];h&&h(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Om=e=>e*1e3,mf=e=>e/1e3;function wte(e,t){return t?e*(1e3/t):0}const Ste=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,pAe=1e-7,mAe=12;function gAe(e,t,n,r,a){let l,h,i=0;do h=t+(n-t)/2,l=Ste(h,r,a)-e,l>0?n=h:t=h;while(Math.abs(l)>pAe&&++i<mAe);return h}function k5(e,t,n,r){if(e===t&&n===r)return vf;const a=l=>gAe(l,0,1,e,n);return l=>l===0||l===1?l:Ste(a(l),t,r)}const Ate=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Tte=e=>t=>1-e(1-t),Cte=k5(.33,1.53,.69,.99),QF=Tte(Cte),Ete=Ate(QF),Pte=e=>(e*=2)<1?.5*QF(e):.5*(2-Math.pow(2,-10*(e-1))),e6=e=>1-Math.sin(Math.acos(e)),kte=Tte(e6),Ite=Ate(e6),yAe=k5(.42,0,1,1),vAe=k5(0,0,.58,1),Nte=k5(.42,0,.58,1),_Ae=e=>Array.isArray(e)&&typeof e[0]!="number",Mte=e=>Array.isArray(e)&&typeof e[0]=="number",oq={linear:vf,easeIn:yAe,easeInOut:Nte,easeOut:vAe,circIn:e6,circInOut:Ite,circOut:kte,backIn:QF,backInOut:Ete,backOut:Cte,anticipate:Pte},xAe=e=>typeof e=="string",lq=e=>{if(Mte(e)){JP(e.length===4);const[t,n,r,a]=e;return k5(t,n,r,a)}else if(xAe(e))return JP(oq[e]!==void 0),oq[e];return e},WC=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],cq={value:null,addProjectionMetrics:null};function bAe(e,t){let n=new Set,r=new Set,a=!1,l=!1;const h=new WeakSet;let i={delta:0,timestamp:0,isProcessing:!1},y=0;function x(C){h.has(C)&&(w.schedule(C),e()),y++,C(i)}const w={schedule:(C,P=!1,E=!1)=>{const D=E&&a?n:r;return P&&h.add(C),D.has(C)||D.add(C),C},cancel:C=>{r.delete(C),h.delete(C)},process:C=>{if(i=C,a){l=!0;return}a=!0,[n,r]=[r,n],n.forEach(x),t&&cq.value&&cq.value.frameloop[t].push(y),y=0,n.clear(),a=!1,l&&(l=!1,w.process(C))}};return w}const wAe=40;function Lte(e,t){let n=!1,r=!0;const a={delta:0,timestamp:0,isProcessing:!1},l=()=>n=!0,h=WC.reduce((H,J)=>(H[J]=bAe(l,t?J:void 0),H),{}),{setup:i,read:y,resolveKeyframes:x,preUpdate:w,update:C,preRender:P,render:E,postRender:j}=h,D=()=>{const H=ly.useManualTiming?a.timestamp:performance.now();n=!1,ly.useManualTiming||(a.delta=r?1e3/60:Math.max(Math.min(H-a.timestamp,wAe),1)),a.timestamp=H,a.isProcessing=!0,i.process(a),y.process(a),x.process(a),w.process(a),C.process(a),P.process(a),E.process(a),j.process(a),a.isProcessing=!1,n&&t&&(r=!1,e(D))},B=()=>{n=!0,r=!0,a.isProcessing||e(D)};return{schedule:WC.reduce((H,J)=>{const ee=h[J];return H[J]=(Q,ne=!1,pe=!1)=>(n||B(),ee.schedule(Q,ne,pe)),H},{}),cancel:H=>{for(let J=0;J<WC.length;J++)h[WC[J]].cancel(H)},state:a,steps:h}}const{schedule:zo,cancel:hv,state:qc,steps:CL}=Lte(typeof requestAnimationFrame<"u"?requestAnimationFrame:vf,!0);let XE;function SAe(){XE=void 0}const Ud={now:()=>(XE===void 0&&Ud.set(qc.isProcessing||ly.useManualTiming?qc.timestamp:performance.now()),XE),set:e=>{XE=e,queueMicrotask(SAe)}},Dte=e=>t=>typeof t=="string"&&t.startsWith(e),t6=Dte("--"),AAe=Dte("var(--"),n6=e=>AAe(e)?TAe.test(e.split("/*")[0].trim()):!1,TAe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Nw={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},OA={...Nw,transform:e=>oy(0,1,e)},ZC={...Nw,default:1},KS=e=>Math.round(e*1e5)/1e5,r6=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function CAe(e){return e==null}const EAe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,i6=(e,t)=>n=>!!(typeof n=="string"&&EAe.test(n)&&n.startsWith(e)||t&&!CAe(n)&&Object.prototype.hasOwnProperty.call(n,t)),Rte=(e,t,n)=>r=>{if(typeof r!="string")return r;const[a,l,h,i]=r.match(r6);return{[e]:parseFloat(a),[t]:parseFloat(l),[n]:parseFloat(h),alpha:i!==void 0?parseFloat(i):1}},PAe=e=>oy(0,255,e),EL={...Nw,transform:e=>Math.round(PAe(e))},k_={test:i6("rgb","red"),parse:Rte("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+EL.transform(e)+", "+EL.transform(t)+", "+EL.transform(n)+", "+KS(OA.transform(r))+")"};function kAe(e){let t="",n="",r="",a="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),a=e.substring(4,5),t+=t,n+=n,r+=r,a+=a),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:a?parseInt(a,16)/255:1}}const SR={test:i6("#"),parse:kAe,transform:k_.transform},I5=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),m0=I5("deg"),Fm=I5("%"),Gi=I5("px"),IAe=I5("vh"),NAe=I5("vw"),uq={...Fm,parse:e=>Fm.parse(e)/100,transform:e=>Fm.transform(e*100)},Q1={test:i6("hsl","hue"),parse:Rte("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+Fm.transform(KS(t))+", "+Fm.transform(KS(n))+", "+KS(OA.transform(r))+")"},Ol={test:e=>k_.test(e)||SR.test(e)||Q1.test(e),parse:e=>k_.test(e)?k_.parse(e):Q1.test(e)?Q1.parse(e):SR.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?k_.transform(e):Q1.transform(e),getAnimatableNone:e=>{const t=Ol.parse(e);return t.alpha=0,Ol.transform(t)}},MAe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function LAe(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(r6))==null?void 0:t.length)||0)+(((n=e.match(MAe))==null?void 0:n.length)||0)>0}const jte="number",Ote="color",DAe="var",RAe="var(",dq="${}",jAe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function FA(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},a=[];let l=0;const i=t.replace(jAe,y=>(Ol.test(y)?(r.color.push(l),a.push(Ote),n.push(Ol.parse(y))):y.startsWith(RAe)?(r.var.push(l),a.push(DAe),n.push(y)):(r.number.push(l),a.push(jte),n.push(parseFloat(y))),++l,dq)).split(dq);return{values:n,split:i,indexes:r,types:a}}function Fte(e){return FA(e).values}function zte(e){const{split:t,types:n}=FA(e),r=t.length;return a=>{let l="";for(let h=0;h<r;h++)if(l+=t[h],a[h]!==void 0){const i=n[h];i===jte?l+=KS(a[h]):i===Ote?l+=Ol.transform(a[h]):l+=a[h]}return l}}const OAe=e=>typeof e=="number"?0:Ol.test(e)?Ol.getAnimatableNone(e):e;function FAe(e){const t=Fte(e);return zte(e)(t.map(OAe))}const fv={test:LAe,parse:Fte,createTransformer:zte,getAnimatableNone:FAe};function PL(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function zAe({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let a=0,l=0,h=0;if(!t)a=l=h=n;else{const i=n<.5?n*(1+t):n+t-n*t,y=2*n-i;a=PL(y,i,e+1/3),l=PL(y,i,e),h=PL(y,i,e-1/3)}return{red:Math.round(a*255),green:Math.round(l*255),blue:Math.round(h*255),alpha:r}}function QP(e,t){return n=>n>0?t:e}const Zo=(e,t,n)=>e+(t-e)*n,kL=(e,t,n)=>{const r=e*e,a=n*(t*t-r)+r;return a<0?0:Math.sqrt(a)},BAe=[SR,k_,Q1],UAe=e=>BAe.find(t=>t.test(e));function hq(e){const t=UAe(e);if(!t)return!1;let n=t.parse(e);return t===Q1&&(n=zAe(n)),n}const fq=(e,t)=>{const n=hq(e),r=hq(t);if(!n||!r)return QP(e,t);const a={...n};return l=>(a.red=kL(n.red,r.red,l),a.green=kL(n.green,r.green,l),a.blue=kL(n.blue,r.blue,l),a.alpha=Zo(n.alpha,r.alpha,l),k_.transform(a))},AR=new Set(["none","hidden"]);function VAe(e,t){return AR.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function $Ae(e,t){return n=>Zo(e,t,n)}function s6(e){return typeof e=="number"?$Ae:typeof e=="string"?n6(e)?QP:Ol.test(e)?fq:HAe:Array.isArray(e)?Bte:typeof e=="object"?Ol.test(e)?fq:qAe:QP}function Bte(e,t){const n=[...e],r=n.length,a=e.map((l,h)=>s6(l)(l,t[h]));return l=>{for(let h=0;h<r;h++)n[h]=a[h](l);return n}}function qAe(e,t){const n={...e,...t},r={};for(const a in n)e[a]!==void 0&&t[a]!==void 0&&(r[a]=s6(e[a])(e[a],t[a]));return a=>{for(const l in r)n[l]=r[l](a);return n}}function GAe(e,t){const n=[],r={color:0,var:0,number:0};for(let a=0;a<t.values.length;a++){const l=t.types[a],h=e.indexes[l][r[l]],i=e.values[h]??0;n[a]=i,r[l]++}return n}const HAe=(e,t)=>{const n=fv.createTransformer(t),r=FA(e),a=FA(t);return r.indexes.var.length===a.indexes.var.length&&r.indexes.color.length===a.indexes.color.length&&r.indexes.number.length>=a.indexes.number.length?AR.has(e)&&!a.values.length||AR.has(t)&&!r.values.length?VAe(e,t):P5(Bte(GAe(r,a),a.values),n):QP(e,t)};function Ute(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?Zo(e,t,n):s6(e)(e,t)}const WAe=e=>{const t=({timestamp:n})=>e(n);return{start:(n=!0)=>zo.update(t,n),stop:()=>hv(t),now:()=>qc.isProcessing?qc.timestamp:Ud.now()}},Vte=(e,t,n=10)=>{let r="";const a=Math.max(Math.round(t/n),2);for(let l=0;l<a;l++)r+=Math.round(e(l/(a-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},ek=2e4;function a6(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<ek;)t+=n,r=e.next(t);return t>=ek?1/0:t}function ZAe(e,t=100,n){const r=n({...e,keyframes:[0,t]}),a=Math.min(a6(r),ek);return{type:"keyframes",ease:l=>r.next(a*l).value/t,duration:mf(a)}}const KAe=5;function $te(e,t,n){const r=Math.max(t-KAe,0);return wte(n-e(r),t-r)}const il={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},IL=.001;function YAe({duration:e=il.duration,bounce:t=il.bounce,velocity:n=il.velocity,mass:r=il.mass}){let a,l,h=1-t;h=oy(il.minDamping,il.maxDamping,h),e=oy(il.minDuration,il.maxDuration,mf(e)),h<1?(a=x=>{const w=x*h,C=w*e,P=w-n,E=TR(x,h),j=Math.exp(-C);return IL-P/E*j},l=x=>{const C=x*h*e,P=C*n+n,E=Math.pow(h,2)*Math.pow(x,2)*e,j=Math.exp(-C),D=TR(Math.pow(x,2),h);return(-a(x)+IL>0?-1:1)*((P-E)*j)/D}):(a=x=>{const w=Math.exp(-x*e),C=(x-n)*e+1;return-IL+w*C},l=x=>{const w=Math.exp(-x*e),C=(n-x)*(e*e);return w*C});const i=5/e,y=JAe(a,l,i);if(e=Om(e),isNaN(y))return{stiffness:il.stiffness,damping:il.damping,duration:e};{const x=Math.pow(y,2)*r;return{stiffness:x,damping:h*2*Math.sqrt(r*x),duration:e}}}const XAe=12;function JAe(e,t,n){let r=n;for(let a=1;a<XAe;a++)r=r-e(r)/t(r);return r}function TR(e,t){return e*Math.sqrt(1-t*t)}const QAe=["duration","bounce"],e5e=["stiffness","damping","mass"];function pq(e,t){return t.some(n=>e[n]!==void 0)}function t5e(e){let t={velocity:il.velocity,stiffness:il.stiffness,damping:il.damping,mass:il.mass,isResolvedFromDuration:!1,...e};if(!pq(e,e5e)&&pq(e,QAe))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(n*1.2),a=r*r,l=2*oy(.05,1,1-(e.bounce||0))*Math.sqrt(a);t={...t,mass:il.mass,stiffness:a,damping:l}}else{const n=YAe(e);t={...t,...n,mass:il.mass},t.isResolvedFromDuration=!0}return t}function tk(e=il.visualDuration,t=il.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:a}=n;const l=n.keyframes[0],h=n.keyframes[n.keyframes.length-1],i={done:!1,value:l},{stiffness:y,damping:x,mass:w,duration:C,velocity:P,isResolvedFromDuration:E}=t5e({...n,velocity:-mf(n.velocity||0)}),j=P||0,D=x/(2*Math.sqrt(y*w)),B=h-l,F=mf(Math.sqrt(y/w)),$=Math.abs(B)<5;r||(r=$?il.restSpeed.granular:il.restSpeed.default),a||(a=$?il.restDelta.granular:il.restDelta.default);let H;if(D<1){const ee=TR(F,D);H=Q=>{const ne=Math.exp(-D*F*Q);return h-ne*((j+D*F*B)/ee*Math.sin(ee*Q)+B*Math.cos(ee*Q))}}else if(D===1)H=ee=>h-Math.exp(-F*ee)*(B+(j+F*B)*ee);else{const ee=F*Math.sqrt(D*D-1);H=Q=>{const ne=Math.exp(-D*F*Q),pe=Math.min(ee*Q,300);return h-ne*((j+D*F*B)*Math.sinh(pe)+ee*B*Math.cosh(pe))/ee}}const J={calculatedDuration:E&&C||null,next:ee=>{const Q=H(ee);if(E)i.done=ee>=C;else{let ne=ee===0?j:0;D<1&&(ne=ee===0?Om(j):$te(H,ee,Q));const pe=Math.abs(ne)<=r,he=Math.abs(h-Q)<=a;i.done=pe&&he}return i.value=i.done?h:Q,i},toString:()=>{const ee=Math.min(a6(J),ek),Q=Vte(ne=>J.next(ee*ne).value,ee,30);return ee+"ms "+Q},toTransition:()=>{}};return J}tk.applyToOptions=e=>{const t=ZAe(e,100,tk);return e.ease=t.ease,e.duration=Om(t.duration),e.type="keyframes",e};function CR({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:a=10,bounceStiffness:l=500,modifyTarget:h,min:i,max:y,restDelta:x=.5,restSpeed:w}){const C=e[0],P={done:!1,value:C},E=pe=>i!==void 0&&pe<i||y!==void 0&&pe>y,j=pe=>i===void 0?y:y===void 0||Math.abs(i-pe)<Math.abs(y-pe)?i:y;let D=n*t;const B=C+D,F=h===void 0?B:h(B);F!==B&&(D=F-C);const $=pe=>-D*Math.exp(-pe/r),H=pe=>F+$(pe),J=pe=>{const he=$(pe),we=H(pe);P.done=Math.abs(he)<=x,P.value=P.done?F:we};let ee,Q;const ne=pe=>{E(P.value)&&(ee=pe,Q=tk({keyframes:[P.value,j(P.value)],velocity:$te(H,pe,P.value),damping:a,stiffness:l,restDelta:x,restSpeed:w}))};return ne(0),{calculatedDuration:null,next:pe=>{let he=!1;return!Q&&ee===void 0&&(he=!0,J(pe),ne(pe)),ee!==void 0&&pe>=ee?Q.next(pe-ee):(!he&&J(pe),P)}}}function n5e(e,t,n){const r=[],a=n||ly.mix||Ute,l=e.length-1;for(let h=0;h<l;h++){let i=a(e[h],e[h+1]);if(t){const y=Array.isArray(t)?t[h]||vf:t;i=P5(y,i)}r.push(i)}return r}function r5e(e,t,{clamp:n=!0,ease:r,mixer:a}={}){const l=e.length;if(JP(l===t.length),l===1)return()=>t[0];if(l===2&&t[0]===t[1])return()=>t[1];const h=e[0]===e[1];e[0]>e[l-1]&&(e=[...e].reverse(),t=[...t].reverse());const i=n5e(t,r,a),y=i.length,x=w=>{if(h&&w<e[0])return t[0];let C=0;if(y>1)for(;C<e.length-2&&!(w<e[C+1]);C++);const P=jA(e[C],e[C+1],w);return i[C](P)};return n?w=>x(oy(e[0],e[l-1],w)):x}function i5e(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const a=jA(0,t,r);e.push(Zo(n,1,a))}}function s5e(e){const t=[0];return i5e(t,e.length-1),t}function a5e(e,t){return e.map(n=>n*t)}function o5e(e,t){return e.map(()=>t||Nte).splice(0,e.length-1)}function YS({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const a=_Ae(r)?r.map(lq):lq(r),l={done:!1,value:t[0]},h=a5e(n&&n.length===t.length?n:s5e(t),e),i=r5e(h,t,{ease:Array.isArray(a)?a:o5e(t,a)});return{calculatedDuration:e,next:y=>(l.value=i(y),l.done=y>=e,l)}}const l5e=e=>e!==null;function o6(e,{repeat:t,repeatType:n="loop"},r,a=1){const l=e.filter(l5e),i=a<0||t&&n!=="loop"&&t%2===1?0:l.length-1;return!i||r===void 0?l[i]:r}const c5e={decay:CR,inertia:CR,tween:YS,keyframes:YS,spring:tk};function qte(e){typeof e.type=="string"&&(e.type=c5e[e.type])}class l6{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const u5e=e=>e/100;class c6 extends l6{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var r,a;const{motionValue:n}=this.options;n&&n.updatedAt!==Ud.now()&&this.tick(Ud.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(a=(r=this.options).onStop)==null||a.call(r))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;qte(t);const{type:n=YS,repeat:r=0,repeatDelay:a=0,repeatType:l,velocity:h=0}=t;let{keyframes:i}=t;const y=n||YS;y!==YS&&typeof i[0]!="number"&&(this.mixKeyframes=P5(u5e,Ute(i[0],i[1])),i=[0,100]);const x=y({...t,keyframes:i});l==="mirror"&&(this.mirroredGenerator=y({...t,keyframes:[...i].reverse(),velocity:-h})),x.calculatedDuration===null&&(x.calculatedDuration=a6(x));const{calculatedDuration:w}=x;this.calculatedDuration=w,this.resolvedDuration=w+a,this.totalDuration=this.resolvedDuration*(r+1)-a,this.generator=x}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:r,totalDuration:a,mixKeyframes:l,mirroredGenerator:h,resolvedDuration:i,calculatedDuration:y}=this;if(this.startTime===null)return r.next(0);const{delay:x=0,keyframes:w,repeat:C,repeatType:P,repeatDelay:E,type:j,onUpdate:D,finalKeyframe:B}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-a/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const F=this.currentTime-x*(this.playbackSpeed>=0?1:-1),$=this.playbackSpeed>=0?F<0:F>a;this.currentTime=Math.max(F,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=a);let H=this.currentTime,J=r;if(C){const pe=Math.min(this.currentTime,a)/i;let he=Math.floor(pe),we=pe%1;!we&&pe>=1&&(we=1),we===1&&he--,he=Math.min(he,C+1),!!(he%2)&&(P==="reverse"?(we=1-we,E&&(we-=E/i)):P==="mirror"&&(J=h)),H=oy(0,1,we)*i}const ee=$?{done:!1,value:w[0]}:J.next(H);l&&(ee.value=l(ee.value));let{done:Q}=ee;!$&&y!==null&&(Q=this.playbackSpeed>=0?this.currentTime>=a:this.currentTime<=0);const ne=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&Q);return ne&&j!==CR&&(ee.value=o6(w,this.options,B,this.speed)),D&&D(ee.value),ne&&this.finish(),ee}then(t,n){return this.finished.then(t,n)}get duration(){return mf(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+mf(t)}get time(){return mf(this.currentTime)}set time(t){var n;t=Om(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Ud.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=mf(this.currentTime))}play(){var a,l;if(this.isStopped)return;const{driver:t=WAe,startTime:n}=this.options;this.driver||(this.driver=t(h=>this.tick(h))),(l=(a=this.options).onPlay)==null||l.call(a);const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=n??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ud.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(t=this.options).onComplete)==null||n.call(t)}cancel(){var t,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(t=this.options).onCancel)==null||n.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),t.observe(this)}}function d5e(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const I_=e=>e*180/Math.PI,ER=e=>{const t=I_(Math.atan2(e[1],e[0]));return PR(t)},h5e={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:ER,rotateZ:ER,skewX:e=>I_(Math.atan(e[1])),skewY:e=>I_(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},PR=e=>(e=e%360,e<0&&(e+=360),e),mq=ER,gq=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),yq=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),f5e={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:gq,scaleY:yq,scale:e=>(gq(e)+yq(e))/2,rotateX:e=>PR(I_(Math.atan2(e[6],e[5]))),rotateY:e=>PR(I_(Math.atan2(-e[2],e[0]))),rotateZ:mq,rotate:mq,skewX:e=>I_(Math.atan(e[4])),skewY:e=>I_(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function kR(e){return e.includes("scale")?1:0}function IR(e,t){if(!e||e==="none")return kR(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,a;if(n)r=f5e,a=n;else{const i=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=h5e,a=i}if(!a)return kR(t);const l=r[t],h=a[1].split(",").map(m5e);return typeof l=="function"?l(h):h[l]}const p5e=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return IR(n,t)};function m5e(e){return parseFloat(e.trim())}const Mw=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Lw=new Set(Mw),vq=e=>e===Nw||e===Gi,g5e=new Set(["x","y","z"]),y5e=Mw.filter(e=>!g5e.has(e));function v5e(e){const t=[];return y5e.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}const Y_={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>IR(t,"x"),y:(e,{transform:t})=>IR(t,"y")};Y_.translateX=Y_.x;Y_.translateY=Y_.y;const X_=new Set;let NR=!1,MR=!1,LR=!1;function Gte(){if(MR){const e=Array.from(X_).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{const a=v5e(r);a.length&&(n.set(r,a),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const a=n.get(r);a&&a.forEach(([l,h])=>{var i;(i=r.getValue(l))==null||i.set(h)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}MR=!1,NR=!1,X_.forEach(e=>e.complete(LR)),X_.clear()}function Hte(){X_.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(MR=!0)})}function _5e(){LR=!0,Hte(),Gte(),LR=!1}class u6{constructor(t,n,r,a,l,h=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=a,this.element=l,this.isAsync=h}scheduleResolve(){this.state="scheduled",this.isAsync?(X_.add(this),NR||(NR=!0,zo.read(Hte),zo.resolveKeyframes(Gte))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:r,motionValue:a}=this;if(t[0]===null){const l=a==null?void 0:a.get(),h=t[t.length-1];if(l!==void 0)t[0]=l;else if(r&&n){const i=r.readValue(n,h);i!=null&&(t[0]=i)}t[0]===void 0&&(t[0]=h),a&&l===void 0&&a.set(t[0])}d5e(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),X_.delete(this)}cancel(){this.state==="scheduled"&&(X_.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const x5e=e=>e.startsWith("--");function b5e(e,t,n){x5e(t)?e.style.setProperty(t,n):e.style[t]=n}const w5e=XF(()=>window.ScrollTimeline!==void 0),S5e={};function A5e(e,t){const n=XF(e);return()=>S5e[t]??n()}const Wte=A5e(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),kS=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,_q={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:kS([0,.65,.55,1]),circOut:kS([.55,0,1,.45]),backIn:kS([.31,.01,.66,-.59]),backOut:kS([.33,1.53,.69,.99])};function Zte(e,t){if(e)return typeof e=="function"?Wte()?Vte(e,t):"ease-out":Mte(e)?kS(e):Array.isArray(e)?e.map(n=>Zte(n,t)||_q.easeOut):_q[e]}function T5e(e,t,n,{delay:r=0,duration:a=300,repeat:l=0,repeatType:h="loop",ease:i="easeOut",times:y}={},x=void 0){const w={[t]:n};y&&(w.offset=y);const C=Zte(i,a);Array.isArray(C)&&(w.easing=C);const P={delay:r,duration:a,easing:Array.isArray(C)?"linear":C,fill:"both",iterations:l+1,direction:h==="reverse"?"alternate":"normal"};return x&&(P.pseudoElement=x),e.animate(w,P)}function Kte(e){return typeof e=="function"&&"applyToOptions"in e}function C5e({type:e,...t}){return Kte(e)&&Wte()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class E5e extends l6{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:n,name:r,keyframes:a,pseudoElement:l,allowFlatten:h=!1,finalKeyframe:i,onComplete:y}=t;this.isPseudoElement=!!l,this.allowFlatten=h,this.options=t,JP(typeof t.type!="string");const x=C5e(t);this.animation=T5e(n,r,a,x,l),x.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!l){const w=o6(a,this.options,i,this.speed);this.updateMotionValue?this.updateMotionValue(w):b5e(n,r,w),this.animation.cancel()}y==null||y(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,n;(n=(t=this.animation).finish)==null||n.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,n;this.isPseudoElement||(n=(t=this.animation).commitStyles)==null||n.call(t)}get duration(){var n,r;const t=((r=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:r.call(n).duration)||0;return mf(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+mf(t)}get time(){return mf(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Om(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&w5e()?(this.animation.timeline=t,vf):n(this)}}const Yte={anticipate:Pte,backInOut:Ete,circInOut:Ite};function P5e(e){return e in Yte}function k5e(e){typeof e.ease=="string"&&P5e(e.ease)&&(e.ease=Yte[e.ease])}const xq=10;class I5e extends E5e{constructor(t){k5e(t),qte(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:r,onComplete:a,element:l,...h}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const i=new c6({...h,autoplay:!1}),y=Om(this.finishedTime??this.time);n.setWithVelocity(i.sample(y-xq).value,i.sample(y).value,xq),i.stop()}}const bq=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(fv.test(e)||e==="0")&&!e.startsWith("url("));function N5e(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function M5e(e,t,n,r){const a=e[0];if(a===null)return!1;if(t==="display"||t==="visibility")return!0;const l=e[e.length-1],h=bq(a,t),i=bq(l,t);return!h||!i?!1:N5e(e)||(n==="spring"||Kte(n))&&r}function DR(e){e.duration=0,e.type="keyframes"}const L5e=new Set(["opacity","clipPath","filter","transform"]),D5e=XF(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function R5e(e){var w;const{motionValue:t,name:n,repeatDelay:r,repeatType:a,damping:l,type:h}=e;if(!(((w=t==null?void 0:t.owner)==null?void 0:w.current)instanceof HTMLElement))return!1;const{onUpdate:y,transformTemplate:x}=t.owner.getProps();return D5e()&&n&&L5e.has(n)&&(n!=="transform"||!x)&&!y&&!r&&a!=="mirror"&&l!==0&&h!=="inertia"}const j5e=40;class O5e extends l6{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:a=0,repeatDelay:l=0,repeatType:h="loop",keyframes:i,name:y,motionValue:x,element:w,...C}){var j;super(),this.stop=()=>{var D,B;this._animation&&(this._animation.stop(),(D=this.stopTimeline)==null||D.call(this)),(B=this.keyframeResolver)==null||B.cancel()},this.createdAt=Ud.now();const P={autoplay:t,delay:n,type:r,repeat:a,repeatDelay:l,repeatType:h,name:y,motionValue:x,element:w,...C},E=(w==null?void 0:w.KeyframeResolver)||u6;this.keyframeResolver=new E(i,(D,B,F)=>this.onKeyframesResolved(D,B,P,!F),y,x,w),(j=this.keyframeResolver)==null||j.scheduleResolve()}onKeyframesResolved(t,n,r,a){this.keyframeResolver=void 0;const{name:l,type:h,velocity:i,delay:y,isHandoff:x,onUpdate:w}=r;this.resolvedAt=Ud.now(),M5e(t,l,h,i)||((ly.instantAnimations||!y)&&(w==null||w(o6(t,r,n))),t[0]=t[t.length-1],DR(r),r.repeat=0);const P={startTime:a?this.resolvedAt?this.resolvedAt-this.createdAt>j5e?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:t},E=!x&&R5e(P)?new I5e({...P,element:P.motionValue.owner.current}):new c6(P);E.finished.then(()=>this.notifyFinished()).catch(vf),this.pendingTimeline&&(this.stopTimeline=E.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=E}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),_5e()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}const F5e=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function z5e(e){const t=F5e.exec(e);if(!t)return[,];const[,n,r,a]=t;return[`--${n??r}`,a]}function Xte(e,t,n=1){const[r,a]=z5e(e);if(!r)return;const l=window.getComputedStyle(t).getPropertyValue(r);if(l){const h=l.trim();return _te(h)?parseFloat(h):h}return n6(a)?Xte(a,t,n+1):a}function d6(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const Jte=new Set(["width","height","top","left","right","bottom",...Mw]),B5e={test:e=>e==="auto",parse:e=>e},Qte=e=>t=>t.test(e),ene=[Nw,Gi,Fm,m0,NAe,IAe,B5e],wq=e=>ene.find(Qte(e));function U5e(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||bte(e):!0}const V5e=new Set(["brightness","contrast","saturate","opacity"]);function $5e(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(r6)||[];if(!r)return e;const a=n.replace(r,"");let l=V5e.has(t)?1:0;return r!==n&&(l*=100),t+"("+l+a+")"}const q5e=/\b([a-z-]*)\(.*?\)/gu,RR={...fv,getAnimatableNone:e=>{const t=e.match(q5e);return t?t.map($5e).join(" "):e}},Sq={...Nw,transform:Math.round},G5e={rotate:m0,rotateX:m0,rotateY:m0,rotateZ:m0,scale:ZC,scaleX:ZC,scaleY:ZC,scaleZ:ZC,skew:m0,skewX:m0,skewY:m0,distance:Gi,translateX:Gi,translateY:Gi,translateZ:Gi,x:Gi,y:Gi,z:Gi,perspective:Gi,transformPerspective:Gi,opacity:OA,originX:uq,originY:uq,originZ:Gi},h6={borderWidth:Gi,borderTopWidth:Gi,borderRightWidth:Gi,borderBottomWidth:Gi,borderLeftWidth:Gi,borderRadius:Gi,radius:Gi,borderTopLeftRadius:Gi,borderTopRightRadius:Gi,borderBottomRightRadius:Gi,borderBottomLeftRadius:Gi,width:Gi,maxWidth:Gi,height:Gi,maxHeight:Gi,top:Gi,right:Gi,bottom:Gi,left:Gi,padding:Gi,paddingTop:Gi,paddingRight:Gi,paddingBottom:Gi,paddingLeft:Gi,margin:Gi,marginTop:Gi,marginRight:Gi,marginBottom:Gi,marginLeft:Gi,backgroundPositionX:Gi,backgroundPositionY:Gi,...G5e,zIndex:Sq,fillOpacity:OA,strokeOpacity:OA,numOctaves:Sq},H5e={...h6,color:Ol,backgroundColor:Ol,outlineColor:Ol,fill:Ol,stroke:Ol,borderColor:Ol,borderTopColor:Ol,borderRightColor:Ol,borderBottomColor:Ol,borderLeftColor:Ol,filter:RR,WebkitFilter:RR},tne=e=>H5e[e];function nne(e,t){let n=tne(e);return n!==RR&&(n=fv),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const W5e=new Set(["auto","none","0"]);function Z5e(e,t,n){let r=0,a;for(;r<e.length&&!a;){const l=e[r];typeof l=="string"&&!W5e.has(l)&&FA(l).values.length&&(a=e[r]),r++}if(a&&n)for(const l of t)e[l]=nne(n,a)}class K5e extends u6{constructor(t,n,r,a,l){super(t,n,r,a,l,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let y=0;y<t.length;y++){let x=t[y];if(typeof x=="string"&&(x=x.trim(),n6(x))){const w=Xte(x,n.current);w!==void 0&&(t[y]=w),y===t.length-1&&(this.finalKeyframe=x)}}if(this.resolveNoneKeyframes(),!Jte.has(r)||t.length!==2)return;const[a,l]=t,h=wq(a),i=wq(l);if(h!==i)if(vq(h)&&vq(i))for(let y=0;y<t.length;y++){const x=t[y];typeof x=="string"&&(t[y]=parseFloat(x))}else Y_[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,r=[];for(let a=0;a<t.length;a++)(t[a]===null||U5e(t[a]))&&r.push(a);r.length&&Z5e(t,r,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Y_[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const a=n[n.length-1];a!==void 0&&t.getValue(r,a).jump(a,!1)}measureEndState(){var i;const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const a=t.getValue(n);a&&a.jump(this.measuredOrigin,!1);const l=r.length-1,h=r[l];r[l]=Y_[n](t.measureViewportBox(),window.getComputedStyle(t.current)),h!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=h),(i=this.removedTransforms)!=null&&i.length&&this.removedTransforms.forEach(([y,x])=>{t.getValue(y).set(x)}),this.resolveNoneKeyframes()}}function Y5e(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){const a=document.querySelectorAll(e);return a?Array.from(a):[]}return Array.from(e)}const rne=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function ine(e){return xte(e)&&"offsetHeight"in e}const Aq=30,X5e=e=>!isNaN(parseFloat(e));class J5e{constructor(t,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{var l;const a=Ud.now();if(this.updatedAt!==a&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((l=this.events.change)==null||l.notify(this.current),this.dependents))for(const h of this.dependents)h.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=Ud.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=X5e(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new JF);const r=this.events[t].add(n);return t==="change"?()=>{r(),zo.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Ud.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Aq)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,Aq);return wte(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,n;(t=this.dependents)==null||t.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ew(e,t){return new J5e(e,t)}const{schedule:f6,cancel:jXe}=Lte(queueMicrotask,!1),lp={x:!1,y:!1};function sne(){return lp.x||lp.y}function Q5e(e){return e==="x"||e==="y"?lp[e]?null:(lp[e]=!0,()=>{lp[e]=!1}):lp.x||lp.y?null:(lp.x=lp.y=!0,()=>{lp.x=lp.y=!1})}function ane(e,t){const n=Y5e(e),r=new AbortController,a={passive:!0,...t,signal:r.signal};return[n,a,()=>r.abort()]}function Tq(e){return!(e.pointerType==="touch"||sne())}function eTe(e,t,n={}){const[r,a,l]=ane(e,n),h=i=>{if(!Tq(i))return;const{target:y}=i,x=t(y,i);if(typeof x!="function"||!y)return;const w=C=>{Tq(C)&&(x(C),y.removeEventListener("pointerleave",w))};y.addEventListener("pointerleave",w,a)};return r.forEach(i=>{i.addEventListener("pointerenter",h,a)}),l}const one=(e,t)=>t?e===t?!0:one(e,t.parentElement):!1,p6=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,tTe=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function nTe(e){return tTe.has(e.tagName)||e.tabIndex!==-1}const JE=new WeakSet;function Cq(e){return t=>{t.key==="Enter"&&e(t)}}function NL(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const rTe=(e,t)=>{const n=e.currentTarget;if(!n)return;const r=Cq(()=>{if(JE.has(n))return;NL(n,"down");const a=Cq(()=>{NL(n,"up")}),l=()=>NL(n,"cancel");n.addEventListener("keyup",a,t),n.addEventListener("blur",l,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function Eq(e){return p6(e)&&!sne()}function iTe(e,t,n={}){const[r,a,l]=ane(e,n),h=i=>{const y=i.currentTarget;if(!Eq(i))return;JE.add(y);const x=t(y,i),w=(E,j)=>{window.removeEventListener("pointerup",C),window.removeEventListener("pointercancel",P),JE.has(y)&&JE.delete(y),Eq(E)&&typeof x=="function"&&x(E,{success:j})},C=E=>{w(E,y===window||y===document||n.useGlobalTarget||one(y,E.target))},P=E=>{w(E,!1)};window.addEventListener("pointerup",C,a),window.addEventListener("pointercancel",P,a)};return r.forEach(i=>{(n.useGlobalTarget?window:i).addEventListener("pointerdown",h,a),ine(i)&&(i.addEventListener("focus",x=>rTe(x,a)),!nTe(i)&&!i.hasAttribute("tabindex")&&(i.tabIndex=0))}),l}function lne(e){return xte(e)&&"ownerSVGElement"in e}function sTe(e){return lne(e)&&e.tagName==="svg"}const Au=e=>!!(e&&e.getVelocity),aTe=[...ene,Ol,fv],oTe=e=>aTe.find(Qte(e)),m6=L.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function Pq(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function lTe(...e){return t=>{let n=!1;const r=e.map(a=>{const l=Pq(a,t);return!n&&typeof l=="function"&&(n=!0),l});if(n)return()=>{for(let a=0;a<r.length;a++){const l=r[a];typeof l=="function"?l():Pq(e[a],null)}}}}function cTe(...e){return L.useCallback(lTe(...e),e)}class uTe extends L.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=n.offsetParent,a=ine(r)&&r.offsetWidth||0,l=this.props.sizeRef.current;l.height=n.offsetHeight||0,l.width=n.offsetWidth||0,l.top=n.offsetTop,l.left=n.offsetLeft,l.right=a-l.width-l.left}return null}componentDidUpdate(){}render(){return this.props.children}}function dTe({children:e,isPresent:t,anchorX:n,root:r}){const a=L.useId(),l=L.useRef(null),h=L.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:i}=L.useContext(m6),y=cTe(l,e==null?void 0:e.ref);return L.useInsertionEffect(()=>{const{width:x,height:w,top:C,left:P,right:E}=h.current;if(t||!l.current||!x||!w)return;const j=n==="left"?`left: ${P}`:`right: ${E}`;l.current.dataset.motionPopId=a;const D=document.createElement("style");i&&(D.nonce=i);const B=r??document.head;return B.appendChild(D),D.sheet&&D.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${x}px !important;
            height: ${w}px !important;
            ${j}px !important;
            top: ${C}px !important;
          }
        `),()=>{B.contains(D)&&B.removeChild(D)}},[t]),v.jsx(uTe,{isPresent:t,childRef:l,sizeRef:h,children:L.cloneElement(e,{ref:y})})}const hTe=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:a,presenceAffectsLayout:l,mode:h,anchorX:i,root:y})=>{const x=WF(fTe),w=L.useId();let C=!0,P=L.useMemo(()=>(C=!1,{id:w,initial:t,isPresent:n,custom:a,onExitComplete:E=>{x.set(E,!0);for(const j of x.values())if(!j)return;r&&r()},register:E=>(x.set(E,!1),()=>x.delete(E))}),[n,x,r]);return l&&C&&(P={...P}),L.useMemo(()=>{x.forEach((E,j)=>x.set(j,!1))},[n]),L.useEffect(()=>{!n&&!x.size&&r&&r()},[n]),h==="popLayout"&&(e=v.jsx(dTe,{isPresent:n,anchorX:i,root:y,children:e})),v.jsx(Z3.Provider,{value:P,children:e})};function fTe(){return new Map}function cne(e=!0){const t=L.useContext(Z3);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:a}=t,l=L.useId();L.useEffect(()=>{if(e)return a(l)},[e]);const h=L.useCallback(()=>e&&r&&r(l),[l,r,e]);return!n&&r?[!1,h]:[!0]}const KC=e=>e.key||"";function kq(e){const t=[];return L.Children.forEach(e,n=>{L.isValidElement(n)&&t.push(n)}),t}const une=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:a=!0,mode:l="sync",propagate:h=!1,anchorX:i="left",root:y})=>{const[x,w]=cne(h),C=L.useMemo(()=>kq(e),[e]),P=h&&!x?[]:C.map(KC),E=L.useRef(!0),j=L.useRef(C),D=WF(()=>new Map),[B,F]=L.useState(C),[$,H]=L.useState(C);vte(()=>{E.current=!1,j.current=C;for(let Q=0;Q<$.length;Q++){const ne=KC($[Q]);P.includes(ne)?D.delete(ne):D.get(ne)!==!0&&D.set(ne,!1)}},[$,P.length,P.join("-")]);const J=[];if(C!==B){let Q=[...C];for(let ne=0;ne<$.length;ne++){const pe=$[ne],he=KC(pe);P.includes(he)||(Q.splice(ne,0,pe),J.push(pe))}return l==="wait"&&J.length&&(Q=J),H(kq(Q)),F(C),null}const{forceRender:ee}=L.useContext(HF);return v.jsx(v.Fragment,{children:$.map(Q=>{const ne=KC(Q),pe=h&&!x?!1:C===$||P.includes(ne),he=()=>{if(D.has(ne))D.set(ne,!0);else return;let we=!0;D.forEach(fe=>{fe||(we=!1)}),we&&(ee==null||ee(),H(j.current),h&&(w==null||w()),r&&r())};return v.jsx(hTe,{isPresent:pe,initial:!E.current||n?void 0:!1,custom:t,presenceAffectsLayout:a,mode:l,root:y,onExitComplete:pe?void 0:he,anchorX:i,children:Q},ne)})})},dne=L.createContext({strict:!1}),Iq={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},tw={};for(const e in Iq)tw[e]={isEnabled:t=>Iq[e].some(n=>!!t[n])};function pTe(e){for(const t in e)tw[t]={...tw[t],...e[t]}}const mTe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function nk(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||mTe.has(e)}let hne=e=>!nk(e);function gTe(e){typeof e=="function"&&(hne=t=>t.startsWith("on")?!nk(t):e(t))}try{gTe(require("@emotion/is-prop-valid").default)}catch{}function yTe(e,t,n){const r={};for(const a in e)a==="values"&&typeof e.values=="object"||(hne(a)||n===!0&&nk(a)||!t&&!nk(a)||e.draggable&&a.startsWith("onDrag"))&&(r[a]=e[a]);return r}const K3=L.createContext({});function Y3(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function zA(e){return typeof e=="string"||Array.isArray(e)}const g6=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],y6=["initial",...g6];function X3(e){return Y3(e.animate)||y6.some(t=>zA(e[t]))}function fne(e){return!!(X3(e)||e.variants)}function vTe(e,t){if(X3(e)){const{initial:n,animate:r}=e;return{initial:n===!1||zA(n)?n:void 0,animate:zA(r)?r:void 0}}return e.inherit!==!1?t:{}}function _Te(e){const{initial:t,animate:n}=vTe(e,L.useContext(K3));return L.useMemo(()=>({initial:t,animate:n}),[Nq(t),Nq(n)])}function Nq(e){return Array.isArray(e)?e.join(" "):e}const BA={};function xTe(e){for(const t in e)BA[t]=e[t],t6(t)&&(BA[t].isCSSVariable=!0)}function pne(e,{layout:t,layoutId:n}){return Lw.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!BA[e]||e==="opacity")}const bTe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},wTe=Mw.length;function STe(e,t,n){let r="",a=!0;for(let l=0;l<wTe;l++){const h=Mw[l],i=e[h];if(i===void 0)continue;let y=!0;if(typeof i=="number"?y=i===(h.startsWith("scale")?1:0):y=parseFloat(i)===0,!y||n){const x=rne(i,h6[h]);if(!y){a=!1;const w=bTe[h]||h;r+=`${w}(${x}) `}n&&(t[h]=x)}}return r=r.trim(),n?r=n(t,a?"":r):a&&(r="none"),r}function v6(e,t,n){const{style:r,vars:a,transformOrigin:l}=e;let h=!1,i=!1;for(const y in t){const x=t[y];if(Lw.has(y)){h=!0;continue}else if(t6(y)){a[y]=x;continue}else{const w=rne(x,h6[y]);y.startsWith("origin")?(i=!0,l[y]=w):r[y]=w}}if(t.transform||(h||n?r.transform=STe(t,e.transform,n):r.transform&&(r.transform="none")),i){const{originX:y="50%",originY:x="50%",originZ:w=0}=l;r.transformOrigin=`${y} ${x} ${w}`}}const _6=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function mne(e,t,n){for(const r in t)!Au(t[r])&&!pne(r,n)&&(e[r]=t[r])}function ATe({transformTemplate:e},t){return L.useMemo(()=>{const n=_6();return v6(n,t,e),Object.assign({},n.vars,n.style)},[t])}function TTe(e,t){const n=e.style||{},r={};return mne(r,n,e),Object.assign(r,ATe(e,t)),r}function CTe(e,t){const n={},r=TTe(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const ETe={offset:"stroke-dashoffset",array:"stroke-dasharray"},PTe={offset:"strokeDashoffset",array:"strokeDasharray"};function kTe(e,t,n=1,r=0,a=!0){e.pathLength=1;const l=a?ETe:PTe;e[l.offset]=Gi.transform(-r);const h=Gi.transform(t),i=Gi.transform(n);e[l.array]=`${h} ${i}`}function gne(e,{attrX:t,attrY:n,attrScale:r,pathLength:a,pathSpacing:l=1,pathOffset:h=0,...i},y,x,w){if(v6(e,i,x),y){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:C,style:P}=e;C.transform&&(P.transform=C.transform,delete C.transform),(P.transform||C.transformOrigin)&&(P.transformOrigin=C.transformOrigin??"50% 50%",delete C.transformOrigin),P.transform&&(P.transformBox=(w==null?void 0:w.transformBox)??"fill-box",delete C.transformBox),t!==void 0&&(C.x=t),n!==void 0&&(C.y=n),r!==void 0&&(C.scale=r),a!==void 0&&kTe(C,a,l,h,!1)}const yne=()=>({..._6(),attrs:{}}),vne=e=>typeof e=="string"&&e.toLowerCase()==="svg";function ITe(e,t,n,r){const a=L.useMemo(()=>{const l=yne();return gne(l,t,vne(r),e.transformTemplate,e.style),{...l.attrs,style:{...l.style}}},[t]);if(e.style){const l={};mne(l,e.style,e),a.style={...l,...a.style}}return a}const NTe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function x6(e){return typeof e!="string"||e.includes("-")?!1:!!(NTe.indexOf(e)>-1||/[A-Z]/u.test(e))}function MTe(e,t,n,{latestValues:r},a,l=!1){const i=(x6(e)?ITe:CTe)(t,r,a,e),y=yTe(t,typeof e=="string",l),x=e!==L.Fragment?{...y,...i,ref:n}:{},{children:w}=t,C=L.useMemo(()=>Au(w)?w.get():w,[w]);return L.createElement(e,{...x,children:C})}function Mq(e){const t=[{},{}];return e==null||e.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function b6(e,t,n,r){if(typeof t=="function"){const[a,l]=Mq(r);t=t(n!==void 0?n:e.custom,a,l)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[a,l]=Mq(r);t=t(n!==void 0?n:e.custom,a,l)}return t}function QE(e){return Au(e)?e.get():e}function LTe({scrapeMotionValuesFromProps:e,createRenderState:t},n,r,a){return{latestValues:DTe(n,r,a,e),renderState:t()}}function DTe(e,t,n,r){const a={},l=r(e,{});for(const P in l)a[P]=QE(l[P]);let{initial:h,animate:i}=e;const y=X3(e),x=fne(e);t&&x&&!y&&e.inherit!==!1&&(h===void 0&&(h=t.initial),i===void 0&&(i=t.animate));let w=n?n.initial===!1:!1;w=w||h===!1;const C=w?i:h;if(C&&typeof C!="boolean"&&!Y3(C)){const P=Array.isArray(C)?C:[C];for(let E=0;E<P.length;E++){const j=b6(e,P[E]);if(j){const{transitionEnd:D,transition:B,...F}=j;for(const $ in F){let H=F[$];if(Array.isArray(H)){const J=w?H.length-1:0;H=H[J]}H!==null&&(a[$]=H)}for(const $ in D)a[$]=D[$]}}}return a}const _ne=e=>(t,n)=>{const r=L.useContext(K3),a=L.useContext(Z3),l=()=>LTe(e,t,r,a);return n?l():WF(l)};function w6(e,t,n){var l;const{style:r}=e,a={};for(const h in r)(Au(r[h])||t.style&&Au(t.style[h])||pne(h,e)||((l=n==null?void 0:n.getValue(h))==null?void 0:l.liveStyle)!==void 0)&&(a[h]=r[h]);return a}const RTe=_ne({scrapeMotionValuesFromProps:w6,createRenderState:_6});function xne(e,t,n){const r=w6(e,t,n);for(const a in e)if(Au(e[a])||Au(t[a])){const l=Mw.indexOf(a)!==-1?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a;r[l]=e[a]}return r}const jTe=_ne({scrapeMotionValuesFromProps:xne,createRenderState:yne}),OTe=Symbol.for("motionComponentSymbol");function eb(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function FTe(e,t,n){return L.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):eb(n)&&(n.current=r))},[t])}const S6=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),zTe="framerAppearId",bne="data-"+S6(zTe),wne=L.createContext({});function BTe(e,t,n,r,a){var D,B;const{visualElement:l}=L.useContext(K3),h=L.useContext(dne),i=L.useContext(Z3),y=L.useContext(m6).reducedMotion,x=L.useRef(null);r=r||h.renderer,!x.current&&r&&(x.current=r(e,{visualState:t,parent:l,props:n,presenceContext:i,blockInitialAnimation:i?i.initial===!1:!1,reducedMotionConfig:y}));const w=x.current,C=L.useContext(wne);w&&!w.projection&&a&&(w.type==="html"||w.type==="svg")&&UTe(x.current,n,a,C);const P=L.useRef(!1);L.useInsertionEffect(()=>{w&&P.current&&w.update(n,i)});const E=n[bne],j=L.useRef(!!E&&!((D=window.MotionHandoffIsComplete)!=null&&D.call(window,E))&&((B=window.MotionHasOptimisedAnimation)==null?void 0:B.call(window,E)));return vte(()=>{w&&(P.current=!0,window.MotionIsMounted=!0,w.updateFeatures(),w.scheduleRenderMicrotask(),j.current&&w.animationState&&w.animationState.animateChanges())}),L.useEffect(()=>{w&&(!j.current&&w.animationState&&w.animationState.animateChanges(),j.current&&(queueMicrotask(()=>{var F;(F=window.MotionHandoffMarkAsComplete)==null||F.call(window,E)}),j.current=!1),w.enteringChildren=void 0)}),w}function UTe(e,t,n,r){const{layoutId:a,layout:l,drag:h,dragConstraints:i,layoutScroll:y,layoutRoot:x,layoutCrossfade:w}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:Sne(e.parent)),e.projection.setOptions({layoutId:a,layout:l,alwaysMeasureLayout:!!h||i&&eb(i),visualElement:e,animationType:typeof l=="string"?l:"both",initialPromotionConfig:r,crossfade:w,layoutScroll:y,layoutRoot:x})}function Sne(e){if(e)return e.options.allowProjection!==!1?e.projection:Sne(e.parent)}function ML(e,{forwardMotionProps:t=!1}={},n,r){n&&pTe(n);const a=x6(e)?jTe:RTe;function l(i,y){let x;const w={...L.useContext(m6),...i,layoutId:VTe(i)},{isStatic:C}=w,P=_Te(i),E=a(i,C);if(!C&&ZF){$Te();const j=qTe(w);x=j.MeasureLayout,P.visualElement=BTe(e,E,w,r,j.ProjectionNode)}return v.jsxs(K3.Provider,{value:P,children:[x&&P.visualElement?v.jsx(x,{visualElement:P.visualElement,...w}):null,MTe(e,i,FTe(E,P.visualElement,y),E,C,t)]})}l.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const h=L.forwardRef(l);return h[OTe]=e,h}function VTe({layoutId:e}){const t=L.useContext(HF).id;return t&&e!==void 0?t+"-"+e:e}function $Te(e,t){L.useContext(dne).strict}function qTe(e){const{drag:t,layout:n}=tw;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function GTe(e,t){if(typeof Proxy>"u")return ML;const n=new Map,r=(l,h)=>ML(l,h,e,t),a=(l,h)=>r(l,h);return new Proxy(a,{get:(l,h)=>h==="create"?r:(n.has(h)||n.set(h,ML(h,void 0,e,t)),n.get(h))})}function Ane({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function HTe({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function WTe(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function LL(e){return e===void 0||e===1}function jR({scale:e,scaleX:t,scaleY:n}){return!LL(e)||!LL(t)||!LL(n)}function __(e){return jR(e)||Tne(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function Tne(e){return Lq(e.x)||Lq(e.y)}function Lq(e){return e&&e!=="0%"}function rk(e,t,n){const r=e-n,a=t*r;return n+a}function Dq(e,t,n,r,a){return a!==void 0&&(e=rk(e,a,r)),rk(e,n,r)+t}function OR(e,t=0,n=1,r,a){e.min=Dq(e.min,t,n,r,a),e.max=Dq(e.max,t,n,r,a)}function Cne(e,{x:t,y:n}){OR(e.x,t.translate,t.scale,t.originPoint),OR(e.y,n.translate,n.scale,n.originPoint)}const Rq=.999999999999,jq=1.0000000000001;function ZTe(e,t,n,r=!1){const a=n.length;if(!a)return;t.x=t.y=1;let l,h;for(let i=0;i<a;i++){l=n[i],h=l.projectionDelta;const{visualElement:y}=l.options;y&&y.props.style&&y.props.style.display==="contents"||(r&&l.options.layoutScroll&&l.scroll&&l!==l.root&&nb(e,{x:-l.scroll.offset.x,y:-l.scroll.offset.y}),h&&(t.x*=h.x.scale,t.y*=h.y.scale,Cne(e,h)),r&&__(l.latestValues)&&nb(e,l.latestValues))}t.x<jq&&t.x>Rq&&(t.x=1),t.y<jq&&t.y>Rq&&(t.y=1)}function tb(e,t){e.min=e.min+t,e.max=e.max+t}function Oq(e,t,n,r,a=.5){const l=Zo(e.min,e.max,a);OR(e,t,n,l,r)}function nb(e,t){Oq(e.x,t.x,t.scaleX,t.scale,t.originX),Oq(e.y,t.y,t.scaleY,t.scale,t.originY)}function Ene(e,t){return Ane(WTe(e.getBoundingClientRect(),t))}function KTe(e,t,n){const r=Ene(e,n),{scroll:a}=t;return a&&(tb(r.x,a.offset.x),tb(r.y,a.offset.y)),r}const Fq=()=>({translate:0,scale:1,origin:0,originPoint:0}),rb=()=>({x:Fq(),y:Fq()}),zq=()=>({min:0,max:0}),yl=()=>({x:zq(),y:zq()}),FR={current:null},Pne={current:!1};function YTe(){if(Pne.current=!0,!!ZF)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>FR.current=e.matches;e.addEventListener("change",t),t()}else FR.current=!1}const XTe=new WeakMap;function JTe(e,t,n){for(const r in t){const a=t[r],l=n[r];if(Au(a))e.addValue(r,a);else if(Au(l))e.addValue(r,ew(a,{owner:e}));else if(l!==a)if(e.hasValue(r)){const h=e.getValue(r);h.liveStyle===!0?h.jump(a):h.hasAnimated||h.set(a)}else{const h=e.getStaticValue(r);e.addValue(r,ew(h!==void 0?h:a,{owner:e}))}}for(const r in n)t[r]===void 0&&e.removeValue(r);return t}const Bq=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class QTe{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:a,blockInitialAnimation:l,visualState:h},i={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=u6,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const P=Ud.now();this.renderScheduledAt<P&&(this.renderScheduledAt=P,zo.render(this.render,!1,!0))};const{latestValues:y,renderState:x}=h;this.latestValues=y,this.baseTarget={...y},this.initialValues=n.initial?{...y}:{},this.renderState=x,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=i,this.blockInitialAnimation=!!l,this.isControllingVariants=X3(n),this.isVariantNode=fne(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:w,...C}=this.scrapeMotionValuesFromProps(n,{},this);for(const P in C){const E=C[P];y[P]!==void 0&&Au(E)&&E.set(y[P])}}mount(t){var n;this.current=t,XTe.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,a)=>this.bindToMotionValue(a,r)),Pne.current||YTe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:FR.current,(n=this.parent)==null||n.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var t;this.projection&&this.projection.unmount(),hv(this.notifyUpdate),hv(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const r=this.features[n];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=Lw.has(t);r&&this.onBindTransform&&this.onBindTransform();const a=n.on("change",h=>{this.latestValues[t]=h,this.props.onUpdate&&zo.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let l;window.MotionCheckAppearSync&&(l=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{a(),l&&l(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in tw){const n=tw[t];if(!n)continue;const{isEnabled:r,Feature:a}=n;if(!this.features[t]&&a&&r(this.props)&&(this.features[t]=new a(this)),this.features[t]){const l=this.features[t];l.isMounted?l.update():(l.mount(),l.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):yl()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<Bq.length;r++){const a=Bq[r];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const l="on"+a,h=t[l];h&&(this.propEventSubscriptions[a]=this.on(a,h))}this.prevMotionValues=JTe(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=ew(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(_te(r)||bte(r))?r=parseFloat(r):!oTe(r)&&fv.test(n)&&(r=nne(t,n)),this.setBaseTarget(t,Au(r)?r.get():r)),Au(r)?r.get():r}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var l;const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const h=b6(this.props,n,(l=this.presenceContext)==null?void 0:l.custom);h&&(r=h[t])}if(n&&r!==void 0)return r;const a=this.getBaseTargetFromProps(this.props,t);return a!==void 0&&!Au(a)?a:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new JF),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}scheduleRenderMicrotask(){f6.render(this.render)}}class kne extends QTe{constructor(){super(...arguments),this.KeyframeResolver=K5e}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Au(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function Ine(e,{style:t,vars:n},r,a){const l=e.style;let h;for(h in t)l[h]=t[h];a==null||a.applyProjectionStyles(l,r);for(h in n)l.setProperty(h,n[h])}function eCe(e){return window.getComputedStyle(e)}class tCe extends kne{constructor(){super(...arguments),this.type="html",this.renderInstance=Ine}readValueFromInstance(t,n){var r;if(Lw.has(n))return(r=this.projection)!=null&&r.isProjecting?kR(n):p5e(t,n);{const a=eCe(t),l=(t6(n)?a.getPropertyValue(n):a[n])||0;return typeof l=="string"?l.trim():l}}measureInstanceViewportBox(t,{transformPagePoint:n}){return Ene(t,n)}build(t,n,r){v6(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return w6(t,n,r)}}const Nne=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function nCe(e,t,n,r){Ine(e,t,void 0,r);for(const a in t.attrs)e.setAttribute(Nne.has(a)?a:S6(a),t.attrs[a])}class rCe extends kne{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=yl}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(Lw.has(n)){const r=tne(n);return r&&r.default||0}return n=Nne.has(n)?n:S6(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return xne(t,n,r)}build(t,n,r){gne(t,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,n,r,a){nCe(t,n,r,a)}mount(t){this.isSVGTag=vne(t.tagName),super.mount(t)}}const iCe=(e,t)=>x6(e)?new rCe(t):new tCe(t,{allowProjection:e!==L.Fragment});function _b(e,t,n){const r=e.getProps();return b6(r,t,n!==void 0?n:r.custom,e)}const zR=e=>Array.isArray(e);function sCe(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,ew(n))}function aCe(e){return zR(e)?e[e.length-1]||0:e}function oCe(e,t){const n=_b(e,t);let{transitionEnd:r={},transition:a={},...l}=n||{};l={...l,...r};for(const h in l){const i=aCe(l[h]);sCe(e,h,i)}}function lCe(e){return!!(Au(e)&&e.add)}function BR(e,t){const n=e.getValue("willChange");if(lCe(n))return n.add(t);if(!n&&ly.WillChange){const r=new ly.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function Mne(e){return e.props[bne]}const cCe=e=>e!==null;function uCe(e,{repeat:t,repeatType:n="loop"},r){const a=e.filter(cCe),l=t&&n!=="loop"&&t%2===1?0:a.length-1;return!l||r===void 0?a[l]:r}const dCe={type:"spring",stiffness:500,damping:25,restSpeed:10},hCe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),fCe={type:"keyframes",duration:.8},pCe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},mCe=(e,{keyframes:t})=>t.length>2?fCe:Lw.has(e)?e.startsWith("scale")?hCe(t[1]):dCe:pCe;function gCe({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:a,repeat:l,repeatType:h,repeatDelay:i,from:y,elapsed:x,...w}){return!!Object.keys(w).length}const A6=(e,t,n,r={},a,l)=>h=>{const i=d6(r,e)||{},y=i.delay||r.delay||0;let{elapsed:x=0}=r;x=x-Om(y);const w={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...i,delay:-x,onUpdate:P=>{t.set(P),i.onUpdate&&i.onUpdate(P)},onComplete:()=>{h(),i.onComplete&&i.onComplete()},name:e,motionValue:t,element:l?void 0:a};gCe(i)||Object.assign(w,mCe(e,w)),w.duration&&(w.duration=Om(w.duration)),w.repeatDelay&&(w.repeatDelay=Om(w.repeatDelay)),w.from!==void 0&&(w.keyframes[0]=w.from);let C=!1;if((w.type===!1||w.duration===0&&!w.repeatDelay)&&(DR(w),w.delay===0&&(C=!0)),(ly.instantAnimations||ly.skipAnimations)&&(C=!0,DR(w),w.delay=0),w.allowFlatten=!i.type&&!i.ease,C&&!l&&t.get()!==void 0){const P=uCe(w.keyframes,i);if(P!==void 0){zo.update(()=>{w.onUpdate(P),w.onComplete()});return}}return i.isSync?new c6(w):new O5e(w)};function yCe({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function Lne(e,t,{delay:n=0,transitionOverride:r,type:a}={}){let{transition:l=e.getDefaultTransition(),transitionEnd:h,...i}=t;r&&(l=r);const y=[],x=a&&e.animationState&&e.animationState.getState()[a];for(const w in i){const C=e.getValue(w,e.latestValues[w]??null),P=i[w];if(P===void 0||x&&yCe(x,w))continue;const E={delay:n,...d6(l||{},w)},j=C.get();if(j!==void 0&&!C.isAnimating&&!Array.isArray(P)&&P===j&&!E.velocity)continue;let D=!1;if(window.MotionHandoffAnimation){const F=Mne(e);if(F){const $=window.MotionHandoffAnimation(F,w,zo);$!==null&&(E.startTime=$,D=!0)}}BR(e,w),C.start(A6(w,C,P,e.shouldReduceMotion&&Jte.has(w)?{type:!1}:E,e,D));const B=C.animation;B&&y.push(B)}return h&&Promise.all(y).then(()=>{zo.update(()=>{h&&oCe(e,h)})}),y}function Dne(e,t,n,r=0,a=1){const l=Array.from(e).sort((x,w)=>x.sortNodePosition(w)).indexOf(t),h=e.size,i=(h-1)*r;return typeof n=="function"?n(l,h):a===1?l*r:i-l*r}function UR(e,t,n={}){var y;const r=_b(e,t,n.type==="exit"?(y=e.presenceContext)==null?void 0:y.custom:void 0);let{transition:a=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(a=n.transitionOverride);const l=r?()=>Promise.all(Lne(e,r,n)):()=>Promise.resolve(),h=e.variantChildren&&e.variantChildren.size?(x=0)=>{const{delayChildren:w=0,staggerChildren:C,staggerDirection:P}=a;return vCe(e,t,x,w,C,P,n)}:()=>Promise.resolve(),{when:i}=a;if(i){const[x,w]=i==="beforeChildren"?[l,h]:[h,l];return x().then(()=>w())}else return Promise.all([l(),h(n.delay)])}function vCe(e,t,n=0,r=0,a=0,l=1,h){const i=[];for(const y of e.variantChildren)y.notify("AnimationStart",t),i.push(UR(y,t,{...h,delay:n+(typeof r=="function"?0:r)+Dne(e.variantChildren,y,r,a,l)}).then(()=>y.notify("AnimationComplete",t)));return Promise.all(i)}function _Ce(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const a=t.map(l=>UR(e,l,n));r=Promise.all(a)}else if(typeof t=="string")r=UR(e,t,n);else{const a=typeof t=="function"?_b(e,t,n.custom):t;r=Promise.all(Lne(e,a,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}function Rne(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const xCe=y6.length;function jne(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?jne(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<xCe;n++){const r=y6[n],a=e.props[r];(zA(a)||a===!1)&&(t[r]=a)}return t}const bCe=[...g6].reverse(),wCe=g6.length;function SCe(e){return t=>Promise.all(t.map(({animation:n,options:r})=>_Ce(e,n,r)))}function ACe(e){let t=SCe(e),n=Uq(),r=!0;const a=y=>(x,w)=>{var P;const C=_b(e,w,y==="exit"?(P=e.presenceContext)==null?void 0:P.custom:void 0);if(C){const{transition:E,transitionEnd:j,...D}=C;x={...x,...D,...j}}return x};function l(y){t=y(e)}function h(y){const{props:x}=e,w=jne(e.parent)||{},C=[],P=new Set;let E={},j=1/0;for(let B=0;B<wCe;B++){const F=bCe[B],$=n[F],H=x[F]!==void 0?x[F]:w[F],J=zA(H),ee=F===y?$.isActive:null;ee===!1&&(j=B);let Q=H===w[F]&&H!==x[F]&&J;if(Q&&r&&e.manuallyAnimateOnMount&&(Q=!1),$.protectedKeys={...E},!$.isActive&&ee===null||!H&&!$.prevProp||Y3(H)||typeof H=="boolean")continue;const ne=TCe($.prevProp,H);let pe=ne||F===y&&$.isActive&&!Q&&J||B>j&&J,he=!1;const we=Array.isArray(H)?H:[H];let fe=we.reduce(a(F),{});ee===!1&&(fe={});const{prevResolvedValues:ge={}}=$,Ce={...ge,...fe},xe=et=>{pe=!0,P.has(et)&&(he=!0,P.delete(et)),$.needsAnimating[et]=!0;const je=e.getValue(et);je&&(je.liveStyle=!1)};for(const et in Ce){const je=fe[et],De=ge[et];if(E.hasOwnProperty(et))continue;let Ct=!1;zR(je)&&zR(De)?Ct=!Rne(je,De):Ct=je!==De,Ct?je!=null?xe(et):P.add(et):je!==void 0&&P.has(et)?xe(et):$.protectedKeys[et]=!0}$.prevProp=H,$.prevResolvedValues=fe,$.isActive&&(E={...E,...fe}),r&&e.blockInitialAnimation&&(pe=!1);const Re=Q&&ne;pe&&(!Re||he)&&C.push(...we.map(et=>{const je={type:F};if(typeof et=="string"&&r&&!Re&&e.manuallyAnimateOnMount&&e.parent){const{parent:De}=e,Ct=_b(De,et);if(De.enteringChildren&&Ct){const{delayChildren:xt}=Ct.transition||{};je.delay=Dne(De.enteringChildren,e,xt)}}return{animation:et,options:je}}))}if(P.size){const B={};if(typeof x.initial!="boolean"){const F=_b(e,Array.isArray(x.initial)?x.initial[0]:x.initial);F&&F.transition&&(B.transition=F.transition)}P.forEach(F=>{const $=e.getBaseTarget(F),H=e.getValue(F);H&&(H.liveStyle=!0),B[F]=$??null}),C.push({animation:B})}let D=!!C.length;return r&&(x.initial===!1||x.initial===x.animate)&&!e.manuallyAnimateOnMount&&(D=!1),r=!1,D?t(C):Promise.resolve()}function i(y,x){var C;if(n[y].isActive===x)return Promise.resolve();(C=e.variantChildren)==null||C.forEach(P=>{var E;return(E=P.animationState)==null?void 0:E.setActive(y,x)}),n[y].isActive=x;const w=h(y);for(const P in n)n[P].protectedKeys={};return w}return{animateChanges:h,setActive:i,setAnimateFunction:l,getState:()=>n,reset:()=>{n=Uq(),r=!0}}}function TCe(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!Rne(t,e):!1}function p_(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Uq(){return{animate:p_(!0),whileInView:p_(),whileHover:p_(),whileTap:p_(),whileDrag:p_(),whileFocus:p_(),exit:p_()}}class Pv{constructor(t){this.isMounted=!1,this.node=t}update(){}}class CCe extends Pv{constructor(t){super(t),t.animationState||(t.animationState=ACe(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Y3(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let ECe=0;class PCe extends Pv{constructor(){super(...arguments),this.id=ECe++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const a=this.node.animationState.setActive("exit",!t);n&&!t&&a.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const kCe={animation:{Feature:CCe},exit:{Feature:PCe}};function UA(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}function N5(e){return{point:{x:e.pageX,y:e.pageY}}}const ICe=e=>t=>p6(t)&&e(t,N5(t));function XS(e,t,n,r){return UA(e,t,ICe(n),r)}const One=1e-4,NCe=1-One,MCe=1+One,Fne=.01,LCe=0-Fne,DCe=0+Fne;function rd(e){return e.max-e.min}function RCe(e,t,n){return Math.abs(e-t)<=n}function Vq(e,t,n,r=.5){e.origin=r,e.originPoint=Zo(t.min,t.max,e.origin),e.scale=rd(n)/rd(t),e.translate=Zo(n.min,n.max,e.origin)-e.originPoint,(e.scale>=NCe&&e.scale<=MCe||isNaN(e.scale))&&(e.scale=1),(e.translate>=LCe&&e.translate<=DCe||isNaN(e.translate))&&(e.translate=0)}function JS(e,t,n,r){Vq(e.x,t.x,n.x,r?r.originX:void 0),Vq(e.y,t.y,n.y,r?r.originY:void 0)}function $q(e,t,n){e.min=n.min+t.min,e.max=e.min+rd(t)}function jCe(e,t,n){$q(e.x,t.x,n.x),$q(e.y,t.y,n.y)}function qq(e,t,n){e.min=t.min-n.min,e.max=e.min+rd(t)}function QS(e,t,n){qq(e.x,t.x,n.x),qq(e.y,t.y,n.y)}function af(e){return[e("x"),e("y")]}const zne=({current:e})=>e?e.ownerDocument.defaultView:null,Gq=(e,t)=>Math.abs(e-t);function OCe(e,t){const n=Gq(e.x,t.x),r=Gq(e.y,t.y);return Math.sqrt(n**2+r**2)}class Bne{constructor(t,n,{transformPagePoint:r,contextWindow:a=window,dragSnapToOrigin:l=!1,distanceThreshold:h=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const P=RL(this.lastMoveEventInfo,this.history),E=this.startEvent!==null,j=OCe(P.offset,{x:0,y:0})>=this.distanceThreshold;if(!E&&!j)return;const{point:D}=P,{timestamp:B}=qc;this.history.push({...D,timestamp:B});const{onStart:F,onMove:$}=this.handlers;E||(F&&F(this.lastMoveEvent,P),this.startEvent=this.lastMoveEvent),$&&$(this.lastMoveEvent,P)},this.handlePointerMove=(P,E)=>{this.lastMoveEvent=P,this.lastMoveEventInfo=DL(E,this.transformPagePoint),zo.update(this.updatePoint,!0)},this.handlePointerUp=(P,E)=>{this.end();const{onEnd:j,onSessionEnd:D,resumeAnimation:B}=this.handlers;if(this.dragSnapToOrigin&&B&&B(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const F=RL(P.type==="pointercancel"?this.lastMoveEventInfo:DL(E,this.transformPagePoint),this.history);this.startEvent&&j&&j(P,F),D&&D(P,F)},!p6(t))return;this.dragSnapToOrigin=l,this.handlers=n,this.transformPagePoint=r,this.distanceThreshold=h,this.contextWindow=a||window;const i=N5(t),y=DL(i,this.transformPagePoint),{point:x}=y,{timestamp:w}=qc;this.history=[{...x,timestamp:w}];const{onSessionStart:C}=n;C&&C(t,RL(y,this.history)),this.removeListeners=P5(XS(this.contextWindow,"pointermove",this.handlePointerMove),XS(this.contextWindow,"pointerup",this.handlePointerUp),XS(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),hv(this.updatePoint)}}function DL(e,t){return t?{point:t(e.point)}:e}function Hq(e,t){return{x:e.x-t.x,y:e.y-t.y}}function RL({point:e},t){return{point:e,delta:Hq(e,Une(t)),offset:Hq(e,FCe(t)),velocity:zCe(t,.1)}}function FCe(e){return e[0]}function Une(e){return e[e.length-1]}function zCe(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const a=Une(e);for(;n>=0&&(r=e[n],!(a.timestamp-r.timestamp>Om(t)));)n--;if(!r)return{x:0,y:0};const l=mf(a.timestamp-r.timestamp);if(l===0)return{x:0,y:0};const h={x:(a.x-r.x)/l,y:(a.y-r.y)/l};return h.x===1/0&&(h.x=0),h.y===1/0&&(h.y=0),h}function BCe(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?Zo(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?Zo(n,e,r.max):Math.min(e,n)),e}function Wq(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function UCe(e,{top:t,left:n,bottom:r,right:a}){return{x:Wq(e.x,n,a),y:Wq(e.y,t,r)}}function Zq(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function VCe(e,t){return{x:Zq(e.x,t.x),y:Zq(e.y,t.y)}}function $Ce(e,t){let n=.5;const r=rd(e),a=rd(t);return a>r?n=jA(t.min,t.max-r,e.min):r>a&&(n=jA(e.min,e.max-a,t.min)),oy(0,1,n)}function qCe(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const VR=.35;function GCe(e=VR){return e===!1?e=0:e===!0&&(e=VR),{x:Kq(e,"left","right"),y:Kq(e,"top","bottom")}}function Kq(e,t,n){return{min:Yq(e,t),max:Yq(e,n)}}function Yq(e,t){return typeof e=="number"?e:e[t]||0}const HCe=new WeakMap;class WCe{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=yl(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:n=!1,distanceThreshold:r}={}){const{presenceContext:a}=this.visualElement;if(a&&a.isPresent===!1)return;const l=C=>{const{dragSnapToOrigin:P}=this.getProps();P?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(N5(C).point)},h=(C,P)=>{const{drag:E,dragPropagation:j,onDragStart:D}=this.getProps();if(E&&!j&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Q5e(E),!this.openDragLock))return;this.latestPointerEvent=C,this.latestPanInfo=P,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),af(F=>{let $=this.getAxisMotionValue(F).get()||0;if(Fm.test($)){const{projection:H}=this.visualElement;if(H&&H.layout){const J=H.layout.layoutBox[F];J&&($=rd(J)*(parseFloat($)/100))}}this.originPoint[F]=$}),D&&zo.postRender(()=>D(C,P)),BR(this.visualElement,"transform");const{animationState:B}=this.visualElement;B&&B.setActive("whileDrag",!0)},i=(C,P)=>{this.latestPointerEvent=C,this.latestPanInfo=P;const{dragPropagation:E,dragDirectionLock:j,onDirectionLock:D,onDrag:B}=this.getProps();if(!E&&!this.openDragLock)return;const{offset:F}=P;if(j&&this.currentDirection===null){this.currentDirection=ZCe(F),this.currentDirection!==null&&D&&D(this.currentDirection);return}this.updateAxis("x",P.point,F),this.updateAxis("y",P.point,F),this.visualElement.render(),B&&B(C,P)},y=(C,P)=>{this.latestPointerEvent=C,this.latestPanInfo=P,this.stop(C,P),this.latestPointerEvent=null,this.latestPanInfo=null},x=()=>af(C=>{var P;return this.getAnimationState(C)==="paused"&&((P=this.getAxisMotionValue(C).animation)==null?void 0:P.play())}),{dragSnapToOrigin:w}=this.getProps();this.panSession=new Bne(t,{onSessionStart:l,onStart:h,onMove:i,onSessionEnd:y,resumeAnimation:x},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:w,distanceThreshold:r,contextWindow:zne(this.visualElement)})}stop(t,n){const r=t||this.latestPointerEvent,a=n||this.latestPanInfo,l=this.isDragging;if(this.cancel(),!l||!a||!r)return;const{velocity:h}=a;this.startAnimation(h);const{onDragEnd:i}=this.getProps();i&&zo.postRender(()=>i(r,a))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:a}=this.getProps();if(!r||!YC(t,a,this.currentDirection))return;const l=this.getAxisMotionValue(t);let h=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(h=BCe(h,this.constraints[t],this.elastic[t])),l.set(h)}resolveConstraints(){var l;const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(l=this.visualElement.projection)==null?void 0:l.layout,a=this.constraints;t&&eb(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=UCe(r.layoutBox,t):this.constraints=!1,this.elastic=GCe(n),a!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&af(h=>{this.constraints!==!1&&this.getAxisMotionValue(h)&&(this.constraints[h]=qCe(r.layoutBox[h],this.constraints[h]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!eb(t))return!1;const r=t.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const l=KTe(r,a.root,this.visualElement.getTransformPagePoint());let h=VCe(a.layout.layoutBox,l);if(n){const i=n(HTe(h));this.hasMutatedConstraints=!!i,i&&(h=Ane(i))}return h}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:a,dragTransition:l,dragSnapToOrigin:h,onDragTransitionEnd:i}=this.getProps(),y=this.constraints||{},x=af(w=>{if(!YC(w,n,this.currentDirection))return;let C=y&&y[w]||{};h&&(C={min:0,max:0});const P=a?200:1e6,E=a?40:1e7,j={type:"inertia",velocity:r?t[w]:0,bounceStiffness:P,bounceDamping:E,timeConstant:750,restDelta:1,restSpeed:10,...l,...C};return this.startAxisValueAnimation(w,j)});return Promise.all(x).then(i)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return BR(this.visualElement,t),r.start(A6(t,r,0,n,this.visualElement,!1))}stopAnimation(){af(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){af(t=>{var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),a=r[n];return a||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){af(n=>{const{drag:r}=this.getProps();if(!YC(n,r,this.currentDirection))return;const{projection:a}=this.visualElement,l=this.getAxisMotionValue(n);if(a&&a.layout){const{min:h,max:i}=a.layout.layoutBox[n];l.set(t[n]-Zo(h,i,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!eb(n)||!r||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};af(h=>{const i=this.getAxisMotionValue(h);if(i&&this.constraints!==!1){const y=i.get();a[h]=$Ce({min:y,max:y},this.constraints[h])}});const{transformTemplate:l}=this.visualElement.getProps();this.visualElement.current.style.transform=l?l({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),af(h=>{if(!YC(h,t,null))return;const i=this.getAxisMotionValue(h),{min:y,max:x}=this.constraints[h];i.set(Zo(y,x,a[h]))})}addListeners(){if(!this.visualElement.current)return;HCe.set(this.visualElement,this);const t=this.visualElement.current,n=XS(t,"pointerdown",y=>{const{drag:x,dragListener:w=!0}=this.getProps();x&&w&&this.start(y)}),r=()=>{const{dragConstraints:y}=this.getProps();eb(y)&&y.current&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,l=a.addEventListener("measure",r);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),zo.read(r);const h=UA(window,"resize",()=>this.scalePositionWithinConstraints()),i=a.addEventListener("didUpdate",({delta:y,hasLayoutChanged:x})=>{this.isDragging&&x&&(af(w=>{const C=this.getAxisMotionValue(w);C&&(this.originPoint[w]+=y[w].translate,C.set(C.get()+y[w].translate))}),this.visualElement.render())});return()=>{h(),n(),l(),i&&i()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:a=!1,dragConstraints:l=!1,dragElastic:h=VR,dragMomentum:i=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:a,dragConstraints:l,dragElastic:h,dragMomentum:i}}}function YC(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function ZCe(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class KCe extends Pv{constructor(t){super(t),this.removeGroupControls=vf,this.removeListeners=vf,this.controls=new WCe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||vf}unmount(){this.removeGroupControls(),this.removeListeners()}}const Xq=e=>(t,n)=>{e&&zo.postRender(()=>e(t,n))};class YCe extends Pv{constructor(){super(...arguments),this.removePointerDownListener=vf}onPointerDown(t){this.session=new Bne(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:zne(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:a}=this.node.getProps();return{onSessionStart:Xq(t),onStart:Xq(n),onMove:r,onEnd:(l,h)=>{delete this.session,a&&zo.postRender(()=>a(l,h))}}}mount(){this.removePointerDownListener=XS(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const eP={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Jq(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const lS={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Gi.test(e))e=parseFloat(e);else return e;const n=Jq(e,t.target.x),r=Jq(e,t.target.y);return`${n}% ${r}%`}},XCe={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,a=fv.parse(e);if(a.length>5)return r;const l=fv.createTransformer(e),h=typeof a[0]!="number"?1:0,i=n.x.scale*t.x,y=n.y.scale*t.y;a[0+h]/=i,a[1+h]/=y;const x=Zo(i,y,.5);return typeof a[2+h]=="number"&&(a[2+h]/=x),typeof a[3+h]=="number"&&(a[3+h]/=x),l(a)}};let jL=!1;class JCe extends L.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:a}=this.props,{projection:l}=t;xTe(QCe),l&&(n.group&&n.group.add(l),r&&r.register&&a&&r.register(l),jL&&l.root.didUpdate(),l.addEventListener("animationComplete",()=>{this.safeToRemove()}),l.setOptions({...l.options,onExitComplete:()=>this.safeToRemove()})),eP.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:a,isPresent:l}=this.props,{projection:h}=r;return h&&(h.isPresent=l,jL=!0,a||t.layoutDependency!==n||n===void 0||t.isPresent!==l?h.willUpdate():this.safeToRemove(),t.isPresent!==l&&(l?h.promote():h.relegate()||zo.postRender(()=>{const i=h.getStack();(!i||!i.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),f6.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:a}=t;jL=!0,a&&(a.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(a),r&&r.deregister&&r.deregister(a))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function Vne(e){const[t,n]=cne(),r=L.useContext(HF);return v.jsx(JCe,{...e,layoutGroup:r,switchLayoutGroup:L.useContext(wne),isPresent:t,safeToRemove:n})}const QCe={borderRadius:{...lS,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:lS,borderTopRightRadius:lS,borderBottomLeftRadius:lS,borderBottomRightRadius:lS,boxShadow:XCe};function eEe(e,t,n){const r=Au(e)?e:ew(e);return r.start(A6("",r,t,n)),r.animation}const tEe=(e,t)=>e.depth-t.depth;class nEe{constructor(){this.children=[],this.isDirty=!1}add(t){KF(this.children,t),this.isDirty=!0}remove(t){YF(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(tEe),this.isDirty=!1,this.children.forEach(t)}}function rEe(e,t){const n=Ud.now(),r=({timestamp:a})=>{const l=a-n;l>=t&&(hv(r),e(l-t))};return zo.setup(r,!0),()=>hv(r)}const $ne=["TopLeft","TopRight","BottomLeft","BottomRight"],iEe=$ne.length,Qq=e=>typeof e=="string"?parseFloat(e):e,eG=e=>typeof e=="number"||Gi.test(e);function sEe(e,t,n,r,a,l){a?(e.opacity=Zo(0,n.opacity??1,aEe(r)),e.opacityExit=Zo(t.opacity??1,0,oEe(r))):l&&(e.opacity=Zo(t.opacity??1,n.opacity??1,r));for(let h=0;h<iEe;h++){const i=`border${$ne[h]}Radius`;let y=tG(t,i),x=tG(n,i);if(y===void 0&&x===void 0)continue;y||(y=0),x||(x=0),y===0||x===0||eG(y)===eG(x)?(e[i]=Math.max(Zo(Qq(y),Qq(x),r),0),(Fm.test(x)||Fm.test(y))&&(e[i]+="%")):e[i]=x}(t.rotate||n.rotate)&&(e.rotate=Zo(t.rotate||0,n.rotate||0,r))}function tG(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const aEe=qne(0,.5,kte),oEe=qne(.5,.95,vf);function qne(e,t,n){return r=>r<e?0:r>t?1:n(jA(e,t,r))}function nG(e,t){e.min=t.min,e.max=t.max}function tf(e,t){nG(e.x,t.x),nG(e.y,t.y)}function rG(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function iG(e,t,n,r,a){return e-=t,e=rk(e,1/n,r),a!==void 0&&(e=rk(e,1/a,r)),e}function lEe(e,t=0,n=1,r=.5,a,l=e,h=e){if(Fm.test(t)&&(t=parseFloat(t),t=Zo(h.min,h.max,t/100)-h.min),typeof t!="number")return;let i=Zo(l.min,l.max,r);e===l&&(i-=t),e.min=iG(e.min,t,n,i,a),e.max=iG(e.max,t,n,i,a)}function sG(e,t,[n,r,a],l,h){lEe(e,t[n],t[r],t[a],t.scale,l,h)}const cEe=["x","scaleX","originX"],uEe=["y","scaleY","originY"];function aG(e,t,n,r){sG(e.x,t,cEe,n?n.x:void 0,r?r.x:void 0),sG(e.y,t,uEe,n?n.y:void 0,r?r.y:void 0)}function oG(e){return e.translate===0&&e.scale===1}function Gne(e){return oG(e.x)&&oG(e.y)}function lG(e,t){return e.min===t.min&&e.max===t.max}function dEe(e,t){return lG(e.x,t.x)&&lG(e.y,t.y)}function cG(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function Hne(e,t){return cG(e.x,t.x)&&cG(e.y,t.y)}function uG(e){return rd(e.x)/rd(e.y)}function dG(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class hEe{constructor(){this.members=[]}add(t){KF(this.members,t),t.scheduleRender()}remove(t){if(YF(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(a=>t===a);if(n===0)return!1;let r;for(let a=n;a>=0;a--){const l=this.members[a];if(l.isPresent!==!1){r=l;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:a}=t.options;a===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function fEe(e,t,n){let r="";const a=e.x.translate/t.x,l=e.y.translate/t.y,h=(n==null?void 0:n.z)||0;if((a||l||h)&&(r=`translate3d(${a}px, ${l}px, ${h}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:x,rotate:w,rotateX:C,rotateY:P,skewX:E,skewY:j}=n;x&&(r=`perspective(${x}px) ${r}`),w&&(r+=`rotate(${w}deg) `),C&&(r+=`rotateX(${C}deg) `),P&&(r+=`rotateY(${P}deg) `),E&&(r+=`skewX(${E}deg) `),j&&(r+=`skewY(${j}deg) `)}const i=e.x.scale*t.x,y=e.y.scale*t.y;return(i!==1||y!==1)&&(r+=`scale(${i}, ${y})`),r||"none"}const OL=["","X","Y","Z"],pEe=1e3;let mEe=0;function FL(e,t,n,r){const{latestValues:a}=t;a[e]&&(n[e]=a[e],t.setStaticValue(e,0),r&&(r[e]=0))}function Wne(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=Mne(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:a,layoutId:l}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",zo,!(a||l))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&Wne(r)}function Zne({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:a}){return class{constructor(h={},i=t==null?void 0:t()){this.id=mEe++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(vEe),this.nodes.forEach(wEe),this.nodes.forEach(SEe),this.nodes.forEach(_Ee)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=h,this.root=i?i.root||i:this,this.path=i?[...i.path,i]:[],this.parent=i,this.depth=i?i.depth+1:0;for(let y=0;y<this.path.length;y++)this.path[y].shouldResetTransform=!0;this.root===this&&(this.nodes=new nEe)}addEventListener(h,i){return this.eventHandlers.has(h)||this.eventHandlers.set(h,new JF),this.eventHandlers.get(h).add(i)}notifyListeners(h,...i){const y=this.eventHandlers.get(h);y&&y.notify(...i)}hasListeners(h){return this.eventHandlers.has(h)}mount(h){if(this.instance)return;this.isSVG=lne(h)&&!sTe(h),this.instance=h;const{layoutId:i,layout:y,visualElement:x}=this.options;if(x&&!x.current&&x.mount(h),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(y||i)&&(this.isLayoutDirty=!0),e){let w,C=0;const P=()=>this.root.updateBlockedByResize=!1;zo.read(()=>{C=window.innerWidth}),e(h,()=>{const E=window.innerWidth;E!==C&&(C=E,this.root.updateBlockedByResize=!0,w&&w(),w=rEe(P,250),eP.hasAnimatedSinceResize&&(eP.hasAnimatedSinceResize=!1,this.nodes.forEach(pG)))})}i&&this.root.registerSharedNode(i,this),this.options.animate!==!1&&x&&(i||y)&&this.addEventListener("didUpdate",({delta:w,hasLayoutChanged:C,hasRelativeLayoutChanged:P,layout:E})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const j=this.options.transition||x.getDefaultTransition()||PEe,{onLayoutAnimationStart:D,onLayoutAnimationComplete:B}=x.getProps(),F=!this.targetLayout||!Hne(this.targetLayout,E),$=!C&&P;if(this.options.layoutRoot||this.resumeFrom||$||C&&(F||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const H={...d6(j,"layout"),onPlay:D,onComplete:B};(x.shouldReduceMotion||this.options.layoutRoot)&&(H.delay=0,H.type=!1),this.startAnimation(H),this.setAnimationOrigin(w,$)}else C||pG(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=E})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const h=this.getStack();h&&h.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),hv(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(AEe),this.animationId++)}getTransformTemplate(){const{visualElement:h}=this.options;return h&&h.getProps().transformTemplate}willUpdate(h=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Wne(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let w=0;w<this.path.length;w++){const C=this.path[w];C.shouldResetTransform=!0,C.updateScroll("snapshot"),C.options.layoutRoot&&C.willUpdate(!1)}const{layoutId:i,layout:y}=this.options;if(i===void 0&&!y)return;const x=this.getTransformTemplate();this.prevTransformTemplateValue=x?x(this.latestValues,""):void 0,this.updateSnapshot(),h&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(hG);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(fG);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(bEe),this.nodes.forEach(gEe),this.nodes.forEach(yEe)):this.nodes.forEach(fG),this.clearAllSnapshots();const i=Ud.now();qc.delta=oy(0,1e3/60,i-qc.timestamp),qc.timestamp=i,qc.isProcessing=!0,CL.update.process(qc),CL.preRender.process(qc),CL.render.process(qc),qc.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,f6.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(xEe),this.sharedNodes.forEach(TEe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,zo.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){zo.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!rd(this.snapshot.measuredBox.x)&&!rd(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let y=0;y<this.path.length;y++)this.path[y].updateScroll();const h=this.layout;this.layout=this.measure(!1),this.layoutCorrected=yl(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:i}=this.options;i&&i.notify("LayoutMeasure",this.layout.layoutBox,h?h.layoutBox:void 0)}updateScroll(h="measure"){let i=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===h&&(i=!1),i&&this.instance){const y=r(this.instance);this.scroll={animationId:this.root.animationId,phase:h,isRoot:y,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:y}}}resetTransform(){if(!a)return;const h=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,i=this.projectionDelta&&!Gne(this.projectionDelta),y=this.getTransformTemplate(),x=y?y(this.latestValues,""):void 0,w=x!==this.prevTransformTemplateValue;h&&this.instance&&(i||__(this.latestValues)||w)&&(a(this.instance,x),this.shouldResetTransform=!1,this.scheduleRender())}measure(h=!0){const i=this.measurePageBox();let y=this.removeElementScroll(i);return h&&(y=this.removeTransform(y)),kEe(y),{animationId:this.root.animationId,measuredBox:i,layoutBox:y,latestValues:{},source:this.id}}measurePageBox(){var x;const{visualElement:h}=this.options;if(!h)return yl();const i=h.measureViewportBox();if(!(((x=this.scroll)==null?void 0:x.wasRoot)||this.path.some(IEe))){const{scroll:w}=this.root;w&&(tb(i.x,w.offset.x),tb(i.y,w.offset.y))}return i}removeElementScroll(h){var y;const i=yl();if(tf(i,h),(y=this.scroll)!=null&&y.wasRoot)return i;for(let x=0;x<this.path.length;x++){const w=this.path[x],{scroll:C,options:P}=w;w!==this.root&&C&&P.layoutScroll&&(C.wasRoot&&tf(i,h),tb(i.x,C.offset.x),tb(i.y,C.offset.y))}return i}applyTransform(h,i=!1){const y=yl();tf(y,h);for(let x=0;x<this.path.length;x++){const w=this.path[x];!i&&w.options.layoutScroll&&w.scroll&&w!==w.root&&nb(y,{x:-w.scroll.offset.x,y:-w.scroll.offset.y}),__(w.latestValues)&&nb(y,w.latestValues)}return __(this.latestValues)&&nb(y,this.latestValues),y}removeTransform(h){const i=yl();tf(i,h);for(let y=0;y<this.path.length;y++){const x=this.path[y];if(!x.instance||!__(x.latestValues))continue;jR(x.latestValues)&&x.updateSnapshot();const w=yl(),C=x.measurePageBox();tf(w,C),aG(i,x.latestValues,x.snapshot?x.snapshot.layoutBox:void 0,w)}return __(this.latestValues)&&aG(i,this.latestValues),i}setTargetDelta(h){this.targetDelta=h,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(h){this.options={...this.options,...h,crossfade:h.crossfade!==void 0?h.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==qc.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(h=!1){var P;const i=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=i.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=i.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=i.isSharedProjectionDirty);const y=!!this.resumingFrom||this!==i;if(!(h||y&&this.isSharedProjectionDirty||this.isProjectionDirty||(P=this.parent)!=null&&P.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:w,layoutId:C}=this.options;if(!(!this.layout||!(w||C))){if(this.resolvedRelativeTargetAt=qc.timestamp,!this.targetDelta&&!this.relativeTarget){const E=this.getClosestProjectingParent();E&&E.layout&&this.animationProgress!==1?(this.relativeParent=E,this.forceRelativeParentToResolveTarget(),this.relativeTarget=yl(),this.relativeTargetOrigin=yl(),QS(this.relativeTargetOrigin,this.layout.layoutBox,E.layout.layoutBox),tf(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=yl(),this.targetWithTransforms=yl()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),jCe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):tf(this.target,this.layout.layoutBox),Cne(this.target,this.targetDelta)):tf(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const E=this.getClosestProjectingParent();E&&!!E.resumingFrom==!!this.resumingFrom&&!E.options.layoutScroll&&E.target&&this.animationProgress!==1?(this.relativeParent=E,this.forceRelativeParentToResolveTarget(),this.relativeTarget=yl(),this.relativeTargetOrigin=yl(),QS(this.relativeTargetOrigin,this.target,E.target),tf(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||jR(this.parent.latestValues)||Tne(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var j;const h=this.getLead(),i=!!this.resumingFrom||this!==h;let y=!0;if((this.isProjectionDirty||(j=this.parent)!=null&&j.isProjectionDirty)&&(y=!1),i&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(y=!1),this.resolvedRelativeTargetAt===qc.timestamp&&(y=!1),y)return;const{layout:x,layoutId:w}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(x||w))return;tf(this.layoutCorrected,this.layout.layoutBox);const C=this.treeScale.x,P=this.treeScale.y;ZTe(this.layoutCorrected,this.treeScale,this.path,i),h.layout&&!h.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(h.target=h.layout.layoutBox,h.targetWithTransforms=yl());const{target:E}=h;if(!E){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(rG(this.prevProjectionDelta.x,this.projectionDelta.x),rG(this.prevProjectionDelta.y,this.projectionDelta.y)),JS(this.projectionDelta,this.layoutCorrected,E,this.latestValues),(this.treeScale.x!==C||this.treeScale.y!==P||!dG(this.projectionDelta.x,this.prevProjectionDelta.x)||!dG(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",E))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(h=!0){var i;if((i=this.options.visualElement)==null||i.scheduleRender(),h){const y=this.getStack();y&&y.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=rb(),this.projectionDelta=rb(),this.projectionDeltaWithTransform=rb()}setAnimationOrigin(h,i=!1){const y=this.snapshot,x=y?y.latestValues:{},w={...this.latestValues},C=rb();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!i;const P=yl(),E=y?y.source:void 0,j=this.layout?this.layout.source:void 0,D=E!==j,B=this.getStack(),F=!B||B.members.length<=1,$=!!(D&&!F&&this.options.crossfade===!0&&!this.path.some(EEe));this.animationProgress=0;let H;this.mixTargetDelta=J=>{const ee=J/1e3;mG(C.x,h.x,ee),mG(C.y,h.y,ee),this.setTargetDelta(C),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(QS(P,this.layout.layoutBox,this.relativeParent.layout.layoutBox),CEe(this.relativeTarget,this.relativeTargetOrigin,P,ee),H&&dEe(this.relativeTarget,H)&&(this.isProjectionDirty=!1),H||(H=yl()),tf(H,this.relativeTarget)),D&&(this.animationValues=w,sEe(w,x,this.latestValues,ee,$,F)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=ee},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(h){var i,y,x;this.notifyListeners("animationStart"),(i=this.currentAnimation)==null||i.stop(),(x=(y=this.resumingFrom)==null?void 0:y.currentAnimation)==null||x.stop(),this.pendingAnimation&&(hv(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=zo.update(()=>{eP.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=ew(0)),this.currentAnimation=eEe(this.motionValue,[0,1e3],{...h,velocity:0,isSync:!0,onUpdate:w=>{this.mixTargetDelta(w),h.onUpdate&&h.onUpdate(w)},onStop:()=>{},onComplete:()=>{h.onComplete&&h.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const h=this.getStack();h&&h.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(pEe),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const h=this.getLead();let{targetWithTransforms:i,target:y,layout:x,latestValues:w}=h;if(!(!i||!y||!x)){if(this!==h&&this.layout&&x&&Kne(this.options.animationType,this.layout.layoutBox,x.layoutBox)){y=this.target||yl();const C=rd(this.layout.layoutBox.x);y.x.min=h.target.x.min,y.x.max=y.x.min+C;const P=rd(this.layout.layoutBox.y);y.y.min=h.target.y.min,y.y.max=y.y.min+P}tf(i,y),nb(i,w),JS(this.projectionDeltaWithTransform,this.layoutCorrected,i,w)}}registerSharedNode(h,i){this.sharedNodes.has(h)||this.sharedNodes.set(h,new hEe),this.sharedNodes.get(h).add(i);const x=i.options.initialPromotionConfig;i.promote({transition:x?x.transition:void 0,preserveFollowOpacity:x&&x.shouldPreserveFollowOpacity?x.shouldPreserveFollowOpacity(i):void 0})}isLead(){const h=this.getStack();return h?h.lead===this:!0}getLead(){var i;const{layoutId:h}=this.options;return h?((i=this.getStack())==null?void 0:i.lead)||this:this}getPrevLead(){var i;const{layoutId:h}=this.options;return h?(i=this.getStack())==null?void 0:i.prevLead:void 0}getStack(){const{layoutId:h}=this.options;if(h)return this.root.sharedNodes.get(h)}promote({needsReset:h,transition:i,preserveFollowOpacity:y}={}){const x=this.getStack();x&&x.promote(this,y),h&&(this.projectionDelta=void 0,this.needsReset=!0),i&&this.setOptions({transition:i})}relegate(){const h=this.getStack();return h?h.relegate(this):!1}resetSkewAndRotation(){const{visualElement:h}=this.options;if(!h)return;let i=!1;const{latestValues:y}=h;if((y.z||y.rotate||y.rotateX||y.rotateY||y.rotateZ||y.skewX||y.skewY)&&(i=!0),!i)return;const x={};y.z&&FL("z",h,x,this.animationValues);for(let w=0;w<OL.length;w++)FL(`rotate${OL[w]}`,h,x,this.animationValues),FL(`skew${OL[w]}`,h,x,this.animationValues);h.render();for(const w in x)h.setStaticValue(w,x[w]),this.animationValues&&(this.animationValues[w]=x[w]);h.scheduleRender()}applyProjectionStyles(h,i){if(!this.instance||this.isSVG)return;if(!this.isVisible){h.visibility="hidden";return}const y=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,h.visibility="",h.opacity="",h.pointerEvents=QE(i==null?void 0:i.pointerEvents)||"",h.transform=y?y(this.latestValues,""):"none";return}const x=this.getLead();if(!this.projectionDelta||!this.layout||!x.target){this.options.layoutId&&(h.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,h.pointerEvents=QE(i==null?void 0:i.pointerEvents)||""),this.hasProjected&&!__(this.latestValues)&&(h.transform=y?y({},""):"none",this.hasProjected=!1);return}h.visibility="";const w=x.animationValues||x.latestValues;this.applyTransformsToTarget();let C=fEe(this.projectionDeltaWithTransform,this.treeScale,w);y&&(C=y(w,C)),h.transform=C;const{x:P,y:E}=this.projectionDelta;h.transformOrigin=`${P.origin*100}% ${E.origin*100}% 0`,x.animationValues?h.opacity=x===this?w.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:w.opacityExit:h.opacity=x===this?w.opacity!==void 0?w.opacity:"":w.opacityExit!==void 0?w.opacityExit:0;for(const j in BA){if(w[j]===void 0)continue;const{correct:D,applyTo:B,isCSSVariable:F}=BA[j],$=C==="none"?w[j]:D(w[j],x);if(B){const H=B.length;for(let J=0;J<H;J++)h[B[J]]=$}else F?this.options.visualElement.renderState.vars[j]=$:h[j]=$}this.options.layoutId&&(h.pointerEvents=x===this?QE(i==null?void 0:i.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(h=>{var i;return(i=h.currentAnimation)==null?void 0:i.stop()}),this.root.nodes.forEach(hG),this.root.sharedNodes.clear()}}}function gEe(e){e.updateLayout()}function yEe(e){var n;const t=((n=e.resumeFrom)==null?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:a}=e.layout,{animationType:l}=e.options,h=t.source!==e.layout.source;l==="size"?af(C=>{const P=h?t.measuredBox[C]:t.layoutBox[C],E=rd(P);P.min=r[C].min,P.max=P.min+E}):Kne(l,t.layoutBox,r)&&af(C=>{const P=h?t.measuredBox[C]:t.layoutBox[C],E=rd(r[C]);P.max=P.min+E,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[C].max=e.relativeTarget[C].min+E)});const i=rb();JS(i,r,t.layoutBox);const y=rb();h?JS(y,e.applyTransform(a,!0),t.measuredBox):JS(y,r,t.layoutBox);const x=!Gne(i);let w=!1;if(!e.resumeFrom){const C=e.getClosestProjectingParent();if(C&&!C.resumeFrom){const{snapshot:P,layout:E}=C;if(P&&E){const j=yl();QS(j,t.layoutBox,P.layoutBox);const D=yl();QS(D,r,E.layoutBox),Hne(j,D)||(w=!0),C.options.layoutRoot&&(e.relativeTarget=D,e.relativeTargetOrigin=j,e.relativeParent=C)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:y,layoutDelta:i,hasLayoutChanged:x,hasRelativeLayoutChanged:w})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function vEe(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function _Ee(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function xEe(e){e.clearSnapshot()}function hG(e){e.clearMeasurements()}function fG(e){e.isLayoutDirty=!1}function bEe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function pG(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function wEe(e){e.resolveTargetDelta()}function SEe(e){e.calcProjection()}function AEe(e){e.resetSkewAndRotation()}function TEe(e){e.removeLeadSnapshot()}function mG(e,t,n){e.translate=Zo(t.translate,0,n),e.scale=Zo(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function gG(e,t,n,r){e.min=Zo(t.min,n.min,r),e.max=Zo(t.max,n.max,r)}function CEe(e,t,n,r){gG(e.x,t.x,n.x,r),gG(e.y,t.y,n.y,r)}function EEe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const PEe={duration:.45,ease:[.4,0,.1,1]},yG=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),vG=yG("applewebkit/")&&!yG("chrome/")?Math.round:vf;function _G(e){e.min=vG(e.min),e.max=vG(e.max)}function kEe(e){_G(e.x),_G(e.y)}function Kne(e,t,n){return e==="position"||e==="preserve-aspect"&&!RCe(uG(t),uG(n),.2)}function IEe(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const NEe=Zne({attachResizeListener:(e,t)=>UA(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),zL={current:void 0},Yne=Zne({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!zL.current){const e=new NEe({});e.mount(window),e.setOptions({layoutScroll:!0}),zL.current=e}return zL.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),MEe={pan:{Feature:YCe},drag:{Feature:KCe,ProjectionNode:Yne,MeasureLayout:Vne}};function xG(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");const a="onHover"+n,l=r[a];l&&zo.postRender(()=>l(t,N5(t)))}class LEe extends Pv{mount(){const{current:t}=this.node;t&&(this.unmount=eTe(t,(n,r)=>(xG(this.node,r,"Start"),a=>xG(this.node,a,"End"))))}unmount(){}}class DEe extends Pv{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=P5(UA(this.node.current,"focus",()=>this.onFocus()),UA(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function bG(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");const a="onTap"+(n==="End"?"":n),l=r[a];l&&zo.postRender(()=>l(t,N5(t)))}class REe extends Pv{mount(){const{current:t}=this.node;t&&(this.unmount=iTe(t,(n,r)=>(bG(this.node,r,"Start"),(a,{success:l})=>bG(this.node,a,l?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const $R=new WeakMap,BL=new WeakMap,jEe=e=>{const t=$R.get(e.target);t&&t(e)},OEe=e=>{e.forEach(jEe)};function FEe({root:e,...t}){const n=e||document;BL.has(n)||BL.set(n,{});const r=BL.get(n),a=JSON.stringify(t);return r[a]||(r[a]=new IntersectionObserver(OEe,{root:e,...t})),r[a]}function zEe(e,t,n){const r=FEe(t);return $R.set(e,n),r.observe(e),()=>{$R.delete(e),r.unobserve(e)}}const BEe={some:0,all:1};class UEe extends Pv{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:a="some",once:l}=t,h={root:n?n.current:void 0,rootMargin:r,threshold:typeof a=="number"?a:BEe[a]},i=y=>{const{isIntersecting:x}=y;if(this.isInView===x||(this.isInView=x,l&&!x&&this.hasEnteredView))return;x&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",x);const{onViewportEnter:w,onViewportLeave:C}=this.node.getProps(),P=x?w:C;P&&P(y)};return zEe(this.node.current,h,i)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(VEe(t,n))&&this.startObserver()}unmount(){}}function VEe({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const $Ee={inView:{Feature:UEe},tap:{Feature:REe},focus:{Feature:DEe},hover:{Feature:LEe}},qEe={layout:{ProjectionNode:Yne,MeasureLayout:Vne}},GEe={...kCe,...$Ee,...MEe,...qEe},ol=GTe(GEe,iCe),T6=kx("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),$n=L.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...a},l)=>{const h=r?Sw:"button";return v.jsx(h,{className:Xn(T6({variant:t,size:n,className:e})),ref:l,...a})});$n.displayName="Button";const HEe=({isVisible:e,title:t,message:n,severity:r,onConfirm:a,onDismiss:l,confirmText:h="Continue",dismissText:i="Cancel",showDismiss:y=!0})=>{const[x,w]=L.useState(!1);L.useEffect(()=>(e?(w(!0),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]);const P=(()=>{switch(r){case"critical":return{bgColor:"bg-red-50",borderColor:"border-red-200",iconColor:"text-red-600",icon:Os,buttonColor:"bg-red-600 hover:bg-red-700",titleColor:"text-red-900",messageColor:"text-red-700"};case"danger":return{bgColor:"bg-orange-50",borderColor:"border-orange-200",iconColor:"text-orange-600",icon:Os,buttonColor:"bg-orange-600 hover:bg-orange-700",titleColor:"text-orange-900",messageColor:"text-orange-700"};case"high":return{bgColor:"bg-yellow-50",borderColor:"border-yellow-200",iconColor:"text-yellow-600",icon:$m,buttonColor:"bg-yellow-600 hover:bg-yellow-700",titleColor:"text-yellow-900",messageColor:"text-yellow-700"};case"warning":return{bgColor:"bg-blue-50",borderColor:"border-blue-200",iconColor:"text-blue-600",icon:$m,buttonColor:"bg-blue-600 hover:bg-blue-700",titleColor:"text-blue-900",messageColor:"text-blue-700"};default:return{bgColor:"bg-red-50",borderColor:"border-red-200",iconColor:"text-red-600",icon:Os,buttonColor:"bg-red-600 hover:bg-red-700",titleColor:"text-red-900",messageColor:"text-red-700"}}})(),E=P.icon;return e?v.jsx(une,{children:e&&v.jsxs(v.Fragment,{children:[v.jsx(ol.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50",onClick:y&&l?l:void 0}),v.jsx(ol.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",stiffness:300,damping:30,duration:.3},className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:v.jsxs("div",{className:`w-full max-w-md ${P.bgColor} ${P.borderColor} border-2 rounded-2xl shadow-2xl overflow-hidden`,children:[v.jsx("div",{className:"px-6 py-4 border-b border-gray-200/50",children:v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx("div",{className:`p-2 rounded-full ${P.bgColor} ${P.borderColor} border`,children:v.jsx(E,{className:`w-6 h-6 ${P.iconColor}`})}),v.jsx("div",{className:"flex-1",children:v.jsx("h2",{className:`text-lg font-semibold ${P.titleColor}`,children:t})}),y&&l&&v.jsx("button",{onClick:l,className:"p-1 rounded-full hover:bg-gray-200/50 transition-colors",children:v.jsx(cv,{className:"w-5 h-5 text-gray-500"})})]})}),v.jsxs("div",{className:"px-6 py-4",children:[v.jsx("p",{className:`text-sm leading-relaxed ${P.messageColor} mb-6`,children:n}),v.jsxs("div",{className:"flex space-x-3",children:[v.jsxs($n,{onClick:a,className:`flex-1 ${P.buttonColor} text-white font-medium py-3 px-4 rounded-xl transition-all duration-200 transform hover:scale-105 active:scale-95 shadow-lg`,children:[v.jsx(wl,{className:"w-4 h-4 mr-2"}),h]}),y&&l&&v.jsxs($n,{onClick:l,className:"flex-1 bg-slate-700 hover:bg-slate-800 text-white font-medium py-3 px-4 rounded-xl transition-all duration-200 transform hover:scale-105 active:scale-95 border-2 border-slate-600 hover:border-slate-500 shadow-lg ring-2 ring-slate-500/20 hover:ring-slate-400/30 relative overflow-hidden",children:[v.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-slate-600/20 to-slate-500/20 opacity-0 hover:opacity-100 transition-opacity duration-200"}),v.jsx(cv,{className:"w-4 h-4 mr-2 relative z-10"}),v.jsx("span",{className:"relative z-10",children:i})]})]})]}),v.jsx("div",{className:"px-6 py-3 bg-gray-50/50 border-t border-gray-200/50",children:v.jsx("p",{className:"text-xs text-gray-500 text-center",children:"MoneyLens Financial Protection"})})]})})]})}):null},WEe=()=>{const{currentBlockingNotification:e,dismissBlockingNotification:t}=yy();if(!e)return null;const n=()=>{e.onConfirm(),t(e.id)},r=()=>{e.onDismiss&&e.onDismiss(),t(e.id)};return v.jsx(HEe,{isVisible:e.isVisible,title:e.title,message:e.message,severity:e.severity,onConfirm:n,onDismiss:e.showDismiss?r:void 0,confirmText:e.confirmText,dismissText:e.dismissText,showDismiss:e.showDismiss})},ss=L.forwardRef(({className:e,type:t,...n},r)=>v.jsx("input",{type:t,className:Xn("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));ss.displayName="Input";var ZEe="Label",Xne=L.forwardRef((e,t)=>v.jsx(Ei.label,{...e,ref:t,onMouseDown:n=>{var a;n.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));Xne.displayName=ZEe;var Jne=Xne;const KEe=kx("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Qi=L.forwardRef(({className:e,...t},n)=>v.jsx(Jne,{ref:n,className:Xn(KEe(),e),...t}));Qi.displayName=Jne.displayName;const xr=L.forwardRef(({className:e,...t},n)=>v.jsx("div",{ref:n,className:Xn("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));xr.displayName="Card";const ui=L.forwardRef(({className:e,...t},n)=>v.jsx("div",{ref:n,className:Xn("flex flex-col space-y-1.5 p-6",e),...t}));ui.displayName="CardHeader";const di=L.forwardRef(({className:e,...t},n)=>v.jsx("h3",{ref:n,className:Xn("text-2xl font-semibold leading-none tracking-tight",e),...t}));di.displayName="CardTitle";const cy=L.forwardRef(({className:e,...t},n)=>v.jsx("p",{ref:n,className:Xn("text-sm text-muted-foreground",e),...t}));cy.displayName="CardDescription";const br=L.forwardRef(({className:e,...t},n)=>v.jsx("div",{ref:n,className:Xn("p-6 pt-0",e),...t}));br.displayName="CardContent";const YEe=L.forwardRef(({className:e,...t},n)=>v.jsx("div",{ref:n,className:Xn("flex items-center p-6 pt-0",e),...t}));YEe.displayName="CardFooter";var XEe=L.createContext(void 0);function M5(e){const t=L.useContext(XEe);return e||t||"ltr"}var UL="rovingFocusGroup.onEntryFocus",JEe={bubbles:!1,cancelable:!0},L5="RovingFocusGroup",[qR,Qne,QEe]=I3(L5),[ePe,J3]=dd(L5,[QEe]),[tPe,nPe]=ePe(L5),ere=L.forwardRef((e,t)=>v.jsx(qR.Provider,{scope:e.__scopeRovingFocusGroup,children:v.jsx(qR.Slot,{scope:e.__scopeRovingFocusGroup,children:v.jsx(rPe,{...e,ref:t})})}));ere.displayName=L5;var rPe=L.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:l,currentTabStopId:h,defaultCurrentTabStopId:i,onCurrentTabStopIdChange:y,onEntryFocus:x,preventScrollOnEntryFocus:w=!1,...C}=e,P=L.useRef(null),E=_s(t,P),j=M5(l),[D,B]=ny({prop:h,defaultProp:i??null,onChange:y,caller:L5}),[F,$]=L.useState(!1),H=ll(x),J=Qne(n),ee=L.useRef(!1),[Q,ne]=L.useState(0);return L.useEffect(()=>{const pe=P.current;if(pe)return pe.addEventListener(UL,H),()=>pe.removeEventListener(UL,H)},[H]),v.jsx(tPe,{scope:n,orientation:r,dir:j,loop:a,currentTabStopId:D,onItemFocus:L.useCallback(pe=>B(pe),[B]),onItemShiftTab:L.useCallback(()=>$(!0),[]),onFocusableItemAdd:L.useCallback(()=>ne(pe=>pe+1),[]),onFocusableItemRemove:L.useCallback(()=>ne(pe=>pe-1),[]),children:v.jsx(Ei.div,{tabIndex:F||Q===0?-1:0,"data-orientation":r,...C,ref:E,style:{outline:"none",...e.style},onMouseDown:Sr(e.onMouseDown,()=>{ee.current=!0}),onFocus:Sr(e.onFocus,pe=>{const he=!ee.current;if(pe.target===pe.currentTarget&&he&&!F){const we=new CustomEvent(UL,JEe);if(pe.currentTarget.dispatchEvent(we),!we.defaultPrevented){const fe=J().filter(Qe=>Qe.focusable),ge=fe.find(Qe=>Qe.active),Ce=fe.find(Qe=>Qe.id===D),Re=[ge,Ce,...fe].filter(Boolean).map(Qe=>Qe.ref.current);rre(Re,w)}}ee.current=!1}),onBlur:Sr(e.onBlur,()=>$(!1))})})}),tre="RovingFocusGroupItem",nre=L.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:l,children:h,...i}=e,y=bp(),x=l||y,w=nPe(tre,n),C=w.currentTabStopId===x,P=Qne(n),{onFocusableItemAdd:E,onFocusableItemRemove:j,currentTabStopId:D}=w;return L.useEffect(()=>{if(r)return E(),()=>j()},[r,E,j]),v.jsx(qR.ItemSlot,{scope:n,id:x,focusable:r,active:a,children:v.jsx(Ei.span,{tabIndex:C?0:-1,"data-orientation":w.orientation,...i,ref:t,onMouseDown:Sr(e.onMouseDown,B=>{r?w.onItemFocus(x):B.preventDefault()}),onFocus:Sr(e.onFocus,()=>w.onItemFocus(x)),onKeyDown:Sr(e.onKeyDown,B=>{if(B.key==="Tab"&&B.shiftKey){w.onItemShiftTab();return}if(B.target!==B.currentTarget)return;const F=aPe(B,w.orientation,w.dir);if(F!==void 0){if(B.metaKey||B.ctrlKey||B.altKey||B.shiftKey)return;B.preventDefault();let H=P().filter(J=>J.focusable).map(J=>J.ref.current);if(F==="last")H.reverse();else if(F==="prev"||F==="next"){F==="prev"&&H.reverse();const J=H.indexOf(B.currentTarget);H=w.loop?oPe(H,J+1):H.slice(J+1)}setTimeout(()=>rre(H))}}),children:typeof h=="function"?h({isCurrentTabStop:C,hasTabStop:D!=null}):h})})});nre.displayName=tre;var iPe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function sPe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function aPe(e,t,n){const r=sPe(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return iPe[r]}function rre(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function oPe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var ire=ere,sre=nre,Q3="Tabs",[lPe,FXe]=dd(Q3,[J3]),are=J3(),[cPe,C6]=lPe(Q3),ore=L.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:a,defaultValue:l,orientation:h="horizontal",dir:i,activationMode:y="automatic",...x}=e,w=M5(i),[C,P]=ny({prop:r,onChange:a,defaultProp:l??"",caller:Q3});return v.jsx(cPe,{scope:n,baseId:bp(),value:C,onValueChange:P,orientation:h,dir:w,activationMode:y,children:v.jsx(Ei.div,{dir:w,"data-orientation":h,...x,ref:t})})});ore.displayName=Q3;var lre="TabsList",cre=L.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...a}=e,l=C6(lre,n),h=are(n);return v.jsx(ire,{asChild:!0,...h,orientation:l.orientation,dir:l.dir,loop:r,children:v.jsx(Ei.div,{role:"tablist","aria-orientation":l.orientation,...a,ref:t})})});cre.displayName=lre;var ure="TabsTrigger",dre=L.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:a=!1,...l}=e,h=C6(ure,n),i=are(n),y=pre(h.baseId,r),x=mre(h.baseId,r),w=r===h.value;return v.jsx(sre,{asChild:!0,...i,focusable:!a,active:w,children:v.jsx(Ei.button,{type:"button",role:"tab","aria-selected":w,"aria-controls":x,"data-state":w?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:y,...l,ref:t,onMouseDown:Sr(e.onMouseDown,C=>{!a&&C.button===0&&C.ctrlKey===!1?h.onValueChange(r):C.preventDefault()}),onKeyDown:Sr(e.onKeyDown,C=>{[" ","Enter"].includes(C.key)&&h.onValueChange(r)}),onFocus:Sr(e.onFocus,()=>{const C=h.activationMode!=="manual";!w&&!a&&C&&h.onValueChange(r)})})})});dre.displayName=ure;var hre="TabsContent",fre=L.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:a,children:l,...h}=e,i=C6(hre,n),y=pre(i.baseId,r),x=mre(i.baseId,r),w=r===i.value,C=L.useRef(w);return L.useEffect(()=>{const P=requestAnimationFrame(()=>C.current=!1);return()=>cancelAnimationFrame(P)},[]),v.jsx(hd,{present:a||w,children:({present:P})=>v.jsx(Ei.div,{"data-state":w?"active":"inactive","data-orientation":i.orientation,role:"tabpanel","aria-labelledby":y,hidden:!P,id:x,tabIndex:0,...h,ref:t,style:{...e.style,animationDuration:C.current?"0s":void 0},children:P&&l})})});fre.displayName=hre;function pre(e,t){return`${e}-trigger-${t}`}function mre(e,t){return`${e}-content-${t}`}var uPe=ore,gre=cre,yre=dre,vre=fre;const eI=uPe,D5=L.forwardRef(({className:e,...t},n)=>v.jsx(gre,{ref:n,className:Xn("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));D5.displayName=gre.displayName;const ed=L.forwardRef(({className:e,...t},n)=>v.jsx(yre,{ref:n,className:Xn("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",e),...t}));ed.displayName=yre.displayName;const td=L.forwardRef(({className:e,...t},n)=>v.jsx(vre,{ref:n,className:Xn("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));td.displayName=vre.displayName;var R5=e=>e.type==="checkbox",N_=e=>e instanceof Date,Xu=e=>e==null;const _re=e=>typeof e=="object";var Ul=e=>!Xu(e)&&!Array.isArray(e)&&_re(e)&&!N_(e),dPe=e=>Ul(e)&&e.target?R5(e.target)?e.target.checked:e.target.value:e,hPe=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,fPe=(e,t)=>e.has(hPe(t)),pPe=e=>{const t=e.constructor&&e.constructor.prototype;return Ul(t)&&t.hasOwnProperty("isPrototypeOf")},E6=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function wc(e){let t;const n=Array.isArray(e),r=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(!(E6&&(e instanceof Blob||r))&&(n||Ul(e)))if(t=n?[]:Object.create(Object.getPrototypeOf(e)),!n&&!pPe(e))t=e;else for(const a in e)e.hasOwnProperty(a)&&(t[a]=wc(e[a]));else return e;return t}var tI=e=>/^\w*$/.test(e),Fl=e=>e===void 0,P6=e=>Array.isArray(e)?e.filter(Boolean):[],k6=e=>P6(e.replace(/["|']|\]/g,"").split(/\.|\[/)),yi=(e,t,n)=>{if(!t||!Ul(e))return n;const r=(tI(t)?[t]:k6(t)).reduce((a,l)=>Xu(a)?a:a[l],e);return Fl(r)||r===e?Fl(e[t])?n:e[t]:r},vm=e=>typeof e=="boolean",Za=(e,t,n)=>{let r=-1;const a=tI(t)?[t]:k6(t),l=a.length,h=l-1;for(;++r<l;){const i=a[r];let y=n;if(r!==h){const x=e[i];y=Ul(x)||Array.isArray(x)?x:isNaN(+a[r+1])?{}:[]}if(i==="__proto__"||i==="constructor"||i==="prototype")return;e[i]=y,e=e[i]}};const wG={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},mp={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Pg={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},mPe=ir.createContext(null);mPe.displayName="HookFormContext";var gPe=(e,t,n,r=!0)=>{const a={defaultValues:t._defaultValues};for(const l in e)Object.defineProperty(a,l,{get:()=>{const h=l;return t._proxyFormState[h]!==mp.all&&(t._proxyFormState[h]=!r||mp.all),e[h]}});return a};const yPe=typeof window<"u"?ir.useLayoutEffect:ir.useEffect;var xh=e=>typeof e=="string",vPe=(e,t,n,r,a)=>xh(e)?(r&&t.watch.add(e),yi(n,e,a)):Array.isArray(e)?e.map(l=>(r&&t.watch.add(l),yi(n,l))):(r&&(t.watchAll=!0),n),GR=e=>Xu(e)||!_re(e);function T0(e,t,n=new WeakSet){if(GR(e)||GR(t))return e===t;if(N_(e)&&N_(t))return e.getTime()===t.getTime();const r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;if(n.has(e)||n.has(t))return!0;n.add(e),n.add(t);for(const l of r){const h=e[l];if(!a.includes(l))return!1;if(l!=="ref"){const i=t[l];if(N_(h)&&N_(i)||Ul(h)&&Ul(i)||Array.isArray(h)&&Array.isArray(i)?!T0(h,i,n):h!==i)return!1}}return!0}var xre=(e,t,n,r,a)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[r]:a||!0}}:{},eA=e=>Array.isArray(e)?e:[e],SG=()=>{let e=[];return{get observers(){return e},next:a=>{for(const l of e)l.next&&l.next(a)},subscribe:a=>(e.push(a),{unsubscribe:()=>{e=e.filter(l=>l!==a)}}),unsubscribe:()=>{e=[]}}};function bre(e,t){const n={};for(const r in e)if(e.hasOwnProperty(r)){const a=e[r],l=t[r];if(a&&Ul(a)&&l){const h=bre(a,l);Ul(h)&&(n[r]=h)}else e[r]&&(n[r]=l)}return n}var Dd=e=>Ul(e)&&!Object.keys(e).length,I6=e=>e.type==="file",gp=e=>typeof e=="function",ik=e=>{if(!E6)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},wre=e=>e.type==="select-multiple",N6=e=>e.type==="radio",_Pe=e=>N6(e)||R5(e),VL=e=>ik(e)&&e.isConnected;function xPe(e,t){const n=t.slice(0,-1).length;let r=0;for(;r<n;)e=Fl(e)?r++:e[t[r++]];return e}function bPe(e){for(const t in e)if(e.hasOwnProperty(t)&&!Fl(e[t]))return!1;return!0}function jl(e,t){const n=Array.isArray(t)?t:tI(t)?[t]:k6(t),r=n.length===1?e:xPe(e,n),a=n.length-1,l=n[a];return r&&delete r[l],a!==0&&(Ul(r)&&Dd(r)||Array.isArray(r)&&bPe(r))&&jl(e,n.slice(0,-1)),e}var wPe=e=>{for(const t in e)if(gp(e[t]))return!0;return!1};function Sre(e){return Array.isArray(e)||Ul(e)&&!wPe(e)}function HR(e,t={}){for(const n in e)Sre(e[n])?(t[n]=Array.isArray(e[n])?[]:{},HR(e[n],t[n])):Xu(e[n])||(t[n]=!0);return t}function R1(e,t,n){n||(n=HR(t));for(const r in e)Sre(e[r])?Fl(t)||GR(n[r])?n[r]=HR(e[r],Array.isArray(e[r])?[]:{}):R1(e[r],Xu(t)?{}:t[r],n[r]):n[r]=!T0(e[r],t[r]);return n}const AG={value:!1,isValid:!1},TG={value:!0,isValid:!0};var Are=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Fl(e[0].attributes.value)?Fl(e[0].value)||e[0].value===""?TG:{value:e[0].value,isValid:!0}:TG:AG}return AG},Tre=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:r})=>Fl(e)?e:t?e===""?NaN:e&&+e:n&&xh(e)?new Date(e):r?r(e):e;const CG={isValid:!1,value:null};var Cre=e=>Array.isArray(e)?e.reduce((t,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:t,CG):CG;function EG(e){const t=e.ref;return I6(t)?t.files:N6(t)?Cre(e.refs).value:wre(t)?[...t.selectedOptions].map(({value:n})=>n):R5(t)?Are(e.refs).value:Tre(Fl(t.value)?e.ref.value:t.value,e)}var SPe=(e,t,n,r)=>{const a={};for(const l of e){const h=yi(t,l);h&&Za(a,l,h._f)}return{criteriaMode:n,names:[...e],fields:a,shouldUseNativeValidation:r}},sk=e=>e instanceof RegExp,cS=e=>Fl(e)?e:sk(e)?e.source:Ul(e)?sk(e.value)?e.value.source:e.value:e,PG=e=>({isOnSubmit:!e||e===mp.onSubmit,isOnBlur:e===mp.onBlur,isOnChange:e===mp.onChange,isOnAll:e===mp.all,isOnTouch:e===mp.onTouched});const kG="AsyncFunction";var APe=e=>!!e&&!!e.validate&&!!(gp(e.validate)&&e.validate.constructor.name===kG||Ul(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===kG)),TPe=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),IG=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some(r=>e.startsWith(r)&&/^\.\w+/.test(e.slice(r.length))));const tA=(e,t,n,r)=>{for(const a of n||Object.keys(e)){const l=yi(e,a);if(l){const{_f:h,...i}=l;if(h){if(h.refs&&h.refs[0]&&t(h.refs[0],a)&&!r)return!0;if(h.ref&&t(h.ref,h.name)&&!r)return!0;if(tA(i,t))break}else if(Ul(i)&&tA(i,t))break}}};function NG(e,t,n){const r=yi(e,n);if(r||tI(n))return{error:r,name:n};const a=n.split(".");for(;a.length;){const l=a.join("."),h=yi(t,l),i=yi(e,l);if(h&&!Array.isArray(h)&&n!==l)return{name:n};if(i&&i.type)return{name:l,error:i};if(i&&i.root&&i.root.type)return{name:`${l}.root`,error:i.root};a.pop()}return{name:n}}var CPe=(e,t,n,r)=>{n(e);const{name:a,...l}=e;return Dd(l)||Object.keys(l).length>=Object.keys(t).length||Object.keys(l).find(h=>t[h]===(!r||mp.all))},EPe=(e,t,n)=>!e||!t||e===t||eA(e).some(r=>r&&(n?r===t:r.startsWith(t)||t.startsWith(r))),PPe=(e,t,n,r,a)=>a.isOnAll?!1:!n&&a.isOnTouch?!(t||e):(n?r.isOnBlur:a.isOnBlur)?!e:(n?r.isOnChange:a.isOnChange)?e:!0,kPe=(e,t)=>!P6(yi(e,t)).length&&jl(e,t),IPe=(e,t,n)=>{const r=eA(yi(e,n));return Za(r,"root",t[n]),Za(e,n,r),e};function MG(e,t,n="validate"){if(xh(e)||Array.isArray(e)&&e.every(xh)||vm(e)&&!e)return{type:n,message:xh(e)?e:"",ref:t}}var T1=e=>Ul(e)&&!sk(e)?e:{value:e,message:""},LG=async(e,t,n,r,a,l)=>{const{ref:h,refs:i,required:y,maxLength:x,minLength:w,min:C,max:P,pattern:E,validate:j,name:D,valueAsNumber:B,mount:F}=e._f,$=yi(n,D);if(!F||t.has(D))return{};const H=i?i[0]:h,J=ge=>{a&&H.reportValidity&&(H.setCustomValidity(vm(ge)?"":ge||""),H.reportValidity())},ee={},Q=N6(h),ne=R5(h),pe=Q||ne,he=(B||I6(h))&&Fl(h.value)&&Fl($)||ik(h)&&h.value===""||$===""||Array.isArray($)&&!$.length,we=xre.bind(null,D,r,ee),fe=(ge,Ce,xe,Re=Pg.maxLength,Qe=Pg.minLength)=>{const et=ge?Ce:xe;ee[D]={type:ge?Re:Qe,message:et,ref:h,...we(ge?Re:Qe,et)}};if(l?!Array.isArray($)||!$.length:y&&(!pe&&(he||Xu($))||vm($)&&!$||ne&&!Are(i).isValid||Q&&!Cre(i).isValid)){const{value:ge,message:Ce}=xh(y)?{value:!!y,message:y}:T1(y);if(ge&&(ee[D]={type:Pg.required,message:Ce,ref:H,...we(Pg.required,Ce)},!r))return J(Ce),ee}if(!he&&(!Xu(C)||!Xu(P))){let ge,Ce;const xe=T1(P),Re=T1(C);if(!Xu($)&&!isNaN($)){const Qe=h.valueAsNumber||$&&+$;Xu(xe.value)||(ge=Qe>xe.value),Xu(Re.value)||(Ce=Qe<Re.value)}else{const Qe=h.valueAsDate||new Date($),et=Ct=>new Date(new Date().toDateString()+" "+Ct),je=h.type=="time",De=h.type=="week";xh(xe.value)&&$&&(ge=je?et($)>et(xe.value):De?$>xe.value:Qe>new Date(xe.value)),xh(Re.value)&&$&&(Ce=je?et($)<et(Re.value):De?$<Re.value:Qe<new Date(Re.value))}if((ge||Ce)&&(fe(!!ge,xe.message,Re.message,Pg.max,Pg.min),!r))return J(ee[D].message),ee}if((x||w)&&!he&&(xh($)||l&&Array.isArray($))){const ge=T1(x),Ce=T1(w),xe=!Xu(ge.value)&&$.length>+ge.value,Re=!Xu(Ce.value)&&$.length<+Ce.value;if((xe||Re)&&(fe(xe,ge.message,Ce.message),!r))return J(ee[D].message),ee}if(E&&!he&&xh($)){const{value:ge,message:Ce}=T1(E);if(sk(ge)&&!$.match(ge)&&(ee[D]={type:Pg.pattern,message:Ce,ref:h,...we(Pg.pattern,Ce)},!r))return J(Ce),ee}if(j){if(gp(j)){const ge=await j($,n),Ce=MG(ge,H);if(Ce&&(ee[D]={...Ce,...we(Pg.validate,Ce.message)},!r))return J(Ce.message),ee}else if(Ul(j)){let ge={};for(const Ce in j){if(!Dd(ge)&&!r)break;const xe=MG(await j[Ce]($,n),H,Ce);xe&&(ge={...xe,...we(Ce,xe.message)},J(xe.message),r&&(ee[D]=ge))}if(!Dd(ge)&&(ee[D]={ref:H,...ge},!r))return ee}}return J(!0),ee};const NPe={mode:mp.onSubmit,reValidateMode:mp.onChange,shouldFocusError:!0};function MPe(e={}){let t={...NPe,...e},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:gp(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},r={},a=Ul(t.defaultValues)||Ul(t.values)?wc(t.defaultValues||t.values)||{}:{},l=t.shouldUnregister?{}:wc(a),h={action:!1,mount:!1,watch:!1},i={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},y,x=0;const w={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let C={...w};const P={array:SG(),state:SG()},E=t.criteriaMode===mp.all,j=ht=>wt=>{clearTimeout(x),x=setTimeout(ht,wt)},D=async ht=>{if(!t.disabled&&(w.isValid||C.isValid||ht)){const wt=t.resolver?Dd((await ne()).errors):await he(r,!0);wt!==n.isValid&&P.state.next({isValid:wt})}},B=(ht,wt)=>{!t.disabled&&(w.isValidating||w.validatingFields||C.isValidating||C.validatingFields)&&((ht||Array.from(i.mount)).forEach(Wt=>{Wt&&(wt?Za(n.validatingFields,Wt,wt):jl(n.validatingFields,Wt))}),P.state.next({validatingFields:n.validatingFields,isValidating:!Dd(n.validatingFields)}))},F=(ht,wt=[],Wt,xn,Rn=!0,Sn=!0)=>{if(xn&&Wt&&!t.disabled){if(h.action=!0,Sn&&Array.isArray(yi(r,ht))){const Mn=Wt(yi(r,ht),xn.argA,xn.argB);Rn&&Za(r,ht,Mn)}if(Sn&&Array.isArray(yi(n.errors,ht))){const Mn=Wt(yi(n.errors,ht),xn.argA,xn.argB);Rn&&Za(n.errors,ht,Mn),kPe(n.errors,ht)}if((w.touchedFields||C.touchedFields)&&Sn&&Array.isArray(yi(n.touchedFields,ht))){const Mn=Wt(yi(n.touchedFields,ht),xn.argA,xn.argB);Rn&&Za(n.touchedFields,ht,Mn)}(w.dirtyFields||C.dirtyFields)&&(n.dirtyFields=R1(a,l)),P.state.next({name:ht,isDirty:fe(ht,wt),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else Za(l,ht,wt)},$=(ht,wt)=>{Za(n.errors,ht,wt),P.state.next({errors:n.errors})},H=ht=>{n.errors=ht,P.state.next({errors:n.errors,isValid:!1})},J=(ht,wt,Wt,xn)=>{const Rn=yi(r,ht);if(Rn){const Sn=yi(l,ht,Fl(Wt)?yi(a,ht):Wt);Fl(Sn)||xn&&xn.defaultChecked||wt?Za(l,ht,wt?Sn:EG(Rn._f)):xe(ht,Sn),h.mount&&D()}},ee=(ht,wt,Wt,xn,Rn)=>{let Sn=!1,Mn=!1;const Ar={name:ht};if(!t.disabled){if(!Wt||xn){(w.isDirty||C.isDirty)&&(Mn=n.isDirty,n.isDirty=Ar.isDirty=fe(),Sn=Mn!==Ar.isDirty);const Pr=T0(yi(a,ht),wt);Mn=!!yi(n.dirtyFields,ht),Pr?jl(n.dirtyFields,ht):Za(n.dirtyFields,ht,!0),Ar.dirtyFields=n.dirtyFields,Sn=Sn||(w.dirtyFields||C.dirtyFields)&&Mn!==!Pr}if(Wt){const Pr=yi(n.touchedFields,ht);Pr||(Za(n.touchedFields,ht,Wt),Ar.touchedFields=n.touchedFields,Sn=Sn||(w.touchedFields||C.touchedFields)&&Pr!==Wt)}Sn&&Rn&&P.state.next(Ar)}return Sn?Ar:{}},Q=(ht,wt,Wt,xn)=>{const Rn=yi(n.errors,ht),Sn=(w.isValid||C.isValid)&&vm(wt)&&n.isValid!==wt;if(t.delayError&&Wt?(y=j(()=>$(ht,Wt)),y(t.delayError)):(clearTimeout(x),y=null,Wt?Za(n.errors,ht,Wt):jl(n.errors,ht)),(Wt?!T0(Rn,Wt):Rn)||!Dd(xn)||Sn){const Mn={...xn,...Sn&&vm(wt)?{isValid:wt}:{},errors:n.errors,name:ht};n={...n,...Mn},P.state.next(Mn)}},ne=async ht=>{B(ht,!0);const wt=await t.resolver(l,t.context,SPe(ht||i.mount,r,t.criteriaMode,t.shouldUseNativeValidation));return B(ht),wt},pe=async ht=>{const{errors:wt}=await ne(ht);if(ht)for(const Wt of ht){const xn=yi(wt,Wt);xn?Za(n.errors,Wt,xn):jl(n.errors,Wt)}else n.errors=wt;return wt},he=async(ht,wt,Wt={valid:!0})=>{for(const xn in ht){const Rn=ht[xn];if(Rn){const{_f:Sn,...Mn}=Rn;if(Sn){const Ar=i.array.has(Sn.name),Pr=Rn._f&&APe(Rn._f);Pr&&w.validatingFields&&B([Sn.name],!0);const wr=await LG(Rn,i.disabled,l,E,t.shouldUseNativeValidation&&!wt,Ar);if(Pr&&w.validatingFields&&B([Sn.name]),wr[Sn.name]&&(Wt.valid=!1,wt))break;!wt&&(yi(wr,Sn.name)?Ar?IPe(n.errors,wr,Sn.name):Za(n.errors,Sn.name,wr[Sn.name]):jl(n.errors,Sn.name))}!Dd(Mn)&&await he(Mn,wt,Wt)}}return Wt.valid},we=()=>{for(const ht of i.unMount){const wt=yi(r,ht);wt&&(wt._f.refs?wt._f.refs.every(Wt=>!VL(Wt)):!VL(wt._f.ref))&&dt(ht)}i.unMount=new Set},fe=(ht,wt)=>!t.disabled&&(ht&&wt&&Za(l,ht,wt),!T0(Ct(),a)),ge=(ht,wt,Wt)=>vPe(ht,i,{...h.mount?l:Fl(wt)?a:xh(ht)?{[ht]:wt}:wt},Wt,wt),Ce=ht=>P6(yi(h.mount?l:a,ht,t.shouldUnregister?yi(a,ht,[]):[])),xe=(ht,wt,Wt={})=>{const xn=yi(r,ht);let Rn=wt;if(xn){const Sn=xn._f;Sn&&(!Sn.disabled&&Za(l,ht,Tre(wt,Sn)),Rn=ik(Sn.ref)&&Xu(wt)?"":wt,wre(Sn.ref)?[...Sn.ref.options].forEach(Mn=>Mn.selected=Rn.includes(Mn.value)):Sn.refs?R5(Sn.ref)?Sn.refs.forEach(Mn=>{(!Mn.defaultChecked||!Mn.disabled)&&(Array.isArray(Rn)?Mn.checked=!!Rn.find(Ar=>Ar===Mn.value):Mn.checked=Rn===Mn.value||!!Rn)}):Sn.refs.forEach(Mn=>Mn.checked=Mn.value===Rn):I6(Sn.ref)?Sn.ref.value="":(Sn.ref.value=Rn,Sn.ref.type||P.state.next({name:ht,values:wc(l)})))}(Wt.shouldDirty||Wt.shouldTouch)&&ee(ht,Rn,Wt.shouldTouch,Wt.shouldDirty,!0),Wt.shouldValidate&&De(ht)},Re=(ht,wt,Wt)=>{for(const xn in wt){if(!wt.hasOwnProperty(xn))return;const Rn=wt[xn],Sn=ht+"."+xn,Mn=yi(r,Sn);(i.array.has(ht)||Ul(Rn)||Mn&&!Mn._f)&&!N_(Rn)?Re(Sn,Rn,Wt):xe(Sn,Rn,Wt)}},Qe=(ht,wt,Wt={})=>{const xn=yi(r,ht),Rn=i.array.has(ht),Sn=wc(wt);Za(l,ht,Sn),Rn?(P.array.next({name:ht,values:wc(l)}),(w.isDirty||w.dirtyFields||C.isDirty||C.dirtyFields)&&Wt.shouldDirty&&P.state.next({name:ht,dirtyFields:R1(a,l),isDirty:fe(ht,Sn)})):xn&&!xn._f&&!Xu(Sn)?Re(ht,Sn,Wt):xe(ht,Sn,Wt),IG(ht,i)&&P.state.next({...n,name:ht}),P.state.next({name:h.mount?ht:void 0,values:wc(l)})},et=async ht=>{h.mount=!0;const wt=ht.target;let Wt=wt.name,xn=!0;const Rn=yi(r,Wt),Sn=Pr=>{xn=Number.isNaN(Pr)||N_(Pr)&&isNaN(Pr.getTime())||T0(Pr,yi(l,Wt,Pr))},Mn=PG(t.mode),Ar=PG(t.reValidateMode);if(Rn){let Pr,wr;const Qr=wt.type?EG(Rn._f):dPe(ht),dr=ht.type===wG.BLUR||ht.type===wG.FOCUS_OUT,Hi=!TPe(Rn._f)&&!t.resolver&&!yi(n.errors,Wt)&&!Rn._f.deps||PPe(dr,yi(n.touchedFields,Wt),n.isSubmitted,Ar,Mn),Bi=IG(Wt,i,dr);Za(l,Wt,Qr),dr?(!wt||!wt.readOnly)&&(Rn._f.onBlur&&Rn._f.onBlur(ht),y&&y(0)):Rn._f.onChange&&Rn._f.onChange(ht);const Cr=ee(Wt,Qr,dr),fi=!Dd(Cr)||Bi;if(!dr&&P.state.next({name:Wt,type:ht.type,values:wc(l)}),Hi)return(w.isValid||C.isValid)&&(t.mode==="onBlur"?dr&&D():dr||D()),fi&&P.state.next({name:Wt,...Bi?{}:Cr});if(!dr&&Bi&&P.state.next({...n}),t.resolver){const{errors:Cn}=await ne([Wt]);if(Sn(Qr),xn){const bn=NG(n.errors,r,Wt),fr=NG(Cn,r,bn.name||Wt);Pr=fr.error,Wt=fr.name,wr=Dd(Cn)}}else B([Wt],!0),Pr=(await LG(Rn,i.disabled,l,E,t.shouldUseNativeValidation))[Wt],B([Wt]),Sn(Qr),xn&&(Pr?wr=!1:(w.isValid||C.isValid)&&(wr=await he(r,!0)));xn&&(Rn._f.deps&&(!Array.isArray(Rn._f.deps)||Rn._f.deps.length>0)&&De(Rn._f.deps),Q(Wt,wr,Pr,Cr))}},je=(ht,wt)=>{if(yi(n.errors,wt)&&ht.focus)return ht.focus(),1},De=async(ht,wt={})=>{let Wt,xn;const Rn=eA(ht);if(t.resolver){const Sn=await pe(Fl(ht)?ht:Rn);Wt=Dd(Sn),xn=ht?!Rn.some(Mn=>yi(Sn,Mn)):Wt}else ht?(xn=(await Promise.all(Rn.map(async Sn=>{const Mn=yi(r,Sn);return await he(Mn&&Mn._f?{[Sn]:Mn}:Mn)}))).every(Boolean),!(!xn&&!n.isValid)&&D()):xn=Wt=await he(r);return P.state.next({...!xh(ht)||(w.isValid||C.isValid)&&Wt!==n.isValid?{}:{name:ht},...t.resolver||!ht?{isValid:Wt}:{},errors:n.errors}),wt.shouldFocus&&!xn&&tA(r,je,ht?Rn:i.mount),xn},Ct=(ht,wt)=>{let Wt={...h.mount?l:a};return wt&&(Wt=bre(wt.dirtyFields?n.dirtyFields:n.touchedFields,Wt)),Fl(ht)?Wt:xh(ht)?yi(Wt,ht):ht.map(xn=>yi(Wt,xn))},xt=(ht,wt)=>({invalid:!!yi((wt||n).errors,ht),isDirty:!!yi((wt||n).dirtyFields,ht),error:yi((wt||n).errors,ht),isValidating:!!yi(n.validatingFields,ht),isTouched:!!yi((wt||n).touchedFields,ht)}),me=ht=>{ht&&eA(ht).forEach(wt=>jl(n.errors,wt)),P.state.next({errors:ht?n.errors:{}})},Ye=(ht,wt,Wt)=>{const xn=(yi(r,ht,{_f:{}})._f||{}).ref,Rn=yi(n.errors,ht)||{},{ref:Sn,message:Mn,type:Ar,...Pr}=Rn;Za(n.errors,ht,{...Pr,...wt,ref:xn}),P.state.next({name:ht,errors:n.errors,isValid:!1}),Wt&&Wt.shouldFocus&&xn&&xn.focus&&xn.focus()},nt=(ht,wt)=>gp(ht)?P.state.subscribe({next:Wt=>"values"in Wt&&ht(ge(void 0,wt),Wt)}):ge(ht,wt,!0),vt=ht=>P.state.subscribe({next:wt=>{EPe(ht.name,wt.name,ht.exact)&&CPe(wt,ht.formState||w,Or,ht.reRenderRoot)&&ht.callback({values:{...l},...n,...wt,defaultValues:a})}}).unsubscribe,gt=ht=>(h.mount=!0,C={...C,...ht.formState},vt({...ht,formState:C})),dt=(ht,wt={})=>{for(const Wt of ht?eA(ht):i.mount)i.mount.delete(Wt),i.array.delete(Wt),wt.keepValue||(jl(r,Wt),jl(l,Wt)),!wt.keepError&&jl(n.errors,Wt),!wt.keepDirty&&jl(n.dirtyFields,Wt),!wt.keepTouched&&jl(n.touchedFields,Wt),!wt.keepIsValidating&&jl(n.validatingFields,Wt),!t.shouldUnregister&&!wt.keepDefaultValue&&jl(a,Wt);P.state.next({values:wc(l)}),P.state.next({...n,...wt.keepDirty?{isDirty:fe()}:{}}),!wt.keepIsValid&&D()},At=({disabled:ht,name:wt})=>{(vm(ht)&&h.mount||ht||i.disabled.has(wt))&&(ht?i.disabled.add(wt):i.disabled.delete(wt))},mt=(ht,wt={})=>{let Wt=yi(r,ht);const xn=vm(wt.disabled)||vm(t.disabled);return Za(r,ht,{...Wt||{},_f:{...Wt&&Wt._f?Wt._f:{ref:{name:ht}},name:ht,mount:!0,...wt}}),i.mount.add(ht),Wt?At({disabled:vm(wt.disabled)?wt.disabled:t.disabled,name:ht}):J(ht,!0,wt.value),{...xn?{disabled:wt.disabled||t.disabled}:{},...t.progressive?{required:!!wt.required,min:cS(wt.min),max:cS(wt.max),minLength:cS(wt.minLength),maxLength:cS(wt.maxLength),pattern:cS(wt.pattern)}:{},name:ht,onChange:et,onBlur:et,ref:Rn=>{if(Rn){mt(ht,wt),Wt=yi(r,ht);const Sn=Fl(Rn.value)&&Rn.querySelectorAll&&Rn.querySelectorAll("input,select,textarea")[0]||Rn,Mn=_Pe(Sn),Ar=Wt._f.refs||[];if(Mn?Ar.find(Pr=>Pr===Sn):Sn===Wt._f.ref)return;Za(r,ht,{_f:{...Wt._f,...Mn?{refs:[...Ar.filter(VL),Sn,...Array.isArray(yi(a,ht))?[{}]:[]],ref:{type:Sn.type,name:ht}}:{ref:Sn}}}),J(ht,!1,void 0,Sn)}else Wt=yi(r,ht,{}),Wt._f&&(Wt._f.mount=!1),(t.shouldUnregister||wt.shouldUnregister)&&!(fPe(i.array,ht)&&h.action)&&i.unMount.add(ht)}}},Pt=()=>t.shouldFocusError&&tA(r,je,i.mount),Ht=ht=>{vm(ht)&&(P.state.next({disabled:ht}),tA(r,(wt,Wt)=>{const xn=yi(r,Wt);xn&&(wt.disabled=xn._f.disabled||ht,Array.isArray(xn._f.refs)&&xn._f.refs.forEach(Rn=>{Rn.disabled=xn._f.disabled||ht}))},0,!1))},Ot=(ht,wt)=>async Wt=>{let xn;Wt&&(Wt.preventDefault&&Wt.preventDefault(),Wt.persist&&Wt.persist());let Rn=wc(l);if(P.state.next({isSubmitting:!0}),t.resolver){const{errors:Sn,values:Mn}=await ne();n.errors=Sn,Rn=wc(Mn)}else await he(r);if(i.disabled.size)for(const Sn of i.disabled)jl(Rn,Sn);if(jl(n.errors,"root"),Dd(n.errors)){P.state.next({errors:{}});try{await ht(Rn,Wt)}catch(Sn){xn=Sn}}else wt&&await wt({...n.errors},Wt),Pt(),setTimeout(Pt);if(P.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Dd(n.errors)&&!xn,submitCount:n.submitCount+1,errors:n.errors}),xn)throw xn},Un=(ht,wt={})=>{yi(r,ht)&&(Fl(wt.defaultValue)?Qe(ht,wc(yi(a,ht))):(Qe(ht,wt.defaultValue),Za(a,ht,wc(wt.defaultValue))),wt.keepTouched||jl(n.touchedFields,ht),wt.keepDirty||(jl(n.dirtyFields,ht),n.isDirty=wt.defaultValue?fe(ht,wc(yi(a,ht))):fe()),wt.keepError||(jl(n.errors,ht),w.isValid&&D()),P.state.next({...n}))},Kt=(ht,wt={})=>{const Wt=ht?wc(ht):a,xn=wc(Wt),Rn=Dd(ht),Sn=Rn?a:xn;if(wt.keepDefaultValues||(a=Wt),!wt.keepValues){if(wt.keepDirtyValues){const Mn=new Set([...i.mount,...Object.keys(R1(a,l))]);for(const Ar of Array.from(Mn))yi(n.dirtyFields,Ar)?Za(Sn,Ar,yi(l,Ar)):Qe(Ar,yi(Sn,Ar))}else{if(E6&&Fl(ht))for(const Mn of i.mount){const Ar=yi(r,Mn);if(Ar&&Ar._f){const Pr=Array.isArray(Ar._f.refs)?Ar._f.refs[0]:Ar._f.ref;if(ik(Pr)){const wr=Pr.closest("form");if(wr){wr.reset();break}}}}if(wt.keepFieldsRef)for(const Mn of i.mount)Qe(Mn,yi(Sn,Mn));else r={}}l=t.shouldUnregister?wt.keepDefaultValues?wc(a):{}:wc(Sn),P.array.next({values:{...Sn}}),P.state.next({values:{...Sn}})}i={mount:wt.keepDirtyValues?i.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},h.mount=!w.isValid||!!wt.keepIsValid||!!wt.keepDirtyValues,h.watch=!!t.shouldUnregister,P.state.next({submitCount:wt.keepSubmitCount?n.submitCount:0,isDirty:Rn?!1:wt.keepDirty?n.isDirty:!!(wt.keepDefaultValues&&!T0(ht,a)),isSubmitted:wt.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:Rn?{}:wt.keepDirtyValues?wt.keepDefaultValues&&l?R1(a,l):n.dirtyFields:wt.keepDefaultValues&&ht?R1(a,ht):wt.keepDirty?n.dirtyFields:{},touchedFields:wt.keepTouched?n.touchedFields:{},errors:wt.keepErrors?n.errors:{},isSubmitSuccessful:wt.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:a})},st=(ht,wt)=>Kt(gp(ht)?ht(l):ht,wt),Dr=(ht,wt={})=>{const Wt=yi(r,ht),xn=Wt&&Wt._f;if(xn){const Rn=xn.refs?xn.refs[0]:xn.ref;Rn.focus&&(Rn.focus(),wt.shouldSelect&&gp(Rn.select)&&Rn.select())}},Or=ht=>{n={...n,...ht}},On={control:{register:mt,unregister:dt,getFieldState:xt,handleSubmit:Ot,setError:Ye,_subscribe:vt,_runSchema:ne,_focusError:Pt,_getWatch:ge,_getDirty:fe,_setValid:D,_setFieldArray:F,_setDisabledField:At,_setErrors:H,_getFieldArray:Ce,_reset:Kt,_resetDefaultValues:()=>gp(t.defaultValues)&&t.defaultValues().then(ht=>{st(ht,t.resetOptions),P.state.next({isLoading:!1})}),_removeUnmounted:we,_disableForm:Ht,_subjects:P,_proxyFormState:w,get _fields(){return r},get _formValues(){return l},get _state(){return h},set _state(ht){h=ht},get _defaultValues(){return a},get _names(){return i},set _names(ht){i=ht},get _formState(){return n},get _options(){return t},set _options(ht){t={...t,...ht}}},subscribe:gt,trigger:De,register:mt,handleSubmit:Ot,watch:nt,setValue:Qe,getValues:Ct,reset:st,resetField:Un,clearErrors:me,unregister:dt,setError:Ye,setFocus:Dr,getFieldState:xt};return{...On,formControl:On}}function DG(e={}){const t=ir.useRef(void 0),n=ir.useRef(void 0),[r,a]=ir.useState({isDirty:!1,isValidating:!1,isLoading:gp(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:gp(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:r},e.defaultValues&&!gp(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{const{formControl:h,...i}=MPe(e);t.current={...i,formState:r}}const l=t.current.control;return l._options=e,yPe(()=>{const h=l._subscribe({formState:l._proxyFormState,callback:()=>a({...l._formState}),reRenderRoot:!0});return a(i=>({...i,isReady:!0})),l._formState.isReady=!0,h},[l]),ir.useEffect(()=>l._disableForm(e.disabled),[l,e.disabled]),ir.useEffect(()=>{e.mode&&(l._options.mode=e.mode),e.reValidateMode&&(l._options.reValidateMode=e.reValidateMode)},[l,e.mode,e.reValidateMode]),ir.useEffect(()=>{e.errors&&(l._setErrors(e.errors),l._focusError())},[l,e.errors]),ir.useEffect(()=>{e.shouldUnregister&&l._subjects.state.next({values:l._getWatch()})},[l,e.shouldUnregister]),ir.useEffect(()=>{if(l._proxyFormState.isDirty){const h=l._getDirty();h!==r.isDirty&&l._subjects.state.next({isDirty:h})}},[l,r.isDirty]),ir.useEffect(()=>{e.values&&!T0(e.values,n.current)?(l._reset(e.values,{keepFieldsRef:!0,...l._options.resetOptions}),n.current=e.values,a(h=>({...h}))):l._resetDefaultValues()},[l,e.values]),ir.useEffect(()=>{l._state.mount||(l._setValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),t.current.formState=gPe(r,l),t.current}const RG=(e,t,n)=>{if(e&&"reportValidity"in e){const r=yi(n,t);e.setCustomValidity(r&&r.message||""),e.reportValidity()}},Ere=(e,t)=>{for(const n in t.fields){const r=t.fields[n];r&&r.ref&&"reportValidity"in r.ref?RG(r.ref,n,e):r.refs&&r.refs.forEach(a=>RG(a,n,e))}},LPe=(e,t)=>{t.shouldUseNativeValidation&&Ere(e,t);const n={};for(const r in e){const a=yi(t.fields,r),l=Object.assign(e[r]||{},{ref:a&&a.ref});if(DPe(t.names||Object.keys(e),r)){const h=Object.assign({},yi(n,r));Za(h,"root",l),Za(n,r,h)}else Za(n,r,l)}return n},DPe=(e,t)=>e.some(n=>n.startsWith(t+"."));var RPe=function(e,t){for(var n={};e.length;){var r=e[0],a=r.code,l=r.message,h=r.path.join(".");if(!n[h])if("unionErrors"in r){var i=r.unionErrors[0].errors[0];n[h]={message:i.message,type:i.code}}else n[h]={message:l,type:a};if("unionErrors"in r&&r.unionErrors.forEach(function(w){return w.errors.forEach(function(C){return e.push(C)})}),t){var y=n[h].types,x=y&&y[r.code];n[h]=xre(h,t,n,a,x?[].concat(x,r.message):r.message)}e.shift()}return n},jG=function(e,t,n){return n===void 0&&(n={}),function(r,a,l){try{return Promise.resolve(function(h,i){try{var y=Promise.resolve(e[n.mode==="sync"?"parse":"parseAsync"](r,t)).then(function(x){return l.shouldUseNativeValidation&&Ere({},l),{errors:{},values:n.raw?r:x}})}catch(x){return i(x)}return y&&y.then?y.then(void 0,i):y}(0,function(h){if(function(i){return Array.isArray(i==null?void 0:i.errors)}(h))return{values:{},errors:LPe(RPe(h.errors,!l.shouldUseNativeValidation&&l.criteriaMode==="all"),l)};throw h}))}catch(h){return Promise.reject(h)}}},ya;(function(e){e.assertEqual=a=>{};function t(a){}e.assertIs=t;function n(a){throw new Error}e.assertNever=n,e.arrayToEnum=a=>{const l={};for(const h of a)l[h]=h;return l},e.getValidEnumValues=a=>{const l=e.objectKeys(a).filter(i=>typeof a[a[i]]!="number"),h={};for(const i of l)h[i]=a[i];return e.objectValues(h)},e.objectValues=a=>e.objectKeys(a).map(function(l){return a[l]}),e.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const l=[];for(const h in a)Object.prototype.hasOwnProperty.call(a,h)&&l.push(h);return l},e.find=(a,l)=>{for(const h of a)if(l(h))return h},e.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function r(a,l=" | "){return a.map(h=>typeof h=="string"?`'${h}'`:h).join(l)}e.joinValues=r,e.jsonStringifyReplacer=(a,l)=>typeof l=="bigint"?l.toString():l})(ya||(ya={}));var OG;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(OG||(OG={}));const xi=ya.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),_0=e=>{switch(typeof e){case"undefined":return xi.undefined;case"string":return xi.string;case"number":return Number.isNaN(e)?xi.nan:xi.number;case"boolean":return xi.boolean;case"function":return xi.function;case"bigint":return xi.bigint;case"symbol":return xi.symbol;case"object":return Array.isArray(e)?xi.array:e===null?xi.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?xi.promise:typeof Map<"u"&&e instanceof Map?xi.map:typeof Set<"u"&&e instanceof Set?xi.set:typeof Date<"u"&&e instanceof Date?xi.date:xi.object;default:return xi.unknown}},mr=ya.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class uy extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(l){return l.message},r={_errors:[]},a=l=>{for(const h of l.issues)if(h.code==="invalid_union")h.unionErrors.map(a);else if(h.code==="invalid_return_type")a(h.returnTypeError);else if(h.code==="invalid_arguments")a(h.argumentsError);else if(h.path.length===0)r._errors.push(n(h));else{let i=r,y=0;for(;y<h.path.length;){const x=h.path[y];y===h.path.length-1?(i[x]=i[x]||{_errors:[]},i[x]._errors.push(n(h))):i[x]=i[x]||{_errors:[]},i=i[x],y++}}};return a(this),r}static assert(t){if(!(t instanceof uy))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ya.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const a of this.issues)if(a.path.length>0){const l=a.path[0];n[l]=n[l]||[],n[l].push(t(a))}else r.push(t(a));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}uy.create=e=>new uy(e);const WR=(e,t)=>{let n;switch(e.code){case mr.invalid_type:e.received===xi.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case mr.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,ya.jsonStringifyReplacer)}`;break;case mr.unrecognized_keys:n=`Unrecognized key(s) in object: ${ya.joinValues(e.keys,", ")}`;break;case mr.invalid_union:n="Invalid input";break;case mr.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${ya.joinValues(e.options)}`;break;case mr.invalid_enum_value:n=`Invalid enum value. Expected ${ya.joinValues(e.options)}, received '${e.received}'`;break;case mr.invalid_arguments:n="Invalid function arguments";break;case mr.invalid_return_type:n="Invalid function return type";break;case mr.invalid_date:n="Invalid date";break;case mr.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:ya.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case mr.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case mr.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case mr.custom:n="Invalid input";break;case mr.invalid_intersection_types:n="Intersection results could not be merged";break;case mr.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case mr.not_finite:n="Number must be finite";break;default:n=t.defaultError,ya.assertNever(e)}return{message:n}};let jPe=WR;function OPe(){return jPe}const FPe=e=>{const{data:t,path:n,errorMaps:r,issueData:a}=e,l=[...n,...a.path||[]],h={...a,path:l};if(a.message!==void 0)return{...a,path:l,message:a.message};let i="";const y=r.filter(x=>!!x).slice().reverse();for(const x of y)i=x(h,{data:t,defaultError:i}).message;return{...a,path:l,message:i}};function Xr(e,t){const n=OPe(),r=FPe({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===WR?void 0:WR].filter(a=>!!a)});e.common.issues.push(r)}class kh{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const a of n){if(a.status==="aborted")return cs;a.status==="dirty"&&t.dirty(),r.push(a.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const a of n){const l=await a.key,h=await a.value;r.push({key:l,value:h})}return kh.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const a of n){const{key:l,value:h}=a;if(l.status==="aborted"||h.status==="aborted")return cs;l.status==="dirty"&&t.dirty(),h.status==="dirty"&&t.dirty(),l.value!=="__proto__"&&(typeof h.value<"u"||a.alwaysSet)&&(r[l.value]=h.value)}return{status:t.value,value:r}}}const cs=Object.freeze({status:"aborted"}),IS=e=>({status:"dirty",value:e}),Ef=e=>({status:"valid",value:e}),FG=e=>e.status==="aborted",zG=e=>e.status==="dirty",nw=e=>e.status==="valid",ak=e=>typeof Promise<"u"&&e instanceof Promise;var Ai;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Ai||(Ai={}));class pv{constructor(t,n,r,a){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const BG=(e,t)=>{if(nw(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new uy(e.common.issues);return this._error=n,this._error}}};function Fs(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:a}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(h,i)=>{const{message:y}=e;return h.code==="invalid_enum_value"?{message:y??i.defaultError}:typeof i.data>"u"?{message:y??r??i.defaultError}:h.code!=="invalid_type"?{message:i.defaultError}:{message:y??n??i.defaultError}},description:a}}class da{get description(){return this._def.description}_getType(t){return _0(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:_0(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new kh,ctx:{common:t.parent.common,data:t.data,parsedType:_0(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(ak(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:_0(t)},a=this._parseSync({data:t,path:r.path,parent:r});return BG(r,a)}"~validate"(t){var r,a;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:_0(t)};if(!this["~standard"].async)try{const l=this._parseSync({data:t,path:[],parent:n});return nw(l)?{value:l.value}:{issues:n.common.issues}}catch(l){(a=(r=l==null?void 0:l.message)==null?void 0:r.toLowerCase())!=null&&a.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(l=>nw(l)?{value:l.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:_0(t)},a=this._parse({data:t,path:r.path,parent:r}),l=await(ak(a)?a:Promise.resolve(a));return BG(r,l)}refine(t,n){const r=a=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(a):n;return this._refinement((a,l)=>{const h=t(a),i=()=>l.addIssue({code:mr.custom,...r(a)});return typeof Promise<"u"&&h instanceof Promise?h.then(y=>y?!0:(i(),!1)):h?!0:(i(),!1)})}refinement(t,n){return this._refinement((r,a)=>t(r)?!0:(a.addIssue(typeof n=="function"?n(r,a):n),!1))}_refinement(t){return new sw({schema:this,typeName:us.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return tv.create(this,this._def)}nullable(){return aw.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return zm.create(this)}promise(){return uk.create(this,this._def)}or(t){return lk.create([this,t],this._def)}and(t){return ck.create(this,t,this._def)}transform(t){return new sw({...Fs(this._def),schema:this,typeName:us.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new KR({...Fs(this._def),innerType:this,defaultValue:n,typeName:us.ZodDefault})}brand(){return new oke({typeName:us.ZodBranded,type:this,...Fs(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new YR({...Fs(this._def),innerType:this,catchValue:n,typeName:us.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return M6.create(this,t)}readonly(){return XR.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const zPe=/^c[^\s-]{8,}$/i,BPe=/^[0-9a-z]+$/,UPe=/^[0-9A-HJKMNP-TV-Z]{26}$/i,VPe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,$Pe=/^[a-z0-9_-]{21}$/i,qPe=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,GPe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,HPe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,WPe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let $L;const ZPe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,KPe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,YPe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,XPe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,JPe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,QPe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Pre="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",eke=new RegExp(`^${Pre}$`);function kre(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function tke(e){return new RegExp(`^${kre(e)}$`)}function nke(e){let t=`${Pre}T${kre(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function rke(e,t){return!!((t==="v4"||!t)&&ZPe.test(e)||(t==="v6"||!t)&&YPe.test(e))}function ike(e,t){if(!qPe.test(e))return!1;try{const[n]=e.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),a=JSON.parse(atob(r));return!(typeof a!="object"||a===null||"typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||t&&a.alg!==t)}catch{return!1}}function ske(e,t){return!!((t==="v4"||!t)&&KPe.test(e)||(t==="v6"||!t)&&XPe.test(e))}class U0 extends da{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==xi.string){const l=this._getOrReturnCtx(t);return Xr(l,{code:mr.invalid_type,expected:xi.string,received:l.parsedType}),cs}const r=new kh;let a;for(const l of this._def.checks)if(l.kind==="min")t.data.length<l.value&&(a=this._getOrReturnCtx(t,a),Xr(a,{code:mr.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),r.dirty());else if(l.kind==="max")t.data.length>l.value&&(a=this._getOrReturnCtx(t,a),Xr(a,{code:mr.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),r.dirty());else if(l.kind==="length"){const h=t.data.length>l.value,i=t.data.length<l.value;(h||i)&&(a=this._getOrReturnCtx(t,a),h?Xr(a,{code:mr.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):i&&Xr(a,{code:mr.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),r.dirty())}else if(l.kind==="email")HPe.test(t.data)||(a=this._getOrReturnCtx(t,a),Xr(a,{validation:"email",code:mr.invalid_string,message:l.message}),r.dirty());else if(l.kind==="emoji")$L||($L=new RegExp(WPe,"u")),$L.test(t.data)||(a=this._getOrReturnCtx(t,a),Xr(a,{validation:"emoji",code:mr.invalid_string,message:l.message}),r.dirty());else if(l.kind==="uuid")VPe.test(t.data)||(a=this._getOrReturnCtx(t,a),Xr(a,{validation:"uuid",code:mr.invalid_string,message:l.message}),r.dirty());else if(l.kind==="nanoid")$Pe.test(t.data)||(a=this._getOrReturnCtx(t,a),Xr(a,{validation:"nanoid",code:mr.invalid_string,message:l.message}),r.dirty());else if(l.kind==="cuid")zPe.test(t.data)||(a=this._getOrReturnCtx(t,a),Xr(a,{validation:"cuid",code:mr.invalid_string,message:l.message}),r.dirty());else if(l.kind==="cuid2")BPe.test(t.data)||(a=this._getOrReturnCtx(t,a),Xr(a,{validation:"cuid2",code:mr.invalid_string,message:l.message}),r.dirty());else if(l.kind==="ulid")UPe.test(t.data)||(a=this._getOrReturnCtx(t,a),Xr(a,{validation:"ulid",code:mr.invalid_string,message:l.message}),r.dirty());else if(l.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),Xr(a,{validation:"url",code:mr.invalid_string,message:l.message}),r.dirty()}else l.kind==="regex"?(l.regex.lastIndex=0,l.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),Xr(a,{validation:"regex",code:mr.invalid_string,message:l.message}),r.dirty())):l.kind==="trim"?t.data=t.data.trim():l.kind==="includes"?t.data.includes(l.value,l.position)||(a=this._getOrReturnCtx(t,a),Xr(a,{code:mr.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),r.dirty()):l.kind==="toLowerCase"?t.data=t.data.toLowerCase():l.kind==="toUpperCase"?t.data=t.data.toUpperCase():l.kind==="startsWith"?t.data.startsWith(l.value)||(a=this._getOrReturnCtx(t,a),Xr(a,{code:mr.invalid_string,validation:{startsWith:l.value},message:l.message}),r.dirty()):l.kind==="endsWith"?t.data.endsWith(l.value)||(a=this._getOrReturnCtx(t,a),Xr(a,{code:mr.invalid_string,validation:{endsWith:l.value},message:l.message}),r.dirty()):l.kind==="datetime"?nke(l).test(t.data)||(a=this._getOrReturnCtx(t,a),Xr(a,{code:mr.invalid_string,validation:"datetime",message:l.message}),r.dirty()):l.kind==="date"?eke.test(t.data)||(a=this._getOrReturnCtx(t,a),Xr(a,{code:mr.invalid_string,validation:"date",message:l.message}),r.dirty()):l.kind==="time"?tke(l).test(t.data)||(a=this._getOrReturnCtx(t,a),Xr(a,{code:mr.invalid_string,validation:"time",message:l.message}),r.dirty()):l.kind==="duration"?GPe.test(t.data)||(a=this._getOrReturnCtx(t,a),Xr(a,{validation:"duration",code:mr.invalid_string,message:l.message}),r.dirty()):l.kind==="ip"?rke(t.data,l.version)||(a=this._getOrReturnCtx(t,a),Xr(a,{validation:"ip",code:mr.invalid_string,message:l.message}),r.dirty()):l.kind==="jwt"?ike(t.data,l.alg)||(a=this._getOrReturnCtx(t,a),Xr(a,{validation:"jwt",code:mr.invalid_string,message:l.message}),r.dirty()):l.kind==="cidr"?ske(t.data,l.version)||(a=this._getOrReturnCtx(t,a),Xr(a,{validation:"cidr",code:mr.invalid_string,message:l.message}),r.dirty()):l.kind==="base64"?JPe.test(t.data)||(a=this._getOrReturnCtx(t,a),Xr(a,{validation:"base64",code:mr.invalid_string,message:l.message}),r.dirty()):l.kind==="base64url"?QPe.test(t.data)||(a=this._getOrReturnCtx(t,a),Xr(a,{validation:"base64url",code:mr.invalid_string,message:l.message}),r.dirty()):ya.assertNever(l);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(a=>t.test(a),{validation:n,code:mr.invalid_string,...Ai.errToObj(r)})}_addCheck(t){return new U0({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Ai.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Ai.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Ai.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Ai.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Ai.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Ai.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Ai.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Ai.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Ai.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Ai.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Ai.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Ai.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Ai.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...Ai.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Ai.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Ai.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...Ai.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...Ai.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...Ai.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...Ai.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...Ai.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...Ai.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...Ai.errToObj(n)})}nonempty(t){return this.min(1,Ai.errToObj(t))}trim(){return new U0({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new U0({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new U0({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}U0.create=e=>new U0({checks:[],typeName:us.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...Fs(e)});function ake(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,a=n>r?n:r,l=Number.parseInt(e.toFixed(a).replace(".","")),h=Number.parseInt(t.toFixed(a).replace(".",""));return l%h/10**a}class rw extends da{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==xi.number){const l=this._getOrReturnCtx(t);return Xr(l,{code:mr.invalid_type,expected:xi.number,received:l.parsedType}),cs}let r;const a=new kh;for(const l of this._def.checks)l.kind==="int"?ya.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),Xr(r,{code:mr.invalid_type,expected:"integer",received:"float",message:l.message}),a.dirty()):l.kind==="min"?(l.inclusive?t.data<l.value:t.data<=l.value)&&(r=this._getOrReturnCtx(t,r),Xr(r,{code:mr.too_small,minimum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),a.dirty()):l.kind==="max"?(l.inclusive?t.data>l.value:t.data>=l.value)&&(r=this._getOrReturnCtx(t,r),Xr(r,{code:mr.too_big,maximum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),a.dirty()):l.kind==="multipleOf"?ake(t.data,l.value)!==0&&(r=this._getOrReturnCtx(t,r),Xr(r,{code:mr.not_multiple_of,multipleOf:l.value,message:l.message}),a.dirty()):l.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),Xr(r,{code:mr.not_finite,message:l.message}),a.dirty()):ya.assertNever(l);return{status:a.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,Ai.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Ai.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Ai.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Ai.toString(n))}setLimit(t,n,r,a){return new rw({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Ai.toString(a)}]})}_addCheck(t){return new rw({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Ai.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ai.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ai.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ai.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ai.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Ai.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:Ai.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ai.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ai.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&ya.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}rw.create=e=>new rw({checks:[],typeName:us.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Fs(e)});class VA extends da{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==xi.bigint)return this._getInvalidInput(t);let r;const a=new kh;for(const l of this._def.checks)l.kind==="min"?(l.inclusive?t.data<l.value:t.data<=l.value)&&(r=this._getOrReturnCtx(t,r),Xr(r,{code:mr.too_small,type:"bigint",minimum:l.value,inclusive:l.inclusive,message:l.message}),a.dirty()):l.kind==="max"?(l.inclusive?t.data>l.value:t.data>=l.value)&&(r=this._getOrReturnCtx(t,r),Xr(r,{code:mr.too_big,type:"bigint",maximum:l.value,inclusive:l.inclusive,message:l.message}),a.dirty()):l.kind==="multipleOf"?t.data%l.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),Xr(r,{code:mr.not_multiple_of,multipleOf:l.value,message:l.message}),a.dirty()):ya.assertNever(l);return{status:a.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return Xr(n,{code:mr.invalid_type,expected:xi.bigint,received:n.parsedType}),cs}gte(t,n){return this.setLimit("min",t,!0,Ai.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Ai.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Ai.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Ai.toString(n))}setLimit(t,n,r,a){return new VA({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Ai.toString(a)}]})}_addCheck(t){return new VA({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ai.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ai.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ai.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ai.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Ai.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}VA.create=e=>new VA({checks:[],typeName:us.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...Fs(e)});class UG extends da{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==xi.boolean){const r=this._getOrReturnCtx(t);return Xr(r,{code:mr.invalid_type,expected:xi.boolean,received:r.parsedType}),cs}return Ef(t.data)}}UG.create=e=>new UG({typeName:us.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Fs(e)});class ok extends da{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==xi.date){const l=this._getOrReturnCtx(t);return Xr(l,{code:mr.invalid_type,expected:xi.date,received:l.parsedType}),cs}if(Number.isNaN(t.data.getTime())){const l=this._getOrReturnCtx(t);return Xr(l,{code:mr.invalid_date}),cs}const r=new kh;let a;for(const l of this._def.checks)l.kind==="min"?t.data.getTime()<l.value&&(a=this._getOrReturnCtx(t,a),Xr(a,{code:mr.too_small,message:l.message,inclusive:!0,exact:!1,minimum:l.value,type:"date"}),r.dirty()):l.kind==="max"?t.data.getTime()>l.value&&(a=this._getOrReturnCtx(t,a),Xr(a,{code:mr.too_big,message:l.message,inclusive:!0,exact:!1,maximum:l.value,type:"date"}),r.dirty()):ya.assertNever(l);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new ok({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:Ai.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:Ai.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}ok.create=e=>new ok({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:us.ZodDate,...Fs(e)});class VG extends da{_parse(t){if(this._getType(t)!==xi.symbol){const r=this._getOrReturnCtx(t);return Xr(r,{code:mr.invalid_type,expected:xi.symbol,received:r.parsedType}),cs}return Ef(t.data)}}VG.create=e=>new VG({typeName:us.ZodSymbol,...Fs(e)});class $G extends da{_parse(t){if(this._getType(t)!==xi.undefined){const r=this._getOrReturnCtx(t);return Xr(r,{code:mr.invalid_type,expected:xi.undefined,received:r.parsedType}),cs}return Ef(t.data)}}$G.create=e=>new $G({typeName:us.ZodUndefined,...Fs(e)});class qG extends da{_parse(t){if(this._getType(t)!==xi.null){const r=this._getOrReturnCtx(t);return Xr(r,{code:mr.invalid_type,expected:xi.null,received:r.parsedType}),cs}return Ef(t.data)}}qG.create=e=>new qG({typeName:us.ZodNull,...Fs(e)});class GG extends da{constructor(){super(...arguments),this._any=!0}_parse(t){return Ef(t.data)}}GG.create=e=>new GG({typeName:us.ZodAny,...Fs(e)});class HG extends da{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Ef(t.data)}}HG.create=e=>new HG({typeName:us.ZodUnknown,...Fs(e)});class mv extends da{_parse(t){const n=this._getOrReturnCtx(t);return Xr(n,{code:mr.invalid_type,expected:xi.never,received:n.parsedType}),cs}}mv.create=e=>new mv({typeName:us.ZodNever,...Fs(e)});class WG extends da{_parse(t){if(this._getType(t)!==xi.undefined){const r=this._getOrReturnCtx(t);return Xr(r,{code:mr.invalid_type,expected:xi.void,received:r.parsedType}),cs}return Ef(t.data)}}WG.create=e=>new WG({typeName:us.ZodVoid,...Fs(e)});class zm extends da{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),a=this._def;if(n.parsedType!==xi.array)return Xr(n,{code:mr.invalid_type,expected:xi.array,received:n.parsedType}),cs;if(a.exactLength!==null){const h=n.data.length>a.exactLength.value,i=n.data.length<a.exactLength.value;(h||i)&&(Xr(n,{code:h?mr.too_big:mr.too_small,minimum:i?a.exactLength.value:void 0,maximum:h?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&n.data.length<a.minLength.value&&(Xr(n,{code:mr.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&n.data.length>a.maxLength.value&&(Xr(n,{code:mr.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((h,i)=>a.type._parseAsync(new pv(n,h,n.path,i)))).then(h=>kh.mergeArray(r,h));const l=[...n.data].map((h,i)=>a.type._parseSync(new pv(n,h,n.path,i)));return kh.mergeArray(r,l)}get element(){return this._def.type}min(t,n){return new zm({...this._def,minLength:{value:t,message:Ai.toString(n)}})}max(t,n){return new zm({...this._def,maxLength:{value:t,message:Ai.toString(n)}})}length(t,n){return new zm({...this._def,exactLength:{value:t,message:Ai.toString(n)}})}nonempty(t){return this.min(1,t)}}zm.create=(e,t)=>new zm({type:e,minLength:null,maxLength:null,exactLength:null,typeName:us.ZodArray,...Fs(t)});function j1(e){if(e instanceof sl){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=tv.create(j1(r))}return new sl({...e._def,shape:()=>t})}else return e instanceof zm?new zm({...e._def,type:j1(e.element)}):e instanceof tv?tv.create(j1(e.unwrap())):e instanceof aw?aw.create(j1(e.unwrap())):e instanceof fx?fx.create(e.items.map(t=>j1(t))):e}class sl extends da{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=ya.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==xi.object){const x=this._getOrReturnCtx(t);return Xr(x,{code:mr.invalid_type,expected:xi.object,received:x.parsedType}),cs}const{status:r,ctx:a}=this._processInputParams(t),{shape:l,keys:h}=this._getCached(),i=[];if(!(this._def.catchall instanceof mv&&this._def.unknownKeys==="strip"))for(const x in a.data)h.includes(x)||i.push(x);const y=[];for(const x of h){const w=l[x],C=a.data[x];y.push({key:{status:"valid",value:x},value:w._parse(new pv(a,C,a.path,x)),alwaysSet:x in a.data})}if(this._def.catchall instanceof mv){const x=this._def.unknownKeys;if(x==="passthrough")for(const w of i)y.push({key:{status:"valid",value:w},value:{status:"valid",value:a.data[w]}});else if(x==="strict")i.length>0&&(Xr(a,{code:mr.unrecognized_keys,keys:i}),r.dirty());else if(x!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const x=this._def.catchall;for(const w of i){const C=a.data[w];y.push({key:{status:"valid",value:w},value:x._parse(new pv(a,C,a.path,w)),alwaysSet:w in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const x=[];for(const w of y){const C=await w.key,P=await w.value;x.push({key:C,value:P,alwaysSet:w.alwaysSet})}return x}).then(x=>kh.mergeObjectSync(r,x)):kh.mergeObjectSync(r,y)}get shape(){return this._def.shape()}strict(t){return Ai.errToObj,new sl({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var l,h;const a=((h=(l=this._def).errorMap)==null?void 0:h.call(l,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:Ai.errToObj(t).message??a}:{message:a}}}:{}})}strip(){return new sl({...this._def,unknownKeys:"strip"})}passthrough(){return new sl({...this._def,unknownKeys:"passthrough"})}extend(t){return new sl({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new sl({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:us.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new sl({...this._def,catchall:t})}pick(t){const n={};for(const r of ya.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new sl({...this._def,shape:()=>n})}omit(t){const n={};for(const r of ya.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new sl({...this._def,shape:()=>n})}deepPartial(){return j1(this)}partial(t){const n={};for(const r of ya.objectKeys(this.shape)){const a=this.shape[r];t&&!t[r]?n[r]=a:n[r]=a.optional()}return new sl({...this._def,shape:()=>n})}required(t){const n={};for(const r of ya.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let l=this.shape[r];for(;l instanceof tv;)l=l._def.innerType;n[r]=l}return new sl({...this._def,shape:()=>n})}keyof(){return Ire(ya.objectKeys(this.shape))}}sl.create=(e,t)=>new sl({shape:()=>e,unknownKeys:"strip",catchall:mv.create(),typeName:us.ZodObject,...Fs(t)});sl.strictCreate=(e,t)=>new sl({shape:()=>e,unknownKeys:"strict",catchall:mv.create(),typeName:us.ZodObject,...Fs(t)});sl.lazycreate=(e,t)=>new sl({shape:e,unknownKeys:"strip",catchall:mv.create(),typeName:us.ZodObject,...Fs(t)});class lk extends da{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function a(l){for(const i of l)if(i.result.status==="valid")return i.result;for(const i of l)if(i.result.status==="dirty")return n.common.issues.push(...i.ctx.common.issues),i.result;const h=l.map(i=>new uy(i.ctx.common.issues));return Xr(n,{code:mr.invalid_union,unionErrors:h}),cs}if(n.common.async)return Promise.all(r.map(async l=>{const h={...n,common:{...n.common,issues:[]},parent:null};return{result:await l._parseAsync({data:n.data,path:n.path,parent:h}),ctx:h}})).then(a);{let l;const h=[];for(const y of r){const x={...n,common:{...n.common,issues:[]},parent:null},w=y._parseSync({data:n.data,path:n.path,parent:x});if(w.status==="valid")return w;w.status==="dirty"&&!l&&(l={result:w,ctx:x}),x.common.issues.length&&h.push(x.common.issues)}if(l)return n.common.issues.push(...l.ctx.common.issues),l.result;const i=h.map(y=>new uy(y));return Xr(n,{code:mr.invalid_union,unionErrors:i}),cs}}get options(){return this._def.options}}lk.create=(e,t)=>new lk({options:e,typeName:us.ZodUnion,...Fs(t)});function ZR(e,t){const n=_0(e),r=_0(t);if(e===t)return{valid:!0,data:e};if(n===xi.object&&r===xi.object){const a=ya.objectKeys(t),l=ya.objectKeys(e).filter(i=>a.indexOf(i)!==-1),h={...e,...t};for(const i of l){const y=ZR(e[i],t[i]);if(!y.valid)return{valid:!1};h[i]=y.data}return{valid:!0,data:h}}else if(n===xi.array&&r===xi.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let l=0;l<e.length;l++){const h=e[l],i=t[l],y=ZR(h,i);if(!y.valid)return{valid:!1};a.push(y.data)}return{valid:!0,data:a}}else return n===xi.date&&r===xi.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class ck extends da{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),a=(l,h)=>{if(FG(l)||FG(h))return cs;const i=ZR(l.value,h.value);return i.valid?((zG(l)||zG(h))&&n.dirty(),{status:n.value,value:i.data}):(Xr(r,{code:mr.invalid_intersection_types}),cs)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([l,h])=>a(l,h)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ck.create=(e,t,n)=>new ck({left:e,right:t,typeName:us.ZodIntersection,...Fs(n)});class fx extends da{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==xi.array)return Xr(r,{code:mr.invalid_type,expected:xi.array,received:r.parsedType}),cs;if(r.data.length<this._def.items.length)return Xr(r,{code:mr.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),cs;!this._def.rest&&r.data.length>this._def.items.length&&(Xr(r,{code:mr.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const l=[...r.data].map((h,i)=>{const y=this._def.items[i]||this._def.rest;return y?y._parse(new pv(r,h,r.path,i)):null}).filter(h=>!!h);return r.common.async?Promise.all(l).then(h=>kh.mergeArray(n,h)):kh.mergeArray(n,l)}get items(){return this._def.items}rest(t){return new fx({...this._def,rest:t})}}fx.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new fx({items:e,typeName:us.ZodTuple,rest:null,...Fs(t)})};class ZG extends da{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==xi.map)return Xr(r,{code:mr.invalid_type,expected:xi.map,received:r.parsedType}),cs;const a=this._def.keyType,l=this._def.valueType,h=[...r.data.entries()].map(([i,y],x)=>({key:a._parse(new pv(r,i,r.path,[x,"key"])),value:l._parse(new pv(r,y,r.path,[x,"value"]))}));if(r.common.async){const i=new Map;return Promise.resolve().then(async()=>{for(const y of h){const x=await y.key,w=await y.value;if(x.status==="aborted"||w.status==="aborted")return cs;(x.status==="dirty"||w.status==="dirty")&&n.dirty(),i.set(x.value,w.value)}return{status:n.value,value:i}})}else{const i=new Map;for(const y of h){const x=y.key,w=y.value;if(x.status==="aborted"||w.status==="aborted")return cs;(x.status==="dirty"||w.status==="dirty")&&n.dirty(),i.set(x.value,w.value)}return{status:n.value,value:i}}}}ZG.create=(e,t,n)=>new ZG({valueType:t,keyType:e,typeName:us.ZodMap,...Fs(n)});class $A extends da{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==xi.set)return Xr(r,{code:mr.invalid_type,expected:xi.set,received:r.parsedType}),cs;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(Xr(r,{code:mr.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),n.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(Xr(r,{code:mr.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),n.dirty());const l=this._def.valueType;function h(y){const x=new Set;for(const w of y){if(w.status==="aborted")return cs;w.status==="dirty"&&n.dirty(),x.add(w.value)}return{status:n.value,value:x}}const i=[...r.data.values()].map((y,x)=>l._parse(new pv(r,y,r.path,x)));return r.common.async?Promise.all(i).then(y=>h(y)):h(i)}min(t,n){return new $A({...this._def,minSize:{value:t,message:Ai.toString(n)}})}max(t,n){return new $A({...this._def,maxSize:{value:t,message:Ai.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}$A.create=(e,t)=>new $A({valueType:e,minSize:null,maxSize:null,typeName:us.ZodSet,...Fs(t)});class KG extends da{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}KG.create=(e,t)=>new KG({getter:e,typeName:us.ZodLazy,...Fs(t)});class YG extends da{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return Xr(n,{received:n.data,code:mr.invalid_literal,expected:this._def.value}),cs}return{status:"valid",value:t.data}}get value(){return this._def.value}}YG.create=(e,t)=>new YG({value:e,typeName:us.ZodLiteral,...Fs(t)});function Ire(e,t){return new iw({values:e,typeName:us.ZodEnum,...Fs(t)})}class iw extends da{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return Xr(n,{expected:ya.joinValues(r),received:n.parsedType,code:mr.invalid_type}),cs}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return Xr(n,{received:n.data,code:mr.invalid_enum_value,options:r}),cs}return Ef(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return iw.create(t,{...this._def,...n})}exclude(t,n=this._def){return iw.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}iw.create=Ire;class XG extends da{_parse(t){const n=ya.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==xi.string&&r.parsedType!==xi.number){const a=ya.objectValues(n);return Xr(r,{expected:ya.joinValues(a),received:r.parsedType,code:mr.invalid_type}),cs}if(this._cache||(this._cache=new Set(ya.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const a=ya.objectValues(n);return Xr(r,{received:r.data,code:mr.invalid_enum_value,options:a}),cs}return Ef(t.data)}get enum(){return this._def.values}}XG.create=(e,t)=>new XG({values:e,typeName:us.ZodNativeEnum,...Fs(t)});class uk extends da{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==xi.promise&&n.common.async===!1)return Xr(n,{code:mr.invalid_type,expected:xi.promise,received:n.parsedType}),cs;const r=n.parsedType===xi.promise?n.data:Promise.resolve(n.data);return Ef(r.then(a=>this._def.type.parseAsync(a,{path:n.path,errorMap:n.common.contextualErrorMap})))}}uk.create=(e,t)=>new uk({type:e,typeName:us.ZodPromise,...Fs(t)});class sw extends da{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===us.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),a=this._def.effect||null,l={addIssue:h=>{Xr(r,h),h.fatal?n.abort():n.dirty()},get path(){return r.path}};if(l.addIssue=l.addIssue.bind(l),a.type==="preprocess"){const h=a.transform(r.data,l);if(r.common.async)return Promise.resolve(h).then(async i=>{if(n.value==="aborted")return cs;const y=await this._def.schema._parseAsync({data:i,path:r.path,parent:r});return y.status==="aborted"?cs:y.status==="dirty"||n.value==="dirty"?IS(y.value):y});{if(n.value==="aborted")return cs;const i=this._def.schema._parseSync({data:h,path:r.path,parent:r});return i.status==="aborted"?cs:i.status==="dirty"||n.value==="dirty"?IS(i.value):i}}if(a.type==="refinement"){const h=i=>{const y=a.refinement(i,l);if(r.common.async)return Promise.resolve(y);if(y instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return i};if(r.common.async===!1){const i=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?cs:(i.status==="dirty"&&n.dirty(),h(i.value),{status:n.value,value:i.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(i=>i.status==="aborted"?cs:(i.status==="dirty"&&n.dirty(),h(i.value).then(()=>({status:n.value,value:i.value}))))}if(a.type==="transform")if(r.common.async===!1){const h=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!nw(h))return cs;const i=a.transform(h.value,l);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:i}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(h=>nw(h)?Promise.resolve(a.transform(h.value,l)).then(i=>({status:n.value,value:i})):cs);ya.assertNever(a)}}sw.create=(e,t,n)=>new sw({schema:e,typeName:us.ZodEffects,effect:t,...Fs(n)});sw.createWithPreprocess=(e,t,n)=>new sw({schema:t,effect:{type:"preprocess",transform:e},typeName:us.ZodEffects,...Fs(n)});class tv extends da{_parse(t){return this._getType(t)===xi.undefined?Ef(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}tv.create=(e,t)=>new tv({innerType:e,typeName:us.ZodOptional,...Fs(t)});class aw extends da{_parse(t){return this._getType(t)===xi.null?Ef(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}aw.create=(e,t)=>new aw({innerType:e,typeName:us.ZodNullable,...Fs(t)});class KR extends da{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===xi.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}KR.create=(e,t)=>new KR({innerType:e,typeName:us.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Fs(t)});class YR extends da{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return ak(a)?a.then(l=>({status:"valid",value:l.status==="valid"?l.value:this._def.catchValue({get error(){return new uy(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new uy(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}YR.create=(e,t)=>new YR({innerType:e,typeName:us.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Fs(t)});class JG extends da{_parse(t){if(this._getType(t)!==xi.nan){const r=this._getOrReturnCtx(t);return Xr(r,{code:mr.invalid_type,expected:xi.nan,received:r.parsedType}),cs}return{status:"valid",value:t.data}}}JG.create=e=>new JG({typeName:us.ZodNaN,...Fs(e)});class oke extends da{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class M6 extends da{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const l=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return l.status==="aborted"?cs:l.status==="dirty"?(n.dirty(),IS(l.value)):this._def.out._parseAsync({data:l.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?cs:a.status==="dirty"?(n.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(t,n){return new M6({in:t,out:n,typeName:us.ZodPipeline})}}class XR extends da{_parse(t){const n=this._def.innerType._parse(t),r=a=>(nw(a)&&(a.value=Object.freeze(a.value)),a);return ak(n)?n.then(a=>r(a)):r(n)}unwrap(){return this._def.innerType}}XR.create=(e,t)=>new XR({innerType:e,typeName:us.ZodReadonly,...Fs(t)});sl.lazycreate;var us;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(us||(us={}));const ib=U0.create,lke=rw.create;mv.create;zm.create;const Nre=sl.create;sl.strictCreate;lk.create;ck.create;fx.create;iw.create;uk.create;tv.create;aw.create;const cke=Nre({email:ib().email("Invalid email address"),password:ib().min(6,"Password must be at least 6 characters")}),uke=Nre({email:ib().email("Invalid email address"),password:ib().min(6,"Password must be at least 6 characters"),firstName:ib().min(2,"First name must be at least 2 characters"),lastName:ib().min(2,"Last name must be at least 2 characters"),monthlyBudgetGoal:lke().min(.01,"Budget must be greater than $0")}),dke=()=>{const{login:e,register:t}=W3(),[n,r]=L.useState(!1),a=DG({resolver:jG(cke),defaultValues:{email:"",password:""}}),l=DG({resolver:jG(uke),defaultValues:{email:"",password:"",firstName:"",lastName:"",monthlyBudgetGoal:3500}}),h=async y=>{console.log("Login attempt:",y),r(!0);try{const x=await e(y.email,y.password);console.log("Login result:",x)}catch(x){console.error("Login error:",x)}finally{r(!1)}},i=async y=>{console.log("Register attempt:",y),r(!0);try{const x=await t(y);console.log("Register result:",x)}catch(x){console.error("Registration error:",x)}finally{r(!1)}};return v.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:v.jsxs(xr,{className:"w-full max-w-md",children:[v.jsxs(ui,{className:"text-center",children:[v.jsx(di,{className:"text-2xl font-bold",children:"MoneyLens"}),v.jsx(cy,{children:"Track your financial journey with intelligent insights"})]}),v.jsx(br,{children:v.jsxs(eI,{defaultValue:"login",className:"w-full",children:[v.jsxs(D5,{className:"grid w-full grid-cols-2",children:[v.jsx(ed,{value:"login",children:"Login"}),v.jsx(ed,{value:"register",children:"Register"})]}),v.jsx(td,{value:"login",className:"space-y-4",children:v.jsxs("form",{onSubmit:a.handleSubmit(h),className:"space-y-4",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{htmlFor:"login-email",children:"Email"}),v.jsx(ss,{id:"login-email",type:"email",placeholder:"Enter your email",...a.register("email")}),a.formState.errors.email&&v.jsx("p",{className:"text-sm text-red-500",children:a.formState.errors.email.message})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{htmlFor:"login-password",children:"Password"}),v.jsx(ss,{id:"login-password",type:"password",placeholder:"Enter your password",...a.register("password")}),a.formState.errors.password&&v.jsx("p",{className:"text-sm text-red-500",children:a.formState.errors.password.message})]}),v.jsx($n,{type:"submit",className:"w-full",disabled:n,children:n?"Signing in...":"Sign In"})]})}),v.jsx(td,{value:"register",className:"space-y-4",children:v.jsxs("form",{onSubmit:l.handleSubmit(i),className:"space-y-4",children:[v.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{htmlFor:"register-firstName",children:"First Name"}),v.jsx(ss,{id:"register-firstName",placeholder:"John",...l.register("firstName")}),l.formState.errors.firstName&&v.jsx("p",{className:"text-sm text-red-500",children:l.formState.errors.firstName.message})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{htmlFor:"register-lastName",children:"Last Name"}),v.jsx(ss,{id:"register-lastName",placeholder:"Doe",...l.register("lastName")}),l.formState.errors.lastName&&v.jsx("p",{className:"text-sm text-red-500",children:l.formState.errors.lastName.message})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{htmlFor:"register-email",children:"Email"}),v.jsx(ss,{id:"register-email",type:"email",placeholder:"john@example.com",...l.register("email")}),l.formState.errors.email&&v.jsx("p",{className:"text-sm text-red-500",children:l.formState.errors.email.message})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{htmlFor:"register-password",children:"Password"}),v.jsx(ss,{id:"register-password",type:"password",placeholder:"Create a password",...l.register("password")}),l.formState.errors.password&&v.jsx("p",{className:"text-sm text-red-500",children:l.formState.errors.password.message})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{htmlFor:"register-budget",children:"Monthly Budget Goal"}),v.jsx(ss,{id:"register-budget",type:"number",placeholder:"3500",...l.register("monthlyBudgetGoal",{valueAsNumber:!0})}),l.formState.errors.monthlyBudgetGoal&&v.jsx("p",{className:"text-sm text-red-500",children:l.formState.errors.monthlyBudgetGoal.message})]}),v.jsx($n,{type:"submit",className:"w-full",disabled:n,children:n?"Creating account...":"Create Account"})]})})]})})]})})},qL=768;function hke(){const[e,t]=L.useState(void 0);return L.useEffect(()=>{const n=window.matchMedia(`(max-width: ${qL-1}px)`),r=()=>{t(window.innerWidth<qL)};return n.addEventListener("change",r),t(window.innerWidth<qL),()=>n.removeEventListener("change",r)},[]),!!e}var fke="Separator",QG="horizontal",pke=["horizontal","vertical"],Mre=L.forwardRef((e,t)=>{const{decorative:n,orientation:r=QG,...a}=e,l=mke(r)?r:QG,i=n?{role:"none"}:{"aria-orientation":l==="vertical"?l:void 0,role:"separator"};return v.jsx(Ei.div,{"data-orientation":l,...i,...a,ref:t})});Mre.displayName=fke;function mke(e){return pke.includes(e)}var Lre=Mre;const of=L.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...r},a)=>v.jsx(Lre,{ref:a,decorative:n,orientation:t,className:Xn("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...r}));of.displayName=Lre.displayName;var GL="focusScope.autoFocusOnMount",HL="focusScope.autoFocusOnUnmount",eH={bubbles:!1,cancelable:!0},gke="FocusScope",nI=L.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:l,...h}=e,[i,y]=L.useState(null),x=ll(a),w=ll(l),C=L.useRef(null),P=_s(t,D=>y(D)),E=L.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;L.useEffect(()=>{if(r){let D=function(H){if(E.paused||!i)return;const J=H.target;i.contains(J)?C.current=J:g0(C.current,{select:!0})},B=function(H){if(E.paused||!i)return;const J=H.relatedTarget;J!==null&&(i.contains(J)||g0(C.current,{select:!0}))},F=function(H){if(document.activeElement===document.body)for(const ee of H)ee.removedNodes.length>0&&g0(i)};document.addEventListener("focusin",D),document.addEventListener("focusout",B);const $=new MutationObserver(F);return i&&$.observe(i,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",D),document.removeEventListener("focusout",B),$.disconnect()}}},[r,i,E.paused]),L.useEffect(()=>{if(i){nH.add(E);const D=document.activeElement;if(!i.contains(D)){const F=new CustomEvent(GL,eH);i.addEventListener(GL,x),i.dispatchEvent(F),F.defaultPrevented||(yke(wke(Dre(i)),{select:!0}),document.activeElement===D&&g0(i))}return()=>{i.removeEventListener(GL,x),setTimeout(()=>{const F=new CustomEvent(HL,eH);i.addEventListener(HL,w),i.dispatchEvent(F),F.defaultPrevented||g0(D??document.body,{select:!0}),i.removeEventListener(HL,w),nH.remove(E)},0)}}},[i,x,w,E]);const j=L.useCallback(D=>{if(!n&&!r||E.paused)return;const B=D.key==="Tab"&&!D.altKey&&!D.ctrlKey&&!D.metaKey,F=document.activeElement;if(B&&F){const $=D.currentTarget,[H,J]=vke($);H&&J?!D.shiftKey&&F===J?(D.preventDefault(),n&&g0(H,{select:!0})):D.shiftKey&&F===H&&(D.preventDefault(),n&&g0(J,{select:!0})):F===$&&D.preventDefault()}},[n,r,E.paused]);return v.jsx(Ei.div,{tabIndex:-1,...h,ref:P,onKeyDown:j})});nI.displayName=gke;function yke(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(g0(r,{select:t}),document.activeElement!==n)return}function vke(e){const t=Dre(e),n=tH(t,e),r=tH(t.reverse(),e);return[n,r]}function Dre(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function tH(e,t){for(const n of e)if(!_ke(n,{upTo:t}))return n}function _ke(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function xke(e){return e instanceof HTMLInputElement&&"select"in e}function g0(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&xke(e)&&t&&e.select()}}var nH=bke();function bke(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=rH(e,t),e.unshift(t)},remove(t){var n;e=rH(e,t),(n=e[0])==null||n.resume()}}}function rH(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function wke(e){return e.filter(t=>t.tagName!=="A")}var WL=0;function L6(){L.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??iH()),document.body.insertAdjacentElement("beforeend",e[1]??iH()),WL++,()=>{WL===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),WL--}},[])}function iH(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Am=function(){return Am=Object.assign||function(t){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l])}return t},Am.apply(this,arguments)};function Rre(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n}function Ske(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,l;r<a;r++)(l||!(r in t))&&(l||(l=Array.prototype.slice.call(t,0,r)),l[r]=t[r]);return e.concat(l||Array.prototype.slice.call(t))}var tP="right-scroll-bar-position",nP="width-before-scroll-bar",Ake="with-scroll-bars-hidden",Tke="--removed-body-scroll-bar-size";function ZL(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Cke(e,t){var n=L.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var Eke=typeof window<"u"?L.useLayoutEffect:L.useEffect,sH=new WeakMap;function Pke(e,t){var n=Cke(null,function(r){return e.forEach(function(a){return ZL(a,r)})});return Eke(function(){var r=sH.get(n);if(r){var a=new Set(r),l=new Set(e),h=n.current;a.forEach(function(i){l.has(i)||ZL(i,null)}),l.forEach(function(i){a.has(i)||ZL(i,h)})}sH.set(n,e)},[e]),n}function kke(e){return e}function Ike(e,t){t===void 0&&(t=kke);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(l){var h=t(l,r);return n.push(h),function(){n=n.filter(function(i){return i!==h})}},assignSyncMedium:function(l){for(r=!0;n.length;){var h=n;n=[],h.forEach(l)}n={push:function(i){return l(i)},filter:function(){return n}}},assignMedium:function(l){r=!0;var h=[];if(n.length){var i=n;n=[],i.forEach(l),h=n}var y=function(){var w=h;h=[],w.forEach(l)},x=function(){return Promise.resolve().then(y)};x(),n={push:function(w){h.push(w),x()},filter:function(w){return h=h.filter(w),n}}}};return a}function Nke(e){e===void 0&&(e={});var t=Ike(null);return t.options=Am({async:!0,ssr:!1},e),t}var jre=function(e){var t=e.sideCar,n=Rre(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return L.createElement(r,Am({},n))};jre.isSideCarExport=!0;function Mke(e,t){return e.useMedium(t),jre}var Ore=Nke(),KL=function(){},rI=L.forwardRef(function(e,t){var n=L.useRef(null),r=L.useState({onScrollCapture:KL,onWheelCapture:KL,onTouchMoveCapture:KL}),a=r[0],l=r[1],h=e.forwardProps,i=e.children,y=e.className,x=e.removeScrollBar,w=e.enabled,C=e.shards,P=e.sideCar,E=e.noRelative,j=e.noIsolation,D=e.inert,B=e.allowPinchZoom,F=e.as,$=F===void 0?"div":F,H=e.gapMode,J=Rre(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),ee=P,Q=Pke([n,t]),ne=Am(Am({},J),a);return L.createElement(L.Fragment,null,w&&L.createElement(ee,{sideCar:Ore,removeScrollBar:x,shards:C,noRelative:E,noIsolation:j,inert:D,setCallbacks:l,allowPinchZoom:!!B,lockRef:n,gapMode:H}),h?L.cloneElement(L.Children.only(i),Am(Am({},ne),{ref:Q})):L.createElement($,Am({},ne,{className:y,ref:Q}),i))});rI.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};rI.classNames={fullWidth:nP,zeroRight:tP};var Lke=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Dke(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Lke();return t&&e.setAttribute("nonce",t),e}function Rke(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function jke(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Oke=function(){var e=0,t=null;return{add:function(n){e==0&&(t=Dke())&&(Rke(t,n),jke(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Fke=function(){var e=Oke();return function(t,n){L.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Fre=function(){var e=Fke(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},zke={left:0,top:0,right:0,gap:0},YL=function(e){return parseInt(e||"",10)||0},Bke=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[YL(n),YL(r),YL(a)]},Uke=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return zke;var t=Bke(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},Vke=Fre(),xb="data-scroll-locked",$ke=function(e,t,n,r){var a=e.left,l=e.top,h=e.right,i=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(Ake,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(i,"px ").concat(r,`;
  }
  body[`).concat(xb,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(l,`px;
    padding-right: `).concat(h,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(i,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(i,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(tP,` {
    right: `).concat(i,"px ").concat(r,`;
  }
  
  .`).concat(nP,` {
    margin-right: `).concat(i,"px ").concat(r,`;
  }
  
  .`).concat(tP," .").concat(tP,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(nP," .").concat(nP,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(xb,`] {
    `).concat(Tke,": ").concat(i,`px;
  }
`)},aH=function(){var e=parseInt(document.body.getAttribute(xb)||"0",10);return isFinite(e)?e:0},qke=function(){L.useEffect(function(){return document.body.setAttribute(xb,(aH()+1).toString()),function(){var e=aH()-1;e<=0?document.body.removeAttribute(xb):document.body.setAttribute(xb,e.toString())}},[])},Gke=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;qke();var l=L.useMemo(function(){return Uke(a)},[a]);return L.createElement(Vke,{styles:$ke(l,!t,a,n?"":"!important")})},JR=!1;if(typeof window<"u")try{var XC=Object.defineProperty({},"passive",{get:function(){return JR=!0,!0}});window.addEventListener("test",XC,XC),window.removeEventListener("test",XC,XC)}catch{JR=!1}var C1=JR?{passive:!1}:!1,Hke=function(e){return e.tagName==="TEXTAREA"},zre=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!Hke(e)&&n[t]==="visible")},Wke=function(e){return zre(e,"overflowY")},Zke=function(e){return zre(e,"overflowX")},oH=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=Bre(e,r);if(a){var l=Ure(e,r),h=l[1],i=l[2];if(h>i)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},Kke=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},Yke=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},Bre=function(e,t){return e==="v"?Wke(t):Zke(t)},Ure=function(e,t){return e==="v"?Kke(t):Yke(t)},Xke=function(e,t){return e==="h"&&t==="rtl"?-1:1},Jke=function(e,t,n,r,a){var l=Xke(e,window.getComputedStyle(t).direction),h=l*r,i=n.target,y=t.contains(i),x=!1,w=h>0,C=0,P=0;do{if(!i)break;var E=Ure(e,i),j=E[0],D=E[1],B=E[2],F=D-B-l*j;(j||F)&&Bre(e,i)&&(C+=F,P+=j);var $=i.parentNode;i=$&&$.nodeType===Node.DOCUMENT_FRAGMENT_NODE?$.host:$}while(!y&&i!==document.body||y&&(t.contains(i)||t===i));return(w&&(Math.abs(C)<1||!a)||!w&&(Math.abs(P)<1||!a))&&(x=!0),x},JC=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},lH=function(e){return[e.deltaX,e.deltaY]},cH=function(e){return e&&"current"in e?e.current:e},Qke=function(e,t){return e[0]===t[0]&&e[1]===t[1]},e3e=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},t3e=0,E1=[];function n3e(e){var t=L.useRef([]),n=L.useRef([0,0]),r=L.useRef(),a=L.useState(t3e++)[0],l=L.useState(Fre)[0],h=L.useRef(e);L.useEffect(function(){h.current=e},[e]),L.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var D=Ske([e.lockRef.current],(e.shards||[]).map(cH),!0).filter(Boolean);return D.forEach(function(B){return B.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),D.forEach(function(B){return B.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var i=L.useCallback(function(D,B){if("touches"in D&&D.touches.length===2||D.type==="wheel"&&D.ctrlKey)return!h.current.allowPinchZoom;var F=JC(D),$=n.current,H="deltaX"in D?D.deltaX:$[0]-F[0],J="deltaY"in D?D.deltaY:$[1]-F[1],ee,Q=D.target,ne=Math.abs(H)>Math.abs(J)?"h":"v";if("touches"in D&&ne==="h"&&Q.type==="range")return!1;var pe=oH(ne,Q);if(!pe)return!0;if(pe?ee=ne:(ee=ne==="v"?"h":"v",pe=oH(ne,Q)),!pe)return!1;if(!r.current&&"changedTouches"in D&&(H||J)&&(r.current=ee),!ee)return!0;var he=r.current||ee;return Jke(he,B,D,he==="h"?H:J,!0)},[]),y=L.useCallback(function(D){var B=D;if(!(!E1.length||E1[E1.length-1]!==l)){var F="deltaY"in B?lH(B):JC(B),$=t.current.filter(function(ee){return ee.name===B.type&&(ee.target===B.target||B.target===ee.shadowParent)&&Qke(ee.delta,F)})[0];if($&&$.should){B.cancelable&&B.preventDefault();return}if(!$){var H=(h.current.shards||[]).map(cH).filter(Boolean).filter(function(ee){return ee.contains(B.target)}),J=H.length>0?i(B,H[0]):!h.current.noIsolation;J&&B.cancelable&&B.preventDefault()}}},[]),x=L.useCallback(function(D,B,F,$){var H={name:D,delta:B,target:F,should:$,shadowParent:r3e(F)};t.current.push(H),setTimeout(function(){t.current=t.current.filter(function(J){return J!==H})},1)},[]),w=L.useCallback(function(D){n.current=JC(D),r.current=void 0},[]),C=L.useCallback(function(D){x(D.type,lH(D),D.target,i(D,e.lockRef.current))},[]),P=L.useCallback(function(D){x(D.type,JC(D),D.target,i(D,e.lockRef.current))},[]);L.useEffect(function(){return E1.push(l),e.setCallbacks({onScrollCapture:C,onWheelCapture:C,onTouchMoveCapture:P}),document.addEventListener("wheel",y,C1),document.addEventListener("touchmove",y,C1),document.addEventListener("touchstart",w,C1),function(){E1=E1.filter(function(D){return D!==l}),document.removeEventListener("wheel",y,C1),document.removeEventListener("touchmove",y,C1),document.removeEventListener("touchstart",w,C1)}},[]);var E=e.removeScrollBar,j=e.inert;return L.createElement(L.Fragment,null,j?L.createElement(l,{styles:e3e(a)}):null,E?L.createElement(Gke,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function r3e(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const i3e=Mke(Ore,n3e);var iI=L.forwardRef(function(e,t){return L.createElement(rI,Am({},e,{ref:t,sideCar:i3e}))});iI.classNames=rI.classNames;var s3e=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},P1=new WeakMap,QC=new WeakMap,eE={},XL=0,Vre=function(e){return e&&(e.host||Vre(e.parentNode))},a3e=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=Vre(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},o3e=function(e,t,n,r){var a=a3e(t,Array.isArray(e)?e:[e]);eE[n]||(eE[n]=new WeakMap);var l=eE[n],h=[],i=new Set,y=new Set(a),x=function(C){!C||i.has(C)||(i.add(C),x(C.parentNode))};a.forEach(x);var w=function(C){!C||y.has(C)||Array.prototype.forEach.call(C.children,function(P){if(i.has(P))w(P);else try{var E=P.getAttribute(r),j=E!==null&&E!=="false",D=(P1.get(P)||0)+1,B=(l.get(P)||0)+1;P1.set(P,D),l.set(P,B),h.push(P),D===1&&j&&QC.set(P,!0),B===1&&P.setAttribute(n,"true"),j||P.setAttribute(r,"true")}catch(F){console.error("aria-hidden: cannot operate on ",P,F)}})};return w(t),i.clear(),XL++,function(){h.forEach(function(C){var P=P1.get(C)-1,E=l.get(C)-1;P1.set(C,P),l.set(C,E),P||(QC.has(C)||C.removeAttribute(r),QC.delete(C)),E||C.removeAttribute(n)}),XL--,XL||(P1=new WeakMap,P1=new WeakMap,QC=new WeakMap,eE={})}},D6=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),a=s3e(e);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live]"))),o3e(r,a,n,"aria-hidden")):function(){return null}},sI="Dialog",[$re,qre]=dd(sI),[l3e,Np]=$re(sI),Gre=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:a,onOpenChange:l,modal:h=!0}=e,i=L.useRef(null),y=L.useRef(null),[x,w]=ny({prop:r,defaultProp:a??!1,onChange:l,caller:sI});return v.jsx(l3e,{scope:t,triggerRef:i,contentRef:y,contentId:bp(),titleId:bp(),descriptionId:bp(),open:x,onOpenChange:w,onOpenToggle:L.useCallback(()=>w(C=>!C),[w]),modal:h,children:n})};Gre.displayName=sI;var Hre="DialogTrigger",Wre=L.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Np(Hre,n),l=_s(t,a.triggerRef);return v.jsx(Ei.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":O6(a.open),...r,ref:l,onClick:Sr(e.onClick,a.onOpenToggle)})});Wre.displayName=Hre;var R6="DialogPortal",[c3e,Zre]=$re(R6,{forceMount:void 0}),Kre=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:a}=e,l=Np(R6,t);return v.jsx(c3e,{scope:t,forceMount:n,children:L.Children.map(r,h=>v.jsx(hd,{present:n||l.open,children:v.jsx(x5,{asChild:!0,container:a,children:h})}))})};Kre.displayName=R6;var dk="DialogOverlay",Yre=L.forwardRef((e,t)=>{const n=Zre(dk,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,l=Np(dk,e.__scopeDialog);return l.modal?v.jsx(hd,{present:r||l.open,children:v.jsx(d3e,{...a,ref:t})}):null});Yre.displayName=dk;var u3e=lx("DialogOverlay.RemoveScroll"),d3e=L.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Np(dk,n);return v.jsx(iI,{as:u3e,allowPinchZoom:!0,shards:[a.contentRef],children:v.jsx(Ei.div,{"data-state":O6(a.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),px="DialogContent",Xre=L.forwardRef((e,t)=>{const n=Zre(px,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,l=Np(px,e.__scopeDialog);return v.jsx(hd,{present:r||l.open,children:l.modal?v.jsx(h3e,{...a,ref:t}):v.jsx(f3e,{...a,ref:t})})});Xre.displayName=px;var h3e=L.forwardRef((e,t)=>{const n=Np(px,e.__scopeDialog),r=L.useRef(null),a=_s(t,n.contentRef,r);return L.useEffect(()=>{const l=r.current;if(l)return D6(l)},[]),v.jsx(Jre,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Sr(e.onCloseAutoFocus,l=>{var h;l.preventDefault(),(h=n.triggerRef.current)==null||h.focus()}),onPointerDownOutside:Sr(e.onPointerDownOutside,l=>{const h=l.detail.originalEvent,i=h.button===0&&h.ctrlKey===!0;(h.button===2||i)&&l.preventDefault()}),onFocusOutside:Sr(e.onFocusOutside,l=>l.preventDefault())})}),f3e=L.forwardRef((e,t)=>{const n=Np(px,e.__scopeDialog),r=L.useRef(!1),a=L.useRef(!1);return v.jsx(Jre,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var h,i;(h=e.onCloseAutoFocus)==null||h.call(e,l),l.defaultPrevented||(r.current||(i=n.triggerRef.current)==null||i.focus(),l.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:l=>{var y,x;(y=e.onInteractOutside)==null||y.call(e,l),l.defaultPrevented||(r.current=!0,l.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const h=l.target;((x=n.triggerRef.current)==null?void 0:x.contains(h))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&a.current&&l.preventDefault()}})}),Jre=L.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:l,...h}=e,i=Np(px,n),y=L.useRef(null),x=_s(t,y);return L6(),v.jsxs(v.Fragment,{children:[v.jsx(nI,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:l,children:v.jsx(Aw,{role:"dialog",id:i.contentId,"aria-describedby":i.descriptionId,"aria-labelledby":i.titleId,"data-state":O6(i.open),...h,ref:x,onDismiss:()=>i.onOpenChange(!1)})}),v.jsxs(v.Fragment,{children:[v.jsx(m3e,{titleId:i.titleId}),v.jsx(y3e,{contentRef:y,descriptionId:i.descriptionId})]})]})}),j6="DialogTitle",Qre=L.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Np(j6,n);return v.jsx(Ei.h2,{id:a.titleId,...r,ref:t})});Qre.displayName=j6;var eie="DialogDescription",tie=L.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Np(eie,n);return v.jsx(Ei.p,{id:a.descriptionId,...r,ref:t})});tie.displayName=eie;var nie="DialogClose",rie=L.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=Np(nie,n);return v.jsx(Ei.button,{type:"button",...r,ref:t,onClick:Sr(e.onClick,()=>a.onOpenChange(!1))})});rie.displayName=nie;function O6(e){return e?"open":"closed"}var iie="DialogTitleWarning",[p3e,sie]=Yve(iie,{contentName:px,titleName:j6,docsSlug:"dialog"}),m3e=({titleId:e})=>{const t=sie(iie),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return L.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},g3e="DialogDescriptionWarning",y3e=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${sie(g3e).contentName}}.`;return L.useEffect(()=>{var l;const a=(l=e.current)==null?void 0:l.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},F6=Gre,aie=Wre,z6=Kre,j5=Yre,O5=Xre,F5=Qre,z5=tie,aI=rie;const v3e=F6,_3e=z6,oie=L.forwardRef(({className:e,...t},n)=>v.jsx(j5,{className:Xn("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));oie.displayName=j5.displayName;const x3e=kx("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),lie=L.forwardRef(({side:e="right",className:t,children:n,...r},a)=>v.jsxs(_3e,{children:[v.jsx(oie,{}),v.jsxs(O5,{ref:a,className:Xn(x3e({side:e}),t),...r,children:[n,v.jsxs(aI,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-secondary hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[v.jsx(cv,{className:"h-4 w-4"}),v.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));lie.displayName=O5.displayName;const b3e=L.forwardRef(({className:e,...t},n)=>v.jsx(F5,{ref:n,className:Xn("text-lg font-semibold text-foreground",e),...t}));b3e.displayName=F5.displayName;const w3e=L.forwardRef(({className:e,...t},n)=>v.jsx(z5,{ref:n,className:Xn("text-sm text-muted-foreground",e),...t}));w3e.displayName=z5.displayName;function Jl({className:e,...t}){return v.jsx("div",{className:Xn("animate-pulse rounded-md bg-muted",e),...t})}const S3e="sidebar:state",A3e=60*60*24*7,T3e="16rem",C3e="18rem",E3e="3rem",P3e="b",cie=L.createContext(null);function B5(){const e=L.useContext(cie);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}const uie=L.forwardRef(({defaultOpen:e=!0,open:t,onOpenChange:n,className:r,style:a,children:l,...h},i)=>{const y=hke(),[x,w]=L.useState(!1),[C,P]=L.useState(e),E=t??C,j=L.useCallback($=>{const H=typeof $=="function"?$(E):$;n?n(H):P(H),document.cookie=`${S3e}=${H}; path=/; max-age=${A3e}`},[n,E]),D=L.useCallback(()=>y?w($=>!$):j($=>!$),[y,j,w]);L.useEffect(()=>{const $=H=>{H.key===P3e&&(H.metaKey||H.ctrlKey)&&(H.preventDefault(),D())};return window.addEventListener("keydown",$),()=>window.removeEventListener("keydown",$)},[D]);const B=E?"expanded":"collapsed",F=L.useMemo(()=>({state:B,open:E,setOpen:j,isMobile:y,openMobile:x,setOpenMobile:w,toggleSidebar:D}),[B,E,j,y,x,w,D]);return v.jsx(cie.Provider,{value:F,children:v.jsx(kee,{delayDuration:0,children:v.jsx("div",{style:{"--sidebar-width":T3e,"--sidebar-width-icon":E3e,...a},className:Xn("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",r),ref:i,...h,children:l})})})});uie.displayName="SidebarProvider";const die=L.forwardRef(({side:e="left",variant:t="sidebar",collapsible:n="offcanvas",className:r,children:a,...l},h)=>{const{isMobile:i,state:y,openMobile:x,setOpenMobile:w}=B5();return n==="none"?v.jsx("div",{className:Xn("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",r),ref:h,...l,children:a}):i?v.jsx(v3e,{open:x,onOpenChange:w,...l,children:v.jsx(lie,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":C3e},side:e,children:v.jsx("div",{className:"flex h-full w-full flex-col",children:a})})}):v.jsxs("div",{ref:h,className:"group peer hidden text-sidebar-foreground md:block","data-state":y,"data-collapsible":y==="collapsed"?n:"","data-variant":t,"data-side":e,children:[v.jsx("div",{className:Xn("relative h-svh w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),v.jsx("div",{className:Xn("fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",r),...l,children:v.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:a})})]})});die.displayName="Sidebar";const hie=L.forwardRef(({className:e,onClick:t,...n},r)=>{const{toggleSidebar:a}=B5();return v.jsxs($n,{ref:r,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:Xn("h-7 w-7",e),onClick:l=>{t==null||t(l),a()},...n,children:[v.jsx(sxe,{}),v.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})});hie.displayName="SidebarTrigger";const k3e=L.forwardRef(({className:e,...t},n)=>{const{toggleSidebar:r}=B5();return v.jsx("button",{ref:n,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:r,title:"Toggle Sidebar",className:Xn("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] group-data-[side=left]:-right-4 group-data-[side=right]:left-0 hover:after:bg-sidebar-border sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...t})});k3e.displayName="SidebarRail";const I3e=L.forwardRef(({className:e,...t},n)=>v.jsx("main",{ref:n,className:Xn("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",e),...t}));I3e.displayName="SidebarInset";const N3e=L.forwardRef(({className:e,...t},n)=>v.jsx(ss,{ref:n,"data-sidebar":"input",className:Xn("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",e),...t}));N3e.displayName="SidebarInput";const M3e=L.forwardRef(({className:e,...t},n)=>v.jsx("div",{ref:n,"data-sidebar":"header",className:Xn("flex flex-col gap-2 p-2",e),...t}));M3e.displayName="SidebarHeader";const L3e=L.forwardRef(({className:e,...t},n)=>v.jsx("div",{ref:n,"data-sidebar":"footer",className:Xn("flex flex-col gap-2 p-2",e),...t}));L3e.displayName="SidebarFooter";const D3e=L.forwardRef(({className:e,...t},n)=>v.jsx(of,{ref:n,"data-sidebar":"separator",className:Xn("mx-2 w-auto bg-sidebar-border",e),...t}));D3e.displayName="SidebarSeparator";const fie=L.forwardRef(({className:e,...t},n)=>v.jsx("div",{ref:n,"data-sidebar":"content",className:Xn("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t}));fie.displayName="SidebarContent";const pie=L.forwardRef(({className:e,...t},n)=>v.jsx("div",{ref:n,"data-sidebar":"group",className:Xn("relative flex w-full min-w-0 flex-col p-2",e),...t}));pie.displayName="SidebarGroup";const mie=L.forwardRef(({className:e,asChild:t=!1,...n},r)=>{const a=t?Sw:"div";return v.jsx(a,{ref:r,"data-sidebar":"group-label",className:Xn("flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...n})});mie.displayName="SidebarGroupLabel";const R3e=L.forwardRef(({className:e,asChild:t=!1,...n},r)=>{const a=t?Sw:"button";return v.jsx(a,{ref:r,"data-sidebar":"group-action",className:Xn("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",e),...n})});R3e.displayName="SidebarGroupAction";const gie=L.forwardRef(({className:e,...t},n)=>v.jsx("div",{ref:n,"data-sidebar":"group-content",className:Xn("w-full text-sm",e),...t}));gie.displayName="SidebarGroupContent";const yie=L.forwardRef(({className:e,...t},n)=>v.jsx("ul",{ref:n,"data-sidebar":"menu",className:Xn("flex w-full min-w-0 flex-col gap-1",e),...t}));yie.displayName="SidebarMenu";const vie=L.forwardRef(({className:e,...t},n)=>v.jsx("li",{ref:n,"data-sidebar":"menu-item",className:Xn("group/menu-item relative",e),...t}));vie.displayName="SidebarMenuItem";const j3e=kx("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),_ie=L.forwardRef(({asChild:e=!1,isActive:t=!1,variant:n="default",size:r="default",tooltip:a,className:l,...h},i)=>{const y=e?Sw:"button",{isMobile:x,state:w}=B5(),C=v.jsx(y,{ref:i,"data-sidebar":"menu-button","data-size":r,"data-active":t,className:Xn(j3e({variant:n,size:r}),l),...h});return a?(typeof a=="string"&&(a={children:a}),v.jsxs(gwe,{children:[v.jsx(ywe,{asChild:!0,children:C}),v.jsx(Iee,{side:"right",align:"center",hidden:w!=="collapsed"||x,...a})]})):C});_ie.displayName="SidebarMenuButton";const O3e=L.forwardRef(({className:e,asChild:t=!1,showOnHover:n=!1,...r},a)=>{const l=t?Sw:"button";return v.jsx(l,{ref:a,"data-sidebar":"menu-action",className:Xn("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform peer-hover/menu-button:text-sidebar-accent-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",n&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",e),...r})});O3e.displayName="SidebarMenuAction";const F3e=L.forwardRef(({className:e,...t},n)=>v.jsx("div",{ref:n,"data-sidebar":"menu-badge",className:Xn("pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",e),...t}));F3e.displayName="SidebarMenuBadge";const z3e=L.forwardRef(({className:e,showIcon:t=!1,...n},r)=>{const a=L.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return v.jsxs("div",{ref:r,"data-sidebar":"menu-skeleton",className:Xn("flex h-8 items-center gap-2 rounded-md px-2",e),...n,children:[t&&v.jsx(Jl,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),v.jsx(Jl,{className:"h-4 max-w-[--skeleton-width] flex-1","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":a}})]})});z3e.displayName="SidebarMenuSkeleton";const B3e=L.forwardRef(({className:e,...t},n)=>v.jsx("ul",{ref:n,"data-sidebar":"menu-sub",className:Xn("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),...t}));B3e.displayName="SidebarMenuSub";const U3e=L.forwardRef(({...e},t)=>v.jsx("li",{ref:t,...e}));U3e.displayName="SidebarMenuSubItem";const V3e=L.forwardRef(({asChild:e=!1,size:t="md",isActive:n,className:r,...a},l)=>{const h=e?Sw:"a";return v.jsx(h,{ref:l,"data-sidebar":"menu-sub-button","data-size":t,"data-active":n,className:Xn("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring aria-disabled:pointer-events-none aria-disabled:opacity-50 hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",t==="sm"&&"text-xs",t==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",r),...a})});V3e.displayName="SidebarMenuSubButton";const $3e="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAyOCAyOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8IS0tIE91dGVyIGNpcmNsZSAtLT4KICA8Y2lyY2xlIGN4PSIxNCIgY3k9IjE0IiByPSIxMyIgc3Ryb2tlPSIjRDRBRjM3IiBzdHJva2Utd2lkdGg9IjIiIGZpbGw9Im5vbmUiLz4KICAKICA8IS0tIElubmVyIGNpcmNsZSAtLT4KICA8Y2lyY2xlIGN4PSIxNCIgY3k9IjE0IiByPSI5IiBzdHJva2U9IiNENEFGMzciIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIvPgogIAogIDwhLS0gTUwgVGV4dCAtIHNsaWdodGx5IGxhcmdlciAtLT4KICA8dGV4dCB4PSIxNCIgeT0iMTgiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtZmFtaWx5PSJzZXJpZiIgZm9udC1zaXplPSIxMCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IiNENEFGMzciPk1MPC90ZXh0PgogIAogIDwhLS0gU3RldGhvc2NvcGUtbGlrZSBjdXJ2ZSAtLT4KICA8cGF0aCBkPSJNIDE5IDkgUSAyMSAxMSAxOSAxMyIgc3Ryb2tlPSIjRDRBRjM3IiBzdHJva2Utd2lkdGg9IjEuNSIgZmlsbD0ibm9uZSIvPgogIDxjaXJjbGUgY3g9IjE5IiBjeT0iMTMiIHI9IjEiIGZpbGw9IiNENEFGMzciLz4KPC9zdmc+Cg==",q3e=[{title:"Dashboard",url:"/",icon:_F,description:"Overview & insights"},{title:"Map View",url:"/map",icon:R3,description:"Geographic spending"},{title:"Spending Caps",url:"/caps",icon:Wd,description:"Manage limits"},{title:"Transactions",url:"/transactions",icon:w5,description:"Transaction history"},{title:"Analytics",url:"/analytics",icon:Kb,description:"Detailed insights"},{title:"Leaderboard",url:"/leaderboard",icon:HE,description:"Compare with others"},{title:"Financial Bodyguard",url:"/bodyguard",icon:$m,description:"AI spending protection"},{title:"Settings",url:"/settings",icon:xF,description:"Preferences"}];function G3e(){const{state:e}=B5(),n=Ix().pathname,r=e==="collapsed",{theme:a,setTheme:l,resolvedTheme:h}=fte(),i=C=>n===C,y=({isActive:C})=>C?"bg-primary text-primary-foreground font-semibold shadow-lg border-l-4 border-primary-foreground transform scale-[1.02] px-5 py-5 pb-5":"hover:bg-accent hover:text-accent-foreground transition-all duration-200 hover:scale-[1.01] hover:shadow-sm",x=()=>{l(a==="light"?"dark":a==="dark"?"system":"light")},w=()=>a==="system"?v.jsx(jQ,{className:"w-4 h-4"}):h==="dark"?v.jsx(OQ,{className:"w-4 h-4"}):v.jsx(BQ,{className:"w-4 h-4"});return v.jsxs(die,{className:`${r?"w-16":"w-64"} border-r border-sidebar-border bg-sidebar`,collapsible:"icon",children:[v.jsx("div",{className:"p-4 border-b border-sidebar-border",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"p-2 rounded-lg",children:v.jsx("img",{src:$3e,alt:"MoneyLens Logo",className:"w-6 h-6"})}),!r&&v.jsxs("div",{children:[v.jsx("h1",{className:"text-xl font-bold text-sidebar-foreground",children:"MoneyLens"}),v.jsx("p",{className:"text-sm text-sidebar-foreground/60",children:"Financial Tracking"})]})]})}),v.jsxs(fie,{className:"py-4",children:[v.jsxs(pie,{children:[v.jsx(mie,{className:"px-4 text-sidebar-foreground/60 font-medium",children:!r&&"Navigation"}),v.jsx(gie,{className:"px-3",children:v.jsx(yie,{className:"space-y-3",children:q3e.map(C=>v.jsx(vie,{children:v.jsx(_ie,{asChild:!0,className:"w-full",children:v.jsxs(J2e,{to:C.url,end:!0,className:`flex items-center gap-3 rounded-md transition-all duration-200 ${y({isActive:i(C.url)})} ${i(C.url)?"":"px-3 py-4"}`,children:[v.jsx(C.icon,{className:`w-5 h-5 flex-shrink-0 ${i(C.url)?"text-primary-foreground":""}`}),!r&&v.jsxs("div",{className:"flex-1 min-w-0 pb-1",children:[v.jsx("div",{className:"font-medium text-sm",children:C.title}),v.jsx("div",{className:"text-xs opacity-60 truncate",children:C.description})]})]})})},C.title))})})]}),!r&&v.jsx("div",{className:"px-6 py-4 mt-auto",children:v.jsxs("div",{className:"p-4 bg-primary/10 rounded-lg",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[v.jsx(Ju,{className:"w-4 h-4 text-primary"}),v.jsx("span",{className:"text-sm font-medium text-sidebar-foreground",children:"Quick Stats"})]}),v.jsx("div",{className:"text-xs text-sidebar-foreground/60",children:"$2,847 spent this month"}),v.jsx("div",{className:"text-xs text-success mt-1",children:"15% under budget"})]})}),v.jsx("div",{className:"px-3 pb-3",children:v.jsxs($n,{variant:"ghost",size:"sm",onClick:x,className:"w-full justify-start gap-3 text-sidebar-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",title:`Current theme: ${h} ${a==="system"?"(system)":""}`,children:[w(),!r&&v.jsx("span",{className:"text-sm",children:a==="system"?"System":h==="dark"?"Dark":"Light"})]})})]})]})}const H3e=kx("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Is({className:e,variant:t,...n}){return v.jsx("div",{className:Xn(H3e({variant:t}),e),...n})}var QR=["Enter"," "],W3e=["ArrowDown","PageUp","Home"],xie=["ArrowUp","PageDown","End"],Z3e=[...W3e,...xie],K3e={ltr:[...QR,"ArrowRight"],rtl:[...QR,"ArrowLeft"]},Y3e={ltr:["ArrowLeft"],rtl:["ArrowRight"]},U5="Menu",[qA,X3e,J3e]=I3(U5),[Nx,bie]=dd(U5,[J3e,Pw,J3]),oI=Pw(),wie=J3(),[Q3e,Mx]=Nx(U5),[eIe,V5]=Nx(U5),Sie=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:a,onOpenChange:l,modal:h=!0}=e,i=oI(t),[y,x]=L.useState(null),w=L.useRef(!1),C=ll(l),P=M5(a);return L.useEffect(()=>{const E=()=>{w.current=!0,document.addEventListener("pointerdown",j,{capture:!0,once:!0}),document.addEventListener("pointermove",j,{capture:!0,once:!0})},j=()=>w.current=!1;return document.addEventListener("keydown",E,{capture:!0}),()=>{document.removeEventListener("keydown",E,{capture:!0}),document.removeEventListener("pointerdown",j,{capture:!0}),document.removeEventListener("pointermove",j,{capture:!0})}},[]),v.jsx(RF,{...i,children:v.jsx(Q3e,{scope:t,open:n,onOpenChange:C,content:y,onContentChange:x,children:v.jsx(eIe,{scope:t,onClose:L.useCallback(()=>C(!1),[C]),isUsingKeyboardRef:w,dir:P,modal:h,children:r})})})};Sie.displayName=U5;var tIe="MenuAnchor",B6=L.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=oI(n);return v.jsx(jF,{...a,...r,ref:t})});B6.displayName=tIe;var U6="MenuPortal",[nIe,Aie]=Nx(U6,{forceMount:void 0}),Tie=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:a}=e,l=Mx(U6,t);return v.jsx(nIe,{scope:t,forceMount:n,children:v.jsx(hd,{present:n||l.open,children:v.jsx(x5,{asChild:!0,container:a,children:r})})})};Tie.displayName=U6;var _f="MenuContent",[rIe,V6]=Nx(_f),Cie=L.forwardRef((e,t)=>{const n=Aie(_f,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,l=Mx(_f,e.__scopeMenu),h=V5(_f,e.__scopeMenu);return v.jsx(qA.Provider,{scope:e.__scopeMenu,children:v.jsx(hd,{present:r||l.open,children:v.jsx(qA.Slot,{scope:e.__scopeMenu,children:h.modal?v.jsx(iIe,{...a,ref:t}):v.jsx(sIe,{...a,ref:t})})})})}),iIe=L.forwardRef((e,t)=>{const n=Mx(_f,e.__scopeMenu),r=L.useRef(null),a=_s(t,r);return L.useEffect(()=>{const l=r.current;if(l)return D6(l)},[]),v.jsx($6,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Sr(e.onFocusOutside,l=>l.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),sIe=L.forwardRef((e,t)=>{const n=Mx(_f,e.__scopeMenu);return v.jsx($6,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),aIe=lx("MenuContent.ScrollLock"),$6=L.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:a,onOpenAutoFocus:l,onCloseAutoFocus:h,disableOutsidePointerEvents:i,onEntryFocus:y,onEscapeKeyDown:x,onPointerDownOutside:w,onFocusOutside:C,onInteractOutside:P,onDismiss:E,disableOutsideScroll:j,...D}=e,B=Mx(_f,n),F=V5(_f,n),$=oI(n),H=wie(n),J=X3e(n),[ee,Q]=L.useState(null),ne=L.useRef(null),pe=_s(t,ne,B.onContentChange),he=L.useRef(0),we=L.useRef(""),fe=L.useRef(0),ge=L.useRef(null),Ce=L.useRef("right"),xe=L.useRef(0),Re=j?iI:L.Fragment,Qe=j?{as:aIe,allowPinchZoom:!0}:void 0,et=De=>{var dt,At;const Ct=we.current+De,xt=J().filter(mt=>!mt.disabled),me=document.activeElement,Ye=(dt=xt.find(mt=>mt.ref.current===me))==null?void 0:dt.textValue,nt=xt.map(mt=>mt.textValue),vt=vIe(nt,Ct,Ye),gt=(At=xt.find(mt=>mt.textValue===vt))==null?void 0:At.ref.current;(function mt(Pt){we.current=Pt,window.clearTimeout(he.current),Pt!==""&&(he.current=window.setTimeout(()=>mt(""),1e3))})(Ct),gt&&setTimeout(()=>gt.focus())};L.useEffect(()=>()=>window.clearTimeout(he.current),[]),L6();const je=L.useCallback(De=>{var xt,me;return Ce.current===((xt=ge.current)==null?void 0:xt.side)&&xIe(De,(me=ge.current)==null?void 0:me.area)},[]);return v.jsx(rIe,{scope:n,searchRef:we,onItemEnter:L.useCallback(De=>{je(De)&&De.preventDefault()},[je]),onItemLeave:L.useCallback(De=>{var Ct;je(De)||((Ct=ne.current)==null||Ct.focus(),Q(null))},[je]),onTriggerLeave:L.useCallback(De=>{je(De)&&De.preventDefault()},[je]),pointerGraceTimerRef:fe,onPointerGraceIntentChange:L.useCallback(De=>{ge.current=De},[]),children:v.jsx(Re,{...Qe,children:v.jsx(nI,{asChild:!0,trapped:a,onMountAutoFocus:Sr(l,De=>{var Ct;De.preventDefault(),(Ct=ne.current)==null||Ct.focus({preventScroll:!0})}),onUnmountAutoFocus:h,children:v.jsx(Aw,{asChild:!0,disableOutsidePointerEvents:i,onEscapeKeyDown:x,onPointerDownOutside:w,onFocusOutside:C,onInteractOutside:P,onDismiss:E,children:v.jsx(ire,{asChild:!0,...H,dir:F.dir,orientation:"vertical",loop:r,currentTabStopId:ee,onCurrentTabStopIdChange:Q,onEntryFocus:Sr(y,De=>{F.isUsingKeyboardRef.current||De.preventDefault()}),preventScrollOnEntryFocus:!0,children:v.jsx(OF,{role:"menu","aria-orientation":"vertical","data-state":Vie(B.open),"data-radix-menu-content":"",dir:F.dir,...$,...D,ref:pe,style:{outline:"none",...D.style},onKeyDown:Sr(D.onKeyDown,De=>{const xt=De.target.closest("[data-radix-menu-content]")===De.currentTarget,me=De.ctrlKey||De.altKey||De.metaKey,Ye=De.key.length===1;xt&&(De.key==="Tab"&&De.preventDefault(),!me&&Ye&&et(De.key));const nt=ne.current;if(De.target!==nt||!Z3e.includes(De.key))return;De.preventDefault();const gt=J().filter(dt=>!dt.disabled).map(dt=>dt.ref.current);xie.includes(De.key)&&gt.reverse(),gIe(gt)}),onBlur:Sr(e.onBlur,De=>{De.currentTarget.contains(De.target)||(window.clearTimeout(he.current),we.current="")}),onPointerMove:Sr(e.onPointerMove,GA(De=>{const Ct=De.target,xt=xe.current!==De.clientX;if(De.currentTarget.contains(Ct)&&xt){const me=De.clientX>xe.current?"right":"left";Ce.current=me,xe.current=De.clientX}}))})})})})})})});Cie.displayName=_f;var oIe="MenuGroup",q6=L.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return v.jsx(Ei.div,{role:"group",...r,ref:t})});q6.displayName=oIe;var lIe="MenuLabel",Eie=L.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return v.jsx(Ei.div,{...r,ref:t})});Eie.displayName=lIe;var hk="MenuItem",uH="menu.itemSelect",lI=L.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...a}=e,l=L.useRef(null),h=V5(hk,e.__scopeMenu),i=V6(hk,e.__scopeMenu),y=_s(t,l),x=L.useRef(!1),w=()=>{const C=l.current;if(!n&&C){const P=new CustomEvent(uH,{bubbles:!0,cancelable:!0});C.addEventListener(uH,E=>r==null?void 0:r(E),{once:!0}),hF(C,P),P.defaultPrevented?x.current=!1:h.onClose()}};return v.jsx(Pie,{...a,ref:y,disabled:n,onClick:Sr(e.onClick,w),onPointerDown:C=>{var P;(P=e.onPointerDown)==null||P.call(e,C),x.current=!0},onPointerUp:Sr(e.onPointerUp,C=>{var P;x.current||(P=C.currentTarget)==null||P.click()}),onKeyDown:Sr(e.onKeyDown,C=>{const P=i.searchRef.current!=="";n||P&&C.key===" "||QR.includes(C.key)&&(C.currentTarget.click(),C.preventDefault())})})});lI.displayName=hk;var Pie=L.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:a,...l}=e,h=V6(hk,n),i=wie(n),y=L.useRef(null),x=_s(t,y),[w,C]=L.useState(!1),[P,E]=L.useState("");return L.useEffect(()=>{const j=y.current;j&&E((j.textContent??"").trim())},[l.children]),v.jsx(qA.ItemSlot,{scope:n,disabled:r,textValue:a??P,children:v.jsx(sre,{asChild:!0,...i,focusable:!r,children:v.jsx(Ei.div,{role:"menuitem","data-highlighted":w?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...l,ref:x,onPointerMove:Sr(e.onPointerMove,GA(j=>{r?h.onItemLeave(j):(h.onItemEnter(j),j.defaultPrevented||j.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Sr(e.onPointerLeave,GA(j=>h.onItemLeave(j))),onFocus:Sr(e.onFocus,()=>C(!0)),onBlur:Sr(e.onBlur,()=>C(!1))})})})}),cIe="MenuCheckboxItem",kie=L.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...a}=e;return v.jsx(Die,{scope:e.__scopeMenu,checked:n,children:v.jsx(lI,{role:"menuitemcheckbox","aria-checked":fk(n)?"mixed":n,...a,ref:t,"data-state":H6(n),onSelect:Sr(a.onSelect,()=>r==null?void 0:r(fk(n)?!0:!n),{checkForDefaultPrevented:!1})})})});kie.displayName=cIe;var Iie="MenuRadioGroup",[uIe,dIe]=Nx(Iie,{value:void 0,onValueChange:()=>{}}),Nie=L.forwardRef((e,t)=>{const{value:n,onValueChange:r,...a}=e,l=ll(r);return v.jsx(uIe,{scope:e.__scopeMenu,value:n,onValueChange:l,children:v.jsx(q6,{...a,ref:t})})});Nie.displayName=Iie;var Mie="MenuRadioItem",Lie=L.forwardRef((e,t)=>{const{value:n,...r}=e,a=dIe(Mie,e.__scopeMenu),l=n===a.value;return v.jsx(Die,{scope:e.__scopeMenu,checked:l,children:v.jsx(lI,{role:"menuitemradio","aria-checked":l,...r,ref:t,"data-state":H6(l),onSelect:Sr(r.onSelect,()=>{var h;return(h=a.onValueChange)==null?void 0:h.call(a,n)},{checkForDefaultPrevented:!1})})})});Lie.displayName=Mie;var G6="MenuItemIndicator",[Die,hIe]=Nx(G6,{checked:!1}),Rie=L.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...a}=e,l=hIe(G6,n);return v.jsx(hd,{present:r||fk(l.checked)||l.checked===!0,children:v.jsx(Ei.span,{...a,ref:t,"data-state":H6(l.checked)})})});Rie.displayName=G6;var fIe="MenuSeparator",jie=L.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return v.jsx(Ei.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});jie.displayName=fIe;var pIe="MenuArrow",Oie=L.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=oI(n);return v.jsx(FF,{...a,...r,ref:t})});Oie.displayName=pIe;var mIe="MenuSub",[zXe,Fie]=Nx(mIe),NS="MenuSubTrigger",zie=L.forwardRef((e,t)=>{const n=Mx(NS,e.__scopeMenu),r=V5(NS,e.__scopeMenu),a=Fie(NS,e.__scopeMenu),l=V6(NS,e.__scopeMenu),h=L.useRef(null),{pointerGraceTimerRef:i,onPointerGraceIntentChange:y}=l,x={__scopeMenu:e.__scopeMenu},w=L.useCallback(()=>{h.current&&window.clearTimeout(h.current),h.current=null},[]);return L.useEffect(()=>w,[w]),L.useEffect(()=>{const C=i.current;return()=>{window.clearTimeout(C),y(null)}},[i,y]),v.jsx(B6,{asChild:!0,...x,children:v.jsx(Pie,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":Vie(n.open),...e,ref:k3(t,a.onTriggerChange),onClick:C=>{var P;(P=e.onClick)==null||P.call(e,C),!(e.disabled||C.defaultPrevented)&&(C.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Sr(e.onPointerMove,GA(C=>{l.onItemEnter(C),!C.defaultPrevented&&!e.disabled&&!n.open&&!h.current&&(l.onPointerGraceIntentChange(null),h.current=window.setTimeout(()=>{n.onOpenChange(!0),w()},100))})),onPointerLeave:Sr(e.onPointerLeave,GA(C=>{var E,j;w();const P=(E=n.content)==null?void 0:E.getBoundingClientRect();if(P){const D=(j=n.content)==null?void 0:j.dataset.side,B=D==="right",F=B?-5:5,$=P[B?"left":"right"],H=P[B?"right":"left"];l.onPointerGraceIntentChange({area:[{x:C.clientX+F,y:C.clientY},{x:$,y:P.top},{x:H,y:P.top},{x:H,y:P.bottom},{x:$,y:P.bottom}],side:D}),window.clearTimeout(i.current),i.current=window.setTimeout(()=>l.onPointerGraceIntentChange(null),300)}else{if(l.onTriggerLeave(C),C.defaultPrevented)return;l.onPointerGraceIntentChange(null)}})),onKeyDown:Sr(e.onKeyDown,C=>{var E;const P=l.searchRef.current!=="";e.disabled||P&&C.key===" "||K3e[r.dir].includes(C.key)&&(n.onOpenChange(!0),(E=n.content)==null||E.focus(),C.preventDefault())})})})});zie.displayName=NS;var Bie="MenuSubContent",Uie=L.forwardRef((e,t)=>{const n=Aie(_f,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,l=Mx(_f,e.__scopeMenu),h=V5(_f,e.__scopeMenu),i=Fie(Bie,e.__scopeMenu),y=L.useRef(null),x=_s(t,y);return v.jsx(qA.Provider,{scope:e.__scopeMenu,children:v.jsx(hd,{present:r||l.open,children:v.jsx(qA.Slot,{scope:e.__scopeMenu,children:v.jsx($6,{id:i.contentId,"aria-labelledby":i.triggerId,...a,ref:x,align:"start",side:h.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:w=>{var C;h.isUsingKeyboardRef.current&&((C=y.current)==null||C.focus()),w.preventDefault()},onCloseAutoFocus:w=>w.preventDefault(),onFocusOutside:Sr(e.onFocusOutside,w=>{w.target!==i.trigger&&l.onOpenChange(!1)}),onEscapeKeyDown:Sr(e.onEscapeKeyDown,w=>{h.onClose(),w.preventDefault()}),onKeyDown:Sr(e.onKeyDown,w=>{var E;const C=w.currentTarget.contains(w.target),P=Y3e[h.dir].includes(w.key);C&&P&&(l.onOpenChange(!1),(E=i.trigger)==null||E.focus(),w.preventDefault())})})})})})});Uie.displayName=Bie;function Vie(e){return e?"open":"closed"}function fk(e){return e==="indeterminate"}function H6(e){return fk(e)?"indeterminate":e?"checked":"unchecked"}function gIe(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function yIe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function vIe(e,t,n){const a=t.length>1&&Array.from(t).every(x=>x===t[0])?t[0]:t,l=n?e.indexOf(n):-1;let h=yIe(e,Math.max(l,0));a.length===1&&(h=h.filter(x=>x!==n));const y=h.find(x=>x.toLowerCase().startsWith(a.toLowerCase()));return y!==n?y:void 0}function _Ie(e,t){const{x:n,y:r}=e;let a=!1;for(let l=0,h=t.length-1;l<t.length;h=l++){const i=t[l],y=t[h],x=i.x,w=i.y,C=y.x,P=y.y;w>r!=P>r&&n<(C-x)*(r-w)/(P-w)+x&&(a=!a)}return a}function xIe(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return _Ie(n,t)}function GA(e){return t=>t.pointerType==="mouse"?e(t):void 0}var bIe=Sie,wIe=B6,SIe=Tie,AIe=Cie,TIe=q6,CIe=Eie,EIe=lI,PIe=kie,kIe=Nie,IIe=Lie,NIe=Rie,MIe=jie,LIe=Oie,DIe=zie,RIe=Uie,cI="DropdownMenu",[jIe,BXe]=dd(cI,[bie]),fd=bie(),[OIe,$ie]=jIe(cI),qie=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:a,defaultOpen:l,onOpenChange:h,modal:i=!0}=e,y=fd(t),x=L.useRef(null),[w,C]=ny({prop:a,defaultProp:l??!1,onChange:h,caller:cI});return v.jsx(OIe,{scope:t,triggerId:bp(),triggerRef:x,contentId:bp(),open:w,onOpenChange:C,onOpenToggle:L.useCallback(()=>C(P=>!P),[C]),modal:i,children:v.jsx(bIe,{...y,open:w,onOpenChange:C,dir:r,modal:i,children:n})})};qie.displayName=cI;var Gie="DropdownMenuTrigger",Hie=L.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...a}=e,l=$ie(Gie,n),h=fd(n);return v.jsx(wIe,{asChild:!0,...h,children:v.jsx(Ei.button,{type:"button",id:l.triggerId,"aria-haspopup":"menu","aria-expanded":l.open,"aria-controls":l.open?l.contentId:void 0,"data-state":l.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:k3(t,l.triggerRef),onPointerDown:Sr(e.onPointerDown,i=>{!r&&i.button===0&&i.ctrlKey===!1&&(l.onOpenToggle(),l.open||i.preventDefault())}),onKeyDown:Sr(e.onKeyDown,i=>{r||(["Enter"," "].includes(i.key)&&l.onOpenToggle(),i.key==="ArrowDown"&&l.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(i.key)&&i.preventDefault())})})})});Hie.displayName=Gie;var FIe="DropdownMenuPortal",Wie=e=>{const{__scopeDropdownMenu:t,...n}=e,r=fd(t);return v.jsx(SIe,{...r,...n})};Wie.displayName=FIe;var Zie="DropdownMenuContent",Kie=L.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=$ie(Zie,n),l=fd(n),h=L.useRef(!1);return v.jsx(AIe,{id:a.contentId,"aria-labelledby":a.triggerId,...l,...r,ref:t,onCloseAutoFocus:Sr(e.onCloseAutoFocus,i=>{var y;h.current||(y=a.triggerRef.current)==null||y.focus(),h.current=!1,i.preventDefault()}),onInteractOutside:Sr(e.onInteractOutside,i=>{const y=i.detail.originalEvent,x=y.button===0&&y.ctrlKey===!0,w=y.button===2||x;(!a.modal||w)&&(h.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Kie.displayName=Zie;var zIe="DropdownMenuGroup",BIe=L.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=fd(n);return v.jsx(TIe,{...a,...r,ref:t})});BIe.displayName=zIe;var UIe="DropdownMenuLabel",Yie=L.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=fd(n);return v.jsx(CIe,{...a,...r,ref:t})});Yie.displayName=UIe;var VIe="DropdownMenuItem",Xie=L.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=fd(n);return v.jsx(EIe,{...a,...r,ref:t})});Xie.displayName=VIe;var $Ie="DropdownMenuCheckboxItem",Jie=L.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=fd(n);return v.jsx(PIe,{...a,...r,ref:t})});Jie.displayName=$Ie;var qIe="DropdownMenuRadioGroup",GIe=L.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=fd(n);return v.jsx(kIe,{...a,...r,ref:t})});GIe.displayName=qIe;var HIe="DropdownMenuRadioItem",Qie=L.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=fd(n);return v.jsx(IIe,{...a,...r,ref:t})});Qie.displayName=HIe;var WIe="DropdownMenuItemIndicator",ese=L.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=fd(n);return v.jsx(NIe,{...a,...r,ref:t})});ese.displayName=WIe;var ZIe="DropdownMenuSeparator",tse=L.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=fd(n);return v.jsx(MIe,{...a,...r,ref:t})});tse.displayName=ZIe;var KIe="DropdownMenuArrow",YIe=L.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=fd(n);return v.jsx(LIe,{...a,...r,ref:t})});YIe.displayName=KIe;var XIe="DropdownMenuSubTrigger",nse=L.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=fd(n);return v.jsx(DIe,{...a,...r,ref:t})});nse.displayName=XIe;var JIe="DropdownMenuSubContent",rse=L.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=fd(n);return v.jsx(RIe,{...a,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});rse.displayName=JIe;var QIe=qie,eNe=Hie,tNe=Wie,ise=Kie,sse=Yie,ase=Xie,ose=Jie,lse=Qie,cse=ese,use=tse,dse=nse,hse=rse;const fse=QIe,pse=eNe,nNe=L.forwardRef(({className:e,inset:t,children:n,...r},a)=>v.jsxs(dse,{ref:a,className:Xn("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",t&&"pl-8",e),...r,children:[n,v.jsx(LQ,{className:"ml-auto h-4 w-4"})]}));nNe.displayName=dse.displayName;const rNe=L.forwardRef(({className:e,...t},n)=>v.jsx(hse,{ref:n,className:Xn("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));rNe.displayName=hse.displayName;const W6=L.forwardRef(({className:e,sideOffset:t=4,...n},r)=>v.jsx(tNe,{children:v.jsx(ise,{ref:r,sideOffset:t,className:Xn("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));W6.displayName=ise.displayName;const Z6=L.forwardRef(({className:e,inset:t,...n},r)=>v.jsx(ase,{ref:r,className:Xn("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t&&"pl-8",e),...n}));Z6.displayName=ase.displayName;const iNe=L.forwardRef(({className:e,children:t,checked:n,...r},a)=>v.jsxs(ose,{ref:a,className:Xn("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),checked:n,...r,children:[v.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:v.jsx(cse,{children:v.jsx(L3,{className:"h-4 w-4"})})}),t]}));iNe.displayName=ose.displayName;const sNe=L.forwardRef(({className:e,children:t,...n},r)=>v.jsxs(lse,{ref:r,className:Xn("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),...n,children:[v.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:v.jsx(cse,{children:v.jsx(K_e,{className:"h-2 w-2 fill-current"})})}),t]}));sNe.displayName=lse.displayName;const ej=L.forwardRef(({className:e,inset:t,...n},r)=>v.jsx(sse,{ref:r,className:Xn("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));ej.displayName=sse.displayName;const K6=L.forwardRef(({className:e,...t},n)=>v.jsx(use,{ref:n,className:Xn("-mx-1 my-1 h-px bg-muted",e),...t}));K6.displayName=use.displayName;function tj(e,[t,n]){return Math.min(n,Math.max(t,e))}function aNe(e,t){return L.useReducer((n,r)=>t[n][r]??n,e)}var Y6="ScrollArea",[mse,UXe]=dd(Y6),[oNe,Pf]=mse(Y6),gse=L.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:r="hover",dir:a,scrollHideDelay:l=600,...h}=e,[i,y]=L.useState(null),[x,w]=L.useState(null),[C,P]=L.useState(null),[E,j]=L.useState(null),[D,B]=L.useState(null),[F,$]=L.useState(0),[H,J]=L.useState(0),[ee,Q]=L.useState(!1),[ne,pe]=L.useState(!1),he=_s(t,fe=>y(fe)),we=M5(a);return v.jsx(oNe,{scope:n,type:r,dir:we,scrollHideDelay:l,scrollArea:i,viewport:x,onViewportChange:w,content:C,onContentChange:P,scrollbarX:E,onScrollbarXChange:j,scrollbarXEnabled:ee,onScrollbarXEnabledChange:Q,scrollbarY:D,onScrollbarYChange:B,scrollbarYEnabled:ne,onScrollbarYEnabledChange:pe,onCornerWidthChange:$,onCornerHeightChange:J,children:v.jsx(Ei.div,{dir:we,...h,ref:he,style:{position:"relative","--radix-scroll-area-corner-width":F+"px","--radix-scroll-area-corner-height":H+"px",...e.style}})})});gse.displayName=Y6;var yse="ScrollAreaViewport",vse=L.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:r,nonce:a,...l}=e,h=Pf(yse,n),i=L.useRef(null),y=_s(t,i,h.onViewportChange);return v.jsxs(v.Fragment,{children:[v.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),v.jsx(Ei.div,{"data-radix-scroll-area-viewport":"",...l,ref:y,style:{overflowX:h.scrollbarXEnabled?"scroll":"hidden",overflowY:h.scrollbarYEnabled?"scroll":"hidden",...e.style},children:v.jsx("div",{ref:h.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});vse.displayName=yse;var Ym="ScrollAreaScrollbar",X6=L.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=Pf(Ym,e.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:h}=a,i=e.orientation==="horizontal";return L.useEffect(()=>(i?l(!0):h(!0),()=>{i?l(!1):h(!1)}),[i,l,h]),a.type==="hover"?v.jsx(lNe,{...r,ref:t,forceMount:n}):a.type==="scroll"?v.jsx(cNe,{...r,ref:t,forceMount:n}):a.type==="auto"?v.jsx(_se,{...r,ref:t,forceMount:n}):a.type==="always"?v.jsx(J6,{...r,ref:t}):null});X6.displayName=Ym;var lNe=L.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=Pf(Ym,e.__scopeScrollArea),[l,h]=L.useState(!1);return L.useEffect(()=>{const i=a.scrollArea;let y=0;if(i){const x=()=>{window.clearTimeout(y),h(!0)},w=()=>{y=window.setTimeout(()=>h(!1),a.scrollHideDelay)};return i.addEventListener("pointerenter",x),i.addEventListener("pointerleave",w),()=>{window.clearTimeout(y),i.removeEventListener("pointerenter",x),i.removeEventListener("pointerleave",w)}}},[a.scrollArea,a.scrollHideDelay]),v.jsx(hd,{present:n||l,children:v.jsx(_se,{"data-state":l?"visible":"hidden",...r,ref:t})})}),cNe=L.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=Pf(Ym,e.__scopeScrollArea),l=e.orientation==="horizontal",h=dI(()=>y("SCROLL_END"),100),[i,y]=aNe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return L.useEffect(()=>{if(i==="idle"){const x=window.setTimeout(()=>y("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(x)}},[i,a.scrollHideDelay,y]),L.useEffect(()=>{const x=a.viewport,w=l?"scrollLeft":"scrollTop";if(x){let C=x[w];const P=()=>{const E=x[w];C!==E&&(y("SCROLL"),h()),C=E};return x.addEventListener("scroll",P),()=>x.removeEventListener("scroll",P)}},[a.viewport,l,y,h]),v.jsx(hd,{present:n||i!=="hidden",children:v.jsx(J6,{"data-state":i==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:Sr(e.onPointerEnter,()=>y("POINTER_ENTER")),onPointerLeave:Sr(e.onPointerLeave,()=>y("POINTER_LEAVE"))})})}),_se=L.forwardRef((e,t)=>{const n=Pf(Ym,e.__scopeScrollArea),{forceMount:r,...a}=e,[l,h]=L.useState(!1),i=e.orientation==="horizontal",y=dI(()=>{if(n.viewport){const x=n.viewport.offsetWidth<n.viewport.scrollWidth,w=n.viewport.offsetHeight<n.viewport.scrollHeight;h(i?x:w)}},10);return ow(n.viewport,y),ow(n.content,y),v.jsx(hd,{present:r||l,children:v.jsx(J6,{"data-state":l?"visible":"hidden",...a,ref:t})})}),J6=L.forwardRef((e,t)=>{const{orientation:n="vertical",...r}=e,a=Pf(Ym,e.__scopeScrollArea),l=L.useRef(null),h=L.useRef(0),[i,y]=L.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),x=Ase(i.viewport,i.content),w={...r,sizes:i,onSizesChange:y,hasThumb:x>0&&x<1,onThumbChange:P=>l.current=P,onThumbPointerUp:()=>h.current=0,onThumbPointerDown:P=>h.current=P};function C(P,E){return mNe(P,h.current,i,E)}return n==="horizontal"?v.jsx(uNe,{...w,ref:t,onThumbPositionChange:()=>{if(a.viewport&&l.current){const P=a.viewport.scrollLeft,E=dH(P,i,a.dir);l.current.style.transform=`translate3d(${E}px, 0, 0)`}},onWheelScroll:P=>{a.viewport&&(a.viewport.scrollLeft=P)},onDragScroll:P=>{a.viewport&&(a.viewport.scrollLeft=C(P,a.dir))}}):n==="vertical"?v.jsx(dNe,{...w,ref:t,onThumbPositionChange:()=>{if(a.viewport&&l.current){const P=a.viewport.scrollTop,E=dH(P,i);l.current.style.transform=`translate3d(0, ${E}px, 0)`}},onWheelScroll:P=>{a.viewport&&(a.viewport.scrollTop=P)},onDragScroll:P=>{a.viewport&&(a.viewport.scrollTop=C(P))}}):null}),uNe=L.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...a}=e,l=Pf(Ym,e.__scopeScrollArea),[h,i]=L.useState(),y=L.useRef(null),x=_s(t,y,l.onScrollbarXChange);return L.useEffect(()=>{y.current&&i(getComputedStyle(y.current))},[y]),v.jsx(bse,{"data-orientation":"horizontal",...a,ref:x,sizes:n,style:{bottom:0,left:l.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:l.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":uI(n)+"px",...e.style},onThumbPointerDown:w=>e.onThumbPointerDown(w.x),onDragScroll:w=>e.onDragScroll(w.x),onWheelScroll:(w,C)=>{if(l.viewport){const P=l.viewport.scrollLeft+w.deltaX;e.onWheelScroll(P),Cse(P,C)&&w.preventDefault()}},onResize:()=>{y.current&&l.viewport&&h&&r({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:y.current.clientWidth,paddingStart:mk(h.paddingLeft),paddingEnd:mk(h.paddingRight)}})}})}),dNe=L.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...a}=e,l=Pf(Ym,e.__scopeScrollArea),[h,i]=L.useState(),y=L.useRef(null),x=_s(t,y,l.onScrollbarYChange);return L.useEffect(()=>{y.current&&i(getComputedStyle(y.current))},[y]),v.jsx(bse,{"data-orientation":"vertical",...a,ref:x,sizes:n,style:{top:0,right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":uI(n)+"px",...e.style},onThumbPointerDown:w=>e.onThumbPointerDown(w.y),onDragScroll:w=>e.onDragScroll(w.y),onWheelScroll:(w,C)=>{if(l.viewport){const P=l.viewport.scrollTop+w.deltaY;e.onWheelScroll(P),Cse(P,C)&&w.preventDefault()}},onResize:()=>{y.current&&l.viewport&&h&&r({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:y.current.clientHeight,paddingStart:mk(h.paddingTop),paddingEnd:mk(h.paddingBottom)}})}})}),[hNe,xse]=mse(Ym),bse=L.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:a,onThumbChange:l,onThumbPointerUp:h,onThumbPointerDown:i,onThumbPositionChange:y,onDragScroll:x,onWheelScroll:w,onResize:C,...P}=e,E=Pf(Ym,n),[j,D]=L.useState(null),B=_s(t,he=>D(he)),F=L.useRef(null),$=L.useRef(""),H=E.viewport,J=r.content-r.viewport,ee=ll(w),Q=ll(y),ne=dI(C,10);function pe(he){if(F.current){const we=he.clientX-F.current.left,fe=he.clientY-F.current.top;x({x:we,y:fe})}}return L.useEffect(()=>{const he=we=>{const fe=we.target;(j==null?void 0:j.contains(fe))&&ee(we,J)};return document.addEventListener("wheel",he,{passive:!1}),()=>document.removeEventListener("wheel",he,{passive:!1})},[H,j,J,ee]),L.useEffect(Q,[r,Q]),ow(j,ne),ow(E.content,ne),v.jsx(hNe,{scope:n,scrollbar:j,hasThumb:a,onThumbChange:ll(l),onThumbPointerUp:ll(h),onThumbPositionChange:Q,onThumbPointerDown:ll(i),children:v.jsx(Ei.div,{...P,ref:B,style:{position:"absolute",...P.style},onPointerDown:Sr(e.onPointerDown,he=>{he.button===0&&(he.target.setPointerCapture(he.pointerId),F.current=j.getBoundingClientRect(),$.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",E.viewport&&(E.viewport.style.scrollBehavior="auto"),pe(he))}),onPointerMove:Sr(e.onPointerMove,pe),onPointerUp:Sr(e.onPointerUp,he=>{const we=he.target;we.hasPointerCapture(he.pointerId)&&we.releasePointerCapture(he.pointerId),document.body.style.webkitUserSelect=$.current,E.viewport&&(E.viewport.style.scrollBehavior=""),F.current=null})})})}),pk="ScrollAreaThumb",wse=L.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=xse(pk,e.__scopeScrollArea);return v.jsx(hd,{present:n||a.hasThumb,children:v.jsx(fNe,{ref:t,...r})})}),fNe=L.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:r,...a}=e,l=Pf(pk,n),h=xse(pk,n),{onThumbPositionChange:i}=h,y=_s(t,C=>h.onThumbChange(C)),x=L.useRef(void 0),w=dI(()=>{x.current&&(x.current(),x.current=void 0)},100);return L.useEffect(()=>{const C=l.viewport;if(C){const P=()=>{if(w(),!x.current){const E=gNe(C,i);x.current=E,i()}};return i(),C.addEventListener("scroll",P),()=>C.removeEventListener("scroll",P)}},[l.viewport,w,i]),v.jsx(Ei.div,{"data-state":h.hasThumb?"visible":"hidden",...a,ref:y,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Sr(e.onPointerDownCapture,C=>{const E=C.target.getBoundingClientRect(),j=C.clientX-E.left,D=C.clientY-E.top;h.onThumbPointerDown({x:j,y:D})}),onPointerUp:Sr(e.onPointerUp,h.onThumbPointerUp)})});wse.displayName=pk;var Q6="ScrollAreaCorner",Sse=L.forwardRef((e,t)=>{const n=Pf(Q6,e.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?v.jsx(pNe,{...e,ref:t}):null});Sse.displayName=Q6;var pNe=L.forwardRef((e,t)=>{const{__scopeScrollArea:n,...r}=e,a=Pf(Q6,n),[l,h]=L.useState(0),[i,y]=L.useState(0),x=!!(l&&i);return ow(a.scrollbarX,()=>{var C;const w=((C=a.scrollbarX)==null?void 0:C.offsetHeight)||0;a.onCornerHeightChange(w),y(w)}),ow(a.scrollbarY,()=>{var C;const w=((C=a.scrollbarY)==null?void 0:C.offsetWidth)||0;a.onCornerWidthChange(w),h(w)}),x?v.jsx(Ei.div,{...r,ref:t,style:{width:l,height:i,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function mk(e){return e?parseInt(e,10):0}function Ase(e,t){const n=e/t;return isNaN(n)?0:n}function uI(e){const t=Ase(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-n)*t;return Math.max(r,18)}function mNe(e,t,n,r="ltr"){const a=uI(n),l=a/2,h=t||l,i=a-h,y=n.scrollbar.paddingStart+h,x=n.scrollbar.size-n.scrollbar.paddingEnd-i,w=n.content-n.viewport,C=r==="ltr"?[0,w]:[w*-1,0];return Tse([y,x],C)(e)}function dH(e,t,n="ltr"){const r=uI(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,l=t.scrollbar.size-a,h=t.content-t.viewport,i=l-r,y=n==="ltr"?[0,h]:[h*-1,0],x=tj(e,y);return Tse([0,h],[0,i])(x)}function Tse(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function Cse(e,t){return e>0&&e<t}var gNe=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},r=0;return function a(){const l={left:e.scrollLeft,top:e.scrollTop},h=n.left!==l.left,i=n.top!==l.top;(h||i)&&t(),n=l,r=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(r)};function dI(e,t){const n=ll(e),r=L.useRef(0);return L.useEffect(()=>()=>window.clearTimeout(r.current),[]),L.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,t)},[n,t])}function ow(e,t){const n=ll(t);Sl(()=>{let r=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return a.observe(e),()=>{window.cancelAnimationFrame(r),a.unobserve(e)}}},[e,n])}var Ese=gse,yNe=vse,vNe=Sse;const gk=L.forwardRef(({className:e,children:t,...n},r)=>v.jsxs(Ese,{ref:r,className:Xn("relative overflow-hidden",e),...n,children:[v.jsx(yNe,{className:"h-full w-full rounded-[inherit]",children:t}),v.jsx(Pse,{}),v.jsx(vNe,{})]}));gk.displayName=Ese.displayName;const Pse=L.forwardRef(({className:e,orientation:t="vertical",...n},r)=>v.jsx(X6,{ref:r,orientation:t,className:Xn("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...n,children:v.jsx(wse,{className:"relative flex-1 rounded-full bg-border"})}));Pse.displayName=X6.displayName;function Hc(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function _Ne(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const tE=43200,hH=1440;let xNe={};function bNe(){return xNe}function fH(e){const t=Hc(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function rP(e,t){const n=Hc(e),r=Hc(t),a=n.getTime()-r.getTime();return a<0?-1:a>0?1:a}function wNe(e){return _Ne(e,Date.now())}function SNe(e,t){const n=Hc(e),r=Hc(t),a=n.getFullYear()-r.getFullYear(),l=n.getMonth()-r.getMonth();return a*12+l}function ANe(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function TNe(e,t){return+Hc(e)-+Hc(t)}function CNe(e){const t=Hc(e);return t.setHours(23,59,59,999),t}function ENe(e){const t=Hc(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function PNe(e){const t=Hc(e);return+CNe(t)==+ENe(t)}function kNe(e,t){const n=Hc(e),r=Hc(t),a=rP(n,r),l=Math.abs(SNe(n,r));let h;if(l<1)h=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-a*l);let i=rP(n,r)===-a;PNe(Hc(e))&&l===1&&rP(e,r)===1&&(i=!1),h=a*(l-Number(i))}return h===0?0:h}function INe(e,t,n){const r=TNe(e,t)/1e3;return ANe(n==null?void 0:n.roundingMethod)(r)}const NNe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},MNe=(e,t,n)=>{let r;const a=NNe[e];return typeof a=="string"?r=a:t===1?r=a.one:r=a.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function JL(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const LNe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},DNe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},RNe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},jNe={date:JL({formats:LNe,defaultWidth:"full"}),time:JL({formats:DNe,defaultWidth:"full"}),dateTime:JL({formats:RNe,defaultWidth:"full"})},ONe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},FNe=(e,t,n,r)=>ONe[e];function uS(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const h=e.defaultFormattingWidth||e.defaultWidth,i=n!=null&&n.width?String(n.width):h;a=e.formattingValues[i]||e.formattingValues[h]}else{const h=e.defaultWidth,i=n!=null&&n.width?String(n.width):e.defaultWidth;a=e.values[i]||e.values[h]}const l=e.argumentCallback?e.argumentCallback(t):t;return a[l]}}const zNe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},BNe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},UNe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},VNe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},$Ne={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},qNe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},GNe=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},HNe={ordinalNumber:GNe,era:uS({values:zNe,defaultWidth:"wide"}),quarter:uS({values:BNe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:uS({values:UNe,defaultWidth:"wide"}),day:uS({values:VNe,defaultWidth:"wide"}),dayPeriod:uS({values:$Ne,defaultWidth:"wide",formattingValues:qNe,defaultFormattingWidth:"wide"})};function dS(e){return(t,n={})=>{const r=n.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],l=t.match(a);if(!l)return null;const h=l[0],i=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],y=Array.isArray(i)?ZNe(i,C=>C.test(h)):WNe(i,C=>C.test(h));let x;x=e.valueCallback?e.valueCallback(y):y,x=n.valueCallback?n.valueCallback(x):x;const w=t.slice(h.length);return{value:x,rest:w}}}function WNe(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function ZNe(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function KNe(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const a=r[0],l=t.match(e.parsePattern);if(!l)return null;let h=e.valueCallback?e.valueCallback(l[0]):l[0];h=n.valueCallback?n.valueCallback(h):h;const i=t.slice(a.length);return{value:h,rest:i}}}const YNe=/^(\d+)(th|st|nd|rd)?/i,XNe=/\d+/i,JNe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},QNe={any:[/^b/i,/^(a|c)/i]},eMe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},tMe={any:[/1/i,/2/i,/3/i,/4/i]},nMe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},rMe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},iMe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},sMe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},aMe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},oMe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},lMe={ordinalNumber:KNe({matchPattern:YNe,parsePattern:XNe,valueCallback:e=>parseInt(e,10)}),era:dS({matchPatterns:JNe,defaultMatchWidth:"wide",parsePatterns:QNe,defaultParseWidth:"any"}),quarter:dS({matchPatterns:eMe,defaultMatchWidth:"wide",parsePatterns:tMe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:dS({matchPatterns:nMe,defaultMatchWidth:"wide",parsePatterns:rMe,defaultParseWidth:"any"}),day:dS({matchPatterns:iMe,defaultMatchWidth:"wide",parsePatterns:sMe,defaultParseWidth:"any"}),dayPeriod:dS({matchPatterns:aMe,defaultMatchWidth:"any",parsePatterns:oMe,defaultParseWidth:"any"})},cMe={code:"en-US",formatDistance:MNe,formatLong:jNe,formatRelative:FNe,localize:HNe,match:lMe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function uMe(e,t,n){const r=bNe(),a=(n==null?void 0:n.locale)??r.locale??cMe,l=2520,h=rP(e,t);if(isNaN(h))throw new RangeError("Invalid time value");const i=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:h});let y,x;h>0?(y=Hc(t),x=Hc(e)):(y=Hc(e),x=Hc(t));const w=INe(x,y),C=(fH(x)-fH(y))/1e3,P=Math.round((w-C)/60);let E;if(P<2)return n!=null&&n.includeSeconds?w<5?a.formatDistance("lessThanXSeconds",5,i):w<10?a.formatDistance("lessThanXSeconds",10,i):w<20?a.formatDistance("lessThanXSeconds",20,i):w<40?a.formatDistance("halfAMinute",0,i):w<60?a.formatDistance("lessThanXMinutes",1,i):a.formatDistance("xMinutes",1,i):P===0?a.formatDistance("lessThanXMinutes",1,i):a.formatDistance("xMinutes",P,i);if(P<45)return a.formatDistance("xMinutes",P,i);if(P<90)return a.formatDistance("aboutXHours",1,i);if(P<hH){const j=Math.round(P/60);return a.formatDistance("aboutXHours",j,i)}else{if(P<l)return a.formatDistance("xDays",1,i);if(P<tE){const j=Math.round(P/hH);return a.formatDistance("xDays",j,i)}else if(P<tE*2)return E=Math.round(P/tE),a.formatDistance("aboutXMonths",E,i)}if(E=kNe(x,y),E<12){const j=Math.round(P/tE);return a.formatDistance("xMonths",j,i)}else{const j=E%12,D=Math.trunc(E/12);return j<3?a.formatDistance("aboutXYears",D,i):j<9?a.formatDistance("overXYears",D,i):a.formatDistance("almostXYears",D+1,i)}}function dMe(e,t){return uMe(e,wNe(e),t)}const hMe=e=>{switch(e){case"error":return v.jsx(FP,{className:"w-4 h-4 text-red-500"});case"warning":return v.jsx(Os,{className:"w-4 h-4 text-yellow-500"});case"success":return v.jsx(wl,{className:"w-4 h-4 text-green-500"});case"info":default:return v.jsx(PA,{className:"w-4 h-4 text-blue-500"})}},fMe=e=>{switch(e){case"error":return"border-red-800 bg-red-900/20 hover:border-white hover:ring-2 hover:ring-white";case"warning":return"border-yellow-800 bg-yellow-900/20 hover:border-white hover:ring-2 hover:ring-white";case"success":return"border-green-800 bg-green-900/20 hover:border-white hover:ring-2 hover:ring-white";case"info":default:return"border-blue-800 bg-blue-900/20 hover:border-white hover:ring-2 hover:ring-white"}};function pMe(){const{notifications:e,unreadCount:t,markAsRead:n,markAllAsRead:r,removeNotification:a,clearAllNotifications:l}=E5(),h=x=>{x.read||n(x.id),x.actionUrl&&(window.location.href=x.actionUrl)},i=()=>{r()},y=()=>{l()};return v.jsxs(fse,{children:[v.jsx(pse,{asChild:!0,children:v.jsxs($n,{variant:"ghost",size:"sm",className:"relative",children:[v.jsx(lv,{className:"w-4 h-4"}),t>0&&v.jsx(Is,{variant:"destructive",className:"absolute -top-1 -right-1 w-5 h-5 flex items-center justify-center text-xs",children:t>9?"9+":t})]})}),v.jsxs(W6,{align:"end",className:"w-96 p-0",children:[v.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border/50",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("h3",{className:"font-semibold text-sm",children:"Notifications"}),v.jsxs("p",{className:"text-xs text-muted-foreground",children:[t," unread"]})]}),v.jsxs("div",{className:"flex gap-2",children:[t>0&&v.jsxs($n,{variant:"ghost",size:"sm",onClick:i,className:"h-8 px-3 text-xs hover:bg-green-500/20 hover:text-green-400 border border-green-500/30",children:[v.jsx(L3,{className:"w-3 h-3 mr-1.5"}),"Mark all read"]}),e.length>0&&v.jsxs($n,{variant:"destructive",size:"sm",onClick:y,className:"h-8 px-3 text-xs hover:bg-red-600 hover:text-white border border-red-500/50 bg-red-500/10 text-red-400",children:[v.jsx(cv,{className:"w-3 h-3 mr-1.5"}),"Clear all"]})]})]}),v.jsx(K6,{}),v.jsx(gk,{className:"h-80",children:e.length===0?v.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center px-4",children:[v.jsx(lv,{className:"w-10 h-10 text-muted-foreground mb-3"}),v.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"No notifications"}),v.jsx("p",{className:"text-xs text-muted-foreground",children:"You're all caught up!"})]}):v.jsx("div",{className:"space-y-2 p-2",children:e.map(x=>v.jsx(Z6,{className:`p-4 cursor-pointer transition-all duration-200 rounded-lg border-l-4 ${fMe(x.type)} ${x.read?"bg-background":"font-medium bg-muted/30"}`,onClick:()=>h(x),children:v.jsxs("div",{className:"flex items-start gap-4 w-full",children:[v.jsx("div",{className:"flex-shrink-0 mt-1",children:hMe(x.type)}),v.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[v.jsxs("div",{className:"flex items-start justify-between gap-2",children:[v.jsx("h4",{className:"text-sm font-medium leading-tight",children:x.title}),!x.read&&v.jsx("div",{className:"w-2 h-2 bg-primary rounded-full flex-shrink-0 mt-1.5"})]}),v.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed line-clamp-3",children:x.message}),v.jsxs("div",{className:"flex items-center justify-between pt-1",children:[v.jsx("span",{className:"text-xs text-muted-foreground",children:dMe(x.timestamp,{addSuffix:!0})}),v.jsx(Is,{variant:"secondary",className:"text-xs px-2 py-0.5",children:x.category})]})]}),v.jsx($n,{variant:"ghost",size:"sm",onClick:w=>{w.stopPropagation(),a(x.id)},className:"h-7 w-7 p-0 hover:bg-destructive/10 hover:text-destructive flex-shrink-0",children:v.jsx(cv,{className:"w-3.5 h-3.5"})})]})},x.id))})})]})]})}const mMe=({onClose:e})=>{const[t,n]=L.useState(""),[r,a]=L.useState([]),[l,h]=L.useState(!1),[i,y]=L.useState(!1),x=qF(),w=L.useCallback(async F=>{const $=F.trim();if(!$||$.length<2){a([]),y(!1);return}h(!0);try{const H=[{id:"1",merchant:"Starbucks",amount:5.5,category:"Food & Dining",description:"Coffee",location:"123 Main St",latitude:40.7128,longitude:-74.006,date:"2024-01-15",status:"COMPLETED",isSimulated:!1,createdAt:"2024-01-15T10:30:00Z",updatedAt:"2024-01-15T10:30:00Z"},{id:"2",merchant:"Target",amount:45.99,category:"Shopping",description:"Groceries",location:"456 Oak Ave",latitude:40.7589,longitude:-73.9851,date:"2024-01-14",status:"COMPLETED",isSimulated:!1,createdAt:"2024-01-14T15:20:00Z",updatedAt:"2024-01-14T15:20:00Z"},{id:"3",merchant:"Uber",amount:12.75,category:"Transportation",description:"Ride to downtown",location:"New York, NY",latitude:40.7128,longitude:-74.006,date:"2024-01-13",status:"COMPLETED",isSimulated:!1,createdAt:"2024-01-13T09:15:00Z",updatedAt:"2024-01-13T09:15:00Z"},{id:"4",merchant:"McDonald's",amount:8.99,category:"Food & Dining",description:"Lunch",location:"789 Broadway",latitude:40.7614,longitude:-73.9776,date:"2024-01-12",status:"COMPLETED",isSimulated:!1,createdAt:"2024-01-12T12:45:00Z",updatedAt:"2024-01-12T12:45:00Z"},{id:"5",merchant:"Amazon",amount:29.99,category:"Shopping",description:"Online purchase",location:"Online",latitude:0,longitude:0,date:"2024-01-11",status:"COMPLETED",isSimulated:!1,createdAt:"2024-01-11T20:30:00Z",updatedAt:"2024-01-11T20:30:00Z"},{id:"6",merchant:"Netflix",amount:15.99,category:"Entertainment",description:"Monthly subscription",location:"Online",latitude:0,longitude:0,date:"2024-01-10",status:"COMPLETED",isSimulated:!1,createdAt:"2024-01-10T00:00:00Z",updatedAt:"2024-01-10T00:00:00Z"},{id:"7",merchant:"Spotify",amount:9.99,category:"Entertainment",description:"Premium subscription",location:"Online",latitude:0,longitude:0,date:"2024-01-09",status:"COMPLETED",isSimulated:!1,createdAt:"2024-01-09T00:00:00Z",updatedAt:"2024-01-09T00:00:00Z"},{id:"8",merchant:"Apple",amount:99.99,category:"Shopping",description:"App Store purchase",location:"Online",latitude:0,longitude:0,date:"2024-01-08",status:"COMPLETED",isSimulated:!1,createdAt:"2024-01-08T14:30:00Z",updatedAt:"2024-01-08T14:30:00Z"},{id:"9",merchant:"Google",amount:2.99,category:"Entertainment",description:"Google Play purchase",location:"Online",latitude:0,longitude:0,date:"2024-01-07",status:"COMPLETED",isSimulated:!1,createdAt:"2024-01-07T16:45:00Z",updatedAt:"2024-01-07T16:45:00Z"},{id:"10",merchant:"Microsoft",amount:12.99,category:"Shopping",description:"Office 365 subscription",location:"Online",latitude:0,longitude:0,date:"2024-01-06",status:"COMPLETED",isSimulated:!1,createdAt:"2024-01-06T09:20:00Z",updatedAt:"2024-01-06T09:20:00Z"}],J=[{id:"merchant-1",name:"Starbucks",address:"123 Main St, New York, NY",totalSpent:55.5,visits:10,category:"Food & Dining",coordinates:{lat:40.7128,lng:-74.006},averageSpent:5.55,pricingLevel:"medium"},{id:"merchant-2",name:"Target",address:"456 Oak Ave, New York, NY",totalSpent:459.9,visits:8,category:"Shopping",coordinates:{lat:40.7589,lng:-73.9851},averageSpent:57.49,pricingLevel:"medium"},{id:"merchant-3",name:"Whole Foods",address:"789 Pine St, New York, NY",totalSpent:320.25,visits:6,category:"Grocery",coordinates:{lat:40.7505,lng:-73.9934},averageSpent:53.38,pricingLevel:"high"},{id:"merchant-4",name:"McDonald's",address:"789 Broadway, New York, NY",totalSpent:89.9,visits:15,category:"Food & Dining",coordinates:{lat:40.7614,lng:-73.9776},averageSpent:5.99,pricingLevel:"low"},{id:"merchant-5",name:"Walmart",address:"321 Commerce St, New York, NY",totalSpent:280.75,visits:5,category:"Shopping",coordinates:{lat:40.7505,lng:-73.9934},averageSpent:56.15,pricingLevel:"low"},{id:"merchant-6",name:"Netflix",address:"Online Service",totalSpent:15.99,visits:1,category:"Entertainment",coordinates:{lat:0,lng:0},averageSpent:15.99,pricingLevel:"low"},{id:"merchant-7",name:"Spotify",address:"Online Service",totalSpent:9.99,visits:1,category:"Entertainment",coordinates:{lat:0,lng:0},averageSpent:9.99,pricingLevel:"low"},{id:"merchant-8",name:"Apple",address:"Online Store",totalSpent:99.99,visits:1,category:"Shopping",coordinates:{lat:0,lng:0},averageSpent:99.99,pricingLevel:"high"},{id:"merchant-9",name:"Google",address:"Online Service",totalSpent:2.99,visits:1,category:"Entertainment",coordinates:{lat:0,lng:0},averageSpent:2.99,pricingLevel:"low"},{id:"merchant-10",name:"Microsoft",address:"Online Service",totalSpent:12.99,visits:1,category:"Shopping",coordinates:{lat:0,lng:0},averageSpent:12.99,pricingLevel:"low"}],ee=[];H.forEach(ne=>{const pe=C(ne.merchant,$),he=C(ne.category,$)*.5,we=C(ne.location||"",$)*.3,fe=pe+he+we;fe>0&&ee.push({type:"transaction",data:ne,relevanceScore:fe})}),J.forEach(ne=>{const pe=C(ne.name,$),he=C(ne.category,$)*.3,we=C(ne.address,$)*.2,fe=pe+he+we;fe>0&&ee.push({type:"merchant",data:ne,relevanceScore:fe})}),ee.sort((ne,pe)=>pe.relevanceScore-ne.relevanceScore);const Q=ee.slice(0,10);a(Q),y(!0)}catch(H){console.error("Search error:",H),a([]),y(!1)}finally{h(!1)}},[]);L.useEffect(()=>{const F=setTimeout(()=>{t.trim().length>=2?w(t):(a([]),y(!1))},100);return()=>clearTimeout(F)},[t,w]);const C=(F,$)=>{const H=F.toLowerCase(),J=$.toLowerCase();if(H.includes(J))return H===J?10:H.startsWith(J)?8:5;const ee=H.split(/\s+/);for(const Q of ee){if(Q.startsWith(J))return 6;if(Q.includes(J))return 3}if(J.length>=2){let Q=0,ne=0;for(;Q<H.length&&ne<J.length;)H[Q]===J[ne]&&ne++,Q++;if(ne===J.length)return 2}return 0},P=F=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(F),E=F=>new Date(F).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),j=F=>{switch(F){case"low":return"bg-green-100 text-green-800 border-green-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"high":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},D=F=>{n(""),a([]),y(!1),F.type==="transaction"?x(`/transactions?id=${F.data.id}`):x(`/map?merchant=${F.data.id}`)},B=()=>{n(""),a([]),y(!1)};return v.jsxs("div",{className:"w-full max-w-4xl mx-auto",children:[v.jsxs("div",{className:"relative mb-4",children:[v.jsx(gb,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),v.jsx(ss,{placeholder:"Search transactions, merchants...",value:t,onChange:F=>n(F.target.value),className:"pl-10 pr-20"}),t&&v.jsx($n,{variant:"ghost",size:"sm",onClick:B,className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0",children:v.jsx(cv,{className:"w-4 h-4"})})]}),i&&v.jsxs("div",{className:"bg-card border border-border rounded-lg shadow-lg max-h-96 overflow-y-auto",children:[l&&v.jsx("div",{className:"flex items-center justify-center py-6",children:v.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"})}),!l&&r.length===0&&t&&t.trim().length>=2&&v.jsxs("div",{className:"p-4 text-center text-muted-foreground",children:['No results found for "',t,'"']}),!l&&r.length>0&&v.jsxs("div",{className:"p-2",children:[r.filter(F=>F.type==="transaction").length>0&&v.jsxs("div",{className:"mb-4",children:[v.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-2 px-2",children:"Recent Transactions"}),v.jsx("div",{className:"space-y-1",children:r.filter(F=>F.type==="transaction").map((F,$)=>{const H=F.data;return v.jsxs("div",{onClick:()=>D(F),className:"flex items-center gap-3 p-3 rounded-md hover:bg-muted cursor-pointer transition-colors",children:[v.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center",children:v.jsx(Tu,{className:"w-4 h-4 text-primary"})}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"font-medium truncate",children:H.merchant}),v.jsx(Is,{variant:"outline",className:"text-xs",children:H.category})]}),v.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[v.jsx(EA,{className:"w-3 h-3"}),v.jsx("span",{children:E(H.date)}),v.jsx(od,{className:"w-3 h-3"}),v.jsx("span",{className:"truncate",children:H.location})]})]}),v.jsx("span",{className:"font-semibold text-right",children:P(H.amount)})]},`transaction-${H.id}-${$}`)})})]}),r.filter(F=>F.type==="merchant").length>0&&v.jsxs("div",{children:[v.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-2 px-2",children:"Merchants"}),v.jsx("div",{className:"space-y-1",children:r.filter(F=>F.type==="merchant").map((F,$)=>{const H=F.data;return v.jsxs("div",{onClick:()=>D(F),className:"flex items-center gap-3 p-3 rounded-md hover:bg-muted cursor-pointer transition-colors",children:[v.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-secondary rounded-full flex items-center justify-center",children:v.jsx(NQ,{className:"w-4 h-4 text-secondary-foreground"})}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"font-medium truncate",children:H.name}),v.jsx(Is,{className:`text-xs capitalize ${j(H.pricingLevel)}`,children:H.pricingLevel})]}),v.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[v.jsx(od,{className:"w-3 h-3"}),v.jsx("span",{className:"truncate",children:H.address})]})]}),v.jsxs("span",{className:"font-semibold text-right",children:[P(H.averageSpent)," avg."]})]},`merchant-${H.id}-${$}`)})})]})]})]})]})};function gMe(){const{user:e,logout:t}=W3(),[n,r]=L.useState(!1);return L.useEffect(()=>{const a=l=>{(l.metaKey||l.ctrlKey)&&l.key==="k"&&(l.preventDefault(),r(!n))};return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[n]),v.jsx(uie,{defaultOpen:!0,children:v.jsxs("div",{className:"min-h-screen flex w-full bg-background",children:[v.jsx(G3e,{}),v.jsxs("div",{className:"flex-1 flex flex-col min-h-screen",children:[v.jsxs("header",{className:"bg-card border-b border-border px-4 sm:px-6 lg:px-8 py-4 flex items-center gap-3 sm:gap-4",children:[v.jsx(hie,{}),v.jsx("div",{className:"flex-1 max-w-md",children:v.jsxs($n,{variant:"outline",onClick:()=>r(!n),className:"w-full justify-start text-muted-foreground",children:[v.jsx(gb,{className:"mr-2 h-4 w-4"}),"Search transactions, merchants...",v.jsxs("kbd",{className:"ml-auto hidden h-5 select-none items-center gap-1 rounded border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100 sm:flex",children:[v.jsx("span",{className:"text-xs",children:""}),"K"]})]})}),v.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[v.jsx(pMe,{}),v.jsxs(fse,{children:[v.jsx(pse,{asChild:!0,children:v.jsx($n,{variant:"ghost",size:"sm",children:v.jsx(UQ,{className:"w-4 h-4"})})}),v.jsxs(W6,{align:"end",className:"w-56",children:[v.jsx(ej,{children:e?`${e.firstName} ${e.lastName}`:"User"}),v.jsx(ej,{className:"text-xs text-muted-foreground",children:e==null?void 0:e.email}),v.jsx(K6,{}),v.jsxs(Z6,{onClick:t,children:[v.jsx(nxe,{className:"mr-2 h-4 w-4"}),v.jsx("span",{children:"Log out"})]})]})]})]})]}),n&&v.jsx("div",{className:"bg-muted/50 border-b border-border p-4",children:v.jsx(mMe,{onClose:()=>r(!1)})}),v.jsx("main",{className:"flex-1 bg-background p-4 sm:p-6 lg:p-8 xl:p-10 max-w-none",children:v.jsx("div",{className:"max-w-7xl mx-auto",children:v.jsx(F2e,{})})})]})]})})}function nE({title:e,value:t,change:n,changeType:r="neutral",icon:a,variant:l="default",className:h}){const i={default:"card-gradient",primary:"card-primary",success:"card-success",warning:"bg-warning text-warning-foreground",danger:"bg-danger text-danger-foreground"},y={positive:"text-success-high-contrast",negative:"text-danger",neutral:"text-muted-foreground"};return v.jsx(xr,{className:Xn("stats-card",i[l],h),children:v.jsx(br,{className:"p-3 sm:p-4 lg:p-6",children:v.jsxs("div",{className:"flex items-start justify-between gap-2 sm:gap-3",children:[v.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden pr-4",children:[v.jsx("p",{className:"font-medium opacity-80 mb-1",children:e}),v.jsxs("div",{className:"flex flex-col gap-0.5",children:[v.jsx("h3",{className:"font-bold",children:t}),n&&v.jsx("span",{className:Xn("font-medium text-lg",y[r]),children:n})]})]}),v.jsx("div",{className:"p-1.5 sm:p-2 lg:p-3 rounded-lg bg-white/10 backdrop-blur-sm flex-shrink-0 ml-4",children:v.jsx("div",{className:"w-4 h-4 xs:w-5 xs:h-5 sm:w-6 sm:h-6",children:a})})]})})})}const yMe=e=>{const t=e.toLowerCase();return t.includes("netflix")?{icon:"",bgColor:"bg-red-500",textColor:"text-white"}:t.includes("starbucks")||t.includes("starbucks coffee")?{icon:"",bgColor:"bg-green-600",textColor:"text-white"}:t.includes("amazon")?{icon:"",bgColor:"bg-orange-500",textColor:"text-white"}:t.includes("mcdonald")||t.includes("mcdonalds")?{icon:"",bgColor:"bg-yellow-500",textColor:"text-white"}:t.includes("uber")||t.includes("lyft")?{icon:"",bgColor:"bg-black",textColor:"text-white"}:t.includes("spotify")?{icon:"",bgColor:"bg-green-500",textColor:"text-white"}:t.includes("apple")||t.includes("app store")?{icon:"",bgColor:"bg-gray-800",textColor:"text-white"}:t.includes("google")||t.includes("google play")?{icon:"",bgColor:"bg-blue-500",textColor:"text-white"}:t.includes("shell")||t.includes("gas")?{icon:"",bgColor:"bg-yellow-400",textColor:"text-black"}:t.includes("target")?{icon:"",bgColor:"bg-red-600",textColor:"text-white"}:t.includes("walmart")?{icon:"",bgColor:"bg-blue-600",textColor:"text-white"}:t.includes("kroger")?{icon:"",bgColor:"bg-red-700",textColor:"text-white"}:t.includes("taco bell")||t.includes("tacobell")?{icon:"",bgColor:"bg-purple-600",textColor:"text-white"}:t.includes("subway")?{icon:"",bgColor:"bg-green-600",textColor:"text-white"}:t.includes("kfc")||t.includes("kentucky fried chicken")?{icon:"",bgColor:"bg-red-600",textColor:"text-white"}:t.includes("pizza hut")||t.includes("pizzahut")?{icon:"",bgColor:"bg-red-500",textColor:"text-white"}:t.includes("domino")||t.includes("dominos")?{icon:"",bgColor:"bg-blue-600",textColor:"text-white"}:t.includes("chipotle")?{icon:"",bgColor:"bg-orange-600",textColor:"text-white"}:t.includes("panera")||t.includes("panera bread")?{icon:"",bgColor:"bg-yellow-600",textColor:"text-white"}:t.includes("chick-fil-a")||t.includes("chickfila")?{icon:"",bgColor:"bg-red-500",textColor:"text-white"}:t.includes("wendy")?{icon:"",bgColor:"bg-red-600",textColor:"text-white"}:t.includes("burger king")||t.includes("burgerking")?{icon:"",bgColor:"bg-yellow-500",textColor:"text-black"}:t.includes("whole foods")||t.includes("wholefoods")?{icon:"",bgColor:"bg-green-600",textColor:"text-white"}:t.includes("safeway")?{icon:"",bgColor:"bg-red-600",textColor:"text-white"}:t.includes("costco")?{icon:"",bgColor:"bg-red-500",textColor:"text-white"}:t.includes("trader joe")||t.includes("traderjoe")?{icon:"",bgColor:"bg-green-500",textColor:"text-white"}:t.includes("exxon")||t.includes("mobil")?{icon:"",bgColor:"bg-red-600",textColor:"text-white"}:t.includes("bp")||t.includes("british petroleum")?{icon:"",bgColor:"bg-green-600",textColor:"text-white"}:t.includes("chevron")?{icon:"",bgColor:"bg-blue-600",textColor:"text-white"}:t.includes("hulu")?{icon:"",bgColor:"bg-green-500",textColor:"text-white"}:t.includes("disney")||t.includes("disney+")?{icon:"",bgColor:"bg-blue-600",textColor:"text-white"}:t.includes("hbo")||t.includes("max")?{icon:"",bgColor:"bg-purple-600",textColor:"text-white"}:t.includes("youtube")||t.includes("youtube premium")?{icon:"",bgColor:"bg-red-600",textColor:"text-white"}:t.includes("delta")?{icon:"",bgColor:"bg-blue-600",textColor:"text-white"}:t.includes("american airlines")||t.includes("americanairlines")?{icon:"",bgColor:"bg-blue-500",textColor:"text-white"}:t.includes("southwest")?{icon:"",bgColor:"bg-orange-500",textColor:"text-white"}:t.includes("amtrak")?{icon:"",bgColor:"bg-blue-700",textColor:"text-white"}:t.includes("best buy")||t.includes("bestbuy")?{icon:"",bgColor:"bg-yellow-500",textColor:"text-black"}:t.includes("home depot")||t.includes("homedepot")?{icon:"",bgColor:"bg-orange-600",textColor:"text-white"}:t.includes("lowes")?{icon:"",bgColor:"bg-blue-600",textColor:"text-white"}:t.includes("ikea")?{icon:"",bgColor:"bg-yellow-500",textColor:"text-black"}:t.includes("nike")?{icon:"",bgColor:"bg-black",textColor:"text-white"}:t.includes("adidas")?{icon:"",bgColor:"bg-black",textColor:"text-white"}:t.includes("regal")||t.includes("regal cinemas")?{icon:"",bgColor:"bg-blue-700",textColor:"text-white"}:t.includes("amc")||t.includes("amc theaters")?{icon:"",bgColor:"bg-red-700",textColor:"text-white"}:t.includes("cinemark")?{icon:"",bgColor:"bg-indigo-700",textColor:"text-white"}:t.includes("imax")?{icon:"",bgColor:"bg-purple-700",textColor:"text-white"}:t.includes("virginia tech")||t.includes("vt")||t.includes("vtech")?{icon:"",bgColor:"bg-orange-700",textColor:"text-white"}:t.includes("university")||t.includes("college")||t.includes("school")?{icon:"",bgColor:"bg-blue-800",textColor:"text-white"}:t.includes("library")?{icon:"",bgColor:"bg-yellow-700",textColor:"text-white"}:t.includes("bookstore")||t.includes("campus store")?{icon:"",bgColor:"bg-green-700",textColor:"text-white"}:t.includes("dining hall")||t.includes("cafeteria")||t.includes("dining commons")?{icon:"",bgColor:"bg-orange-600",textColor:"text-white"}:t.includes("electric")||t.includes("power")||t.includes("energy")||t.includes("duke energy")||t.includes("dominion")?{icon:"",bgColor:"bg-yellow-500",textColor:"text-black"}:t.includes("water")||t.includes("sewer")?{icon:"",bgColor:"bg-blue-500",textColor:"text-white"}:t.includes("gas")||t.includes("natural gas")?{icon:"",bgColor:"bg-orange-500",textColor:"text-white"}:t.includes("internet")||t.includes("wifi")||t.includes("comcast")||t.includes("verizon")?{icon:"",bgColor:"bg-blue-600",textColor:"text-white"}:t.includes("phone")||t.includes("cellular")||t.includes("at&t")||t.includes("t-mobile")?{icon:"",bgColor:"bg-purple-600",textColor:"text-white"}:null},vMe=e=>{switch(e.toLowerCase()){case"food & dining":case"dining":return vF;case"shopping":return S5;case"transportation":case"transport":return gF;case"utilities":return _F;case"entertainment":return cx;case"gaming":return txe;case"maintenance":return pxe;default:return VQ}};function _Me(){const{data:e,isLoading:t}=WSe({limit:5}),n=(e==null?void 0:e.transactions)||[];return t?v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:["Recent Transactions",v.jsx(Is,{variant:"secondary",className:"ml-auto",children:v.jsx(Jl,{className:"h-4 w-6"})})]})}),v.jsx(br,{children:v.jsx(gk,{className:"h-[300px]",children:v.jsx("div",{className:"space-y-4",children:[...Array(5)].map((r,a)=>v.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/20",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Jl,{className:"h-8 w-8 rounded-lg"}),v.jsxs("div",{children:[v.jsx(Jl,{className:"h-4 w-24 mb-1"}),v.jsx(Jl,{className:"h-3 w-16"})]})]}),v.jsxs("div",{className:"text-right",children:[v.jsx(Jl,{className:"h-4 w-16 mb-1"}),v.jsx(Jl,{className:"h-3 w-12"})]})]},a))})})})]}):v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:["Recent Transactions",v.jsx(Is,{variant:"secondary",className:"ml-auto",children:n.length})]})}),v.jsx(br,{children:v.jsx(gk,{className:"h-[300px]",children:v.jsx("div",{className:"space-y-4",children:n.length===0?v.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[v.jsx("p",{children:"No transactions yet"}),v.jsx("p",{className:"text-sm",children:"Start by adding your first transaction"})]}):n.map(r=>{const a=yMe(r.merchant),l=vMe(r.category),h=r.amount>0;return v.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/20 hover:bg-muted/30 transition-colors",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[a?v.jsx("div",{className:`p-2 rounded-lg ${a.bgColor} ${a.textColor} flex items-center justify-center w-8 h-8`,children:v.jsx("span",{className:"text-lg",children:a.icon})}):v.jsx("div",{className:`p-2 rounded-lg ${h?"bg-success/10 text-success":"bg-primary/10 text-primary"}`,children:v.jsx(l,{className:"w-4 h-4"})}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-sm",children:r.merchant}),v.jsx("p",{className:"text-xs text-muted-foreground",children:r.category})]})]}),v.jsxs("div",{className:"text-right",children:[v.jsxs("p",{className:`font-semibold ${h?"text-success":"text-foreground"}`,children:[h?"+":"","$",Math.abs(r.amount).toFixed(2)]}),v.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(r.date).toLocaleDateString()})]})]},r.id)})})})})]})}var hI={},kse={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==="__proto__"}e.isUnsafeProperty=t})(kse);var ez={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){switch(typeof n){case"number":case"symbol":return!1;case"string":return n.includes(".")||n.includes("[")||n.includes("]")}}e.isDeepKey=t})(ez);var tz={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){var r;return typeof n=="string"||typeof n=="symbol"?n:Object.is((r=n==null?void 0:n.valueOf)==null?void 0:r.call(n),-0)?"-0":String(n)}e.toKey=t})(tz);var fI={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){const r=[],a=n.length;if(a===0)return r;let l=0,h="",i="",y=!1;for(n.charCodeAt(0)===46&&(r.push(""),l++);l<a;){const x=n[l];i?x==="\\"&&l+1<a?(l++,h+=n[l]):x===i?i="":h+=x:y?x==='"'||x==="'"?i=x:x==="]"?(y=!1,r.push(h),h=""):h+=x:x==="["?(y=!0,h&&(r.push(h),h="")):x==="."?h&&(r.push(h),h=""):h+=x,l++}return h&&r.push(h),r}e.toPath=t})(fI);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kse,n=ez,r=tz,a=fI;function l(i,y,x){if(i==null)return x;switch(typeof y){case"string":{if(t.isUnsafeProperty(y))return x;const w=i[y];return w===void 0?n.isDeepKey(y)?l(i,a.toPath(y),x):x:w}case"number":case"symbol":{typeof y=="number"&&(y=r.toKey(y));const w=i[y];return w===void 0?x:w}default:{if(Array.isArray(y))return h(i,y,x);if(Object.is(y==null?void 0:y.valueOf(),-0)?y="-0":y=String(y),t.isUnsafeProperty(y))return x;const w=i[y];return w===void 0?x:w}}}function h(i,y,x){if(y.length===0)return x;let w=i;for(let C=0;C<y.length;C++){if(w==null||t.isUnsafeProperty(y[C]))return x;w=w[y[C]]}return w===void 0?x:w}e.get=l})(hI);var xMe=hI.get;const mx=Ip(xMe);var Ise={exports:{}},Xa={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nz=Symbol.for("react.transitional.element"),rz=Symbol.for("react.portal"),pI=Symbol.for("react.fragment"),mI=Symbol.for("react.strict_mode"),gI=Symbol.for("react.profiler"),yI=Symbol.for("react.consumer"),vI=Symbol.for("react.context"),_I=Symbol.for("react.forward_ref"),xI=Symbol.for("react.suspense"),bI=Symbol.for("react.suspense_list"),wI=Symbol.for("react.memo"),SI=Symbol.for("react.lazy"),bMe=Symbol.for("react.view_transition"),wMe=Symbol.for("react.client.reference");function kf(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case nz:switch(e=e.type,e){case pI:case gI:case mI:case xI:case bI:case bMe:return e;default:switch(e=e&&e.$$typeof,e){case vI:case _I:case SI:case wI:return e;case yI:return e;default:return t}}case rz:return t}}}Xa.ContextConsumer=yI;Xa.ContextProvider=vI;Xa.Element=nz;Xa.ForwardRef=_I;Xa.Fragment=pI;Xa.Lazy=SI;Xa.Memo=wI;Xa.Portal=rz;Xa.Profiler=gI;Xa.StrictMode=mI;Xa.Suspense=xI;Xa.SuspenseList=bI;Xa.isContextConsumer=function(e){return kf(e)===yI};Xa.isContextProvider=function(e){return kf(e)===vI};Xa.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===nz};Xa.isForwardRef=function(e){return kf(e)===_I};Xa.isFragment=function(e){return kf(e)===pI};Xa.isLazy=function(e){return kf(e)===SI};Xa.isMemo=function(e){return kf(e)===wI};Xa.isPortal=function(e){return kf(e)===rz};Xa.isProfiler=function(e){return kf(e)===gI};Xa.isStrictMode=function(e){return kf(e)===mI};Xa.isSuspense=function(e){return kf(e)===xI};Xa.isSuspenseList=function(e){return kf(e)===bI};Xa.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===pI||e===gI||e===mI||e===xI||e===bI||typeof e=="object"&&e!==null&&(e.$$typeof===SI||e.$$typeof===wI||e.$$typeof===vI||e.$$typeof===yI||e.$$typeof===_I||e.$$typeof===wMe||e.getModuleId!==void 0)};Xa.typeOf=kf;Ise.exports=Xa;var SMe=Ise.exports,Ec=e=>e===0?0:e>0?1:-1,Zd=e=>typeof e=="number"&&e!=+e,M_=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,wi=e=>(typeof e=="number"||e instanceof Number)&&!Zd(e),Gm=e=>wi(e)||typeof e=="string",AMe=0,HA=e=>{var t=++AMe;return"".concat(e||"").concat(t)},Cu=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!wi(t)&&typeof t!="string")return r;var l;if(M_(t)){if(n==null)return r;var h=t.indexOf("%");l=n*parseFloat(t.slice(0,h))/100}else l=+t;return Zd(l)&&(l=r),a&&n!=null&&l>n&&(l=n),l},Nse=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++)if(!n[e[r]])n[e[r]]=!0;else return!0;return!1};function $a(e,t,n){return wi(e)&&wi(t)?e+n*(t-e):t}function Mse(e,t,n){if(!(!e||!e.length))return e.find(r=>r&&(typeof t=="function"?t(r):mx(r,t))===n)}var Co=e=>e===null||typeof e>"u",$5=e=>Co(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),TMe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function iz(e){if(typeof e!="string")return!1;var t=TMe;return t.includes(e)}var CMe=["viewBox","children"],pH=["points","pathLength"],QL={svg:CMe,polygon:pH,polyline:pH},sz=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(L.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var r={};return Object.keys(n).forEach(a=>{iz(a)&&(r[a]=l=>n[a](n,l))}),r},EMe=(e,t,n)=>r=>(e(t,n,r),null),AI=(e,t,n)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var r=null;return Object.keys(e).forEach(a=>{var l=e[a];iz(a)&&typeof l=="function"&&(r||(r={}),r[a]=EMe(l,t,n))}),r},PMe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function Lse(e){if(typeof e!="string")return!1;var t=PMe;return t.includes(e)}function If(e){var t=Object.entries(e).filter(n=>{var[r]=n;return Lse(r)});return Object.fromEntries(t)}var mH=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",gH=null,e4=null,Dse=e=>{if(e===gH&&Array.isArray(e4))return e4;var t=[];return L.Children.forEach(e,n=>{Co(n)||(SMe.isFragment(n)?t=t.concat(Dse(n.props.children)):t.push(n))}),e4=t,gH=e,t};function az(e,t){var n=[],r=[];return Array.isArray(t)?r=t.map(a=>mH(a)):r=[mH(t)],Dse(e).forEach(a=>{var l=mx(a,"type.displayName")||mx(a,"type.name");r.indexOf(l)!==-1&&n.push(a)}),n}var TI=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,kMe=(e,t,n,r)=>{var a;if(typeof t=="symbol"||typeof t=="number")return!0;var l=(a=r&&(QL==null?void 0:QL[r]))!==null&&a!==void 0?a:[],h=t.startsWith("data-"),i=typeof e!="function"&&(!!r&&l.includes(t)||Lse(t)),y=!!n&&iz(t);return h||i||y},Eo=(e,t,n)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(L.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var a={};return Object.keys(r).forEach(l=>{var h;kMe((h=r)===null||h===void 0?void 0:h[l],l,t,n)&&(a[l]=r[l])}),a},IMe=["children","width","height","viewBox","className","style","title","desc"];function nj(){return nj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nj.apply(null,arguments)}function NMe(e,t){if(e==null)return{};var n,r,a=MMe(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function MMe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var Rse=L.forwardRef((e,t)=>{var{children:n,width:r,height:a,viewBox:l,className:h,style:i,title:y,desc:x}=e,w=NMe(e,IMe),C=l||{width:r,height:a,x:0,y:0},P=ra("recharts-surface",h);return L.createElement("svg",nj({},Eo(w,!0,"svg"),{className:P,width:r,height:a,style:i,viewBox:"".concat(C.x," ").concat(C.y," ").concat(C.width," ").concat(C.height),ref:t}),L.createElement("title",null,y),L.createElement("desc",null,x),n)}),LMe=["children","className"];function rj(){return rj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rj.apply(null,arguments)}function DMe(e,t){if(e==null)return{};var n,r,a=RMe(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function RMe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var ul=L.forwardRef((e,t)=>{var{children:n,className:r}=e,a=DMe(e,LMe),l=ra("recharts-layer",r);return L.createElement("g",rj({className:l},Eo(a,!0),{ref:t}),n)}),jMe=L.createContext(null);function co(e){return function(){return e}}const jse=Math.cos,yk=Math.sin,Mp=Math.sqrt,vk=Math.PI,CI=2*vk,ij=Math.PI,sj=2*ij,x_=1e-6,OMe=sj-x_;function Ose(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function FMe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Ose;const n=10**t;return function(r){this._+=r[0];for(let a=1,l=r.length;a<l;++a)this._+=Math.round(arguments[a]*n)/n+r[a]}}class zMe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Ose:FMe(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,a){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+a}`}bezierCurveTo(t,n,r,a,l,h){this._append`C${+t},${+n},${+r},${+a},${this._x1=+l},${this._y1=+h}`}arcTo(t,n,r,a,l){if(t=+t,n=+n,r=+r,a=+a,l=+l,l<0)throw new Error(`negative radius: ${l}`);let h=this._x1,i=this._y1,y=r-t,x=a-n,w=h-t,C=i-n,P=w*w+C*C;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(P>x_)if(!(Math.abs(C*y-x*w)>x_)||!l)this._append`L${this._x1=t},${this._y1=n}`;else{let E=r-h,j=a-i,D=y*y+x*x,B=E*E+j*j,F=Math.sqrt(D),$=Math.sqrt(P),H=l*Math.tan((ij-Math.acos((D+P-B)/(2*F*$)))/2),J=H/$,ee=H/F;Math.abs(J-1)>x_&&this._append`L${t+J*w},${n+J*C}`,this._append`A${l},${l},0,0,${+(C*E>w*j)},${this._x1=t+ee*y},${this._y1=n+ee*x}`}}arc(t,n,r,a,l,h){if(t=+t,n=+n,r=+r,h=!!h,r<0)throw new Error(`negative radius: ${r}`);let i=r*Math.cos(a),y=r*Math.sin(a),x=t+i,w=n+y,C=1^h,P=h?a-l:l-a;this._x1===null?this._append`M${x},${w}`:(Math.abs(this._x1-x)>x_||Math.abs(this._y1-w)>x_)&&this._append`L${x},${w}`,r&&(P<0&&(P=P%sj+sj),P>OMe?this._append`A${r},${r},0,1,${C},${t-i},${n-y}A${r},${r},0,1,${C},${this._x1=x},${this._y1=w}`:P>x_&&this._append`A${r},${r},0,${+(P>=ij)},${C},${this._x1=t+r*Math.cos(l)},${this._y1=n+r*Math.sin(l)}`)}rect(t,n,r,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+a}h${-r}Z`}toString(){return this._}}function oz(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new zMe(t)}function lz(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Fse(e){this._context=e}Fse.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function EI(e){return new Fse(e)}function zse(e){return e[0]}function Bse(e){return e[1]}function Use(e,t){var n=co(!0),r=null,a=EI,l=null,h=oz(i);e=typeof e=="function"?e:e===void 0?zse:co(e),t=typeof t=="function"?t:t===void 0?Bse:co(t);function i(y){var x,w=(y=lz(y)).length,C,P=!1,E;for(r==null&&(l=a(E=h())),x=0;x<=w;++x)!(x<w&&n(C=y[x],x,y))===P&&((P=!P)?l.lineStart():l.lineEnd()),P&&l.point(+e(C,x,y),+t(C,x,y));if(E)return l=null,E+""||null}return i.x=function(y){return arguments.length?(e=typeof y=="function"?y:co(+y),i):e},i.y=function(y){return arguments.length?(t=typeof y=="function"?y:co(+y),i):t},i.defined=function(y){return arguments.length?(n=typeof y=="function"?y:co(!!y),i):n},i.curve=function(y){return arguments.length?(a=y,r!=null&&(l=a(r)),i):a},i.context=function(y){return arguments.length?(y==null?r=l=null:l=a(r=y),i):r},i}function rE(e,t,n){var r=null,a=co(!0),l=null,h=EI,i=null,y=oz(x);e=typeof e=="function"?e:e===void 0?zse:co(+e),t=typeof t=="function"?t:co(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?Bse:co(+n);function x(C){var P,E,j,D=(C=lz(C)).length,B,F=!1,$,H=new Array(D),J=new Array(D);for(l==null&&(i=h($=y())),P=0;P<=D;++P){if(!(P<D&&a(B=C[P],P,C))===F)if(F=!F)E=P,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),j=P-1;j>=E;--j)i.point(H[j],J[j]);i.lineEnd(),i.areaEnd()}F&&(H[P]=+e(B,P,C),J[P]=+t(B,P,C),i.point(r?+r(B,P,C):H[P],n?+n(B,P,C):J[P]))}if($)return i=null,$+""||null}function w(){return Use().defined(a).curve(h).context(l)}return x.x=function(C){return arguments.length?(e=typeof C=="function"?C:co(+C),r=null,x):e},x.x0=function(C){return arguments.length?(e=typeof C=="function"?C:co(+C),x):e},x.x1=function(C){return arguments.length?(r=C==null?null:typeof C=="function"?C:co(+C),x):r},x.y=function(C){return arguments.length?(t=typeof C=="function"?C:co(+C),n=null,x):t},x.y0=function(C){return arguments.length?(t=typeof C=="function"?C:co(+C),x):t},x.y1=function(C){return arguments.length?(n=C==null?null:typeof C=="function"?C:co(+C),x):n},x.lineX0=x.lineY0=function(){return w().x(e).y(t)},x.lineY1=function(){return w().x(e).y(n)},x.lineX1=function(){return w().x(r).y(t)},x.defined=function(C){return arguments.length?(a=typeof C=="function"?C:co(!!C),x):a},x.curve=function(C){return arguments.length?(h=C,l!=null&&(i=h(l)),x):h},x.context=function(C){return arguments.length?(C==null?l=i=null:i=h(l=C),x):l},x}class Vse{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function BMe(e){return new Vse(e,!0)}function UMe(e){return new Vse(e,!1)}const cz={draw(e,t){const n=Mp(t/vk);e.moveTo(n,0),e.arc(0,0,n,0,CI)}},VMe={draw(e,t){const n=Mp(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},$se=Mp(1/3),$Me=$se*2,qMe={draw(e,t){const n=Mp(t/$Me),r=n*$se;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},GMe={draw(e,t){const n=Mp(t),r=-n/2;e.rect(r,r,n,n)}},HMe=.8908130915292852,qse=yk(vk/10)/yk(7*vk/10),WMe=yk(CI/10)*qse,ZMe=-jse(CI/10)*qse,KMe={draw(e,t){const n=Mp(t*HMe),r=WMe*n,a=ZMe*n;e.moveTo(0,-n),e.lineTo(r,a);for(let l=1;l<5;++l){const h=CI*l/5,i=jse(h),y=yk(h);e.lineTo(y*n,-i*n),e.lineTo(i*r-y*a,y*r+i*a)}e.closePath()}},t4=Mp(3),YMe={draw(e,t){const n=-Mp(t/(t4*3));e.moveTo(0,n*2),e.lineTo(-t4*n,-n),e.lineTo(t4*n,-n),e.closePath()}},nf=-.5,rf=Mp(3)/2,aj=1/Mp(12),XMe=(aj/2+1)*3,JMe={draw(e,t){const n=Mp(t/XMe),r=n/2,a=n*aj,l=r,h=n*aj+n,i=-l,y=h;e.moveTo(r,a),e.lineTo(l,h),e.lineTo(i,y),e.lineTo(nf*r-rf*a,rf*r+nf*a),e.lineTo(nf*l-rf*h,rf*l+nf*h),e.lineTo(nf*i-rf*y,rf*i+nf*y),e.lineTo(nf*r+rf*a,nf*a-rf*r),e.lineTo(nf*l+rf*h,nf*h-rf*l),e.lineTo(nf*i+rf*y,nf*y-rf*i),e.closePath()}};function QMe(e,t){let n=null,r=oz(a);e=typeof e=="function"?e:co(e||cz),t=typeof t=="function"?t:co(t===void 0?64:+t);function a(){let l;if(n||(n=l=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),l)return n=null,l+""||null}return a.type=function(l){return arguments.length?(e=typeof l=="function"?l:co(l),a):e},a.size=function(l){return arguments.length?(t=typeof l=="function"?l:co(+l),a):t},a.context=function(l){return arguments.length?(n=l??null,a):n},a}function _k(){}function xk(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Gse(e){this._context=e}Gse.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:xk(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:xk(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function eLe(e){return new Gse(e)}function Hse(e){this._context=e}Hse.prototype={areaStart:_k,areaEnd:_k,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:xk(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function tLe(e){return new Hse(e)}function Wse(e){this._context=e}Wse.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:xk(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function nLe(e){return new Wse(e)}function Zse(e){this._context=e}Zse.prototype={areaStart:_k,areaEnd:_k,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function rLe(e){return new Zse(e)}function yH(e){return e<0?-1:1}function vH(e,t,n){var r=e._x1-e._x0,a=t-e._x1,l=(e._y1-e._y0)/(r||a<0&&-0),h=(n-e._y1)/(a||r<0&&-0),i=(l*a+h*r)/(r+a);return(yH(l)+yH(h))*Math.min(Math.abs(l),Math.abs(h),.5*Math.abs(i))||0}function _H(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function n4(e,t,n){var r=e._x0,a=e._y0,l=e._x1,h=e._y1,i=(l-r)/3;e._context.bezierCurveTo(r+i,a+i*t,l-i,h-i*n,l,h)}function bk(e){this._context=e}bk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:n4(this,this._t0,_H(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,n4(this,_H(this,n=vH(this,e,t)),n);break;default:n4(this,this._t0,n=vH(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function Kse(e){this._context=new Yse(e)}(Kse.prototype=Object.create(bk.prototype)).point=function(e,t){bk.prototype.point.call(this,t,e)};function Yse(e){this._context=e}Yse.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,l){this._context.bezierCurveTo(t,e,r,n,l,a)}};function iLe(e){return new bk(e)}function sLe(e){return new Kse(e)}function Xse(e){this._context=e}Xse.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=xH(e),a=xH(t),l=0,h=1;h<n;++l,++h)this._context.bezierCurveTo(r[0][l],a[0][l],r[1][l],a[1][l],e[h],t[h]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function xH(e){var t,n=e.length-1,r,a=new Array(n),l=new Array(n),h=new Array(n);for(a[0]=0,l[0]=2,h[0]=e[0]+2*e[1],t=1;t<n-1;++t)a[t]=1,l[t]=4,h[t]=4*e[t]+2*e[t+1];for(a[n-1]=2,l[n-1]=7,h[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=a[t]/l[t-1],l[t]-=r,h[t]-=r*h[t-1];for(a[n-1]=h[n-1]/l[n-1],t=n-2;t>=0;--t)a[t]=(h[t]-a[t+1])/l[t];for(l[n-1]=(e[n]+a[n-1])/2,t=0;t<n-1;++t)l[t]=2*e[t+1]-a[t+1];return[a,l]}function aLe(e){return new Xse(e)}function PI(e,t){this._context=e,this._t=t}PI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function oLe(e){return new PI(e,.5)}function lLe(e){return new PI(e,0)}function cLe(e){return new PI(e,1)}function lw(e,t){if((h=e.length)>1)for(var n=1,r,a,l=e[t[0]],h,i=l.length;n<h;++n)for(a=l,l=e[t[n]],r=0;r<i;++r)l[r][1]+=l[r][0]=isNaN(a[r][1])?a[r][0]:a[r][1]}function oj(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function uLe(e,t){return e[t]}function dLe(e){const t=[];return t.key=e,t}function hLe(){var e=co([]),t=oj,n=lw,r=uLe;function a(l){var h=Array.from(e.apply(this,arguments),dLe),i,y=h.length,x=-1,w;for(const C of l)for(i=0,++x;i<y;++i)(h[i][x]=[0,+r(C,h[i].key,x,l)]).data=C;for(i=0,w=lz(t(h));i<y;++i)h[w[i]].index=i;return n(h,w),h}return a.keys=function(l){return arguments.length?(e=typeof l=="function"?l:co(Array.from(l)),a):e},a.value=function(l){return arguments.length?(r=typeof l=="function"?l:co(+l),a):r},a.order=function(l){return arguments.length?(t=l==null?oj:typeof l=="function"?l:co(Array.from(l)),a):t},a.offset=function(l){return arguments.length?(n=l??lw,a):n},a}function fLe(e,t){if((r=e.length)>0){for(var n,r,a=0,l=e[0].length,h;a<l;++a){for(h=n=0;n<r;++n)h+=e[n][a][1]||0;if(h)for(n=0;n<r;++n)e[n][a][1]/=h}lw(e,t)}}function pLe(e,t){if((a=e.length)>0){for(var n=0,r=e[t[0]],a,l=r.length;n<l;++n){for(var h=0,i=0;h<a;++h)i+=e[h][n][1]||0;r[n][1]+=r[n][0]=-i/2}lw(e,t)}}function mLe(e,t){if(!(!((h=e.length)>0)||!((l=(a=e[t[0]]).length)>0))){for(var n=0,r=1,a,l,h;r<l;++r){for(var i=0,y=0,x=0;i<h;++i){for(var w=e[t[i]],C=w[r][1]||0,P=w[r-1][1]||0,E=(C-P)/2,j=0;j<i;++j){var D=e[t[j]],B=D[r][1]||0,F=D[r-1][1]||0;E+=B-F}y+=C,x+=E*C}a[r-1][1]+=a[r-1][0]=n,y&&(n-=x/y)}a[r-1][1]+=a[r-1][0]=n,lw(e,t)}}var gLe=["type","size","sizeType"];function lj(){return lj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lj.apply(null,arguments)}function bH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function wH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?bH(Object(n),!0).forEach(function(r){yLe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function yLe(e,t,n){return(t=vLe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vLe(e){var t=_Le(e,"string");return typeof t=="symbol"?t:t+""}function _Le(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xLe(e,t){if(e==null)return{};var n,r,a=bLe(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function bLe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var Jse={symbolCircle:cz,symbolCross:VMe,symbolDiamond:qMe,symbolSquare:GMe,symbolStar:KMe,symbolTriangle:YMe,symbolWye:JMe},wLe=Math.PI/180,SLe=e=>{var t="symbol".concat($5(e));return Jse[t]||cz},ALe=(e,t,n)=>{if(t==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var r=18*wLe;return 1.25*e*e*(Math.tan(r)-Math.tan(r*2)*Math.tan(r)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},TLe=(e,t)=>{Jse["symbol".concat($5(e))]=t},Qse=e=>{var{type:t="circle",size:n=64,sizeType:r="area"}=e,a=xLe(e,gLe),l=wH(wH({},a),{},{type:t,size:n,sizeType:r}),h="circle";typeof t=="string"&&(h=t);var i=()=>{var P=SLe(h),E=QMe().type(P).size(ALe(n,r,h));return E()},{className:y,cx:x,cy:w}=l,C=Eo(l,!0);return x===+x&&w===+w&&n===+n?L.createElement("path",lj({},C,{className:ra("recharts-symbols",y),transform:"translate(".concat(x,", ").concat(w,")"),d:i()})):null};Qse.registerSymbol=TLe;var eae={},tae={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,r){const a=new Map;for(let l=0;l<n.length;l++){const h=n[l],i=r(h);a.has(i)||a.set(i,h)}return Array.from(a.values())}e.uniqBy=t})(tae);var uz={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n}e.identity=t})(uz);var nae={},kI={},rae={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Number.isSafeInteger(n)&&n>=0}e.isLength=t})(rae);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rae;function n(r){return r!=null&&typeof r!="function"&&t.isLength(r.length)}e.isArrayLike=n})(kI);var iae={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="object"&&n!==null}e.isObjectLike=t})(iae);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kI,n=iae;function r(a){return n.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=r})(nae);var sae={},aae={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=hI;function n(r){return function(a){return t.get(a,r)}}e.property=n})(aae);var oae={},r4={},i4={},dz={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n!==null&&(typeof n=="object"||typeof n=="function")}e.isObject=t})(dz);var hz={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==null||typeof n!="object"&&typeof n!="function"}e.isPrimitive=t})(hz);var fz={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,r){return n===r||Number.isNaN(n)&&Number.isNaN(r)}e.eq=t})(fz);var SH;function CLe(){return SH||(SH=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=pz(),n=dz,r=hz,a=fz;function l(C,P,E){return typeof E!="function"?t.isMatch(C,P):h(C,P,function j(D,B,F,$,H,J){const ee=E(D,B,F,$,H,J);return ee!==void 0?!!ee:h(D,B,j,J)},new Map)}function h(C,P,E,j){if(P===C)return!0;switch(typeof P){case"object":return i(C,P,E,j);case"function":return Object.keys(P).length>0?h(C,{...P},E,j):a.eq(C,P);default:return n.isObject(C)?typeof P=="string"?P==="":!0:a.eq(C,P)}}function i(C,P,E,j){if(P==null)return!0;if(Array.isArray(P))return x(C,P,E,j);if(P instanceof Map)return y(C,P,E,j);if(P instanceof Set)return w(C,P,E,j);const D=Object.keys(P);if(C==null)return D.length===0;if(D.length===0)return!0;if(j&&j.has(P))return j.get(P)===C;j&&j.set(P,C);try{for(let B=0;B<D.length;B++){const F=D[B];if(!r.isPrimitive(C)&&!(F in C)||P[F]===void 0&&C[F]!==void 0||P[F]===null&&C[F]!==null||!E(C[F],P[F],F,C,P,j))return!1}return!0}finally{j&&j.delete(P)}}function y(C,P,E,j){if(P.size===0)return!0;if(!(C instanceof Map))return!1;for(const[D,B]of P.entries()){const F=C.get(D);if(E(F,B,D,C,P,j)===!1)return!1}return!0}function x(C,P,E,j){if(P.length===0)return!0;if(!Array.isArray(C))return!1;const D=new Set;for(let B=0;B<P.length;B++){const F=P[B];let $=!1;for(let H=0;H<C.length;H++){if(D.has(H))continue;const J=C[H];let ee=!1;if(E(J,F,B,C,P,j)&&(ee=!0),ee){D.add(H),$=!0;break}}if(!$)return!1}return!0}function w(C,P,E,j){return P.size===0?!0:C instanceof Set?x([...C],[...P],E,j):!1}e.isMatchWith=l,e.isSetMatch=w}(i4)),i4}var AH;function pz(){return AH||(AH=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=CLe();function n(r,a){return t.isMatchWith(r,a,()=>{})}e.isMatch=n}(r4)),r4}var lae={},mz={},cae={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Object.getOwnPropertySymbols(n).filter(r=>Object.prototype.propertyIsEnumerable.call(n,r))}e.getSymbols=t})(cae);var gz={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}e.getTag=t})(gz);var yz={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",n="[object String]",r="[object Number]",a="[object Boolean]",l="[object Arguments]",h="[object Symbol]",i="[object Date]",y="[object Map]",x="[object Set]",w="[object Array]",C="[object Function]",P="[object ArrayBuffer]",E="[object Object]",j="[object Error]",D="[object DataView]",B="[object Uint8Array]",F="[object Uint8ClampedArray]",$="[object Uint16Array]",H="[object Uint32Array]",J="[object BigUint64Array]",ee="[object Int8Array]",Q="[object Int16Array]",ne="[object Int32Array]",pe="[object BigInt64Array]",he="[object Float32Array]",we="[object Float64Array]";e.argumentsTag=l,e.arrayBufferTag=P,e.arrayTag=w,e.bigInt64ArrayTag=pe,e.bigUint64ArrayTag=J,e.booleanTag=a,e.dataViewTag=D,e.dateTag=i,e.errorTag=j,e.float32ArrayTag=he,e.float64ArrayTag=we,e.functionTag=C,e.int16ArrayTag=Q,e.int32ArrayTag=ne,e.int8ArrayTag=ee,e.mapTag=y,e.numberTag=r,e.objectTag=E,e.regexpTag=t,e.setTag=x,e.stringTag=n,e.symbolTag=h,e.uint16ArrayTag=$,e.uint32ArrayTag=H,e.uint8ArrayTag=B,e.uint8ClampedArrayTag=F})(yz);var uae={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}e.isTypedArray=t})(uae);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cae,n=gz,r=yz,a=hz,l=uae;function h(w,C){return i(w,void 0,w,new Map,C)}function i(w,C,P,E=new Map,j=void 0){const D=j==null?void 0:j(w,C,P,E);if(D!==void 0)return D;if(a.isPrimitive(w))return w;if(E.has(w))return E.get(w);if(Array.isArray(w)){const B=new Array(w.length);E.set(w,B);for(let F=0;F<w.length;F++)B[F]=i(w[F],F,P,E,j);return Object.hasOwn(w,"index")&&(B.index=w.index),Object.hasOwn(w,"input")&&(B.input=w.input),B}if(w instanceof Date)return new Date(w.getTime());if(w instanceof RegExp){const B=new RegExp(w.source,w.flags);return B.lastIndex=w.lastIndex,B}if(w instanceof Map){const B=new Map;E.set(w,B);for(const[F,$]of w)B.set(F,i($,F,P,E,j));return B}if(w instanceof Set){const B=new Set;E.set(w,B);for(const F of w)B.add(i(F,void 0,P,E,j));return B}if(typeof Buffer<"u"&&Buffer.isBuffer(w))return w.subarray();if(l.isTypedArray(w)){const B=new(Object.getPrototypeOf(w)).constructor(w.length);E.set(w,B);for(let F=0;F<w.length;F++)B[F]=i(w[F],F,P,E,j);return B}if(w instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&w instanceof SharedArrayBuffer)return w.slice(0);if(w instanceof DataView){const B=new DataView(w.buffer.slice(0),w.byteOffset,w.byteLength);return E.set(w,B),y(B,w,P,E,j),B}if(typeof File<"u"&&w instanceof File){const B=new File([w],w.name,{type:w.type});return E.set(w,B),y(B,w,P,E,j),B}if(w instanceof Blob){const B=new Blob([w],{type:w.type});return E.set(w,B),y(B,w,P,E,j),B}if(w instanceof Error){const B=new w.constructor;return E.set(w,B),B.message=w.message,B.name=w.name,B.stack=w.stack,B.cause=w.cause,y(B,w,P,E,j),B}if(typeof w=="object"&&x(w)){const B=Object.create(Object.getPrototypeOf(w));return E.set(w,B),y(B,w,P,E,j),B}return w}function y(w,C,P=w,E,j){const D=[...Object.keys(C),...t.getSymbols(C)];for(let B=0;B<D.length;B++){const F=D[B],$=Object.getOwnPropertyDescriptor(w,F);($==null||$.writable)&&(w[F]=i(C[F],F,P,E,j))}}function x(w){switch(n.getTag(w)){case r.argumentsTag:case r.arrayTag:case r.arrayBufferTag:case r.dataViewTag:case r.booleanTag:case r.dateTag:case r.float32ArrayTag:case r.float64ArrayTag:case r.int8ArrayTag:case r.int16ArrayTag:case r.int32ArrayTag:case r.mapTag:case r.numberTag:case r.objectTag:case r.regexpTag:case r.setTag:case r.stringTag:case r.symbolTag:case r.uint8ArrayTag:case r.uint8ClampedArrayTag:case r.uint16ArrayTag:case r.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=h,e.cloneDeepWithImpl=i,e.copyProperties=y})(mz);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=mz;function n(r){return t.cloneDeepWithImpl(r,void 0,r,new Map,void 0)}e.cloneDeep=n})(lae);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=pz(),n=lae;function r(a){return a=n.cloneDeep(a),l=>t.isMatch(l,a)}e.matches=r})(oae);var dae={},hae={},fae={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=mz,n=yz;function r(a,l){return t.cloneDeepWith(a,(h,i,y,x)=>{const w=l==null?void 0:l(h,i,y,x);if(w!==void 0)return w;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case n.numberTag:case n.stringTag:case n.booleanTag:{const C=new a.constructor(a==null?void 0:a.valueOf());return t.copyProperties(C,a),C}case n.argumentsTag:{const C={};return t.copyProperties(C,a),C.length=a.length,C[Symbol.iterator]=a[Symbol.iterator],C}default:return}})}e.cloneDeepWith=r})(fae);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=fae;function n(r){return t.cloneDeepWith(r)}e.cloneDeep=n})(hae);var pae={},vz={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function n(r,a=Number.MAX_SAFE_INTEGER){switch(typeof r){case"number":return Number.isInteger(r)&&r>=0&&r<a;case"symbol":return!1;case"string":return t.test(r)}}e.isIndex=n})(vz);var mae={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=gz;function n(r){return r!==null&&typeof r=="object"&&t.getTag(r)==="[object Arguments]"}e.isArguments=n})(mae);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ez,n=vz,r=mae,a=fI;function l(h,i){let y;if(Array.isArray(i)?y=i:typeof i=="string"&&t.isDeepKey(i)&&(h==null?void 0:h[i])==null?y=a.toPath(i):y=[i],y.length===0)return!1;let x=h;for(let w=0;w<y.length;w++){const C=y[w];if((x==null||!Object.hasOwn(x,C))&&!((Array.isArray(x)||r.isArguments(x))&&n.isIndex(C)&&C<x.length))return!1;x=x[C]}return!0}e.has=l})(pae);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=pz(),n=tz,r=hae,a=hI,l=pae;function h(i,y){switch(typeof i){case"object":{Object.is(i==null?void 0:i.valueOf(),-0)&&(i="-0");break}case"number":{i=n.toKey(i);break}}return y=r.cloneDeep(y),function(x){const w=a.get(x,i);return w===void 0?l.has(x,i):y===void 0?w===void 0:t.isMatch(w,y)}}e.matchesProperty=h})(dae);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=uz,n=aae,r=oae,a=dae;function l(h){if(h==null)return t.identity;switch(typeof h){case"function":return h;case"object":return Array.isArray(h)&&h.length===2?a.matchesProperty(h[0],h[1]):r.matches(h);case"string":case"symbol":case"number":return n.property(h)}}e.iteratee=l})(sae);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tae,n=uz,r=nae,a=sae;function l(h,i=n.identity){return r.isArrayLikeObject(h)?t.uniqBy(Array.from(h),a.iteratee(i)):[]}e.uniqBy=l})(eae);var ELe=eae.uniqBy;const TH=Ip(ELe);function PLe(e,t,n){return t===!0?TH(e,n):typeof t=="function"?TH(e,t):e}var gae={exports:{}},yae={},vae={exports:{}},_ae={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cw=L;function kLe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ILe=typeof Object.is=="function"?Object.is:kLe,NLe=cw.useState,MLe=cw.useEffect,LLe=cw.useLayoutEffect,DLe=cw.useDebugValue;function RLe(e,t){var n=t(),r=NLe({inst:{value:n,getSnapshot:t}}),a=r[0].inst,l=r[1];return LLe(function(){a.value=n,a.getSnapshot=t,s4(a)&&l({inst:a})},[e,n,t]),MLe(function(){return s4(a)&&l({inst:a}),e(function(){s4(a)&&l({inst:a})})},[e]),DLe(n),n}function s4(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ILe(e,n)}catch{return!0}}function jLe(e,t){return t()}var OLe=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?jLe:RLe;_ae.useSyncExternalStore=cw.useSyncExternalStore!==void 0?cw.useSyncExternalStore:OLe;vae.exports=_ae;var xae=vae.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var II=L,FLe=xae;function zLe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var BLe=typeof Object.is=="function"?Object.is:zLe,ULe=FLe.useSyncExternalStore,VLe=II.useRef,$Le=II.useEffect,qLe=II.useMemo,GLe=II.useDebugValue;yae.useSyncExternalStoreWithSelector=function(e,t,n,r,a){var l=VLe(null);if(l.current===null){var h={hasValue:!1,value:null};l.current=h}else h=l.current;l=qLe(function(){function y(E){if(!x){if(x=!0,w=E,E=r(E),a!==void 0&&h.hasValue){var j=h.value;if(a(j,E))return C=j}return C=E}if(j=C,BLe(w,E))return j;var D=r(E);return a!==void 0&&a(j,D)?(w=E,j):(w=E,C=D)}var x=!1,w,C,P=n===void 0?null:n;return[function(){return y(t())},P===null?void 0:function(){return y(P())}]},[t,n,r,a]);var i=ULe(e,l[0],l[1]);return $Le(function(){h.hasValue=!0,h.value=i},[i]),GLe(i),i};gae.exports=yae;var HLe=gae.exports,_z=L.createContext(null),WLe=e=>e,Al=()=>{var e=L.useContext(_z);return e?e.store.dispatch:WLe},iP=()=>{},ZLe=()=>iP,KLe=(e,t)=>e===t;function Si(e){var t=L.useContext(_z);return HLe.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:ZLe,t?t.store.getState:iP,t?t.store.getState:iP,t?e:iP,KLe)}function YLe(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function XLe(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function JLe(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(n=>typeof n=="function")){const n=e.map(r=>typeof r=="function"?`function ${r.name||"unnamed"}()`:typeof r).join(", ");throw new TypeError(`${t}[${n}]`)}}var CH=e=>Array.isArray(e)?e:[e];function QLe(e){const t=Array.isArray(e[0])?e[0]:e;return JLe(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function e4e(e,t){const n=[],{length:r}=e;for(let a=0;a<r;a++)n.push(e[a].apply(null,t));return n}var t4e=class{constructor(e){this.value=e}deref(){return this.value}},n4e=typeof WeakRef<"u"?WeakRef:t4e,r4e=0,EH=1;function iE(){return{s:r4e,v:void 0,o:null,p:null}}function bae(e,t={}){let n=iE();const{resultEqualityCheck:r}=t;let a,l=0;function h(){var C;let i=n;const{length:y}=arguments;for(let P=0,E=y;P<E;P++){const j=arguments[P];if(typeof j=="function"||typeof j=="object"&&j!==null){let D=i.o;D===null&&(i.o=D=new WeakMap);const B=D.get(j);B===void 0?(i=iE(),D.set(j,i)):i=B}else{let D=i.p;D===null&&(i.p=D=new Map);const B=D.get(j);B===void 0?(i=iE(),D.set(j,i)):i=B}}const x=i;let w;if(i.s===EH)w=i.v;else if(w=e.apply(null,arguments),l++,r){const P=((C=a==null?void 0:a.deref)==null?void 0:C.call(a))??a;P!=null&&r(P,w)&&(w=P,l!==0&&l--),a=typeof w=="object"&&w!==null||typeof w=="function"?new n4e(w):w}return x.s=EH,x.v=w,w}return h.clearCache=()=>{n=iE(),h.resetResultsCount()},h.resultsCount=()=>l,h.resetResultsCount=()=>{l=0},h}function i4e(e,...t){const n=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,r=(...a)=>{let l=0,h=0,i,y={},x=a.pop();typeof x=="object"&&(y=x,x=a.pop()),YLe(x,`createSelector expects an output function after the inputs, but received: [${typeof x}]`);const w={...n,...y},{memoize:C,memoizeOptions:P=[],argsMemoize:E=bae,argsMemoizeOptions:j=[],devModeChecks:D={}}=w,B=CH(P),F=CH(j),$=QLe(a),H=C(function(){return l++,x.apply(null,arguments)},...B),J=E(function(){h++;const Q=e4e($,arguments);return i=H.apply(null,Q),i},...F);return Object.assign(J,{resultFunc:x,memoizedResultFunc:H,dependencies:$,dependencyRecomputations:()=>h,resetDependencyRecomputations:()=>{h=0},lastResult:()=>i,recomputations:()=>l,resetRecomputations:()=>{l=0},memoize:C,argsMemoize:E})};return Object.assign(r,{withTypes:()=>r}),r}var _n=i4e(bae),s4e=Object.assign((e,t=_n)=>{XLe(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const n=Object.keys(e),r=n.map(l=>e[l]);return t(r,(...l)=>l.reduce((h,i,y)=>(h[n[y]]=i,h),{}))},{withTypes:()=>s4e}),wae={},Sae={},Aae={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"?1:r===null?2:r===void 0?3:r!==r?4:0}const n=(r,a,l)=>{if(r!==a){const h=t(r),i=t(a);if(h===i&&h===0){if(r<a)return l==="desc"?1:-1;if(r>a)return l==="desc"?-1:1}return l==="desc"?i-h:h-i}return 0};e.compareValues=n})(Aae);var Tae={},xz={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"||n instanceof Symbol}e.isSymbol=t})(xz);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xz,n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function a(l,h){return Array.isArray(l)?!1:typeof l=="number"||typeof l=="boolean"||l==null||t.isSymbol(l)?!0:typeof l=="string"&&(r.test(l)||!n.test(l))||h!=null&&Object.hasOwn(h,l)}e.isKey=a})(Tae);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Aae,n=Tae,r=fI;function a(l,h,i,y){if(l==null)return[];i=y?void 0:i,Array.isArray(l)||(l=Object.values(l)),Array.isArray(h)||(h=h==null?[null]:[h]),h.length===0&&(h=[null]),Array.isArray(i)||(i=i==null?[]:[i]),i=i.map(E=>String(E));const x=(E,j)=>{let D=E;for(let B=0;B<j.length&&D!=null;++B)D=D[j[B]];return D},w=(E,j)=>j==null||E==null?j:typeof E=="object"&&"key"in E?Object.hasOwn(j,E.key)?j[E.key]:x(j,E.path):typeof E=="function"?E(j):Array.isArray(E)?x(j,E):typeof j=="object"?j[E]:j,C=h.map(E=>(Array.isArray(E)&&E.length===1&&(E=E[0]),E==null||typeof E=="function"||Array.isArray(E)||n.isKey(E)?E:{key:E,path:r.toPath(E)}));return l.map(E=>({original:E,criteria:C.map(j=>w(j,E))})).slice().sort((E,j)=>{for(let D=0;D<C.length;D++){const B=t.compareValues(E.criteria[D],j.criteria[D],i[D]);if(B!==0)return B}return 0}).map(E=>E.original)}e.orderBy=a})(Sae);var Cae={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,r=1){const a=[],l=Math.floor(r),h=(i,y)=>{for(let x=0;x<i.length;x++){const w=i[x];Array.isArray(w)&&y<l?h(w,y+1):a.push(w)}};return h(n,0),a}e.flatten=t})(Cae);var bz={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vz,n=kI,r=dz,a=fz;function l(h,i,y){return r.isObject(y)&&(typeof i=="number"&&n.isArrayLike(y)&&t.isIndex(i)&&i<y.length||typeof i=="string"&&i in y)?a.eq(y[i],h):!1}e.isIterateeCall=l})(bz);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Sae,n=Cae,r=bz;function a(l,...h){const i=h.length;return i>1&&r.isIterateeCall(l,h[0],h[1])?h=[]:i>2&&r.isIterateeCall(h[0],h[1],h[2])&&(h=[h[0]]),t.orderBy(l,n.flatten(h),["asc"])}e.sortBy=a})(wae);var a4e=wae.sortBy;const NI=Ip(a4e);var Eae=e=>e.legend.settings,o4e=e=>e.legend.size,l4e=e=>e.legend.payload;_n([l4e,Eae],(e,t)=>{var{itemSorter:n}=t,r=e.flat(1);return n?NI(r,n):r});var sE=1;function c4e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,n]=L.useState({height:0,left:0,top:0,width:0}),r=L.useCallback(a=>{if(a!=null){var l=a.getBoundingClientRect(),h={height:l.height,left:l.left,top:l.top,width:l.width};(Math.abs(h.height-t.height)>sE||Math.abs(h.left-t.left)>sE||Math.abs(h.top-t.top)>sE||Math.abs(h.width-t.width)>sE)&&n({height:h.height,left:h.left,top:h.top,width:h.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,r]}function Uc(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var u4e=typeof Symbol=="function"&&Symbol.observable||"@@observable",PH=u4e,a4=()=>Math.random().toString(36).substring(7).split("").join("."),d4e={INIT:`@@redux/INIT${a4()}`,REPLACE:`@@redux/REPLACE${a4()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${a4()}`},wk=d4e;function wz(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function Pae(e,t,n){if(typeof e!="function")throw new Error(Uc(2));if(typeof t=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Uc(0));if(typeof t=="function"&&typeof n>"u"&&(n=t,t=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Uc(1));return n(Pae)(e,t)}let r=e,a=t,l=new Map,h=l,i=0,y=!1;function x(){h===l&&(h=new Map,l.forEach((B,F)=>{h.set(F,B)}))}function w(){if(y)throw new Error(Uc(3));return a}function C(B){if(typeof B!="function")throw new Error(Uc(4));if(y)throw new Error(Uc(5));let F=!0;x();const $=i++;return h.set($,B),function(){if(F){if(y)throw new Error(Uc(6));F=!1,x(),h.delete($),l=null}}}function P(B){if(!wz(B))throw new Error(Uc(7));if(typeof B.type>"u")throw new Error(Uc(8));if(typeof B.type!="string")throw new Error(Uc(17));if(y)throw new Error(Uc(9));try{y=!0,a=r(a,B)}finally{y=!1}return(l=h).forEach($=>{$()}),B}function E(B){if(typeof B!="function")throw new Error(Uc(10));r=B,P({type:wk.REPLACE})}function j(){const B=C;return{subscribe(F){if(typeof F!="object"||F===null)throw new Error(Uc(11));function $(){const J=F;J.next&&J.next(w())}return $(),{unsubscribe:B($)}},[PH](){return this}}}return P({type:wk.INIT}),{dispatch:P,subscribe:C,getState:w,replaceReducer:E,[PH]:j}}function h4e(e){Object.keys(e).forEach(t=>{const n=e[t];if(typeof n(void 0,{type:wk.INIT})>"u")throw new Error(Uc(12));if(typeof n(void 0,{type:wk.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Uc(13))})}function kae(e){const t=Object.keys(e),n={};for(let l=0;l<t.length;l++){const h=t[l];typeof e[h]=="function"&&(n[h]=e[h])}const r=Object.keys(n);let a;try{h4e(n)}catch(l){a=l}return function(h={},i){if(a)throw a;let y=!1;const x={};for(let w=0;w<r.length;w++){const C=r[w],P=n[C],E=h[C],j=P(E,i);if(typeof j>"u")throw i&&i.type,new Error(Uc(14));x[C]=j,y=y||j!==E}return y=y||r.length!==Object.keys(h).length,y?x:h}}function Sk(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,n)=>(...r)=>t(n(...r)))}function f4e(...e){return t=>(n,r)=>{const a=t(n,r);let l=()=>{throw new Error(Uc(15))};const h={getState:a.getState,dispatch:(y,...x)=>l(y,...x)},i=e.map(y=>y(h));return l=Sk(...i)(a.dispatch),{...a,dispatch:l}}}function Iae(e){return wz(e)&&"type"in e&&typeof e.type=="string"}var Nae=Symbol.for("immer-nothing"),kH=Symbol.for("immer-draftable"),Ih=Symbol.for("immer-state");function yp(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var uw=Object.getPrototypeOf;function gx(e){return!!e&&!!e[Ih]}function dy(e){var t;return e?Mae(e)||Array.isArray(e)||!!e[kH]||!!((t=e.constructor)!=null&&t[kH])||q5(e)||LI(e):!1}var p4e=Object.prototype.constructor.toString();function Mae(e){if(!e||typeof e!="object")return!1;const t=uw(e);if(t===null)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===p4e}function Ak(e,t){MI(e)===0?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function MI(e){const t=e[Ih];return t?t.type_:Array.isArray(e)?1:q5(e)?2:LI(e)?3:0}function cj(e,t){return MI(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Lae(e,t,n){const r=MI(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function m4e(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function q5(e){return e instanceof Map}function LI(e){return e instanceof Set}function b_(e){return e.copy_||e.base_}function uj(e,t){if(q5(e))return new Map(e);if(LI(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=Mae(e);if(t===!0||t==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(e);delete r[Ih];let a=Reflect.ownKeys(r);for(let l=0;l<a.length;l++){const h=a[l],i=r[h];i.writable===!1&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(r[h]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[h]})}return Object.create(uw(e),r)}else{const r=uw(e);if(r!==null&&n)return{...e};const a=Object.create(r);return Object.assign(a,e)}}function Sz(e,t=!1){return DI(e)||gx(e)||!dy(e)||(MI(e)>1&&Object.defineProperties(e,{set:{value:aE},add:{value:aE},clear:{value:aE},delete:{value:aE}}),Object.freeze(e),t&&Object.values(e).forEach(n=>Sz(n,!0))),e}function aE(){yp(2)}function DI(e){return Object.isFrozen(e)}var g4e={};function yx(e){const t=g4e[e];return t||yp(0,e),t}var WA;function Dae(){return WA}function y4e(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function IH(e,t){t&&(yx("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function dj(e){hj(e),e.drafts_.forEach(v4e),e.drafts_=null}function hj(e){e===WA&&(WA=e.parent_)}function NH(e){return WA=y4e(WA,e)}function v4e(e){const t=e[Ih];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function MH(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[Ih].modified_&&(dj(t),yp(4)),dy(e)&&(e=Tk(t,e),t.parent_||Ck(t,e)),t.patches_&&yx("Patches").generateReplacementPatches_(n[Ih].base_,e,t.patches_,t.inversePatches_)):e=Tk(t,n,[]),dj(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Nae?e:void 0}function Tk(e,t,n){if(DI(t))return t;const r=t[Ih];if(!r)return Ak(t,(a,l)=>LH(e,r,t,a,l,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return Ck(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const a=r.copy_;let l=a,h=!1;r.type_===3&&(l=new Set(a),a.clear(),h=!0),Ak(l,(i,y)=>LH(e,r,a,i,y,n,h)),Ck(e,a,!1),n&&e.patches_&&yx("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function LH(e,t,n,r,a,l,h){if(gx(a)){const i=l&&t&&t.type_!==3&&!cj(t.assigned_,r)?l.concat(r):void 0,y=Tk(e,a,i);if(Lae(n,r,y),gx(y))e.canAutoFreeze_=!1;else return}else h&&n.add(a);if(dy(a)&&!DI(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Tk(e,a),(!t||!t.scope_.parent_)&&typeof r!="symbol"&&(q5(n)?n.has(r):Object.prototype.propertyIsEnumerable.call(n,r))&&Ck(e,a)}}function Ck(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Sz(t,n)}function _4e(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:Dae(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=r,l=Az;n&&(a=[r],l=ZA);const{revoke:h,proxy:i}=Proxy.revocable(a,l);return r.draft_=i,r.revoke_=h,i}var Az={get(e,t){if(t===Ih)return e;const n=b_(e);if(!cj(n,t))return x4e(e,n,t);const r=n[t];return e.finalized_||!dy(r)?r:r===o4(e.base_,t)?(l4(e),e.copy_[t]=pj(r,e)):r},has(e,t){return t in b_(e)},ownKeys(e){return Reflect.ownKeys(b_(e))},set(e,t,n){const r=Rae(b_(e),t);if(r!=null&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const a=o4(b_(e),t),l=a==null?void 0:a[Ih];if(l&&l.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(m4e(n,a)&&(n!==void 0||cj(e.base_,t)))return!0;l4(e),fj(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return o4(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,l4(e),fj(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=b_(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty(){yp(11)},getPrototypeOf(e){return uw(e.base_)},setPrototypeOf(){yp(12)}},ZA={};Ak(Az,(e,t)=>{ZA[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});ZA.deleteProperty=function(e,t){return ZA.set.call(this,e,t,void 0)};ZA.set=function(e,t,n){return Az.set.call(this,e[0],t,n,e[0])};function o4(e,t){const n=e[Ih];return(n?b_(n):e)[t]}function x4e(e,t,n){var a;const r=Rae(t,n);return r?"value"in r?r.value:(a=r.get)==null?void 0:a.call(e.draft_):void 0}function Rae(e,t){if(!(t in e))return;let n=uw(e);for(;n;){const r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=uw(n)}}function fj(e){e.modified_||(e.modified_=!0,e.parent_&&fj(e.parent_))}function l4(e){e.copy_||(e.copy_=uj(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var b4e=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,n,r)=>{if(typeof t=="function"&&typeof n!="function"){const l=n;n=t;const h=this;return function(y=l,...x){return h.produce(y,w=>n.call(this,w,...x))}}typeof n!="function"&&yp(6),r!==void 0&&typeof r!="function"&&yp(7);let a;if(dy(t)){const l=NH(this),h=pj(t,void 0);let i=!0;try{a=n(h),i=!1}finally{i?dj(l):hj(l)}return IH(l,r),MH(a,l)}else if(!t||typeof t!="object"){if(a=n(t),a===void 0&&(a=t),a===Nae&&(a=void 0),this.autoFreeze_&&Sz(a,!0),r){const l=[],h=[];yx("Patches").generateReplacementPatches_(t,a,l,h),r(l,h)}return a}else yp(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(h,...i)=>this.produceWithPatches(h,y=>t(y,...i));let r,a;return[this.produce(t,n,(h,i)=>{r=h,a=i}),r,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){dy(e)||yp(8),gx(e)&&(e=Wg(e));const t=NH(this),n=pj(e,void 0);return n[Ih].isManual_=!0,hj(t),n}finishDraft(e,t){const n=e&&e[Ih];(!n||!n.isManual_)&&yp(9);const{scope_:r}=n;return IH(r,t),MH(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const a=t[n];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}n>-1&&(t=t.slice(n+1));const r=yx("Patches").applyPatches_;return gx(e)?r(e,t):this.produce(e,a=>r(a,t))}};function pj(e,t){const n=q5(e)?yx("MapSet").proxyMap_(e,t):LI(e)?yx("MapSet").proxySet_(e,t):_4e(e,t);return(t?t.scope_:Dae()).drafts_.push(n),n}function Wg(e){return gx(e)||yp(10,e),jae(e)}function jae(e){if(!dy(e)||DI(e))return e;const t=e[Ih];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=uj(e,t.scope_.immer_.useStrictShallowCopy_)}else n=uj(e,!0);return Ak(n,(r,a)=>{Lae(n,r,jae(a))}),t&&(t.finalized_=!1),n}var w4e=new b4e,Oae=w4e.produce;function Fae(e){return({dispatch:n,getState:r})=>a=>l=>typeof l=="function"?l(n,r,e):a(l)}var S4e=Fae(),A4e=Fae,T4e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Sk:Sk.apply(null,arguments)};function wf(e,t){function n(...r){if(t){let a=t(...r);if(!a)throw new Error(Eh(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:r[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=r=>Iae(r)&&r.type===e,n}var zae=class MS extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,MS.prototype)}static get[Symbol.species](){return MS}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new MS(...t[0].concat(this)):new MS(...t.concat(this))}};function DH(e){return dy(e)?Oae(e,()=>{}):e}function oE(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}function C4e(e){return typeof e=="boolean"}var E4e=()=>function(t){const{thunk:n=!0,immutableCheck:r=!0,serializableCheck:a=!0,actionCreatorCheck:l=!0}=t??{};let h=new zae;return n&&(C4e(n)?h.push(S4e):h.push(A4e(n.extraArgument))),h},P4e="RTK_autoBatch",RH=e=>t=>{setTimeout(t,e)},k4e=(e={type:"raf"})=>t=>(...n)=>{const r=t(...n);let a=!0,l=!1,h=!1;const i=new Set,y=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:RH(10):e.type==="callback"?e.queueNotification:RH(e.timeout),x=()=>{h=!1,l&&(l=!1,i.forEach(w=>w()))};return Object.assign({},r,{subscribe(w){const C=()=>a&&w(),P=r.subscribe(C);return i.add(w),()=>{P(),i.delete(w)}},dispatch(w){var C;try{return a=!((C=w==null?void 0:w.meta)!=null&&C[P4e]),l=!a,l&&(h||(h=!0,y(x))),r.dispatch(w)}finally{a=!0}}})},I4e=e=>function(n){const{autoBatch:r=!0}=n??{};let a=new zae(e);return r&&a.push(k4e(typeof r=="object"?r:void 0)),a};function N4e(e){const t=E4e(),{reducer:n=void 0,middleware:r,devTools:a=!0,duplicateMiddlewareCheck:l=!0,preloadedState:h=void 0,enhancers:i=void 0}=e||{};let y;if(typeof n=="function")y=n;else if(wz(n))y=kae(n);else throw new Error(Eh(1));let x;typeof r=="function"?x=r(t):x=t();let w=Sk;a&&(w=T4e({trace:!1,...typeof a=="object"&&a}));const C=f4e(...x),P=I4e(C);let E=typeof i=="function"?i(P):P();const j=w(...E);return Pae(y,h,j)}function Bae(e){const t={},n=[];let r;const a={addCase(l,h){const i=typeof l=="string"?l:l.type;if(!i)throw new Error(Eh(28));if(i in t)throw new Error(Eh(29));return t[i]=h,a},addAsyncThunk(l,h){return h.pending&&(t[l.pending.type]=h.pending),h.rejected&&(t[l.rejected.type]=h.rejected),h.fulfilled&&(t[l.fulfilled.type]=h.fulfilled),h.settled&&n.push({matcher:l.settled,reducer:h.settled}),a},addMatcher(l,h){return n.push({matcher:l,reducer:h}),a},addDefaultCase(l){return r=l,a}};return e(a),[t,n,r]}function M4e(e){return typeof e=="function"}function L4e(e,t){let[n,r,a]=Bae(t),l;if(M4e(e))l=()=>DH(e());else{const i=DH(e);l=()=>i}function h(i=l(),y){let x=[n[y.type],...r.filter(({matcher:w})=>w(y)).map(({reducer:w})=>w)];return x.filter(w=>!!w).length===0&&(x=[a]),x.reduce((w,C)=>{if(C)if(gx(w)){const E=C(w,y);return E===void 0?w:E}else{if(dy(w))return Oae(w,P=>C(P,y));{const P=C(w,y);if(P===void 0){if(w===null)return w;throw Error("A case reducer on a non-draftable value must not return undefined")}return P}}return w},i)}return h.getInitialState=l,h}var D4e="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",R4e=(e=21)=>{let t="",n=e;for(;n--;)t+=D4e[Math.random()*64|0];return t},j4e=Symbol.for("rtk-slice-createasyncthunk");function O4e(e,t){return`${e}/${t}`}function F4e({creators:e}={}){var n;const t=(n=e==null?void 0:e.asyncThunk)==null?void 0:n[j4e];return function(a){const{name:l,reducerPath:h=l}=a;if(!l)throw new Error(Eh(11));typeof process<"u";const i=(typeof a.reducers=="function"?a.reducers(B4e()):a.reducers)||{},y=Object.keys(i),x={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},w={addCase(J,ee){const Q=typeof J=="string"?J:J.type;if(!Q)throw new Error(Eh(12));if(Q in x.sliceCaseReducersByType)throw new Error(Eh(13));return x.sliceCaseReducersByType[Q]=ee,w},addMatcher(J,ee){return x.sliceMatchers.push({matcher:J,reducer:ee}),w},exposeAction(J,ee){return x.actionCreators[J]=ee,w},exposeCaseReducer(J,ee){return x.sliceCaseReducersByName[J]=ee,w}};y.forEach(J=>{const ee=i[J],Q={reducerName:J,type:O4e(l,J),createNotation:typeof a.reducers=="function"};V4e(ee)?q4e(Q,ee,w,t):U4e(Q,ee,w)});function C(){const[J={},ee=[],Q=void 0]=typeof a.extraReducers=="function"?Bae(a.extraReducers):[a.extraReducers],ne={...J,...x.sliceCaseReducersByType};return L4e(a.initialState,pe=>{for(let he in ne)pe.addCase(he,ne[he]);for(let he of x.sliceMatchers)pe.addMatcher(he.matcher,he.reducer);for(let he of ee)pe.addMatcher(he.matcher,he.reducer);Q&&pe.addDefaultCase(Q)})}const P=J=>J,E=new Map,j=new WeakMap;let D;function B(J,ee){return D||(D=C()),D(J,ee)}function F(){return D||(D=C()),D.getInitialState()}function $(J,ee=!1){function Q(pe){let he=pe[J];return typeof he>"u"&&ee&&(he=oE(j,Q,F)),he}function ne(pe=P){const he=oE(E,ee,()=>new WeakMap);return oE(he,pe,()=>{const we={};for(const[fe,ge]of Object.entries(a.selectors??{}))we[fe]=z4e(ge,pe,()=>oE(j,pe,F),ee);return we})}return{reducerPath:J,getSelectors:ne,get selectors(){return ne(Q)},selectSlice:Q}}const H={name:l,reducer:B,actions:x.actionCreators,caseReducers:x.sliceCaseReducersByName,getInitialState:F,...$(h),injectInto(J,{reducerPath:ee,...Q}={}){const ne=ee??h;return J.inject({reducerPath:ne,reducer:B},Q),{...H,...$(ne,!0)}}};return H}}function z4e(e,t,n,r){function a(l,...h){let i=t(l);return typeof i>"u"&&r&&(i=n()),e(i,...h)}return a.unwrapped=e,a}var Dh=F4e();function B4e(){function e(t,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...n}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...n){return t(...n)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:n}},asyncThunk:e}}function U4e({type:e,reducerName:t,createNotation:n},r,a){let l,h;if("reducer"in r){if(n&&!$4e(r))throw new Error(Eh(17));l=r.reducer,h=r.prepare}else l=r;a.addCase(e,l).exposeCaseReducer(t,l).exposeAction(t,h?wf(e,h):wf(e))}function V4e(e){return e._reducerDefinitionType==="asyncThunk"}function $4e(e){return e._reducerDefinitionType==="reducerWithPrepare"}function q4e({type:e,reducerName:t},n,r,a){if(!a)throw new Error(Eh(18));const{payloadCreator:l,fulfilled:h,pending:i,rejected:y,settled:x,options:w}=n,C=a(e,l,w);r.exposeAction(t,C),h&&r.addCase(C.fulfilled,h),i&&r.addCase(C.pending,i),y&&r.addCase(C.rejected,y),x&&r.addMatcher(C.settled,x),r.exposeCaseReducer(t,{fulfilled:h||lE,pending:i||lE,rejected:y||lE,settled:x||lE})}function lE(){}var G4e="task",Uae="listener",Vae="completed",Tz="cancelled",H4e=`task-${Tz}`,W4e=`task-${Vae}`,mj=`${Uae}-${Tz}`,Z4e=`${Uae}-${Vae}`,RI=class{constructor(e){ni(this,"name","TaskAbortError");ni(this,"message");this.code=e,this.message=`${G4e} ${Tz} (reason: ${e})`}},Cz=(e,t)=>{if(typeof e!="function")throw new TypeError(Eh(32))},Ek=()=>{},$ae=(e,t=Ek)=>(e.catch(t),e),qae=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),J_=(e,t)=>{const n=e.signal;n.aborted||("reason"in n||Object.defineProperty(n,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Q_=e=>{if(e.aborted){const{reason:t}=e;throw new RI(t)}};function Gae(e,t){let n=Ek;return new Promise((r,a)=>{const l=()=>a(new RI(e.reason));if(e.aborted){l();return}n=qae(e,l),t.finally(()=>n()).then(r,a)}).finally(()=>{n=Ek})}var K4e=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(n){return{status:n instanceof RI?"cancelled":"rejected",error:n}}finally{t==null||t()}},Pk=e=>t=>$ae(Gae(e,t).then(n=>(Q_(e),n))),Hae=e=>{const t=Pk(e);return n=>t(new Promise(r=>setTimeout(r,n)))},{assign:bb}=Object,jH={},jI="listenerMiddleware",Y4e=(e,t)=>{const n=r=>qae(e,()=>J_(r,e.reason));return(r,a)=>{Cz(r);const l=new AbortController;n(l);const h=K4e(async()=>{Q_(e),Q_(l.signal);const i=await r({pause:Pk(l.signal),delay:Hae(l.signal),signal:l.signal});return Q_(l.signal),i},()=>J_(l,W4e));return a!=null&&a.autoJoin&&t.push(h.catch(Ek)),{result:Pk(e)(h),cancel(){J_(l,H4e)}}}},X4e=(e,t)=>{const n=async(r,a)=>{Q_(t);let l=()=>{};const i=[new Promise((y,x)=>{let w=e({predicate:r,effect:(C,P)=>{P.unsubscribe(),y([C,P.getState(),P.getOriginalState()])}});l=()=>{w(),x()}})];a!=null&&i.push(new Promise(y=>setTimeout(y,a,null)));try{const y=await Gae(t,Promise.race(i));return Q_(t),y}finally{l()}};return(r,a)=>$ae(n(r,a))},Wae=e=>{let{type:t,actionCreator:n,matcher:r,predicate:a,effect:l}=e;if(t)a=wf(t).match;else if(n)t=n.type,a=n.match;else if(r)a=r;else if(!a)throw new Error(Eh(21));return Cz(l),{predicate:a,type:t,effect:l}},Zae=bb(e=>{const{type:t,predicate:n,effect:r}=Wae(e);return{id:R4e(),effect:r,type:t,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(Eh(22))}}},{withTypes:()=>Zae}),OH=(e,t)=>{const{type:n,effect:r,predicate:a}=Wae(t);return Array.from(e.values()).find(l=>(typeof n=="string"?l.type===n:l.predicate===a)&&l.effect===r)},gj=e=>{e.pending.forEach(t=>{J_(t,mj)})},J4e=e=>()=>{e.forEach(gj),e.clear()},FH=(e,t,n)=>{try{e(t,n)}catch(r){setTimeout(()=>{throw r},0)}},Kae=bb(wf(`${jI}/add`),{withTypes:()=>Kae}),Q4e=wf(`${jI}/removeAll`),Yae=bb(wf(`${jI}/remove`),{withTypes:()=>Yae}),eDe=(...e)=>{console.error(`${jI}/error`,...e)},G5=(e={})=>{const t=new Map,{extra:n,onError:r=eDe}=e;Cz(r);const a=w=>(w.unsubscribe=()=>t.delete(w.id),t.set(w.id,w),C=>{w.unsubscribe(),C!=null&&C.cancelActive&&gj(w)}),l=w=>{const C=OH(t,w)??Zae(w);return a(C)};bb(l,{withTypes:()=>l});const h=w=>{const C=OH(t,w);return C&&(C.unsubscribe(),w.cancelActive&&gj(C)),!!C};bb(h,{withTypes:()=>h});const i=async(w,C,P,E)=>{const j=new AbortController,D=X4e(l,j.signal),B=[];try{w.pending.add(j),await Promise.resolve(w.effect(C,bb({},P,{getOriginalState:E,condition:(F,$)=>D(F,$).then(Boolean),take:D,delay:Hae(j.signal),pause:Pk(j.signal),extra:n,signal:j.signal,fork:Y4e(j.signal,B),unsubscribe:w.unsubscribe,subscribe:()=>{t.set(w.id,w)},cancelActiveListeners:()=>{w.pending.forEach((F,$,H)=>{F!==j&&(J_(F,mj),H.delete(F))})},cancel:()=>{J_(j,mj),w.pending.delete(j)},throwIfCancelled:()=>{Q_(j.signal)}})))}catch(F){F instanceof RI||FH(r,F,{raisedBy:"effect"})}finally{await Promise.all(B),J_(j,Z4e),w.pending.delete(j)}},y=J4e(t);return{middleware:w=>C=>P=>{if(!Iae(P))return C(P);if(Kae.match(P))return l(P.payload);if(Q4e.match(P)){y();return}if(Yae.match(P))return h(P.payload);let E=w.getState();const j=()=>{if(E===jH)throw new Error(Eh(23));return E};let D;try{if(D=C(P),t.size>0){const B=w.getState(),F=Array.from(t.values());for(const $ of F){let H=!1;try{H=$.predicate(P,B,E)}catch(J){H=!1,FH(r,J,{raisedBy:"predicate"})}H&&i($,P,w,j)}}}finally{E=jH}return D},startListening:l,stopListening:h,clearListeners:y}};function Eh(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var tDe={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},Xae=Dh({name:"chartLayout",initialState:tDe,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var n,r,a,l;e.margin.top=(n=t.payload.top)!==null&&n!==void 0?n:0,e.margin.right=(r=t.payload.right)!==null&&r!==void 0?r:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(l=t.payload.left)!==null&&l!==void 0?l:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:nDe,setLayout:rDe,setChartSize:iDe,setScale:sDe}=Xae.actions,aDe=Xae.reducer;function zH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function BH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?zH(Object(n),!0).forEach(function(r){oDe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function oDe(e,t,n){return(t=lDe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lDe(e){var t=cDe(e,"string");return typeof t=="symbol"?t:t+""}function cDe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kk=Math.PI/180,uDe=e=>e*180/Math.PI,Bl=(e,t,n,r)=>({x:e+Math.cos(-kk*r)*n,y:t+Math.sin(-kk*r)*n}),Jae=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0,width:0,height:0,brushBottom:0};return Math.min(Math.abs(t-(r.left||0)-(r.right||0)),Math.abs(n-(r.top||0)-(r.bottom||0)))/2},dDe=(e,t)=>{var{x:n,y:r}=e,{x:a,y:l}=t;return Math.sqrt((n-a)**2+(r-l)**2)},hDe=(e,t)=>{var{x:n,y:r}=e,{cx:a,cy:l}=t,h=dDe({x:n,y:r},{x:a,y:l});if(h<=0)return{radius:h,angle:0};var i=(n-a)/h,y=Math.acos(i);return r>l&&(y=2*Math.PI-y),{radius:h,angle:uDe(y),angleInRadian:y}},fDe=e=>{var{startAngle:t,endAngle:n}=e,r=Math.floor(t/360),a=Math.floor(n/360),l=Math.min(r,a);return{startAngle:t-l*360,endAngle:n-l*360}},pDe=(e,t)=>{var{startAngle:n,endAngle:r}=t,a=Math.floor(n/360),l=Math.floor(r/360),h=Math.min(a,l);return e+h*360},mDe=(e,t)=>{var{x:n,y:r}=e,{radius:a,angle:l}=hDe({x:n,y:r},t),{innerRadius:h,outerRadius:i}=t;if(a<h||a>i||a===0)return null;var{startAngle:y,endAngle:x}=fDe(t),w=l,C;if(y<=x){for(;w>x;)w-=360;for(;w<y;)w+=360;C=w>=y&&w<=x}else{for(;w>y;)w-=360;for(;w<x;)w+=360;C=w>=x&&w<=y}return C?BH(BH({},t),{},{radius:a,angle:pDe(w,t)}):null};function Qae(e,t,n){return Array.isArray(e)&&e&&t+n!==0?e.slice(t,n+1):e}function UH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function hf(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?UH(Object(n),!0).forEach(function(r){gDe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function gDe(e,t,n){return(t=yDe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yDe(e){var t=vDe(e,"string");return typeof t=="symbol"?t:t+""}function vDe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qa(e,t,n){return Co(e)||Co(t)?n:Gm(t)?mx(e,t,n):typeof t=="function"?t(e):n}var _De=(e,t,n,r,a)=>{var l,h=-1,i=(l=t==null?void 0:t.length)!==null&&l!==void 0?l:0;if(i<=1||e==null)return 0;if(r==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var y=0;y<i;y++){var x=y>0?n[y-1].coordinate:n[i-1].coordinate,w=n[y].coordinate,C=y>=i-1?n[0].coordinate:n[y+1].coordinate,P=void 0;if(Ec(w-x)!==Ec(C-w)){var E=[];if(Ec(C-w)===Ec(a[1]-a[0])){P=C;var j=w+a[1]-a[0];E[0]=Math.min(j,(j+x)/2),E[1]=Math.max(j,(j+x)/2)}else{P=x;var D=C+a[1]-a[0];E[0]=Math.min(w,(D+w)/2),E[1]=Math.max(w,(D+w)/2)}var B=[Math.min(w,(P+w)/2),Math.max(w,(P+w)/2)];if(e>B[0]&&e<=B[1]||e>=E[0]&&e<=E[1]){({index:h}=n[y]);break}}else{var F=Math.min(x,C),$=Math.max(x,C);if(e>(F+w)/2&&e<=($+w)/2){({index:h}=n[y]);break}}}else if(t){for(var H=0;H<i;H++)if(H===0&&e<=(t[H].coordinate+t[H+1].coordinate)/2||H>0&&H<i-1&&e>(t[H].coordinate+t[H-1].coordinate)/2&&e<=(t[H].coordinate+t[H+1].coordinate)/2||H===i-1&&e>(t[H].coordinate+t[H-1].coordinate)/2){({index:h}=t[H]);break}}return h},xDe=(e,t,n)=>{if(t&&n){var{width:r,height:a}=n,{align:l,verticalAlign:h,layout:i}=t;if((i==="vertical"||i==="horizontal"&&h==="middle")&&l!=="center"&&wi(e[l]))return hf(hf({},e),{},{[l]:e[l]+(r||0)});if((i==="horizontal"||i==="vertical"&&l==="center")&&h!=="middle"&&wi(e[h]))return hf(hf({},e),{},{[h]:e[h]+(a||0)})}return e},Xm=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",eoe=(e,t,n,r)=>{if(r)return e.map(i=>i.coordinate);var a,l,h=e.map(i=>(i.coordinate===t&&(a=!0),i.coordinate===n&&(l=!0),i.coordinate));return a||h.push(t),l||h.push(n),h},toe=(e,t,n)=>{if(!e)return null;var{duplicateDomain:r,type:a,range:l,scale:h,realScaleType:i,isCategorical:y,categoricalDomain:x,tickCount:w,ticks:C,niceTicks:P,axisType:E}=e;if(!h)return null;var j=i==="scaleBand"&&h.bandwidth?h.bandwidth()/2:2,D=a==="category"&&h.bandwidth?h.bandwidth()/j:0;if(D=E==="angleAxis"&&l&&l.length>=2?Ec(l[0]-l[1])*2*D:D,C||P){var B=(C||P||[]).map((F,$)=>{var H=r?r.indexOf(F):F;return{coordinate:h(H)+D,value:F,offset:D,index:$}});return B.filter(F=>!Zd(F.coordinate))}return y&&x?x.map((F,$)=>({coordinate:h(F)+D,value:F,index:$,offset:D})):h.ticks&&!n&&w!=null?h.ticks(w).map((F,$)=>({coordinate:h(F)+D,value:F,offset:D,index:$})):h.domain().map((F,$)=>({coordinate:h(F)+D,value:r?r[F]:F,index:$,offset:D}))},VH=1e-4,bDe=e=>{var t=e.domain();if(!(!t||t.length<=2)){var n=t.length,r=e.range(),a=Math.min(r[0],r[1])-VH,l=Math.max(r[0],r[1])+VH,h=e(t[0]),i=e(t[n-1]);(h<a||h>l||i<a||i>l)&&e.domain([t[0],t[n-1]])}},wDe=(e,t)=>{if(!t||t.length!==2||!wi(t[0])||!wi(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!wi(e[0])||e[0]<n)&&(a[0]=n),(!wi(e[1])||e[1]>r)&&(a[1]=r),a[0]>r&&(a[0]=r),a[1]<n&&(a[1]=n),a},SDe=e=>{var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,l=0,h=0;h<t;++h){var i=Zd(e[h][n][1])?e[h][n][0]:e[h][n][1];i>=0?(e[h][n][0]=a,e[h][n][1]=a+i,a=e[h][n][1]):(e[h][n][0]=l,e[h][n][1]=l+i,l=e[h][n][1])}},ADe=e=>{var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var a=0,l=0;l<t;++l){var h=Zd(e[l][n][1])?e[l][n][0]:e[l][n][1];h>=0?(e[l][n][0]=a,e[l][n][1]=a+h,a=e[l][n][1]):(e[l][n][0]=0,e[l][n][1]=0)}},TDe={sign:SDe,expand:fLe,none:lw,silhouette:pLe,wiggle:mLe,positive:ADe},CDe=(e,t,n)=>{var r=TDe[n],a=hLe().keys(t).value((l,h)=>+qa(l,h,0)).order(oj).offset(r);return a(e)};function noe(e){return e==null?void 0:String(e)}function Ik(e){var{axis:t,ticks:n,bandSize:r,entry:a,index:l,dataKey:h}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Co(a[t.dataKey])){var i=Mse(n,"value",a[t.dataKey]);if(i)return i.coordinate+r/2}return n[l]?n[l].coordinate+r/2:null}var y=qa(a,Co(h)?t.dataKey:h);return Co(y)?null:t.scale(y)}var $H=e=>{var{axis:t,ticks:n,offset:r,bandSize:a,entry:l,index:h}=e;if(t.type==="category")return n[h]?n[h].coordinate+r:null;var i=qa(l,t.dataKey,t.scale.domain()[h]);return Co(i)?null:t.scale(i)-a/2+r},EDe=e=>{var{numericAxis:t}=e,n=t.scale.domain();if(t.type==="number"){var r=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return r<=0&&a>=0?0:a<0?a:r}return n[0]},PDe=e=>{var t=e.flat(2).filter(wi);return[Math.min(...t),Math.max(...t)]},kDe=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],IDe=(e,t,n)=>{if(e!=null)return kDe(Object.keys(e).reduce((r,a)=>{var l=e[a],{stackedData:h}=l,i=h.reduce((y,x)=>{var w=Qae(x,t,n),C=PDe(w);return[Math.min(y[0],C[0]),Math.max(y[1],C[1])]},[1/0,-1/0]);return[Math.min(i[0],r[0]),Math.max(i[1],r[1])]},[1/0,-1/0]))},qH=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,GH=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,vx=(e,t,n)=>{if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var a=NI(t,w=>w.coordinate),l=1/0,h=1,i=a.length;h<i;h++){var y=a[h],x=a[h-1];l=Math.min((y.coordinate||0)-(x.coordinate||0),l)}return l===1/0?0:l}return n?void 0:0};function HH(e){var{tooltipEntrySettings:t,dataKey:n,payload:r,value:a,name:l}=e;return hf(hf({},t),{},{dataKey:n,payload:r,value:a,name:l})}function kv(e,t){if(e)return String(e);if(typeof t=="string")return t}function NDe(e,t,n,r,a){if(n==="horizontal"||n==="vertical"){var l=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return l?{x:e,y:t}:null}return r?mDe({x:e,y:t},r):null}var MDe=(e,t,n,r)=>{var a=t.find(x=>x&&x.index===n);if(a){if(e==="horizontal")return{x:a.coordinate,y:r.y};if(e==="vertical")return{x:r.x,y:a.coordinate};if(e==="centric"){var l=a.coordinate,{radius:h}=r;return hf(hf(hf({},r),Bl(r.cx,r.cy,h,l)),{},{angle:l,radius:h})}var i=a.coordinate,{angle:y}=r;return hf(hf(hf({},r),Bl(r.cx,r.cy,i,y)),{},{angle:y,radius:i})}return{x:0,y:0}},LDe=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,vy=e=>e.layout.width,_y=e=>e.layout.height,DDe=e=>e.layout.scale,roe=e=>e.layout.margin,OI=_n(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),FI=_n(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),ioe="data-recharts-item-index",soe="data-recharts-item-data-key",H5=60;function WH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function cE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?WH(Object(n),!0).forEach(function(r){RDe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function RDe(e,t,n){return(t=jDe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jDe(e){var t=ODe(e,"string");return typeof t=="symbol"?t:t+""}function ODe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FDe=e=>e.brush.height;function zDe(e){var t=FI(e);return t.reduce((n,r)=>{if(r.orientation==="left"&&!r.mirror&&!r.hide){var a=typeof r.width=="number"?r.width:H5;return n+a}return n},0)}function BDe(e){var t=FI(e);return t.reduce((n,r)=>{if(r.orientation==="right"&&!r.mirror&&!r.hide){var a=typeof r.width=="number"?r.width:H5;return n+a}return n},0)}function UDe(e){var t=OI(e);return t.reduce((n,r)=>r.orientation==="top"&&!r.mirror&&!r.hide?n+r.height:n,0)}function VDe(e){var t=OI(e);return t.reduce((n,r)=>r.orientation==="bottom"&&!r.mirror&&!r.hide?n+r.height:n,0)}var nc=_n([vy,_y,roe,FDe,zDe,BDe,UDe,VDe,Eae,o4e],(e,t,n,r,a,l,h,i,y,x)=>{var w={left:(n.left||0)+a,right:(n.right||0)+l},C={top:(n.top||0)+h,bottom:(n.bottom||0)+i},P=cE(cE({},C),w),E=P.bottom;P.bottom+=r,P=xDe(P,y,x);var j=e-P.left-P.right,D=t-P.top-P.bottom;return cE(cE({brushBottom:E},P),{},{width:Math.max(j,0),height:Math.max(D,0)})}),$De=_n(nc,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),Ez=_n(vy,_y,(e,t)=>({x:0,y:0,width:e,height:t})),qDe=L.createContext(null),Pu=()=>L.useContext(qDe)!=null,zI=e=>e.brush,BI=_n([zI,nc,roe],(e,t,n)=>({height:e.height,x:wi(e.x)?e.x:t.left,y:wi(e.y)?e.y:t.top+t.height+t.brushBottom-((n==null?void 0:n.bottom)||0),width:wi(e.width)?e.width:t.width})),Pz=()=>{var e,t=Pu(),n=Si($De),r=Si(BI),a=(e=Si(zI))===null||e===void 0?void 0:e.padding;return!t||!r||!a?n:{width:r.width-a.left-a.right,height:r.height-a.top-a.bottom,x:a.left,y:a.top}},GDe={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},aoe=()=>{var e;return(e=Si(nc))!==null&&e!==void 0?e:GDe},ooe=()=>Si(vy),loe=()=>Si(_y),Hs=e=>e.layout.layoutType,W5=()=>Si(Hs),HDe={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},coe=Dh({name:"legend",initialState:HDe,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var n=Wg(e).payload.indexOf(t.payload);n>-1&&e.payload.splice(n,1)}}}),{setLegendSize:VXe,setLegendSettings:$Xe,addLegendPayload:uoe,removeLegendPayload:doe}=coe.actions,WDe=coe.reducer;function yj(){return yj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yj.apply(null,arguments)}function ZH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function c4(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ZH(Object(n),!0).forEach(function(r){ZDe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ZH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ZDe(e,t,n){return(t=KDe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KDe(e){var t=YDe(e,"string");return typeof t=="symbol"?t:t+""}function YDe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XDe(e){return Array.isArray(e)&&Gm(e[0])&&Gm(e[1])?e.join(" ~ "):e}var JDe=e=>{var{separator:t=" : ",contentStyle:n={},itemStyle:r={},labelStyle:a={},payload:l,formatter:h,itemSorter:i,wrapperClassName:y,labelClassName:x,label:w,labelFormatter:C,accessibilityLayer:P=!1}=e,E=()=>{if(l&&l.length){var ee={padding:0,margin:0},Q=(i?NI(l,i):l).map((ne,pe)=>{if(ne.type==="none")return null;var he=ne.formatter||h||XDe,{value:we,name:fe}=ne,ge=we,Ce=fe;if(he){var xe=he(we,fe,ne,pe,l);if(Array.isArray(xe))[ge,Ce]=xe;else if(xe!=null)ge=xe;else return null}var Re=c4({display:"block",paddingTop:4,paddingBottom:4,color:ne.color||"#000"},r);return L.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(pe),style:Re},Gm(Ce)?L.createElement("span",{className:"recharts-tooltip-item-name"},Ce):null,Gm(Ce)?L.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,L.createElement("span",{className:"recharts-tooltip-item-value"},ge),L.createElement("span",{className:"recharts-tooltip-item-unit"},ne.unit||""))});return L.createElement("ul",{className:"recharts-tooltip-item-list",style:ee},Q)}return null},j=c4({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},n),D=c4({margin:0},a),B=!Co(w),F=B?w:"",$=ra("recharts-default-tooltip",y),H=ra("recharts-tooltip-label",x);B&&C&&l!==void 0&&l!==null&&(F=C(w,l));var J=P?{role:"status","aria-live":"assertive"}:{};return L.createElement("div",yj({className:$,style:j},J),L.createElement("p",{className:H,style:D},L.isValidElement(F)?F:"".concat(F)),E())},hS="recharts-tooltip-wrapper",QDe={visibility:"hidden"};function eRe(e){var{coordinate:t,translateX:n,translateY:r}=e;return ra(hS,{["".concat(hS,"-right")]:wi(n)&&t&&wi(t.x)&&n>=t.x,["".concat(hS,"-left")]:wi(n)&&t&&wi(t.x)&&n<t.x,["".concat(hS,"-bottom")]:wi(r)&&t&&wi(t.y)&&r>=t.y,["".concat(hS,"-top")]:wi(r)&&t&&wi(t.y)&&r<t.y})}function KH(e){var{allowEscapeViewBox:t,coordinate:n,key:r,offsetTopLeft:a,position:l,reverseDirection:h,tooltipDimension:i,viewBox:y,viewBoxDimension:x}=e;if(l&&wi(l[r]))return l[r];var w=n[r]-i-(a>0?a:0),C=n[r]+a;if(t[r])return h[r]?w:C;var P=y[r];if(P==null)return 0;if(h[r]){var E=w,j=P;return E<j?Math.max(C,P):Math.max(w,P)}if(x==null)return 0;var D=C+i,B=P+x;return D>B?Math.max(w,P):Math.max(C,P)}function tRe(e){var{translateX:t,translateY:n,useTranslate3d:r}=e;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function nRe(e){var{allowEscapeViewBox:t,coordinate:n,offsetTopLeft:r,position:a,reverseDirection:l,tooltipBox:h,useTranslate3d:i,viewBox:y}=e,x,w,C;return h.height>0&&h.width>0&&n?(w=KH({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:r,position:a,reverseDirection:l,tooltipDimension:h.width,viewBox:y,viewBoxDimension:y.width}),C=KH({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:r,position:a,reverseDirection:l,tooltipDimension:h.height,viewBox:y,viewBoxDimension:y.height}),x=tRe({translateX:w,translateY:C,useTranslate3d:i})):x=QDe,{cssProperties:x,cssClasses:eRe({translateX:w,translateY:C,coordinate:n})}}function YH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function uE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?YH(Object(n),!0).forEach(function(r){vj(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function vj(e,t,n){return(t=rRe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rRe(e){var t=iRe(e,"string");return typeof t=="symbol"?t:t+""}function iRe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class sRe extends L.PureComponent{constructor(){super(...arguments),vj(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),vj(this,"handleKeyDown",t=>{if(t.key==="Escape"){var n,r,a,l;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(n=(r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==null&&n!==void 0?n:0,y:(a=(l=this.props.coordinate)===null||l===void 0?void 0:l.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,n;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((n=this.props.coordinate)===null||n===void 0?void 0:n.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:n,animationDuration:r,animationEasing:a,children:l,coordinate:h,hasPayload:i,isAnimationActive:y,offset:x,position:w,reverseDirection:C,useTranslate3d:P,viewBox:E,wrapperStyle:j,lastBoundingBox:D,innerRef:B,hasPortalFromProps:F}=this.props,{cssClasses:$,cssProperties:H}=nRe({allowEscapeViewBox:n,coordinate:h,offsetTopLeft:x,position:w,reverseDirection:C,tooltipBox:{height:D.height,width:D.width},useTranslate3d:P,viewBox:E}),J=F?{}:uE(uE({transition:y&&t?"transform ".concat(r,"ms ").concat(a):void 0},H),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&i?"visible":"hidden",position:"absolute",top:0,left:0}),ee=uE(uE({},J),{},{visibility:!this.state.dismissed&&t&&i?"visible":"hidden"},j);return L.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:$,style:ee,ref:B},l)}}var aRe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),xy={devToolsEnabled:!1,isSsr:aRe()},hoe=()=>Si(e=>e.rootProps.accessibilityLayer);function Kc(e){return Number.isFinite(e)}function dw(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function _j(){return _j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_j.apply(null,arguments)}function XH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function JH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?XH(Object(n),!0).forEach(function(r){oRe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):XH(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function oRe(e,t,n){return(t=lRe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lRe(e){var t=cRe(e,"string");return typeof t=="symbol"?t:t+""}function cRe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QH={curveBasisClosed:tLe,curveBasisOpen:nLe,curveBasis:eLe,curveBumpX:BMe,curveBumpY:UMe,curveLinearClosed:rLe,curveLinear:EI,curveMonotoneX:iLe,curveMonotoneY:sLe,curveNatural:aLe,curveStep:oLe,curveStepAfter:cLe,curveStepBefore:lLe},dE=e=>Kc(e.x)&&Kc(e.y),fS=e=>e.x,pS=e=>e.y,uRe=(e,t)=>{if(typeof e=="function")return e;var n="curve".concat($5(e));return(n==="curveMonotone"||n==="curveBump")&&t?QH["".concat(n).concat(t==="vertical"?"Y":"X")]:QH[n]||EI},dRe=e=>{var{type:t="linear",points:n=[],baseLine:r,layout:a,connectNulls:l=!1}=e,h=uRe(t,a),i=l?n.filter(dE):n,y;if(Array.isArray(r)){var x=l?r.filter(C=>dE(C)):r,w=i.map((C,P)=>JH(JH({},C),{},{base:x[P]}));return a==="vertical"?y=rE().y(pS).x1(fS).x0(C=>C.base.x):y=rE().x(fS).y1(pS).y0(C=>C.base.y),y.defined(dE).curve(h),y(w)}return a==="vertical"&&wi(r)?y=rE().y(pS).x1(fS).x0(r):wi(r)?y=rE().x(fS).y1(pS).y0(r):y=Use().x(fS).y(pS),y.defined(dE).curve(h),y(i)},wb=e=>{var{className:t,points:n,path:r,pathRef:a}=e;if((!n||!n.length)&&!r)return null;var l=n&&n.length?dRe(e):r;return L.createElement("path",_j({},If(e),sz(e),{className:ra("recharts-curve",t),d:l===null?void 0:l,ref:a}))},hRe=["x","y","top","left","width","height","className"];function xj(){return xj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xj.apply(null,arguments)}function eW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function fRe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?eW(Object(n),!0).forEach(function(r){pRe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function pRe(e,t,n){return(t=mRe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mRe(e){var t=gRe(e,"string");return typeof t=="symbol"?t:t+""}function gRe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yRe(e,t){if(e==null)return{};var n,r,a=vRe(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function vRe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var _Re=(e,t,n,r,a,l)=>"M".concat(e,",").concat(a,"v").concat(r,"M").concat(l,",").concat(t,"h").concat(n),xRe=e=>{var{x:t=0,y:n=0,top:r=0,left:a=0,width:l=0,height:h=0,className:i}=e,y=yRe(e,hRe),x=fRe({x:t,y:n,top:r,left:a,width:l,height:h},y);return!wi(t)||!wi(n)||!wi(l)||!wi(h)||!wi(r)||!wi(a)?null:L.createElement("path",xj({},Eo(x,!0),{className:ra("recharts-cross",i),d:_Re(t,n,l,h,r,a)}))};function bRe(e,t,n,r){var a=r/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-a,width:e==="horizontal"?r:n.width-1,height:e==="horizontal"?n.height-1:r}}function tW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function wRe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?tW(Object(n),!0).forEach(function(r){SRe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function SRe(e,t,n){return(t=ARe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ARe(e){var t=TRe(e,"string");return typeof t=="symbol"?t:t+""}function TRe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rc(e,t){var n=wRe({},e),r=t,a=Object.keys(t),l=a.reduce((h,i)=>(h[i]===void 0&&r[i]!==void 0&&(h[i]=r[i]),h),n);return l}function CRe(){}function nW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function rW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nW(Object(n),!0).forEach(function(r){ERe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ERe(e,t,n){return(t=PRe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PRe(e){var t=kRe(e,"string");return typeof t=="symbol"?t:t+""}function kRe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IRe=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),foe=(e,t,n)=>e.map(r=>"".concat(IRe(r)," ").concat(t,"ms ").concat(n)).join(","),NRe=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((n,r)=>n.filter(a=>r.includes(a))),KA=(e,t)=>Object.keys(t).reduce((n,r)=>rW(rW({},n),{},{[r]:e(r,t[r])}),{});function iW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Gc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?iW(Object(n),!0).forEach(function(r){MRe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function MRe(e,t,n){return(t=LRe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function LRe(e){var t=DRe(e,"string");return typeof t=="symbol"?t:t+""}function DRe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nk=(e,t,n)=>e+(t-e)*n,bj=e=>{var{from:t,to:n}=e;return t!==n},poe=(e,t,n)=>{var r=KA((a,l)=>{if(bj(l)){var[h,i]=e(l.from,l.to,l.velocity);return Gc(Gc({},l),{},{from:h,velocity:i})}return l},t);return n<1?KA((a,l)=>bj(l)?Gc(Gc({},l),{},{velocity:Nk(l.velocity,r[a].velocity,n),from:Nk(l.from,r[a].from,n)}):l,t):poe(e,r,n-1)};function RRe(e,t,n,r,a,l){var h,i=r.reduce((P,E)=>Gc(Gc({},P),{},{[E]:{from:e[E],velocity:0,to:t[E]}}),{}),y=()=>KA((P,E)=>E.from,i),x=()=>!Object.values(i).filter(bj).length,w=null,C=P=>{h||(h=P);var E=P-h,j=E/n.dt;i=poe(n,i,j),a(Gc(Gc(Gc({},e),t),y())),h=P,x()||(w=l.setTimeout(C))};return()=>(w=l.setTimeout(C),()=>{w()})}function jRe(e,t,n,r,a,l,h){var i=null,y=a.reduce((C,P)=>Gc(Gc({},C),{},{[P]:[e[P],t[P]]}),{}),x,w=C=>{x||(x=C);var P=(C-x)/r,E=KA((D,B)=>Nk(...B,n(P)),y);if(l(Gc(Gc(Gc({},e),t),E)),P<1)i=h.setTimeout(w);else{var j=KA((D,B)=>Nk(...B,n(1)),y);l(Gc(Gc(Gc({},e),t),j))}};return()=>(i=h.setTimeout(w),()=>{i()})}const ORe=(e,t,n,r,a,l)=>{var h=NRe(e,t);return n.isStepper===!0?RRe(e,t,n,h,a,l):jRe(e,t,n,r,h,a,l)};var Mk=1e-4,moe=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],goe=(e,t)=>e.map((n,r)=>n*t**r).reduce((n,r)=>n+r),sW=(e,t)=>n=>{var r=moe(e,t);return goe(r,n)},FRe=(e,t)=>n=>{var r=moe(e,t),a=[...r.map((l,h)=>l*h).slice(1),0];return goe(a,n)},aW=function(){for(var t,n,r,a,l=arguments.length,h=new Array(l),i=0;i<l;i++)h[i]=arguments[i];if(h.length===1)switch(h[0]){case"linear":[t,r,n,a]=[0,0,1,1];break;case"ease":[t,r,n,a]=[.25,.1,.25,1];break;case"ease-in":[t,r,n,a]=[.42,0,1,1];break;case"ease-out":[t,r,n,a]=[.42,0,.58,1];break;case"ease-in-out":[t,r,n,a]=[0,0,.58,1];break;default:{var y=h[0].split("(");y[0]==="cubic-bezier"&&y[1].split(")")[0].split(",").length===4&&([t,r,n,a]=y[1].split(")")[0].split(",").map(j=>parseFloat(j)))}}else h.length===4&&([t,r,n,a]=h);var x=sW(t,n),w=sW(r,a),C=FRe(t,n),P=j=>j>1?1:j<0?0:j,E=j=>{for(var D=j>1?1:j,B=D,F=0;F<8;++F){var $=x(B)-D,H=C(B);if(Math.abs($-D)<Mk||H<Mk)return w(B);B=P(B-$/H)}return w(B)};return E.isStepper=!1,E},zRe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:n=100,damping:r=8,dt:a=17}=t,l=(h,i,y)=>{var x=-(h-i)*n,w=y*r,C=y+(x-w)*a/1e3,P=y*a/1e3+h;return Math.abs(P-i)<Mk&&Math.abs(C)<Mk?[i,0]:[P,C]};return l.isStepper=!0,l.dt=a,l},BRe=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return aW(e);case"spring":return zRe();default:if(e.split("(")[0]==="cubic-bezier")return aW(e)}return typeof e=="function"?e:null};function URe(e){var t,n=()=>null,r=!1,a=null,l=h=>{if(!r){if(Array.isArray(h)){if(!h.length)return;var i=h,[y,...x]=i;if(typeof y=="number"){a=e.setTimeout(l.bind(null,x),y);return}l(y),a=e.setTimeout(l.bind(null,x));return}typeof h=="string"&&(t=h,n(t)),typeof h=="object"&&(t=h,n(t)),typeof h=="function"&&h()}};return{stop:()=>{r=!0},start:h=>{r=!1,a&&(a(),a=null),l(h)},subscribe:h=>(n=h,()=>{n=()=>null}),getTimeoutController:()=>e}}class VRe{setTimeout(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=performance.now(),a=null,l=h=>{h-r>=n?t(h):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(l))};return a=requestAnimationFrame(l),()=>{cancelAnimationFrame(a)}}}function $Re(){return URe(new VRe)}var qRe=L.createContext($Re);function GRe(e,t){var n=L.useContext(qRe);return L.useMemo(()=>t??n(e),[e,t,n])}var HRe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},oW={t:0},u4={t:1};function Dw(e){var t=rc(e,HRe),{isActive:n,canBegin:r,duration:a,easing:l,begin:h,onAnimationEnd:i,onAnimationStart:y,children:x}=t,w=GRe(t.animationId,t.animationManager),[C,P]=L.useState(n?oW:u4),E=L.useRef(null);return L.useEffect(()=>{n||P(u4)},[n]),L.useEffect(()=>{if(!n||!r)return CRe;var j=ORe(oW,u4,BRe(l),a,P,w.getTimeoutController()),D=()=>{E.current=j()};return w.start([y,h,D,a,i]),()=>{w.stop(),E.current&&E.current(),i()}},[n,r,a,l,h,y,i,w]),x(C.t)}function Rw(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",n=L.useRef(HA(t)),r=L.useRef(e);return r.current!==e&&(n.current=HA(t),r.current=e),n.current}function lW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function cW(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?lW(Object(n),!0).forEach(function(r){WRe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function WRe(e,t,n){return(t=ZRe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ZRe(e){var t=KRe(e,"string");return typeof t=="symbol"?t:t+""}function KRe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lk(){return Lk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Lk.apply(null,arguments)}var uW=(e,t,n,r,a)=>{var l=Math.min(Math.abs(n)/2,Math.abs(r)/2),h=r>=0?1:-1,i=n>=0?1:-1,y=r>=0&&n>=0||r<0&&n<0?1:0,x;if(l>0&&a instanceof Array){for(var w=[0,0,0,0],C=0,P=4;C<P;C++)w[C]=a[C]>l?l:a[C];x="M".concat(e,",").concat(t+h*w[0]),w[0]>0&&(x+="A ".concat(w[0],",").concat(w[0],",0,0,").concat(y,",").concat(e+i*w[0],",").concat(t)),x+="L ".concat(e+n-i*w[1],",").concat(t),w[1]>0&&(x+="A ".concat(w[1],",").concat(w[1],",0,0,").concat(y,`,
        `).concat(e+n,",").concat(t+h*w[1])),x+="L ".concat(e+n,",").concat(t+r-h*w[2]),w[2]>0&&(x+="A ".concat(w[2],",").concat(w[2],",0,0,").concat(y,`,
        `).concat(e+n-i*w[2],",").concat(t+r)),x+="L ".concat(e+i*w[3],",").concat(t+r),w[3]>0&&(x+="A ".concat(w[3],",").concat(w[3],",0,0,").concat(y,`,
        `).concat(e,",").concat(t+r-h*w[3])),x+="Z"}else if(l>0&&a===+a&&a>0){var E=Math.min(l,a);x="M ".concat(e,",").concat(t+h*E,`
            A `).concat(E,",").concat(E,",0,0,").concat(y,",").concat(e+i*E,",").concat(t,`
            L `).concat(e+n-i*E,",").concat(t,`
            A `).concat(E,",").concat(E,",0,0,").concat(y,",").concat(e+n,",").concat(t+h*E,`
            L `).concat(e+n,",").concat(t+r-h*E,`
            A `).concat(E,",").concat(E,",0,0,").concat(y,",").concat(e+n-i*E,",").concat(t+r,`
            L `).concat(e+i*E,",").concat(t+r,`
            A `).concat(E,",").concat(E,",0,0,").concat(y,",").concat(e,",").concat(t+r-h*E," Z")}else x="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(r," h ").concat(-n," Z");return x},YRe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},yoe=e=>{var t=rc(e,YRe),n=L.useRef(null),[r,a]=L.useState(-1);L.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var xe=n.current.getTotalLength();xe&&a(xe)}catch{}},[]);var{x:l,y:h,width:i,height:y,radius:x,className:w}=t,{animationEasing:C,animationDuration:P,animationBegin:E,isAnimationActive:j,isUpdateAnimationActive:D}=t,B=L.useRef(i),F=L.useRef(y),$=L.useRef(l),H=L.useRef(h),J=L.useMemo(()=>({x:l,y:h,width:i,height:y,radius:x}),[l,h,i,y,x]),ee=Rw(J,"rectangle-");if(l!==+l||h!==+h||i!==+i||y!==+y||i===0||y===0)return null;var Q=ra("recharts-rectangle",w);if(!D)return L.createElement("path",Lk({},Eo(t,!0),{className:Q,d:uW(l,h,i,y,x)}));var ne=B.current,pe=F.current,he=$.current,we=H.current,fe="0px ".concat(r===-1?1:r,"px"),ge="".concat(r,"px 0px"),Ce=foe(["strokeDasharray"],P,typeof C=="string"?C:void 0);return L.createElement(Dw,{animationId:ee,key:ee,canBegin:r>0,duration:P,easing:C,isActive:D,begin:E},xe=>{var Re=$a(ne,i,xe),Qe=$a(pe,y,xe),et=$a(he,l,xe),je=$a(we,h,xe);n.current&&(B.current=Re,F.current=Qe,$.current=et,H.current=je);var De;return j?xe>0?De={transition:Ce,strokeDasharray:ge}:De={strokeDasharray:fe}:De={strokeDasharray:ge},L.createElement("path",Lk({},Eo(t,!0),{className:Q,d:uW(et,je,Re,Qe,x),ref:n,style:cW(cW({},De),t.style)}))})};function voe(e){var{cx:t,cy:n,radius:r,startAngle:a,endAngle:l}=e,h=Bl(t,n,r,a),i=Bl(t,n,r,l);return{points:[h,i],cx:t,cy:n,radius:r,startAngle:a,endAngle:l}}function wj(){return wj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},wj.apply(null,arguments)}var XRe=(e,t)=>{var n=Ec(t-e),r=Math.min(Math.abs(t-e),359.999);return n*r},hE=e=>{var{cx:t,cy:n,radius:r,angle:a,sign:l,isExternal:h,cornerRadius:i,cornerIsExternal:y}=e,x=i*(h?1:-1)+r,w=Math.asin(i/x)/kk,C=y?a:a+l*w,P=Bl(t,n,x,C),E=Bl(t,n,r,C),j=y?a-l*w:a,D=Bl(t,n,x*Math.cos(w*kk),j);return{center:P,circleTangency:E,lineTangency:D,theta:w}},_oe=e=>{var{cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:l,endAngle:h}=e,i=XRe(l,h),y=l+i,x=Bl(t,n,a,l),w=Bl(t,n,a,y),C="M ".concat(x.x,",").concat(x.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(i)>180),",").concat(+(l>y),`,
    `).concat(w.x,",").concat(w.y,`
  `);if(r>0){var P=Bl(t,n,r,l),E=Bl(t,n,r,y);C+="L ".concat(E.x,",").concat(E.y,`
            A `).concat(r,",").concat(r,`,0,
            `).concat(+(Math.abs(i)>180),",").concat(+(l<=y),`,
            `).concat(P.x,",").concat(P.y," Z")}else C+="L ".concat(t,",").concat(n," Z");return C},JRe=e=>{var{cx:t,cy:n,innerRadius:r,outerRadius:a,cornerRadius:l,forceCornerRadius:h,cornerIsExternal:i,startAngle:y,endAngle:x}=e,w=Ec(x-y),{circleTangency:C,lineTangency:P,theta:E}=hE({cx:t,cy:n,radius:a,angle:y,sign:w,cornerRadius:l,cornerIsExternal:i}),{circleTangency:j,lineTangency:D,theta:B}=hE({cx:t,cy:n,radius:a,angle:x,sign:-w,cornerRadius:l,cornerIsExternal:i}),F=i?Math.abs(y-x):Math.abs(y-x)-E-B;if(F<0)return h?"M ".concat(P.x,",").concat(P.y,`
        a`).concat(l,",").concat(l,",0,0,1,").concat(l*2,`,0
        a`).concat(l,",").concat(l,",0,0,1,").concat(-l*2,`,0
      `):_oe({cx:t,cy:n,innerRadius:r,outerRadius:a,startAngle:y,endAngle:x});var $="M ".concat(P.x,",").concat(P.y,`
    A`).concat(l,",").concat(l,",0,0,").concat(+(w<0),",").concat(C.x,",").concat(C.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(F>180),",").concat(+(w<0),",").concat(j.x,",").concat(j.y,`
    A`).concat(l,",").concat(l,",0,0,").concat(+(w<0),",").concat(D.x,",").concat(D.y,`
  `);if(r>0){var{circleTangency:H,lineTangency:J,theta:ee}=hE({cx:t,cy:n,radius:r,angle:y,sign:w,isExternal:!0,cornerRadius:l,cornerIsExternal:i}),{circleTangency:Q,lineTangency:ne,theta:pe}=hE({cx:t,cy:n,radius:r,angle:x,sign:-w,isExternal:!0,cornerRadius:l,cornerIsExternal:i}),he=i?Math.abs(y-x):Math.abs(y-x)-ee-pe;if(he<0&&l===0)return"".concat($,"L").concat(t,",").concat(n,"Z");$+="L".concat(ne.x,",").concat(ne.y,`
      A`).concat(l,",").concat(l,",0,0,").concat(+(w<0),",").concat(Q.x,",").concat(Q.y,`
      A`).concat(r,",").concat(r,",0,").concat(+(he>180),",").concat(+(w>0),",").concat(H.x,",").concat(H.y,`
      A`).concat(l,",").concat(l,",0,0,").concat(+(w<0),",").concat(J.x,",").concat(J.y,"Z")}else $+="L".concat(t,",").concat(n,"Z");return $},QRe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},xoe=e=>{var t=rc(e,QRe),{cx:n,cy:r,innerRadius:a,outerRadius:l,cornerRadius:h,forceCornerRadius:i,cornerIsExternal:y,startAngle:x,endAngle:w,className:C}=t;if(l<a||x===w)return null;var P=ra("recharts-sector",C),E=l-a,j=Cu(h,E,0,!0),D;return j>0&&Math.abs(x-w)<360?D=JRe({cx:n,cy:r,innerRadius:a,outerRadius:l,cornerRadius:Math.min(j,E/2),forceCornerRadius:i,cornerIsExternal:y,startAngle:x,endAngle:w}):D=_oe({cx:n,cy:r,innerRadius:a,outerRadius:l,startAngle:x,endAngle:w}),L.createElement("path",wj({},Eo(t,!0),{className:P,d:D}))};function eje(e,t,n){var r,a,l,h;if(e==="horizontal")r=t.x,l=r,a=n.top,h=n.top+n.height;else if(e==="vertical")a=t.y,h=a,r=n.left,l=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:i,cy:y,innerRadius:x,outerRadius:w,angle:C}=t,P=Bl(i,y,x,C),E=Bl(i,y,w,C);r=P.x,a=P.y,l=E.x,h=E.y}else return voe(t);return[{x:r,y:a},{x:l,y:h}]}var boe={},woe={},Soe={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xz;function n(r){return t.isSymbol(r)?NaN:Number(r)}e.toNumber=n})(Soe);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Soe;function n(r){return r?(r=t.toNumber(r),r===1/0||r===-1/0?(r<0?-1:1)*Number.MAX_VALUE:r===r?r:0):r===0?r:0}e.toFinite=n})(woe);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bz,n=woe;function r(a,l,h){h&&typeof h!="number"&&t.isIterateeCall(a,l,h)&&(l=h=void 0),a=n.toFinite(a),l===void 0?(l=a,a=0):l=n.toFinite(l),h=h===void 0?a<l?1:-1:n.toFinite(h);const i=Math.max(Math.ceil((l-a)/(h||1)),0),y=new Array(i);for(let x=0;x<i;x++)y[x]=a,a+=h;return y}e.range=r})(boe);var tje=boe.range;const Aoe=Ip(tje);function nv(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function nje(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function kz(e){let t,n,r;e.length!==2?(t=nv,n=(i,y)=>nv(e(i),y),r=(i,y)=>e(i)-y):(t=e===nv||e===nje?e:rje,n=e,r=e);function a(i,y,x=0,w=i.length){if(x<w){if(t(y,y)!==0)return w;do{const C=x+w>>>1;n(i[C],y)<0?x=C+1:w=C}while(x<w)}return x}function l(i,y,x=0,w=i.length){if(x<w){if(t(y,y)!==0)return w;do{const C=x+w>>>1;n(i[C],y)<=0?x=C+1:w=C}while(x<w)}return x}function h(i,y,x=0,w=i.length){const C=a(i,y,x,w-1);return C>x&&r(i[C-1],y)>-r(i[C],y)?C-1:C}return{left:a,center:h,right:l}}function rje(){return 0}function Toe(e){return e===null?NaN:+e}function*ije(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const sje=kz(nv),Z5=sje.right;kz(Toe).center;class dW extends Map{constructor(t,n=lje){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,a]of t)this.set(r,a)}get(t){return super.get(hW(this,t))}has(t){return super.has(hW(this,t))}set(t,n){return super.set(aje(this,t),n)}delete(t){return super.delete(oje(this,t))}}function hW({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function aje({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function oje({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function lje(e){return e!==null&&typeof e=="object"?e.valueOf():e}function cje(e=nv){if(e===nv)return Coe;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function Coe(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const uje=Math.sqrt(50),dje=Math.sqrt(10),hje=Math.sqrt(2);function Dk(e,t,n){const r=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(r)),l=r/Math.pow(10,a),h=l>=uje?10:l>=dje?5:l>=hje?2:1;let i,y,x;return a<0?(x=Math.pow(10,-a)/h,i=Math.round(e*x),y=Math.round(t*x),i/x<e&&++i,y/x>t&&--y,x=-x):(x=Math.pow(10,a)*h,i=Math.round(e/x),y=Math.round(t/x),i*x<e&&++i,y*x>t&&--y),y<i&&.5<=n&&n<2?Dk(e,t,n*2):[i,y,x]}function Sj(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[a,l,h]=r?Dk(t,e,n):Dk(e,t,n);if(!(l>=a))return[];const i=l-a+1,y=new Array(i);if(r)if(h<0)for(let x=0;x<i;++x)y[x]=(l-x)/-h;else for(let x=0;x<i;++x)y[x]=(l-x)*h;else if(h<0)for(let x=0;x<i;++x)y[x]=(a+x)/-h;else for(let x=0;x<i;++x)y[x]=(a+x)*h;return y}function Aj(e,t,n){return t=+t,e=+e,n=+n,Dk(e,t,n)[2]}function Tj(e,t,n){t=+t,e=+e,n=+n;const r=t<e,a=r?Aj(t,e,n):Aj(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}function fW(e,t){let n;for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function pW(e,t){let n;for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function Eoe(e,t,n=0,r=1/0,a){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(a=a===void 0?Coe:cje(a);r>n;){if(r-n>600){const y=r-n+1,x=t-n+1,w=Math.log(y),C=.5*Math.exp(2*w/3),P=.5*Math.sqrt(w*C*(y-C)/y)*(x-y/2<0?-1:1),E=Math.max(n,Math.floor(t-x*C/y+P)),j=Math.min(r,Math.floor(t+(y-x)*C/y+P));Eoe(e,t,E,j,a)}const l=e[t];let h=n,i=r;for(mS(e,n,t),a(e[r],l)>0&&mS(e,n,r);h<i;){for(mS(e,h,i),++h,--i;a(e[h],l)<0;)++h;for(;a(e[i],l)>0;)--i}a(e[n],l)===0?mS(e,n,i):(++i,mS(e,i,r)),i<=t&&(n=i+1),t<=i&&(r=i-1)}return e}function mS(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function fje(e,t,n){if(e=Float64Array.from(ije(e)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return pW(e);if(t>=1)return fW(e);var r,a=(r-1)*t,l=Math.floor(a),h=fW(Eoe(e,l).subarray(0,l+1)),i=pW(e.subarray(l+1));return h+(i-h)*(a-l)}}function pje(e,t,n=Toe){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,l=Math.floor(a),h=+n(e[l],l,e),i=+n(e[l+1],l+1,e);return h+(i-h)*(a-l)}}function mje(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=Math.max(0,Math.ceil((t-e)/n))|0,l=new Array(a);++r<a;)l[r]=e+r*n;return l}function Nf(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function by(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Cj=Symbol("implicit");function Iz(){var e=new dW,t=[],n=[],r=Cj;function a(l){let h=e.get(l);if(h===void 0){if(r!==Cj)return r;e.set(l,h=t.push(l)-1)}return n[h%n.length]}return a.domain=function(l){if(!arguments.length)return t.slice();t=[],e=new dW;for(const h of l)e.has(h)||e.set(h,t.push(h)-1);return a},a.range=function(l){return arguments.length?(n=Array.from(l),a):n.slice()},a.unknown=function(l){return arguments.length?(r=l,a):r},a.copy=function(){return Iz(t,n).unknown(r)},Nf.apply(a,arguments),a}function Nz(){var e=Iz().unknown(void 0),t=e.domain,n=e.range,r=0,a=1,l,h,i=!1,y=0,x=0,w=.5;delete e.unknown;function C(){var P=t().length,E=a<r,j=E?a:r,D=E?r:a;l=(D-j)/Math.max(1,P-y+x*2),i&&(l=Math.floor(l)),j+=(D-j-l*(P-y))*w,h=l*(1-y),i&&(j=Math.round(j),h=Math.round(h));var B=mje(P).map(function(F){return j+l*F});return n(E?B.reverse():B)}return e.domain=function(P){return arguments.length?(t(P),C()):t()},e.range=function(P){return arguments.length?([r,a]=P,r=+r,a=+a,C()):[r,a]},e.rangeRound=function(P){return[r,a]=P,r=+r,a=+a,i=!0,C()},e.bandwidth=function(){return h},e.step=function(){return l},e.round=function(P){return arguments.length?(i=!!P,C()):i},e.padding=function(P){return arguments.length?(y=Math.min(1,x=+P),C()):y},e.paddingInner=function(P){return arguments.length?(y=Math.min(1,P),C()):y},e.paddingOuter=function(P){return arguments.length?(x=+P,C()):x},e.align=function(P){return arguments.length?(w=Math.max(0,Math.min(1,P)),C()):w},e.copy=function(){return Nz(t(),[r,a]).round(i).paddingInner(y).paddingOuter(x).align(w)},Nf.apply(C(),arguments)}function Poe(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Poe(t())},e}function gje(){return Poe(Nz.apply(null,arguments).paddingInner(1))}function Mz(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function koe(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function K5(){}var YA=.7,Rk=1/YA,Sb="\\s*([+-]?\\d+)\\s*",XA="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Bm="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",yje=/^#([0-9a-f]{3,8})$/,vje=new RegExp(`^rgb\\(${Sb},${Sb},${Sb}\\)$`),_je=new RegExp(`^rgb\\(${Bm},${Bm},${Bm}\\)$`),xje=new RegExp(`^rgba\\(${Sb},${Sb},${Sb},${XA}\\)$`),bje=new RegExp(`^rgba\\(${Bm},${Bm},${Bm},${XA}\\)$`),wje=new RegExp(`^hsl\\(${XA},${Bm},${Bm}\\)$`),Sje=new RegExp(`^hsla\\(${XA},${Bm},${Bm},${XA}\\)$`),mW={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Mz(K5,JA,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:gW,formatHex:gW,formatHex8:Aje,formatHsl:Tje,formatRgb:yW,toString:yW});function gW(){return this.rgb().formatHex()}function Aje(){return this.rgb().formatHex8()}function Tje(){return Ioe(this).formatHsl()}function yW(){return this.rgb().formatRgb()}function JA(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=yje.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?vW(t):n===3?new Vd(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?fE(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?fE(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=vje.exec(e))?new Vd(t[1],t[2],t[3],1):(t=_je.exec(e))?new Vd(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=xje.exec(e))?fE(t[1],t[2],t[3],t[4]):(t=bje.exec(e))?fE(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=wje.exec(e))?bW(t[1],t[2]/100,t[3]/100,1):(t=Sje.exec(e))?bW(t[1],t[2]/100,t[3]/100,t[4]):mW.hasOwnProperty(e)?vW(mW[e]):e==="transparent"?new Vd(NaN,NaN,NaN,0):null}function vW(e){return new Vd(e>>16&255,e>>8&255,e&255,1)}function fE(e,t,n,r){return r<=0&&(e=t=n=NaN),new Vd(e,t,n,r)}function Cje(e){return e instanceof K5||(e=JA(e)),e?(e=e.rgb(),new Vd(e.r,e.g,e.b,e.opacity)):new Vd}function Ej(e,t,n,r){return arguments.length===1?Cje(e):new Vd(e,t,n,r??1)}function Vd(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Mz(Vd,Ej,koe(K5,{brighter(e){return e=e==null?Rk:Math.pow(Rk,e),new Vd(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?YA:Math.pow(YA,e),new Vd(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Vd(ex(this.r),ex(this.g),ex(this.b),jk(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:_W,formatHex:_W,formatHex8:Eje,formatRgb:xW,toString:xW}));function _W(){return`#${L_(this.r)}${L_(this.g)}${L_(this.b)}`}function Eje(){return`#${L_(this.r)}${L_(this.g)}${L_(this.b)}${L_((isNaN(this.opacity)?1:this.opacity)*255)}`}function xW(){const e=jk(this.opacity);return`${e===1?"rgb(":"rgba("}${ex(this.r)}, ${ex(this.g)}, ${ex(this.b)}${e===1?")":`, ${e})`}`}function jk(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ex(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function L_(e){return e=ex(e),(e<16?"0":"")+e.toString(16)}function bW(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new vp(e,t,n,r)}function Ioe(e){if(e instanceof vp)return new vp(e.h,e.s,e.l,e.opacity);if(e instanceof K5||(e=JA(e)),!e)return new vp;if(e instanceof vp)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),l=Math.max(t,n,r),h=NaN,i=l-a,y=(l+a)/2;return i?(t===l?h=(n-r)/i+(n<r)*6:n===l?h=(r-t)/i+2:h=(t-n)/i+4,i/=y<.5?l+a:2-l-a,h*=60):i=y>0&&y<1?0:h,new vp(h,i,y,e.opacity)}function Pje(e,t,n,r){return arguments.length===1?Ioe(e):new vp(e,t,n,r??1)}function vp(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Mz(vp,Pje,koe(K5,{brighter(e){return e=e==null?Rk:Math.pow(Rk,e),new vp(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?YA:Math.pow(YA,e),new vp(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new Vd(d4(e>=240?e-240:e+120,a,r),d4(e,a,r),d4(e<120?e+240:e-120,a,r),this.opacity)},clamp(){return new vp(wW(this.h),pE(this.s),pE(this.l),jk(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=jk(this.opacity);return`${e===1?"hsl(":"hsla("}${wW(this.h)}, ${pE(this.s)*100}%, ${pE(this.l)*100}%${e===1?")":`, ${e})`}`}}));function wW(e){return e=(e||0)%360,e<0?e+360:e}function pE(e){return Math.max(0,Math.min(1,e||0))}function d4(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Lz=e=>()=>e;function kje(e,t){return function(n){return e+n*t}}function Ije(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Nje(e){return(e=+e)==1?Noe:function(t,n){return n-t?Ije(t,n,e):Lz(isNaN(t)?n:t)}}function Noe(e,t){var n=t-e;return n?kje(e,n):Lz(isNaN(e)?t:e)}const SW=function e(t){var n=Nje(t);function r(a,l){var h=n((a=Ej(a)).r,(l=Ej(l)).r),i=n(a.g,l.g),y=n(a.b,l.b),x=Noe(a.opacity,l.opacity);return function(w){return a.r=h(w),a.g=i(w),a.b=y(w),a.opacity=x(w),a+""}}return r.gamma=e,r}(1);function Mje(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),a;return function(l){for(a=0;a<n;++a)r[a]=e[a]*(1-l)+t[a]*l;return r}}function Lje(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Dje(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,a=new Array(r),l=new Array(n),h;for(h=0;h<r;++h)a[h]=jw(e[h],t[h]);for(;h<n;++h)l[h]=t[h];return function(i){for(h=0;h<r;++h)l[h]=a[h](i);return l}}function Rje(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Ok(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function jje(e,t){var n={},r={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?n[a]=jw(e[a],t[a]):r[a]=t[a];return function(l){for(a in n)r[a]=n[a](l);return r}}var Pj=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,h4=new RegExp(Pj.source,"g");function Oje(e){return function(){return e}}function Fje(e){return function(t){return e(t)+""}}function zje(e,t){var n=Pj.lastIndex=h4.lastIndex=0,r,a,l,h=-1,i=[],y=[];for(e=e+"",t=t+"";(r=Pj.exec(e))&&(a=h4.exec(t));)(l=a.index)>n&&(l=t.slice(n,l),i[h]?i[h]+=l:i[++h]=l),(r=r[0])===(a=a[0])?i[h]?i[h]+=a:i[++h]=a:(i[++h]=null,y.push({i:h,x:Ok(r,a)})),n=h4.lastIndex;return n<t.length&&(l=t.slice(n),i[h]?i[h]+=l:i[++h]=l),i.length<2?y[0]?Fje(y[0].x):Oje(t):(t=y.length,function(x){for(var w=0,C;w<t;++w)i[(C=y[w]).i]=C.x(x);return i.join("")})}function jw(e,t){var n=typeof t,r;return t==null||n==="boolean"?Lz(t):(n==="number"?Ok:n==="string"?(r=JA(t))?(t=r,SW):zje:t instanceof JA?SW:t instanceof Date?Rje:Lje(t)?Mje:Array.isArray(t)?Dje:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?jje:Ok)(e,t)}function Dz(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function Bje(e,t){t===void 0&&(t=e,e=jw);for(var n=0,r=t.length-1,a=t[0],l=new Array(r<0?0:r);n<r;)l[n]=e(a,a=t[++n]);return function(h){var i=Math.max(0,Math.min(r-1,Math.floor(h*=r)));return l[i](h-i)}}function Uje(e){return function(){return e}}function Fk(e){return+e}var AW=[0,1];function id(e){return e}function kj(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Uje(isNaN(t)?NaN:.5)}function Vje(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function $je(e,t,n){var r=e[0],a=e[1],l=t[0],h=t[1];return a<r?(r=kj(a,r),l=n(h,l)):(r=kj(r,a),l=n(l,h)),function(i){return l(r(i))}}function qje(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),l=new Array(r),h=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++h<r;)a[h]=kj(e[h],e[h+1]),l[h]=n(t[h],t[h+1]);return function(i){var y=Z5(e,i,1,r)-1;return l[y](a[y](i))}}function Y5(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function UI(){var e=AW,t=AW,n=jw,r,a,l,h=id,i,y,x;function w(){var P=Math.min(e.length,t.length);return h!==id&&(h=Vje(e[0],e[P-1])),i=P>2?qje:$je,y=x=null,C}function C(P){return P==null||isNaN(P=+P)?l:(y||(y=i(e.map(r),t,n)))(r(h(P)))}return C.invert=function(P){return h(a((x||(x=i(t,e.map(r),Ok)))(P)))},C.domain=function(P){return arguments.length?(e=Array.from(P,Fk),w()):e.slice()},C.range=function(P){return arguments.length?(t=Array.from(P),w()):t.slice()},C.rangeRound=function(P){return t=Array.from(P),n=Dz,w()},C.clamp=function(P){return arguments.length?(h=P?!0:id,w()):h!==id},C.interpolate=function(P){return arguments.length?(n=P,w()):n},C.unknown=function(P){return arguments.length?(l=P,C):l},function(P,E){return r=P,a=E,w()}}function Rz(){return UI()(id,id)}function Gje(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function zk(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function hw(e){return e=zk(Math.abs(e)),e?e[1]:NaN}function Hje(e,t){return function(n,r){for(var a=n.length,l=[],h=0,i=e[0],y=0;a>0&&i>0&&(y+i+1>r&&(i=Math.max(1,r-y)),l.push(n.substring(a-=i,a+i)),!((y+=i+1)>r));)i=e[h=(h+1)%e.length];return l.reverse().join(t)}}function Wje(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Zje=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function QA(e){if(!(t=Zje.exec(e)))throw new Error("invalid format: "+e);var t;return new jz({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}QA.prototype=jz.prototype;function jz(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}jz.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Kje(e){e:for(var t=e.length,n=1,r=-1,a;n<t;++n)switch(e[n]){case".":r=a=n;break;case"0":r===0&&(r=n),a=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(a+1):e}var Moe;function Yje(e,t){var n=zk(e,t);if(!n)return e+"";var r=n[0],a=n[1],l=a-(Moe=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,h=r.length;return l===h?r:l>h?r+new Array(l-h+1).join("0"):l>0?r.slice(0,l)+"."+r.slice(l):"0."+new Array(1-l).join("0")+zk(e,Math.max(0,t+l-1))[0]}function TW(e,t){var n=zk(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}const CW={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Gje,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>TW(e*100,t),r:TW,s:Yje,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function EW(e){return e}var PW=Array.prototype.map,kW=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Xje(e){var t=e.grouping===void 0||e.thousands===void 0?EW:Hje(PW.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",l=e.numerals===void 0?EW:Wje(PW.call(e.numerals,String)),h=e.percent===void 0?"%":e.percent+"",i=e.minus===void 0?"":e.minus+"",y=e.nan===void 0?"NaN":e.nan+"";function x(C){C=QA(C);var P=C.fill,E=C.align,j=C.sign,D=C.symbol,B=C.zero,F=C.width,$=C.comma,H=C.precision,J=C.trim,ee=C.type;ee==="n"?($=!0,ee="g"):CW[ee]||(H===void 0&&(H=12),J=!0,ee="g"),(B||P==="0"&&E==="=")&&(B=!0,P="0",E="=");var Q=D==="$"?n:D==="#"&&/[boxX]/.test(ee)?"0"+ee.toLowerCase():"",ne=D==="$"?r:/[%p]/.test(ee)?h:"",pe=CW[ee],he=/[defgprs%]/.test(ee);H=H===void 0?6:/[gprs]/.test(ee)?Math.max(1,Math.min(21,H)):Math.max(0,Math.min(20,H));function we(fe){var ge=Q,Ce=ne,xe,Re,Qe;if(ee==="c")Ce=pe(fe)+Ce,fe="";else{fe=+fe;var et=fe<0||1/fe<0;if(fe=isNaN(fe)?y:pe(Math.abs(fe),H),J&&(fe=Kje(fe)),et&&+fe==0&&j!=="+"&&(et=!1),ge=(et?j==="("?j:i:j==="-"||j==="("?"":j)+ge,Ce=(ee==="s"?kW[8+Moe/3]:"")+Ce+(et&&j==="("?")":""),he){for(xe=-1,Re=fe.length;++xe<Re;)if(Qe=fe.charCodeAt(xe),48>Qe||Qe>57){Ce=(Qe===46?a+fe.slice(xe+1):fe.slice(xe))+Ce,fe=fe.slice(0,xe);break}}}$&&!B&&(fe=t(fe,1/0));var je=ge.length+fe.length+Ce.length,De=je<F?new Array(F-je+1).join(P):"";switch($&&B&&(fe=t(De+fe,De.length?F-Ce.length:1/0),De=""),E){case"<":fe=ge+fe+Ce+De;break;case"=":fe=ge+De+fe+Ce;break;case"^":fe=De.slice(0,je=De.length>>1)+ge+fe+Ce+De.slice(je);break;default:fe=De+ge+fe+Ce;break}return l(fe)}return we.toString=function(){return C+""},we}function w(C,P){var E=x((C=QA(C),C.type="f",C)),j=Math.max(-8,Math.min(8,Math.floor(hw(P)/3)))*3,D=Math.pow(10,-j),B=kW[8+j/3];return function(F){return E(D*F)+B}}return{format:x,formatPrefix:w}}var mE,Oz,Loe;Jje({thousands:",",grouping:[3],currency:["$",""]});function Jje(e){return mE=Xje(e),Oz=mE.format,Loe=mE.formatPrefix,mE}function Qje(e){return Math.max(0,-hw(Math.abs(e)))}function eOe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(hw(t)/3)))*3-hw(Math.abs(e)))}function tOe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,hw(t)-hw(e))+1}function Doe(e,t,n,r){var a=Tj(e,t,n),l;switch(r=QA(r??",f"),r.type){case"s":{var h=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(l=eOe(a,h))&&(r.precision=l),Loe(r,h)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(l=tOe(a,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=l-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(l=Qje(a))&&(r.precision=l-(r.type==="%")*2);break}}return Oz(r)}function Iv(e){var t=e.domain;return e.ticks=function(n){var r=t();return Sj(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var a=t();return Doe(a[0],a[a.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),a=0,l=r.length-1,h=r[a],i=r[l],y,x,w=10;for(i<h&&(x=h,h=i,i=x,x=a,a=l,l=x);w-- >0;){if(x=Aj(h,i,n),x===y)return r[a]=h,r[l]=i,t(r);if(x>0)h=Math.floor(h/x)*x,i=Math.ceil(i/x)*x;else if(x<0)h=Math.ceil(h*x)/x,i=Math.floor(i*x)/x;else break;y=x}return e},e}function Roe(){var e=Rz();return e.copy=function(){return Y5(e,Roe())},Nf.apply(e,arguments),Iv(e)}function joe(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,Fk),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return joe(e).unknown(t)},e=arguments.length?Array.from(e,Fk):[0,1],Iv(n)}function Ooe(e,t){e=e.slice();var n=0,r=e.length-1,a=e[n],l=e[r],h;return l<a&&(h=n,n=r,r=h,h=a,a=l,l=h),e[n]=t.floor(a),e[r]=t.ceil(l),e}function IW(e){return Math.log(e)}function NW(e){return Math.exp(e)}function nOe(e){return-Math.log(-e)}function rOe(e){return-Math.exp(-e)}function iOe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function sOe(e){return e===10?iOe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function aOe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function MW(e){return(t,n)=>-e(-t,n)}function Fz(e){const t=e(IW,NW),n=t.domain;let r=10,a,l;function h(){return a=aOe(r),l=sOe(r),n()[0]<0?(a=MW(a),l=MW(l),e(nOe,rOe)):e(IW,NW),t}return t.base=function(i){return arguments.length?(r=+i,h()):r},t.domain=function(i){return arguments.length?(n(i),h()):n()},t.ticks=i=>{const y=n();let x=y[0],w=y[y.length-1];const C=w<x;C&&([x,w]=[w,x]);let P=a(x),E=a(w),j,D;const B=i==null?10:+i;let F=[];if(!(r%1)&&E-P<B){if(P=Math.floor(P),E=Math.ceil(E),x>0){for(;P<=E;++P)for(j=1;j<r;++j)if(D=P<0?j/l(-P):j*l(P),!(D<x)){if(D>w)break;F.push(D)}}else for(;P<=E;++P)for(j=r-1;j>=1;--j)if(D=P>0?j/l(-P):j*l(P),!(D<x)){if(D>w)break;F.push(D)}F.length*2<B&&(F=Sj(x,w,B))}else F=Sj(P,E,Math.min(E-P,B)).map(l);return C?F.reverse():F},t.tickFormat=(i,y)=>{if(i==null&&(i=10),y==null&&(y=r===10?"s":","),typeof y!="function"&&(!(r%1)&&(y=QA(y)).precision==null&&(y.trim=!0),y=Oz(y)),i===1/0)return y;const x=Math.max(1,r*i/t.ticks().length);return w=>{let C=w/l(Math.round(a(w)));return C*r<r-.5&&(C*=r),C<=x?y(w):""}},t.nice=()=>n(Ooe(n(),{floor:i=>l(Math.floor(a(i))),ceil:i=>l(Math.ceil(a(i)))})),t}function Foe(){const e=Fz(UI()).domain([1,10]);return e.copy=()=>Y5(e,Foe()).base(e.base()),Nf.apply(e,arguments),e}function LW(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function DW(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function zz(e){var t=1,n=e(LW(t),DW(t));return n.constant=function(r){return arguments.length?e(LW(t=+r),DW(t)):t},Iv(n)}function zoe(){var e=zz(UI());return e.copy=function(){return Y5(e,zoe()).constant(e.constant())},Nf.apply(e,arguments)}function RW(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function oOe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function lOe(e){return e<0?-e*e:e*e}function Bz(e){var t=e(id,id),n=1;function r(){return n===1?e(id,id):n===.5?e(oOe,lOe):e(RW(n),RW(1/n))}return t.exponent=function(a){return arguments.length?(n=+a,r()):n},Iv(t)}function Uz(){var e=Bz(UI());return e.copy=function(){return Y5(e,Uz()).exponent(e.exponent())},Nf.apply(e,arguments),e}function cOe(){return Uz.apply(null,arguments).exponent(.5)}function jW(e){return Math.sign(e)*e*e}function uOe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function Boe(){var e=Rz(),t=[0,1],n=!1,r;function a(l){var h=uOe(e(l));return isNaN(h)?r:n?Math.round(h):h}return a.invert=function(l){return e.invert(jW(l))},a.domain=function(l){return arguments.length?(e.domain(l),a):e.domain()},a.range=function(l){return arguments.length?(e.range((t=Array.from(l,Fk)).map(jW)),a):t.slice()},a.rangeRound=function(l){return a.range(l).round(!0)},a.round=function(l){return arguments.length?(n=!!l,a):n},a.clamp=function(l){return arguments.length?(e.clamp(l),a):e.clamp()},a.unknown=function(l){return arguments.length?(r=l,a):r},a.copy=function(){return Boe(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},Nf.apply(a,arguments),Iv(a)}function Uoe(){var e=[],t=[],n=[],r;function a(){var h=0,i=Math.max(1,t.length);for(n=new Array(i-1);++h<i;)n[h-1]=pje(e,h/i);return l}function l(h){return h==null||isNaN(h=+h)?r:t[Z5(n,h)]}return l.invertExtent=function(h){var i=t.indexOf(h);return i<0?[NaN,NaN]:[i>0?n[i-1]:e[0],i<n.length?n[i]:e[e.length-1]]},l.domain=function(h){if(!arguments.length)return e.slice();e=[];for(let i of h)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(nv),a()},l.range=function(h){return arguments.length?(t=Array.from(h),a()):t.slice()},l.unknown=function(h){return arguments.length?(r=h,l):r},l.quantiles=function(){return n.slice()},l.copy=function(){return Uoe().domain(e).range(t).unknown(r)},Nf.apply(l,arguments)}function Voe(){var e=0,t=1,n=1,r=[.5],a=[0,1],l;function h(y){return y!=null&&y<=y?a[Z5(r,y,0,n)]:l}function i(){var y=-1;for(r=new Array(n);++y<n;)r[y]=((y+1)*t-(y-n)*e)/(n+1);return h}return h.domain=function(y){return arguments.length?([e,t]=y,e=+e,t=+t,i()):[e,t]},h.range=function(y){return arguments.length?(n=(a=Array.from(y)).length-1,i()):a.slice()},h.invertExtent=function(y){var x=a.indexOf(y);return x<0?[NaN,NaN]:x<1?[e,r[0]]:x>=n?[r[n-1],t]:[r[x-1],r[x]]},h.unknown=function(y){return arguments.length&&(l=y),h},h.thresholds=function(){return r.slice()},h.copy=function(){return Voe().domain([e,t]).range(a).unknown(l)},Nf.apply(Iv(h),arguments)}function $oe(){var e=[.5],t=[0,1],n,r=1;function a(l){return l!=null&&l<=l?t[Z5(e,l,0,r)]:n}return a.domain=function(l){return arguments.length?(e=Array.from(l),r=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(l){return arguments.length?(t=Array.from(l),r=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(l){var h=t.indexOf(l);return[e[h-1],e[h]]},a.unknown=function(l){return arguments.length?(n=l,a):n},a.copy=function(){return $oe().domain(e).range(t).unknown(n)},Nf.apply(a,arguments)}const f4=new Date,p4=new Date;function ic(e,t,n,r){function a(l){return e(l=arguments.length===0?new Date:new Date(+l)),l}return a.floor=l=>(e(l=new Date(+l)),l),a.ceil=l=>(e(l=new Date(l-1)),t(l,1),e(l),l),a.round=l=>{const h=a(l),i=a.ceil(l);return l-h<i-l?h:i},a.offset=(l,h)=>(t(l=new Date(+l),h==null?1:Math.floor(h)),l),a.range=(l,h,i)=>{const y=[];if(l=a.ceil(l),i=i==null?1:Math.floor(i),!(l<h)||!(i>0))return y;let x;do y.push(x=new Date(+l)),t(l,i),e(l);while(x<l&&l<h);return y},a.filter=l=>ic(h=>{if(h>=h)for(;e(h),!l(h);)h.setTime(h-1)},(h,i)=>{if(h>=h)if(i<0)for(;++i<=0;)for(;t(h,-1),!l(h););else for(;--i>=0;)for(;t(h,1),!l(h););}),n&&(a.count=(l,h)=>(f4.setTime(+l),p4.setTime(+h),e(f4),e(p4),Math.floor(n(f4,p4))),a.every=l=>(l=Math.floor(l),!isFinite(l)||!(l>0)?null:l>1?a.filter(r?h=>r(h)%l===0:h=>a.count(0,h)%l===0):a)),a}const Bk=ic(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Bk.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ic(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Bk);Bk.range;const Vg=1e3,gf=Vg*60,$g=gf*60,hy=$g*24,Vz=hy*7,OW=hy*30,m4=hy*365,D_=ic(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Vg)},(e,t)=>(t-e)/Vg,e=>e.getUTCSeconds());D_.range;const $z=ic(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Vg)},(e,t)=>{e.setTime(+e+t*gf)},(e,t)=>(t-e)/gf,e=>e.getMinutes());$z.range;const qz=ic(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*gf)},(e,t)=>(t-e)/gf,e=>e.getUTCMinutes());qz.range;const Gz=ic(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Vg-e.getMinutes()*gf)},(e,t)=>{e.setTime(+e+t*$g)},(e,t)=>(t-e)/$g,e=>e.getHours());Gz.range;const Hz=ic(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*$g)},(e,t)=>(t-e)/$g,e=>e.getUTCHours());Hz.range;const X5=ic(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*gf)/hy,e=>e.getDate()-1);X5.range;const VI=ic(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/hy,e=>e.getUTCDate()-1);VI.range;const qoe=ic(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/hy,e=>Math.floor(e/hy));qoe.range;function Lx(e){return ic(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*gf)/Vz)}const $I=Lx(0),Uk=Lx(1),dOe=Lx(2),hOe=Lx(3),fw=Lx(4),fOe=Lx(5),pOe=Lx(6);$I.range;Uk.range;dOe.range;hOe.range;fw.range;fOe.range;pOe.range;function Dx(e){return ic(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/Vz)}const qI=Dx(0),Vk=Dx(1),mOe=Dx(2),gOe=Dx(3),pw=Dx(4),yOe=Dx(5),vOe=Dx(6);qI.range;Vk.range;mOe.range;gOe.range;pw.range;yOe.range;vOe.range;const Wz=ic(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Wz.range;const Zz=ic(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Zz.range;const fy=ic(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());fy.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ic(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});fy.range;const py=ic(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());py.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ic(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});py.range;function Goe(e,t,n,r,a,l){const h=[[D_,1,Vg],[D_,5,5*Vg],[D_,15,15*Vg],[D_,30,30*Vg],[l,1,gf],[l,5,5*gf],[l,15,15*gf],[l,30,30*gf],[a,1,$g],[a,3,3*$g],[a,6,6*$g],[a,12,12*$g],[r,1,hy],[r,2,2*hy],[n,1,Vz],[t,1,OW],[t,3,3*OW],[e,1,m4]];function i(x,w,C){const P=w<x;P&&([x,w]=[w,x]);const E=C&&typeof C.range=="function"?C:y(x,w,C),j=E?E.range(x,+w+1):[];return P?j.reverse():j}function y(x,w,C){const P=Math.abs(w-x)/C,E=kz(([,,B])=>B).right(h,P);if(E===h.length)return e.every(Tj(x/m4,w/m4,C));if(E===0)return Bk.every(Math.max(Tj(x,w,C),1));const[j,D]=h[P/h[E-1][2]<h[E][2]/P?E-1:E];return j.every(D)}return[i,y]}const[_Oe,xOe]=Goe(py,Zz,qI,qoe,Hz,qz),[bOe,wOe]=Goe(fy,Wz,$I,X5,Gz,$z);function g4(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function y4(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function gS(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function SOe(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,l=e.days,h=e.shortDays,i=e.months,y=e.shortMonths,x=yS(a),w=vS(a),C=yS(l),P=vS(l),E=yS(h),j=vS(h),D=yS(i),B=vS(i),F=yS(y),$=vS(y),H={a:et,A:je,b:De,B:Ct,c:null,d:$W,e:$W,f:HOe,g:nFe,G:iFe,H:$Oe,I:qOe,j:GOe,L:Hoe,m:WOe,M:ZOe,p:xt,q:me,Q:HW,s:WW,S:KOe,u:YOe,U:XOe,V:JOe,w:QOe,W:eFe,x:null,X:null,y:tFe,Y:rFe,Z:sFe,"%":GW},J={a:Ye,A:nt,b:vt,B:gt,c:null,d:qW,e:qW,f:cFe,g:_Fe,G:bFe,H:aFe,I:oFe,j:lFe,L:Zoe,m:uFe,M:dFe,p:dt,q:At,Q:HW,s:WW,S:hFe,u:fFe,U:pFe,V:mFe,w:gFe,W:yFe,x:null,X:null,y:vFe,Y:xFe,Z:wFe,"%":GW},ee={a:we,A:fe,b:ge,B:Ce,c:xe,d:UW,e:UW,f:zOe,g:BW,G:zW,H:VW,I:VW,j:ROe,L:FOe,m:DOe,M:jOe,p:he,q:LOe,Q:UOe,s:VOe,S:OOe,u:POe,U:kOe,V:IOe,w:EOe,W:NOe,x:Re,X:Qe,y:BW,Y:zW,Z:MOe,"%":BOe};H.x=Q(n,H),H.X=Q(r,H),H.c=Q(t,H),J.x=Q(n,J),J.X=Q(r,J),J.c=Q(t,J);function Q(mt,Pt){return function(Ht){var Ot=[],Un=-1,Kt=0,st=mt.length,Dr,Or,Br;for(Ht instanceof Date||(Ht=new Date(+Ht));++Un<st;)mt.charCodeAt(Un)===37&&(Ot.push(mt.slice(Kt,Un)),(Or=FW[Dr=mt.charAt(++Un)])!=null?Dr=mt.charAt(++Un):Or=Dr==="e"?" ":"0",(Br=Pt[Dr])&&(Dr=Br(Ht,Or)),Ot.push(Dr),Kt=Un+1);return Ot.push(mt.slice(Kt,Un)),Ot.join("")}}function ne(mt,Pt){return function(Ht){var Ot=gS(1900,void 0,1),Un=pe(Ot,mt,Ht+="",0),Kt,st;if(Un!=Ht.length)return null;if("Q"in Ot)return new Date(Ot.Q);if("s"in Ot)return new Date(Ot.s*1e3+("L"in Ot?Ot.L:0));if(Pt&&!("Z"in Ot)&&(Ot.Z=0),"p"in Ot&&(Ot.H=Ot.H%12+Ot.p*12),Ot.m===void 0&&(Ot.m="q"in Ot?Ot.q:0),"V"in Ot){if(Ot.V<1||Ot.V>53)return null;"w"in Ot||(Ot.w=1),"Z"in Ot?(Kt=y4(gS(Ot.y,0,1)),st=Kt.getUTCDay(),Kt=st>4||st===0?Vk.ceil(Kt):Vk(Kt),Kt=VI.offset(Kt,(Ot.V-1)*7),Ot.y=Kt.getUTCFullYear(),Ot.m=Kt.getUTCMonth(),Ot.d=Kt.getUTCDate()+(Ot.w+6)%7):(Kt=g4(gS(Ot.y,0,1)),st=Kt.getDay(),Kt=st>4||st===0?Uk.ceil(Kt):Uk(Kt),Kt=X5.offset(Kt,(Ot.V-1)*7),Ot.y=Kt.getFullYear(),Ot.m=Kt.getMonth(),Ot.d=Kt.getDate()+(Ot.w+6)%7)}else("W"in Ot||"U"in Ot)&&("w"in Ot||(Ot.w="u"in Ot?Ot.u%7:"W"in Ot?1:0),st="Z"in Ot?y4(gS(Ot.y,0,1)).getUTCDay():g4(gS(Ot.y,0,1)).getDay(),Ot.m=0,Ot.d="W"in Ot?(Ot.w+6)%7+Ot.W*7-(st+5)%7:Ot.w+Ot.U*7-(st+6)%7);return"Z"in Ot?(Ot.H+=Ot.Z/100|0,Ot.M+=Ot.Z%100,y4(Ot)):g4(Ot)}}function pe(mt,Pt,Ht,Ot){for(var Un=0,Kt=Pt.length,st=Ht.length,Dr,Or;Un<Kt;){if(Ot>=st)return-1;if(Dr=Pt.charCodeAt(Un++),Dr===37){if(Dr=Pt.charAt(Un++),Or=ee[Dr in FW?Pt.charAt(Un++):Dr],!Or||(Ot=Or(mt,Ht,Ot))<0)return-1}else if(Dr!=Ht.charCodeAt(Ot++))return-1}return Ot}function he(mt,Pt,Ht){var Ot=x.exec(Pt.slice(Ht));return Ot?(mt.p=w.get(Ot[0].toLowerCase()),Ht+Ot[0].length):-1}function we(mt,Pt,Ht){var Ot=E.exec(Pt.slice(Ht));return Ot?(mt.w=j.get(Ot[0].toLowerCase()),Ht+Ot[0].length):-1}function fe(mt,Pt,Ht){var Ot=C.exec(Pt.slice(Ht));return Ot?(mt.w=P.get(Ot[0].toLowerCase()),Ht+Ot[0].length):-1}function ge(mt,Pt,Ht){var Ot=F.exec(Pt.slice(Ht));return Ot?(mt.m=$.get(Ot[0].toLowerCase()),Ht+Ot[0].length):-1}function Ce(mt,Pt,Ht){var Ot=D.exec(Pt.slice(Ht));return Ot?(mt.m=B.get(Ot[0].toLowerCase()),Ht+Ot[0].length):-1}function xe(mt,Pt,Ht){return pe(mt,t,Pt,Ht)}function Re(mt,Pt,Ht){return pe(mt,n,Pt,Ht)}function Qe(mt,Pt,Ht){return pe(mt,r,Pt,Ht)}function et(mt){return h[mt.getDay()]}function je(mt){return l[mt.getDay()]}function De(mt){return y[mt.getMonth()]}function Ct(mt){return i[mt.getMonth()]}function xt(mt){return a[+(mt.getHours()>=12)]}function me(mt){return 1+~~(mt.getMonth()/3)}function Ye(mt){return h[mt.getUTCDay()]}function nt(mt){return l[mt.getUTCDay()]}function vt(mt){return y[mt.getUTCMonth()]}function gt(mt){return i[mt.getUTCMonth()]}function dt(mt){return a[+(mt.getUTCHours()>=12)]}function At(mt){return 1+~~(mt.getUTCMonth()/3)}return{format:function(mt){var Pt=Q(mt+="",H);return Pt.toString=function(){return mt},Pt},parse:function(mt){var Pt=ne(mt+="",!1);return Pt.toString=function(){return mt},Pt},utcFormat:function(mt){var Pt=Q(mt+="",J);return Pt.toString=function(){return mt},Pt},utcParse:function(mt){var Pt=ne(mt+="",!0);return Pt.toString=function(){return mt},Pt}}}var FW={"-":"",_:" ",0:"0"},kc=/^\s*\d+/,AOe=/^%/,TOe=/[\\^$*+?|[\]().{}]/g;function va(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",l=a.length;return r+(l<n?new Array(n-l+1).join(t)+a:a)}function COe(e){return e.replace(TOe,"\\$&")}function yS(e){return new RegExp("^(?:"+e.map(COe).join("|")+")","i")}function vS(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function EOe(e,t,n){var r=kc.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function POe(e,t,n){var r=kc.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function kOe(e,t,n){var r=kc.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function IOe(e,t,n){var r=kc.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function NOe(e,t,n){var r=kc.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function zW(e,t,n){var r=kc.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function BW(e,t,n){var r=kc.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function MOe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function LOe(e,t,n){var r=kc.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function DOe(e,t,n){var r=kc.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function UW(e,t,n){var r=kc.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function ROe(e,t,n){var r=kc.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function VW(e,t,n){var r=kc.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function jOe(e,t,n){var r=kc.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function OOe(e,t,n){var r=kc.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function FOe(e,t,n){var r=kc.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function zOe(e,t,n){var r=kc.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function BOe(e,t,n){var r=AOe.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function UOe(e,t,n){var r=kc.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function VOe(e,t,n){var r=kc.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function $W(e,t){return va(e.getDate(),t,2)}function $Oe(e,t){return va(e.getHours(),t,2)}function qOe(e,t){return va(e.getHours()%12||12,t,2)}function GOe(e,t){return va(1+X5.count(fy(e),e),t,3)}function Hoe(e,t){return va(e.getMilliseconds(),t,3)}function HOe(e,t){return Hoe(e,t)+"000"}function WOe(e,t){return va(e.getMonth()+1,t,2)}function ZOe(e,t){return va(e.getMinutes(),t,2)}function KOe(e,t){return va(e.getSeconds(),t,2)}function YOe(e){var t=e.getDay();return t===0?7:t}function XOe(e,t){return va($I.count(fy(e)-1,e),t,2)}function Woe(e){var t=e.getDay();return t>=4||t===0?fw(e):fw.ceil(e)}function JOe(e,t){return e=Woe(e),va(fw.count(fy(e),e)+(fy(e).getDay()===4),t,2)}function QOe(e){return e.getDay()}function eFe(e,t){return va(Uk.count(fy(e)-1,e),t,2)}function tFe(e,t){return va(e.getFullYear()%100,t,2)}function nFe(e,t){return e=Woe(e),va(e.getFullYear()%100,t,2)}function rFe(e,t){return va(e.getFullYear()%1e4,t,4)}function iFe(e,t){var n=e.getDay();return e=n>=4||n===0?fw(e):fw.ceil(e),va(e.getFullYear()%1e4,t,4)}function sFe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+va(t/60|0,"0",2)+va(t%60,"0",2)}function qW(e,t){return va(e.getUTCDate(),t,2)}function aFe(e,t){return va(e.getUTCHours(),t,2)}function oFe(e,t){return va(e.getUTCHours()%12||12,t,2)}function lFe(e,t){return va(1+VI.count(py(e),e),t,3)}function Zoe(e,t){return va(e.getUTCMilliseconds(),t,3)}function cFe(e,t){return Zoe(e,t)+"000"}function uFe(e,t){return va(e.getUTCMonth()+1,t,2)}function dFe(e,t){return va(e.getUTCMinutes(),t,2)}function hFe(e,t){return va(e.getUTCSeconds(),t,2)}function fFe(e){var t=e.getUTCDay();return t===0?7:t}function pFe(e,t){return va(qI.count(py(e)-1,e),t,2)}function Koe(e){var t=e.getUTCDay();return t>=4||t===0?pw(e):pw.ceil(e)}function mFe(e,t){return e=Koe(e),va(pw.count(py(e),e)+(py(e).getUTCDay()===4),t,2)}function gFe(e){return e.getUTCDay()}function yFe(e,t){return va(Vk.count(py(e)-1,e),t,2)}function vFe(e,t){return va(e.getUTCFullYear()%100,t,2)}function _Fe(e,t){return e=Koe(e),va(e.getUTCFullYear()%100,t,2)}function xFe(e,t){return va(e.getUTCFullYear()%1e4,t,4)}function bFe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?pw(e):pw.ceil(e),va(e.getUTCFullYear()%1e4,t,4)}function wFe(){return"+0000"}function GW(){return"%"}function HW(e){return+e}function WW(e){return Math.floor(+e/1e3)}var k1,Yoe,Xoe;SFe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function SFe(e){return k1=SOe(e),Yoe=k1.format,k1.parse,Xoe=k1.utcFormat,k1.utcParse,k1}function AFe(e){return new Date(e)}function TFe(e){return e instanceof Date?+e:+new Date(+e)}function Kz(e,t,n,r,a,l,h,i,y,x){var w=Rz(),C=w.invert,P=w.domain,E=x(".%L"),j=x(":%S"),D=x("%I:%M"),B=x("%I %p"),F=x("%a %d"),$=x("%b %d"),H=x("%B"),J=x("%Y");function ee(Q){return(y(Q)<Q?E:i(Q)<Q?j:h(Q)<Q?D:l(Q)<Q?B:r(Q)<Q?a(Q)<Q?F:$:n(Q)<Q?H:J)(Q)}return w.invert=function(Q){return new Date(C(Q))},w.domain=function(Q){return arguments.length?P(Array.from(Q,TFe)):P().map(AFe)},w.ticks=function(Q){var ne=P();return e(ne[0],ne[ne.length-1],Q??10)},w.tickFormat=function(Q,ne){return ne==null?ee:x(ne)},w.nice=function(Q){var ne=P();return(!Q||typeof Q.range!="function")&&(Q=t(ne[0],ne[ne.length-1],Q??10)),Q?P(Ooe(ne,Q)):w},w.copy=function(){return Y5(w,Kz(e,t,n,r,a,l,h,i,y,x))},w}function CFe(){return Nf.apply(Kz(bOe,wOe,fy,Wz,$I,X5,Gz,$z,D_,Yoe).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function EFe(){return Nf.apply(Kz(_Oe,xOe,py,Zz,qI,VI,Hz,qz,D_,Xoe).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function GI(){var e=0,t=1,n,r,a,l,h=id,i=!1,y;function x(C){return C==null||isNaN(C=+C)?y:h(a===0?.5:(C=(l(C)-n)*a,i?Math.max(0,Math.min(1,C)):C))}x.domain=function(C){return arguments.length?([e,t]=C,n=l(e=+e),r=l(t=+t),a=n===r?0:1/(r-n),x):[e,t]},x.clamp=function(C){return arguments.length?(i=!!C,x):i},x.interpolator=function(C){return arguments.length?(h=C,x):h};function w(C){return function(P){var E,j;return arguments.length?([E,j]=P,h=C(E,j),x):[h(0),h(1)]}}return x.range=w(jw),x.rangeRound=w(Dz),x.unknown=function(C){return arguments.length?(y=C,x):y},function(C){return l=C,n=C(e),r=C(t),a=n===r?0:1/(r-n),x}}function Nv(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Joe(){var e=Iv(GI()(id));return e.copy=function(){return Nv(e,Joe())},by.apply(e,arguments)}function Qoe(){var e=Fz(GI()).domain([1,10]);return e.copy=function(){return Nv(e,Qoe()).base(e.base())},by.apply(e,arguments)}function ele(){var e=zz(GI());return e.copy=function(){return Nv(e,ele()).constant(e.constant())},by.apply(e,arguments)}function Yz(){var e=Bz(GI());return e.copy=function(){return Nv(e,Yz()).exponent(e.exponent())},by.apply(e,arguments)}function PFe(){return Yz.apply(null,arguments).exponent(.5)}function tle(){var e=[],t=id;function n(r){if(r!=null&&!isNaN(r=+r))return t((Z5(e,r,1)-1)/(e.length-1))}return n.domain=function(r){if(!arguments.length)return e.slice();e=[];for(let a of r)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(nv),n},n.interpolator=function(r){return arguments.length?(t=r,n):t},n.range=function(){return e.map((r,a)=>t(a/(e.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(a,l)=>fje(e,l/r))},n.copy=function(){return tle(t).domain(e)},by.apply(n,arguments)}function HI(){var e=0,t=.5,n=1,r=1,a,l,h,i,y,x=id,w,C=!1,P;function E(D){return isNaN(D=+D)?P:(D=.5+((D=+w(D))-l)*(r*D<r*l?i:y),x(C?Math.max(0,Math.min(1,D)):D))}E.domain=function(D){return arguments.length?([e,t,n]=D,a=w(e=+e),l=w(t=+t),h=w(n=+n),i=a===l?0:.5/(l-a),y=l===h?0:.5/(h-l),r=l<a?-1:1,E):[e,t,n]},E.clamp=function(D){return arguments.length?(C=!!D,E):C},E.interpolator=function(D){return arguments.length?(x=D,E):x};function j(D){return function(B){var F,$,H;return arguments.length?([F,$,H]=B,x=Bje(D,[F,$,H]),E):[x(0),x(.5),x(1)]}}return E.range=j(jw),E.rangeRound=j(Dz),E.unknown=function(D){return arguments.length?(P=D,E):P},function(D){return w=D,a=D(e),l=D(t),h=D(n),i=a===l?0:.5/(l-a),y=l===h?0:.5/(h-l),r=l<a?-1:1,E}}function nle(){var e=Iv(HI()(id));return e.copy=function(){return Nv(e,nle())},by.apply(e,arguments)}function rle(){var e=Fz(HI()).domain([.1,1,10]);return e.copy=function(){return Nv(e,rle()).base(e.base())},by.apply(e,arguments)}function ile(){var e=zz(HI());return e.copy=function(){return Nv(e,ile()).constant(e.constant())},by.apply(e,arguments)}function Xz(){var e=Bz(HI());return e.copy=function(){return Nv(e,Xz()).exponent(e.exponent())},by.apply(e,arguments)}function kFe(){return Xz.apply(null,arguments).exponent(.5)}const LS=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Nz,scaleDiverging:nle,scaleDivergingLog:rle,scaleDivergingPow:Xz,scaleDivergingSqrt:kFe,scaleDivergingSymlog:ile,scaleIdentity:joe,scaleImplicit:Cj,scaleLinear:Roe,scaleLog:Foe,scaleOrdinal:Iz,scalePoint:gje,scalePow:Uz,scaleQuantile:Uoe,scaleQuantize:Voe,scaleRadial:Boe,scaleSequential:Joe,scaleSequentialLog:Qoe,scaleSequentialPow:Yz,scaleSequentialQuantile:tle,scaleSequentialSqrt:PFe,scaleSequentialSymlog:ele,scaleSqrt:cOe,scaleSymlog:zoe,scaleThreshold:$oe,scaleTime:CFe,scaleUtc:EFe,tickFormat:Doe},Symbol.toStringTag,{value:"Module"}));var Mv=e=>e.chartData,Jz=_n([Mv],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),J5=(e,t,n,r)=>r?Jz(e):Mv(e);function mw(e){if(Array.isArray(e)&&e.length===2){var[t,n]=e;if(Kc(t)&&Kc(n))return!0}return!1}function ZW(e,t,n){return n?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function IFe(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[n,r]=e,a,l;if(Kc(n))a=n;else if(typeof n=="function")return;if(Kc(r))l=r;else if(typeof r=="function")return;var h=[a,l];if(mw(h))return h}}function NFe(e,t,n){if(!(!n&&t==null)){if(typeof e=="function"&&t!=null)try{var r=e(t,n);if(mw(r))return ZW(r,t,n)}catch{}if(Array.isArray(e)&&e.length===2){var[a,l]=e,h,i;if(a==="auto")t!=null&&(h=Math.min(...t));else if(wi(a))h=a;else if(typeof a=="function")try{t!=null&&(h=a(t==null?void 0:t[0]))}catch{}else if(typeof a=="string"&&qH.test(a)){var y=qH.exec(a);if(y==null||t==null)h=void 0;else{var x=+y[1];h=t[0]-x}}else h=t==null?void 0:t[0];if(l==="auto")t!=null&&(i=Math.max(...t));else if(wi(l))i=l;else if(typeof l=="function")try{t!=null&&(i=l(t==null?void 0:t[1]))}catch{}else if(typeof l=="string"&&GH.test(l)){var w=GH.exec(l);if(w==null||t==null)i=void 0;else{var C=+w[1];i=t[1]+C}}else i=t==null?void 0:t[1];var P=[h,i];if(mw(P))return t==null?P:ZW(P,t,n)}}}var Ow=1e9,MFe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},eB,Bo=!0,Sf="[DecimalError] ",tx=Sf+"Invalid argument: ",Qz=Sf+"Exponent out of range: ",Fw=Math.floor,w_=Math.pow,LFe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,bh,Ac=1e7,wo=7,sle=9007199254740991,$k=Fw(sle/wo),hi={};hi.absoluteValue=hi.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};hi.comparedTo=hi.cmp=function(e){var t,n,r,a,l=this;if(e=new l.constructor(e),l.s!==e.s)return l.s||-e.s;if(l.e!==e.e)return l.e>e.e^l.s<0?1:-1;for(r=l.d.length,a=e.d.length,t=0,n=r<a?r:a;t<n;++t)if(l.d[t]!==e.d[t])return l.d[t]>e.d[t]^l.s<0?1:-1;return r===a?0:r>a^l.s<0?1:-1};hi.decimalPlaces=hi.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*wo;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};hi.dividedBy=hi.div=function(e){return Zg(this,new this.constructor(e))};hi.dividedToIntegerBy=hi.idiv=function(e){var t=this,n=t.constructor;return Ya(Zg(t,new n(e),0,1),n.precision)};hi.equals=hi.eq=function(e){return!this.cmp(e)};hi.exponent=function(){return Vl(this)};hi.greaterThan=hi.gt=function(e){return this.cmp(e)>0};hi.greaterThanOrEqualTo=hi.gte=function(e){return this.cmp(e)>=0};hi.isInteger=hi.isint=function(){return this.e>this.d.length-2};hi.isNegative=hi.isneg=function(){return this.s<0};hi.isPositive=hi.ispos=function(){return this.s>0};hi.isZero=function(){return this.s===0};hi.lessThan=hi.lt=function(e){return this.cmp(e)<0};hi.lessThanOrEqualTo=hi.lte=function(e){return this.cmp(e)<1};hi.logarithm=hi.log=function(e){var t,n=this,r=n.constructor,a=r.precision,l=a+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(bh))throw Error(Sf+"NaN");if(n.s<1)throw Error(Sf+(n.s?"NaN":"-Infinity"));return n.eq(bh)?new r(0):(Bo=!1,t=Zg(e5(n,l),e5(e,l),l),Bo=!0,Ya(t,a))};hi.minus=hi.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?lle(t,e):ale(t,(e.s=-e.s,e))};hi.modulo=hi.mod=function(e){var t,n=this,r=n.constructor,a=r.precision;if(e=new r(e),!e.s)throw Error(Sf+"NaN");return n.s?(Bo=!1,t=Zg(n,e,0,1).times(e),Bo=!0,n.minus(t)):Ya(new r(n),a)};hi.naturalExponential=hi.exp=function(){return ole(this)};hi.naturalLogarithm=hi.ln=function(){return e5(this)};hi.negated=hi.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};hi.plus=hi.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?ale(t,e):lle(t,(e.s=-e.s,e))};hi.precision=hi.sd=function(e){var t,n,r,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(tx+e);if(t=Vl(a)+1,r=a.d.length-1,n=r*wo+1,r=a.d[r],r){for(;r%10==0;r/=10)n--;for(r=a.d[0];r>=10;r/=10)n++}return e&&t>n?t:n};hi.squareRoot=hi.sqrt=function(){var e,t,n,r,a,l,h,i=this,y=i.constructor;if(i.s<1){if(!i.s)return new y(0);throw Error(Sf+"NaN")}for(e=Vl(i),Bo=!1,a=Math.sqrt(+i),a==0||a==1/0?(t=Pm(i.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Fw((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new y(t)):r=new y(a.toString()),n=y.precision,a=h=n+3;;)if(l=r,r=l.plus(Zg(i,l,h+2)).times(.5),Pm(l.d).slice(0,h)===(t=Pm(r.d)).slice(0,h)){if(t=t.slice(h-3,h+1),a==h&&t=="4999"){if(Ya(l,n+1,0),l.times(l).eq(i)){r=l;break}}else if(t!="9999")break;h+=4}return Bo=!0,Ya(r,n)};hi.times=hi.mul=function(e){var t,n,r,a,l,h,i,y,x,w=this,C=w.constructor,P=w.d,E=(e=new C(e)).d;if(!w.s||!e.s)return new C(0);for(e.s*=w.s,n=w.e+e.e,y=P.length,x=E.length,y<x&&(l=P,P=E,E=l,h=y,y=x,x=h),l=[],h=y+x,r=h;r--;)l.push(0);for(r=x;--r>=0;){for(t=0,a=y+r;a>r;)i=l[a]+E[r]*P[a-r-1]+t,l[a--]=i%Ac|0,t=i/Ac|0;l[a]=(l[a]+t)%Ac|0}for(;!l[--h];)l.pop();return t?++n:l.shift(),e.d=l,e.e=n,Bo?Ya(e,C.precision):e};hi.toDecimalPlaces=hi.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(Hm(e,0,Ow),t===void 0?t=r.rounding:Hm(t,0,8),Ya(n,e+Vl(n)+1,t))};hi.toExponential=function(e,t){var n,r=this,a=r.constructor;return e===void 0?n=_x(r,!0):(Hm(e,0,Ow),t===void 0?t=a.rounding:Hm(t,0,8),r=Ya(new a(r),e+1,t),n=_x(r,!0,e+1)),n};hi.toFixed=function(e,t){var n,r,a=this,l=a.constructor;return e===void 0?_x(a):(Hm(e,0,Ow),t===void 0?t=l.rounding:Hm(t,0,8),r=Ya(new l(a),e+Vl(a)+1,t),n=_x(r.abs(),!1,e+Vl(r)+1),a.isneg()&&!a.isZero()?"-"+n:n)};hi.toInteger=hi.toint=function(){var e=this,t=e.constructor;return Ya(new t(e),Vl(e)+1,t.rounding)};hi.toNumber=function(){return+this};hi.toPower=hi.pow=function(e){var t,n,r,a,l,h,i=this,y=i.constructor,x=12,w=+(e=new y(e));if(!e.s)return new y(bh);if(i=new y(i),!i.s){if(e.s<1)throw Error(Sf+"Infinity");return i}if(i.eq(bh))return i;if(r=y.precision,e.eq(bh))return Ya(i,r);if(t=e.e,n=e.d.length-1,h=t>=n,l=i.s,h){if((n=w<0?-w:w)<=sle){for(a=new y(bh),t=Math.ceil(r/wo+4),Bo=!1;n%2&&(a=a.times(i),YW(a.d,t)),n=Fw(n/2),n!==0;)i=i.times(i),YW(i.d,t);return Bo=!0,e.s<0?new y(bh).div(a):Ya(a,r)}}else if(l<0)throw Error(Sf+"NaN");return l=l<0&&e.d[Math.max(t,n)]&1?-1:1,i.s=1,Bo=!1,a=e.times(e5(i,r+x)),Bo=!0,a=ole(a),a.s=l,a};hi.toPrecision=function(e,t){var n,r,a=this,l=a.constructor;return e===void 0?(n=Vl(a),r=_x(a,n<=l.toExpNeg||n>=l.toExpPos)):(Hm(e,1,Ow),t===void 0?t=l.rounding:Hm(t,0,8),a=Ya(new l(a),e,t),n=Vl(a),r=_x(a,e<=n||n<=l.toExpNeg,e)),r};hi.toSignificantDigits=hi.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(Hm(e,1,Ow),t===void 0?t=r.rounding:Hm(t,0,8)),Ya(new r(n),e,t)};hi.toString=hi.valueOf=hi.val=hi.toJSON=hi[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Vl(e),n=e.constructor;return _x(e,t<=n.toExpNeg||t>=n.toExpPos)};function ale(e,t){var n,r,a,l,h,i,y,x,w=e.constructor,C=w.precision;if(!e.s||!t.s)return t.s||(t=new w(e)),Bo?Ya(t,C):t;if(y=e.d,x=t.d,h=e.e,a=t.e,y=y.slice(),l=h-a,l){for(l<0?(r=y,l=-l,i=x.length):(r=x,a=h,i=y.length),h=Math.ceil(C/wo),i=h>i?h+1:i+1,l>i&&(l=i,r.length=1),r.reverse();l--;)r.push(0);r.reverse()}for(i=y.length,l=x.length,i-l<0&&(l=i,r=x,x=y,y=r),n=0;l;)n=(y[--l]=y[l]+x[l]+n)/Ac|0,y[l]%=Ac;for(n&&(y.unshift(n),++a),i=y.length;y[--i]==0;)y.pop();return t.d=y,t.e=a,Bo?Ya(t,C):t}function Hm(e,t,n){if(e!==~~e||e<t||e>n)throw Error(tx+e)}function Pm(e){var t,n,r,a=e.length-1,l="",h=e[0];if(a>0){for(l+=h,t=1;t<a;t++)r=e[t]+"",n=wo-r.length,n&&(l+=x0(n)),l+=r;h=e[t],r=h+"",n=wo-r.length,n&&(l+=x0(n))}else if(h===0)return"0";for(;h%10===0;)h/=10;return l+h}var Zg=function(){function e(r,a){var l,h=0,i=r.length;for(r=r.slice();i--;)l=r[i]*a+h,r[i]=l%Ac|0,h=l/Ac|0;return h&&r.unshift(h),r}function t(r,a,l,h){var i,y;if(l!=h)y=l>h?1:-1;else for(i=y=0;i<l;i++)if(r[i]!=a[i]){y=r[i]>a[i]?1:-1;break}return y}function n(r,a,l){for(var h=0;l--;)r[l]-=h,h=r[l]<a[l]?1:0,r[l]=h*Ac+r[l]-a[l];for(;!r[0]&&r.length>1;)r.shift()}return function(r,a,l,h){var i,y,x,w,C,P,E,j,D,B,F,$,H,J,ee,Q,ne,pe,he=r.constructor,we=r.s==a.s?1:-1,fe=r.d,ge=a.d;if(!r.s)return new he(r);if(!a.s)throw Error(Sf+"Division by zero");for(y=r.e-a.e,ne=ge.length,ee=fe.length,E=new he(we),j=E.d=[],x=0;ge[x]==(fe[x]||0);)++x;if(ge[x]>(fe[x]||0)&&--y,l==null?$=l=he.precision:h?$=l+(Vl(r)-Vl(a))+1:$=l,$<0)return new he(0);if($=$/wo+2|0,x=0,ne==1)for(w=0,ge=ge[0],$++;(x<ee||w)&&$--;x++)H=w*Ac+(fe[x]||0),j[x]=H/ge|0,w=H%ge|0;else{for(w=Ac/(ge[0]+1)|0,w>1&&(ge=e(ge,w),fe=e(fe,w),ne=ge.length,ee=fe.length),J=ne,D=fe.slice(0,ne),B=D.length;B<ne;)D[B++]=0;pe=ge.slice(),pe.unshift(0),Q=ge[0],ge[1]>=Ac/2&&++Q;do w=0,i=t(ge,D,ne,B),i<0?(F=D[0],ne!=B&&(F=F*Ac+(D[1]||0)),w=F/Q|0,w>1?(w>=Ac&&(w=Ac-1),C=e(ge,w),P=C.length,B=D.length,i=t(C,D,P,B),i==1&&(w--,n(C,ne<P?pe:ge,P))):(w==0&&(i=w=1),C=ge.slice()),P=C.length,P<B&&C.unshift(0),n(D,C,B),i==-1&&(B=D.length,i=t(ge,D,ne,B),i<1&&(w++,n(D,ne<B?pe:ge,B))),B=D.length):i===0&&(w++,D=[0]),j[x++]=w,i&&D[0]?D[B++]=fe[J]||0:(D=[fe[J]],B=1);while((J++<ee||D[0]!==void 0)&&$--)}return j[0]||j.shift(),E.e=y,Ya(E,h?l+Vl(E)+1:l)}}();function ole(e,t){var n,r,a,l,h,i,y=0,x=0,w=e.constructor,C=w.precision;if(Vl(e)>16)throw Error(Qz+Vl(e));if(!e.s)return new w(bh);for(t==null?(Bo=!1,i=C):i=t,h=new w(.03125);e.abs().gte(.1);)e=e.times(h),x+=5;for(r=Math.log(w_(2,x))/Math.LN10*2+5|0,i+=r,n=a=l=new w(bh),w.precision=i;;){if(a=Ya(a.times(e),i),n=n.times(++y),h=l.plus(Zg(a,n,i)),Pm(h.d).slice(0,i)===Pm(l.d).slice(0,i)){for(;x--;)l=Ya(l.times(l),i);return w.precision=C,t==null?(Bo=!0,Ya(l,C)):l}l=h}}function Vl(e){for(var t=e.e*wo,n=e.d[0];n>=10;n/=10)t++;return t}function v4(e,t,n){if(t>e.LN10.sd())throw Bo=!0,n&&(e.precision=n),Error(Sf+"LN10 precision limit exceeded");return Ya(new e(e.LN10),t)}function x0(e){for(var t="";e--;)t+="0";return t}function e5(e,t){var n,r,a,l,h,i,y,x,w,C=1,P=10,E=e,j=E.d,D=E.constructor,B=D.precision;if(E.s<1)throw Error(Sf+(E.s?"NaN":"-Infinity"));if(E.eq(bh))return new D(0);if(t==null?(Bo=!1,x=B):x=t,E.eq(10))return t==null&&(Bo=!0),v4(D,x);if(x+=P,D.precision=x,n=Pm(j),r=n.charAt(0),l=Vl(E),Math.abs(l)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)E=E.times(e),n=Pm(E.d),r=n.charAt(0),C++;l=Vl(E),r>1?(E=new D("0."+n),l++):E=new D(r+"."+n.slice(1))}else return y=v4(D,x+2,B).times(l+""),E=e5(new D(r+"."+n.slice(1)),x-P).plus(y),D.precision=B,t==null?(Bo=!0,Ya(E,B)):E;for(i=h=E=Zg(E.minus(bh),E.plus(bh),x),w=Ya(E.times(E),x),a=3;;){if(h=Ya(h.times(w),x),y=i.plus(Zg(h,new D(a),x)),Pm(y.d).slice(0,x)===Pm(i.d).slice(0,x))return i=i.times(2),l!==0&&(i=i.plus(v4(D,x+2,B).times(l+""))),i=Zg(i,new D(C),x),D.precision=B,t==null?(Bo=!0,Ya(i,B)):i;i=y,a+=2}}function KW(e,t){var n,r,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(r,a),t){if(a-=r,n=n-r-1,e.e=Fw(n/wo),e.d=[],r=(n+1)%wo,n<0&&(r+=wo),r<a){for(r&&e.d.push(+t.slice(0,r)),a-=wo;r<a;)e.d.push(+t.slice(r,r+=wo));t=t.slice(r),r=wo-t.length}else r-=a;for(;r--;)t+="0";if(e.d.push(+t),Bo&&(e.e>$k||e.e<-$k))throw Error(Qz+n)}else e.s=0,e.e=0,e.d=[0];return e}function Ya(e,t,n){var r,a,l,h,i,y,x,w,C=e.d;for(h=1,l=C[0];l>=10;l/=10)h++;if(r=t-h,r<0)r+=wo,a=t,x=C[w=0];else{if(w=Math.ceil((r+1)/wo),l=C.length,w>=l)return e;for(x=l=C[w],h=1;l>=10;l/=10)h++;r%=wo,a=r-wo+h}if(n!==void 0&&(l=w_(10,h-a-1),i=x/l%10|0,y=t<0||C[w+1]!==void 0||x%l,y=n<4?(i||y)&&(n==0||n==(e.s<0?3:2)):i>5||i==5&&(n==4||y||n==6&&(r>0?a>0?x/w_(10,h-a):0:C[w-1])%10&1||n==(e.s<0?8:7))),t<1||!C[0])return y?(l=Vl(e),C.length=1,t=t-l-1,C[0]=w_(10,(wo-t%wo)%wo),e.e=Fw(-t/wo)||0):(C.length=1,C[0]=e.e=e.s=0),e;if(r==0?(C.length=w,l=1,w--):(C.length=w+1,l=w_(10,wo-r),C[w]=a>0?(x/w_(10,h-a)%w_(10,a)|0)*l:0),y)for(;;)if(w==0){(C[0]+=l)==Ac&&(C[0]=1,++e.e);break}else{if(C[w]+=l,C[w]!=Ac)break;C[w--]=0,l=1}for(r=C.length;C[--r]===0;)C.pop();if(Bo&&(e.e>$k||e.e<-$k))throw Error(Qz+Vl(e));return e}function lle(e,t){var n,r,a,l,h,i,y,x,w,C,P=e.constructor,E=P.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new P(e),Bo?Ya(t,E):t;if(y=e.d,C=t.d,r=t.e,x=e.e,y=y.slice(),h=x-r,h){for(w=h<0,w?(n=y,h=-h,i=C.length):(n=C,r=x,i=y.length),a=Math.max(Math.ceil(E/wo),i)+2,h>a&&(h=a,n.length=1),n.reverse(),a=h;a--;)n.push(0);n.reverse()}else{for(a=y.length,i=C.length,w=a<i,w&&(i=a),a=0;a<i;a++)if(y[a]!=C[a]){w=y[a]<C[a];break}h=0}for(w&&(n=y,y=C,C=n,t.s=-t.s),i=y.length,a=C.length-i;a>0;--a)y[i++]=0;for(a=C.length;a>h;){if(y[--a]<C[a]){for(l=a;l&&y[--l]===0;)y[l]=Ac-1;--y[l],y[a]+=Ac}y[a]-=C[a]}for(;y[--i]===0;)y.pop();for(;y[0]===0;y.shift())--r;return y[0]?(t.d=y,t.e=r,Bo?Ya(t,E):t):new P(0)}function _x(e,t,n){var r,a=Vl(e),l=Pm(e.d),h=l.length;return t?(n&&(r=n-h)>0?l=l.charAt(0)+"."+l.slice(1)+x0(r):h>1&&(l=l.charAt(0)+"."+l.slice(1)),l=l+(a<0?"e":"e+")+a):a<0?(l="0."+x0(-a-1)+l,n&&(r=n-h)>0&&(l+=x0(r))):a>=h?(l+=x0(a+1-h),n&&(r=n-a-1)>0&&(l=l+"."+x0(r))):((r=a+1)<h&&(l=l.slice(0,r)+"."+l.slice(r)),n&&(r=n-h)>0&&(a+1===h&&(l+="."),l+=x0(r))),e.s<0?"-"+l:l}function YW(e,t){if(e.length>t)return e.length=t,!0}function cle(e){var t,n,r;function a(l){var h=this;if(!(h instanceof a))return new a(l);if(h.constructor=a,l instanceof a){h.s=l.s,h.e=l.e,h.d=(l=l.d)?l.slice():l;return}if(typeof l=="number"){if(l*0!==0)throw Error(tx+l);if(l>0)h.s=1;else if(l<0)l=-l,h.s=-1;else{h.s=0,h.e=0,h.d=[0];return}if(l===~~l&&l<1e7){h.e=0,h.d=[l];return}return KW(h,l.toString())}else if(typeof l!="string")throw Error(tx+l);if(l.charCodeAt(0)===45?(l=l.slice(1),h.s=-1):h.s=1,LFe.test(l))KW(h,l);else throw Error(tx+l)}if(a.prototype=hi,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=cle,a.config=a.set=DFe,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return a.config(e),a}function DFe(e){if(!e||typeof e!="object")throw Error(Sf+"Object expected");var t,n,r,a=["precision",1,Ow,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((r=e[n=a[t]])!==void 0)if(Fw(r)===r&&r>=a[t+1]&&r<=a[t+2])this[n]=r;else throw Error(tx+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(tx+n+": "+r);return this}var eB=cle(MFe);bh=new eB(1);const La=eB;var RFe=e=>e,ule={"@@functional/placeholder":!0},dle=e=>e===ule,XW=e=>function t(){return arguments.length===0||arguments.length===1&&dle(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},hle=(e,t)=>e===1?t:XW(function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var l=r.filter(h=>h!==ule).length;return l>=e?t(...r):hle(e-l,XW(function(){for(var h=arguments.length,i=new Array(h),y=0;y<h;y++)i[y]=arguments[y];var x=r.map(w=>dle(w)?i.shift():w);return t(...x,...i)}))}),WI=e=>hle(e.length,e),Ij=(e,t)=>{for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},jFe=WI((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(n=>t[n]).map(e)),OFe=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(!n.length)return RFe;var a=n.reverse(),l=a[0],h=a.slice(1);return function(){return h.reduce((i,y)=>y(i),l(...arguments))}},Nj=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),fle=e=>{var t=null,n=null;return function(){for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return t&&a.every((h,i)=>{var y;return h===((y=t)===null||y===void 0?void 0:y[i])})||(t=a,n=e(...a)),n}};function ple(e){var t;return e===0?t=1:t=Math.floor(new La(e).abs().log(10).toNumber())+1,t}function mle(e,t,n){for(var r=new La(e),a=0,l=[];r.lt(t)&&a<1e5;)l.push(r.toNumber()),r=r.add(n),a++;return l}WI((e,t,n)=>{var r=+e,a=+t;return r+n*(a-r)});WI((e,t,n)=>{var r=t-+e;return r=r||1/0,(n-e)/r});WI((e,t,n)=>{var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});var gle=e=>{var[t,n]=e,[r,a]=[t,n];return t>n&&([r,a]=[n,t]),[r,a]},yle=(e,t,n)=>{if(e.lte(0))return new La(0);var r=ple(e.toNumber()),a=new La(10).pow(r),l=e.div(a),h=r!==1?.05:.1,i=new La(Math.ceil(l.div(h).toNumber())).add(n).mul(h),y=i.mul(a);return t?new La(y.toNumber()):new La(Math.ceil(y.toNumber()))},FFe=(e,t,n)=>{var r=new La(1),a=new La(e);if(!a.isint()&&n){var l=Math.abs(e);l<1?(r=new La(10).pow(ple(e)-1),a=new La(Math.floor(a.div(r).toNumber())).mul(r)):l>1&&(a=new La(Math.floor(e)))}else e===0?a=new La(Math.floor((t-1)/2)):n||(a=new La(Math.floor(e)));var h=Math.floor((t-1)/2),i=OFe(jFe(y=>a.add(new La(y-h).mul(r)).toNumber()),Ij);return i(0,t)},vle=function(t,n,r,a){var l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((n-t)/(r-1)))return{step:new La(0),tickMin:new La(0),tickMax:new La(0)};var h=yle(new La(n).sub(t).div(r-1),a,l),i;t<=0&&n>=0?i=new La(0):(i=new La(t).add(n).div(2),i=i.sub(new La(i).mod(h)));var y=Math.ceil(i.sub(t).div(h).toNumber()),x=Math.ceil(new La(n).sub(i).div(h).toNumber()),w=y+x+1;return w>r?vle(t,n,r,a,l+1):(w<r&&(x=n>0?x+(r-w):x,y=n>0?y:y+(r-w)),{step:h,tickMin:i.sub(new La(y).mul(h)),tickMax:i.add(new La(x).mul(h))})};function zFe(e){var[t,n]=e,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=Math.max(r,2),[h,i]=gle([t,n]);if(h===-1/0||i===1/0){var y=i===1/0?[h,...Ij(0,r-1).map(()=>1/0)]:[...Ij(0,r-1).map(()=>-1/0),i];return t>n?Nj(y):y}if(h===i)return FFe(h,r,a);var{step:x,tickMin:w,tickMax:C}=vle(h,i,l,a,0),P=mle(w,C.add(new La(.1).mul(x)),x);return t>n?Nj(P):P}function BFe(e,t){var[n,r]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[l,h]=gle([n,r]);if(l===-1/0||h===1/0)return[n,r];if(l===h)return[l];var i=Math.max(t,2),y=yle(new La(h).sub(l).div(i-1),a,0),x=[...mle(new La(l),new La(h),y),h];return a===!1&&(x=x.map(w=>Math.round(w))),n>r?Nj(x):x}var UFe=fle(zFe),VFe=fle(BFe),_le=e=>e.rootProps.maxBarSize,$Fe=e=>e.rootProps.barGap,xle=e=>e.rootProps.barCategoryGap,qFe=e=>e.rootProps.barSize,Q5=e=>e.rootProps.stackOffset,tB=e=>e.options.chartName,nB=e=>e.rootProps.syncId,ble=e=>e.rootProps.syncMethod,rB=e=>e.options.eventEmitter,Fg={allowDuplicatedCategory:!0,angleAxisId:0,axisLine:!0,cx:0,cy:0,orientation:"outer",reversed:!1,scale:"auto",tick:!0,tickLine:!0,tickSize:8,type:"category"},yh={allowDataOverflow:!1,allowDuplicatedCategory:!0,angle:0,axisLine:!0,cx:0,cy:0,orientation:"right",radiusAxisId:0,scale:"auto",stroke:"#ccc",tick:!0,tickCount:5,type:"number"},ZI=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},GFe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Fg.angleAxisId,includeHidden:!1,name:void 0,reversed:Fg.reversed,scale:Fg.scale,tick:Fg.tick,tickCount:void 0,ticks:void 0,type:Fg.type,unit:void 0},HFe={allowDataOverflow:yh.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:yh.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:yh.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:yh.scale,tick:yh.tick,tickCount:yh.tickCount,ticks:void 0,type:yh.type,unit:void 0},WFe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Fg.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Fg.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Fg.scale,tick:Fg.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},ZFe={allowDataOverflow:yh.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:yh.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:yh.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:yh.scale,tick:yh.tick,tickCount:yh.tickCount,ticks:void 0,type:"category",unit:void 0},iB=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?WFe:GFe,sB=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?ZFe:HFe,KI=e=>e.polarOptions,aB=_n([vy,_y,nc],Jae),wle=_n([KI,aB],(e,t)=>{if(e!=null)return Cu(e.innerRadius,t,0)}),Sle=_n([KI,aB],(e,t)=>{if(e!=null)return Cu(e.outerRadius,t,t*.8)}),KFe=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:n}=e;return[t,n]},Ale=_n([KI],KFe);_n([iB,Ale],ZI);var Tle=_n([aB,wle,Sle],(e,t,n)=>{if(!(e==null||t==null||n==null))return[t,n]});_n([sB,Tle],ZI);var Cle=_n([Hs,KI,wle,Sle,vy,_y],(e,t,n,r,a,l)=>{if(!(e!=="centric"&&e!=="radial"||t==null||n==null||r==null)){var{cx:h,cy:i,startAngle:y,endAngle:x}=t;return{cx:Cu(h,a,a/2),cy:Cu(i,l,l/2),innerRadius:n,outerRadius:r,startAngle:y,endAngle:x,clockWise:!1}}}),Uo=(e,t)=>t,eT=(e,t,n)=>n;function YI(e){return e==null?void 0:e.id}var sc=e=>{var t=Hs(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},zw=e=>e.tooltip.settings.axisId,Ic=e=>{var t=sc(e),n=zw(e);return tT(e,t,n)},Ele=_n([Ic],e=>e==null?void 0:e.dataKey);function Ple(e,t,n){var{chartData:r=[]}=t,{allowDuplicatedCategory:a,dataKey:l}=n,h=new Map;return e.forEach(i=>{var y,x=(y=i.data)!==null&&y!==void 0?y:r;if(!(x==null||x.length===0)){var w=YI(i);x.forEach((C,P)=>{var E=l==null||a?P:String(qa(C,l,null)),j=qa(C,i.dataKey,0),D;h.has(E)?D=h.get(E):D={},Object.assign(D,{[w]:j}),h.set(E,D)})}}),Array.from(h.values())}function XI(e){return e.stackId!=null&&e.dataKey!=null}function JW(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function qk(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?JW(Object(n),!0).forEach(function(r){YFe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JW(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function YFe(e,t,n){return(t=XFe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function XFe(e){var t=JFe(e,"string");return typeof t=="symbol"?t:t+""}function JFe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mj=[0,"auto"],hh={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},kle=(e,t)=>e.cartesianAxis.xAxis[t],wy=(e,t)=>{var n=kle(e,t);return n??hh},fh={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Mj,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:H5},Ile=(e,t)=>e.cartesianAxis.yAxis[t],Sy=(e,t)=>{var n=Ile(e,t);return n??fh},QFe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},oB=(e,t)=>{var n=e.cartesianAxis.zAxis[t];return n??QFe},Tl=(e,t,n)=>{switch(t){case"xAxis":return wy(e,n);case"yAxis":return Sy(e,n);case"zAxis":return oB(e,n);case"angleAxis":return iB(e,n);case"radiusAxis":return sB(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},e6e=(e,t,n)=>{switch(t){case"xAxis":return wy(e,n);case"yAxis":return Sy(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},tT=(e,t,n)=>{switch(t){case"xAxis":return wy(e,n);case"yAxis":return Sy(e,n);case"angleAxis":return iB(e,n);case"radiusAxis":return sB(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},Nle=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function lB(e,t){return n=>{switch(e){case"xAxis":return"xAxisId"in n&&n.xAxisId===t;case"yAxis":return"yAxisId"in n&&n.yAxisId===t;case"zAxis":return"zAxisId"in n&&n.zAxisId===t;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===t;default:return!1}}}var nT=e=>e.graphicalItems.cartesianItems,t6e=_n([Uo,eT],lB),cB=(e,t,n)=>e.filter(n).filter(r=>(t==null?void 0:t.includeHidden)===!0?!0:!r.hide),rT=_n([nT,Tl,t6e],cB),Mle=_n([rT],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(XI)),Lle=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),Dle=_n([rT],Lle),uB=e=>e.map(t=>t.data).filter(Boolean).flat(1),n6e=_n([rT],uB),dB=(e,t)=>{var{chartData:n=[],dataStartIndex:r,dataEndIndex:a}=t;return e.length>0?e:n.slice(r,a+1)},hB=_n([n6e,J5],dB),fB=(e,t,n)=>(t==null?void 0:t.dataKey)!=null?e.map(r=>({value:qa(r,t.dataKey)})):n.length>0?n.map(r=>r.dataKey).flatMap(r=>e.map(a=>({value:qa(a,r)}))):e.map(r=>({value:r})),JI=_n([hB,Tl,rT],fB);function Rle(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Rx(e){return e.filter(t=>Gm(t)||t instanceof Date).map(Number).filter(t=>Zd(t)===!1)}function r6e(e,t,n){return!n||typeof t!="number"||Zd(t)?[]:n.length?Rx(n.flatMap(r=>{var a=qa(e,r.dataKey),l,h;if(Array.isArray(a)?[l,h]=a:l=h=a,!(!Kc(l)||!Kc(h)))return[t-l,t+h]})):[]}var i6e=_n([Mle,J5,Ic],Ple),jle=(e,t,n)=>{var r={},a=t.reduce((l,h)=>(h.stackId==null||(l[h.stackId]==null&&(l[h.stackId]=[]),l[h.stackId].push(h)),l),r);return Object.fromEntries(Object.entries(a).map(l=>{var[h,i]=l,y=i.map(YI);return[h,{stackedData:CDe(e,y,n),graphicalItems:i}]}))},t5=_n([i6e,Mle,Q5],jle),Ole=(e,t,n)=>{var{dataStartIndex:r,dataEndIndex:a}=t;if(n!=="zAxis"){var l=IDe(e,r,a);if(!(l!=null&&l[0]===0&&l[1]===0))return l}},s6e=_n([t5,Mv,Uo],Ole),Fle=(e,t,n,r,a)=>n.length>0?e.flatMap(l=>n.flatMap(h=>{var i,y,x=(i=r[h.id])===null||i===void 0?void 0:i.filter(C=>Rle(a,C)),w=qa(l,(y=t.dataKey)!==null&&y!==void 0?y:h.dataKey);return{value:w,errorDomain:r6e(l,w,x)}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(l=>({value:qa(l,t.dataKey),errorDomain:[]})):e.map(l=>({value:l,errorDomain:[]})),QI=e=>e.errorBars,zle=(e,t,n)=>e.flatMap(r=>t[r.id]).filter(Boolean).filter(r=>Rle(n,r));_n([Dle,QI,Uo],zle);var a6e=_n([hB,Tl,Dle,QI,Uo],Fle);function o6e(e){var{value:t}=e;if(Gm(t)||t instanceof Date)return t}var QW=e=>{var t=e.flatMap(r=>[r.value,r.errorDomain]).flat(1),n=Rx(t);if(n.length!==0)return[Math.min(...n),Math.max(...n)]},l6e=(e,t,n)=>{var r=e.map(o6e).filter(a=>a!=null);return n&&(t.dataKey==null||t.allowDuplicatedCategory&&Nse(r))?Aoe(0,e.length):t.allowDuplicatedCategory?r:Array.from(new Set(r))},pB=e=>{var t;if(e==null||!("domain"in e))return Mj;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var n=Rx(e.ticks);return[Math.min(...n),Math.max(...n)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:Mj},Gk=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=n.filter(Boolean);if(a.length!==0){var l=a.flat(),h=Math.min(...l),i=Math.max(...l);return[h,i]}},Ble=e=>e.referenceElements.dots,Bw=(e,t,n)=>e.filter(r=>r.ifOverflow==="extendDomain").filter(r=>t==="xAxis"?r.xAxisId===n:r.yAxisId===n),c6e=_n([Ble,Uo,eT],Bw),Ule=e=>e.referenceElements.areas,u6e=_n([Ule,Uo,eT],Bw),Vle=e=>e.referenceElements.lines,d6e=_n([Vle,Uo,eT],Bw),$le=(e,t)=>{var n=Rx(e.map(r=>t==="xAxis"?r.x:r.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},h6e=_n(c6e,Uo,$le),qle=(e,t)=>{var n=Rx(e.flatMap(r=>[t==="xAxis"?r.x1:r.y1,t==="xAxis"?r.x2:r.y2]));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},f6e=_n([u6e,Uo],qle),Gle=(e,t)=>{var n=Rx(e.map(r=>t==="xAxis"?r.x:r.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},p6e=_n(d6e,Uo,Gle),m6e=_n(h6e,p6e,f6e,(e,t,n)=>Gk(e,n,t)),Hle=_n([Tl],pB),mB=(e,t,n,r,a,l,h)=>{var i=IFe(t,e.allowDataOverflow);if(i!=null)return i;var y=l==="vertical"&&h==="xAxis"||l==="horizontal"&&h==="yAxis",x=y?Gk(n,a,QW(r)):Gk(a,QW(r));return NFe(t,x,e.allowDataOverflow)},g6e=_n([Tl,Hle,s6e,a6e,m6e,Hs,Uo],mB),y6e=[0,1],gB=(e,t,n,r,a,l,h)=>{if(!((e==null||n==null||n.length===0)&&h===void 0)){var{dataKey:i,type:y}=e,x=Xm(t,l);return x&&i==null?Aoe(0,n.length):y==="category"?l6e(r,e,x):a==="expand"?y6e:h}},yB=_n([Tl,Hs,hB,JI,Q5,Uo,g6e],gB),Wle=(e,t,n,r,a)=>{if(e!=null){var{scale:l,type:h}=e;if(l==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":h==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?"point":h==="category"?"band":"linear";if(typeof l=="string"){var i="scale".concat($5(l));return i in LS?i:"point"}}},Uw=_n([Tl,Hs,Nle,tB,Uo],Wle);function v6e(e){if(e!=null){if(e in LS)return LS[e]();var t="scale".concat($5(e));if(t in LS)return LS[t]()}}function vB(e,t,n,r){if(!(n==null||r==null)){if(typeof e.scale=="function")return e.scale.copy().domain(n).range(r);var a=v6e(t);if(a!=null){var l=a.domain(n).range(r);return bDe(l),l}}}var _B=(e,t,n)=>{var r=pB(t);if(!(n!=="auto"&&n!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(r)&&(r[0]==="auto"||r[1]==="auto")&&mw(e))return UFe(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&mw(e))return VFe(e,t.tickCount,t.allowDecimals)}},xB=_n([yB,tT,Uw],_B),bB=(e,t,n,r)=>{if(r!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&mw(t)&&Array.isArray(n)&&n.length>0){var a=t[0],l=n[0],h=t[1],i=n[n.length-1];return[Math.min(a,l),Math.max(h,i)]}return t},_6e=_n([Tl,yB,xB,Uo],bB),x6e=_n(JI,Tl,(e,t)=>{if(!(!t||t.type!=="number")){var n=1/0,r=Array.from(Rx(e.map(i=>i.value))).sort((i,y)=>i-y);if(r.length<2)return 1/0;var a=r[r.length-1]-r[0];if(a===0)return 1/0;for(var l=0;l<r.length-1;l++){var h=r[l+1]-r[l];n=Math.min(n,h)}return n/a}}),Zle=_n(x6e,Hs,xle,nc,(e,t,n,r)=>r,(e,t,n,r,a)=>{if(!Kc(e))return 0;var l=t==="vertical"?r.height:r.width;if(a==="gap")return e*l/2;if(a==="no-gap"){var h=Cu(n,e*l),i=e*l/2;return i-h-(i-h)/l*h}return 0}),b6e=(e,t)=>{var n=wy(e,t);return n==null||typeof n.padding!="string"?0:Zle(e,"xAxis",t,n.padding)},w6e=(e,t)=>{var n=Sy(e,t);return n==null||typeof n.padding!="string"?0:Zle(e,"yAxis",t,n.padding)},S6e=_n(wy,b6e,(e,t)=>{var n,r;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((n=a.left)!==null&&n!==void 0?n:0)+t,right:((r=a.right)!==null&&r!==void 0?r:0)+t}}),A6e=_n(Sy,w6e,(e,t)=>{var n,r;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((n=a.top)!==null&&n!==void 0?n:0)+t,bottom:((r=a.bottom)!==null&&r!==void 0?r:0)+t}}),T6e=_n([nc,S6e,BI,zI,(e,t,n)=>n],(e,t,n,r,a)=>{var{padding:l}=r;return a?[l.left,n.width-l.right]:[e.left+t.left,e.left+e.width-t.right]}),C6e=_n([nc,Hs,A6e,BI,zI,(e,t,n)=>n],(e,t,n,r,a,l)=>{var{padding:h}=a;return l?[r.height-h.bottom,h.top]:t==="horizontal"?[e.top+e.height-n.bottom,e.top+n.top]:[e.top+n.top,e.top+e.height-n.bottom]}),iT=(e,t,n,r)=>{var a;switch(t){case"xAxis":return T6e(e,n,r);case"yAxis":return C6e(e,n,r);case"zAxis":return(a=oB(e,n))===null||a===void 0?void 0:a.range;case"angleAxis":return Ale(e);case"radiusAxis":return Tle(e,n);default:return}},Kle=_n([Tl,iT],ZI),Vw=_n([Tl,Uw,_6e,Kle],vB);_n([rT,QI,Uo],zle);function Yle(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var eN=(e,t)=>t,tN=(e,t,n)=>n,E6e=_n(OI,eN,tN,(e,t,n)=>e.filter(r=>r.orientation===t).filter(r=>r.mirror===n).sort(Yle)),P6e=_n(FI,eN,tN,(e,t,n)=>e.filter(r=>r.orientation===t).filter(r=>r.mirror===n).sort(Yle)),Xle=(e,t)=>({width:e.width,height:t.height}),k6e=(e,t)=>{var n=typeof t.width=="number"?t.width:H5;return{width:n,height:e.height}},Jle=_n(nc,wy,Xle),I6e=(e,t,n)=>{switch(t){case"top":return e.top;case"bottom":return n-e.bottom;default:return 0}},N6e=(e,t,n)=>{switch(t){case"left":return e.left;case"right":return n-e.right;default:return 0}},M6e=_n(_y,nc,E6e,eN,tN,(e,t,n,r,a)=>{var l={},h;return n.forEach(i=>{var y=Xle(t,i);h==null&&(h=I6e(t,r,e));var x=r==="top"&&!a||r==="bottom"&&a;l[i.id]=h-Number(x)*y.height,h+=(x?-1:1)*y.height}),l}),L6e=_n(vy,nc,P6e,eN,tN,(e,t,n,r,a)=>{var l={},h;return n.forEach(i=>{var y=k6e(t,i);h==null&&(h=N6e(t,r,e));var x=r==="left"&&!a||r==="right"&&a;l[i.id]=h-Number(x)*y.width,h+=(x?-1:1)*y.width}),l}),D6e=(e,t)=>{var n=wy(e,t);if(n!=null)return M6e(e,n.orientation,n.mirror)},R6e=_n([nc,wy,D6e,(e,t)=>t],(e,t,n,r)=>{if(t!=null){var a=n==null?void 0:n[r];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),j6e=(e,t)=>{var n=Sy(e,t);if(n!=null)return L6e(e,n.orientation,n.mirror)},O6e=_n([nc,Sy,j6e,(e,t)=>t],(e,t,n,r)=>{if(t!=null){var a=n==null?void 0:n[r];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),Qle=_n(nc,Sy,(e,t)=>{var n=typeof t.width=="number"?t.width:H5;return{width:n,height:e.height}}),eZ=(e,t,n)=>{switch(t){case"xAxis":return Jle(e,n).width;case"yAxis":return Qle(e,n).height;default:return}},ece=(e,t,n,r)=>{if(n!=null){var{allowDuplicatedCategory:a,type:l,dataKey:h}=n,i=Xm(e,r),y=t.map(x=>x.value);if(h&&i&&l==="category"&&a&&Nse(y))return y}},wB=_n([Hs,JI,Tl,Uo],ece),tce=(e,t,n,r)=>{if(!(n==null||n.dataKey==null)){var{type:a,scale:l}=n,h=Xm(e,r);if(h&&(a==="number"||l!=="auto"))return t.map(i=>i.value)}},SB=_n([Hs,JI,tT,Uo],tce),tZ=_n([Hs,e6e,Uw,Vw,wB,SB,iT,xB,Uo],(e,t,n,r,a,l,h,i,y)=>{if(t==null)return null;var x=Xm(e,y);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:y,categoricalDomain:l,duplicateDomain:a,isCategorical:x,niceTicks:i,range:h,realScaleType:n,scale:r}}),F6e=(e,t,n,r,a,l,h,i,y)=>{if(!(t==null||r==null)){var x=Xm(e,y),{type:w,ticks:C,tickCount:P}=t,E=n==="scaleBand"&&typeof r.bandwidth=="function"?r.bandwidth()/2:2,j=w==="category"&&r.bandwidth?r.bandwidth()/E:0;j=y==="angleAxis"&&l!=null&&l.length>=2?Ec(l[0]-l[1])*2*j:j;var D=C||a;if(D){var B=D.map((F,$)=>{var H=h?h.indexOf(F):F;return{index:$,coordinate:r(H)+j,value:F,offset:j}});return B.filter(F=>!Zd(F.coordinate))}return x&&i?i.map((F,$)=>({coordinate:r(F)+j,value:F,index:$,offset:j})):r.ticks?r.ticks(P).map(F=>({coordinate:r(F)+j,value:F,offset:j})):r.domain().map((F,$)=>({coordinate:r(F)+j,value:h?h[F]:F,index:$,offset:j}))}},nce=_n([Hs,tT,Uw,Vw,xB,iT,wB,SB,Uo],F6e),z6e=(e,t,n,r,a,l,h)=>{if(!(t==null||n==null||r==null||r[0]===r[1])){var i=Xm(e,h),{tickCount:y}=t,x=0;return x=h==="angleAxis"&&(r==null?void 0:r.length)>=2?Ec(r[0]-r[1])*2*x:x,i&&l?l.map((w,C)=>({coordinate:n(w)+x,value:w,index:C,offset:x})):n.ticks?n.ticks(y).map(w=>({coordinate:n(w)+x,value:w,offset:x})):n.domain().map((w,C)=>({coordinate:n(w)+x,value:a?a[w]:w,index:C,offset:x}))}},Wm=_n([Hs,tT,Vw,iT,wB,SB,Uo],z6e),Zm=_n(Tl,Vw,(e,t)=>{if(!(e==null||t==null))return qk(qk({},e),{},{scale:t})}),B6e=_n([Tl,Uw,yB,Kle],vB);_n((e,t,n)=>oB(e,n),B6e,(e,t)=>{if(!(e==null||t==null))return qk(qk({},e),{},{scale:t})});var U6e=_n([Hs,OI,FI],(e,t,n)=>{switch(e){case"horizontal":return t.some(r=>r.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(r=>r.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),rce=e=>e.options.defaultTooltipEventType,ice=e=>e.options.validateTooltipEventTypes;function sce(e,t,n){if(e==null)return t;var r=e?"axis":"item";return n==null?t:n.includes(r)?r:t}function AB(e,t){var n=rce(e),r=ice(e);return sce(t,n,r)}function V6e(e){return Si(t=>AB(t,e))}var ace=(e,t)=>{var n,r=Number(t);if(!(Zd(r)||t==null))return r>=0?e==null||(n=e[r])===null||n===void 0?void 0:n.value:void 0},$6e=e=>e.tooltip.settings,C0={active:!1,index:null,dataKey:void 0,coordinate:void 0},q6e={itemInteraction:{click:C0,hover:C0},axisInteraction:{click:C0,hover:C0},keyboardInteraction:C0,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},oce=Dh({name:"tooltip",initialState:q6e,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var n=Wg(e).tooltipItemPayloads.indexOf(t.payload);n>-1&&e.tooltipItemPayloads.splice(n,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:G6e,removeTooltipEntrySettings:H6e,setTooltipSettingsState:W6e,setActiveMouseOverItemIndex:lce,mouseLeaveItem:Z6e,mouseLeaveChart:cce,setActiveClickItemIndex:K6e,setMouseOverAxisIndex:uce,setMouseClickAxisIndex:Y6e,setSyncInteraction:Lj,setKeyboardInteraction:Dj}=oce.actions,X6e=oce.reducer;function nZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function gE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nZ(Object(n),!0).forEach(function(r){J6e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function J6e(e,t,n){return(t=Q6e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Q6e(e){var t=eze(e,"string");return typeof t=="symbol"?t:t+""}function eze(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tze(e,t,n){return t==="axis"?n==="click"?e.axisInteraction.click:e.axisInteraction.hover:n==="click"?e.itemInteraction.click:e.itemInteraction.hover}function nze(e){return e.index!=null}var dce=(e,t,n,r)=>{if(t==null)return C0;var a=tze(e,t,n);if(a==null)return C0;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var l=e.settings.active===!0;if(nze(a)){if(l)return gE(gE({},a),{},{active:!0})}else if(r!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:r};return gE(gE({},C0),{},{coordinate:a.coordinate})},TB=(e,t)=>{var n=e==null?void 0:e.index;if(n==null)return null;var r=Number(n);if(!Kc(r))return n;var a=0,l=1/0;return t.length>0&&(l=t.length-1),String(Math.max(a,Math.min(r,l)))},hce=(e,t,n,r,a,l,h,i)=>{if(!(l==null||i==null)){var y=h[0],x=y==null?void 0:i(y.positions,l);if(x!=null)return x;var w=a==null?void 0:a[Number(l)];if(w)switch(n){case"horizontal":return{x:w.coordinate,y:(r.top+t)/2};default:return{x:(r.left+e)/2,y:w.coordinate}}}},fce=(e,t,n,r)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return n==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&r!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(l=>{var h;return((h=l.settings)===null||h===void 0?void 0:h.dataKey)===a})},sT=e=>e.options.tooltipPayloadSearcher,$w=e=>e.tooltip;function rZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function iZ(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?rZ(Object(n),!0).forEach(function(r){rze(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function rze(e,t,n){return(t=ize(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ize(e){var t=sze(e,"string");return typeof t=="symbol"?t:t+""}function sze(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aze(e,t){return e??t}var pce=(e,t,n,r,a,l,h)=>{if(!(t==null||l==null)){var{chartData:i,computedData:y,dataStartIndex:x,dataEndIndex:w}=n,C=[];return e.reduce((P,E)=>{var j,{dataDefinedOnItem:D,settings:B}=E,F=aze(D,i),$=Array.isArray(F)?Qae(F,x,w):F,H=(j=B==null?void 0:B.dataKey)!==null&&j!==void 0?j:r,J=B==null?void 0:B.nameKey,ee;if(r&&Array.isArray($)&&!Array.isArray($[0])&&h==="axis"?ee=Mse($,r,a):ee=l($,t,y,J),Array.isArray(ee))ee.forEach(ne=>{var pe=iZ(iZ({},B),{},{name:ne.name,unit:ne.unit,color:void 0,fill:void 0});P.push(HH({tooltipEntrySettings:pe,dataKey:ne.dataKey,payload:ne.payload,value:qa(ne.payload,ne.dataKey),name:ne.name}))});else{var Q;P.push(HH({tooltipEntrySettings:B,dataKey:H,payload:ee,value:qa(ee,H),name:(Q=qa(ee,J))!==null&&Q!==void 0?Q:B==null?void 0:B.name}))}return P},C)}},CB=_n([Ic,Hs,Nle,tB,sc],Wle),oze=_n([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),lze=_n([sc,zw],lB),aT=_n([oze,Ic,lze],cB),cze=_n([aT],e=>e.filter(XI)),uze=_n([aT],uB),qw=_n([uze,Mv],dB),dze=_n([cze,Mv,Ic],Ple),EB=_n([qw,Ic,aT],fB),hze=_n([Ic],pB),fze=_n([aT],e=>e.filter(XI)),pze=_n([dze,fze,Q5],jle),mze=_n([pze,Mv,sc],Ole),gze=_n([aT],Lle),yze=_n([qw,Ic,gze,QI,sc],Fle),vze=_n([Ble,sc,zw],Bw),_ze=_n([vze,sc],$le),xze=_n([Ule,sc,zw],Bw),bze=_n([xze,sc],qle),wze=_n([Vle,sc,zw],Bw),Sze=_n([wze,sc],Gle),Aze=_n([_ze,Sze,bze],Gk),Tze=_n([Ic,hze,mze,yze,Aze,Hs,sc],mB),mce=_n([Ic,Hs,qw,EB,Q5,sc,Tze],gB),Cze=_n([mce,Ic,CB],_B),Eze=_n([Ic,mce,Cze,sc],bB),gce=e=>{var t=sc(e),n=zw(e),r=!1;return iT(e,t,n,r)},yce=_n([Ic,gce],ZI),vce=_n([Ic,CB,Eze,yce],vB),Pze=_n([Hs,EB,Ic,sc],ece),kze=_n([Hs,EB,Ic,sc],tce),Ize=(e,t,n,r,a,l,h,i)=>{if(t){var{type:y}=t,x=Xm(e,i);if(r){var w=n==="scaleBand"&&r.bandwidth?r.bandwidth()/2:2,C=y==="category"&&r.bandwidth?r.bandwidth()/w:0;return C=i==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?Ec(a[0]-a[1])*2*C:C,x&&h?h.map((P,E)=>({coordinate:r(P)+C,value:P,index:E,offset:C})):r.domain().map((P,E)=>({coordinate:r(P)+C,value:l?l[P]:P,index:E,offset:C}))}}},Ay=_n([Hs,Ic,CB,vce,gce,Pze,kze,sc],Ize),PB=_n([rce,ice,$6e],(e,t,n)=>sce(n.shared,e,t)),_ce=e=>e.tooltip.settings.trigger,kB=e=>e.tooltip.settings.defaultIndex,nN=_n([$w,PB,_ce,kB],dce),gv=_n([nN,qw],TB),xce=_n([Ay,gv],ace),bce=_n([nN],e=>{if(e)return e.dataKey}),wce=_n([$w,PB,_ce,kB],fce),Nze=_n([vy,_y,Hs,nc,Ay,kB,wce,sT],hce),Mze=_n([nN,Nze],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),Lze=_n([nN],e=>e.active),Dze=_n([wce,gv,Mv,Ele,xce,sT,PB],pce),Rze=_n([Dze],e=>{if(e!=null){var t=e.map(n=>n.payload).filter(n=>n!=null);return Array.from(new Set(t))}});function sZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function aZ(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?sZ(Object(n),!0).forEach(function(r){jze(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function jze(e,t,n){return(t=Oze(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oze(e){var t=Fze(e,"string");return typeof t=="symbol"?t:t+""}function Fze(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zze=()=>Si(Ic),Bze=()=>{var e=zze(),t=Si(Ay),n=Si(vce);return vx(aZ(aZ({},e),{},{scale:n}),t)},Sce=()=>Si(tB),IB=(e,t)=>t,Ace=(e,t,n)=>n,NB=(e,t,n,r)=>r,Uze=_n(Ay,e=>NI(e,t=>t.coordinate)),MB=_n([$w,IB,Ace,NB],dce),Tce=_n([MB,qw],TB),Vze=(e,t,n)=>{if(t!=null){var r=$w(e);return t==="axis"?n==="hover"?r.axisInteraction.hover.dataKey:r.axisInteraction.click.dataKey:n==="hover"?r.itemInteraction.hover.dataKey:r.itemInteraction.click.dataKey}},Cce=_n([$w,IB,Ace,NB],fce),Hk=_n([vy,_y,Hs,nc,Ay,NB,Cce,sT],hce),$ze=_n([MB,Hk],(e,t)=>{var n;return(n=e.coordinate)!==null&&n!==void 0?n:t}),Ece=_n(Ay,Tce,ace),qze=_n([Cce,Tce,Mv,Ele,Ece,sT,IB],pce),Gze=_n([MB],e=>({isActive:e.active,activeIndex:e.index})),Hze=(e,t,n,r,a,l,h,i)=>{if(!(!e||!t||!r||!a||!l)){var y=NDe(e.chartX,e.chartY,t,n,i);if(y){var x=LDe(y,t),w=_De(x,h,l,r,a),C=MDe(t,l,w,y);return{activeIndex:String(w),activeCoordinate:C}}}};function Rj(){return Rj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Rj.apply(null,arguments)}function oZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function yE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?oZ(Object(n),!0).forEach(function(r){Wze(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Wze(e,t,n){return(t=Zze(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zze(e){var t=Kze(e,"string");return typeof t=="symbol"?t:t+""}function Kze(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yze(e){var{coordinate:t,payload:n,index:r,offset:a,tooltipAxisBandSize:l,layout:h,cursor:i,tooltipEventType:y,chartName:x}=e,w=t,C=n,P=r;if(!i||!w||x!=="ScatterChart"&&y!=="axis")return null;var E,j;if(x==="ScatterChart")E=w,j=xRe;else if(x==="BarChart")E=bRe(h,w,a,l),j=yoe;else if(h==="radial"){var{cx:D,cy:B,radius:F,startAngle:$,endAngle:H}=voe(w);E={cx:D,cy:B,startAngle:$,endAngle:H,innerRadius:F,outerRadius:F},j=xoe}else E={points:eje(h,w,a)},j=wb;var J=typeof i=="object"&&"className"in i?i.className:void 0,ee=yE(yE(yE(yE({stroke:"#ccc",pointerEvents:"none"},a),E),Eo(i,!1)),{},{payload:C,payloadIndex:P,className:ra("recharts-tooltip-cursor",J)});return L.isValidElement(i)?L.cloneElement(i,ee):L.createElement(j,ee)}function Xze(e){var t=Bze(),n=aoe(),r=W5(),a=Sce();return L.createElement(Yze,Rj({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:n,layout:r,tooltipAxisBandSize:t,chartName:a}))}var Pce=L.createContext(null),Jze=()=>L.useContext(Pce),kce={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function a(y,x,w){this.fn=y,this.context=x,this.once=w||!1}function l(y,x,w,C,P){if(typeof w!="function")throw new TypeError("The listener must be a function");var E=new a(w,C||y,P),j=n?n+x:x;return y._events[j]?y._events[j].fn?y._events[j]=[y._events[j],E]:y._events[j].push(E):(y._events[j]=E,y._eventsCount++),y}function h(y,x){--y._eventsCount===0?y._events=new r:delete y._events[x]}function i(){this._events=new r,this._eventsCount=0}i.prototype.eventNames=function(){var x=[],w,C;if(this._eventsCount===0)return x;for(C in w=this._events)t.call(w,C)&&x.push(n?C.slice(1):C);return Object.getOwnPropertySymbols?x.concat(Object.getOwnPropertySymbols(w)):x},i.prototype.listeners=function(x){var w=n?n+x:x,C=this._events[w];if(!C)return[];if(C.fn)return[C.fn];for(var P=0,E=C.length,j=new Array(E);P<E;P++)j[P]=C[P].fn;return j},i.prototype.listenerCount=function(x){var w=n?n+x:x,C=this._events[w];return C?C.fn?1:C.length:0},i.prototype.emit=function(x,w,C,P,E,j){var D=n?n+x:x;if(!this._events[D])return!1;var B=this._events[D],F=arguments.length,$,H;if(B.fn){switch(B.once&&this.removeListener(x,B.fn,void 0,!0),F){case 1:return B.fn.call(B.context),!0;case 2:return B.fn.call(B.context,w),!0;case 3:return B.fn.call(B.context,w,C),!0;case 4:return B.fn.call(B.context,w,C,P),!0;case 5:return B.fn.call(B.context,w,C,P,E),!0;case 6:return B.fn.call(B.context,w,C,P,E,j),!0}for(H=1,$=new Array(F-1);H<F;H++)$[H-1]=arguments[H];B.fn.apply(B.context,$)}else{var J=B.length,ee;for(H=0;H<J;H++)switch(B[H].once&&this.removeListener(x,B[H].fn,void 0,!0),F){case 1:B[H].fn.call(B[H].context);break;case 2:B[H].fn.call(B[H].context,w);break;case 3:B[H].fn.call(B[H].context,w,C);break;case 4:B[H].fn.call(B[H].context,w,C,P);break;default:if(!$)for(ee=1,$=new Array(F-1);ee<F;ee++)$[ee-1]=arguments[ee];B[H].fn.apply(B[H].context,$)}}return!0},i.prototype.on=function(x,w,C){return l(this,x,w,C,!1)},i.prototype.once=function(x,w,C){return l(this,x,w,C,!0)},i.prototype.removeListener=function(x,w,C,P){var E=n?n+x:x;if(!this._events[E])return this;if(!w)return h(this,E),this;var j=this._events[E];if(j.fn)j.fn===w&&(!P||j.once)&&(!C||j.context===C)&&h(this,E);else{for(var D=0,B=[],F=j.length;D<F;D++)(j[D].fn!==w||P&&!j[D].once||C&&j[D].context!==C)&&B.push(j[D]);B.length?this._events[E]=B.length===1?B[0]:B:h(this,E)}return this},i.prototype.removeAllListeners=function(x){var w;return x?(w=n?n+x:x,this._events[w]&&h(this,w)):(this._events=new r,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=n,i.EventEmitter=i,e.exports=i})(kce);var Qze=kce.exports;const eBe=Ip(Qze);var n5=new eBe,jj="recharts.syncEvent.tooltip",lZ="recharts.syncEvent.brush";function oT(e,t){if(t){var n=Number.parseInt(t,10);if(!Zd(n))return e==null?void 0:e[n]}}var tBe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},Ice=Dh({name:"options",initialState:tBe,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),nBe=Ice.reducer,{createEventEmitter:rBe}=Ice.actions;function iBe(e){return e.tooltip.syncInteraction}var sBe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},Nce=Dh({name:"chartData",initialState:sBe,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:n,endIndex:r}=t.payload;n!=null&&(e.dataStartIndex=n),r!=null&&(e.dataEndIndex=r)}}}),{setChartData:cZ,setDataStartEndIndexes:aBe,setComputedData:qXe}=Nce.actions,oBe=Nce.reducer,lBe=["x","y"];function uZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function m_(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?uZ(Object(n),!0).forEach(function(r){cBe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function cBe(e,t,n){return(t=uBe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uBe(e){var t=dBe(e,"string");return typeof t=="symbol"?t:t+""}function dBe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hBe(e,t){if(e==null)return{};var n,r,a=fBe(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function fBe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var Mce=()=>{};function pBe(){var e=Si(nB),t=Si(rB),n=Al(),r=Si(ble),a=Si(Ay),l=W5(),h=Pz(),i=Si(y=>y.rootProps.className);L.useEffect(()=>{if(e==null)return Mce;var y=(x,w,C)=>{if(t!==C&&e===x){if(r==="index"){var P;if(h&&w!==null&&w!==void 0&&(P=w.payload)!==null&&P!==void 0&&P.coordinate){var E=w.payload.coordinate,{x:j,y:D}=E,B=hBe(E,lBe),F=m_(m_(m_({},B),typeof j=="number"&&{x:Math.max(h.x,Math.min(j,h.x+h.width))}),typeof D=="number"&&{y:Math.max(h.y,Math.min(D,h.y+h.height))}),$=m_(m_({},w),{},{payload:m_(m_({},w.payload),{},{coordinate:F})});n($)}else n(w);return}if(a!=null){var H;if(typeof r=="function"){var J={activeTooltipIndex:w.payload.index==null?void 0:Number(w.payload.index),isTooltipActive:w.payload.active,activeIndex:w.payload.index==null?void 0:Number(w.payload.index),activeLabel:w.payload.label,activeDataKey:w.payload.dataKey,activeCoordinate:w.payload.coordinate},ee=r(a,J);H=a[ee]}else r==="value"&&(H=a.find(Ce=>String(Ce.value)===w.payload.label));var{coordinate:Q}=w.payload;if(H==null||w.payload.active===!1||Q==null||h==null){n(Lj({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:ne,y:pe}=Q,he=Math.min(ne,h.x+h.width),we=Math.min(pe,h.y+h.height),fe={x:l==="horizontal"?H.coordinate:he,y:l==="horizontal"?we:H.coordinate},ge=Lj({active:w.payload.active,coordinate:fe,dataKey:w.payload.dataKey,index:String(H.index),label:w.payload.label});n(ge)}}};return n5.on(jj,y),()=>{n5.off(jj,y)}},[i,n,t,e,r,a,l,h])}function mBe(){var e=Si(nB),t=Si(rB),n=Al();L.useEffect(()=>{if(e==null)return Mce;var r=(a,l,h)=>{t!==h&&e===a&&n(aBe(l))};return n5.on(lZ,r),()=>{n5.off(lZ,r)}},[n,t,e])}function gBe(){var e=Al();L.useEffect(()=>{e(rBe())},[e]),pBe(),mBe()}function yBe(e,t,n,r,a,l){var h=Si(P=>Vze(P,e,t)),i=Si(rB),y=Si(nB),x=Si(ble),w=Si(iBe),C=w==null?void 0:w.active;L.useEffect(()=>{if(!C&&y!=null&&i!=null){var P=Lj({active:l,coordinate:n,dataKey:h,index:a,label:typeof r=="number"?String(r):r});n5.emit(jj,y,P,i)}},[C,n,h,a,r,i,y,x,l])}function dZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function hZ(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?dZ(Object(n),!0).forEach(function(r){vBe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function vBe(e,t,n){return(t=_Be(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _Be(e){var t=xBe(e,"string");return typeof t=="symbol"?t:t+""}function xBe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bBe(e){return e.dataKey}function wBe(e,t){return L.isValidElement(e)?L.cloneElement(e,t):typeof e=="function"?L.createElement(e,t):L.createElement(JDe,t)}var fZ=[],SBe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!xy.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function ABe(e){var t=rc(e,SBe),{active:n,allowEscapeViewBox:r,animationDuration:a,animationEasing:l,content:h,filterNull:i,isAnimationActive:y,offset:x,payloadUniqBy:w,position:C,reverseDirection:P,useTranslate3d:E,wrapperStyle:j,cursor:D,shared:B,trigger:F,defaultIndex:$,portal:H,axisId:J}=t,ee=Al(),Q=typeof $=="number"?String($):$;L.useEffect(()=>{ee(W6e({shared:B,trigger:F,axisId:J,active:n,defaultIndex:Q}))},[ee,B,F,J,n,Q]);var ne=Pz(),pe=hoe(),he=V6e(B),{activeIndex:we,isActive:fe}=Si(vt=>Gze(vt,he,F,Q)),ge=Si(vt=>qze(vt,he,F,Q)),Ce=Si(vt=>Ece(vt,he,F,Q)),xe=Si(vt=>$ze(vt,he,F,Q)),Re=ge,Qe=Jze(),et=n??fe,[je,De]=c4e([Re,et]),Ct=he==="axis"?Ce:void 0;yBe(he,F,xe,Ct,we,et);var xt=H??Qe;if(xt==null)return null;var me=Re??fZ;et||(me=fZ),i&&me.length&&(me=PLe(Re.filter(vt=>vt.value!=null&&(vt.hide!==!0||t.includeHidden)),w,bBe));var Ye=me.length>0,nt=L.createElement(sRe,{allowEscapeViewBox:r,animationDuration:a,animationEasing:l,isAnimationActive:y,active:et,coordinate:xe,hasPayload:Ye,offset:x,position:C,reverseDirection:P,useTranslate3d:E,viewBox:ne,wrapperStyle:j,lastBoundingBox:je,innerRef:De,hasPortalFromProps:!!H},wBe(h,hZ(hZ({},t),{},{payload:me,label:Ct,active:et,coordinate:xe,accessibilityLayer:pe})));return L.createElement(L.Fragment,null,Sv.createPortal(nt,xt),et&&L.createElement(Xze,{cursor:D,tooltipEventType:he,coordinate:xe,payload:Re,index:we}))}var Lce={},Dce={},Rce={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,r,{signal:a,edges:l}={}){let h,i=null;const y=l!=null&&l.includes("leading"),x=l==null||l.includes("trailing"),w=()=>{i!==null&&(n.apply(h,i),h=void 0,i=null)},C=()=>{x&&w(),D()};let P=null;const E=()=>{P!=null&&clearTimeout(P),P=setTimeout(()=>{P=null,C()},r)},j=()=>{P!==null&&(clearTimeout(P),P=null)},D=()=>{j(),h=void 0,i=null},B=()=>{w()},F=function(...$){if(a!=null&&a.aborted)return;h=this,i=$;const H=P==null;E(),y&&H&&w()};return F.schedule=E,F.cancel=D,F.flush=B,a==null||a.addEventListener("abort",D,{once:!0}),F}e.debounce=t})(Rce);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Rce;function n(r,a=0,l={}){typeof l!="object"&&(l={});const{leading:h=!1,trailing:i=!0,maxWait:y}=l,x=Array(2);h&&(x[0]="leading"),i&&(x[1]="trailing");let w,C=null;const P=t.debounce(function(...D){w=r.apply(this,D),C=null},a,{edges:x}),E=function(...D){return y!=null&&(C===null&&(C=Date.now()),Date.now()-C>=y)?(w=r.apply(this,D),C=Date.now(),P.cancel(),P.schedule(),w):(P.apply(this,D),w)},j=()=>(P.flush(),w);return E.cancel=P.cancel,E.flush=j,E}e.debounce=n})(Dce);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Dce;function n(r,a=0,l={}){const{leading:h=!0,trailing:i=!0}=l;return t.debounce(r,a,{leading:h,maxWait:a,trailing:i})}e.throttle=n})(Lce);var TBe=Lce.throttle;const CBe=Ip(TBe);var nA=function(t,n){for(var r=arguments.length,a=new Array(r>2?r-2:0),l=2;l<r;l++)a[l-2]=arguments[l]};function pZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function _4(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pZ(Object(n),!0).forEach(function(r){EBe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function EBe(e,t,n){return(t=PBe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PBe(e){var t=kBe(e,"string");return typeof t=="symbol"?t:t+""}function kBe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jce=L.forwardRef((e,t)=>{var{aspect:n,initialDimension:r={width:-1,height:-1},width:a="100%",height:l="100%",minWidth:h=0,minHeight:i,maxHeight:y,children:x,debounce:w=0,id:C,className:P,onResize:E,style:j={}}=e,D=L.useRef(null),B=L.useRef();B.current=E,L.useImperativeHandle(t,()=>D.current);var[F,$]=L.useState({containerWidth:r.width,containerHeight:r.height}),H=L.useCallback((ee,Q)=>{$(ne=>{var pe=Math.round(ee),he=Math.round(Q);return ne.containerWidth===pe&&ne.containerHeight===he?ne:{containerWidth:pe,containerHeight:he}})},[]);L.useEffect(()=>{var ee=he=>{var we,{width:fe,height:ge}=he[0].contentRect;H(fe,ge),(we=B.current)===null||we===void 0||we.call(B,fe,ge)};w>0&&(ee=CBe(ee,w,{trailing:!0,leading:!1}));var Q=new ResizeObserver(ee),{width:ne,height:pe}=D.current.getBoundingClientRect();return H(ne,pe),Q.observe(D.current),()=>{Q.disconnect()}},[H,w]);var J=L.useMemo(()=>{var{containerWidth:ee,containerHeight:Q}=F;if(ee<0||Q<0)return null;nA(M_(a)||M_(l),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,a,l),nA(!n||n>0,"The aspect(%s) must be greater than zero.",n);var ne=M_(a)?ee:a,pe=M_(l)?Q:l;return n&&n>0&&(ne?pe=ne/n:pe&&(ne=pe*n),y&&pe>y&&(pe=y)),nA(ne>0||pe>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,ne,pe,a,l,h,i,n),L.Children.map(x,he=>L.cloneElement(he,{width:ne,height:pe,style:_4({width:ne,height:pe},he.props.style)}))},[n,x,l,y,i,h,F,a]);return L.createElement("div",{id:C?"".concat(C):void 0,className:ra("recharts-responsive-container",P),style:_4(_4({},j),{},{width:a,height:l,minWidth:h,minHeight:i,maxHeight:y}),ref:D},L.createElement("div",{style:{width:0,height:0,overflow:"visible"}},J))}),Kg=e=>null;Kg.displayName="Cell";function IBe(e,t,n){return(t=NBe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function NBe(e){var t=MBe(e,"string");return typeof t=="symbol"?t:t+""}function MBe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class LBe{constructor(t){IBe(this,"cache",new Map),this.maxSize=t}get(t){var n=this.cache.get(t);return n!==void 0&&(this.cache.delete(t),this.cache.set(t,n)),n}set(t,n){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(t,n)}clear(){this.cache.clear()}size(){return this.cache.size}}function mZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function DBe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?mZ(Object(n),!0).forEach(function(r){RBe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function RBe(e,t,n){return(t=jBe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jBe(e){var t=OBe(e,"string");return typeof t=="symbol"?t:t+""}function OBe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FBe={cacheSize:2e3,enableCache:!0},Oce=DBe({},FBe),gZ=new LBe(Oce.cacheSize),zBe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},yZ="recharts_measurement_span";function BBe(e,t){var n=t.fontSize||"",r=t.fontFamily||"",a=t.fontWeight||"",l=t.fontStyle||"",h=t.letterSpacing||"",i=t.textTransform||"";return"".concat(e,"|").concat(n,"|").concat(r,"|").concat(a,"|").concat(l,"|").concat(h,"|").concat(i)}var vZ=(e,t)=>{try{var n=document.getElementById(yZ);n||(n=document.createElement("span"),n.setAttribute("id",yZ),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,zBe,t),n.textContent="".concat(e);var r=n.getBoundingClientRect();return{width:r.width,height:r.height}}catch{return{width:0,height:0}}},rA=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||xy.isSsr)return{width:0,height:0};if(!Oce.enableCache)return vZ(t,n);var r=BBe(t,n),a=gZ.get(r);if(a)return a;var l=vZ(t,n);return gZ.set(r,l),l},_Z=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,xZ=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,UBe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,VBe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Fce={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},$Be=Object.keys(Fce),sb="NaN";function qBe(e,t){return e*Fce[t]}class jd{static parse(t){var n,[,r,a]=(n=VBe.exec(t))!==null&&n!==void 0?n:[];return new jd(parseFloat(r),a??"")}constructor(t,n){this.num=t,this.unit=n,this.num=t,this.unit=n,Zd(t)&&(this.unit=""),n!==""&&!UBe.test(n)&&(this.num=NaN,this.unit=""),$Be.includes(n)&&(this.num=qBe(t,n),this.unit="px")}add(t){return this.unit!==t.unit?new jd(NaN,""):new jd(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new jd(NaN,""):new jd(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new jd(NaN,""):new jd(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new jd(NaN,""):new jd(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Zd(this.num)}}function zce(e){if(e.includes(sb))return sb;for(var t=e;t.includes("*")||t.includes("/");){var n,[,r,a,l]=(n=_Z.exec(t))!==null&&n!==void 0?n:[],h=jd.parse(r??""),i=jd.parse(l??""),y=a==="*"?h.multiply(i):h.divide(i);if(y.isNaN())return sb;t=t.replace(_Z,y.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var x,[,w,C,P]=(x=xZ.exec(t))!==null&&x!==void 0?x:[],E=jd.parse(w??""),j=jd.parse(P??""),D=C==="+"?E.add(j):E.subtract(j);if(D.isNaN())return sb;t=t.replace(xZ,D.toString())}return t}var bZ=/\(([^()]*)\)/;function GBe(e){for(var t=e,n;(n=bZ.exec(t))!=null;){var[,r]=n;t=t.replace(bZ,zce(r))}return t}function HBe(e){var t=e.replace(/\s+/g,"");return t=GBe(t),t=zce(t),t}function WBe(e){try{return HBe(e)}catch{return sb}}function x4(e){var t=WBe(e.slice(5,-1));return t===sb?"":t}var ZBe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],KBe=["dx","dy","angle","className","breakAll"];function Oj(){return Oj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Oj.apply(null,arguments)}function wZ(e,t){if(e==null)return{};var n,r,a=YBe(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function YBe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var Bce=/[ \f\n\r\t\v\u2028\u2029]+/,Uce=e=>{var{children:t,breakAll:n,style:r}=e;try{var a=[];Co(t)||(n?a=t.toString().split(""):a=t.toString().split(Bce));var l=a.map(i=>({word:i,width:rA(i,r).width})),h=n?0:rA("",r).width;return{wordsWithComputedWidth:l,spaceWidth:h}}catch{return null}},XBe=(e,t,n,r,a)=>{var{maxLines:l,children:h,style:i,breakAll:y}=e,x=wi(l),w=h,C=function(){var fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return fe.reduce((ge,Ce)=>{var{word:xe,width:Re}=Ce,Qe=ge[ge.length-1];if(Qe&&(r==null||a||Qe.width+Re+n<Number(r)))Qe.words.push(xe),Qe.width+=Re+n;else{var et={words:[xe],width:Re};ge.push(et)}return ge},[])},P=C(t),E=we=>we.reduce((fe,ge)=>fe.width>ge.width?fe:ge);if(!x||a)return P;var j=P.length>l||E(P).width>Number(r);if(!j)return P;for(var D="",B=we=>{var fe=w.slice(0,we),ge=Uce({breakAll:y,style:i,children:fe+D}).wordsWithComputedWidth,Ce=C(ge),xe=Ce.length>l||E(Ce).width>Number(r);return[xe,Ce]},F=0,$=w.length-1,H=0,J;F<=$&&H<=w.length-1;){var ee=Math.floor((F+$)/2),Q=ee-1,[ne,pe]=B(Q),[he]=B(ee);if(!ne&&!he&&(F=ee+1),ne&&he&&($=ee-1),!ne&&he){J=pe;break}H++}return J||P},SZ=e=>{var t=Co(e)?[]:e.toString().split(Bce);return[{words:t}]},JBe=e=>{var{width:t,scaleToFit:n,children:r,style:a,breakAll:l,maxLines:h}=e;if((t||n)&&!xy.isSsr){var i,y,x=Uce({breakAll:l,children:r,style:a});if(x){var{wordsWithComputedWidth:w,spaceWidth:C}=x;i=w,y=C}else return SZ(r);return XBe({breakAll:l,children:r,maxLines:h,style:a},i,y,t,n)}return SZ(r)},AZ="#808080",rN=L.forwardRef((e,t)=>{var{x:n=0,y:r=0,lineHeight:a="1em",capHeight:l="0.71em",scaleToFit:h=!1,textAnchor:i="start",verticalAnchor:y="end",fill:x=AZ}=e,w=wZ(e,ZBe),C=L.useMemo(()=>JBe({breakAll:w.breakAll,children:w.children,maxLines:w.maxLines,scaleToFit:h,style:w.style,width:w.width}),[w.breakAll,w.children,w.maxLines,h,w.style,w.width]),{dx:P,dy:E,angle:j,className:D,breakAll:B}=w,F=wZ(w,KBe);if(!Gm(n)||!Gm(r)||C.length===0)return null;var $=n+(wi(P)?P:0),H=r+(wi(E)?E:0),J;switch(y){case"start":J=x4("calc(".concat(l,")"));break;case"middle":J=x4("calc(".concat((C.length-1)/2," * -").concat(a," + (").concat(l," / 2))"));break;default:J=x4("calc(".concat(C.length-1," * -").concat(a,")"));break}var ee=[];if(h){var Q=C[0].width,{width:ne}=w;ee.push("scale(".concat(wi(ne)?ne/Q:1,")"))}return j&&ee.push("rotate(".concat(j,", ").concat($,", ").concat(H,")")),ee.length&&(F.transform=ee.join(" ")),L.createElement("text",Oj({},Eo(F,!0),{ref:t,x:$,y:H,className:ra("recharts-text",D),textAnchor:i,fill:x.includes("url")?AZ:x}),C.map((pe,he)=>{var we=pe.words.join(B?"":" ");return L.createElement("tspan",{x:$,dy:he===0?J:a,key:"".concat(we,"-").concat(he)},we)}))});rN.displayName="Text";var QBe=["labelRef"];function e8e(e,t){if(e==null)return{};var n,r,a=t8e(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function t8e(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function TZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function gl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?TZ(Object(n),!0).forEach(function(r){n8e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function n8e(e,t,n){return(t=r8e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r8e(e){var t=i8e(e,"string");return typeof t=="symbol"?t:t+""}function i8e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zg(){return zg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zg.apply(null,arguments)}var Vce=L.createContext(null),s8e=e=>{var{x:t,y:n,width:r,height:a,children:l}=e,h=L.useMemo(()=>({x:t,y:n,width:r,height:a}),[t,n,r,a]);return L.createElement(Vce.Provider,{value:h},l)},$ce=()=>{var e=L.useContext(Vce),t=Pz();return e||t},a8e=L.createContext(null),o8e=()=>{var e=L.useContext(a8e),t=Si(Cle);return e||t},l8e=e=>{var{value:t,formatter:n}=e,r=Co(e.children)?t:e.children;return typeof n=="function"?n(r):r},LB=e=>e!=null&&typeof e=="function",c8e=(e,t)=>{var n=Ec(t-e),r=Math.min(Math.abs(t-e),360);return n*r},u8e=(e,t,n,r,a)=>{var{offset:l,className:h}=e,{cx:i,cy:y,innerRadius:x,outerRadius:w,startAngle:C,endAngle:P,clockWise:E}=a,j=(x+w)/2,D=c8e(C,P),B=D>=0?1:-1,F,$;switch(t){case"insideStart":F=C+B*l,$=E;break;case"insideEnd":F=P-B*l,$=!E;break;case"end":F=P+B*l,$=E;break;default:throw new Error("Unsupported position ".concat(t))}$=D<=0?$:!$;var H=Bl(i,y,j,F),J=Bl(i,y,j,F+($?1:-1)*359),ee="M".concat(H.x,",").concat(H.y,`
    A`).concat(j,",").concat(j,",0,1,").concat($?0:1,`,
    `).concat(J.x,",").concat(J.y),Q=Co(e.id)?HA("recharts-radial-line-"):e.id;return L.createElement("text",zg({},r,{dominantBaseline:"central",className:ra("recharts-radial-bar-label",h)}),L.createElement("defs",null,L.createElement("path",{id:Q,d:ee})),L.createElement("textPath",{xlinkHref:"#".concat(Q)},n))},d8e=(e,t,n)=>{var{cx:r,cy:a,innerRadius:l,outerRadius:h,startAngle:i,endAngle:y}=e,x=(i+y)/2;if(n==="outside"){var{x:w,y:C}=Bl(r,a,h+t,x);return{x:w,y:C,textAnchor:w>=r?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:r,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:r,y:a,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:r,y:a,textAnchor:"middle",verticalAnchor:"end"};var P=(l+h)/2,{x:E,y:j}=Bl(r,a,P,x);return{x:E,y:j,textAnchor:"middle",verticalAnchor:"middle"}},qce=e=>"cx"in e&&wi(e.cx),h8e=(e,t)=>{var{parentViewBox:n,offset:r,position:a}=e,l;n!=null&&!qce(n)&&(l=n);var{x:h,y:i,width:y,height:x}=t,w=x>=0?1:-1,C=w*r,P=w>0?"end":"start",E=w>0?"start":"end",j=y>=0?1:-1,D=j*r,B=j>0?"end":"start",F=j>0?"start":"end";if(a==="top"){var $={x:h+y/2,y:i-w*r,textAnchor:"middle",verticalAnchor:P};return gl(gl({},$),l?{height:Math.max(i-l.y,0),width:y}:{})}if(a==="bottom"){var H={x:h+y/2,y:i+x+C,textAnchor:"middle",verticalAnchor:E};return gl(gl({},H),l?{height:Math.max(l.y+l.height-(i+x),0),width:y}:{})}if(a==="left"){var J={x:h-D,y:i+x/2,textAnchor:B,verticalAnchor:"middle"};return gl(gl({},J),l?{width:Math.max(J.x-l.x,0),height:x}:{})}if(a==="right"){var ee={x:h+y+D,y:i+x/2,textAnchor:F,verticalAnchor:"middle"};return gl(gl({},ee),l?{width:Math.max(l.x+l.width-ee.x,0),height:x}:{})}var Q=l?{width:y,height:x}:{};return a==="insideLeft"?gl({x:h+D,y:i+x/2,textAnchor:F,verticalAnchor:"middle"},Q):a==="insideRight"?gl({x:h+y-D,y:i+x/2,textAnchor:B,verticalAnchor:"middle"},Q):a==="insideTop"?gl({x:h+y/2,y:i+C,textAnchor:"middle",verticalAnchor:E},Q):a==="insideBottom"?gl({x:h+y/2,y:i+x-C,textAnchor:"middle",verticalAnchor:P},Q):a==="insideTopLeft"?gl({x:h+D,y:i+C,textAnchor:F,verticalAnchor:E},Q):a==="insideTopRight"?gl({x:h+y-D,y:i+C,textAnchor:B,verticalAnchor:E},Q):a==="insideBottomLeft"?gl({x:h+D,y:i+x-C,textAnchor:F,verticalAnchor:P},Q):a==="insideBottomRight"?gl({x:h+y-D,y:i+x-C,textAnchor:B,verticalAnchor:P},Q):a&&typeof a=="object"&&(wi(a.x)||M_(a.x))&&(wi(a.y)||M_(a.y))?gl({x:h+Cu(a.x,y),y:i+Cu(a.y,x),textAnchor:"end",verticalAnchor:"end"},Q):gl({x:h+y/2,y:i+x/2,textAnchor:"middle",verticalAnchor:"middle"},Q)},f8e={offset:5};function b0(e){var t=rc(e,f8e),{viewBox:n,position:r,value:a,children:l,content:h,className:i="",textBreakAll:y,labelRef:x}=t,w=o8e(),C=$ce(),P=r==="center"?C:w??C,E=n||P;if(!E||Co(a)&&Co(l)&&!L.isValidElement(h)&&typeof h!="function")return null;var j=gl(gl({},t),{},{viewBox:E});if(L.isValidElement(h)){var D=e8e(j,QBe);return L.cloneElement(h,D)}var B;if(typeof h=="function"){if(B=L.createElement(h,j),L.isValidElement(B))return B}else B=l8e(t);var F=qce(E),$=Eo(t,!0);if(F&&(r==="insideStart"||r==="insideEnd"||r==="end"))return u8e(t,r,B,$,E);var H=F?d8e(E,t.offset,t.position):h8e(t,E);return L.createElement(rN,zg({ref:x,className:ra("recharts-label",i)},$,H,{breakAll:y}),B)}b0.displayName="Label";var p8e=(e,t,n)=>{if(!e)return null;var r={viewBox:t,labelRef:n};return e===!0?L.createElement(b0,zg({key:"label-implicit"},r)):Gm(e)?L.createElement(b0,zg({key:"label-implicit",value:e},r)):L.isValidElement(e)?e.type===b0?L.cloneElement(e,gl({key:"label-implicit"},r)):L.createElement(b0,zg({key:"label-implicit",content:e},r)):LB(e)?L.createElement(b0,zg({key:"label-implicit",content:e},r)):e&&typeof e=="object"?L.createElement(b0,zg({},e,{key:"label-implicit"},r)):null};function m8e(e){var{label:t}=e,n=$ce();return p8e(t,n)||null}var Gce={},Hce={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n[n.length-1]}e.last=t})(Hce);var Wce={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Array.isArray(n)?n:Array.from(n)}e.toArray=t})(Wce);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Hce,n=Wce,r=kI;function a(l){if(r.isArrayLike(l))return t.last(n.toArray(l))}e.last=a})(Gce);var g8e=Gce.last;const y8e=Ip(g8e);var v8e=["valueAccessor"],_8e=["dataKey","clockWise","id","textBreakAll"];function Wk(){return Wk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Wk.apply(null,arguments)}function CZ(e,t){if(e==null)return{};var n,r,a=x8e(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function x8e(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var b8e=e=>Array.isArray(e.value)?y8e(e.value):e.value,Zce=L.createContext(void 0),DB=Zce.Provider,Kce=L.createContext(void 0),w8e=Kce.Provider;function S8e(){return L.useContext(Zce)}function A8e(){return L.useContext(Kce)}function sP(e){var{valueAccessor:t=b8e}=e,n=CZ(e,v8e),{dataKey:r,clockWise:a,id:l,textBreakAll:h}=n,i=CZ(n,_8e),y=S8e(),x=A8e(),w=y||x;return!w||!w.length?null:L.createElement(ul,{className:"recharts-label-list"},w.map((C,P)=>{var E,j=Co(r)?t(C,P):qa(C&&C.payload,r),D=Co(l)?{}:{id:"".concat(l,"-").concat(P)};return L.createElement(b0,Wk({},Eo(C,!0),i,D,{fill:(E=n.fill)!==null&&E!==void 0?E:C.fill,parentViewBox:C.parentViewBox,value:j,textBreakAll:h,viewBox:C.viewBox,key:"label-".concat(P),index:P}))}))}sP.displayName="LabelList";function iN(e){var{label:t}=e;return t?t===!0?L.createElement(sP,{key:"labelList-implicit"}):L.isValidElement(t)||LB(t)?L.createElement(sP,{key:"labelList-implicit",content:t}):typeof t=="object"?L.createElement(sP,Wk({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function Fj(){return Fj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fj.apply(null,arguments)}var RB=e=>{var{cx:t,cy:n,r,className:a}=e,l=ra("recharts-dot",a);return t===+t&&n===+n&&r===+r?L.createElement("circle",Fj({},If(e),sz(e),{className:l,cx:t,cy:n,r})):null},Yce=e=>e.graphicalItems.polarItems,T8e=_n([Uo,eT],lB),jB=_n([Yce,Tl,T8e],cB),C8e=_n([jB],uB),OB=_n([C8e,Jz],dB),E8e=_n([OB,Tl,jB],fB),P8e=_n([OB,Tl,jB],(e,t,n)=>n.length>0?e.flatMap(r=>n.flatMap(a=>{var l,h=qa(r,(l=t.dataKey)!==null&&l!==void 0?l:a.dataKey);return{value:h,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(r=>({value:qa(r,t.dataKey),errorDomain:[]})):e.map(r=>({value:r,errorDomain:[]}))),EZ=()=>{},k8e=_n([Tl,Hle,EZ,P8e,EZ,Hs,Uo],mB),Xce=_n([Tl,Hs,OB,E8e,Q5,Uo,k8e],gB),I8e=_n([Xce,Tl,Uw],_B);_n([Tl,Xce,I8e,Uo],bB);var N8e={radiusAxis:{},angleAxis:{}},M8e=Dh({name:"polarAxis",initialState:N8e,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),L8e=M8e.reducer;function PZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function kZ(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?PZ(Object(n),!0).forEach(function(r){D8e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function D8e(e,t,n){return(t=R8e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R8e(e){var t=j8e(e,"string");return typeof t=="symbol"?t:t+""}function j8e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var O8e=(e,t)=>t,FB=_n([Yce,O8e],(e,t)=>e.filter(n=>n.type==="pie").find(n=>n.id===t)),F8e=[],zB=(e,t,n)=>(n==null?void 0:n.length)===0?F8e:n,Jce=_n([Jz,FB,zB],(e,t,n)=>{var{chartData:r}=e;if(t!=null){var a;if((t==null?void 0:t.data)!=null&&t.data.length>0?a=t.data:a=r,(!a||!a.length)&&n!=null&&(a=n.map(l=>kZ(kZ({},t.presentationProps),l.props))),a!=null)return a}}),z8e=_n([Jce,FB,zB],(e,t,n)=>{if(!(e==null||t==null))return e.map((r,a)=>{var l,h=qa(r,t.nameKey,t.name),i;return n!=null&&(l=n[a])!==null&&l!==void 0&&(l=l.props)!==null&&l!==void 0&&l.fill?i=n[a].props.fill:typeof r=="object"&&r!=null&&"fill"in r?i=r.fill:i=t.fill,{value:kv(h,t.dataKey),color:i,payload:r,type:t.legendType}})}),B8e=_n([Jce,FB,zB,nc],(e,t,n,r)=>{if(!(t==null||e==null))return R7e({offset:r,pieSettings:t,displayedData:e,cells:n})}),Qce={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){var a;if(typeof n!="object"||n==null)return!1;if(Object.getPrototypeOf(n)===null)return!0;if(Object.prototype.toString.call(n)!=="[object Object]"){const l=n[Symbol.toStringTag];return l==null||!((a=Object.getOwnPropertyDescriptor(n,Symbol.toStringTag))!=null&&a.writable)?!1:n.toString()===`[object ${l}]`}let r=n;for(;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(n)===r}e.isPlainObject=t})(Qce);var U8e=Qce.isPlainObject;const V8e=Ip(U8e);function IZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function NZ(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?IZ(Object(n),!0).forEach(function(r){$8e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function $8e(e,t,n){return(t=q8e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function q8e(e){var t=G8e(e,"string");return typeof t=="symbol"?t:t+""}function G8e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zk(){return Zk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zk.apply(null,arguments)}var MZ=(e,t,n,r,a)=>{var l=n-r,h;return h="M ".concat(e,",").concat(t),h+="L ".concat(e+n,",").concat(t),h+="L ".concat(e+n-l/2,",").concat(t+a),h+="L ".concat(e+n-l/2-r,",").concat(t+a),h+="L ".concat(e,",").concat(t," Z"),h},H8e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},W8e=e=>{var t=rc(e,H8e),{x:n,y:r,upperWidth:a,lowerWidth:l,height:h,className:i}=t,{animationEasing:y,animationDuration:x,animationBegin:w,isUpdateAnimationActive:C}=t,P=L.useRef(),[E,j]=L.useState(-1),D=L.useRef(a),B=L.useRef(l),F=L.useRef(h),$=L.useRef(n),H=L.useRef(r),J=Rw(e,"trapezoid-");if(L.useEffect(()=>{if(P.current&&P.current.getTotalLength)try{var xe=P.current.getTotalLength();xe&&j(xe)}catch{}},[]),n!==+n||r!==+r||a!==+a||l!==+l||h!==+h||a===0&&l===0||h===0)return null;var ee=ra("recharts-trapezoid",i);if(!C)return L.createElement("g",null,L.createElement("path",Zk({},Eo(t,!0),{className:ee,d:MZ(n,r,a,l,h)})));var Q=D.current,ne=B.current,pe=F.current,he=$.current,we=H.current,fe="0px ".concat(E===-1?1:E,"px"),ge="".concat(E,"px 0px"),Ce=foe(["strokeDasharray"],x,y);return L.createElement(Dw,{animationId:J,key:J,canBegin:E>0,duration:x,easing:y,isActive:C,begin:w},xe=>{var Re=$a(Q,a,xe),Qe=$a(ne,l,xe),et=$a(pe,h,xe),je=$a(he,n,xe),De=$a(we,r,xe);P.current&&(D.current=Re,B.current=Qe,F.current=et,$.current=je,H.current=De);var Ct=xe>0?{transition:Ce,strokeDasharray:ge}:{strokeDasharray:fe};return L.createElement("path",Zk({},Eo(t,!0),{className:ee,d:MZ(je,De,Re,Qe,et),ref:P,style:NZ(NZ({},Ct),t.style)}))})},Z8e=["option","shapeType","propTransformer","activeClassName","isActive"];function K8e(e,t){if(e==null)return{};var n,r,a=Y8e(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Y8e(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function LZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Kk(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?LZ(Object(n),!0).forEach(function(r){X8e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):LZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function X8e(e,t,n){return(t=J8e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J8e(e){var t=Q8e(e,"string");return typeof t=="symbol"?t:t+""}function Q8e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function e7e(e,t){return Kk(Kk({},t),e)}function t7e(e,t){return e==="symbols"}function DZ(e){var{shapeType:t,elementProps:n}=e;switch(t){case"rectangle":return L.createElement(yoe,n);case"trapezoid":return L.createElement(W8e,n);case"sector":return L.createElement(xoe,n);case"symbols":if(t7e(t))return L.createElement(Qse,n);break;default:return null}}function n7e(e){return L.isValidElement(e)?e.props:e}function eue(e){var{option:t,shapeType:n,propTransformer:r=e7e,activeClassName:a="recharts-active-shape",isActive:l}=e,h=K8e(e,Z8e),i;if(L.isValidElement(t))i=L.cloneElement(t,Kk(Kk({},h),n7e(t)));else if(typeof t=="function")i=t(h);else if(V8e(t)&&typeof t!="boolean"){var y=r(t,h);i=L.createElement(DZ,{shapeType:n,elementProps:y})}else{var x=h;i=L.createElement(DZ,{shapeType:n,elementProps:x})}return l?L.createElement(ul,{className:a},i):i}var BB=(e,t)=>{var n=Al();return(r,a)=>l=>{e==null||e(r,a,l),n(lce({activeIndex:String(a),activeDataKey:t,activeCoordinate:r.tooltipPosition}))}},UB=e=>{var t=Al();return(n,r)=>a=>{e==null||e(n,r,a),t(Z6e())}},VB=(e,t)=>{var n=Al();return(r,a)=>l=>{e==null||e(r,a,l),n(K6e({activeIndex:String(a),activeDataKey:t,activeCoordinate:r.tooltipPosition}))}};function sN(e){var{fn:t,args:n}=e,r=Al(),a=Pu();return L.useEffect(()=>{if(!a){var l=t(n);return r(G6e(l)),()=>{r(H6e(l))}}},[t,n,r,a]),null}var tue=()=>{};function $B(e){var{legendPayload:t}=e,n=Al(),r=Pu();return L.useEffect(()=>r?tue:(n(uoe(t)),()=>{n(doe(t))}),[n,r,t]),null}function r7e(e){var{legendPayload:t}=e,n=Al(),r=Si(Hs);return L.useEffect(()=>r!=="centric"&&r!=="radial"?tue:(n(uoe(t)),()=>{n(doe(t))}),[n,r,t]),null}var b4,i7e=()=>{var[e]=L.useState(()=>HA("uid-"));return e},s7e=(b4=f3.useId)!==null&&b4!==void 0?b4:i7e;function a7e(e,t){var n=s7e();return t||(e?"".concat(e,"-").concat(n):n)}var o7e=L.createContext(void 0),aN=e=>{var{id:t,type:n,children:r}=e,a=a7e("recharts-".concat(n),t);return L.createElement(o7e.Provider,{value:a},r(a))},l7e={cartesianItems:[],polarItems:[]},nue=Dh({name:"graphicalItems",initialState:l7e,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:n,next:r}=t.payload,a=Wg(e).cartesianItems.indexOf(n);a>-1&&(e.cartesianItems[a]=r)},removeCartesianGraphicalItem(e,t){var n=Wg(e).cartesianItems.indexOf(t.payload);n>-1&&e.cartesianItems.splice(n,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var n=Wg(e).polarItems.indexOf(t.payload);n>-1&&e.polarItems.splice(n,1)}}}),{addCartesianGraphicalItem:c7e,replaceCartesianGraphicalItem:u7e,removeCartesianGraphicalItem:d7e,addPolarGraphicalItem:h7e,removePolarGraphicalItem:f7e}=nue.actions,p7e=nue.reducer;function qB(e){var t=Al(),n=L.useRef(null);return L.useEffect(()=>{n.current===null?t(c7e(e)):n.current!==e&&t(u7e({prev:n.current,next:e})),n.current=e},[t,e]),L.useEffect(()=>()=>{n.current&&(t(d7e(n.current)),n.current=null)},[t]),null}function m7e(e){var t=Al();return L.useEffect(()=>(t(h7e(e)),()=>{t(f7e(e))}),[t,e]),null}var g7e=["onMouseEnter","onClick","onMouseLeave"],y7e=["id"],v7e=["id"];function GB(e,t){if(e==null)return{};var n,r,a=_7e(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function _7e(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function RZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Oo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?RZ(Object(n),!0).forEach(function(r){x7e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):RZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function x7e(e,t,n){return(t=b7e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b7e(e){var t=w7e(e,"string");return typeof t=="symbol"?t:t+""}function w7e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yv(){return yv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yv.apply(null,arguments)}function S7e(e){var t=L.useMemo(()=>az(e.children,Kg),[e.children]),n=Si(r=>z8e(r,e.id,t));return n==null?null:L.createElement(r7e,{legendPayload:n})}function A7e(e){var{dataKey:t,nameKey:n,sectors:r,stroke:a,strokeWidth:l,fill:h,name:i,hide:y,tooltipType:x}=e;return{dataDefinedOnItem:r.map(w=>w.tooltipPayload),positions:r.map(w=>w.tooltipPosition),settings:{stroke:a,strokeWidth:l,fill:h,dataKey:t,nameKey:n,name:kv(i,t),hide:y,type:x,color:h,unit:""}}}var T7e=(e,t)=>e>t?"start":e<t?"end":"middle",C7e=(e,t,n)=>Cu(typeof t=="function"?t(e):t,n,n*.8),E7e=(e,t,n)=>{var{top:r,left:a,width:l,height:h}=t,i=Jae(l,h),y=a+Cu(e.cx,l,l/2),x=r+Cu(e.cy,h,h/2),w=Cu(e.innerRadius,i,0),C=C7e(n,e.outerRadius,i),P=e.maxRadius||Math.sqrt(l*l+h*h)/2;return{cx:y,cy:x,innerRadius:w,outerRadius:C,maxRadius:P}},P7e=(e,t)=>{var n=Ec(t-e),r=Math.min(Math.abs(t-e),360);return n*r};function k7e(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var I7e=(e,t)=>{if(L.isValidElement(e))return L.cloneElement(e,t);if(typeof e=="function")return e(t);var n=ra("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return L.createElement(wb,yv({},t,{type:"linear",className:n}))},N7e=(e,t,n)=>{if(L.isValidElement(e))return L.cloneElement(e,t);var r=n;if(typeof e=="function"&&(r=e(t),L.isValidElement(r)))return r;var a=ra("recharts-pie-label-text",k7e(e));return L.createElement(rN,yv({},t,{alignmentBaseline:"middle",className:a}),r)};function M7e(e){var{sectors:t,props:n,showLabels:r}=e,{label:a,labelLine:l,dataKey:h}=n;if(!r||!a||!t)return null;var i=If(n),y=Eo(a,!1),x=Eo(l,!1),w=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,C=t.map((P,E)=>{var j=(P.startAngle+P.endAngle)/2,D=Bl(P.cx,P.cy,P.outerRadius+w,j),B=Oo(Oo(Oo(Oo({},i),P),{},{stroke:"none"},y),{},{index:E,textAnchor:T7e(D.x,P.cx)},D),F=Oo(Oo(Oo(Oo({},i),P),{},{fill:"none",stroke:P.fill},x),{},{index:E,points:[Bl(P.cx,P.cy,P.outerRadius,j),D],key:"line"});return L.createElement(ul,{key:"label-".concat(P.startAngle,"-").concat(P.endAngle,"-").concat(P.midAngle,"-").concat(E)},l&&I7e(l,F),N7e(a,B,qa(P,h)))});return L.createElement(ul,{className:"recharts-pie-labels"},C)}function L7e(e){var{sectors:t,props:n,showLabels:r}=e,{label:a}=n;return typeof a=="object"&&a!=null&&"position"in a?L.createElement(iN,{label:a}):L.createElement(M7e,{sectors:t,props:n,showLabels:r})}function D7e(e){var{sectors:t,activeShape:n,inactiveShape:r,allOtherPieProps:a}=e,l=Si(gv),{onMouseEnter:h,onClick:i,onMouseLeave:y}=a,x=GB(a,g7e),w=BB(h,a.dataKey),C=UB(y),P=VB(i,a.dataKey);return t==null||t.length===0?null:L.createElement(L.Fragment,null,t.map((E,j)=>{if((E==null?void 0:E.startAngle)===0&&(E==null?void 0:E.endAngle)===0&&t.length!==1)return null;var D=n&&String(j)===l,B=l?r:null,F=D?n:B,$=Oo(Oo({},E),{},{stroke:E.stroke,tabIndex:-1,[ioe]:j,[soe]:a.dataKey});return L.createElement(ul,yv({tabIndex:-1,className:"recharts-pie-sector"},AI(x,E,j),{onMouseEnter:w(E,j),onMouseLeave:C(E,j),onClick:P(E,j),key:"sector-".concat(E==null?void 0:E.startAngle,"-").concat(E==null?void 0:E.endAngle,"-").concat(E.midAngle,"-").concat(j)}),L.createElement(eue,yv({option:F,isActive:D,shapeType:"sector"},$)))}))}function R7e(e){var t,{pieSettings:n,displayedData:r,cells:a,offset:l}=e,{cornerRadius:h,startAngle:i,endAngle:y,dataKey:x,nameKey:w,tooltipType:C}=n,P=Math.abs(n.minAngle),E=P7e(i,y),j=Math.abs(E),D=r.length<=1?0:(t=n.paddingAngle)!==null&&t!==void 0?t:0,B=r.filter(Q=>qa(Q,x,0)!==0).length,F=(j>=360?B:B-1)*D,$=j-B*P-F,H=r.reduce((Q,ne)=>{var pe=qa(ne,x,0);return Q+(wi(pe)?pe:0)},0),J;if(H>0){var ee;J=r.map((Q,ne)=>{var pe=qa(Q,x,0),he=qa(Q,w,ne),we=E7e(n,l,Q),fe=(wi(pe)?pe:0)/H,ge,Ce=Oo(Oo({},Q),a&&a[ne]&&a[ne].props);ne?ge=ee.endAngle+Ec(E)*D*(pe!==0?1:0):ge=i;var xe=ge+Ec(E)*((pe!==0?P:0)+fe*$),Re=(ge+xe)/2,Qe=(we.innerRadius+we.outerRadius)/2,et=[{name:he,value:pe,payload:Ce,dataKey:x,type:C}],je=Bl(we.cx,we.cy,Qe,Re);return ee=Oo(Oo(Oo(Oo({},n.presentationProps),{},{percent:fe,cornerRadius:h,name:he,tooltipPayload:et,midAngle:Re,middleRadius:Qe,tooltipPosition:je},Ce),we),{},{value:pe,startAngle:ge,endAngle:xe,payload:Ce,paddingAngle:Ec(E)*D}),ee})}return J}function j7e(e){var{showLabels:t,sectors:n,children:r}=e,a=L.useMemo(()=>!t||!n?[]:n.map(l=>({value:l.value,payload:l.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:l.cx,cy:l.cy,innerRadius:l.innerRadius,outerRadius:l.outerRadius,startAngle:l.startAngle,endAngle:l.endAngle,clockWise:!1},fill:l.fill})),[n,t]);return L.createElement(w8e,{value:t?a:void 0},r)}function O7e(e){var{props:t,previousSectorsRef:n}=e,{sectors:r,isAnimationActive:a,animationBegin:l,animationDuration:h,animationEasing:i,activeShape:y,inactiveShape:x,onAnimationStart:w,onAnimationEnd:C}=t,P=Rw(t,"recharts-pie-"),E=n.current,[j,D]=L.useState(!1),B=L.useCallback(()=>{typeof C=="function"&&C(),D(!1)},[C]),F=L.useCallback(()=>{typeof w=="function"&&w(),D(!0)},[w]);return L.createElement(j7e,{showLabels:!j,sectors:r},L.createElement(Dw,{animationId:P,begin:l,duration:h,isActive:a,easing:i,onAnimationStart:F,onAnimationEnd:B,key:P},$=>{var H=[],J=r&&r[0],ee=J==null?void 0:J.startAngle;return r==null||r.forEach((Q,ne)=>{var pe=E&&E[ne],he=ne>0?mx(Q,"paddingAngle",0):0;if(pe){var we=$a(pe.endAngle-pe.startAngle,Q.endAngle-Q.startAngle,$),fe=Oo(Oo({},Q),{},{startAngle:ee+he,endAngle:ee+we+he});H.push(fe),ee=fe.endAngle}else{var{endAngle:ge,startAngle:Ce}=Q,xe=$a(0,ge-Ce,$),Re=Oo(Oo({},Q),{},{startAngle:ee+he,endAngle:ee+xe+he});H.push(Re),ee=Re.endAngle}}),n.current=H,L.createElement(ul,null,L.createElement(D7e,{sectors:H,activeShape:y,inactiveShape:x,allOtherPieProps:t}))}),L.createElement(L7e,{showLabels:!j,sectors:r,props:t}),t.children)}var F7e={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!xy.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function z7e(e){var{id:t}=e,n=GB(e,y7e),{hide:r,className:a,rootTabIndex:l}=e,h=L.useMemo(()=>az(e.children,Kg),[e.children]),i=Si(w=>B8e(w,t,h)),y=L.useRef(null),x=ra("recharts-pie",a);return r||i==null?(y.current=null,L.createElement(ul,{tabIndex:l,className:x})):L.createElement(L.Fragment,null,L.createElement(sN,{fn:A7e,args:Oo(Oo({},e),{},{sectors:i})}),L.createElement(ul,{tabIndex:l,className:x},L.createElement(O7e,{props:Oo(Oo({},n),{},{sectors:i}),previousSectorsRef:y})))}function HB(e){var t=rc(e,F7e),{id:n}=t,r=GB(t,v7e),a=If(r);return L.createElement(aN,{id:n,type:"pie"},l=>L.createElement(L.Fragment,null,L.createElement(m7e,{type:"pie",id:l,data:r.data,dataKey:r.dataKey,hide:r.hide,angleAxisId:0,radiusAxisId:0,name:r.name,nameKey:r.nameKey,tooltipType:r.tooltipType,legendType:r.legendType,fill:r.fill,cx:r.cx,cy:r.cy,startAngle:r.startAngle,endAngle:r.endAngle,paddingAngle:r.paddingAngle,minAngle:r.minAngle,innerRadius:r.innerRadius,outerRadius:r.outerRadius,cornerRadius:r.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),L.createElement(S7e,yv({},r,{id:l})),L.createElement(z7e,yv({},r,{id:l}))))}HB.displayName="Pie";function jZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function OZ(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jZ(Object(n),!0).forEach(function(r){B7e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function B7e(e,t,n){return(t=U7e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U7e(e){var t=V7e(e,"string");return typeof t=="symbol"?t:t+""}function V7e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $7e={xAxis:{},yAxis:{},zAxis:{}},rue=Dh({name:"cartesianAxis",initialState:$7e,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:n,width:r}=t.payload;e.yAxis[n]&&(e.yAxis[n]=OZ(OZ({},e.yAxis[n]),{},{width:r}))}}}),{addXAxis:q7e,removeXAxis:G7e,addYAxis:H7e,removeYAxis:W7e,addZAxis:GXe,removeZAxis:HXe,updateYAxisWidth:Z7e}=rue.actions,K7e=rue.reducer,Y7e=_n([nc],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),X7e=_n([Y7e,vy,_y],(e,t,n)=>{if(!(!e||t==null||n==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,n-e.top-e.bottom)}}),oN=()=>Si(X7e),J7e=()=>Si(Rze);function FZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function zZ(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?FZ(Object(n),!0).forEach(function(r){Q7e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Q7e(e,t,n){return(t=eUe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eUe(e){var t=tUe(e,"string");return typeof t=="symbol"?t:t+""}function tUe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nUe=e=>{var{point:t,childIndex:n,mainColor:r,activeDot:a,dataKey:l}=e;if(a===!1||t.x==null||t.y==null)return null;var h=zZ(zZ({index:n,dataKey:l,cx:t.x,cy:t.y,r:4,fill:r??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},Eo(a,!1)),sz(a)),i;return L.isValidElement(a)?i=L.cloneElement(a,h):typeof a=="function"?i=a(h):i=L.createElement(RB,h),L.createElement(ul,{className:"recharts-active-dot"},i)};function zj(e){var{points:t,mainColor:n,activeDot:r,itemDataKey:a}=e,l=Si(gv),h=J7e();if(t==null||h==null)return null;var i=t.find(y=>h.includes(y.payload));return Co(i)?null:nUe({point:i,childIndex:Number(l),mainColor:n,dataKey:a,activeDot:r})}var rUe="Invariant failed";function iUe(e,t){throw new Error(rUe)}var sUe=["x","y"];function Bj(){return Bj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bj.apply(null,arguments)}function BZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function _S(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?BZ(Object(n),!0).forEach(function(r){aUe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):BZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function aUe(e,t,n){return(t=oUe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oUe(e){var t=lUe(e,"string");return typeof t=="symbol"?t:t+""}function lUe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cUe(e,t){if(e==null)return{};var n,r,a=uUe(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function uUe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function dUe(e,t){var{x:n,y:r}=e,a=cUe(e,sUe),l="".concat(n),h=parseInt(l,10),i="".concat(r),y=parseInt(i,10),x="".concat(t.height||a.height),w=parseInt(x,10),C="".concat(t.width||a.width),P=parseInt(C,10);return _S(_S(_S(_S(_S({},t),a),h?{x:h}:{}),y?{y}:{}),{},{height:w,width:P,name:t.name,radius:t.radius})}function WB(e){return L.createElement(eue,Bj({shapeType:"rectangle",propTransformer:dUe,activeClassName:"recharts-active-bar"},e))}var hUe=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(r,a)=>{if(wi(t))return t;var l=wi(r)||Co(r);return l?t(r,a):(l||iUe(),n)}},fUe={},pUe=Dh({name:"errorBars",initialState:fUe,reducers:{addErrorBar:(e,t)=>{var{itemId:n,errorBar:r}=t.payload;e[n]||(e[n]=[]),e[n].push(r)},replaceErrorBar:(e,t)=>{var{itemId:n,prev:r,next:a}=t.payload;e[n]&&(e[n]=e[n].map(l=>l.dataKey===r.dataKey&&l.direction===r.direction?a:l))},removeErrorBar:(e,t)=>{var{itemId:n,errorBar:r}=t.payload;e[n]&&(e[n]=e[n].filter(a=>a.dataKey!==r.dataKey||a.direction!==r.direction))}}}),mUe=pUe.reducer,gUe=["children"];function yUe(e,t){if(e==null)return{};var n,r,a=vUe(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function vUe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var _Ue={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},xUe=L.createContext(_Ue);function iue(e){var{children:t}=e,n=yUe(e,gUe);return L.createElement(xUe.Provider,{value:n},t)}function lN(e,t){var n,r,a=Si(x=>wy(x,e)),l=Si(x=>Sy(x,t)),h=(n=a==null?void 0:a.allowDataOverflow)!==null&&n!==void 0?n:hh.allowDataOverflow,i=(r=l==null?void 0:l.allowDataOverflow)!==null&&r!==void 0?r:fh.allowDataOverflow,y=h||i;return{needClip:y,needClipX:h,needClipY:i}}function ZB(e){var{xAxisId:t,yAxisId:n,clipPathId:r}=e,a=oN(),{needClipX:l,needClipY:h,needClip:i}=lN(t,n);if(!i)return null;var{x:y,y:x,width:w,height:C}=a;return L.createElement("clipPath",{id:"clipPath-".concat(r)},L.createElement("rect",{x:l?y:y-w/2,y:h?x:x-C/2,width:l?w:w*2,height:h?C:C*2}))}var bUe=["onMouseEnter","onMouseLeave","onClick"],wUe=["value","background","tooltipPosition"],SUe=["id"],AUe=["onMouseEnter","onClick","onMouseLeave"];function vv(){return vv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vv.apply(null,arguments)}function UZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function nd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?UZ(Object(n),!0).forEach(function(r){TUe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):UZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function TUe(e,t,n){return(t=CUe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CUe(e){var t=EUe(e,"string");return typeof t=="symbol"?t:t+""}function EUe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yk(e,t){if(e==null)return{};var n,r,a=PUe(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function PUe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var kUe=e=>{var{dataKey:t,name:n,fill:r,legendType:a,hide:l}=e;return[{inactive:l,dataKey:t,type:a,color:r,value:kv(n,t),payload:e}]};function IUe(e){var{dataKey:t,stroke:n,strokeWidth:r,fill:a,name:l,hide:h,unit:i}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:n,strokeWidth:r,fill:a,dataKey:t,nameKey:void 0,name:kv(l,t),hide:h,type:e.tooltipType,color:e.fill,unit:i}}}function NUe(e){var t=Si(gv),{data:n,dataKey:r,background:a,allOtherBarProps:l}=e,{onMouseEnter:h,onMouseLeave:i,onClick:y}=l,x=Yk(l,bUe),w=BB(h,r),C=UB(i),P=VB(y,r);if(!a||n==null)return null;var E=Eo(a,!1);return L.createElement(L.Fragment,null,n.map((j,D)=>{var{value:B,background:F,tooltipPosition:$}=j,H=Yk(j,wUe);if(!F)return null;var J=w(j,D),ee=C(j,D),Q=P(j,D),ne=nd(nd(nd(nd(nd({option:a,isActive:String(D)===t},H),{},{fill:"#eee"},F),E),AI(x,j,D)),{},{onMouseEnter:J,onMouseLeave:ee,onClick:Q,dataKey:r,index:D,className:"recharts-bar-background-rectangle"});return L.createElement(WB,vv({key:"background-bar-".concat(ne.index)},ne))}))}function MUe(e){var{showLabels:t,children:n,rects:r}=e,a=r==null?void 0:r.map(l=>{var h={x:l.x,y:l.y,width:l.width,height:l.height};return nd(nd({},h),{},{value:l.value,payload:l.payload,parentViewBox:l.parentViewBox,viewBox:h,fill:l.fill})});return L.createElement(DB,{value:t?a:void 0},n)}function LUe(e){var{shape:t,activeBar:n,baseProps:r,entry:a,index:l,dataKey:h}=e,i=Si(gv),y=Si(bce),x=n&&String(l)===i&&(y==null||h===y),w=x?n:t;return L.createElement(WB,vv({},r,a,{isActive:x,option:w,index:l,dataKey:h}))}function DUe(e){var{shape:t,baseProps:n,entry:r,index:a,dataKey:l}=e;return L.createElement(WB,vv({},n,r,{isActive:!1,option:t,index:a,dataKey:l}))}function RUe(e){var{data:t,props:n}=e,r=If(n),a=Yk(r,SUe),{shape:l,dataKey:h,activeBar:i}=n,{onMouseEnter:y,onClick:x,onMouseLeave:w}=n,C=Yk(n,AUe),P=BB(y,h),E=UB(w),j=VB(x,h);return t?L.createElement(L.Fragment,null,t.map((D,B)=>L.createElement(ul,vv({className:"recharts-bar-rectangle"},AI(C,D,B),{onMouseEnter:P(D,B),onMouseLeave:E(D,B),onClick:j(D,B),key:"rectangle-".concat(D==null?void 0:D.x,"-").concat(D==null?void 0:D.y,"-").concat(D==null?void 0:D.value,"-").concat(B)}),i?L.createElement(LUe,{shape:l,activeBar:i,baseProps:a,entry:D,index:B,dataKey:h}):L.createElement(DUe,{shape:l,baseProps:a,entry:D,index:B,dataKey:h})))):null}function jUe(e){var{props:t,previousRectanglesRef:n}=e,{data:r,layout:a,isAnimationActive:l,animationBegin:h,animationDuration:i,animationEasing:y,onAnimationEnd:x,onAnimationStart:w}=t,C=n.current,P=Rw(t,"recharts-bar-"),[E,j]=L.useState(!1),D=!E,B=L.useCallback(()=>{typeof x=="function"&&x(),j(!1)},[x]),F=L.useCallback(()=>{typeof w=="function"&&w(),j(!0)},[w]);return L.createElement(MUe,{showLabels:D,rects:r},L.createElement(Dw,{animationId:P,begin:h,duration:i,isActive:l,easing:y,onAnimationEnd:B,onAnimationStart:F,key:P},$=>{var H=$===1?r:r==null?void 0:r.map((J,ee)=>{var Q=C&&C[ee];if(Q)return nd(nd({},J),{},{x:$a(Q.x,J.x,$),y:$a(Q.y,J.y,$),width:$a(Q.width,J.width,$),height:$a(Q.height,J.height,$)});if(a==="horizontal"){var ne=$a(0,J.height,$);return nd(nd({},J),{},{y:J.y+J.height-ne,height:ne})}var pe=$a(0,J.width,$);return nd(nd({},J),{},{width:pe})});return $>0&&(n.current=H??null),H==null?null:L.createElement(ul,null,L.createElement(RUe,{props:t,data:H}))}),L.createElement(iN,{label:t.label}),t.children)}function OUe(e){var t=L.useRef(null);return L.createElement(jUe,{previousRectanglesRef:t,props:e})}var sue=0,FUe=(e,t)=>{var n=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:n,errorVal:qa(e,t)}};class zUe extends L.PureComponent{render(){var{hide:t,data:n,dataKey:r,className:a,xAxisId:l,yAxisId:h,needClip:i,background:y,id:x}=this.props;if(t||n==null)return null;var w=ra("recharts-bar",a),C=x;return L.createElement(ul,{className:w,id:x},i&&L.createElement("defs",null,L.createElement(ZB,{clipPathId:C,xAxisId:l,yAxisId:h})),L.createElement(ul,{className:"recharts-bar-rectangles",clipPath:i?"url(#clipPath-".concat(C,")"):void 0},L.createElement(NUe,{data:n,dataKey:r,background:y,allOtherBarProps:this.props}),L.createElement(OUe,this.props)))}}var BUe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!xy.isSsr,legendType:"rect",minPointSize:sue,xAxisId:0,yAxisId:0};function UUe(e){var{xAxisId:t,yAxisId:n,hide:r,legendType:a,minPointSize:l,activeBar:h,animationBegin:i,animationDuration:y,animationEasing:x,isAnimationActive:w}=e,{needClip:C}=lN(t,n),P=W5(),E=Pu(),j=az(e.children,Kg),D=Si($=>mVe($,t,n,E,e.id,j));if(P!=="vertical"&&P!=="horizontal")return null;var B,F=D==null?void 0:D[0];return F==null||F.height==null||F.width==null?B=0:B=P==="vertical"?F.height/2:F.width/2,L.createElement(iue,{xAxisId:t,yAxisId:n,data:D,dataPointFormatter:FUe,errorBarOffset:B},L.createElement(zUe,vv({},e,{layout:P,needClip:C,data:D,xAxisId:t,yAxisId:n,hide:r,legendType:a,minPointSize:l,activeBar:h,animationBegin:i,animationDuration:y,animationEasing:x,isAnimationActive:w})))}function VUe(e){var{layout:t,barSettings:{dataKey:n,minPointSize:r},pos:a,bandSize:l,xAxis:h,yAxis:i,xAxisTicks:y,yAxisTicks:x,stackedData:w,displayedData:C,offset:P,cells:E,parentViewBox:j}=e,D=t==="horizontal"?i:h,B=w?D.scale.domain():null,F=EDe({numericAxis:D});return C.map(($,H)=>{var J,ee,Q,ne,pe,he;w?J=wDe(w[H],B):(J=qa($,n),Array.isArray(J)||(J=[F,J]));var we=hUe(r,sue)(J[1],H);if(t==="horizontal"){var fe,[ge,Ce]=[i.scale(J[0]),i.scale(J[1])];ee=$H({axis:h,ticks:y,bandSize:l,offset:a.offset,entry:$,index:H}),Q=(fe=Ce??ge)!==null&&fe!==void 0?fe:void 0,ne=a.size;var xe=ge-Ce;if(pe=Zd(xe)?0:xe,he={x:ee,y:P.top,width:ne,height:P.height},Math.abs(we)>0&&Math.abs(pe)<Math.abs(we)){var Re=Ec(pe||we)*(Math.abs(we)-Math.abs(pe));Q-=Re,pe+=Re}}else{var[Qe,et]=[h.scale(J[0]),h.scale(J[1])];if(ee=Qe,Q=$H({axis:i,ticks:x,bandSize:l,offset:a.offset,entry:$,index:H}),ne=et-Qe,pe=a.size,he={x:P.left,y:Q,width:P.width,height:pe},Math.abs(we)>0&&Math.abs(ne)<Math.abs(we)){var je=Ec(ne||we)*(Math.abs(we)-Math.abs(ne));ne+=je}}if(ee==null||Q==null||ne==null||pe==null)return null;var De=nd(nd({},$),{},{x:ee,y:Q,width:ne,height:pe,value:w?J:J[1],payload:$,background:he,tooltipPosition:{x:ee+ne/2,y:Q+pe/2},parentViewBox:j},E&&E[H]&&E[H].props);return De}).filter(Boolean)}function $Ue(e){var t=rc(e,BUe),n=Pu();return L.createElement(aN,{id:t.id,type:"bar"},r=>L.createElement(L.Fragment,null,L.createElement($B,{legendPayload:kUe(t)}),L.createElement(sN,{fn:IUe,args:t}),L.createElement(qB,{type:"bar",id:r,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:noe(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),L.createElement(UUe,vv({},t,{id:r}))))}var Nd=L.memo($Ue);Nd.displayName="Bar";function VZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function vE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?VZ(Object(n),!0).forEach(function(r){qUe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function qUe(e,t,n){return(t=GUe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GUe(e){var t=HUe(e,"string");return typeof t=="symbol"?t:t+""}function HUe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WUe=(e,t)=>t,ZUe=(e,t,n)=>n,KUe=(e,t,n,r)=>r,YUe=(e,t,n,r,a)=>a,lT=_n([nT,YUe],(e,t)=>e.filter(n=>n.type==="bar").find(n=>n.id===t)),XUe=_n([lT],e=>e==null?void 0:e.maxBarSize),JUe=(e,t,n,r,a,l)=>l,$Z=(e,t,n)=>{var r=n??e;if(!Co(r))return Cu(r,t,0)},QUe=_n([Hs,nT,WUe,ZUe,KUe],(e,t,n,r,a)=>t.filter(l=>e==="horizontal"?l.xAxisId===n:l.yAxisId===r).filter(l=>l.isPanorama===a).filter(l=>l.hide===!1).filter(l=>l.type==="bar")),eVe=(e,t,n,r)=>{var a=Hs(e);return a==="horizontal"?t5(e,"yAxis",n,r):t5(e,"xAxis",t,r)},tVe=(e,t,n)=>{var r=Hs(e);return r==="horizontal"?eZ(e,"xAxis",t):eZ(e,"yAxis",n)},nVe=(e,t,n)=>{var r={},a=e.filter(XI),l=e.filter(x=>x.stackId==null),h=a.reduce((x,w)=>(x[w.stackId]||(x[w.stackId]=[]),x[w.stackId].push(w),x),r),i=Object.entries(h).map(x=>{var[w,C]=x,P=C.map(j=>j.dataKey),E=$Z(t,n,C[0].barSize);return{stackId:w,dataKeys:P,barSize:E}}),y=l.map(x=>{var w=[x.dataKey].filter(P=>P!=null),C=$Z(t,n,x.barSize);return{stackId:void 0,dataKeys:w,barSize:C}});return[...i,...y]},rVe=_n([QUe,qFe,tVe],nVe),iVe=(e,t,n,r,a)=>{var l,h,i=lT(e,t,n,r,a);if(i!=null){var y=Hs(e),x=_le(e),{maxBarSize:w}=i,C=Co(w)?x:w,P,E;return y==="horizontal"?(P=Zm(e,"xAxis",t,r),E=Wm(e,"xAxis",t,r)):(P=Zm(e,"yAxis",n,r),E=Wm(e,"yAxis",n,r)),(l=(h=vx(P,E,!0))!==null&&h!==void 0?h:C)!==null&&l!==void 0?l:0}},aue=(e,t,n,r)=>{var a=Hs(e),l,h;return a==="horizontal"?(l=Zm(e,"xAxis",t,r),h=Wm(e,"xAxis",t,r)):(l=Zm(e,"yAxis",n,r),h=Wm(e,"yAxis",n,r)),vx(l,h)};function sVe(e,t,n,r,a){var l=r.length;if(!(l<1)){var h=Cu(e,n,0,!0),i,y=[];if(Kc(r[0].barSize)){var x=!1,w=n/l,C=r.reduce((F,$)=>F+($.barSize||0),0);C+=(l-1)*h,C>=n&&(C-=(l-1)*h,h=0),C>=n&&w>0&&(x=!0,w*=.9,C=l*w);var P=(n-C)/2>>0,E={offset:P-h,size:0};i=r.reduce((F,$)=>{var H,J={stackId:$.stackId,dataKeys:$.dataKeys,position:{offset:E.offset+E.size+h,size:x?w:(H=$.barSize)!==null&&H!==void 0?H:0}},ee=[...F,J];return E=ee[ee.length-1].position,ee},y)}else{var j=Cu(t,n,0,!0);n-2*j-(l-1)*h<=0&&(h=0);var D=(n-2*j-(l-1)*h)/l;D>1&&(D>>=0);var B=Kc(a)?Math.min(D,a):D;i=r.reduce((F,$,H)=>[...F,{stackId:$.stackId,dataKeys:$.dataKeys,position:{offset:j+(D+h)*H+(D-B)/2,size:B}}],y)}return i}}var aVe=(e,t,n,r,a,l,h)=>{var i=Co(h)?t:h,y=sVe(n,r,a!==l?a:l,e,i);return a!==l&&y!=null&&(y=y.map(x=>vE(vE({},x),{},{position:vE(vE({},x.position),{},{offset:x.position.offset-a/2})}))),y},oVe=_n([rVe,_le,$Fe,xle,iVe,aue,XUe],aVe),lVe=(e,t,n,r)=>Zm(e,"xAxis",t,r),cVe=(e,t,n,r)=>Zm(e,"yAxis",n,r),uVe=(e,t,n,r)=>Wm(e,"xAxis",t,r),dVe=(e,t,n,r)=>Wm(e,"yAxis",n,r),hVe=_n([oVe,lT],(e,t)=>{if(!(e==null||t==null)){var n=e.find(r=>r.stackId===t.stackId&&t.dataKey!=null&&r.dataKeys.includes(t.dataKey));if(n!=null)return n.position}}),fVe=(e,t)=>{var n=YI(t);if(!(!e||n==null||t==null)){var{stackId:r}=t;if(r!=null){var a=e[r];if(a){var{stackedData:l}=a;if(l)return l.find(h=>h.key===n)}}}},pVe=_n([eVe,lT],fVe),mVe=_n([nc,Ez,lVe,cVe,uVe,dVe,hVe,Hs,J5,aue,pVe,lT,JUe],(e,t,n,r,a,l,h,i,y,x,w,C,P)=>{var{chartData:E,dataStartIndex:j,dataEndIndex:D}=y;if(!(C==null||h==null||t==null||i!=="horizontal"&&i!=="vertical"||n==null||r==null||a==null||l==null||x==null)){var{data:B}=C,F;if(B!=null&&B.length>0?F=B:F=E==null?void 0:E.slice(j,D+1),F!=null)return VUe({layout:i,barSettings:C,pos:h,parentViewBox:t,bandSize:x,xAxis:n,yAxis:r,xAxisTicks:a,yAxisTicks:l,stackedData:w,displayedData:F,offset:e,cells:P})}}),oue=e=>{var{chartData:t}=e,n=Al(),r=Pu();return L.useEffect(()=>r?()=>{}:(n(cZ(t)),()=>{n(cZ(void 0))}),[t,n,r]),null},qZ={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},gVe=Dh({name:"brush",initialState:qZ,reducers:{setBrushSettings(e,t){return t.payload==null?qZ:t.payload}}}),yVe=gVe.reducer;function vVe(e,t,n){return(t=_Ve(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _Ve(e){var t=xVe(e,"string");return typeof t=="symbol"?t:t+""}function xVe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class KB{static create(t){return new KB(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:n,position:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(r)switch(r){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(t)+l}default:return this.scale(t)}if(n){var h=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+h}return this.scale(t)}}isInRange(t){var n=this.range(),r=n[0],a=n[n.length-1];return r<=a?t>=r&&t<=a:t>=a&&t<=r}}vVe(KB,"EPS",1e-4);function bVe(e){return(e%180+180)%180}var wVe=function(t){var{width:n,height:r}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=bVe(a),h=l*Math.PI/180,i=Math.atan(r/n),y=h>i&&h<Math.PI-i?r/Math.sin(h):n/Math.cos(h);return Math.abs(y)},SVe={dots:[],areas:[],lines:[]},AVe=Dh({name:"referenceElements",initialState:SVe,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var n=Wg(e).dots.findIndex(r=>r===t.payload);n!==-1&&e.dots.splice(n,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var n=Wg(e).areas.findIndex(r=>r===t.payload);n!==-1&&e.areas.splice(n,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var n=Wg(e).lines.findIndex(r=>r===t.payload);n!==-1&&e.lines.splice(n,1)}}}),TVe=AVe.reducer,CVe=L.createContext(void 0),EVe=e=>{var{children:t}=e,[n]=L.useState("".concat(HA("recharts"),"-clip")),r=oN();if(r==null)return null;var{x:a,y:l,width:h,height:i}=r;return L.createElement(CVe.Provider,{value:n},L.createElement("defs",null,L.createElement("clipPath",{id:n},L.createElement("rect",{x:a,y:l,height:i,width:h}))),t)};function gw(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function lue(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var r=[],a=0;a<e.length;a+=t)r.push(e[a]);return r}function PVe(e,t,n){var r={width:e.width+t.width,height:e.height+t.height};return wVe(r,n)}function kVe(e,t,n){var r=n==="width",{x:a,y:l,width:h,height:i}=e;return t===1?{start:r?a:l,end:r?a+h:l+i}:{start:r?a+h:l+i,end:r?a:l}}function Xk(e,t,n,r,a){if(e*t<e*r||e*t>e*a)return!1;var l=n();return e*(t-e*l/2-r)>=0&&e*(t+e*l/2-a)<=0}function IVe(e,t){return lue(e,t+1)}function NVe(e,t,n,r,a){for(var l=(r||[]).slice(),{start:h,end:i}=t,y=0,x=1,w=h,C=function(){var j=r==null?void 0:r[y];if(j===void 0)return{v:lue(r,x)};var D=y,B,F=()=>(B===void 0&&(B=n(j,D)),B),$=j.coordinate,H=y===0||Xk(e,$,F,w,i);H||(y=0,w=h,x+=1),H&&(w=$+e*(F()/2+a),y+=x)},P;x<=l.length;)if(P=C(),P)return P.v;return[]}function GZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function bu(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?GZ(Object(n),!0).forEach(function(r){MVe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):GZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function MVe(e,t,n){return(t=LVe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function LVe(e){var t=DVe(e,"string");return typeof t=="symbol"?t:t+""}function DVe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RVe(e,t,n,r,a){for(var l=(r||[]).slice(),h=l.length,{start:i}=t,{end:y}=t,x=function(P){var E=l[P],j,D=()=>(j===void 0&&(j=n(E,P)),j);if(P===h-1){var B=e*(E.coordinate+e*D()/2-y);l[P]=E=bu(bu({},E),{},{tickCoord:B>0?E.coordinate-B*e:E.coordinate})}else l[P]=E=bu(bu({},E),{},{tickCoord:E.coordinate});var F=Xk(e,E.tickCoord,D,i,y);F&&(y=E.tickCoord-e*(D()/2+a),l[P]=bu(bu({},E),{},{isShow:!0}))},w=h-1;w>=0;w--)x(w);return l}function jVe(e,t,n,r,a,l){var h=(r||[]).slice(),i=h.length,{start:y,end:x}=t;if(l){var w=r[i-1],C=n(w,i-1),P=e*(w.coordinate+e*C/2-x);h[i-1]=w=bu(bu({},w),{},{tickCoord:P>0?w.coordinate-P*e:w.coordinate});var E=Xk(e,w.tickCoord,()=>C,y,x);E&&(x=w.tickCoord-e*(C/2+a),h[i-1]=bu(bu({},w),{},{isShow:!0}))}for(var j=l?i-1:i,D=function($){var H=h[$],J,ee=()=>(J===void 0&&(J=n(H,$)),J);if($===0){var Q=e*(H.coordinate-e*ee()/2-y);h[$]=H=bu(bu({},H),{},{tickCoord:Q<0?H.coordinate-Q*e:H.coordinate})}else h[$]=H=bu(bu({},H),{},{tickCoord:H.coordinate});var ne=Xk(e,H.tickCoord,ee,y,x);ne&&(y=H.tickCoord+e*(ee()/2+a),h[$]=bu(bu({},H),{},{isShow:!0}))},B=0;B<j;B++)D(B);return h}function YB(e,t,n){var{tick:r,ticks:a,viewBox:l,minTickGap:h,orientation:i,interval:y,tickFormatter:x,unit:w,angle:C}=e;if(!a||!a.length||!r)return[];if(wi(y)||xy.isSsr){var P;return(P=IVe(a,wi(y)?y:0))!==null&&P!==void 0?P:[]}var E=[],j=i==="top"||i==="bottom"?"width":"height",D=w&&j==="width"?rA(w,{fontSize:t,letterSpacing:n}):{width:0,height:0},B=(H,J)=>{var ee=typeof x=="function"?x(H.value,J):H.value;return j==="width"?PVe(rA(ee,{fontSize:t,letterSpacing:n}),D,C):rA(ee,{fontSize:t,letterSpacing:n})[j]},F=a.length>=2?Ec(a[1].coordinate-a[0].coordinate):1,$=kVe(l,F,j);return y==="equidistantPreserveStart"?NVe(F,$,B,a,h):(y==="preserveStart"||y==="preserveStartEnd"?E=jVe(F,$,B,a,h,y==="preserveStartEnd"):E=RVe(F,$,B,a,h),E.filter(H=>H.isShow))}var OVe=e=>{var{ticks:t,label:n,labelGapWithTick:r=5,tickSize:a=0,tickMargin:l=0}=e,h=0;if(t){t.forEach(w=>{if(w){var C=w.getBoundingClientRect();C.width>h&&(h=C.width)}});var i=n?n.getBoundingClientRect().width:0,y=a+l,x=h+y+i+(n?r:0);return Math.round(x)}return 0},FVe=["axisLine","width","height","className","hide","ticks"],zVe=["viewBox"],BVe=["viewBox"];function Uj(e,t){if(e==null)return{};var n,r,a=UVe(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function UVe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function xx(){return xx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xx.apply(null,arguments)}function HZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Xl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?HZ(Object(n),!0).forEach(function(r){VVe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function VVe(e,t,n){return(t=$Ve(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $Ve(e){var t=qVe(e,"string");return typeof t=="symbol"?t:t+""}function qVe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XB={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function GVe(e){var{x:t,y:n,width:r,height:a,orientation:l,mirror:h,axisLine:i,otherSvgProps:y}=e;if(!i)return null;var x=Xl(Xl(Xl({},y),Eo(i,!1)),{},{fill:"none"});if(l==="top"||l==="bottom"){var w=+(l==="top"&&!h||l==="bottom"&&h);x=Xl(Xl({},x),{},{x1:t,y1:n+w*a,x2:t+r,y2:n+w*a})}else{var C=+(l==="left"&&!h||l==="right"&&h);x=Xl(Xl({},x),{},{x1:t+C*r,y1:n,x2:t+C*r,y2:n+a})}return L.createElement("line",xx({},x,{className:ra("recharts-cartesian-axis-line",mx(i,"className"))}))}function HVe(e,t,n,r,a,l,h,i,y){var x,w,C,P,E,j,D=i?-1:1,B=e.tickSize||h,F=wi(e.tickCoord)?e.tickCoord:e.coordinate;switch(l){case"top":x=w=e.coordinate,P=n+ +!i*a,C=P-D*B,j=C-D*y,E=F;break;case"left":C=P=e.coordinate,w=t+ +!i*r,x=w-D*B,E=x-D*y,j=F;break;case"right":C=P=e.coordinate,w=t+ +i*r,x=w+D*B,E=x+D*y,j=F;break;default:x=w=e.coordinate,P=n+ +i*a,C=P+D*B,j=C+D*y,E=F;break}return{line:{x1:x,y1:C,x2:w,y2:P},tick:{x:E,y:j}}}function WVe(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function ZVe(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function KVe(e){var{option:t,tickProps:n,value:r}=e,a,l=ra(n.className,"recharts-cartesian-axis-tick-value");if(L.isValidElement(t))a=L.cloneElement(t,Xl(Xl({},n),{},{className:l}));else if(typeof t=="function")a=t(Xl(Xl({},n),{},{className:l}));else{var h="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(h=ra(h,t==null?void 0:t.className)),a=L.createElement(rN,xx({},n,{className:h}),r)}return a}function YVe(e){var{ticks:t=[],tick:n,tickLine:r,stroke:a,tickFormatter:l,unit:h,padding:i,tickTextProps:y,orientation:x,mirror:w,x:C,y:P,width:E,height:j,tickSize:D,tickMargin:B,fontSize:F,letterSpacing:$,getTicksConfig:H,events:J}=e,ee=YB(Xl(Xl({},H),{},{ticks:t}),F,$),Q=WVe(x,w),ne=ZVe(x,w),pe=If(H),he=Eo(n,!1),we=Xl(Xl({},pe),{},{fill:"none"},Eo(r,!1)),fe=ee.map((ge,Ce)=>{var{line:xe,tick:Re}=HVe(ge,C,P,E,j,x,D,w,B),Qe=Xl(Xl(Xl(Xl({textAnchor:Q,verticalAnchor:ne},pe),{},{stroke:"none",fill:a},he),Re),{},{index:Ce,payload:ge,visibleTicksCount:ee.length,tickFormatter:l,padding:i},y);return L.createElement(ul,xx({className:"recharts-cartesian-axis-tick",key:"tick-".concat(ge.value,"-").concat(ge.coordinate,"-").concat(ge.tickCoord)},AI(J,ge,Ce)),r&&L.createElement("line",xx({},we,xe,{className:ra("recharts-cartesian-axis-tick-line",mx(r,"className"))})),n&&L.createElement(KVe,{option:n,tickProps:Qe,value:"".concat(typeof l=="function"?l(ge.value,Ce):ge.value).concat(h||"")}))});return fe.length>0?L.createElement("g",{className:"recharts-cartesian-axis-ticks"},fe):null}var XVe=L.forwardRef((e,t)=>{var{axisLine:n,width:r,height:a,className:l,hide:h,ticks:i}=e,y=Uj(e,FVe),[x,w]=L.useState(""),[C,P]=L.useState(""),E=L.useRef([]);L.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var D;return OVe({ticks:E.current,label:(D=e.labelRef)===null||D===void 0?void 0:D.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var j=L.useCallback(D=>{if(D){var B=D.getElementsByClassName("recharts-cartesian-axis-tick-value");E.current=Array.from(B);var F=B[0];if(F){var $=window.getComputedStyle(F),H=$.fontSize,J=$.letterSpacing;(H!==x||J!==C)&&(w(H),P(J))}}},[x,C]);return h||r!=null&&r<=0||a!=null&&a<=0?null:L.createElement(ul,{className:ra("recharts-cartesian-axis",l),ref:j},L.createElement(GVe,{x:e.x,y:e.y,width:r,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:n,otherSvgProps:If(e)}),L.createElement(YVe,{ticks:i,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:x,letterSpacing:C,getTicksConfig:e,events:y}),L.createElement(s8e,{x:e.x,y:e.y,width:e.width,height:e.height},L.createElement(m8e,{label:e.label}),e.children))}),JVe=L.memo(XVe,(e,t)=>{var{viewBox:n}=e,r=Uj(e,zVe),{viewBox:a}=t,l=Uj(t,BVe);return gw(n,a)&&gw(r,l)}),JB=L.forwardRef((e,t)=>{var n=rc(e,XB);return L.createElement(JVe,xx({},n,{ref:t}))});JB.displayName="CartesianAxis";var QVe=["x1","y1","x2","y2","key"],e$e=["offset"],t$e=["xAxisId","yAxisId"],n$e=["xAxisId","yAxisId"];function WZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function Su(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?WZ(Object(n),!0).forEach(function(r){r$e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function r$e(e,t,n){return(t=i$e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i$e(e){var t=s$e(e,"string");return typeof t=="symbol"?t:t+""}function s$e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function R_(){return R_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},R_.apply(null,arguments)}function Jk(e,t){if(e==null)return{};var n,r,a=a$e(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function a$e(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var o$e=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:n,x:r,y:a,width:l,height:h,ry:i}=e;return L.createElement("rect",{x:r,y:a,ry:i,width:l,height:h,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function cue(e,t){var n;if(L.isValidElement(e))n=L.cloneElement(e,t);else if(typeof e=="function")n=e(t);else{var{x1:r,y1:a,x2:l,y2:h,key:i}=t,y=Jk(t,QVe),x=If(y),w=Jk(x,e$e);n=L.createElement("line",R_({},w,{x1:r,y1:a,x2:l,y2:h,fill:"none",key:i}))}return n}function l$e(e){var{x:t,width:n,horizontal:r=!0,horizontalPoints:a}=e;if(!r||!a||!a.length)return null;var l=Jk(e,t$e),h=a.map((i,y)=>{var x=Su(Su({},l),{},{x1:t,y1:i,x2:t+n,y2:i,key:"line-".concat(y),index:y});return cue(r,x)});return L.createElement("g",{className:"recharts-cartesian-grid-horizontal"},h)}function c$e(e){var{y:t,height:n,vertical:r=!0,verticalPoints:a}=e;if(!r||!a||!a.length)return null;var l=Jk(e,n$e),h=a.map((i,y)=>{var x=Su(Su({},l),{},{x1:i,y1:t,x2:i,y2:t+n,key:"line-".concat(y),index:y});return cue(r,x)});return L.createElement("g",{className:"recharts-cartesian-grid-vertical"},h)}function u$e(e){var{horizontalFill:t,fillOpacity:n,x:r,y:a,width:l,height:h,horizontalPoints:i,horizontal:y=!0}=e;if(!y||!t||!t.length)return null;var x=i.map(C=>Math.round(C+a-a)).sort((C,P)=>C-P);a!==x[0]&&x.unshift(0);var w=x.map((C,P)=>{var E=!x[P+1],j=E?a+h-C:x[P+1]-C;if(j<=0)return null;var D=P%t.length;return L.createElement("rect",{key:"react-".concat(P),y:C,x:r,height:j,width:l,stroke:"none",fill:t[D],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return L.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},w)}function d$e(e){var{vertical:t=!0,verticalFill:n,fillOpacity:r,x:a,y:l,width:h,height:i,verticalPoints:y}=e;if(!t||!n||!n.length)return null;var x=y.map(C=>Math.round(C+a-a)).sort((C,P)=>C-P);a!==x[0]&&x.unshift(0);var w=x.map((C,P)=>{var E=!x[P+1],j=E?a+h-C:x[P+1]-C;if(j<=0)return null;var D=P%n.length;return L.createElement("rect",{key:"react-".concat(P),x:C,y:l,width:j,height:i,stroke:"none",fill:n[D],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return L.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},w)}var h$e=(e,t)=>{var{xAxis:n,width:r,height:a,offset:l}=e;return eoe(YB(Su(Su(Su({},XB),n),{},{ticks:toe(n),viewBox:{x:0,y:0,width:r,height:a}})),l.left,l.left+l.width,t)},f$e=(e,t)=>{var{yAxis:n,width:r,height:a,offset:l}=e;return eoe(YB(Su(Su(Su({},XB),n),{},{ticks:toe(n),viewBox:{x:0,y:0,width:r,height:a}})),l.top,l.top+l.height,t)},p$e={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function uue(e){var t=ooe(),n=loe(),r=aoe(),a=Su(Su({},rc(e,p$e)),{},{x:wi(e.x)?e.x:r.left,y:wi(e.y)?e.y:r.top,width:wi(e.width)?e.width:r.width,height:wi(e.height)?e.height:r.height}),{xAxisId:l,yAxisId:h,x:i,y,width:x,height:w,syncWithTicks:C,horizontalValues:P,verticalValues:E}=a,j=Pu(),D=Si(he=>tZ(he,"xAxis",l,j)),B=Si(he=>tZ(he,"yAxis",h,j));if(!wi(x)||x<=0||!wi(w)||w<=0||!wi(i)||i!==+i||!wi(y)||y!==+y)return null;var F=a.verticalCoordinatesGenerator||h$e,$=a.horizontalCoordinatesGenerator||f$e,{horizontalPoints:H,verticalPoints:J}=a;if((!H||!H.length)&&typeof $=="function"){var ee=P&&P.length,Q=$({yAxis:B?Su(Su({},B),{},{ticks:ee?P:B.ticks}):void 0,width:t,height:n,offset:r},ee?!0:C);nA(Array.isArray(Q),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof Q,"]")),Array.isArray(Q)&&(H=Q)}if((!J||!J.length)&&typeof F=="function"){var ne=E&&E.length,pe=F({xAxis:D?Su(Su({},D),{},{ticks:ne?E:D.ticks}):void 0,width:t,height:n,offset:r},ne?!0:C);nA(Array.isArray(pe),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof pe,"]")),Array.isArray(pe)&&(J=pe)}return L.createElement("g",{className:"recharts-cartesian-grid"},L.createElement(o$e,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),L.createElement(u$e,R_({},a,{horizontalPoints:H})),L.createElement(d$e,R_({},a,{verticalPoints:J})),L.createElement(l$e,R_({},a,{offset:r,horizontalPoints:H,xAxis:D,yAxis:B})),L.createElement(c$e,R_({},a,{offset:r,verticalPoints:J,xAxis:D,yAxis:B})))}uue.displayName="CartesianGrid";var due=(e,t,n,r)=>Zm(e,"xAxis",t,r),hue=(e,t,n,r)=>Wm(e,"xAxis",t,r),fue=(e,t,n,r)=>Zm(e,"yAxis",n,r),pue=(e,t,n,r)=>Wm(e,"yAxis",n,r),m$e=_n([Hs,due,fue,hue,pue],(e,t,n,r,a)=>Xm(e,"xAxis")?vx(t,r,!1):vx(n,a,!1)),g$e=(e,t,n,r,a)=>a;function y$e(e){return e.type==="line"}var v$e=_n([nT,g$e],(e,t)=>e.filter(y$e).find(n=>n.id===t)),_$e=_n([Hs,due,fue,hue,pue,v$e,m$e,J5],(e,t,n,r,a,l,h,i)=>{var{chartData:y,dataStartIndex:x,dataEndIndex:w}=i;if(!(l==null||t==null||n==null||r==null||a==null||r.length===0||a.length===0||h==null)){var{dataKey:C,data:P}=l,E;if(P!=null&&P.length>0?E=P:E=y==null?void 0:y.slice(x,w+1),E!=null)return U$e({layout:e,xAxis:t,yAxis:n,xAxisTicks:r,yAxisTicks:a,dataKey:C,bandSize:h,displayedData:E})}}),x$e=["id"],b$e=["type","layout","connectNulls","needClip"],w$e=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function ZZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function _h(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ZZ(Object(n),!0).forEach(function(r){S$e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ZZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function S$e(e,t,n){return(t=A$e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A$e(e){var t=T$e(e,"string");return typeof t=="symbol"?t:t+""}function T$e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QB(e,t){if(e==null)return{};var n,r,a=C$e(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function C$e(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function bx(){return bx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bx.apply(null,arguments)}var E$e=e=>{var{dataKey:t,name:n,stroke:r,legendType:a,hide:l}=e;return[{inactive:l,dataKey:t,type:a,color:r,value:kv(n,t),payload:e}]};function P$e(e){var{dataKey:t,data:n,stroke:r,strokeWidth:a,fill:l,name:h,hide:i,unit:y}=e;return{dataDefinedOnItem:n,positions:void 0,settings:{stroke:r,strokeWidth:a,fill:l,dataKey:t,nameKey:void 0,name:kv(h,t),hide:i,type:e.tooltipType,color:e.stroke,unit:y}}}var mue=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function k$e(e,t){for(var n=e.length%2!==0?[...e,0]:e,r=[],a=0;a<t;++a)r=[...r,...n];return r}var I$e=(e,t,n)=>{var r=n.reduce((C,P)=>C+P);if(!r)return mue(t,e);for(var a=Math.floor(e/r),l=e%r,h=t-e,i=[],y=0,x=0;y<n.length;x+=n[y],++y)if(x+n[y]>l){i=[...n.slice(0,y),l-x];break}var w=i.length%2===0?[0,h]:[h];return[...k$e(n,a),...i,...w].map(C=>"".concat(C,"px")).join(", ")};function N$e(e,t){var n;if(L.isValidElement(e))n=L.cloneElement(e,t);else if(typeof e=="function")n=e(t);else{var r=ra("recharts-line-dot",typeof e!="boolean"?e.className:"");n=L.createElement(RB,bx({},t,{className:r}))}return n}function M$e(e,t){return e==null?!1:t?!0:e.length===1}function L$e(e){var{clipPathId:t,points:n,props:r}=e,{dot:a,dataKey:l,needClip:h}=r;if(!M$e(n,a))return null;var i=QB(r,x$e),y=TI(a),x=If(i),w=Eo(a,!0),C=n.map((E,j)=>{var D=_h(_h(_h({key:"dot-".concat(j),r:3},x),w),{},{index:j,cx:E.x,cy:E.y,dataKey:l,value:E.value,payload:E.payload,points:n});return N$e(a,D)}),P={clipPath:h?"url(#clipPath-".concat(y?"":"dots-").concat(t,")"):void 0};return L.createElement(ul,bx({className:"recharts-line-dots",key:"dots"},P),C)}function D$e(e){var{showLabels:t,children:n,points:r}=e,a=L.useMemo(()=>r==null?void 0:r.map(l=>{var h={x:l.x,y:l.y,width:0,height:0};return _h(_h({},h),{},{value:l.value,payload:l.payload,viewBox:h,parentViewBox:void 0,fill:void 0})}),[r]);return L.createElement(DB,{value:t?a:null},n)}function KZ(e){var{clipPathId:t,pathRef:n,points:r,strokeDasharray:a,props:l}=e,{type:h,layout:i,connectNulls:y,needClip:x}=l,w=QB(l,b$e),C=_h(_h({},Eo(w,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:x?"url(#clipPath-".concat(t,")"):void 0,points:r,type:h,layout:i,connectNulls:y,strokeDasharray:a??l.strokeDasharray});return L.createElement(L.Fragment,null,(r==null?void 0:r.length)>1&&L.createElement(wb,bx({},C,{pathRef:n})),L.createElement(L$e,{points:r,clipPathId:t,props:l}))}function R$e(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function j$e(e){var{clipPathId:t,props:n,pathRef:r,previousPointsRef:a,longestAnimatedLengthRef:l}=e,{points:h,strokeDasharray:i,isAnimationActive:y,animationBegin:x,animationDuration:w,animationEasing:C,animateNewValues:P,width:E,height:j,onAnimationEnd:D,onAnimationStart:B}=n,F=a.current,$=Rw(n,"recharts-line-"),[H,J]=L.useState(!1),ee=!H,Q=L.useCallback(()=>{typeof D=="function"&&D(),J(!1)},[D]),ne=L.useCallback(()=>{typeof B=="function"&&B(),J(!0)},[B]),pe=R$e(r.current),he=l.current;return L.createElement(D$e,{points:h,showLabels:ee},n.children,L.createElement(Dw,{animationId:$,begin:x,duration:w,isActive:y,easing:C,onAnimationEnd:Q,onAnimationStart:ne,key:$},we=>{var fe=$a(he,pe+he,we),ge=Math.min(fe,pe),Ce;if(y)if(i){var xe="".concat(i).split(/[,\s]+/gim).map(et=>parseFloat(et));Ce=I$e(ge,pe,xe)}else Ce=mue(pe,ge);else Ce=i==null?void 0:String(i);if(F){var Re=F.length/h.length,Qe=we===1?h:h.map((et,je)=>{var De=Math.floor(je*Re);if(F[De]){var Ct=F[De];return _h(_h({},et),{},{x:$a(Ct.x,et.x,we),y:$a(Ct.y,et.y,we)})}return P?_h(_h({},et),{},{x:$a(E*2,et.x,we),y:$a(j/2,et.y,we)}):_h(_h({},et),{},{x:et.x,y:et.y})});return a.current=Qe,L.createElement(KZ,{props:n,points:Qe,clipPathId:t,pathRef:r,strokeDasharray:Ce})}return we>0&&pe>0&&(a.current=h,l.current=ge),L.createElement(KZ,{props:n,points:h,clipPathId:t,pathRef:r,strokeDasharray:Ce})}),L.createElement(iN,{label:n.label}))}function O$e(e){var{clipPathId:t,props:n}=e,r=L.useRef(null),a=L.useRef(0),l=L.useRef(null);return L.createElement(j$e,{props:n,clipPathId:t,previousPointsRef:r,longestAnimatedLengthRef:a,pathRef:l})}var F$e=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:qa(e.payload,t)});class z$e extends L.Component{render(){var t,{hide:n,dot:r,points:a,className:l,xAxisId:h,yAxisId:i,top:y,left:x,width:w,height:C,id:P,needClip:E}=this.props;if(n)return null;var j=ra("recharts-line",l),D=P,{r:B=3,strokeWidth:F=2}=(t=Eo(r,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},$=TI(r),H=B*2+F;return L.createElement(L.Fragment,null,L.createElement(ul,{className:j},E&&L.createElement("defs",null,L.createElement(ZB,{clipPathId:D,xAxisId:h,yAxisId:i}),!$&&L.createElement("clipPath",{id:"clipPath-dots-".concat(D)},L.createElement("rect",{x:x-H/2,y:y-H/2,width:w+H,height:C+H}))),L.createElement(iue,{xAxisId:h,yAxisId:i,data:a,dataPointFormatter:F$e,errorBarOffset:0},L.createElement(O$e,{props:this.props,clipPathId:D}))),L.createElement(zj,{activeDot:this.props.activeDot,points:a,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var gue={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!xy.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function B$e(e){var t=rc(e,gue),{activeDot:n,animateNewValues:r,animationBegin:a,animationDuration:l,animationEasing:h,connectNulls:i,dot:y,hide:x,isAnimationActive:w,label:C,legendType:P,xAxisId:E,yAxisId:j,id:D}=t,B=QB(t,w$e),{needClip:F}=lN(E,j),$=oN(),H=W5(),J=Pu(),ee=Si(we=>_$e(we,E,j,J,D));if(H!=="horizontal"&&H!=="vertical"||ee==null||$==null)return null;var{height:Q,width:ne,x:pe,y:he}=$;return L.createElement(z$e,bx({},B,{id:D,connectNulls:i,dot:y,activeDot:n,animateNewValues:r,animationBegin:a,animationDuration:l,animationEasing:h,isAnimationActive:w,hide:x,label:C,legendType:P,xAxisId:E,yAxisId:j,points:ee,layout:H,height:Q,width:ne,left:pe,top:he,needClip:F}))}function U$e(e){var{layout:t,xAxis:n,yAxis:r,xAxisTicks:a,yAxisTicks:l,dataKey:h,bandSize:i,displayedData:y}=e;return y.map((x,w)=>{var C=qa(x,h);if(t==="horizontal"){var P=Ik({axis:n,ticks:a,bandSize:i,entry:x,index:w}),E=Co(C)?null:r.scale(C);return{x:P,y:E,value:C,payload:x}}var j=Co(C)?null:n.scale(C),D=Ik({axis:r,ticks:l,bandSize:i,entry:x,index:w});return j==null||D==null?null:{x:j,y:D,value:C,payload:x}}).filter(Boolean)}function V$e(e){var t=rc(e,gue),n=Pu();return L.createElement(aN,{id:t.id,type:"line"},r=>L.createElement(L.Fragment,null,L.createElement($B,{legendPayload:E$e(t)}),L.createElement(sN,{fn:P$e,args:t}),L.createElement(qB,{type:"line",id:r,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:n}),L.createElement(B$e,bx({},t,{id:r}))))}var cN=L.memo(V$e);cN.displayName="Line";var yue=(e,t,n,r)=>Zm(e,"xAxis",t,r),vue=(e,t,n,r)=>Wm(e,"xAxis",t,r),_ue=(e,t,n,r)=>Zm(e,"yAxis",n,r),xue=(e,t,n,r)=>Wm(e,"yAxis",n,r),$$e=_n([Hs,yue,_ue,vue,xue],(e,t,n,r,a)=>Xm(e,"xAxis")?vx(t,r,!1):vx(n,a,!1)),q$e=(e,t,n,r,a)=>a,bue=_n([nT,q$e],(e,t)=>e.filter(n=>n.type==="area").find(n=>n.id===t)),G$e=(e,t,n,r,a)=>{var l,h=bue(e,t,n,r,a);if(h!=null){var i=Hs(e),y=Xm(i,"xAxis"),x;if(y?x=t5(e,"yAxis",n,r):x=t5(e,"xAxis",t,r),x!=null){var{stackId:w}=h,C=YI(h);if(!(w==null||C==null)){var P=(l=x[w])===null||l===void 0?void 0:l.stackedData;return P==null?void 0:P.find(E=>E.key===C)}}}},H$e=_n([Hs,yue,_ue,vue,xue,G$e,J5,$$e,bue],(e,t,n,r,a,l,h,i,y)=>{var{chartData:x,dataStartIndex:w,dataEndIndex:C}=h;if(!(y==null||e!=="horizontal"&&e!=="vertical"||t==null||n==null||r==null||a==null||r.length===0||a.length===0||i==null)){var{data:P}=y,E;if(P&&P.length>0?E=P:E=x==null?void 0:x.slice(w,C+1),E!=null){var j=void 0;return f9e({layout:e,xAxis:t,yAxis:n,xAxisTicks:r,yAxisTicks:a,dataStartIndex:w,areaSettings:y,stackedData:l,displayedData:E,chartBaseValue:j,bandSize:i})}}}),W$e=["id"],Z$e=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];function wue(e,t){if(e==null)return{};var n,r,a=K$e(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function K$e(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function YZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function qg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?YZ(Object(n),!0).forEach(function(r){Y$e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YZ(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Y$e(e,t,n){return(t=X$e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X$e(e){var t=J$e(e,"string");return typeof t=="symbol"?t:t+""}function J$e(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yg(){return Yg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Yg.apply(null,arguments)}function Qk(e,t){return e&&e!=="none"?e:t}var Q$e=e=>{var{dataKey:t,name:n,stroke:r,fill:a,legendType:l,hide:h}=e;return[{inactive:h,dataKey:t,type:l,color:Qk(r,a),value:kv(n,t),payload:e}]};function e9e(e){var{dataKey:t,data:n,stroke:r,strokeWidth:a,fill:l,name:h,hide:i,unit:y}=e;return{dataDefinedOnItem:n,positions:void 0,settings:{stroke:r,strokeWidth:a,fill:l,dataKey:t,nameKey:void 0,name:kv(h,t),hide:i,type:e.tooltipType,color:Qk(r,l),unit:y}}}var t9e=(e,t)=>{var n;if(L.isValidElement(e))n=L.cloneElement(e,t);else if(typeof e=="function")n=e(t);else{var r=ra("recharts-area-dot",typeof e!="boolean"?e.className:"");n=L.createElement(RB,Yg({},t,{className:r}))}return n};function n9e(e,t){return e==null?!1:t?!0:e.length===1}function r9e(e){var{clipPathId:t,points:n,props:r}=e,{needClip:a,dot:l,dataKey:h}=r;if(!n9e(n,l))return null;var i=TI(l),y=If(r),x=Eo(l,!0),w=n.map((P,E)=>{var j=qg(qg(qg({key:"dot-".concat(E),r:3},y),x),{},{index:E,cx:P.x,cy:P.y,dataKey:h,value:P.value,payload:P.payload,points:n});return t9e(l,j)}),C={clipPath:a?"url(#clipPath-".concat(i?"":"dots-").concat(t,")"):void 0};return L.createElement(ul,Yg({className:"recharts-area-dots"},C),w)}function i9e(e){var{showLabels:t,children:n,points:r}=e,a=r.map(l=>{var h={x:l.x,y:l.y,width:0,height:0};return qg(qg({},h),{},{value:l.value,payload:l.payload,parentViewBox:void 0,viewBox:h,fill:void 0})});return L.createElement(DB,{value:t?a:null},n)}function XZ(e){var{points:t,baseLine:n,needClip:r,clipPathId:a,props:l}=e,{layout:h,type:i,stroke:y,connectNulls:x,isRange:w}=l,{id:C}=l,P=wue(l,W$e),E=If(P);return L.createElement(L.Fragment,null,(t==null?void 0:t.length)>1&&L.createElement(ul,{clipPath:r?"url(#clipPath-".concat(a,")"):void 0},L.createElement(wb,Yg({},E,{id:C,points:t,connectNulls:x,type:i,baseLine:n,layout:h,stroke:"none",className:"recharts-area-area"})),y!=="none"&&L.createElement(wb,Yg({},E,{className:"recharts-area-curve",layout:h,type:i,connectNulls:x,fill:"none",points:t})),y!=="none"&&w&&L.createElement(wb,Yg({},E,{className:"recharts-area-curve",layout:h,type:i,connectNulls:x,fill:"none",points:n}))),L.createElement(r9e,{points:t,props:P,clipPathId:a}))}function s9e(e){var{alpha:t,baseLine:n,points:r,strokeWidth:a}=e,l=r[0].y,h=r[r.length-1].y;if(!Kc(l)||!Kc(h))return null;var i=t*Math.abs(l-h),y=Math.max(...r.map(x=>x.x||0));return wi(n)?y=Math.max(n,y):n&&Array.isArray(n)&&n.length&&(y=Math.max(...n.map(x=>x.x||0),y)),wi(y)?L.createElement("rect",{x:0,y:l<h?l:l-i,width:y+(a?parseInt("".concat(a),10):1),height:Math.floor(i)}):null}function a9e(e){var{alpha:t,baseLine:n,points:r,strokeWidth:a}=e,l=r[0].x,h=r[r.length-1].x;if(!Kc(l)||!Kc(h))return null;var i=t*Math.abs(l-h),y=Math.max(...r.map(x=>x.y||0));return wi(n)?y=Math.max(n,y):n&&Array.isArray(n)&&n.length&&(y=Math.max(...n.map(x=>x.y||0),y)),wi(y)?L.createElement("rect",{x:l<h?l:l-i,y:0,width:i,height:Math.floor(y+(a?parseInt("".concat(a),10):1))}):null}function o9e(e){var{alpha:t,layout:n,points:r,baseLine:a,strokeWidth:l}=e;return n==="vertical"?L.createElement(s9e,{alpha:t,points:r,baseLine:a,strokeWidth:l}):L.createElement(a9e,{alpha:t,points:r,baseLine:a,strokeWidth:l})}function l9e(e){var{needClip:t,clipPathId:n,props:r,previousPointsRef:a,previousBaselineRef:l}=e,{points:h,baseLine:i,isAnimationActive:y,animationBegin:x,animationDuration:w,animationEasing:C,onAnimationStart:P,onAnimationEnd:E}=r,j=Rw(r,"recharts-area-"),[D,B]=L.useState(!1),F=!D,$=L.useCallback(()=>{typeof E=="function"&&E(),B(!1)},[E]),H=L.useCallback(()=>{typeof P=="function"&&P(),B(!0)},[P]),J=a.current,ee=l.current;return L.createElement(i9e,{showLabels:F,points:h},r.children,L.createElement(Dw,{animationId:j,begin:x,duration:w,isActive:y,easing:C,onAnimationEnd:$,onAnimationStart:H,key:j},Q=>{if(J){var ne=J.length/h.length,pe=Q===1?h:h.map((we,fe)=>{var ge=Math.floor(fe*ne);if(J[ge]){var Ce=J[ge];return qg(qg({},we),{},{x:$a(Ce.x,we.x,Q),y:$a(Ce.y,we.y,Q)})}return we}),he;return wi(i)?he=$a(ee,i,Q):Co(i)||Zd(i)?he=$a(ee,0,Q):he=i.map((we,fe)=>{var ge=Math.floor(fe*ne);if(Array.isArray(ee)&&ee[ge]){var Ce=ee[ge];return qg(qg({},we),{},{x:$a(Ce.x,we.x,Q),y:$a(Ce.y,we.y,Q)})}return we}),Q>0&&(a.current=pe,l.current=he),L.createElement(XZ,{points:pe,baseLine:he,needClip:t,clipPathId:n,props:r})}return Q>0&&(a.current=h,l.current=i),L.createElement(ul,null,y&&L.createElement("defs",null,L.createElement("clipPath",{id:"animationClipPath-".concat(n)},L.createElement(o9e,{alpha:Q,points:h,baseLine:i,layout:r.layout,strokeWidth:r.strokeWidth}))),L.createElement(ul,{clipPath:"url(#animationClipPath-".concat(n,")")},L.createElement(XZ,{points:h,baseLine:i,needClip:t,clipPathId:n,props:r})))}),L.createElement(iN,{label:r.label}))}function c9e(e){var{needClip:t,clipPathId:n,props:r}=e,a=L.useRef(null),l=L.useRef();return L.createElement(l9e,{needClip:t,clipPathId:n,props:r,previousPointsRef:a,previousBaselineRef:l})}class u9e extends L.PureComponent{render(){var t,{hide:n,dot:r,points:a,className:l,top:h,left:i,needClip:y,xAxisId:x,yAxisId:w,width:C,height:P,id:E,baseLine:j}=this.props;if(n)return null;var D=ra("recharts-area",l),B=E,{r:F=3,strokeWidth:$=2}=(t=Eo(r,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},H=TI(r),J=F*2+$;return L.createElement(L.Fragment,null,L.createElement(ul,{className:D},y&&L.createElement("defs",null,L.createElement(ZB,{clipPathId:B,xAxisId:x,yAxisId:w}),!H&&L.createElement("clipPath",{id:"clipPath-dots-".concat(B)},L.createElement("rect",{x:i-J/2,y:h-J/2,width:C+J,height:P+J}))),L.createElement(c9e,{needClip:y,clipPathId:B,props:this.props})),L.createElement(zj,{points:a,mainColor:Qk(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}),this.props.isRange&&Array.isArray(j)&&L.createElement(zj,{points:j,mainColor:Qk(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}))}}var Sue={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:!xy.isSsr,legendType:"line",stroke:"#3182bd",xAxisId:0,yAxisId:0};function d9e(e){var t,n=rc(e,Sue),{activeDot:r,animationBegin:a,animationDuration:l,animationEasing:h,connectNulls:i,dot:y,fill:x,fillOpacity:w,hide:C,isAnimationActive:P,legendType:E,stroke:j,xAxisId:D,yAxisId:B}=n,F=wue(n,Z$e),$=W5(),H=Sce(),{needClip:J}=lN(D,B),ee=Pu(),{points:Q,isRange:ne,baseLine:pe}=(t=Si(xe=>H$e(xe,D,B,ee,e.id)))!==null&&t!==void 0?t:{},he=oN();if($!=="horizontal"&&$!=="vertical"||he==null||H!=="AreaChart"&&H!=="ComposedChart")return null;var{height:we,width:fe,x:ge,y:Ce}=he;return!Q||!Q.length?null:L.createElement(u9e,Yg({},F,{activeDot:r,animationBegin:a,animationDuration:l,animationEasing:h,baseLine:pe,connectNulls:i,dot:y,fill:x,fillOpacity:w,height:we,hide:C,layout:$,isAnimationActive:P,isRange:ne,legendType:E,needClip:J,points:Q,stroke:j,width:fe,left:ge,top:Ce,xAxisId:D,yAxisId:B}))}var h9e=(e,t,n,r,a)=>{var l=n??t;if(wi(l))return l;var h=e==="horizontal"?a:r,i=h.scale.domain();if(h.type==="number"){var y=Math.max(i[0],i[1]),x=Math.min(i[0],i[1]);return l==="dataMin"?x:l==="dataMax"||y<0?y:Math.max(Math.min(i[0],i[1]),0)}return l==="dataMin"?i[0]:l==="dataMax"?i[1]:i[0]};function f9e(e){var{areaSettings:{connectNulls:t,baseValue:n,dataKey:r},stackedData:a,layout:l,chartBaseValue:h,xAxis:i,yAxis:y,displayedData:x,dataStartIndex:w,xAxisTicks:C,yAxisTicks:P,bandSize:E}=e,j=a&&a.length,D=h9e(l,h,n,i,y),B=l==="horizontal",F=!1,$=x.map((J,ee)=>{var Q;j?Q=a[w+ee]:(Q=qa(J,r),Array.isArray(Q)?F=!0:Q=[D,Q]);var ne=Q[1]==null||j&&!t&&qa(J,r)==null;return B?{x:Ik({axis:i,ticks:C,bandSize:E,entry:J,index:ee}),y:ne?null:y.scale(Q[1]),value:Q,payload:J}:{x:ne?null:i.scale(Q[1]),y:Ik({axis:y,ticks:P,bandSize:E,entry:J,index:ee}),value:Q,payload:J}}),H;return j||F?H=$.map(J=>{var ee=Array.isArray(J.value)?J.value[0]:null;return B?{x:J.x,y:ee!=null&&J.y!=null?y.scale(ee):null,payload:J.payload}:{x:ee!=null?i.scale(ee):null,y:J.y,payload:J.payload}}):H=B?y.scale(D):i.scale(D),{points:$,baseLine:H,isRange:F}}function p9e(e){var t=rc(e,Sue),n=Pu();return L.createElement(aN,{id:t.id,type:"area"},r=>L.createElement(L.Fragment,null,L.createElement($B,{legendPayload:Q$e(t)}),L.createElement(sN,{fn:e9e,args:t}),L.createElement(qB,{type:"area",id:r,data:t.data,dataKey:t.dataKey,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,stackId:noe(t.stackId),hide:t.hide,barSize:void 0,baseValue:t.baseValue,isPanorama:n,connectNulls:t.connectNulls}),L.createElement(d9e,Yg({},t,{id:r}))))}var jo=L.memo(p9e);jo.displayName="Area";var m9e=["dangerouslySetInnerHTML","ticks"],g9e=["id"],y9e=["domain"],v9e=["domain"];function Vj(){return Vj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Vj.apply(null,arguments)}function e3(e,t){if(e==null)return{};var n,r,a=_9e(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function _9e(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function x9e(e){var t=Al();return L.useEffect(()=>(t(q7e(e)),()=>{t(G7e(e))}),[e,t]),null}var b9e=e=>{var{xAxisId:t,className:n}=e,r=Si(Ez),a=Pu(),l="xAxis",h=Si(E=>Vw(E,l,t,a)),i=Si(E=>nce(E,l,t,a)),y=Si(E=>Jle(E,t)),x=Si(E=>R6e(E,t)),w=Si(E=>kle(E,t));if(y==null||x==null||w==null)return null;var C=e3(e,m9e),P=e3(w,g9e);return L.createElement(JB,Vj({},C,P,{scale:h,x:x.x,y:x.y,width:y.width,height:y.height,className:ra("recharts-".concat(l," ").concat(l),n),viewBox:r,ticks:i}))},w9e={allowDataOverflow:hh.allowDataOverflow,allowDecimals:hh.allowDecimals,allowDuplicatedCategory:hh.allowDuplicatedCategory,height:hh.height,hide:!1,mirror:hh.mirror,orientation:hh.orientation,padding:hh.padding,reversed:hh.reversed,scale:hh.scale,tickCount:hh.tickCount,type:hh.type,xAxisId:0},S9e=e=>{var t,n,r,a,l,h=rc(e,w9e);return L.createElement(L.Fragment,null,L.createElement(x9e,{interval:(t=h.interval)!==null&&t!==void 0?t:"preserveEnd",id:h.xAxisId,scale:h.scale,type:h.type,padding:h.padding,allowDataOverflow:h.allowDataOverflow,domain:h.domain,dataKey:h.dataKey,allowDuplicatedCategory:h.allowDuplicatedCategory,allowDecimals:h.allowDecimals,tickCount:h.tickCount,includeHidden:(n=h.includeHidden)!==null&&n!==void 0?n:!1,reversed:h.reversed,ticks:h.ticks,height:h.height,orientation:h.orientation,mirror:h.mirror,hide:h.hide,unit:h.unit,name:h.name,angle:(r=h.angle)!==null&&r!==void 0?r:0,minTickGap:(a=h.minTickGap)!==null&&a!==void 0?a:5,tick:(l=h.tick)!==null&&l!==void 0?l:!0,tickFormatter:h.tickFormatter}),L.createElement(b9e,h))},A9e=(e,t)=>{var{domain:n}=e,r=e3(e,y9e),{domain:a}=t,l=e3(t,v9e);return gw(r,l)?Array.isArray(n)&&n.length===2&&Array.isArray(a)&&a.length===2?n[0]===a[0]&&n[1]===a[1]:gw({domain:n},{domain:a}):!1},Od=L.memo(S9e,A9e);Od.displayName="XAxis";var T9e=["dangerouslySetInnerHTML","ticks"],C9e=["id"],E9e=["domain"],P9e=["domain"];function $j(){return $j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$j.apply(null,arguments)}function t3(e,t){if(e==null)return{};var n,r,a=k9e(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function k9e(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function I9e(e){var t=Al();return L.useEffect(()=>(t(H7e(e)),()=>{t(W7e(e))}),[e,t]),null}var N9e=e=>{var{yAxisId:t,className:n,width:r,label:a}=e,l=L.useRef(null),h=L.useRef(null),i=Si(Ez),y=Pu(),x=Al(),w="yAxis",C=Si($=>Vw($,w,t,y)),P=Si($=>Qle($,t)),E=Si($=>O6e($,t)),j=Si($=>nce($,w,t,y)),D=Si($=>Ile($,t));if(L.useLayoutEffect(()=>{if(!(r!=="auto"||!P||LB(a)||L.isValidElement(a)||D==null)){var $=l.current;if($){var H=$.getCalculatedWidth();Math.round(P.width)!==Math.round(H)&&x(Z7e({id:t,width:H}))}}},[j,P,x,a,t,r,D]),P==null||E==null||D==null)return null;var B=t3(e,T9e),F=t3(D,C9e);return L.createElement(JB,$j({},B,F,{ref:l,labelRef:h,scale:C,x:E.x,y:E.y,tickTextProps:r==="auto"?{width:void 0}:{width:r},width:P.width,height:P.height,className:ra("recharts-".concat(w," ").concat(w),n),viewBox:i,ticks:j}))},M9e={allowDataOverflow:fh.allowDataOverflow,allowDecimals:fh.allowDecimals,allowDuplicatedCategory:fh.allowDuplicatedCategory,hide:!1,mirror:fh.mirror,orientation:fh.orientation,padding:fh.padding,reversed:fh.reversed,scale:fh.scale,tickCount:fh.tickCount,type:fh.type,width:fh.width,yAxisId:0},L9e=e=>{var t,n,r,a,l,h=rc(e,M9e);return L.createElement(L.Fragment,null,L.createElement(I9e,{interval:(t=h.interval)!==null&&t!==void 0?t:"preserveEnd",id:h.yAxisId,scale:h.scale,type:h.type,domain:h.domain,allowDataOverflow:h.allowDataOverflow,dataKey:h.dataKey,allowDuplicatedCategory:h.allowDuplicatedCategory,allowDecimals:h.allowDecimals,tickCount:h.tickCount,padding:h.padding,includeHidden:(n=h.includeHidden)!==null&&n!==void 0?n:!1,reversed:h.reversed,ticks:h.ticks,width:h.width,orientation:h.orientation,mirror:h.mirror,hide:h.hide,unit:h.unit,name:h.name,angle:(r=h.angle)!==null&&r!==void 0?r:0,minTickGap:(a=h.minTickGap)!==null&&a!==void 0?a:5,tick:(l=h.tick)!==null&&l!==void 0?l:!0,tickFormatter:h.tickFormatter}),L.createElement(N9e,h))},D9e=(e,t)=>{var{domain:n}=e,r=t3(e,E9e),{domain:a}=t,l=t3(t,P9e);return gw(r,l)?Array.isArray(n)&&n.length===2&&Array.isArray(a)&&a.length===2?n[0]===a[0]&&n[1]===a[1]:gw({domain:n},{domain:a}):!1},Fd=L.memo(L9e,D9e);Fd.displayName="YAxis";var R9e={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cT=L;function j9e(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var O9e=typeof Object.is=="function"?Object.is:j9e,F9e=cT.useSyncExternalStore,z9e=cT.useRef,B9e=cT.useEffect,U9e=cT.useMemo,V9e=cT.useDebugValue;R9e.useSyncExternalStoreWithSelector=function(e,t,n,r,a){var l=z9e(null);if(l.current===null){var h={hasValue:!1,value:null};l.current=h}else h=l.current;l=U9e(function(){function y(E){if(!x){if(x=!0,w=E,E=r(E),a!==void 0&&h.hasValue){var j=h.value;if(a(j,E))return C=j}return C=E}if(j=C,O9e(w,E))return j;var D=r(E);return a!==void 0&&a(j,D)?(w=E,j):(w=E,C=D)}var x=!1,w,C,P=n===void 0?null:n;return[function(){return y(t())},P===null?void 0:function(){return y(P())}]},[t,n,r,a]);var i=F9e(e,l[0],l[1]);return B9e(function(){h.hasValue=!0,h.value=i},[i]),V9e(i),i};function $9e(e){e()}function q9e(){let e=null,t=null;return{clear(){e=null,t=null},notify(){$9e(()=>{let n=e;for(;n;)n.callback(),n=n.next})},get(){const n=[];let r=e;for(;r;)n.push(r),r=r.next;return n},subscribe(n){let r=!0;const a=t={callback:n,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!r||e===null||(r=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var JZ={notify(){},get:()=>[]};function G9e(e,t){let n,r=JZ,a=0,l=!1;function h(D){w();const B=r.subscribe(D);let F=!1;return()=>{F||(F=!0,B(),C())}}function i(){r.notify()}function y(){j.onStateChange&&j.onStateChange()}function x(){return l}function w(){a++,n||(n=e.subscribe(y),r=q9e())}function C(){a--,n&&a===0&&(n(),n=void 0,r.clear(),r=JZ)}function P(){l||(l=!0,w())}function E(){l&&(l=!1,C())}const j={addNestedSub:h,notifyNestedSubs:i,handleChangeWrapper:y,isSubscribed:x,trySubscribe:P,tryUnsubscribe:E,getListeners:()=>r};return j}var H9e=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",W9e=H9e(),Z9e=()=>typeof navigator<"u"&&navigator.product==="ReactNative",K9e=Z9e(),Y9e=()=>W9e||K9e?L.useLayoutEffect:L.useEffect,X9e=Y9e(),w4=Symbol.for("react-redux-context"),S4=typeof globalThis<"u"?globalThis:{};function J9e(){if(!L.createContext)return{};const e=S4[w4]??(S4[w4]=new Map);let t=e.get(L.createContext);return t||(t=L.createContext(null),e.set(L.createContext,t)),t}var Q9e=J9e();function eqe(e){const{children:t,context:n,serverState:r,store:a}=e,l=L.useMemo(()=>{const y=G9e(a);return{store:a,subscription:y,getServerState:r?()=>r:void 0}},[a,r]),h=L.useMemo(()=>a.getState(),[a]);X9e(()=>{const{subscription:y}=l;return y.onStateChange=y.notifyNestedSubs,y.trySubscribe(),h!==a.getState()&&y.notifyNestedSubs(),()=>{y.tryUnsubscribe(),y.onStateChange=void 0}},[l,h]);const i=n||Q9e;return L.createElement(i.Provider,{value:l},t)}var tqe=eqe,nqe=(e,t)=>t,e8=_n([nqe,Hs,Cle,sc,yce,Ay,Uze,nc],Hze),t8=e=>{var t=e.currentTarget.getBoundingClientRect(),n=t.width/e.currentTarget.offsetWidth,r=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/n),chartY:Math.round((e.clientY-t.top)/r)}},Aue=wf("mouseClick"),Tue=G5();Tue.startListening({actionCreator:Aue,effect:(e,t)=>{var n=e.payload,r=e8(t.getState(),t8(n));(r==null?void 0:r.activeIndex)!=null&&t.dispatch(Y6e({activeIndex:r.activeIndex,activeDataKey:void 0,activeCoordinate:r.activeCoordinate}))}});var qj=wf("mouseMove"),Cue=G5();Cue.startListening({actionCreator:qj,effect:(e,t)=>{var n=e.payload,r=t.getState(),a=AB(r,r.tooltip.settings.shared),l=e8(r,t8(n));a==="axis"&&((l==null?void 0:l.activeIndex)!=null?t.dispatch(uce({activeIndex:l.activeIndex,activeDataKey:void 0,activeCoordinate:l.activeCoordinate})):t.dispatch(cce()))}});var QZ={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},Eue=Dh({name:"rootProps",initialState:QZ,reducers:{updateOptions:(e,t)=>{var n;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(n=t.payload.barGap)!==null&&n!==void 0?n:QZ.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),rqe=Eue.reducer,{updateOptions:iqe}=Eue.actions,Pue=Dh({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:sqe}=Pue.actions,aqe=Pue.reducer,kue=wf("keyDown"),Iue=wf("focus"),n8=G5();n8.startListening({actionCreator:kue,effect:(e,t)=>{var n=t.getState(),r=n.rootProps.accessibilityLayer!==!1;if(r){var{keyboardInteraction:a}=n.tooltip,l=e.payload;if(!(l!=="ArrowRight"&&l!=="ArrowLeft"&&l!=="Enter")){var h=Number(TB(a,qw(n))),i=Ay(n);if(l==="Enter"){var y=Hk(n,"axis","hover",String(a.index));t.dispatch(Dj({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:y}));return}var x=U6e(n),w=x==="left-to-right"?1:-1,C=l==="ArrowRight"?1:-1,P=h+C*w;if(!(i==null||P>=i.length||P<0)){var E=Hk(n,"axis","hover",String(P));t.dispatch(Dj({active:!0,activeIndex:P.toString(),activeDataKey:void 0,activeCoordinate:E}))}}}}});n8.startListening({actionCreator:Iue,effect:(e,t)=>{var n=t.getState(),r=n.rootProps.accessibilityLayer!==!1;if(r){var{keyboardInteraction:a}=n.tooltip;if(!a.active&&a.index==null){var l="0",h=Hk(n,"axis","hover",String(l));t.dispatch(Dj({activeDataKey:void 0,active:!0,activeIndex:l,activeCoordinate:h}))}}}});var sf=wf("externalEvent"),Nue=G5();Nue.startListening({actionCreator:sf,effect:(e,t)=>{if(e.payload.handler!=null){var n=t.getState(),r={activeCoordinate:Mze(n),activeDataKey:bce(n),activeIndex:gv(n),activeLabel:xce(n),activeTooltipIndex:gv(n),isTooltipActive:Lze(n)};e.payload.handler(r,e.payload.reactEvent)}}});var oqe=_n([$w],e=>e.tooltipItemPayloads),lqe=_n([oqe,sT,(e,t,n)=>t,(e,t,n)=>n],(e,t,n,r)=>{var a=e.find(i=>i.settings.dataKey===r);if(a!=null){var{positions:l}=a;if(l!=null){var h=t(l,n);return h}}}),Mue=wf("touchMove"),Lue=G5();Lue.startListening({actionCreator:Mue,effect:(e,t)=>{var n=e.payload,r=t.getState(),a=AB(r,r.tooltip.settings.shared);if(a==="axis"){var l=e8(r,t8({clientX:n.touches[0].clientX,clientY:n.touches[0].clientY,currentTarget:n.currentTarget}));(l==null?void 0:l.activeIndex)!=null&&t.dispatch(uce({activeIndex:l.activeIndex,activeDataKey:void 0,activeCoordinate:l.activeCoordinate}))}else if(a==="item"){var h,i=n.touches[0],y=document.elementFromPoint(i.clientX,i.clientY);if(!y||!y.getAttribute)return;var x=y.getAttribute(ioe),w=(h=y.getAttribute(soe))!==null&&h!==void 0?h:void 0,C=lqe(t.getState(),x,w);t.dispatch(lce({activeDataKey:w,activeIndex:x,activeCoordinate:C}))}}});var cqe=kae({brush:yVe,cartesianAxis:K7e,chartData:oBe,errorBars:mUe,graphicalItems:p7e,layout:aDe,legend:WDe,options:nBe,polarAxis:L8e,polarOptions:aqe,referenceElements:TVe,rootProps:rqe,tooltip:X6e}),uqe=function(t){return N4e({reducer:cqe,preloadedState:t,middleware:n=>n({serializableCheck:!1}).concat([Tue.middleware,Cue.middleware,n8.middleware,Nue.middleware,Lue.middleware]),devTools:xy.devToolsEnabled})};function Due(e){var{preloadedState:t,children:n,reduxStoreName:r}=e,a=Pu(),l=L.useRef(null);if(a)return n;l.current==null&&(l.current=uqe(t));var h=_z;return L.createElement(tqe,{context:h,store:l.current},n)}function Rue(e){var{layout:t,width:n,height:r,margin:a}=e,l=Al(),h=Pu();return L.useEffect(()=>{h||(l(rDe(t)),l(iDe({width:n,height:r})),l(nDe(a)))},[l,h,t,n,r,a]),null}function jue(e){var t=Al();return L.useEffect(()=>{t(iqe(e))},[t,e]),null}var dqe=["children"];function hqe(e,t){if(e==null)return{};var n,r,a=fqe(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function fqe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function n3(){return n3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n3.apply(null,arguments)}var pqe={width:"100%",height:"100%"},mqe=L.forwardRef((e,t)=>{var n=ooe(),r=loe(),a=hoe();if(!dw(n)||!dw(r))return null;var{children:l,otherAttributes:h,title:i,desc:y}=e,x,w;return typeof h.tabIndex=="number"?x=h.tabIndex:x=a?0:void 0,typeof h.role=="string"?w=h.role:w=a?"application":void 0,L.createElement(Rse,n3({},h,{title:i,desc:y,role:w,tabIndex:x,width:n,height:r,style:pqe,ref:t}),l)}),gqe=e=>{var{children:t}=e,n=Si(BI);if(!n)return null;var{width:r,height:a,y:l,x:h}=n;return L.createElement(Rse,{width:r,height:a,x:h,y:l},t)},eK=L.forwardRef((e,t)=>{var{children:n}=e,r=hqe(e,dqe),a=Pu();return a?L.createElement(gqe,null,n):L.createElement(mqe,n3({ref:t},r),n)});function yqe(){var e=Al(),[t,n]=L.useState(null),r=Si(DDe);return L.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),l=a.width/t.offsetWidth;Kc(l)&&l!==r&&e(sDe(l))}},[t,e,r]),n}function tK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function vqe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?tK(Object(n),!0).forEach(function(r){_qe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tK(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function _qe(e,t,n){return(t=xqe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xqe(e){var t=bqe(e,"string");return typeof t=="symbol"?t:t+""}function bqe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wqe=L.forwardRef((e,t)=>{var{children:n,className:r,height:a,onClick:l,onContextMenu:h,onDoubleClick:i,onMouseDown:y,onMouseEnter:x,onMouseLeave:w,onMouseMove:C,onMouseUp:P,onTouchEnd:E,onTouchMove:j,onTouchStart:D,style:B,width:F}=e,$=Al(),[H,J]=L.useState(null),[ee,Q]=L.useState(null);gBe();var ne=yqe(),pe=L.useCallback(me=>{ne(me),typeof t=="function"&&t(me),J(me),Q(me)},[ne,t,J,Q]),he=L.useCallback(me=>{$(Aue(me)),$(sf({handler:l,reactEvent:me}))},[$,l]),we=L.useCallback(me=>{$(qj(me)),$(sf({handler:x,reactEvent:me}))},[$,x]),fe=L.useCallback(me=>{$(cce()),$(sf({handler:w,reactEvent:me}))},[$,w]),ge=L.useCallback(me=>{$(qj(me)),$(sf({handler:C,reactEvent:me}))},[$,C]),Ce=L.useCallback(()=>{$(Iue())},[$]),xe=L.useCallback(me=>{$(kue(me.key))},[$]),Re=L.useCallback(me=>{$(sf({handler:h,reactEvent:me}))},[$,h]),Qe=L.useCallback(me=>{$(sf({handler:i,reactEvent:me}))},[$,i]),et=L.useCallback(me=>{$(sf({handler:y,reactEvent:me}))},[$,y]),je=L.useCallback(me=>{$(sf({handler:P,reactEvent:me}))},[$,P]),De=L.useCallback(me=>{$(sf({handler:D,reactEvent:me}))},[$,D]),Ct=L.useCallback(me=>{$(Mue(me)),$(sf({handler:j,reactEvent:me}))},[$,j]),xt=L.useCallback(me=>{$(sf({handler:E,reactEvent:me}))},[$,E]);return L.createElement(Pce.Provider,{value:H},L.createElement(jMe.Provider,{value:ee},L.createElement("div",{className:ra("recharts-wrapper",r),style:vqe({position:"relative",cursor:"default",width:F,height:a},B),onClick:he,onContextMenu:Re,onDoubleClick:Qe,onFocus:Ce,onKeyDown:xe,onMouseDown:et,onMouseEnter:we,onMouseLeave:fe,onMouseMove:ge,onMouseUp:je,onTouchEnd:xt,onTouchMove:Ct,onTouchStart:De,ref:pe},n)))}),Sqe=["children","className","width","height","style","compact","title","desc"];function Aqe(e,t){if(e==null)return{};var n,r,a=Tqe(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Tqe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var Oue=L.forwardRef((e,t)=>{var{children:n,className:r,width:a,height:l,style:h,compact:i,title:y,desc:x}=e,w=Aqe(e,Sqe),C=If(w);return i?L.createElement(eK,{otherAttributes:C,title:y,desc:x},n):L.createElement(wqe,{className:r,style:h,width:a,height:l,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},L.createElement(eK,{otherAttributes:C,title:y,desc:x,ref:t},L.createElement(EVe,null,n)))}),Cqe=["width","height"];function Gj(){return Gj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Gj.apply(null,arguments)}function Eqe(e,t){if(e==null)return{};var n,r,a=Pqe(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Pqe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var kqe={top:5,right:5,bottom:5,left:5},Iqe={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:kqe,reverseStackOrder:!1,syncMethod:"index"},uN=L.forwardRef(function(t,n){var r,a=rc(t.categoricalChartProps,Iqe),{width:l,height:h}=a,i=Eqe(a,Cqe);if(!dw(l)||!dw(h))return null;var{chartName:y,defaultTooltipEventType:x,validateTooltipEventTypes:w,tooltipPayloadSearcher:C,categoricalChartProps:P}=t,E={chartName:y,defaultTooltipEventType:x,validateTooltipEventTypes:w,tooltipPayloadSearcher:C,eventEmitter:void 0};return L.createElement(Due,{preloadedState:{options:E},reduxStoreName:(r=P.id)!==null&&r!==void 0?r:y},L.createElement(oue,{chartData:P.data}),L.createElement(Rue,{width:l,height:h,layout:a.layout,margin:a.margin}),L.createElement(jue,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),L.createElement(Oue,Gj({},i,{width:l,height:h,ref:n})))}),Nqe=["axis"],Fue=L.forwardRef((e,t)=>L.createElement(uN,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Nqe,tooltipPayloadSearcher:oT,categoricalChartProps:e,ref:t})),Mqe=["axis","item"],DS=L.forwardRef((e,t)=>L.createElement(uN,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Mqe,tooltipPayloadSearcher:oT,categoricalChartProps:e,ref:t}));function Lqe(e){var t=Al();return L.useEffect(()=>{t(sqe(e))},[t,e]),null}var Dqe=["width","height","layout"];function Hj(){return Hj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Hj.apply(null,arguments)}function Rqe(e,t){if(e==null)return{};var n,r,a=jqe(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function jqe(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var Oqe={top:5,right:5,bottom:5,left:5},Fqe={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Oqe,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},zqe=L.forwardRef(function(t,n){var r,a=rc(t.categoricalChartProps,Fqe),{width:l,height:h,layout:i}=a,y=Rqe(a,Dqe);if(!dw(l)||!dw(h))return null;var{chartName:x,defaultTooltipEventType:w,validateTooltipEventTypes:C,tooltipPayloadSearcher:P}=t,E={chartName:x,defaultTooltipEventType:w,validateTooltipEventTypes:C,tooltipPayloadSearcher:P,eventEmitter:void 0};return L.createElement(Due,{preloadedState:{options:E},reduxStoreName:(r=a.id)!==null&&r!==void 0?r:x},L.createElement(oue,{chartData:a.data}),L.createElement(Rue,{width:l,height:h,layout:i,margin:a.margin}),L.createElement(jue,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),L.createElement(Lqe,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),L.createElement(Oue,Hj({width:l,height:h},y,{ref:n})))}),Bqe=["item"],Uqe={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},zue=L.forwardRef((e,t)=>{var n=rc(e,Uqe);return L.createElement(zqe,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Bqe,tooltipPayloadSearcher:oT,categoricalChartProps:n,ref:t})}),Vqe=["axis"],RS=L.forwardRef((e,t)=>L.createElement(uN,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Vqe,tooltipPayloadSearcher:oT,categoricalChartProps:e,ref:t})),$qe=["axis"],qqe=L.forwardRef((e,t)=>L.createElement(uN,{chartName:"ComposedChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:$qe,tooltipPayloadSearcher:oT,categoricalChartProps:e,ref:t}));const Gqe={light:"",dark:".dark"},Bue=L.createContext(null);function Uue(){const e=L.useContext(Bue);if(!e)throw new Error("useChart must be used within a <ChartContainer />");return e}const Zu=L.forwardRef(({id:e,className:t,children:n,config:r,...a},l)=>{const h=L.useId(),i=`chart-${e||h.replace(/:/g,"")}`;return v.jsx(Bue.Provider,{value:{config:r},children:v.jsxs("div",{"data-chart":i,ref:l,className:Xn("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",t),...a,children:[v.jsx(Hqe,{id:i,config:r}),v.jsx(jce,{children:n})]})})});Zu.displayName="Chart";const Hqe=({id:e,config:t})=>{const n=Object.entries(t).filter(([r,a])=>a.theme||a.color);return n.length?v.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(Gqe).map(([r,a])=>`
${a} [data-chart=${e}] {
${n.map(([l,h])=>{var y;const i=((y=h.theme)==null?void 0:y[r])||h.color;return i?`  --color-${l}: ${i};`:null}).join(`
`)}
}
`).join(`
`)}}):null},Ku=ABe,gh=L.forwardRef(({active:e,payload:t,className:n,indicator:r="dot",hideLabel:a=!1,hideIndicator:l=!1,label:h,labelFormatter:i,labelClassName:y,formatter:x,color:w,nameKey:C,labelKey:P,...E},j)=>{const{config:D}=Uue(),B=L.useMemo(()=>{var Q;if(a||!(t!=null&&t.length))return null;const[$]=t,H=`${P||$.dataKey||$.name||"value"}`,J=Wj(D,$,H),ee=!P&&typeof h=="string"?((Q=D[h])==null?void 0:Q.label)||h:J==null?void 0:J.label;return i?v.jsx("div",{className:Xn("font-medium",y),children:i(ee,t)}):ee?v.jsx("div",{className:Xn("font-medium",y),children:ee}):null},[h,i,t,a,y,D,P]);if(!e||!(t!=null&&t.length))return null;const F=t.length===1&&r!=="dot";return v.jsxs("div",{ref:j,className:Xn("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",n),children:[F?null:B,v.jsx("div",{className:"grid gap-1.5",children:t.map(($,H)=>{const J=`${C||$.name||$.dataKey||"value"}`,ee=Wj(D,$,J),Q=w||$.payload.fill||$.color;return v.jsx("div",{className:Xn("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",r==="dot"&&"items-center"),children:x&&($==null?void 0:$.value)!==void 0&&$.name?x($.value,$.name,$,H,$.payload):v.jsxs(v.Fragment,{children:[ee!=null&&ee.icon?v.jsx(ee.icon,{}):!l&&v.jsx("div",{className:Xn("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":r==="dot","w-1":r==="line","w-0 border-[1.5px] border-dashed bg-transparent":r==="dashed","my-0.5":F&&r==="dashed"}),style:{"--color-bg":Q,"--color-border":Q}}),v.jsxs("div",{className:Xn("flex flex-1 justify-between leading-none",F?"items-end":"items-center"),children:[v.jsxs("div",{className:"grid gap-1.5",children:[F?B:null,v.jsx("span",{className:"text-muted-foreground",children:(ee==null?void 0:ee.label)||$.name})]}),$.value&&v.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:$.value.toLocaleString()})]})]})},$.dataKey)})})]})});gh.displayName="ChartTooltip";const Wqe=L.forwardRef(({className:e,hideIcon:t=!1,payload:n,verticalAlign:r="bottom",nameKey:a,...l},h)=>{const{config:i}=Uue();return n!=null&&n.length?v.jsx("div",{ref:h,className:Xn("flex items-center justify-center gap-4",r==="top"?"pb-3":"pt-3",e),...l,children:n.map(y=>{const x=`${a||y.dataKey||"value"}`,w=Wj(i,y,x);return v.jsxs("div",{className:Xn("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[w!=null&&w.icon&&!t?v.jsx(w.icon,{}):v.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:y.color}}),w==null?void 0:w.label]},y.value)})}):null});Wqe.displayName="ChartLegend";function Wj(e,t,n){if(typeof t!="object"||t===null)return;const r="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let a=n;return n in t&&typeof t[n]=="string"?a=t[n]:r&&n in r&&typeof r[n]=="string"&&(a=r[n]),a in e?e[a]:e[n]}const Qu=e=>{switch(e.toLowerCase()){case"food & dining":case"dining":return"#FF6B6B";case"shopping":return"#4ECDC4";case"transportation":case"transport":return"#45B7D1";case"utilities":return"#96CEB4";case"entertainment":return"#FFEAA7";case"healthcare":return"#DDA0DD";case"education":return"#98D8C8";case"gaming":return"#F7DC6F";case"maintenance":return"#BB8FCE";default:return"#95A5A6"}},Zqe={amount:{label:"Spending",color:Qu("Shopping")}},nK=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"}),Kqe=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);function Yqe(){const{data:e,isLoading:t}=ute(),n=(e==null?void 0:e.spendingTrend)||[];return t?v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsx(di,{children:"30-Day Spending Trend"})}),v.jsx(br,{children:v.jsx(Jl,{className:"h-[200px] w-full"})})]}):v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{className:"pb-4",children:v.jsx(di,{className:"text-lg font-semibold",children:"30-Day Spending Trend"})}),v.jsx(br,{className:"pt-0",children:n.length===0?v.jsx("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-sm",children:"No spending data available"}),v.jsx("p",{className:"text-xs mt-1",children:"Start tracking your expenses to see trends"})]})}):v.jsx("div",{className:"w-full h-[300px]",children:v.jsx(Zu,{config:Zqe,className:"h-full w-full",children:v.jsx(jce,{width:"100%",height:"100%",children:v.jsxs(Fue,{data:n,margin:{top:20,right:30,left:20,bottom:20},children:[v.jsx(uue,{strokeDasharray:"3 3",stroke:"hsl(var(--muted))",opacity:.3}),v.jsx(Od,{dataKey:"date",tick:{fontSize:11,fill:"hsl(var(--muted-foreground))"},tickLine:!1,axisLine:!1,tickFormatter:nK,interval:"preserveStartEnd"}),v.jsx(Fd,{tick:{fontSize:11,fill:"hsl(var(--muted-foreground))"},tickLine:!1,axisLine:!1,tickFormatter:r=>`$${r}`,domain:["dataMin - 10","dataMax + 10"]}),v.jsx(Ku,{content:({active:r,payload:a,label:l})=>r&&a&&a.length?v.jsxs("div",{className:"bg-background border border-border rounded-lg shadow-lg p-4",style:{lineHeight:"1.5"},children:[v.jsx("p",{className:"text-sm font-semibold text-foreground mb-1",style:{fontSize:"14px",fontWeight:"600"},children:nK(l)}),v.jsx("p",{className:"text-sm text-primary font-medium",style:{fontSize:"14px"},children:Kqe(a[0].value)})]}):null,animationDuration:0,isAnimationActive:!1,cursor:{stroke:"hsl(var(--primary))",strokeWidth:1,strokeDasharray:"3 3"}}),v.jsx(cN,{type:"monotone",dataKey:"amount",stroke:"hsl(var(--primary))",strokeWidth:2.5,dot:{fill:"hsl(var(--primary))",strokeWidth:2,r:3,stroke:"hsl(var(--background))"},activeDot:{r:5,strokeWidth:2,stroke:"hsl(var(--primary))",fill:"hsl(var(--background))"},connectNulls:!1})]})})})})})]})}function Xqe(){const e=qF(),{addNotification:t}=E5(),{showBlockingNotification:n}=yy(),h=[{label:"Add Spending Cap",icon:Wd,variant:"default",onClick:()=>e("/caps")},{label:"View Map",icon:R3,variant:"outline",onClick:()=>e("/map")},{label:"Simulate Transaction",icon:w5,variant:"outline",onClick:()=>e("/transactions")},{label:"View Analytics",icon:Kb,variant:"outline",onClick:()=>e("/analytics")},{label:"Demo Notification",icon:lv,variant:"outline",onClick:()=>{t({type:"info",title:" Welcome to VT Hacks Demo!",message:"You've arrived at Owens Ballroom! This is where the MoneyLens demo is taking place. Check out the smart financial features!",category:"system",actionUrl:"/bodyguard"})}},{label:"Test High Risk",icon:Os,variant:"destructive",onClick:()=>{n({title:" High Risk Location Detected!",message:"You've entered a high-risk spending zone! MoneyLens has detected unusual financial activity in this area. This location has been flagged for potential overspending risks.",severity:"critical",onConfirm:()=>{console.log("User confirmed to proceed with caution in high-risk area"),t({type:"success",title:"Proceeding with Enhanced Monitoring",message:"MoneyLens will closely monitor your spending in this area.",category:"system"})},onDismiss:()=>{console.log("User chose to avoid the high-risk area"),t({type:"info",title:"Smart Choice!",message:"Avoiding high-risk spending area.",category:"system"})},confirmText:"Proceed with Caution",dismissText:"Turn Back",showDismiss:!0})}},{label:"Spending Alert",icon:lv,variant:"outline",onClick:()=>{n({title:" Spending Alert Demo",message:"This is a demonstration of the blocking spending alert system. It prevents app interaction until you take action, helping you make informed financial decisions.",severity:"warning",onConfirm:()=>{console.log("User confirmed spending alert"),t({type:"success",title:"Spending Alert Confirmed",message:"You've successfully interacted with the spending alert system.",category:"system"})},onDismiss:()=>{console.log("User dismissed spending alert"),t({type:"info",title:"Spending Alert Dismissed",message:"You've dismissed the spending alert.",category:"system"})},confirmText:"Continue",dismissText:"Cancel",showDismiss:!0})}}];return v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(Yb,{className:"w-5 h-5"}),"Quick Actions"]})}),v.jsx(br,{children:v.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:h.map(i=>{const y=i.icon;return v.jsxs($n,{variant:i.variant,className:"h-auto p-3 sm:p-4 flex flex-col items-center gap-2 text-center min-h-[80px] sm:min-h-[90px]",onClick:i.onClick,children:[v.jsx(y,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),v.jsx("span",{className:"text-xs font-medium leading-tight",children:i.label})]},i.label)})})})]})}function Jqe({monthlyBudget:e,totalSpent:t}){const n=e-t,r=t/e*100,a=t>e;return v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(Tu,{className:"w-5 h-5"}),"Budget Status"]})}),v.jsxs(br,{className:"space-y-4",children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("span",{className:"text-sm text-muted-foreground",children:"Monthly Budget"}),v.jsxs("span",{className:"font-semibold",children:["$",e.toLocaleString()]})]}),v.jsx("div",{className:"w-full bg-muted rounded-full h-3",children:v.jsx("div",{className:`h-3 rounded-full transition-all duration-300 ${a?"bg-red-500":r>80?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(r,100)}%`,maxWidth:"100%"}})}),v.jsxs("div",{className:"flex justify-between text-sm",children:[v.jsxs("span",{className:`font-medium ${a?"text-red-500":"text-muted-foreground"}`,children:["$",t.toLocaleString()," spent"]}),v.jsx("span",{className:`font-medium ${n<0?"text-red-500":"text-muted-foreground"}`,children:n<0?`$${Math.abs(n).toLocaleString()} over budget`:`$${n.toLocaleString()} remaining`})]}),a&&v.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[v.jsx(Os,{className:"w-4 h-4 text-red-500"}),v.jsxs("span",{className:"text-sm text-red-700 font-medium",children:["Budget exceeded by $",Math.abs(n).toLocaleString()]})]})]})]})}function Qqe(){const e=[{id:1,type:"warning",title:"High Dining Spending",message:"You've spent 150% more on dining this month",icon:Os,color:"text-orange-500",bgColor:"bg-orange-900/20",borderColor:"border-orange-500/30"},{id:2,type:"success",title:"Transportation Under Budget",message:"You're $85 under your transportation budget",icon:SF,color:"text-green-500",bgColor:"bg-green-900/20",borderColor:"border-green-500/30"}];return v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(Os,{className:"w-5 h-5 text-yellow-500"}),"Smart Alerts"]})}),v.jsx(br,{className:"space-y-3",children:e.map(t=>{const n=t.icon;return v.jsx("div",{className:`p-4 rounded-lg border ${t.bgColor} ${t.borderColor}`,children:v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx(n,{className:`w-5 h-5 ${t.color} mt-0.5 flex-shrink-0`}),v.jsxs("div",{className:"flex-1",children:[v.jsx("h4",{className:`font-semibold text-sm ${t.color} mb-1`,children:t.title}),v.jsx("p",{className:"text-sm text-muted-foreground",children:t.message})]})]})},t.id)})})]})}const eGe=()=>{const{addNotification:e}=E5(),{showBlockingNotification:t}=yy(),[n,r]=L.useState(!1),a=[{id:"owens_ballroom",title:" Welcome to VT Hacks Demo!",message:"You've arrived at Owens Ballroom! This is where the MoneyLens demo is taking place. Check out the smart financial features!",type:"info",location:"Owens Ballroom, 150 Kent St, Blacksburg, VA",coordinates:{lat:37.22767,lng:-80.41794}},{id:"squires_center",title:" Near Squires Student Center",message:"You're near a popular student area. This location typically has high spending activity.",type:"warning",location:"Squires Student Center, Blacksburg, VA",coordinates:{lat:37.2295,lng:-80.42}},{id:"downtown_blacksburg",title:" Downtown Blacksburg - High Spending Zone",message:"You've entered downtown Blacksburg, a high-spending area with many restaurants and shops.",type:"error",location:"Downtown Blacksburg, VA",coordinates:{lat:37.229,lng:-80.41}},{id:"proximity_alert",title:" Approaching VT Hacks Demo!",message:"You're getting close to the MoneyLens demo at Owens Ballroom. Just a few more steps!",type:"info",location:"Approaching Owens Ballroom",coordinates:{lat:37.22767,lng:-80.41794}},{id:"current_location_high_risk",title:" High Risk Location Detected!",message:"You've entered a high-risk spending zone! MoneyLens has detected unusual financial activity in this area.",type:"error",location:"Current Location - High Risk Zone",coordinates:{lat:37.2521,lng:-80.4097}}],l=y=>{if(y.id==="current_location_high_risk"||y.id==="downtown_blacksburg"||y.type==="error"&&y.title.includes("High Risk")){let x="critical",w="Proceed with Caution",C="Turn Back";y.id==="downtown_blacksburg"&&(x="high",w="Set Spending Limit",C="Avoid Area"),t({title:y.title,message:y.message+`

Location: ${y.location}`,severity:x,onConfirm:()=>{console.log("User confirmed to proceed in high-risk area"),e({type:"success",title:"Proceeding with Enhanced Monitoring",message:"MoneyLens will closely monitor your spending in this area.",category:"system"})},onDismiss:()=>{console.log("User chose to avoid the high-risk area"),e({type:"info",title:"Smart Choice!",message:"Avoiding high-risk spending area.",category:"system"})},confirmText:w,dismissText:C,showDismiss:!0})}else e({type:y.type,title:y.title,message:y.message,category:"system",actionUrl:"/bodyguard"})},h=()=>{r(!0),l(a[0]),setTimeout(()=>{l(a[3])},2e3),setTimeout(()=>{l(a[1])},5e3),setTimeout(()=>{l(a[2])},8e3)},i=()=>{r(!1)};return v.jsxs(xr,{className:"w-full max-w-2xl mx-auto",children:[v.jsxs(ui,{children:[v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(lv,{className:"w-5 h-5"}),"VT Hacks Demo - Geolocation Notifications"]}),v.jsx(cy,{children:"Simulate location-based financial notifications for the MoneyLens demo"})]}),v.jsxs(br,{className:"space-y-4",children:[v.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted rounded-lg",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:`w-3 h-3 rounded-full ${n?"bg-green-500":"bg-gray-400"}`}),v.jsx("span",{className:"font-medium",children:n?"Demo Active":"Demo Inactive"})]}),v.jsx(Is,{variant:n?"default":"secondary",children:n?"Running":"Stopped"})]}),v.jsx("div",{className:"flex gap-2",children:n?v.jsxs($n,{onClick:i,variant:"outline",className:"flex-1",children:[v.jsx(BP,{className:"w-4 h-4 mr-2"}),"Stop Demo"]}):v.jsxs($n,{onClick:h,className:"flex-1",children:[v.jsx(cx,{className:"w-4 h-4 mr-2"}),"Start Demo Sequence"]})}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"Individual Notifications:"}),v.jsx("div",{className:"grid grid-cols-1 gap-2",children:a.map(y=>v.jsxs($n,{variant:"outline",size:"sm",onClick:()=>l(y),className:"justify-start h-auto p-3",children:[v.jsx(od,{className:"w-4 h-4 mr-2 flex-shrink-0"}),v.jsxs("div",{className:"text-left flex-1",children:[v.jsx("div",{className:"font-medium text-sm",children:y.title}),v.jsx("div",{className:"text-xs text-muted-foreground truncate",children:y.location})]})]},y.id))})]}),v.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[v.jsx("h4",{className:"font-medium text-sm text-blue-900 mb-2",children:"Demo Instructions:"}),v.jsxs("ol",{className:"text-sm text-blue-800 space-y-1",children:[v.jsx("li",{children:'1. Click "Start Demo Sequence" to trigger a realistic notification flow'}),v.jsx("li",{children:"2. Or click individual notification buttons to test specific scenarios"}),v.jsxs("li",{children:["3. ",v.jsx("strong",{children:"High-risk notifications"}),' (like "High Risk Location" or "Downtown Blacksburg") will show ',v.jsx("strong",{children:"blocking spending alerts"})]}),v.jsx("li",{children:"4. Regular notifications appear as toast messages and in the notification dropdown"}),v.jsx("li",{children:"5. The main demo notification simulates arriving at Owens Ballroom"})]})]})]})]})},tGe=e=>{const[t,n]=L.useState(1);return L.useEffect(()=>{const r=()=>{if(!e.current)return;const h=e.current.offsetWidth;let i;h<400?i=Math.max(.2,h/800):h<600?i=Math.max(.3,h/1e3):i=Math.max(.4,h/1200),n(i)};r();const a=new ResizeObserver(r);return e.current&&a.observe(e.current),window.addEventListener("resize",r),()=>{a.disconnect(),window.removeEventListener("resize",r)}},[e]),t};function nGe(){const{data:e,isLoading:t,error:n}=ute(),r=L.useRef(null),a=tGe(r),l={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.1}}},h={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}};if(t)return v.jsxs("div",{className:"space-y-8",children:[v.jsxs("div",{className:"hero-gradient rounded-xl p-8 text-center",children:[v.jsx(Jl,{className:"h-8 w-64 mx-auto mb-2"}),v.jsx(Jl,{className:"h-6 w-96 mx-auto"})]}),v.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((y,x)=>v.jsx("div",{className:"card-gradient p-6 rounded-lg",children:v.jsx(Jl,{className:"h-20 w-full"})},x))})]});if(n)return v.jsx("div",{className:"space-y-8",children:v.jsxs("div",{className:"hero-gradient rounded-xl p-8 text-center",children:[v.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Welcome back to MoneyLens"}),v.jsx("p",{className:"text-lg opacity-90",children:"Unable to load dashboard data. Please try again later."})]})});const i=e||{totalSpent:0,monthlyBudget:3500,budgetRemaining:3500,activeCaps:0,lockedCards:0,topCategory:"None",recentTransactions:[],spendingTrend:[]};return v.jsxs(ol.div,{className:"h-full min-h-screen space-y-4 sm:space-y-6",variants:l,initial:"hidden",animate:"visible",children:[v.jsxs(ol.div,{className:"hero-gradient rounded-xl p-6 sm:p-8 text-center",variants:h,children:[v.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-2",children:"Welcome back to MoneyLens"}),v.jsx("p",{className:"text-base sm:text-lg opacity-90",children:"Track your financial journey with intelligent insights"})]}),v.jsx(ol.div,{ref:r,className:"overflow-x-auto stats-grid-scroll relative",variants:h,style:{fontSize:`${a}rem`},children:v.jsxs("div",{className:"@container grid grid-cols-1 xs:grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-3 xs:gap-4 lg:gap-6 w-full",children:[v.jsx("div",{className:"w-full",children:v.jsx(nE,{title:"Total Spent This Month",value:`$${i.totalSpent.toLocaleString()}`,change:`${(i.totalSpent/i.monthlyBudget*100).toFixed(0)}% of budget`,changeType:i.totalSpent>i.monthlyBudget?"negative":"positive",icon:v.jsx(Tu,{className:"w-6 h-6"}),variant:"primary"})}),v.jsx("div",{className:"w-full",children:v.jsx(nE,{title:"Active Spending Caps",value:i.activeCaps.toString(),change:"Active limits",changeType:"positive",icon:v.jsx(Wd,{className:"w-6 h-6"}),variant:"default"})}),v.jsx("div",{className:"w-full",children:v.jsx(nE,{title:"Locked Cards",value:i.lockedCards.toString(),change:"All active",changeType:"positive",icon:v.jsx(wl,{className:"w-6 h-6"}),variant:"primary"})}),v.jsx("div",{className:"w-full",children:v.jsx(nE,{title:"Top Category",value:i.topCategory,change:"This month",changeType:"neutral",icon:v.jsx(Ju,{className:"w-6 h-6"}),variant:"default"})})]})}),v.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[v.jsxs(ol.div,{className:"xl:col-span-2 space-y-6",variants:h,children:[v.jsx(Yqe,{}),v.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[v.jsx(Jqe,{monthlyBudget:i.monthlyBudget,totalSpent:i.totalSpent}),v.jsx(Qqe,{})]}),v.jsx(_Me,{})]}),v.jsxs(ol.div,{className:"space-y-6",variants:h,children:[v.jsx(Xqe,{}),v.jsx(eGe,{})]})]})]})}function Vue(e){const t=L.useRef({value:e,previous:e});return L.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var rGe=[" ","Enter","ArrowUp","ArrowDown"],iGe=[" ","Enter"],wx="Select",[dN,hN,sGe]=I3(wx),[Gw,WXe]=dd(wx,[sGe,Pw]),fN=Pw(),[aGe,Lv]=Gw(wx),[oGe,lGe]=Gw(wx),$ue=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:a,onOpenChange:l,value:h,defaultValue:i,onValueChange:y,dir:x,name:w,autoComplete:C,disabled:P,required:E,form:j}=e,D=fN(t),[B,F]=L.useState(null),[$,H]=L.useState(null),[J,ee]=L.useState(!1),Q=M5(x),[ne,pe]=ny({prop:r,defaultProp:a??!1,onChange:l,caller:wx}),[he,we]=ny({prop:h,defaultProp:i,onChange:y,caller:wx}),fe=L.useRef(null),ge=B?j||!!B.closest("form"):!0,[Ce,xe]=L.useState(new Set),Re=Array.from(Ce).map(Qe=>Qe.props.value).join(";");return v.jsx(RF,{...D,children:v.jsxs(aGe,{required:E,scope:t,trigger:B,onTriggerChange:F,valueNode:$,onValueNodeChange:H,valueNodeHasChildren:J,onValueNodeHasChildrenChange:ee,contentId:bp(),value:he,onValueChange:we,open:ne,onOpenChange:pe,dir:Q,triggerPointerDownPosRef:fe,disabled:P,children:[v.jsx(dN.Provider,{scope:t,children:v.jsx(oGe,{scope:e.__scopeSelect,onNativeOptionAdd:L.useCallback(Qe=>{xe(et=>new Set(et).add(Qe))},[]),onNativeOptionRemove:L.useCallback(Qe=>{xe(et=>{const je=new Set(et);return je.delete(Qe),je})},[]),children:n})}),ge?v.jsxs(fde,{"aria-hidden":!0,required:E,tabIndex:-1,name:w,autoComplete:C,value:he,onChange:Qe=>we(Qe.target.value),disabled:P,form:j,children:[he===void 0?v.jsx("option",{value:""}):null,Array.from(Ce)]},Re):null]})})};$ue.displayName=wx;var que="SelectTrigger",Gue=L.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...a}=e,l=fN(n),h=Lv(que,n),i=h.disabled||r,y=_s(t,h.onTriggerChange),x=hN(n),w=L.useRef("touch"),[C,P,E]=mde(D=>{const B=x().filter(H=>!H.disabled),F=B.find(H=>H.value===h.value),$=gde(B,D,F);$!==void 0&&h.onValueChange($.value)}),j=D=>{i||(h.onOpenChange(!0),E()),D&&(h.triggerPointerDownPosRef.current={x:Math.round(D.pageX),y:Math.round(D.pageY)})};return v.jsx(jF,{asChild:!0,...l,children:v.jsx(Ei.button,{type:"button",role:"combobox","aria-controls":h.contentId,"aria-expanded":h.open,"aria-required":h.required,"aria-autocomplete":"none",dir:h.dir,"data-state":h.open?"open":"closed",disabled:i,"data-disabled":i?"":void 0,"data-placeholder":pde(h.value)?"":void 0,...a,ref:y,onClick:Sr(a.onClick,D=>{D.currentTarget.focus(),w.current!=="mouse"&&j(D)}),onPointerDown:Sr(a.onPointerDown,D=>{w.current=D.pointerType;const B=D.target;B.hasPointerCapture(D.pointerId)&&B.releasePointerCapture(D.pointerId),D.button===0&&D.ctrlKey===!1&&D.pointerType==="mouse"&&(j(D),D.preventDefault())}),onKeyDown:Sr(a.onKeyDown,D=>{const B=C.current!=="";!(D.ctrlKey||D.altKey||D.metaKey)&&D.key.length===1&&P(D.key),!(B&&D.key===" ")&&rGe.includes(D.key)&&(j(),D.preventDefault())})})})});Gue.displayName=que;var Hue="SelectValue",Wue=L.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,children:l,placeholder:h="",...i}=e,y=Lv(Hue,n),{onValueNodeHasChildrenChange:x}=y,w=l!==void 0,C=_s(t,y.onValueNodeChange);return Sl(()=>{x(w)},[x,w]),v.jsx(Ei.span,{...i,ref:C,style:{pointerEvents:"none"},children:pde(y.value)?v.jsx(v.Fragment,{children:h}):l})});Wue.displayName=Hue;var cGe="SelectIcon",Zue=L.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...a}=e;return v.jsx(Ei.span,{"aria-hidden":!0,...a,ref:t,children:r||""})});Zue.displayName=cGe;var uGe="SelectPortal",Kue=e=>v.jsx(x5,{asChild:!0,...e});Kue.displayName=uGe;var Sx="SelectContent",Yue=L.forwardRef((e,t)=>{const n=Lv(Sx,e.__scopeSelect),[r,a]=L.useState();if(Sl(()=>{a(new DocumentFragment)},[]),!n.open){const l=r;return l?Sv.createPortal(v.jsx(Xue,{scope:e.__scopeSelect,children:v.jsx(dN.Slot,{scope:e.__scopeSelect,children:v.jsx("div",{children:e.children})})}),l):null}return v.jsx(Jue,{...e,ref:t})});Yue.displayName=Sx;var cp=10,[Xue,Dv]=Gw(Sx),dGe="SelectContentImpl",hGe=lx("SelectContent.RemoveScroll"),Jue=L.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:l,onPointerDownOutside:h,side:i,sideOffset:y,align:x,alignOffset:w,arrowPadding:C,collisionBoundary:P,collisionPadding:E,sticky:j,hideWhenDetached:D,avoidCollisions:B,...F}=e,$=Lv(Sx,n),[H,J]=L.useState(null),[ee,Q]=L.useState(null),ne=_s(t,dt=>J(dt)),[pe,he]=L.useState(null),[we,fe]=L.useState(null),ge=hN(n),[Ce,xe]=L.useState(!1),Re=L.useRef(!1);L.useEffect(()=>{if(H)return D6(H)},[H]),L6();const Qe=L.useCallback(dt=>{const[At,...mt]=ge().map(Ot=>Ot.ref.current),[Pt]=mt.slice(-1),Ht=document.activeElement;for(const Ot of dt)if(Ot===Ht||(Ot==null||Ot.scrollIntoView({block:"nearest"}),Ot===At&&ee&&(ee.scrollTop=0),Ot===Pt&&ee&&(ee.scrollTop=ee.scrollHeight),Ot==null||Ot.focus(),document.activeElement!==Ht))return},[ge,ee]),et=L.useCallback(()=>Qe([pe,H]),[Qe,pe,H]);L.useEffect(()=>{Ce&&et()},[Ce,et]);const{onOpenChange:je,triggerPointerDownPosRef:De}=$;L.useEffect(()=>{if(H){let dt={x:0,y:0};const At=Pt=>{var Ht,Ot;dt={x:Math.abs(Math.round(Pt.pageX)-(((Ht=De.current)==null?void 0:Ht.x)??0)),y:Math.abs(Math.round(Pt.pageY)-(((Ot=De.current)==null?void 0:Ot.y)??0))}},mt=Pt=>{dt.x<=10&&dt.y<=10?Pt.preventDefault():H.contains(Pt.target)||je(!1),document.removeEventListener("pointermove",At),De.current=null};return De.current!==null&&(document.addEventListener("pointermove",At),document.addEventListener("pointerup",mt,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",At),document.removeEventListener("pointerup",mt,{capture:!0})}}},[H,je,De]),L.useEffect(()=>{const dt=()=>je(!1);return window.addEventListener("blur",dt),window.addEventListener("resize",dt),()=>{window.removeEventListener("blur",dt),window.removeEventListener("resize",dt)}},[je]);const[Ct,xt]=mde(dt=>{const At=ge().filter(Ht=>!Ht.disabled),mt=At.find(Ht=>Ht.ref.current===document.activeElement),Pt=gde(At,dt,mt);Pt&&setTimeout(()=>Pt.ref.current.focus())}),me=L.useCallback((dt,At,mt)=>{const Pt=!Re.current&&!mt;($.value!==void 0&&$.value===At||Pt)&&(he(dt),Pt&&(Re.current=!0))},[$.value]),Ye=L.useCallback(()=>H==null?void 0:H.focus(),[H]),nt=L.useCallback((dt,At,mt)=>{const Pt=!Re.current&&!mt;($.value!==void 0&&$.value===At||Pt)&&fe(dt)},[$.value]),vt=r==="popper"?Zj:Que,gt=vt===Zj?{side:i,sideOffset:y,align:x,alignOffset:w,arrowPadding:C,collisionBoundary:P,collisionPadding:E,sticky:j,hideWhenDetached:D,avoidCollisions:B}:{};return v.jsx(Xue,{scope:n,content:H,viewport:ee,onViewportChange:Q,itemRefCallback:me,selectedItem:pe,onItemLeave:Ye,itemTextRefCallback:nt,focusSelectedItem:et,selectedItemText:we,position:r,isPositioned:Ce,searchRef:Ct,children:v.jsx(iI,{as:hGe,allowPinchZoom:!0,children:v.jsx(nI,{asChild:!0,trapped:$.open,onMountAutoFocus:dt=>{dt.preventDefault()},onUnmountAutoFocus:Sr(a,dt=>{var At;(At=$.trigger)==null||At.focus({preventScroll:!0}),dt.preventDefault()}),children:v.jsx(Aw,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:l,onPointerDownOutside:h,onFocusOutside:dt=>dt.preventDefault(),onDismiss:()=>$.onOpenChange(!1),children:v.jsx(vt,{role:"listbox",id:$.contentId,"data-state":$.open?"open":"closed",dir:$.dir,onContextMenu:dt=>dt.preventDefault(),...F,...gt,onPlaced:()=>xe(!0),ref:ne,style:{display:"flex",flexDirection:"column",outline:"none",...F.style},onKeyDown:Sr(F.onKeyDown,dt=>{const At=dt.ctrlKey||dt.altKey||dt.metaKey;if(dt.key==="Tab"&&dt.preventDefault(),!At&&dt.key.length===1&&xt(dt.key),["ArrowUp","ArrowDown","Home","End"].includes(dt.key)){let Pt=ge().filter(Ht=>!Ht.disabled).map(Ht=>Ht.ref.current);if(["ArrowUp","End"].includes(dt.key)&&(Pt=Pt.slice().reverse()),["ArrowUp","ArrowDown"].includes(dt.key)){const Ht=dt.target,Ot=Pt.indexOf(Ht);Pt=Pt.slice(Ot+1)}setTimeout(()=>Qe(Pt)),dt.preventDefault()}})})})})})})});Jue.displayName=dGe;var fGe="SelectItemAlignedPosition",Que=L.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...a}=e,l=Lv(Sx,n),h=Dv(Sx,n),[i,y]=L.useState(null),[x,w]=L.useState(null),C=_s(t,ne=>w(ne)),P=hN(n),E=L.useRef(!1),j=L.useRef(!0),{viewport:D,selectedItem:B,selectedItemText:F,focusSelectedItem:$}=h,H=L.useCallback(()=>{if(l.trigger&&l.valueNode&&i&&x&&D&&B&&F){const ne=l.trigger.getBoundingClientRect(),pe=x.getBoundingClientRect(),he=l.valueNode.getBoundingClientRect(),we=F.getBoundingClientRect();if(l.dir!=="rtl"){const Ht=we.left-pe.left,Ot=he.left-Ht,Un=ne.left-Ot,Kt=ne.width+Un,st=Math.max(Kt,pe.width),Dr=window.innerWidth-cp,Or=tj(Ot,[cp,Math.max(cp,Dr-st)]);i.style.minWidth=Kt+"px",i.style.left=Or+"px"}else{const Ht=pe.right-we.right,Ot=window.innerWidth-he.right-Ht,Un=window.innerWidth-ne.right-Ot,Kt=ne.width+Un,st=Math.max(Kt,pe.width),Dr=window.innerWidth-cp,Or=tj(Ot,[cp,Math.max(cp,Dr-st)]);i.style.minWidth=Kt+"px",i.style.right=Or+"px"}const fe=P(),ge=window.innerHeight-cp*2,Ce=D.scrollHeight,xe=window.getComputedStyle(x),Re=parseInt(xe.borderTopWidth,10),Qe=parseInt(xe.paddingTop,10),et=parseInt(xe.borderBottomWidth,10),je=parseInt(xe.paddingBottom,10),De=Re+Qe+Ce+je+et,Ct=Math.min(B.offsetHeight*5,De),xt=window.getComputedStyle(D),me=parseInt(xt.paddingTop,10),Ye=parseInt(xt.paddingBottom,10),nt=ne.top+ne.height/2-cp,vt=ge-nt,gt=B.offsetHeight/2,dt=B.offsetTop+gt,At=Re+Qe+dt,mt=De-At;if(At<=nt){const Ht=fe.length>0&&B===fe[fe.length-1].ref.current;i.style.bottom="0px";const Ot=x.clientHeight-D.offsetTop-D.offsetHeight,Un=Math.max(vt,gt+(Ht?Ye:0)+Ot+et),Kt=At+Un;i.style.height=Kt+"px"}else{const Ht=fe.length>0&&B===fe[0].ref.current;i.style.top="0px";const Un=Math.max(nt,Re+D.offsetTop+(Ht?me:0)+gt)+mt;i.style.height=Un+"px",D.scrollTop=At-nt+D.offsetTop}i.style.margin=`${cp}px 0`,i.style.minHeight=Ct+"px",i.style.maxHeight=ge+"px",r==null||r(),requestAnimationFrame(()=>E.current=!0)}},[P,l.trigger,l.valueNode,i,x,D,B,F,l.dir,r]);Sl(()=>H(),[H]);const[J,ee]=L.useState();Sl(()=>{x&&ee(window.getComputedStyle(x).zIndex)},[x]);const Q=L.useCallback(ne=>{ne&&j.current===!0&&(H(),$==null||$(),j.current=!1)},[H,$]);return v.jsx(mGe,{scope:n,contentWrapper:i,shouldExpandOnScrollRef:E,onScrollButtonChange:Q,children:v.jsx("div",{ref:y,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:J},children:v.jsx(Ei.div,{...a,ref:C,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});Que.displayName=fGe;var pGe="SelectPopperPosition",Zj=L.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:a=cp,...l}=e,h=fN(n);return v.jsx(OF,{...h,...l,ref:t,align:r,collisionPadding:a,style:{boxSizing:"border-box",...l.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Zj.displayName=pGe;var[mGe,r8]=Gw(Sx,{}),Kj="SelectViewport",ede=L.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...a}=e,l=Dv(Kj,n),h=r8(Kj,n),i=_s(t,l.onViewportChange),y=L.useRef(0);return v.jsxs(v.Fragment,{children:[v.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),v.jsx(dN.Slot,{scope:n,children:v.jsx(Ei.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:i,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:Sr(a.onScroll,x=>{const w=x.currentTarget,{contentWrapper:C,shouldExpandOnScrollRef:P}=h;if(P!=null&&P.current&&C){const E=Math.abs(y.current-w.scrollTop);if(E>0){const j=window.innerHeight-cp*2,D=parseFloat(C.style.minHeight),B=parseFloat(C.style.height),F=Math.max(D,B);if(F<j){const $=F+E,H=Math.min(j,$),J=$-H;C.style.height=H+"px",C.style.bottom==="0px"&&(w.scrollTop=J>0?J:0,C.style.justifyContent="flex-end")}}}y.current=w.scrollTop})})})]})});ede.displayName=Kj;var tde="SelectGroup",[gGe,yGe]=Gw(tde),vGe=L.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=bp();return v.jsx(gGe,{scope:n,id:a,children:v.jsx(Ei.div,{role:"group","aria-labelledby":a,...r,ref:t})})});vGe.displayName=tde;var nde="SelectLabel",rde=L.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=yGe(nde,n);return v.jsx(Ei.div,{id:a.id,...r,ref:t})});rde.displayName=nde;var r3="SelectItem",[_Ge,ide]=Gw(r3),sde=L.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:a=!1,textValue:l,...h}=e,i=Lv(r3,n),y=Dv(r3,n),x=i.value===r,[w,C]=L.useState(l??""),[P,E]=L.useState(!1),j=_s(t,$=>{var H;return(H=y.itemRefCallback)==null?void 0:H.call(y,$,r,a)}),D=bp(),B=L.useRef("touch"),F=()=>{a||(i.onValueChange(r),i.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return v.jsx(_Ge,{scope:n,value:r,disabled:a,textId:D,isSelected:x,onItemTextChange:L.useCallback($=>{C(H=>H||(($==null?void 0:$.textContent)??"").trim())},[]),children:v.jsx(dN.ItemSlot,{scope:n,value:r,disabled:a,textValue:w,children:v.jsx(Ei.div,{role:"option","aria-labelledby":D,"data-highlighted":P?"":void 0,"aria-selected":x&&P,"data-state":x?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...h,ref:j,onFocus:Sr(h.onFocus,()=>E(!0)),onBlur:Sr(h.onBlur,()=>E(!1)),onClick:Sr(h.onClick,()=>{B.current!=="mouse"&&F()}),onPointerUp:Sr(h.onPointerUp,()=>{B.current==="mouse"&&F()}),onPointerDown:Sr(h.onPointerDown,$=>{B.current=$.pointerType}),onPointerMove:Sr(h.onPointerMove,$=>{var H;B.current=$.pointerType,a?(H=y.onItemLeave)==null||H.call(y):B.current==="mouse"&&$.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Sr(h.onPointerLeave,$=>{var H;$.currentTarget===document.activeElement&&((H=y.onItemLeave)==null||H.call(y))}),onKeyDown:Sr(h.onKeyDown,$=>{var J;((J=y.searchRef)==null?void 0:J.current)!==""&&$.key===" "||(iGe.includes($.key)&&F(),$.key===" "&&$.preventDefault())})})})})});sde.displayName=r3;var jS="SelectItemText",ade=L.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,...l}=e,h=Lv(jS,n),i=Dv(jS,n),y=ide(jS,n),x=lGe(jS,n),[w,C]=L.useState(null),P=_s(t,F=>C(F),y.onItemTextChange,F=>{var $;return($=i.itemTextRefCallback)==null?void 0:$.call(i,F,y.value,y.disabled)}),E=w==null?void 0:w.textContent,j=L.useMemo(()=>v.jsx("option",{value:y.value,disabled:y.disabled,children:E},y.value),[y.disabled,y.value,E]),{onNativeOptionAdd:D,onNativeOptionRemove:B}=x;return Sl(()=>(D(j),()=>B(j)),[D,B,j]),v.jsxs(v.Fragment,{children:[v.jsx(Ei.span,{id:y.textId,...l,ref:P}),y.isSelected&&h.valueNode&&!h.valueNodeHasChildren?Sv.createPortal(l.children,h.valueNode):null]})});ade.displayName=jS;var ode="SelectItemIndicator",lde=L.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return ide(ode,n).isSelected?v.jsx(Ei.span,{"aria-hidden":!0,...r,ref:t}):null});lde.displayName=ode;var Yj="SelectScrollUpButton",cde=L.forwardRef((e,t)=>{const n=Dv(Yj,e.__scopeSelect),r=r8(Yj,e.__scopeSelect),[a,l]=L.useState(!1),h=_s(t,r.onScrollButtonChange);return Sl(()=>{if(n.viewport&&n.isPositioned){let i=function(){const x=y.scrollTop>0;l(x)};const y=n.viewport;return i(),y.addEventListener("scroll",i),()=>y.removeEventListener("scroll",i)}},[n.viewport,n.isPositioned]),a?v.jsx(dde,{...e,ref:h,onAutoScroll:()=>{const{viewport:i,selectedItem:y}=n;i&&y&&(i.scrollTop=i.scrollTop-y.offsetHeight)}}):null});cde.displayName=Yj;var Xj="SelectScrollDownButton",ude=L.forwardRef((e,t)=>{const n=Dv(Xj,e.__scopeSelect),r=r8(Xj,e.__scopeSelect),[a,l]=L.useState(!1),h=_s(t,r.onScrollButtonChange);return Sl(()=>{if(n.viewport&&n.isPositioned){let i=function(){const x=y.scrollHeight-y.clientHeight,w=Math.ceil(y.scrollTop)<x;l(w)};const y=n.viewport;return i(),y.addEventListener("scroll",i),()=>y.removeEventListener("scroll",i)}},[n.viewport,n.isPositioned]),a?v.jsx(dde,{...e,ref:h,onAutoScroll:()=>{const{viewport:i,selectedItem:y}=n;i&&y&&(i.scrollTop=i.scrollTop+y.offsetHeight)}}):null});ude.displayName=Xj;var dde=L.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...a}=e,l=Dv("SelectScrollButton",n),h=L.useRef(null),i=hN(n),y=L.useCallback(()=>{h.current!==null&&(window.clearInterval(h.current),h.current=null)},[]);return L.useEffect(()=>()=>y(),[y]),Sl(()=>{var w;const x=i().find(C=>C.ref.current===document.activeElement);(w=x==null?void 0:x.ref.current)==null||w.scrollIntoView({block:"nearest"})},[i]),v.jsx(Ei.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:Sr(a.onPointerDown,()=>{h.current===null&&(h.current=window.setInterval(r,50))}),onPointerMove:Sr(a.onPointerMove,()=>{var x;(x=l.onItemLeave)==null||x.call(l),h.current===null&&(h.current=window.setInterval(r,50))}),onPointerLeave:Sr(a.onPointerLeave,()=>{y()})})}),xGe="SelectSeparator",hde=L.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return v.jsx(Ei.div,{"aria-hidden":!0,...r,ref:t})});hde.displayName=xGe;var Jj="SelectArrow",bGe=L.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=fN(n),l=Lv(Jj,n),h=Dv(Jj,n);return l.open&&h.position==="popper"?v.jsx(FF,{...a,...r,ref:t}):null});bGe.displayName=Jj;var wGe="SelectBubbleInput",fde=L.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const a=L.useRef(null),l=_s(r,a),h=Vue(t);return L.useEffect(()=>{const i=a.current;if(!i)return;const y=window.HTMLSelectElement.prototype,w=Object.getOwnPropertyDescriptor(y,"value").set;if(h!==t&&w){const C=new Event("change",{bubbles:!0});w.call(i,t),i.dispatchEvent(C)}},[h,t]),v.jsx(Ei.select,{...n,style:{...cQ,...n.style},ref:l,defaultValue:t})});fde.displayName=wGe;function pde(e){return e===""||e===void 0}function mde(e){const t=ll(e),n=L.useRef(""),r=L.useRef(0),a=L.useCallback(h=>{const i=n.current+h;t(i),function y(x){n.current=x,window.clearTimeout(r.current),x!==""&&(r.current=window.setTimeout(()=>y(""),1e3))}(i)},[t]),l=L.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return L.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,a,l]}function gde(e,t,n){const a=t.length>1&&Array.from(t).every(x=>x===t[0])?t[0]:t,l=n?e.indexOf(n):-1;let h=SGe(e,Math.max(l,0));a.length===1&&(h=h.filter(x=>x!==n));const y=h.find(x=>x.textValue.toLowerCase().startsWith(a.toLowerCase()));return y!==n?y:void 0}function SGe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var AGe=$ue,yde=Gue,TGe=Wue,CGe=Zue,EGe=Kue,vde=Yue,PGe=ede,_de=rde,xde=sde,kGe=ade,IGe=lde,bde=cde,wde=ude,Sde=hde;const Ep=AGe,Pp=TGe,Af=L.forwardRef(({className:e,children:t,...n},r)=>v.jsxs(yde,{ref:r,className:Xn("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,v.jsx(CGe,{asChild:!0,children:v.jsx(yF,{className:"h-4 w-4 opacity-50"})})]}));Af.displayName=yde.displayName;const Ade=L.forwardRef(({className:e,...t},n)=>v.jsx(bde,{ref:n,className:Xn("flex cursor-default items-center justify-center py-1",e),...t,children:v.jsx(DQ,{className:"h-4 w-4"})}));Ade.displayName=bde.displayName;const Tde=L.forwardRef(({className:e,...t},n)=>v.jsx(wde,{ref:n,className:Xn("flex cursor-default items-center justify-center py-1",e),...t,children:v.jsx(yF,{className:"h-4 w-4"})}));Tde.displayName=wde.displayName;const Tf=L.forwardRef(({className:e,children:t,position:n="popper",...r},a)=>v.jsx(EGe,{children:v.jsxs(vde,{ref:a,className:Xn("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[v.jsx(Ade,{}),v.jsx(PGe,{className:Xn("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),v.jsx(Tde,{})]})}));Tf.displayName=vde.displayName;const NGe=L.forwardRef(({className:e,...t},n)=>v.jsx(_de,{ref:n,className:Xn("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));NGe.displayName=_de.displayName;const So=L.forwardRef(({className:e,children:t,...n},r)=>v.jsxs(xde,{ref:r,className:Xn("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),...n,children:[v.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:v.jsx(IGe,{children:v.jsx(L3,{className:"h-4 w-4"})})}),v.jsx(kGe,{children:t})]}));So.displayName=xde.displayName;const MGe=L.forwardRef(({className:e,...t},n)=>v.jsx(Sde,{ref:n,className:Xn("-mx-1 my-1 h-px bg-muted",e),...t}));MGe.displayName=Sde.displayName;class LGe{constructor(t){ni(this,"merchantLocations",new Map);ni(this,"config");ni(this,"verificationTimer",null);this.config={minConfidenceThreshold:70,verificationInterval:24*60*60*1e3,geocodingRetryAttempts:3,coordinateTolerance:1e-4,...t}}async resolveMerchantLocation(t,n,r,a){if(console.log(` Location Intelligence Agent: Resolving location for ${n}`),a&&this.areCoordinatesAccurate(a,r))return console.log(` Using provided accurate coordinates for ${n}`),a;const l=this.merchantLocations.get(t);if(l&&this.isLocationValid(l))return console.log(` Using cached verified location for ${n}`),l.coordinates;const h=this.determineLocationStrategy(n,r,l);console.log(` Using strategy: ${h}`);const i=await this.executeLocationStrategy(h,t,n,r);return this.storeLocationResult(t,n,r,i),i.coordinates}determineLocationStrategy(t,n,r){return r&&r.confidence>=this.config.minConfidenceThreshold?"cached":r&&r.confidence<this.config.minConfidenceThreshold?"verification":n&&n!=="Address not available"?"geocoding":"fallback"}async executeLocationStrategy(t,n,r,a){switch(t){case"cached":return this.merchantLocations.get(n);case"verification":return await this.verifyExistingLocation(n,r,a);case"geocoding":return await this.geocodeAddress(n,r,a);case"fallback":return this.getFallbackLocation(n,r);default:throw new Error(`Unknown strategy: ${t}`)}}storeLocationResult(t,n,r,a){this.merchantLocations.set(t,{...a,lastVerified:new Date,verified:!0}),console.log(` Learned location for ${n}: ${a.coordinates.lat}, ${a.coordinates.lng} (confidence: ${a.confidence})`)}async verifyExistingLocation(t,n,r){console.log(` Verifying existing location for ${n}`);const a=await this.geocodeAddress(t,n,r),l=this.merchantLocations.get(t);return this.calculateDistance(l.coordinates,a.coordinates)<this.config.coordinateTolerance?{...l,confidence:Math.min(l.confidence+10,100),lastVerified:new Date}:{...a,confidence:Math.max(a.confidence-20,30)}}async geocodeAddress(t,n,r){console.log(` Geocoding address for ${n}: ${r}`);for(let a=1;a<=this.config.geocodingRetryAttempts;a++)try{const l=await this.performGeocoding(r);return{id:t,name:n,address:r,coordinates:l,verified:!0,lastVerified:new Date,confidence:this.calculateGeocodingConfidence(r,l)}}catch(l){console.warn(` Geocoding attempt ${a} failed for ${n}:`,l),a<this.config.geocodingRetryAttempts&&await new Promise(h=>setTimeout(h,1e3*a))}return console.warn(` All geocoding attempts failed for ${n}, using fallback`),this.getFallbackLocation(t,n)}getFallbackLocation(t,n){const r={"target-christiansburg":{lat:37.156681,lng:-80.422609},"starbucks-university":{lat:37.235581,lng:-80.433307},"kroger-south-main":{lat:37.216801,lng:-80.402687},"walmart-christiansburg":{lat:37.145123,lng:-80.408456},"mcdonalds-university":{lat:37.234567,lng:-80.432109},"shell-gas-station":{lat:37.218901,lng:-80.401234},"corner-bar":{lat:37.229012,lng:-80.414567},"subway-downtown":{lat:37.228456,lng:-80.413789},"cvs-pharmacy":{lat:37.22789,lng:-80.412345},"pizza-hut":{lat:37.233456,lng:-80.431234},"dominos-pizza":{lat:37.226789,lng:-80.411567},"food-lion":{lat:37.232345,lng:-80.430123}};let a=r[t];if(!a){const l=n.toLowerCase();for(const[h,i]of Object.entries(r)){const y=h.split("-")[0];if(l.includes(y)||y.includes(l)){a=i;break}}}return a||(a={lat:37.2296+(Math.random()-.5)*.02,lng:-80.4139+(Math.random()-.5)*.02}),{id:t,name:n,address:"Location estimated",coordinates:a,verified:!1,lastVerified:new Date,confidence:r[t]?85:50}}isLocationValid(t){const r=new Date().getTime()-t.lastVerified.getTime();return t.verified&&t.confidence>=this.config.minConfidenceThreshold&&r<this.config.verificationInterval}areCoordinatesAccurate(t,n){const r=t.lat>=37.1&&t.lat<=37.3&&t.lng>=-80.5&&t.lng<=-80.3,a=n&&n!=="Address to be geocoded"&&n!=="Address not available"&&n.includes("VA")&&(n.includes("Blacksburg")||n.includes("Christiansburg"));return r&&a}calculateGeocodingConfidence(t,n){let r=60;return t.includes("Blacksburg, VA")&&(r+=20),t.includes("Christiansburg, VA")&&(r+=20),t.includes("VA 24060")&&(r+=10),t.includes("VA 24073")&&(r+=10),t.match(/\d+.*St/)&&(r+=10),t.match(/\d+.*Ave/)&&(r+=10),t.match(/\d+.*Blvd/)&&(r+=10),n.lat>=37.1&&n.lat<=37.3&&(r+=10),n.lng>=-80.5&&n.lng<=-80.3&&(r+=10),Math.min(r,100)}async performGeocoding(t){try{const n=await fetch("/api/map/geocode",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`},body:JSON.stringify({address:t})});if(!n.ok)throw new Error(`Geocoding failed: ${n.status}`);const r=await n.json();if(r.success&&r.data&&r.data.coordinates)return{lat:r.data.coordinates.lat,lng:r.data.coordinates.lng,confidence:90};throw new Error("No geocoding results found")}catch(n){return console.warn("Backend geocoding failed, falling back to mock:",n),{lat:37.2296+(Math.random()-.5)*.01,lng:-80.4139+(Math.random()-.5)*.01,confidence:50}}}calculateDistance(t,n){const a=t.lat*Math.PI/180,l=n.lat*Math.PI/180,h=(n.lat-t.lat)*Math.PI/180,i=(n.lng-t.lng)*Math.PI/180,y=Math.sin(h/2)*Math.sin(h/2)+Math.cos(a)*Math.cos(l)*Math.sin(i/2)*Math.sin(i/2);return 6371e3*(2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y)))}startPeriodicVerification(){this.verificationTimer&&clearInterval(this.verificationTimer),this.verificationTimer=setInterval(()=>{this.verifyAllLocations()},this.config.verificationInterval),console.log(" Started periodic location verification")}async verifyAllLocations(){console.log(" Verifying all stored locations...");for(const[t,n]of this.merchantLocations.entries())if(!this.isLocationValid(n))try{await this.verifyExistingLocation(t,n.name,n.address)}catch(r){console.warn(`Failed to verify location for ${n.name}:`,r)}}stopPeriodicVerification(){this.verificationTimer&&(clearInterval(this.verificationTimer),this.verificationTimer=null),console.log(" Stopped periodic location verification")}getLocationIntelligence(){const t=Array.from(this.merchantLocations.values()),n=t.filter(l=>l.verified).length,r=t.reduce((l,h)=>l+h.confidence,0)/t.length,a=t.reduce((l,h)=>{const i=h.confidence>=90?"90-100":h.confidence>=70?"70-89":h.confidence>=50?"50-69":"0-49";return l[i]=(l[i]||0)+1,l},{});return{totalLocations:t.length,verifiedLocations:n,averageConfidence:Math.round(r*100)/100,locationsByConfidence:a}}}var Cde={exports:{}};(function(e,t){(function(n,r){e.exports=r()})(vye,function(){var n,r,a;function l(i,y){if(!n)n=y;else if(!r)r=y;else{var x="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk); self.onerror = null;",w={};n(w),a=y(w),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(a.workerUrl=window.URL.createObjectURL(new Blob([x],{type:"text/javascript"})))}}l(["exports"],function(i){var y=1e-6,x=typeof Float32Array<"u"?Float32Array:Array;function w(u,s){var c=s[0],f=s[1],p=s[2],_=s[3],b=c*_-p*f;return b?(u[0]=_*(b=1/b),u[1]=-f*b,u[2]=-p*b,u[3]=c*b,u):null}function C(){var u=new x(9);return x!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[5]=0,u[6]=0,u[7]=0),u[0]=1,u[4]=1,u[8]=1,u}function P(u,s){var c=s[0],f=s[1],p=s[2],_=s[3],b=s[4],T=s[5],I=s[6],M=s[7],O=s[8];return u[0]=b*O-T*M,u[1]=p*M-f*O,u[2]=f*T-p*b,u[3]=T*I-_*O,u[4]=c*O-p*I,u[5]=p*_-c*T,u[6]=_*M-b*I,u[7]=f*I-c*M,u[8]=c*b-f*_,u}function E(u,s,c){var f=s[0],p=s[1],_=s[2],b=s[3],T=s[4],I=s[5],M=s[6],O=s[7],z=s[8],q=c[0],K=c[1],Y=c[2],ae=c[3],le=c[4],ce=c[5],Se=c[6],Ae=c[7],Ee=c[8];return u[0]=q*f+K*b+Y*M,u[1]=q*p+K*T+Y*O,u[2]=q*_+K*I+Y*z,u[3]=ae*f+le*b+ce*M,u[4]=ae*p+le*T+ce*O,u[5]=ae*_+le*I+ce*z,u[6]=Se*f+Ae*b+Ee*M,u[7]=Se*p+Ae*T+Ee*O,u[8]=Se*_+Ae*I+Ee*z,u}function j(){var u=new x(16);return x!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u}function D(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function B(u,s){var c=s[0],f=s[1],p=s[2],_=s[3],b=s[4],T=s[5],I=s[6],M=s[7],O=s[8],z=s[9],q=s[10],K=s[11],Y=s[12],ae=s[13],le=s[14],ce=s[15],Se=c*T-f*b,Ae=c*I-p*b,Ee=c*M-_*b,Ze=f*I-p*T,Ke=f*M-_*T,tt=p*M-_*I,at=O*ae-z*Y,ct=O*le-q*Y,qt=O*ce-K*Y,_t=z*le-q*ae,Xt=z*ce-K*ae,an=q*ce-K*le,Jt=Se*an-Ae*Xt+Ee*_t+Ze*qt-Ke*ct+tt*at;return Jt?(u[0]=(T*an-I*Xt+M*_t)*(Jt=1/Jt),u[1]=(p*Xt-f*an-_*_t)*Jt,u[2]=(ae*tt-le*Ke+ce*Ze)*Jt,u[3]=(q*Ke-z*tt-K*Ze)*Jt,u[4]=(I*qt-b*an-M*ct)*Jt,u[5]=(c*an-p*qt+_*ct)*Jt,u[6]=(le*Ee-Y*tt-ce*Ae)*Jt,u[7]=(O*tt-q*Ee+K*Ae)*Jt,u[8]=(b*Xt-T*qt+M*at)*Jt,u[9]=(f*qt-c*Xt-_*at)*Jt,u[10]=(Y*Ke-ae*Ee+ce*Se)*Jt,u[11]=(z*Ee-O*Ke-K*Se)*Jt,u[12]=(T*ct-b*_t-I*at)*Jt,u[13]=(c*_t-f*ct+p*at)*Jt,u[14]=(ae*Ae-Y*Ze-le*Se)*Jt,u[15]=(O*Ze-z*Ae+q*Se)*Jt,u):null}function F(u,s,c){var f=s[0],p=s[1],_=s[2],b=s[3],T=s[4],I=s[5],M=s[6],O=s[7],z=s[8],q=s[9],K=s[10],Y=s[11],ae=s[12],le=s[13],ce=s[14],Se=s[15],Ae=c[0],Ee=c[1],Ze=c[2],Ke=c[3];return u[0]=Ae*f+Ee*T+Ze*z+Ke*ae,u[1]=Ae*p+Ee*I+Ze*q+Ke*le,u[2]=Ae*_+Ee*M+Ze*K+Ke*ce,u[3]=Ae*b+Ee*O+Ze*Y+Ke*Se,u[4]=(Ae=c[4])*f+(Ee=c[5])*T+(Ze=c[6])*z+(Ke=c[7])*ae,u[5]=Ae*p+Ee*I+Ze*q+Ke*le,u[6]=Ae*_+Ee*M+Ze*K+Ke*ce,u[7]=Ae*b+Ee*O+Ze*Y+Ke*Se,u[8]=(Ae=c[8])*f+(Ee=c[9])*T+(Ze=c[10])*z+(Ke=c[11])*ae,u[9]=Ae*p+Ee*I+Ze*q+Ke*le,u[10]=Ae*_+Ee*M+Ze*K+Ke*ce,u[11]=Ae*b+Ee*O+Ze*Y+Ke*Se,u[12]=(Ae=c[12])*f+(Ee=c[13])*T+(Ze=c[14])*z+(Ke=c[15])*ae,u[13]=Ae*p+Ee*I+Ze*q+Ke*le,u[14]=Ae*_+Ee*M+Ze*K+Ke*ce,u[15]=Ae*b+Ee*O+Ze*Y+Ke*Se,u}function $(u,s,c){var f,p,_,b,T,I,M,O,z,q,K,Y,ae=c[0],le=c[1],ce=c[2];return s===u?(u[12]=s[0]*ae+s[4]*le+s[8]*ce+s[12],u[13]=s[1]*ae+s[5]*le+s[9]*ce+s[13],u[14]=s[2]*ae+s[6]*le+s[10]*ce+s[14],u[15]=s[3]*ae+s[7]*le+s[11]*ce+s[15]):(p=s[1],_=s[2],b=s[3],T=s[4],I=s[5],M=s[6],O=s[7],z=s[8],q=s[9],K=s[10],Y=s[11],u[0]=f=s[0],u[1]=p,u[2]=_,u[3]=b,u[4]=T,u[5]=I,u[6]=M,u[7]=O,u[8]=z,u[9]=q,u[10]=K,u[11]=Y,u[12]=f*ae+T*le+z*ce+s[12],u[13]=p*ae+I*le+q*ce+s[13],u[14]=_*ae+M*le+K*ce+s[14],u[15]=b*ae+O*le+Y*ce+s[15]),u}function H(u,s,c){var f=c[0],p=c[1],_=c[2];return u[0]=s[0]*f,u[1]=s[1]*f,u[2]=s[2]*f,u[3]=s[3]*f,u[4]=s[4]*p,u[5]=s[5]*p,u[6]=s[6]*p,u[7]=s[7]*p,u[8]=s[8]*_,u[9]=s[9]*_,u[10]=s[10]*_,u[11]=s[11]*_,u[12]=s[12],u[13]=s[13],u[14]=s[14],u[15]=s[15],u}function J(u,s,c){var f=Math.sin(c),p=Math.cos(c),_=s[4],b=s[5],T=s[6],I=s[7],M=s[8],O=s[9],z=s[10],q=s[11];return s!==u&&(u[0]=s[0],u[1]=s[1],u[2]=s[2],u[3]=s[3],u[12]=s[12],u[13]=s[13],u[14]=s[14],u[15]=s[15]),u[4]=_*p+M*f,u[5]=b*p+O*f,u[6]=T*p+z*f,u[7]=I*p+q*f,u[8]=M*p-_*f,u[9]=O*p-b*f,u[10]=z*p-T*f,u[11]=q*p-I*f,u}function ee(u,s,c){var f=Math.sin(c),p=Math.cos(c),_=s[0],b=s[1],T=s[2],I=s[3],M=s[8],O=s[9],z=s[10],q=s[11];return s!==u&&(u[4]=s[4],u[5]=s[5],u[6]=s[6],u[7]=s[7],u[12]=s[12],u[13]=s[13],u[14]=s[14],u[15]=s[15]),u[0]=_*p-M*f,u[1]=b*p-O*f,u[2]=T*p-z*f,u[3]=I*p-q*f,u[8]=_*f+M*p,u[9]=b*f+O*p,u[10]=T*f+z*p,u[11]=I*f+q*p,u}function Q(u,s,c){var f=Math.sin(c),p=Math.cos(c),_=s[0],b=s[1],T=s[2],I=s[3],M=s[4],O=s[5],z=s[6],q=s[7];return s!==u&&(u[8]=s[8],u[9]=s[9],u[10]=s[10],u[11]=s[11],u[12]=s[12],u[13]=s[13],u[14]=s[14],u[15]=s[15]),u[0]=_*p+M*f,u[1]=b*p+O*f,u[2]=T*p+z*f,u[3]=I*p+q*f,u[4]=M*p-_*f,u[5]=O*p-b*f,u[6]=z*p-T*f,u[7]=q*p-I*f,u}function ne(u,s){return u[0]=s[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=s[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=s[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function pe(u,s,c){var f,p,_,b=c[0],T=c[1],I=c[2],M=Math.sqrt(b*b+T*T+I*I);return M<y?null:(b*=M=1/M,T*=M,I*=M,f=Math.sin(s),p=Math.cos(s),u[0]=b*b*(_=1-p)+p,u[1]=T*b*_+I*f,u[2]=I*b*_-T*f,u[3]=0,u[4]=b*T*_-I*f,u[5]=T*T*_+p,u[6]=I*T*_+b*f,u[7]=0,u[8]=b*I*_+T*f,u[9]=T*I*_-b*f,u[10]=I*I*_+p,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u)}function he(u,s){var c=s[0],f=s[1],p=s[2],_=s[3],b=c+c,T=f+f,I=p+p,M=c*b,O=f*b,z=f*T,q=p*b,K=p*T,Y=p*I,ae=_*b,le=_*T,ce=_*I;return u[0]=1-z-Y,u[1]=O+ce,u[2]=q-le,u[3]=0,u[4]=O-ce,u[5]=1-M-Y,u[6]=K+ae,u[7]=0,u[8]=q+le,u[9]=K-ae,u[10]=1-M-z,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}var we=F;function fe(){var u=new x(3);return x!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u}function ge(u){var s=new x(3);return s[0]=u[0],s[1]=u[1],s[2]=u[2],s}function Ce(u){var s=u[0],c=u[1],f=u[2];return Math.sqrt(s*s+c*c+f*f)}function xe(u,s,c){var f=new x(3);return f[0]=u,f[1]=s,f[2]=c,f}function Re(u,s,c,f){return u[0]=s,u[1]=c,u[2]=f,u}function Qe(u,s,c){return u[0]=s[0]+c[0],u[1]=s[1]+c[1],u[2]=s[2]+c[2],u}function et(u,s,c){return u[0]=s[0]-c[0],u[1]=s[1]-c[1],u[2]=s[2]-c[2],u}function je(u,s,c){return u[0]=s[0]*c[0],u[1]=s[1]*c[1],u[2]=s[2]*c[2],u}function De(u,s,c){return u[0]=Math.min(s[0],c[0]),u[1]=Math.min(s[1],c[1]),u[2]=Math.min(s[2],c[2]),u}function Ct(u,s,c){return u[0]=Math.max(s[0],c[0]),u[1]=Math.max(s[1],c[1]),u[2]=Math.max(s[2],c[2]),u}function xt(u,s,c){return u[0]=s[0]*c,u[1]=s[1]*c,u[2]=s[2]*c,u}function me(u,s,c,f){return u[0]=s[0]+c[0]*f,u[1]=s[1]+c[1]*f,u[2]=s[2]+c[2]*f,u}function Ye(u,s){var c=s[0]-u[0],f=s[1]-u[1],p=s[2]-u[2];return c*c+f*f+p*p}function nt(u){var s=u[0],c=u[1],f=u[2];return s*s+c*c+f*f}function vt(u,s){return u[0]=-s[0],u[1]=-s[1],u[2]=-s[2],u}function gt(u,s){var c=s[0],f=s[1],p=s[2],_=c*c+f*f+p*p;return _>0&&(_=1/Math.sqrt(_)),u[0]=s[0]*_,u[1]=s[1]*_,u[2]=s[2]*_,u}function dt(u,s){return u[0]*s[0]+u[1]*s[1]+u[2]*s[2]}function At(u,s,c){var f=s[0],p=s[1],_=s[2],b=c[0],T=c[1],I=c[2];return u[0]=p*I-_*T,u[1]=_*b-f*I,u[2]=f*T-p*b,u}function mt(u,s,c,f){var p=s[0],_=s[1],b=s[2];return u[0]=p+f*(c[0]-p),u[1]=_+f*(c[1]-_),u[2]=b+f*(c[2]-b),u}function Pt(u,s,c){var f=s[0],p=s[1],_=s[2],b=c[3]*f+c[7]*p+c[11]*_+c[15];return u[0]=(c[0]*f+c[4]*p+c[8]*_+c[12])/(b=b||1),u[1]=(c[1]*f+c[5]*p+c[9]*_+c[13])/b,u[2]=(c[2]*f+c[6]*p+c[10]*_+c[14])/b,u}function Ht(u,s,c){var f=s[0],p=s[1],_=s[2];return u[0]=f*c[0]+p*c[3]+_*c[6],u[1]=f*c[1]+p*c[4]+_*c[7],u[2]=f*c[2]+p*c[5]+_*c[8],u}function Ot(u,s,c){var f=c[0],p=c[1],_=c[2],b=c[3],T=s[0],I=s[1],M=s[2],O=p*M-_*I,z=_*T-f*M,q=f*I-p*T;return u[0]=T+b*(O+=O)+p*(q+=q)-_*(z+=z),u[1]=I+b*z+_*O-f*q,u[2]=M+b*q+f*z-p*O,u}function Un(u){return u[0]=0,u[1]=0,u[2]=0,u}function Kt(u,s){return u[0]===s[0]&&u[1]===s[1]&&u[2]===s[2]}var st=et,Dr=je,Or=Ce;function Br(){var u=new x(4);return x!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0,u[3]=0),u}function On(u,s,c){return u[0]=s[0]*c,u[1]=s[1]*c,u[2]=s[2]*c,u[3]=s[3]*c,u}function ht(u,s){var c=s[0],f=s[1],p=s[2],_=s[3],b=c*c+f*f+p*p+_*_;return b>0&&(b=1/Math.sqrt(b)),u[0]=c*b,u[1]=f*b,u[2]=p*b,u[3]=_*b,u}function wt(u,s,c){var f=s[0],p=s[1],_=s[2],b=s[3];return u[0]=c[0]*f+c[4]*p+c[8]*_+c[12]*b,u[1]=c[1]*f+c[5]*p+c[9]*_+c[13]*b,u[2]=c[2]*f+c[6]*p+c[10]*_+c[14]*b,u[3]=c[3]*f+c[7]*p+c[11]*_+c[15]*b,u}function Wt(){var u=new x(4);return x!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u[3]=1,u}function xn(u){return u[0]=0,u[1]=0,u[2]=0,u[3]=1,u}function Rn(u,s,c){c*=.5;var f=s[0],p=s[1],_=s[2],b=s[3],T=Math.sin(c),I=Math.cos(c);return u[0]=f*I+b*T,u[1]=p*I+_*T,u[2]=_*I-p*T,u[3]=b*I-f*T,u}function Sn(u,s,c){c*=.5;var f=s[0],p=s[1],_=s[2],b=s[3],T=Math.sin(c),I=Math.cos(c);return u[0]=f*I-_*T,u[1]=p*I+b*T,u[2]=_*I+f*T,u[3]=b*I-p*T,u}fe(),Br();var Mn,Ar,Pr,wr=ht,Qr=(Mn=fe(),Ar=xe(1,0,0),Pr=xe(0,1,0),function(u,s,c){var f=dt(s,c);return f<-.999999?(At(Mn,Ar,s),Or(Mn)<1e-6&&At(Mn,Pr,s),gt(Mn,Mn),function(p,_,b){b*=.5;var T=Math.sin(b);p[0]=T*_[0],p[1]=T*_[1],p[2]=T*_[2],p[3]=Math.cos(b)}(u,Mn,Math.PI),u):f>.999999?(u[0]=0,u[1]=0,u[2]=0,u[3]=1,u):(At(Mn,s,c),u[0]=Mn[0],u[1]=Mn[1],u[2]=Mn[2],u[3]=1+f,wr(u,u))});function dr(){var u=new x(2);return x!=Float32Array&&(u[0]=0,u[1]=0),u}function Hi(u,s){var c=new x(2);return c[0]=u,c[1]=s,c}function Bi(u,s,c){return u[0]=s,u[1]=c,u}function Cr(u,s,c){return u[0]=s[0]+c[0],u[1]=s[1]+c[1],u}function fi(u,s,c){return u[0]=s[0]-c[0],u[1]=s[1]-c[1],u}function Cn(u,s,c){return u[0]=s[0]*c,u[1]=s[1]*c,u}function bn(u){var s=u[0],c=u[1];return Math.sqrt(s*s+c*c)}function fr(u,s){var c=s[0],f=s[1],p=c*c+f*f;return p>0&&(p=1/Math.sqrt(p)),u[0]=s[0]*p,u[1]=s[1]*p,u}function Ur(u,s){return u[0]*s[0]+u[1]*s[1]}Wt(),Wt(),C();var Xs,_a,ts=fi;function _i(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}dr();var xs=function(){if(_a)return Xs;function u(s,c,f,p){this.cx=3*s,this.bx=3*(f-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(p-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=c,this.p2x=f,this.p2y=p}return _a=1,Xs=u,u.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,c){if(c===void 0&&(c=1e-6),s<0)return 0;if(s>1)return 1;for(var f=s,p=0;p<8;p++){var _=this.sampleCurveX(f)-s;if(Math.abs(_)<c)return f;var b=this.sampleCurveDerivativeX(f);if(Math.abs(b)<1e-6)break;f-=_/b}var T=0,I=1;for(f=s,p=0;p<20&&(_=this.sampleCurveX(f),!(Math.abs(_-s)<c));p++)s>_?T=f:I=f,f=.5*(I-T)+T;return f},solve:function(s,c){return this.sampleCurveY(this.solveCurveX(s,c))}},Xs}(),Pi=_i(xs);function zt(u,s){this.x=u,this.y=s}function es(u,s){if(Array.isArray(u)){if(!Array.isArray(s)||u.length!==s.length)return!1;for(let c=0;c<u.length;c++)if(!es(u[c],s[c]))return!1;return!0}if(typeof u=="object"&&u!==null&&s!==null){if(typeof s!="object"||Object.keys(u).length!==Object.keys(s).length)return!1;for(const c in u)if(!es(u[c],s[c]))return!1;return!0}return u===s}zt.prototype={clone(){return new zt(this.x,this.y)},add(u){return this.clone()._add(u)},sub(u){return this.clone()._sub(u)},multByPoint(u){return this.clone()._multByPoint(u)},divByPoint(u){return this.clone()._divByPoint(u)},mult(u){return this.clone()._mult(u)},div(u){return this.clone()._div(u)},rotate(u){return this.clone()._rotate(u)},rotateAround(u,s){return this.clone()._rotateAround(u,s)},matMult(u){return this.clone()._matMult(u)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(u){return this.x===u.x&&this.y===u.y},dist(u){return Math.sqrt(this.distSqr(u))},distSqr(u){const s=u.x-this.x,c=u.y-this.y;return s*s+c*c},angle(){return Math.atan2(this.y,this.x)},angleTo(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith(u){return this.angleWithSep(u.x,u.y)},angleWithSep(u,s){return Math.atan2(this.x*s-this.y*u,this.x*u+this.y*s)},_matMult(u){const s=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=s,this},_add(u){return this.x+=u.x,this.y+=u.y,this},_sub(u){return this.x-=u.x,this.y-=u.y,this},_mult(u){return this.x*=u,this.y*=u,this},_div(u){return this.x/=u,this.y/=u,this},_multByPoint(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint(u){return this.x/=u.x,this.y/=u.y,this},_unit(){return this._div(this.mag()),this},_perp(){const u=this.y;return this.y=this.x,this.x=-u,this},_rotate(u){const s=Math.cos(u),c=Math.sin(u),f=c*this.x+s*this.y;return this.x=s*this.x-c*this.y,this.y=f,this},_rotateAround(u,s){const c=Math.cos(u),f=Math.sin(u),p=s.y+f*(this.x-s.x)+c*(this.y-s.y);return this.x=s.x+c*(this.x-s.x)-f*(this.y-s.y),this.y=p,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:zt},zt.convert=function(u){if(u instanceof zt)return u;if(Array.isArray(u))return new zt(+u[0],+u[1]);if(u.x!==void 0&&u.y!==void 0)return new zt(+u.x,+u.y);throw new Error("Expected [x, y] or {x, y} point format")};const ja=Math.PI/180,qr=180/Math.PI;function lt(u){return u*ja}function de(u){return u*qr}const _e=[[0,0],[1,0],[1,1],[0,1]];function Ie(u){if(u<=0)return 0;if(u>=1)return 1;const s=u*u,c=s*u;return 4*(u<.5?c:3*(u-s)+c-.75)}function Xe(u,s,c,f){const p=new Pi(u,s,c,f);return function(_){return p.solve(_)}}const He=Xe(.25,.1,.25,1);function We(u,s,c){return Math.min(c,Math.max(s,u))}function kt(u,s,c){return(c=We((c-u)/(s-u),0,1))*c*(3-2*c)}function ot(u,s,c){const f=c-s,p=((u-s)%f+f)%f+s;return p===s?c:p}function Et(u,s,c){if(!u.length)return c(null,[]);let f=u.length;const p=new Array(u.length);let _=null;u.forEach((b,T)=>{s(b,(I,M)=>{I&&(_=I),p[T]=M,--f==0&&c(_,p)})})}let on=1;function Yt(){return on++}function Vn(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log2(u)))}function ar(u,s){u.forEach(c=>{s[c]&&(s[c]=s[c].bind(s))})}function vr(u,s,c){const f={};for(const p in u)f[p]=s.call(this,u[p],p,u);return f}function Gr(u,s,c){const f={};for(const p in u)s.call(this,u[p],p,u)&&(f[p]=u[p]);return f}function Fr(u){return Array.isArray(u)?u.map(Fr):typeof u=="object"&&u?vr(u,Fr):u}function pi(u,s){for(let c=0;c<u.length;c++)if(s.indexOf(u[c])>=0)return!0;return!1}const Vi={};function ai(u){Vi[u]||(typeof console<"u"&&console.warn(u),Vi[u]=!0)}function Js(u,s,c){return(c.y-u.y)*(s.x-u.x)>(s.y-u.y)*(c.x-u.x)}function ha(u){let s=0;for(let c,f,p=0,_=u.length,b=_-1;p<_;b=p++)c=u[p],f=u[b],s+=(f.x-c.x)*(c.y+f.y);return s}function xa([u,s,c]){const f=lt(s+90),p=lt(c);return{x:u*Math.cos(f)*Math.sin(p),y:u*Math.sin(f)*Math.sin(p),z:u*Math.cos(p),azimuthal:s,polar:c}}function Wi(u){return(typeof self<"u"||u!==void 0)&&typeof WorkerGlobalScope<"u"&&(u!==void 0?u:self)instanceof WorkerGlobalScope}function bi(u){const s={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,f,p,_)=>{const b=p||_;return s[f]=!b||b.toLowerCase(),""}),s["max-age"]){const c=parseInt(s["max-age"],10);isNaN(c)?delete s["max-age"]:s["max-age"]=c}return s}let Ns=null;function zs(u,s){return[u[4*s],u[4*s+1],u[4*s+2],u[4*s+3]]}function as(u,s,c,f){for(;s<c;){const p=s+c>>1;u[p]<f?s=p+1:c=p}return s}function Ja(u,s,c,f){for(;s<c;){const p=s+c>>1;u[p]<=f?s=p+1:c=p}return s}function Vo(u){return u>0?1/(1.001-u):1+u}function Cl(u){return u>0?1-1/(1.001-u):-u}function ac(u,s,c){return(u-s.min)*(c.max-c.min)/(s.max-s.min)+c.min}const $o={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!$o.API_URL)return null;try{const u=new URL($o.API_URL);return u.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":u.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",BUILDING_GEN_URL:"https://api.mapbox.com/mapbox-gl-js/building-gen/building_gen_v1.2.3.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Pa(u){return $o.API_URL_REGEX.test(u)}function Qm(u){return $o.API_SPRITE_REGEX.test(u)}let ku,oc,Iu,$l,lc,ka;function Mf(){return ku==null&&(ku=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),ku}const Yc={now:()=>$l!==void 0?$l:performance.now(),setNow(u){$l=u},restoreNow(){$l=void 0},frame(u){const s=requestAnimationFrame(u);return{cancel:()=>cancelAnimationFrame(s)}},getImageData(u,s=0){const{width:c,height:f}=u;lc||(lc=document.createElement("canvas"));const p=lc.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return(c>lc.width||f>lc.height)&&(lc.width=c,lc.height=f),p.clearRect(-s,-s,c+2*s,f+2*s),p.drawImage(u,0,0,c,f),p.getImageData(-s,-s,c+2*s,f+2*s)},resolveURL:u=>(oc||(oc=document.createElement("a")),oc.href=u,oc.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Iu==null&&(Iu=window.matchMedia("(prefers-reduced-motion: reduce)")),Iu.matches)},hasCanvasFingerprintNoise(){if(ka!==void 0)return ka;if(!Mf())return ka=!1,!1;const u=new OffscreenCanvas(85,1),s=u.getContext("2d",{willReadFrequently:!0});let c=0;for(let p=0;p<u.width;++p)s.fillStyle=`rgba(${c++},${c++},${c++}, 255)`,s.fillRect(p,0,1,1);const f=s.getImageData(0,0,u.width,u.height);c=0;for(let p=0;p<f.data.length;++p)if(p%4!=3&&c++!==f.data[p])return ka=!0,!0;return ka=!1,!1}};function eg(u,s){const c=u.indexOf("?");if(c<0)return`${u}?${new URLSearchParams(s).toString()}`;const f=new URLSearchParams(u.slice(c));for(const p in s)f.set(p,s[p]);return`${u.slice(0,c)}?${f.toString()}`}function Rp(u,s={persistentParams:[]}){const c=u.indexOf("?");if(c<0)return u;const f=new URLSearchParams,p=new URLSearchParams(u.slice(c));for(const b of s.persistentParams){const T=p.get(b);T&&f.set(b,T)}const _=f.toString();return`${u.slice(0,c)}${_.length>0?`?${_}`:""}`}const Qa="mapbox-tiles";let cc=500,Xc=50;const Xo=["language","worldview","jobid"];let Po,Yd;function tg(){try{return caches}catch{}}function Lf(){const u=tg();u&&Po==null&&(Po=u.open(Qa))}let Jc=1/0;const Nu={supported:!1,testSupport:function(u){!qo&&Rh&&(Df?jh(u):Qc=u)}};let Qc,Rh,qo=!1,Df=!1;const Li=typeof self<"u"?self:{};function jh(u){const s=u.createTexture();u.bindTexture(u.TEXTURE_2D,s);try{if(u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,Rh),u.isContextLost())return;Nu.supported=!0}catch{}u.deleteTexture(s),qo=!0}Li.document&&(Rh=Li.document.createElement("img"),Rh.onload=function(){Qc&&jh(Qc),Qc=null,Df=!0},Rh.onerror=function(){qo=!0,Qc=null},Rh.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const jp={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(jp);class ng extends Error{constructor(s,c,f){c===401&&Pa(f)&&(s+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(s),this.status=c,this.url=f}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Op=Wi()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,mi=function(u,s){if(!(/^file:/.test(c=u.url)||/^file:/.test(Op())&&!/^\w+:/.test(c))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(f,p){const _=new AbortController,b=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:Op(),referrerPolicy:f.referrerPolicy,signal:_.signal});let T=!1,I=!1;const M=(O=b.url).indexOf("sku=")>0&&Pa(O);var O;f.type==="json"&&b.headers.set("Accept","application/json");const z=(K,Y,ae)=>{if(I)return;if(K&&K.message!=="SecurityError"&&ai(K.toString()),Y&&ae)return q(Y);const le=Date.now();fetch(b).then(ce=>{if(ce.ok){const Se=M?ce.clone():null;return q(ce,Se,le)}return p(new ng(ce.statusText,ce.status,f.url))}).catch(ce=>{ce.name!=="AbortError"&&p(new Error(`${ce.message} ${f.url}`))})},q=(K,Y,ae)=>{(f.type==="arrayBuffer"?K.arrayBuffer():f.type==="json"?K.json():K.text()).then(le=>{I||(Y&&ae&&function(ce,Se,Ae){if(Lf(),Po==null)return;const Ee=bi(Se.headers.get("Cache-Control")||"");if(Ee["no-store"])return;const Ze={status:Se.status,statusText:Se.statusText,headers:new Headers};Se.headers.forEach((at,ct)=>Ze.headers.set(ct,at)),Ee["max-age"]&&Ze.headers.set("Expires",new Date(Ae+1e3*Ee["max-age"]).toUTCString());const Ke=Ze.headers.get("Expires");if(!Ke||new Date(Ke).getTime()-Ae<42e4)return;let tt=Rp(ce.url,{persistentParams:Xo});if(Se.status===206){const at=ce.headers.get("Range");if(!at)return;Ze.status=200,tt=eg(tt,{range:at})}(function(at,ct){if(Yd===void 0)try{new Response(new ReadableStream),Yd=!0}catch{Yd=!1}Yd?ct(at.body):at.blob().then(ct).catch(qt=>ai(qt.message))})(Se,at=>{const ct=new Response((qt=Se.status)!==200&&qt!==404&&[101,103,204,205,304].includes(qt)?null:at,Ze);var qt;Lf(),Po!=null&&Po.then(_t=>_t.put(tt,ct)).catch(_t=>ai(_t.message))})}(b,Y,ae),T=!0,p(null,le,K.headers.get("Cache-Control"),K.headers.get("Expires")))}).catch(le=>{I||p(new Error(le.message))})};return M?function(K,Y){if(Lf(),Po==null)return Y(null);Po.then(ae=>{let le=Rp(K.url,{persistentParams:Xo});const ce=K.headers.get("Range");ce&&(le=eg(le,{range:ce})),ae.match(le).then(Se=>{const Ae=function(Ee){if(!Ee)return!1;const Ze=new Date(Ee.headers.get("Expires")||0),Ke=bi(Ee.headers.get("Cache-Control")||"");return Number(Ze)>Date.now()&&!Ke["no-cache"]}(Se);ae.delete(le).catch(Y),Ae&&ae.put(le,Se.clone()).catch(Y),Y(null,Se,Ae)}).catch(Y)}).catch(Y)}(b,z):z(null,null),{cancel:()=>{I=!0,T||_.abort()}}}(u,s);if(Wi(self)&&self.worker.actor)return self.worker.actor.send("getResource",u,s,void 0,!0)}var c;return function(f,p){const _=new XMLHttpRequest;_.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(_.responseType="arraybuffer");for(const b in f.headers)_.setRequestHeader(b,f.headers[b]);return f.type==="json"&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials=f.credentials==="include",_.onerror=()=>{p(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||_.status===0)&&_.response!==null){let b=_.response;if(f.type==="json")try{b=JSON.parse(_.response)}catch(T){return p(T)}p(null,b,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else p(new ng(_.statusText,_.status,f.url))},_.send(f.body),{cancel:()=>_.abort()}}(u,s)},uc=function(u,s){return mi(Object.assign(u,{type:"arrayBuffer"}),s)};function Cy(u){const s=document.createElement("a");return s.href=u,s.protocol===location.protocol&&s.host===location.host}const Ey="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Xd,eu;Xd=[],eu=0;const tu=function(u,s){if(Nu.supported&&(u.headers||(u.headers={}),u.headers.accept="image/webp,*/*"),eu>=$o.MAX_PARALLEL_IMAGE_REQUESTS){const _={requestParameters:u,callback:s,cancelled:!1,cancel(){this.cancelled=!0}};return Xd.push(_),_}eu++;let c=!1;const f=()=>{if(!c)for(c=!0,eu--;Xd.length&&eu<$o.MAX_PARALLEL_IMAGE_REQUESTS;){const _=Xd.shift(),{requestParameters:b,callback:T,cancelled:I}=_;I||(_.cancel=tu(b,T).cancel)}},p=uc(u,(_,b,T,I)=>{f(),_?s(_):b&&(self.createImageBitmap?function(M,O){const z=new Blob([new Uint8Array(M)],{type:"image/png"});createImageBitmap(z).then(q=>{O(null,q)}).catch(q=>{O(new Error(`Could not load image because of ${q.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(b,(M,O)=>s(M,O,T,I)):function(M,O){const z=new Image;z.onload=()=>{O(null,z),URL.revokeObjectURL(z.src),z.onload=null,requestAnimationFrame(()=>{z.src=Ey})},z.onerror=()=>O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const q=new Blob([new Uint8Array(M)],{type:"image/png"});z.src=M.byteLength?URL.createObjectURL(q):Ey}(b,(M,O)=>s(M,O,T,I)))});return{cancel:()=>{p.cancel(),f()}}};var pd,Jd,Py,Mu={exports:{}},Fp={exports:{}},Qd={exports:{}},nu=function(){if(Py)return Mu.exports;Py=1;var u=(pd||(pd=1,Fp.exports=function(c,f){var p,_,b,T,I,M,O,z;for(_=c.length-(p=3&c.length),b=f,I=3432918353,M=461845907,z=0;z<_;)O=255&c.charCodeAt(z)|(255&c.charCodeAt(++z))<<8|(255&c.charCodeAt(++z))<<16|(255&c.charCodeAt(++z))<<24,++z,b=27492+(65535&(T=5*(65535&(b=(b^=O=(65535&(O=(O=(65535&O)*I+(((O>>>16)*I&65535)<<16)&4294967295)<<15|O>>>17))*M+(((O>>>16)*M&65535)<<16)&4294967295)<<13|b>>>19))+((5*(b>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(O=0,p){case 3:O^=(255&c.charCodeAt(z+2))<<16;case 2:O^=(255&c.charCodeAt(z+1))<<8;case 1:b^=O=(65535&(O=(O=(65535&(O^=255&c.charCodeAt(z)))*I+(((O>>>16)*I&65535)<<16)&4294967295)<<15|O>>>17))*M+(((O>>>16)*M&65535)<<16)&4294967295}return b^=c.length,b=2246822507*(65535&(b^=b>>>16))+((2246822507*(b>>>16)&65535)<<16)&4294967295,b=3266489909*(65535&(b^=b>>>13))+((3266489909*(b>>>16)&65535)<<16)&4294967295,(b^=b>>>16)>>>0}),Fp.exports),s=(Jd||(Jd=1,Qd.exports=function(c,f){for(var p,_=c.length,b=f^_,T=0;_>=4;)p=1540483477*(65535&(p=255&c.charCodeAt(T)|(255&c.charCodeAt(++T))<<8|(255&c.charCodeAt(++T))<<16|(255&c.charCodeAt(++T))<<24))+((1540483477*(p>>>16)&65535)<<16),b=1540483477*(65535&b)+((1540483477*(b>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),_-=4,++T;switch(_){case 3:b^=(255&c.charCodeAt(T+2))<<16;case 2:b^=(255&c.charCodeAt(T+1))<<8;case 1:b=1540483477*(65535&(b^=255&c.charCodeAt(T)))+((1540483477*(b>>>16)&65535)<<16)}return b=1540483477*(65535&(b^=b>>>13))+((1540483477*(b>>>16)&65535)<<16),(b^=b>>>15)>>>0}),Qd.exports);return Mu.exports=u,Mu.exports.murmur3=u,Mu.exports.murmur2=s,Mu.exports}(),Oh=_i(nu);class El{constructor(s,...c){Object.assign(this,c[0]||{}),this.type=s}}class eh extends El{constructor(s,c={}){super("error",Object.assign({error:s},c))}}function md(u,s,c){c[u]&&c[u].indexOf(s)!==-1||(c[u]=c[u]||[],c[u].push(s))}function Pl(u,s,c){if(c&&c[u]){const f=c[u].indexOf(s);f!==-1&&c[u].splice(f,1)}}class gd{on(s,c){return this._listeners=this._listeners||{},md(s,c,this._listeners),this}off(s,c){return Pl(s,c,this._listeners),Pl(s,c,this._oneTimeListeners),this}once(s,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},md(s,c,this._oneTimeListeners),this):new Promise(f=>{this.once(s,f)})}fire(s,c){const f=typeof s=="string"?new El(s,c):s,p=f.type;if(this.listens(p)){f.target=this;const _=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const I of _)I.call(this,f);const b=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const I of b)Pl(p,I,this._oneTimeListeners),I.call(this,f);const T=this._eventedParent;if(T){const I=typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData;Object.assign(f,I),T.fire(f)}}else f instanceof eh&&console.error(f.error);return this}listens(s){return!!(this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s))}setEventedParent(s,c){return this._eventedParent=s,this._eventedParentData=c,this}}class ho{constructor(s){typeof s=="string"?this.name=s:(this.name=s.name,this.iconsetId=s.iconsetId)}static from(s){return new ho(s)}static toString(s){return s.iconsetId?`${s.name}${s.iconsetId}`:s.name}static parse(s){const[c,f]=s.split("");return new ho({name:c,iconsetId:f})}static isEqual(s,c){return s.name===c.name&&s.iconsetId===c.iconsetId}toString(){return ho.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var Lu,Rf={},zp=function(){if(Lu)return Rf;Lu=1;var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function s(_){return(_=Math.round(_))<0?0:_>255?255:_}function c(_){return s(_[_.length-1]==="%"?parseFloat(_)/100*255:parseInt(_))}function f(_){return(b=_[_.length-1]==="%"?parseFloat(_)/100:parseFloat(_))<0?0:b>1?1:b;var b}function p(_,b,T){return T<0?T+=1:T>1&&(T-=1),6*T<1?_+(b-_)*T*6:2*T<1?b:3*T<2?_+(b-_)*(2/3-T)*6:_}try{Rf.parseCSSColor=function(_){var b,T=_.replace(/ /g,"").toLowerCase();if(T in u)return u[T].slice();if(T[0]==="#")return T.length===4?(b=parseInt(T.substr(1),16))>=0&&b<=4095?[(3840&b)>>4|(3840&b)>>8,240&b|(240&b)>>4,15&b|(15&b)<<4,1]:null:T.length===7&&(b=parseInt(T.substr(1),16))>=0&&b<=16777215?[(16711680&b)>>16,(65280&b)>>8,255&b,1]:null;var I=T.indexOf("("),M=T.indexOf(")");if(I!==-1&&M+1===T.length){var O=T.substr(0,I),z=T.substr(I+1,M-(I+1)).split(","),q=1;switch(O){case"rgba":if(z.length!==4)return null;q=f(z.pop());case"rgb":return z.length!==3?null:[c(z[0]),c(z[1]),c(z[2]),q];case"hsla":if(z.length!==4)return null;q=f(z.pop());case"hsl":if(z.length!==3)return null;var K=(parseFloat(z[0])%360+360)%360/360,Y=f(z[1]),ae=f(z[2]),le=ae<=.5?ae*(Y+1):ae+Y-ae*Y,ce=2*ae-le;return[s(255*p(ce,le,K+1/3)),s(255*p(ce,le,K)),s(255*p(ce,le,K-1/3)),q];default:return null}}return null}}catch{}return Rf}();class Ii{constructor(s,c,f,p=1){this.r=s,this.g=c,this.b=f,this.a=p}static parse(s){if(!s)return;if(s instanceof Ii)return s;if(typeof s!="string")return;const c=zp.parseCSSColor(s);return c?new Ii(c[0]/255,c[1]/255,c[2]/255,c[3]):void 0}toString(){const[s,c,f,p]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*s)},${Math.round(255*c)},${Math.round(255*f)},${p})`}toNonPremultipliedRenderColor(s){const{r:c,g:f,b:p,a:_}=this;return new re(s,c,f,p,_)}toPremultipliedRenderColor(s){const{r:c,g:f,b:p,a:_}=this;return new Pe(s,c*_,f*_,p*_,_)}clone(){return new Ii(this.r,this.g,this.b,this.a)}}class Bp{constructor(s,c,f,p,_,b=!1){if(this.premultiplied=!1,this.premultiplied=b,s){const T=s.image.height,I=T*T;this.premultiplied?(c=_===0?0:c/_*(T-1),f=_===0?0:f/_*(T-1),p=_===0?0:p/_*(T-1)):(c*=T-1,f*=T-1,p*=T-1);const M=Math.floor(c),O=Math.floor(f),z=Math.floor(p),q=Math.ceil(c),K=Math.ceil(f),Y=Math.ceil(p),ae=c-M,le=f-O,ce=p-z,Se=s.image.data,Ae=4*(M+O*I+z*T),Ee=4*(M+O*I+Y*T),Ze=4*(M+K*I+z*T),Ke=4*(M+K*I+Y*T),tt=4*(q+O*I+z*T),at=4*(q+O*I+Y*T),ct=4*(q+K*I+z*T),qt=4*(q+K*I+Y*T);if(Ae<0||qt>=Se.length)throw new Error("out of range");this.r=qe(qe(qe(Se[Ae],Se[Ee],ce),qe(Se[Ze],Se[Ke],ce),le),qe(qe(Se[tt],Se[at],ce),qe(Se[ct],Se[qt],ce),le),ae)/255*(this.premultiplied?_:1),this.g=qe(qe(qe(Se[Ae+1],Se[Ee+1],ce),qe(Se[Ze+1],Se[Ke+1],ce),le),qe(qe(Se[tt+1],Se[at+1],ce),qe(Se[ct+1],Se[qt+1],ce),le),ae)/255*(this.premultiplied?_:1),this.b=qe(qe(qe(Se[Ae+2],Se[Ee+2],ce),qe(Se[Ze+2],Se[Ke+2],ce),le),qe(qe(Se[tt+2],Se[at+2],ce),qe(Se[ct+2],Se[qt+2],ce),le),ae)/255*(this.premultiplied?_:1),this.a=_}else this.r=c,this.g=f,this.b=p,this.a=_}toArray(){const{r:s,g:c,b:f,a:p}=this;return[255*s,255*c,255*f,p]}toHslaArray(){let{r:s,g:c,b:f,a:p}=this;if(this.premultiplied){if(p===0)return[0,0,0,0];const Y=1/p;s*=Y,c*=Y,f*=Y}const _=Math.min(Math.max(s,0),1),b=Math.min(Math.max(c,0),1),T=Math.min(Math.max(f,0),1),I=Math.min(_,b,T),M=Math.max(_,b,T),O=M-I,z=.5*(I+M);if(O===0)return[0,0,100*z,p];const q=z>.5?O/(2-M-I):O/(M+I);let K;switch(M){case _:K=60*((b-T)/O+(b<T?6:0));break;case b:K=60*((T-_)/O+2);break;default:K=60*((_-b)/O+4)}return[K,100*q,100*z,p]}toArray01(){const{r:s,g:c,b:f,a:p}=this;return[s,c,f,p]}toArray01Scaled(s){const{r:c,g:f,b:p}=this;return[c*s,f*s,p*s]}toArray01Linear(){const{r:s,g:c,b:f,a:p}=this;return[Math.pow(s,2.2),Math.pow(c,2.2),Math.pow(f,2.2),p]}}class re extends Bp{constructor(s,c,f,p,_){super(s,c,f,p,_,!1)}}class Pe extends Bp{constructor(s,c,f,p,_){super(s,c,f,p,_,!0)}}function qe(u,s,c){return u*(1-c)+s*c}function Rt(u,s,c){return u.map((f,p)=>qe(f,s[p],c))}Ii.black=new Ii(0,0,0,1),Ii.white=new Ii(1,1,1,1),Ii.transparent=new Ii(0,0,0,0),Ii.red=new Ii(1,0,0,1),Ii.blue=new Ii(0,0,1,1);var Zt=Object.freeze({__proto__:null,array:Rt,color:function(u,s,c){return new Ii(qe(u.r,s.r,c),qe(u.g,s.g,c),qe(u.b,s.b,c),qe(u.a,s.a,c))},number:qe});class kn extends Error{constructor(s,c){super(c),this.message=c,this.key=s}}class Wn{constructor(s,c=[]){this.parent=s,this.bindings={};for(const[f,p]of c)this.bindings[f]=p}concat(s){return new Wn(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}const Mr={kind:"null"},ln={kind:"number"},lr={kind:"string"},ur={kind:"boolean"},$i={kind:"color"},aa={kind:"object"},Hr={kind:"value"},oa={kind:"collator"},Aa={kind:"formatted"},Oa={kind:"resolvedImage"};function Bs(u,s){return{kind:"array",itemType:u,N:s}}function Cs(u){if(u.kind==="array"){const s=Cs(u.itemType);return typeof u.N=="number"?`array<${s}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${s}>`}return u.kind}const dc=[Mr,ln,lr,ur,$i,Aa,aa,Bs(Hr),Oa];function Fh(u,s){if(s.kind==="error")return null;if(u.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!Fh(u.itemType,s.itemType))&&(typeof u.N!="number"||u.N===s.N))return null}else{if(u.kind===s.kind)return null;if(u.kind==="value"){for(const c of dc)if(!Fh(c,s))return null}}return`Expected ${Cs(u)} but found ${Cs(s)} instead.`}function zh(u,s){return s.some(c=>c.kind===u.kind)}function Du(u,s){return s.some(c=>c==="null"?u===null:c==="array"?Array.isArray(u):c==="object"?u&&!Array.isArray(u)&&typeof u=="object":c===typeof u)}function ru(u,s){return u.kind==="array"&&s.kind==="array"?u.N===s.N&&ru(u.itemType,s.itemType):u.kind===s.kind}class hc{constructor(s,c,f){this.sensitivity=s?c?"variant":"case":c?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,c){return this.collator.compare(s,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class yd{constructor(s,c,f,p,_){this.text=s.normalize?s.normalize():s,this.image=c,this.scale=f,this.fontStack=p,this.textColor=_}}class eo{constructor(s){this.sections=s}static fromString(s){return new eo([new yd(s,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(s=>s.text.length!==0||!!s.image&&s.image.hasPrimary())}static factory(s){return s instanceof eo?s:eo.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map(s=>s.text).join("")}serialize(){const s=["format"];for(const c of this.sections){if(c.image){const p=c.image.getPrimary().id.toString();s.push(["image",p]);continue}s.push(c.text);const f={};c.fontStack&&(f["text-font"]=["literal",c.fontStack.split(",")]),c.scale&&(f["font-scale"]=c.scale),c.textColor&&(f["text-color"]=["rgba"].concat(c.textColor.toNonPremultipliedRenderColor(null).toArray())),s.push(f)}return s}}class Ta{constructor(s,c={}){if(this.id=ho.from(s),this.options=Object.assign({},c),c.transform){const{a:f,b:p,c:_,d:b,e:T,f:I}=c.transform;this.options.transform=new DOMMatrix([f,p,_,b,T,I])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:s,b:c,c:f,d:p,e:_,f:b}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:s,b:c,c:f,d:p,e:_,f:b}})}static parse(s){let c,f,p,_;try{({name:c,iconsetId:f,params:p,transform:_}=JSON.parse(s)||{})}catch{return null}if(!c)return null;const{a:b,b:T,c:I,d:M,e:O,f:z}=_||{};return new Ta({name:c,iconsetId:f},{params:p,transform:new DOMMatrix([b,T,I,M,O,z])})}scaleSelf(s,c){return this.options.transform.scaleSelf(s,c),this}}class fo{constructor(s,c,f,p,_=!1){this.primaryId=ho.from(s),this.primaryOptions=c,f&&(this.secondaryId=ho.from(f)),this.secondaryOptions=p,this.available=_}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new Ta(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new Ta(this.secondaryId,this.secondaryOptions):null}static from(s){return typeof s=="string"?fo.build({name:s}):s}static build(s,c,f,p){return!s||typeof s=="object"&&!("name"in s)?null:new fo(s,f,c,p)}}function Bh(u,s,c,f){return typeof u=="number"&&u>=0&&u<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof c=="number"&&c>=0&&c<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[u,s,c,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[u,s,c,f]:[u,s,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function vd(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof Ii||u instanceof hc||u instanceof eo||u instanceof fo)return!0;if(Array.isArray(u)){for(const s of u)if(!vd(s))return!1;return!0}if(typeof u=="object"){for(const s in u)if(!vd(u[s]))return!1;return!0}return!1}function Ca(u){if(u===null)return Mr;if(typeof u=="string")return lr;if(typeof u=="boolean")return ur;if(typeof u=="number")return ln;if(u instanceof Ii)return $i;if(u instanceof hc)return oa;if(u instanceof eo)return Aa;if(u instanceof fo)return Oa;if(Array.isArray(u)){const s=u.length;let c;for(const f of u){const p=Ca(f);if(c){if(c===p)continue;c=Hr;break}c=p}return Bs(c||Hr,s)}return aa}function bs(u){const s=typeof u;return u===null?"":s==="string"||s==="number"||s==="boolean"?String(u):u instanceof eo||u instanceof fo||u instanceof Ii?u.toString():JSON.stringify(u)}class kr{constructor(s,c){this.type=s,this.value=c}static parse(s,c){if(s.length!==2)return c.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!vd(s[1]))return c.error("invalid value");const f=s[1];let p=Ca(f);const _=c.expectedType;return p.kind!=="array"||p.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(p=_),new kr(p,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Ii?["rgba"].concat(this.value.toNonPremultipliedRenderColor(null).toArray()):this.value instanceof eo?this.value.serialize():this.value}}class Ln{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}}const Uh={string:lr,number:ln,boolean:ur,object:aa};class sr{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");let f,p=1;const _=s[0];if(_==="array"){let T,I;if(s.length>2){const M=s[1];if(typeof M!="string"||!(M in Uh)||M==="object")return c.error('The item type argument of "array" must be one of string, number, boolean',1);T=Uh[M],p++}else T=Hr;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return c.error('The length argument to "array" must be a positive integer literal',2);I=s[2],p++}f=Bs(T,I)}else f=Uh[_];const b=[];for(;p<s.length;p++){const T=c.parse(s[p],p,Hr);if(!T)return null;b.push(T)}return new sr(f,b)}evaluate(s){for(let c=0;c<this.args.length;c++){const f=this.args[c].evaluate(s);if(!Fh(this.type,Ca(f)))return f;if(c===this.args.length-1)throw new Ln(`The expression ${JSON.stringify(this.args[c].serialize())} evaluated to ${Cs(Ca(f))} but was expected to be of type ${Cs(this.type)}.`)}return null}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=this.type,c=[s.kind];if(s.kind==="array"){const f=s.itemType;if(f.kind==="string"||f.kind==="number"||f.kind==="boolean"){c.push(f.kind);const p=s.N;(typeof p=="number"||this.args.length>1)&&c.push(p)}}return c.concat(this.args.map(f=>f.serialize()))}}class Nc{constructor(s){this.type=Aa,this.sections=s}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");const f=s[1];if(!Array.isArray(f)&&typeof f=="object")return c.error("First argument must be an image or text section.");const p=[];let _=!1;for(let b=1;b<=s.length-1;++b){const T=s[b];if(_&&typeof T=="object"&&!Array.isArray(T)){_=!1;let I=null;if(T["font-scale"]&&(I=c.parseObjectValue(T["font-scale"],b,"font-scale",ln),!I))return null;let M=null;if(T["text-font"]&&(M=c.parseObjectValue(T["text-font"],b,"text-font",Bs(lr)),!M))return null;let O=null;if(T["text-color"]&&(O=c.parseObjectValue(T["text-color"],b,"text-color",$i),!O))return null;const z=p[p.length-1];z.scale=I,z.font=M,z.textColor=O}else{const I=c.parse(s[b],b,Hr);if(!I)return null;const M=I.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,p.push({content:I,scale:null,font:null,textColor:null})}}return new Nc(p)}evaluate(s){return new eo(this.sections.map(c=>{const f=c.content.evaluate(s);return ru(Ca(f),Oa)?new yd("",f,null,null,null):new yd(bs(f),null,c.scale?c.scale.evaluate(s):null,c.font?c.font.evaluate(s).join(","):null,c.textColor?c.textColor.evaluate(s):null)}))}eachChild(s){for(const c of this.sections)s(c.content),c.scale&&s(c.scale),c.font&&s(c.font),c.textColor&&s(c.textColor)}outputDefined(){return!1}serialize(){const s=["format"];for(const c of this.sections){s.push(c.content.serialize());const f={};c.scale&&(f["font-scale"]=c.scale.serialize()),c.font&&(f["text-font"]=c.font.serialize()),c.textColor&&(f["text-color"]=c.textColor.serialize()),s.push(f)}return s}}class _d{constructor(s,c,f,p){this._imageWarnHistory={},this.type=Oa,this.namePrimary=s,this.nameSecondary=c,f&&(this.paramsPrimary=f.params,this.iconsetIdPrimary=f.iconset?f.iconset.id:void 0),p&&(this.paramsSecondary=p.params,this.iconsetIdSecondary=p.iconset?p.iconset.id:void 0)}static parse(s,c){if(s.length<2)return c.error("Expected two or more arguments.");let f=1;const p=[];function _(){if(f<s.length){const T=c.parse(s[f],f++,lr);return T?(p.push({image:T,options:{}}),!0):(c.error(p.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function b(){if(f<s.length){const I=s[f];if((T=I)===null||typeof T!="object"||Array.isArray(T))return!0;const M=I.params,O=I.iconset,z=c.concat(f);if(!M&&!O)return f++,!0;if(M){if(typeof M!="object"||M.constructor!==Object)return z.error('Image options "params" should be an object'),!1;const q={},K=z.concat(void 0,"params");for(const Y in M){if(!Y)return K.error("Image parameter name should be non-empty"),!1;const ae=K.concat(void 0,Y).parse(M[Y],void 0,$i,void 0,{typeAnnotation:"coerce"});if(!ae)return!1;q[Y]=ae}p[p.length-1].options.params=q}if(O){if(typeof O!="object"||O.constructor!==Object)return z.error('Image options "iconset" should be an object'),!1;if(!O.id)return z.error('Image options "iconset" should have an "id" property'),!1;p[p.length-1].options.iconset=O}return f++,!0}var T;return!0}for(let T=0;T<2;T++)if(!_()||!b())return;return new _d(p[0].image,p[1]?p[1].image:void 0,p[0].options,p[1]?p[1].options:void 0)}evaluateParams(s,c){const f={};if(c){for(const p in c)if(c[p])try{f[p]=c[p].evaluate(s)}catch{continue}if(Object.keys(f).length!==0)return{params:f}}}evaluate(s){const c={name:this.namePrimary.evaluate(s),iconsetId:this.iconsetIdPrimary},f=this.nameSecondary?{name:this.nameSecondary.evaluate(s),iconsetId:this.iconsetIdSecondary}:void 0,p=fo.build(c,f,this.paramsPrimary?this.evaluateParams(s,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(s,this.paramsSecondary):void 0);if(p&&s.availableImages){const _=p.getPrimary().id;if(p.available=s.availableImages.some(b=>ho.isEqual(b,_)),p.available){const b=p.getSecondary()?p.getSecondary().id:null;b&&(p.available=s.availableImages.some(T=>ho.isEqual(T,b)))}}return p}eachChild(s){if(s(this.namePrimary),this.paramsPrimary)for(const c in this.paramsPrimary)this.paramsPrimary[c]&&s(this.paramsPrimary[c]);if(this.nameSecondary&&(s(this.nameSecondary),this.paramsSecondary))for(const c in this.paramsSecondary)this.paramsSecondary[c]&&s(this.paramsSecondary[c])}outputDefined(){return!1}serializeOptions(s,c){const f={};if(c&&(f.iconset={id:c}),s){f.params={};for(const p in s)s[p]&&(f.params[p]=s[p].serialize())}return Object.keys(f).length>0?f:void 0}serialize(){const s=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const c=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);c&&s.push(c)}if(this.nameSecondary&&(s.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const c=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);c&&s.push(c)}return s}}function hr(u){return Ru(u)?"string":dl(u)?"number":ql(u)?"boolean":Array.isArray(u)?"array":u===null?"null":xd(u)?"object":typeof u}function xd(u){return u!=null&&!Array.isArray(u)&&typeof u!="function"&&!(u instanceof String||u instanceof Number||u instanceof Boolean)&&typeof u=="object"}function Ru(u){return typeof u=="string"||u instanceof String}function dl(u){return typeof u=="number"||u instanceof Number}function ql(u){return typeof u=="boolean"||u instanceof Boolean}const ju={"to-boolean":ur,"to-color":$i,"to-number":ln,"to-string":lr};class Ms{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");const f=s[0],p=[];let _=Mr;if(f==="to-array"){if(!Array.isArray(s[1]))return null;const b=s[1].length;if(c.expectedType){if(c.expectedType.kind!=="array")return c.error(`Expected ${c.expectedType.kind} but found array.`);_=Bs(c.expectedType.itemType,b)}else{if(!(b>0&&vd(s[1][0])))return null;_=Bs(Ca(s[1][0]),b)}for(let T=0;T<b;T++){const I=s[1][T];let M;if(Array.isArray(I))M=c.parse(I,void 0,_.itemType);else{const O=hr(I);if(O!==_.itemType.kind)return c.error(`Expected ${_.itemType.kind} but found ${O}.`);M=c.registry.literal.parse(["literal",I===void 0?null:I],c)}if(!M)return null;p.push(M)}}else{if((f==="to-boolean"||f==="to-string")&&s.length!==2)return c.error("Expected one argument.");_=ju[f];for(let b=1;b<s.length;b++){const T=c.parse(s[b],b,Hr);if(!T)return null;p.push(T)}}return new Ms(_,p)}evaluate(s){if(this.type.kind==="boolean")return!!this.args[0].evaluate(s);if(this.type.kind==="color"){let c,f;for(const p of this.args){if(c=p.evaluate(s),f=null,c instanceof Ii)return c;if(typeof c=="string"){const _=s.parseColor(c);if(_)return _}else if(Array.isArray(c)&&(f=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:Bh(c[0],c[1],c[2],c[3]),!f))return new Ii(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new Ln(f||`Could not parse color from value '${typeof c=="string"?c:String(JSON.stringify(c))}'`)}if(this.type.kind==="number"){let c=null;for(const f of this.args){if(c=f.evaluate(s),c===null)return 0;const p=Number(c);if(!isNaN(p))return p}throw new Ln(`Could not convert ${JSON.stringify(c)} to number.`)}return this.type.kind==="formatted"?eo.fromString(bs(this.args[0].evaluate(s))):this.type.kind==="resolvedImage"?fo.build(bs(this.args[0].evaluate(s))):this.type.kind==="array"?this.args.map(c=>c.evaluate(s)):bs(this.args[0].evaluate(s))}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Nc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new _d(this.args[0]).serialize();const s=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(c=>{s.push(c.serialize())}),s}}const bd=["Unknown","Point","LineString","Polygon"];class Mc{constructor(s,c,f){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=s,this.options=c,this.iconImageUseTheme=f}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?bd[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(s){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const s=this.featureDistanceData.center,c=this.featureDistanceData.scale,{x:f,y:p}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(f*c-s[0])+this.featureDistanceData.bearing[1]*(p*c-s[1])}return 0}parseColor(s){let c=this._parseColorCache[s];return c||(c=this._parseColorCache[s]=Ii.parse(s)),c}getConfig(s){return this.options?this.options.get(s):null}}class po{constructor(s,c,f,p,_){this.name=s,this.type=c,this._evaluate=f,this.args=p,this._overloadIndex=_}evaluate(s){if(!this._evaluate){const c=po.definitions[this.name];this._evaluate=Array.isArray(c)?c[2]:c.overloads[this._overloadIndex][1]}return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(s=>s.serialize()))}static parse(s,c){const f=s[0],p=po.definitions[f];if(!p)return c.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(p)?p[0]:p.type,b=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,T=[];let I=null,M=-1;for(const[O,z]of b){if(Array.isArray(O)&&O.length!==s.length-1)continue;T.push(O),M++,I=new iu(c.registry,c.path,null,c.scope,void 0,c._scope,c.options,c.iconImageUseTheme);const q=[];let K=!1;for(let Y=1;Y<s.length;Y++){const ae=s[Y],le=Array.isArray(O)?O[Y-1]:O.type,ce=I.parse(ae,1+q.length,le);if(!ce){K=!0;break}q.push(ce)}if(!K)if(Array.isArray(O)&&O.length!==q.length)I.error(`Expected ${O.length} arguments, but found ${q.length} instead.`);else{for(let Y=0;Y<q.length;Y++){const ae=Array.isArray(O)?O[Y]:O.type,le=q[Y];I.concat(Y+1).checkSubtype(ae,le.type)}if(I.errors.length===0)return new po(f,_,z,q,M)}}if(T.length===1)c.errors.push(...I.errors);else{const O=(T.length?T:b.map(([q])=>q)).map(fa).join(" | "),z=[];for(let q=1;q<s.length;q++){const K=c.parse(s[q],1+z.length);if(!K)return null;z.push(Cs(K.type))}c.error(`Expected arguments of type ${O}, but found (${z.join(", ")}) instead.`)}return null}static register(s,c){po.definitions=c;for(const f in c)s[f]=po}}function fa(u){return Array.isArray(u)?`(${u.map(Cs).join(", ")})`:`(${Cs(u.type)}...)`}class to{constructor(s,c,f){this.type=oa,this.locale=f,this.caseSensitive=s,this.diacriticSensitive=c}static parse(s,c){if(s.length!==2)return c.error("Expected one argument.");const f=s[1];if(typeof f!="object"||Array.isArray(f))return c.error("Collator options argument must be an object.");const p=f["case-sensitive"]===void 0?c.parse(!1,1,ur):c.parseObjectValue(f["case-sensitive"],1,"case-sensitive",ur);if(!p)return null;const _=f["diacritic-sensitive"]===void 0?c.parse(!1,1,ur):c.parseObjectValue(f["diacritic-sensitive"],1,"diacritic-sensitive",ur);if(!_)return null;let b=null;return f.locale&&(b=c.parseObjectValue(f.locale,1,"locale",lr),!b)?null:new to(p,_,b)}evaluate(s){return new hc(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}serialize(){const s={};return s["case-sensitive"]=this.caseSensitive.serialize(),s["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(s.locale=this.locale.serialize()),["collator",s]}}function Ou(u,s,c=0,f=u.length-1,p=rg){for(;f>c;){if(f-c>600){const I=f-c+1,M=s-c+1,O=Math.log(I),z=.5*Math.exp(2*O/3),q=.5*Math.sqrt(O*z*(I-z)/I)*(M-I/2<0?-1:1);Ou(u,s,Math.max(c,Math.floor(s-M*z/I+q)),Math.min(f,Math.floor(s+(I-M)*z/I+q)),p)}const _=u[s];let b=c,T=f;for(fc(u,c,s),p(u[f],_)>0&&fc(u,c,f);b<T;){for(fc(u,b,T),b++,T--;p(u[b],_)<0;)b++;for(;p(u[T],_)>0;)T--}p(u[c],_)===0?fc(u,c,T):(T++,fc(u,T,f)),T<=s&&(c=T+1),s<=T&&(f=T-1)}}function fc(u,s,c){const f=u[s];u[s]=u[c],u[c]=f}function rg(u,s){return u<s?-1:u>s?1:0}function Vh(u){let s=0;for(let c,f,p=0,_=u.length,b=_-1;p<_;b=p++)c=u[p],f=u[b],s+=(f.x-c.x)*(c.y+f.y);return s}function wd(u,s){u[0]=Math.min(u[0],s[0]),u[1]=Math.min(u[1],s[1]),u[2]=Math.max(u[2],s[0]),u[3]=Math.max(u[3],s[1])}function Gl(u,s){return!(u[0]<=s[0]||u[2]>=s[2]||u[1]<=s[1]||u[3]>=s[3])}function $h(u,s,c){const f=u[0]-s[0],p=u[1]-s[1],_=u[0]-c[0],b=u[1]-c[1];return f*b-_*p==0&&f*_<=0&&p*b<=0}function Lc(u,s,c=!1){let f=!1;for(let T=0,I=s.length;T<I;T++){const M=s[T];for(let O=0,z=M.length,q=z-1;O<z;q=O++){const K=M[q],Y=M[O];if($h(u,K,Y))return c;(_=K)[1]>(p=u)[1]!=(b=Y)[1]>p[1]&&p[0]<(b[0]-_[0])*(p[1]-_[1])/(b[1]-_[1])+_[0]&&(f=!f)}}var p,_,b;return f}function th(u,s,c,f){const p=f[0]-c[0],_=f[1]-c[1],b=(u[0]-c[0])*_-p*(u[1]-c[1]),T=(s[0]-c[0])*_-p*(s[1]-c[1]);return b>0&&T<0||b<0&&T>0}function Sd(u,s,c,f){return(p=[f[0]-c[0],f[1]-c[1]])[0]*(_=[s[0]-u[0],s[1]-u[1]])[1]-p[1]*_[0]!=0&&!(!th(u,s,c,f)||!th(c,f,u,s));var p,_}function Fu(u){const s=new zt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),c=new zt(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const f of u[0])s.x>f.x&&(s.x=f.x),s.y>f.y&&(s.y=f.y),c.x<f.x&&(c.x=f.x),c.y<f.y&&(c.y=f.y);return{min:s,max:c}}const pc=8192;function Jo(u,s){const c=(180+u[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,p=Math.pow(2,s.z);return[Math.round(c*p*pc),Math.round(f*p*pc)]}function Ad(u,s){for(let c=0;c<s.length;c++)if(Lc(u,s[c]))return!0;return!1}function ia(u,s,c){for(const f of c)for(let p=0,_=f.length,b=_-1;p<_;b=p++)if(Sd(u,s,f[b],f[p]))return!0;return!1}function sa(u,s){for(let c=0;c<u.length;++c)if(!Lc(u[c],s))return!1;for(let c=0;c<u.length-1;++c)if(ia(u[c],u[c+1],s))return!1;return!0}function no(u,s){for(let c=0;c<s.length;c++)if(sa(u,s[c]))return!0;return!1}function ro(u,s,c){const f=[];for(let p=0;p<u.length;p++){const _=[];for(let b=0;b<u[p].length;b++){const T=Jo(u[p][b],c);wd(s,T),_.push(T)}f.push(_)}return f}function ko(u,s,c){const f=[];for(let p=0;p<u.length;p++){const _=ro(u[p],s,c);f.push(_)}return f}function Up(u,s,c,f){if(u[0]<c[0]||u[0]>c[2]){const p=.5*f;let _=u[0]-c[0]>p?-f:c[0]-u[0]>p?f:0;_===0&&(_=u[0]-c[2]>p?-f:c[2]-u[0]>p?f:0),u[0]+=_}wd(s,u)}function jf(u,s,c,f){const p=Math.pow(2,f.z)*pc,_=[f.x*pc,f.y*pc],b=[];if(!u)return b;for(const T of u)for(const I of T){const M=[I.x+_[0],I.y+_[1]];Up(M,s,c,p),b.push(M)}return b}function ig(u,s,c,f){const p=Math.pow(2,f.z)*pc,_=[f.x*pc,f.y*pc],b=[];if(!u)return b;for(const I of u){const M=[];for(const O of I){const z=[O.x+_[0],O.y+_[1]];wd(s,z),M.push(z)}b.push(M)}if(s[2]-s[0]<=p/2){(T=s)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const I of b)for(const M of I)Up(M,s,c,p)}var T;return b}class qh{constructor(s,c){this.type=ur,this.geojson=s,this.geometries=c}static parse(s,c){if(s.length!==2)return c.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(vd(s[1])){const f=s[1];if(f.type==="FeatureCollection")for(let p=0;p<f.features.length;++p){const _=f.features[p].geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new qh(f,f.features[p].geometry)}else if(f.type==="Feature"){const p=f.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new qh(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new qh(f,f)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(c,f){const p=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],b=c.canonicalID();if(!b)return!1;if(f.type==="Polygon"){const T=ro(f.coordinates,_,b),I=jf(c.geometry(),p,_,b);if(!Gl(p,_))return!1;for(const M of I)if(!Lc(M,T))return!1}if(f.type==="MultiPolygon"){const T=ko(f.coordinates,_,b),I=jf(c.geometry(),p,_,b);if(!Gl(p,_))return!1;for(const M of I)if(!Ad(M,T))return!1}return!0}(s,this.geometries);if(s.geometryType()==="LineString")return function(c,f){const p=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],b=c.canonicalID();if(!b)return!1;if(f.type==="Polygon"){const T=ro(f.coordinates,_,b),I=ig(c.geometry(),p,_,b);if(!Gl(p,_))return!1;for(const M of I)if(!sa(M,T))return!1}if(f.type==="MultiPolygon"){const T=ko(f.coordinates,_,b),I=ig(c.geometry(),p,_,b);if(!Gl(p,_))return!1;for(const M of I)if(!no(M,T))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Vp={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},ky=1/298.257223563,Iy=ky*(2-ky),Of=Math.PI/180;class Ff{static fromTile(s,c,f){const p=Math.PI*(1-2*(s+.5)/Math.pow(2,c)),_=Math.atan(.5*(Math.exp(p)-Math.exp(-p)))/Of;return new Ff(_,f)}static get units(){return Vp}constructor(s,c){if(s===void 0)throw new Error("No latitude given.");if(c&&!Vp[c])throw new Error(`Unknown unit ${c}. Use one of: ${Object.keys(Vp).join(", ")}`);const f=6378.137*Of*(c?Vp[c]:1),p=Math.cos(s*Of),_=1/(1-Iy*(1-p*p)),b=Math.sqrt(_);this.kx=f*b*p,this.ky=f*b*_*(1-Iy)}distance(s,c){const f=mc(s[0]-c[0])*this.kx,p=(s[1]-c[1])*this.ky;return Math.sqrt(f*f+p*p)}bearing(s,c){const f=mc(c[0]-s[0])*this.kx;return Math.atan2(f,(c[1]-s[1])*this.ky)/Of}destination(s,c,f){const p=f*Of;return this.offset(s,Math.sin(p)*c,Math.cos(p)*c)}offset(s,c,f){return[s[0]+c/this.kx,s[1]+f/this.ky]}lineDistance(s){let c=0;for(let f=0;f<s.length-1;f++)c+=this.distance(s[f],s[f+1]);return c}area(s){let c=0;for(let f=0;f<s.length;f++){const p=s[f];for(let _=0,b=p.length,T=b-1;_<b;T=_++)c+=mc(p[_][0]-p[T][0])*(p[_][1]+p[T][1])*(f?-1:1)}return Math.abs(c)/2*this.kx*this.ky}along(s,c){let f=0;if(c<=0)return s[0];for(let p=0;p<s.length-1;p++){const _=s[p],b=s[p+1],T=this.distance(_,b);if(f+=T,f>c)return sg(_,b,(c-(f-T))/T)}return s[s.length-1]}pointToSegmentDistance(s,c,f){let[p,_]=c,b=mc(f[0]-p)*this.kx,T=(f[1]-_)*this.ky;if(b!==0||T!==0){const I=(mc(s[0]-p)*this.kx*b+(s[1]-_)*this.ky*T)/(b*b+T*T);I>1?(p=f[0],_=f[1]):I>0&&(p+=b/this.kx*I,_+=T/this.ky*I)}return b=mc(s[0]-p)*this.kx,T=(s[1]-_)*this.ky,Math.sqrt(b*b+T*T)}pointOnLine(s,c){let f=1/0,p=s[0][0],_=s[0][1],b=0,T=0;for(let I=0;I<s.length-1;I++){let M=s[I][0],O=s[I][1],z=mc(s[I+1][0]-M)*this.kx,q=(s[I+1][1]-O)*this.ky,K=0;z===0&&q===0||(K=(mc(c[0]-M)*this.kx*z+(c[1]-O)*this.ky*q)/(z*z+q*q),K>1?(M=s[I+1][0],O=s[I+1][1]):K>0&&(M+=z/this.kx*K,O+=q/this.ky*K)),z=mc(c[0]-M)*this.kx,q=(c[1]-O)*this.ky;const Y=z*z+q*q;Y<f&&(f=Y,p=M,_=O,b=I,T=K)}return{point:[p,_],index:b,t:Math.max(0,Math.min(1,T))}}lineSlice(s,c,f){let p=this.pointOnLine(f,s),_=this.pointOnLine(f,c);if(p.index>_.index||p.index===_.index&&p.t>_.t){const M=p;p=_,_=M}const b=[p.point],T=p.index+1,I=_.index;!zf(f[T],b[0])&&T<=I&&b.push(f[T]);for(let M=T+1;M<=I;M++)b.push(f[M]);return zf(f[I],_.point)||b.push(_.point),b}lineSliceAlong(s,c,f){let p=0;const _=[];for(let b=0;b<f.length-1;b++){const T=f[b],I=f[b+1],M=this.distance(T,I);if(p+=M,p>s&&_.length===0&&_.push(sg(T,I,(s-(p-M))/M)),p>=c)return _.push(sg(T,I,(c-(p-M))/M)),_;p>s&&_.push(I)}return _}bufferPoint(s,c){const f=c/this.ky,p=c/this.kx;return[s[0]-p,s[1]-f,s[0]+p,s[1]+f]}bufferBBox(s,c){const f=c/this.ky,p=c/this.kx;return[s[0]-p,s[1]-f,s[2]+p,s[3]+f]}insideBBox(s,c){return mc(s[0]-c[0])>=0&&mc(s[0]-c[2])<=0&&s[1]>=c[1]&&s[1]<=c[3]}}function zf(u,s){return u[0]===s[0]&&u[1]===s[1]}function sg(u,s,c){const f=mc(s[0]-u[0]);return[u[0]+f*c,u[1]+(s[1]-u[1])*c]}function mc(u){for(;u<-180;)u+=360;for(;u>180;)u-=360;return u}class ag{constructor(s=[],c=(f,p)=>f<p?-1:f>p?1:0){if(this.data=s,this.length=this.data.length,this.compare=c,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],c=this.data.pop();return--this.length>0&&(this.data[0]=c,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:c,compare:f}=this,p=c[s];for(;s>0;){const _=s-1>>1,b=c[_];if(f(p,b)>=0)break;c[s]=b,s=_}c[s]=p}_down(s){const{data:c,compare:f}=this,p=this.length>>1,_=c[s];for(;s<p;){let b=1+(s<<1);const T=b+1;if(T<this.length&&f(c[T],c[b])<0&&(b=T),f(c[b],_)>=0)break;c[s]=c[b],s=b}c[s]=_}}var yn=8192;function Ny(u,s){return s.dist-u.dist}const Bf=100,Uf=50;function $p(u){const s=[1/0,1/0,-1/0,-1/0];if(s.length!==u.length)return!1;for(let c=0;c<s.length;c++)if(s[c]!==u[c])return!1;return!0}function Vf(u){return u[1]-u[0]+1}function Dc(u,s){const c=u[1]>=u[0]&&u[1]<s;return c||console.warn("Distance Expression: Index is out of range"),c}function kl(u,s){if(u[0]>u[1])return[null,null];const c=Vf(u);if(s){if(c===2)return[u,null];const f=Math.floor(c/2);return[[u[0],u[0]+f],[u[0]+f,u[1]]]}{if(c===1)return[u,null];const f=Math.floor(c/2)-1;return[[u[0],u[0]+f],[u[0]+f+1,u[1]]]}}function Ga(u,s){const c=[1/0,1/0,-1/0,-1/0];if(!Dc(s,u.length))return c;for(let f=s[0];f<=s[1];++f)wd(c,u[f]);return c}function gi(u){const s=[1/0,1/0,-1/0,-1/0];for(let c=0;c<u.length;++c)for(let f=0;f<u[c].length;++f)wd(s,u[c][f]);return s}function nh(u,s,c){if($p(u)||$p(s))return NaN;let f=0,p=0;return u[2]<s[0]&&(f=s[0]-u[2]),u[0]>s[2]&&(f=u[0]-s[2]),u[1]>s[3]&&(p=u[1]-s[3]),u[3]<s[1]&&(p=s[1]-u[3]),c.distance([0,0],[f,p])}function Fx(u){return 360*u-180}function My(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function $f(u,s){const c=Math.pow(2,s.z),f=(u.y/yn+s.y)/c;return[Fx((u.x/yn+s.x)/c),My(f)]}function Rv(u,s){const c=[];for(let f=0;f<u.length;++f)c.push($f(u[f],s));return c}function Ls(u,s,c){const f=c.pointOnLine(s,u).point;return c.distance(u,f)}function Ly(u,s,c,f,p){const _=c.slice(f[0],f[1]+1);let b=1/0;for(let T=s[0];T<=s[1];++T)if((b=Math.min(b,Ls(u[T],_,p)))===0)return 0;return b}function og(u,s,c,f,p){const _=Math.min(p.pointToSegmentDistance(u,c,f),p.pointToSegmentDistance(s,c,f)),b=Math.min(p.pointToSegmentDistance(c,u,s),p.pointToSegmentDistance(f,u,s));return Math.min(_,b)}function Dy(u,s,c,f,p){if(!Dc(s,u.length)||!Dc(f,c.length))return NaN;let _=1/0;for(let b=s[0];b<s[1];++b)for(let T=f[0];T<f[1];++T){if(Sd(u[b],u[b+1],c[T],c[T+1]))return 0;_=Math.min(_,og(u[b],u[b+1],c[T],c[T+1],p))}return _}function jv(u,s,c,f,p){if(!Dc(s,u.length)||!Dc(f,c.length))return NaN;let _=1/0;for(let b=s[0];b<=s[1];++b)for(let T=f[0];T<=f[1];++T)if((_=Math.min(_,p.distance(u[b],c[T])))===0)return _;return _}function Yw(u,s,c){if(Lc(u,s,!0))return 0;let f=1/0;for(const p of s){const _=p.length;if(_<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(p[0]!==p[_-1]&&(f=Math.min(f,c.pointToSegmentDistance(u,p[_-1],p[0])))===0||(f=Math.min(f,Ls(u,p,c)))===0)return f}return f}function Xw(u,s,c,f){if(!Dc(s,u.length))return NaN;for(let _=s[0];_<=s[1];++_)if(Lc(u[_],c,!0))return 0;let p=1/0;for(let _=s[0];_<s[1];++_)for(const b of c)for(let T=0,I=b.length,M=I-1;T<I;M=T++){if(Sd(u[_],u[_+1],b[M],b[T]))return 0;p=Math.min(p,og(u[_],u[_+1],b[M],b[T],f))}return p}function Ov(u,s){for(const c of u)for(let f=0;f<=c.length-1;++f)if(Lc(c[f],s,!0))return!0;return!1}function Jw(u,s,c,f=1/0){const p=gi(u),_=gi(s);if(f!==1/0&&nh(p,_,c)>=f)return f;if(Gl(p,_)){if(Ov(u,s))return 0}else if(Ov(s,u))return 0;let b=f;for(const T of u)for(let I=0,M=T.length,O=M-1;I<M;O=I++)for(const z of s)for(let q=0,K=z.length,Y=K-1;q<K;Y=q++){if(Sd(T[O],T[I],z[Y],z[q]))return 0;b=Math.min(b,og(T[O],T[I],z[Y],z[q],c))}return b}function Ry(u,s,c,f,p,_,b){if(_===null||b===null)return;const T=nh(Ga(f,_),Ga(p,b),c);T<s&&u.push({dist:T,range1:_,range2:b})}function Qw(u,s,c,f,p=1/0){let _=Math.min(f.distance(u[0],c[0][0]),p);if(_===0)return _;const b=new ag([{dist:0,range1:[0,u.length-1],range2:[0,0]}],Ny),T=s?Uf:Bf,I=gi(c);for(;b.length;){const M=b.pop();if(M.dist>=_)continue;const O=M.range1;if(Vf(O)<=T){if(!Dc(O,u.length))return NaN;if(s){const z=Xw(u,O,c,f);if((_=Math.min(_,z))===0)return _}else for(let z=O[0];z<=O[1];++z){const q=Yw(u[z],c,f);if((_=Math.min(_,q))===0)return _}}else{const z=kl(O,s);if(z[0]!==null){const q=nh(Ga(u,z[0]),I,f);q<_&&b.push({dist:q,range1:z[0],range2:[0,0]})}if(z[1]!==null){const q=nh(Ga(u,z[1]),I,f);q<_&&b.push({dist:q,range1:z[1],range2:[0,0]})}}}return _}function zx(u,s,c,f,p,_=1/0){let b=Math.min(_,p.distance(u[0],c[0]));if(b===0)return b;const T=new ag([{dist:0,range1:[0,u.length-1],range2:[0,c.length-1]}],Ny),I=s?Uf:Bf,M=f?Uf:Bf;for(;T.length;){const O=T.pop();if(O.dist>=b)continue;const z=O.range1,q=O.range2;if(Vf(z)<=I&&Vf(q)<=M){if(!Dc(z,u.length)||!Dc(q,c.length))return NaN;if(s&&f?b=Math.min(b,Dy(u,z,c,q,p)):s||f?s&&!f?b=Math.min(b,Ly(c,q,u,z,p)):!s&&f&&(b=Math.min(b,Ly(u,z,c,q,p))):b=Math.min(b,jv(u,z,c,q,p)),b===0)return b}else{const K=kl(z,s),Y=kl(q,f);Ry(T,b,p,u,c,K[0],Y[0]),Ry(T,b,p,u,c,K[0],Y[1]),Ry(T,b,p,u,c,K[1],Y[0]),Ry(T,b,p,u,c,K[1],Y[1])}}return b}function Fv(u,s,c,f,p=1/0){let _=p;const b=Ga(u,[0,u.length-1]);for(const T of c)if(!(_!==1/0&&nh(b,Ga(T,[0,T.length-1]),f)>=_)&&(_=Math.min(_,zx(u,s,T,!0,f,_)),_===0))return _;return _}function qp(u,s,c,f,p=1/0){let _=p;const b=Ga(u,[0,u.length-1]);for(const T of c){if(_!==1/0&&nh(b,gi(T),f)>=_)continue;const I=Qw(u,s,T,f,_);if(isNaN(I))return I;if((_=Math.min(_,I))===0)return _}return _}function lg(u){return u==="Point"||u==="MultiPoint"||u==="LineString"||u==="MultiLineString"||u==="Polygon"||u==="MultiPolygon"}class zu{constructor(s,c){this.type=ln,this.geojson=s,this.geometries=c}static parse(s,c){if(s.length!==2)return c.error(`'distance' expression requires either one argument, but found ' ${s.length-1} instead.`);if(vd(s[1])){const f=s[1];if(f.type==="FeatureCollection"){for(let p=0;p<f.features.length;++p)if(lg(f.features[p].geometry.type))return new zu(f,f.features[p].geometry)}else if(f.type==="Feature"){if(lg(f.geometry.type))return new zu(f,f.geometry)}else if(lg(f.type))return new zu(f,f)}return c.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(s){const c=s.geometry(),f=s.canonicalID();if(c!=null&&f!=null){if(s.geometryType()==="Point")return function(p,_,b){const T=[];for(const M of p)for(const O of M)T.push($f(O,_));const I=new Ff(T[0][1],"meters");return b.type==="Point"||b.type==="MultiPoint"||b.type==="LineString"?zx(T,!1,b.type==="Point"?[b.coordinates]:b.coordinates,b.type==="LineString",I):b.type==="MultiLineString"?Fv(T,!1,b.coordinates,I):b.type==="Polygon"||b.type==="MultiPolygon"?qp(T,!1,b.type==="Polygon"?[b.coordinates]:b.coordinates,I):null}(c,f,this.geometries);if(s.geometryType()==="LineString")return function(p,_,b){const T=[];for(const M of p){const O=[];for(const z of M)O.push($f(z,_));T.push(O)}const I=new Ff(T[0][0][1],"meters");if(b.type==="Point"||b.type==="MultiPoint"||b.type==="LineString")return Fv(b.type==="Point"?[b.coordinates]:b.coordinates,b.type==="LineString",T,I);if(b.type==="MultiLineString"){let M=1/0;for(let O=0;O<b.coordinates.length;O++){const z=Fv(b.coordinates[O],!0,T,I,M);if(isNaN(z))return z;if((M=Math.min(M,z))===0)return M}return M}if(b.type==="Polygon"||b.type==="MultiPolygon"){let M=1/0;for(let O=0;O<T.length;O++){const z=qp(T[O],!0,b.type==="Polygon"?[b.coordinates]:b.coordinates,I,M);if(isNaN(z))return z;if((M=Math.min(M,z))===0)return M}return M}return null}(c,f,this.geometries);if(s.geometryType()==="Polygon")return function(p,_,b){const T=[];for(const M of function(O,z){const q=O.length;if(q<=1)return[O];const K=[];let Y,ae;for(let le=0;le<q;le++){const ce=Vh(O[le]);ce!==0&&(O[le].area=Math.abs(ce),ae===void 0&&(ae=ce<0),ae===ce<0?(Y&&K.push(Y),Y=[O[le]]):Y.push(O[le]))}return Y&&K.push(Y),K}(p)){const O=[];for(let z=0;z<M.length;++z)O.push(Rv(M[z],_));T.push(O)}const I=new Ff(T[0][0][0][1],"meters");if(b.type==="Point"||b.type==="MultiPoint"||b.type==="LineString")return qp(b.type==="Point"?[b.coordinates]:b.coordinates,b.type==="LineString",T,I);if(b.type==="MultiLineString"){let M=1/0;for(let O=0;O<b.coordinates.length;O++){const z=qp(b.coordinates[O],!0,T,I,M);if(isNaN(z))return z;if((M=Math.min(M,z))===0)return M}return M}return b.type==="Polygon"||b.type==="MultiPolygon"?function(M,O,z){let q=1/0;for(const K of M)for(const Y of O){const ae=Jw(K,Y,z,q);if(isNaN(ae))return ae;if((q=Math.min(q,ae))===0)return q}return q}(b.type==="Polygon"?[b.coordinates]:b.coordinates,T,I):null}(c,f,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Gp(u){if(u instanceof po&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof qh||u instanceof zu)return!1;if(u instanceof Rc)return u.featureConstant;let s=!0;return u.eachChild(c=>{s&&!Gp(c)&&(s=!1)}),s}function jy(u){if(u instanceof po&&u.name==="feature-state")return!1;let s=!0;return u.eachChild(c=>{s&&!jy(c)&&(s=!1)}),s}function cg(u){if(u instanceof Rc)return new Set([u.key]);let s=new Set;return u.eachChild(c=>{s=new Set([...s,...cg(c)])}),s}function Hp(u,s){if(u instanceof po&&s.indexOf(u.name)>=0)return!1;let c=!0;return u.eachChild(f=>{c&&!Hp(f,s)&&(c=!1)}),c}function Bx(u,s,c){return[u,s,c].filter(Boolean).join("")}function zv(u,s){switch(u){case"string":return bs(s);case"number":return+s;case"boolean":return!!s;case"color":return Ii.parse(s);case"formatted":return eo.fromString(bs(s));case"resolvedImage":return fo.build(bs(s))}return s}function Ux(u,s,c,f){return f!==void 0&&(u=f*Math.round(u/f)),s!==void 0&&u<s&&(u=s),c!==void 0&&u>c&&(u=c),u}class Rc{constructor(s,c,f,p=!1){this.type=s,this.key=c,this.scope=f,this.featureConstant=p}static parse(s,c){let f=c.expectedType;if(f==null&&(f=Hr),s.length<2||s.length>3)return c.error("Invalid number of arguments for 'config' expression.");const p=c.parse(s[1],1);if(!(p instanceof kr))return c.error("Key name of 'config' expression must be a string literal.");let _,b=!0;const T=bs(p.value);if(s.length>=3){const I=c.parse(s[2],2);if(!(I instanceof kr))return c.error("Scope of 'config' expression must be a string literal.");_=bs(I.value)}if(c.options){const I=Bx(T,_,c._scope),M=c.options.get(I);M&&(b=Gp(M.value||M.default))}return new Rc(f,T,_,b)}evaluate(s){const c=Bx(this.key,this.scope,s.scope),f=s.getConfig(c);if(!f)return null;const{type:p,value:_,values:b,minValue:T,maxValue:I,stepValue:M}=f,O=f.default.evaluate(s);let z=O;if(_){const q=s.scope;s.scope=(q||"").split("").slice(1).join(""),z=_.evaluate(s),s.scope=q}return p&&(z=zv(p,z)),z===void 0||T===void 0&&I===void 0&&M===void 0||(typeof z=="number"?z=Ux(z,T,I,M):Array.isArray(z)&&(z=z.map(q=>typeof q=="number"?Ux(q,T,I,M):q))),_!==void 0&&z!==void 0&&b&&!b.includes(z)&&(z=O,p&&(z=zv(p,z))),(p&&p!==this.type||z!==void 0&&!ru(Ca(z),this.type))&&(z=zv(this.type.kind,z)),z}eachChild(){}outputDefined(){return!1}serialize(){const s=["config",this.key];return this.scope&&s.concat(this.scope),s}}class gc{constructor(s,c){this.type=c.type,this.name=s,this.boundExpression=c}static parse(s,c){if(s.length!==2||typeof s[1]!="string")return c.error("'var' expression requires exactly one string literal argument.");const f=s[1];return c.scope.has(f)?new gc(f,c.scope.get(f)):c.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class iu{constructor(s,c=[],f,p=new Wn,_=[],b,T,I){this.registry=s,this.path=c,this.key=c.map(M=>typeof M=="string"?`['${M}']`:`[${M}]`).join(""),this.scope=p,this.errors=_,this.expectedType=f,this._scope=b,this.options=T,this.iconImageUseTheme=I}parse(s,c,f,p,_={}){return c||f?this.concat(c,null,f,p)._parse(s,_):this._parse(s,_)}parseObjectValue(s,c,f,p,_,b={}){return this.concat(c,f,p,_)._parse(s,b)}_parse(s,c){function f(p,_,b){return b==="assert"?new sr(_,[p]):b==="coerce"?new Ms(_,[p]):p}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=typeof s[0]=="string"?this.registry[s[0]]:void 0;if(p){let _=p.parse(s,this);if(!_)return null;if(this.expectedType){const b=this.expectedType,T=_.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||T.kind!=="value")if(b.kind!=="color"&&b.kind!=="formatted"&&b.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string"){if(this.checkSubtype(b,T))return null}else _=f(_,b,c.typeAnnotation||"coerce");else _=f(_,b,c.typeAnnotation||"assert")}if(!(_ instanceof kr)&&_.type.kind!=="resolvedImage"&&Bv(_)){const b=new Mc(this._scope,this.options,this.iconImageUseTheme);try{_=new kr(_.type,_.evaluate(b))}catch(T){return this.error(T.message),null}}return _}return Ms.parse(["to-array",s],this)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,c,f,p){let _=typeof s=="number"?this.path.concat(s):this.path;_=typeof c=="string"?_.concat(c):_;const b=p?this.scope.concat(p):this.scope;return new iu(this.registry,_,f||null,b,this.errors,this._scope,this.options,this.iconImageUseTheme)}error(s,...c){const f=`${this.key}${c.map(p=>`[${p}]`).join("")}`;this.errors.push(new kn(f,s))}checkSubtype(s,c){const f=Fh(s,c);return f&&this.error(f),f}}function Bv(u){if(u instanceof gc)return Bv(u.boundExpression);if(u instanceof po&&u.name==="error"||u instanceof to||u instanceof qh||u instanceof zu||u instanceof Rc)return!1;const s=u instanceof Ms||u instanceof sr;let c=!0;return u.eachChild(f=>{c=s?c&&Bv(f):c&&f instanceof kr}),!!c&&Gp(u)&&Hp(u,["zoom","heatmap-density","worldview","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function ug(u,s){const c=u.length-1;let f,p,_=0,b=c,T=0;for(;_<=b;)if(T=Math.floor((_+b)/2),f=u[T],p=u[T+1],f<=s){if(T===c||s<p)return T;_=T+1}else{if(!(f>s))throw new Ln("Input is not a number.");b=T-1}return 0}class su{constructor(s,c,f){this.type=s,this.input=c,this.labels=[],this.outputs=[];for(const[p,_]of f)this.labels.push(p),this.outputs.push(_)}static parse(s,c){if(s.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return c.error("Expected an even number of arguments.");const f=c.parse(s[1],1,ln);if(!f)return null;const p=[];let _=null;c.expectedType&&c.expectedType.kind!=="value"&&(_=c.expectedType);for(let b=1;b<s.length;b+=2){const T=b===1?-1/0:s[b],I=s[b+1],M=b,O=b+1;if(typeof T!="number")return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(p.length&&p[p.length-1][0]>=T)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const z=c.parse(I,O,_);if(!z)return null;_=_||z.type,p.push([T,z])}return new su(_,f,p)}evaluate(s){const c=this.labels,f=this.outputs;if(c.length===1)return f[0].evaluate(s);const p=this.input.evaluate(s);if(p<=c[0])return f[0].evaluate(s);const _=c.length;return p>=c[_-1]?f[_-1].evaluate(s):f[ug(c,p)].evaluate(s)}eachChild(s){s(this.input);for(const c of this.outputs)s(c)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){const s=["step",this.input.serialize()];for(let c=0;c<this.labels.length;c++)c>0&&s.push(this.labels[c]),s.push(this.outputs[c].serialize());return s}}const jc=.95047,Vx=1.08883,$x=4/29,rh=6/29,Uv=3*rh*rh,Vv=rh*rh*rh,qx=Math.PI/180,e2=180/Math.PI;function Wp(u){return u>Vv?Math.pow(u,1/3):u/Uv+$x}function qf(u){return u>rh?u*u*u:Uv*(u-$x)}function Gh(u){return 255*(u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055)}function Td(u){return(u/=255)<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function Oy(u){const s=Td(u.r),c=Td(u.g),f=Td(u.b),p=Wp((.4124564*s+.3575761*c+.1804375*f)/jc),_=Wp((.2126729*s+.7151522*c+.072175*f)/1);return{l:116*_-16,a:500*(p-_),b:200*(_-Wp((.0193339*s+.119192*c+.9503041*f)/Vx)),alpha:u.a}}function $v(u){let s=(u.l+16)/116,c=isNaN(u.a)?s:s+u.a/500,f=isNaN(u.b)?s:s-u.b/200;return s=1*qf(s),c=jc*qf(c),f=Vx*qf(f),new Ii(Gh(3.2404542*c-1.5371385*s-.4985314*f),Gh(-.969266*c+1.8760108*s+.041556*f),Gh(.0556434*c-.2040259*s+1.0572252*f),u.alpha)}function Gx(u,s,c){const f=s-u;return u+c*(f>180||f<-180?f-360*Math.round(f/360):f)}const Gf={forward:Oy,reverse:$v,interpolate:function(u,s,c){return{l:qe(u.l,s.l,c),a:qe(u.a,s.a,c),b:qe(u.b,s.b,c),alpha:qe(u.alpha,s.alpha,c)}}},Hf={forward:function(u){const{l:s,a:c,b:f}=Oy(u),p=Math.atan2(f,c)*e2;return{h:p<0?p+360:p,c:Math.sqrt(c*c+f*f),l:s,alpha:u.a}},reverse:function(u){const s=u.h*qx,c=u.c;return $v({l:u.l,a:Math.cos(s)*c,b:Math.sin(s)*c,alpha:u.alpha})},interpolate:function(u,s,c){return{h:Gx(u.h,s.h,c),c:qe(u.c,s.c,c),l:qe(u.l,s.l,c),alpha:qe(u.alpha,s.alpha,c)}}};var Hx=Object.freeze({__proto__:null,hcl:Hf,lab:Gf});class Oc{constructor(s,c,f,p,_){this.type=s,this.operator=c,this.interpolation=f,this.input=p,this.labels=[],this.outputs=[];for(const[b,T]of _)this.labels.push(b),this.outputs.push(T)}static interpolationFactor(s,c,f,p){let _=0;if(s.name==="exponential")_=Fy(c,s.base,f,p);else if(s.name==="linear")_=Fy(c,1,f,p);else if(s.name==="cubic-bezier"){const b=s.controlPoints;_=new Pi(b[0],b[1],b[2],b[3]).solve(Fy(c,1,f,p))}return _}static parse(s,c){let[f,p,_,...b]=s;if(!Array.isArray(p)||p.length===0)return c.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const M=p[1];if(typeof M!="number")return c.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:M}}else{if(p[0]!=="cubic-bezier")return c.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const M=p.slice(1);if(M.length!==4||M.some(O=>typeof O!="number"||O<0||O>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:M}}}if(s.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length-1>3&&(s.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(_=c.parse(_,2,ln),!_)return null;const T=[];let I=null;f==="interpolate-hcl"||f==="interpolate-lab"?I=$i:c.expectedType&&c.expectedType.kind!=="value"&&(I=c.expectedType);for(let M=0;M<b.length;M+=2){const O=b[M],z=b[M+1],q=M+3,K=M+4;if(typeof O!="number")return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(T.length&&T[T.length-1][0]>=O)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',q);const Y=c.parse(z,K,I);if(!Y)return null;I=I||Y.type,T.push([O,Y])}return I.kind==="number"||I.kind==="color"||I.kind==="array"&&I.itemType.kind==="number"&&typeof I.N=="number"?new Oc(I,f,p,_,T):c.error(`Type ${Cs(I)} is not interpolatable.`)}evaluate(s){const c=this.labels,f=this.outputs;if(c.length===1)return f[0].evaluate(s);const p=this.input.evaluate(s);if(p<=c[0])return f[0].evaluate(s);const _=c.length;if(p>=c[_-1])return f[_-1].evaluate(s);const b=ug(c,p),T=Oc.interpolationFactor(this.interpolation,p,c[b],c[b+1]),I=f[b].evaluate(s),M=f[b+1].evaluate(s);return this.operator==="interpolate"?Zt[this.type.kind.toLowerCase()](I,M,T):this.operator==="interpolate-hcl"?Hf.reverse(Hf.interpolate(Hf.forward(I),Hf.forward(M),T)):Gf.reverse(Gf.interpolate(Gf.forward(I),Gf.forward(M),T))}eachChild(s){s(this.input);for(const c of this.outputs)s(c)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){let s;s=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const c=[this.operator,s,this.input.serialize()];for(let f=0;f<this.labels.length;f++)c.push(this.labels[f],this.outputs[f].serialize());return c}}function Fy(u,s,c,f){const p=f-c,_=u-c;return p===0?0:s===1?_/p:(Math.pow(s,_)-1)/(Math.pow(s,p)-1)}class dg{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expectected at least one argument.");let f=null;const p=c.expectedType;p&&p.kind!=="value"&&(f=p);const _=[];for(const T of s.slice(1)){const I=c.parse(T,1+_.length,f,void 0,{typeAnnotation:"omit"});if(!I)return null;f=f||I.type,_.push(I)}const b=p&&_.some(T=>Fh(p,T.type));return new dg(b?Hr:f,_)}evaluate(s){let c,f=null,p=0;for(const _ of this.args){if(p++,f=_.evaluate(s),f&&f instanceof fo&&!f.available&&(c||(c=f),f=null,p===this.args.length))return c;if(f!==null)break}return f}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=["coalesce"];return this.eachChild(c=>{s.push(c.serialize())}),s}}class hg{constructor(s,c){this.type=c.type,this.bindings=[].concat(s),this.result=c}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const c of this.bindings)s(c[1]);s(this.result)}static parse(s,c){if(s.length<4)return c.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const f=[];for(let _=1;_<s.length-1;_+=2){const b=s[_];if(typeof b!="string")return c.error(`Expected string, but found ${typeof b} instead.`,_);if(/[^a-zA-Z0-9_]/.test(b))return c.error("Variable names must contain only alphanumeric characters or '_'.",_);const T=c.parse(s[_+1],_+1);if(!T)return null;f.push([b,T])}const p=c.parse(s[s.length-1],s.length-1,c.expectedType,f);return p?new hg(f,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const s=["let"];for(const[c,f]of this.bindings)s.push(c,f.serialize());return s.push(this.result.serialize()),s}}class Zp{constructor(s,c,f){this.type=s,this.index=c,this.input=f}static parse(s,c){if(s.length!==3)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const f=c.parse(s[1],1,ln),p=c.parse(s[2],2,Bs(c.expectedType||Hr));return f&&p?new Zp(p.type.itemType,f,p):null}evaluate(s){const c=this.index.evaluate(s),f=this.input.evaluate(s);if(c<0)throw new Ln("Array index out of bounds: negative index");if(c>=f.length)throw new Ln("Array index out of bounds: index exceeds array size");if(c!==Math.floor(c))throw new Ln("Array index must be an integer. Use at-interpolated for fractional indices");return f[c]}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class qv{constructor(s,c,f){this.type=s,this.index=c,this.input=f}static parse(s,c){if(s.length!==3)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const f=c.parse(s[1],1,ln),p=c.parse(s[2],2,Bs(c.expectedType||Hr));return f&&p?new qv(p.type.itemType,f,p):null}evaluate(s){const c=this.index.evaluate(s),f=this.input.evaluate(s);if(c<0)throw new Ln(`Array index out of bounds: ${c} < 0.`);if(c>f.length-1)throw new Ln(`Array index out of bounds: ${c} > ${f.length-1}.`);if(c===Math.floor(c))return f[c];const p=Math.floor(c),_=Math.ceil(c),b=f[p],T=f[_];if(typeof b!="number"||typeof T!="number")throw new Ln(`Cannot interpolate between non-number values at index ${c}.`);const I=c-p;return b*(1-I)+T*I}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class zy{constructor(s,c){this.type=ur,this.needle=s,this.haystack=c}static parse(s,c){if(s.length!==3)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const f=c.parse(s[1],1,Hr),p=c.parse(s[2],2,Hr);return f&&p?zh(f.type,[ur,lr,ln,Mr,Hr])?new zy(f,p):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Cs(f.type)} instead`):null}evaluate(s){const c=this.needle.evaluate(s),f=this.haystack.evaluate(s);if(f==null)return!1;if(!Du(c,["boolean","string","number","null"]))throw new Ln(`Expected first argument to be of type boolean, string, number or null, but found ${Cs(Ca(c))} instead.`);if(!Du(f,["string","array"]))throw new Ln(`Expected second argument to be of type array or string, but found ${Cs(Ca(f))} instead.`);return f.indexOf(c)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Kp{constructor(s,c,f){this.type=ln,this.needle=s,this.haystack=c,this.fromIndex=f}static parse(s,c){if(s.length<=2||s.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const f=c.parse(s[1],1,Hr),p=c.parse(s[2],2,Hr);if(!f||!p)return null;if(!zh(f.type,[ur,lr,ln,Mr,Hr]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${Cs(f.type)} instead`);if(s.length===4){const _=c.parse(s[3],3,ln);return _?new Kp(f,p,_):null}return new Kp(f,p)}evaluate(s){const c=this.needle.evaluate(s),f=this.haystack.evaluate(s);if(!Du(c,["boolean","string","number","null"]))throw new Ln(`Expected first argument to be of type boolean, string, number or null, but found ${Cs(Ca(c))} instead.`);if(!Du(f,["string","array"]))throw new Ln(`Expected second argument to be of type array or string, but found ${Cs(Ca(f))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(s);return f.indexOf(c,p)}return f.indexOf(c)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const s=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),s]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class U{constructor(s,c,f,p,_,b){this.inputType=s,this.type=c,this.input=f,this.cases=p,this.outputs=_,this.otherwise=b}static parse(s,c){if(s.length<5)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return c.error("Expected an even number of arguments.");let f,p;c.expectedType&&c.expectedType.kind!=="value"&&(p=c.expectedType);const _={},b=[];for(let M=2;M<s.length-1;M+=2){let O=s[M];const z=s[M+1];Array.isArray(O)||(O=[O]);const q=c.concat(M);if(O.length===0)return q.error("Expected at least one branch label.");for(const Y of O){if(typeof Y!="number"&&typeof Y!="string")return q.error("Branch labels must be numbers or strings.");if(typeof Y=="number"&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return q.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Y=="number"&&Math.floor(Y)!==Y)return q.error("Numeric branch labels must be integer values.");if(f){if(q.checkSubtype(f,Ca(Y)))return null}else f=Ca(Y);if(_[String(Y)]!==void 0)return q.error("Branch labels must be unique.");_[String(Y)]=b.length}const K=c.parse(z,M,p);if(!K)return null;p=p||K.type,b.push(K)}const T=c.parse(s[1],1,Hr);if(!T)return null;const I=c.parse(s[s.length-1],s.length-1,p);return I?T.type.kind!=="value"&&c.concat(1).checkSubtype(f,T.type)?null:new U(f,p,T,_,b,I):null}evaluate(s){const c=this.input.evaluate(s);return(ru(Ca(c),this.inputType)&&this.outputs[this.cases[c]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["match",this.input.serialize()],c=Object.keys(this.cases).sort(),f=[],p={};for(const b of c){const T=p[this.cases[b]];T===void 0?(p[this.cases[b]]=f.length,f.push([this.cases[b],[b]])):f[T][1].push(b)}const _=b=>this.inputType.kind==="number"?Number(b):b;for(const[b,T]of f)s.push(T.length===1?_(T[0]):T.map(_)),s.push(this.outputs[b].serialize());return s.push(this.otherwise.serialize()),s}}class Z{constructor(s,c,f){this.type=s,this.branches=c,this.otherwise=f}static parse(s,c){if(s.length<4)return c.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return c.error("Expected an odd number of arguments.");let f;c.expectedType&&c.expectedType.kind!=="value"&&(f=c.expectedType);const p=[];for(let b=1;b<s.length-1;b+=2){const T=c.parse(s[b],b,ur);if(!T)return null;const I=c.parse(s[b+1],b+1,f);if(!I)return null;p.push([T,I]),f=f||I.type}const _=c.parse(s[s.length-1],s.length-1,f);return _?new Z(f,p,_):null}evaluate(s){for(const[c,f]of this.branches)if(c.evaluate(s))return f.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[c,f]of this.branches)s(c),s(f);s(this.otherwise)}outputDefined(){return this.branches.every(([s,c])=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["case"];return this.eachChild(c=>{s.push(c.serialize())}),s}}class oe{constructor(s,c,f,p){this.type=s,this.input=c,this.beginIndex=f,this.endIndex=p}static parse(s,c){if(s.length<=2||s.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const f=c.parse(s[1],1,Hr),p=c.parse(s[2],2,ln);if(!f||!p)return null;if(!zh(f.type,[Bs(Hr),lr,Hr]))return c.error(`Expected first argument to be of type array or string, but found ${Cs(f.type)} instead`);if(s.length===4){const _=c.parse(s[3],3,ln);return _?new oe(f.type,f,p,_):null}return new oe(f.type,f,p)}evaluate(s){const c=this.input.evaluate(s),f=this.beginIndex.evaluate(s);if(!Du(c,["string","array"]))throw new Ln(`Expected first argument to be of type array or string, but found ${Cs(Ca(c))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(s);return c.slice(f,p)}return c.slice(f)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const s=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),s]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}class ye{constructor(s,c){this.type=Bs(lr),this.str=s,this.delimiter=c}static parse(s,c){if(s.length!==3)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const f=c.parse(s[1],1,lr),p=c.parse(s[2],2,lr);return f&&p?new ye(f,p):void 0}evaluate(s){const c=this.str.evaluate(s),f=this.delimiter.evaluate(s);return c.split(f)}eachChild(s){s(this.str),s(this.delimiter)}outputDefined(){return!1}serialize(){return["split",this.str.serialize(),this.delimiter.serialize()]}}function Ne(u,s){return u==="=="||u==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function Be(u,s,c,f){return f.compare(s,c)===0}function $e(u,s,c){const f=u!=="=="&&u!=="!=";return class Ede{constructor(_,b,T){this.type=ur,this.lhs=_,this.rhs=b,this.collator=T,this.hasUntypedArgument=_.type.kind==="value"||b.type.kind==="value"}static parse(_,b){if(_.length!==3&&_.length!==4)return b.error("Expected two or three arguments.");const T=_[0];let I=b.parse(_[1],1,Hr);if(!I)return null;if(!Ne(T,I.type))return b.concat(1).error(`"${T}" comparisons are not supported for type '${Cs(I.type)}'.`);let M=b.parse(_[2],2,Hr);if(!M)return null;if(!Ne(T,M.type))return b.concat(2).error(`"${T}" comparisons are not supported for type '${Cs(M.type)}'.`);if(I.type.kind!==M.type.kind&&I.type.kind!=="value"&&M.type.kind!=="value")return b.error(`Cannot compare types '${Cs(I.type)}' and '${Cs(M.type)}'.`);f&&(I.type.kind==="value"&&M.type.kind!=="value"?I=new sr(M.type,[I]):I.type.kind!=="value"&&M.type.kind==="value"&&(M=new sr(I.type,[M])));let O=null;if(_.length===4){if(I.type.kind!=="string"&&M.type.kind!=="string"&&I.type.kind!=="value"&&M.type.kind!=="value")return b.error("Cannot use collator to compare non-string types.");if(O=b.parse(_[3],3,oa),!O)return null}return new Ede(I,M,O)}evaluate(_){const b=this.lhs.evaluate(_),T=this.rhs.evaluate(_);if(f&&this.hasUntypedArgument){const I=Ca(b),M=Ca(T);if(I.kind!==M.kind||I.kind!=="string"&&I.kind!=="number")throw new Ln(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${I.kind}, ${M.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const I=Ca(b),M=Ca(T);if(I.kind!=="string"||M.kind!=="string")return s(_,b,T)}return this.collator?c(_,b,T,this.collator.evaluate(_)):s(_,b,T)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}serialize(){const _=[u];return this.eachChild(b=>{_.push(b.serialize())}),_}}}const Je=$e("==",function(u,s,c){return s===c},Be),rt=$e("!=",function(u,s,c){return s!==c},function(u,s,c,f){return!Be(0,s,c,f)}),ft=$e("<",function(u,s,c){return s<c},function(u,s,c,f){return f.compare(s,c)<0}),Bt=$e(">",function(u,s,c){return s>c},function(u,s,c,f){return f.compare(s,c)>0}),pn=$e("<=",function(u,s,c){return s<=c},function(u,s,c,f){return f.compare(s,c)<=0}),pt=$e(">=",function(u,s,c){return s>=c},function(u,s,c,f){return f.compare(s,c)>=0});class Gt{constructor(s,c,f,p,_,b){this.type=lr,this.number=s,this.locale=c,this.currency=f,this.unit=p,this.minFractionDigits=_,this.maxFractionDigits=b}static parse(s,c){if(s.length!==3)return c.error("Expected two arguments.");const f=c.parse(s[1],1,ln);if(!f)return null;const p=s[2];if(typeof p!="object"||Array.isArray(p))return c.error("NumberFormat options argument must be an object.");let _=null;if(p.locale&&(_=c.parseObjectValue(p.locale,2,"locale",lr),!_))return null;let b=null;if(p.currency&&(b=c.parseObjectValue(p.currency,2,"currency",lr),!b))return null;let T=null;if(p.unit&&(T=c.parseObjectValue(p.unit,2,"unit",lr),!T))return null;let I=null;if(p["min-fraction-digits"]&&(I=c.parseObjectValue(p["min-fraction-digits"],2,"min-fraction-digits",ln),!I))return null;let M=null;return p["max-fraction-digits"]&&(M=c.parseObjectValue(p["max-fraction-digits"],2,"max-fraction-digits",ln),!M)?null:new Gt(f,_,b,T,I,M)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(s):void 0,unit:this.unit?this.unit.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.unit&&s(this.unit),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const s={};return this.locale&&(s.locale=this.locale.serialize()),this.currency&&(s.currency=this.currency.serialize()),this.unit&&(s.unit=this.unit.serialize()),this.minFractionDigits&&(s["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(s["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),s]}}class tn{constructor(s){this.type=ln,this.input=s}static parse(s,c){if(s.length!==2)return c.error(`Expected 1 argument, but found ${s.length-1} instead.`);const f=c.parse(s[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?c.error(`Expected argument of type string or array, but found ${Cs(f.type)} instead.`):new tn(f):null}evaluate(s){const c=this.input.evaluate(s);if(typeof c=="string"||Array.isArray(c))return c.length;throw new Ln(`Expected value to be of type string or array, but found ${Cs(Ca(c))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){const s=["length"];return this.eachChild(c=>{s.push(c.serialize())}),s}}function In(u){return function(){u=1831565813+(u|=0)|0;let s=Math.imul(u^u>>>15,1|u);return s=s+Math.imul(s^s>>>7,61|s)^s,((s^s>>>14)>>>0)/4294967296}}const sn={"==":Je,"!=":rt,">":Bt,"<":ft,">=":pt,"<=":pn,array:sr,at:Zp,"at-interpolated":qv,boolean:sr,case:Z,coalesce:dg,collator:to,format:Nc,image:_d,in:zy,"index-of":Kp,interpolate:Oc,"interpolate-hcl":Oc,"interpolate-lab":Oc,length:tn,let:hg,literal:kr,match:U,number:sr,"number-format":Gt,object:sr,slice:oe,step:su,string:sr,"to-boolean":Ms,"to-color":Ms,"to-number":Ms,"to-string":Ms,var:gc,within:qh,distance:zu,config:Rc,split:ye};function Dn(u,[s,c,f,p]){s=s.evaluate(u),c=c.evaluate(u),f=f.evaluate(u);const _=p?p.evaluate(u):1,b=Bh(s,c,f,_);if(b)throw new Ln(b);return new Ii(s/255,c/255,f/255,_)}function jn(u,[s,c,f,p]){s=s.evaluate(u),c=c.evaluate(u),f=f.evaluate(u);const _=p?p.evaluate(u):1,b=function(M,O,z,q){return typeof M=="number"&&M>=0&&M<=360?typeof O=="number"&&O>=0&&O<=100&&typeof z=="number"&&z>=0&&z<=100?q===void 0||typeof q=="number"&&q>=0&&q<=1?null:`Invalid hsla value [${[M,O,z,q].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof q=="number"?[M,O,z,q]:[M,O,z]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof q=="number"?[M,O,z,q]:[M,O,z]).join(", ")}]: 'h' must be between 0 and 360.`}(s,c,f,_);if(b)throw new Ln(b);const T=`hsla(${s}, ${c}%, ${f}%, ${_})`,I=Ii.parse(T);if(!I)throw new Ln(`Failed to parse HSLA color: ${T}`);return I}function rr(u,s){return u in s}function Hn(u,s){const c=s[u];return c===void 0?null:c}function ei(u){return{type:u}}function Rr(u){return{result:"success",value:u}}function Di(u){return{result:"error",value:u}}function ri(u,s){return!!u&&!!u.parameters&&u.parameters.indexOf(s)>-1}function ps(u){return u["property-type"]==="data-driven"}function mo(u){return ri(u.expression,"measure-light")}function Zi(u){return ri(u.expression,"zoom")}function ti(u){return!!u.expression&&u.expression.interpolated}function _r(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function Ha(u){return u}function Fi(u,s){const c=s.type==="color",f=u.stops&&typeof u.stops[0][0]=="object",p=f||!(f||u.property!==void 0),_=u.type||(ti(s)?"exponential":"interval");if(c&&((u=Object.assign({},u)).stops&&(u.stops=u.stops.map(M=>[M[0],Ii.parse(M[1])])),u.default=Ii.parse(u.default?u.default:s.default)),u.colorSpace&&u.colorSpace!=="rgb"&&!Hx[u.colorSpace])throw new Error(`Unknown color space: ${u.colorSpace}`);let b,T,I;if(_==="exponential")b=Il;else if(_==="interval")b=Fa;else if(_==="categorical"){b=Ia,T=Object.create(null);for(const M of u.stops)T[M[0]]=M[1];I=typeof u.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);b=io}if(f){const M={},O=[];for(let K=0;K<u.stops.length;K++){const Y=u.stops[K],ae=Y[0].zoom;M[ae]===void 0&&(M[ae]={zoom:ae,type:u.type,property:u.property,default:u.default,stops:[]},O.push(ae)),M[ae].stops.push([Y[0].value,Y[1]])}const z=[];for(const K of O)z.push([M[K].zoom,Fi(M[K],s)]);const q={name:"linear"};return{kind:"composite",interpolationType:q,interpolationFactor:Oc.interpolationFactor.bind(void 0,q),zoomStops:z.map(K=>K[0]),evaluate:({zoom:K},Y)=>Il({stops:z,base:u.base},s,K).evaluate(K,Y)}}if(p){const M=_==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:Oc.interpolationFactor.bind(void 0,M),zoomStops:u.stops.map(O=>O[0]),evaluate:({zoom:O})=>b(u,s,O,T,I)}}return{kind:"source",evaluate(M,O){const z=O&&O.properties?O.properties[u.property]:void 0;return z===void 0?ds(u.default,s.default):b(u,s,z,T,I)}}}function ds(u,s,c){return u!==void 0?u:s!==void 0?s:c!==void 0?c:void 0}function Ia(u,s,c,f,p){return ds(typeof c===p?f[c]:void 0,u.default,s.default)}function Fa(u,s,c){if(!dl(c))return ds(u.default,s.default);const f=u.stops.length;if(f===1||c<=u.stops[0][0])return u.stops[0][1];if(c>=u.stops[f-1][0])return u.stops[f-1][1];const p=ug(u.stops.map(_=>_[0]),c);return u.stops[p][1]}function Il(u,s,c){const f=u.base!==void 0?u.base:1;if(!dl(c))return ds(u.default,s.default);const p=u.stops.length;if(p===1||c<=u.stops[0][0])return u.stops[0][1];if(c>=u.stops[p-1][0])return u.stops[p-1][1];const _=ug(u.stops.map(O=>O[0]),c),b=function(O,z,q,K){const Y=K-q,ae=O-q;return Y===0?0:z===1?ae/Y:(Math.pow(z,ae)-1)/(Math.pow(z,Y)-1)}(c,f,u.stops[_][0],u.stops[_+1][0]),T=u.stops[_][1],I=u.stops[_+1][1];let M=Zt[s.type]||Ha;if(u.colorSpace&&u.colorSpace!=="rgb"){const O=Hx[u.colorSpace];M=(z,q)=>O.reverse(O.interpolate(O.forward(z),O.forward(q),b))}return typeof T.evaluate=="function"?{evaluate(...O){const z=T.evaluate.apply(void 0,O),q=I.evaluate.apply(void 0,O);if(z!==void 0&&q!==void 0)return M(z,q,b)}}:M(T,I,b)}function io(u,s,c){return s.type==="color"?c=Ii.parse(c):s.type==="formatted"?c=eo.fromString(c.toString()):s.type==="resolvedImage"?c=fo.build(c.toString()):hr(c)===s.type||s.type==="enum"&&s.values[c]||(c=void 0),ds(c,u.default,s.default)}po.register(sn,{error:[{kind:"error"},[lr],(u,[s])=>{throw new Ln(s.evaluate(u))}],typeof:[lr,[Hr],(u,[s])=>Cs(Ca(s.evaluate(u)))],"to-rgba":[Bs(ln,4),[$i],(u,[s])=>s.evaluate(u).toNonPremultipliedRenderColor(null).toArray()],"to-hsla":[Bs(ln,4),[$i],(u,[s])=>s.evaluate(u).toNonPremultipliedRenderColor(null).toHslaArray()],rgb:[$i,[ln,ln,ln],Dn],rgba:[$i,[ln,ln,ln,ln],Dn],hsl:[$i,[ln,ln,ln],jn],hsla:[$i,[ln,ln,ln,ln],jn],has:{type:ur,overloads:[[[lr],(u,[s])=>rr(s.evaluate(u),u.properties())],[[lr,aa],(u,[s,c])=>rr(s.evaluate(u),c.evaluate(u))]]},get:{type:Hr,overloads:[[[lr],(u,[s])=>Hn(s.evaluate(u),u.properties())],[[lr,aa],(u,[s,c])=>Hn(s.evaluate(u),c.evaluate(u))]]},"feature-state":[Hr,[lr],(u,[s])=>Hn(s.evaluate(u),u.featureState||{})],properties:[aa,[],u=>u.properties()],"geometry-type":[lr,[],u=>u.geometryType()],worldview:[lr,[],u=>u.globals.worldview||""],id:[Hr,[],u=>u.id()],zoom:[ln,[],u=>u.globals.zoom],pitch:[ln,[],u=>u.globals.pitch||0],"distance-from-center":[ln,[],u=>u.distanceFromCenter()],"measure-light":[ln,[lr],(u,[s])=>u.measureLight(s.evaluate(u))],"heatmap-density":[ln,[],u=>u.globals.heatmapDensity||0],"line-progress":[ln,[],u=>u.globals.lineProgress||0],"raster-value":[ln,[],u=>u.globals.rasterValue||0],"raster-particle-speed":[ln,[],u=>u.globals.rasterParticleSpeed||0],"sky-radial-progress":[ln,[],u=>u.globals.skyRadialProgress||0],accumulated:[Hr,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[ln,ei(ln),(u,s)=>{let c=0;for(const f of s)c+=f.evaluate(u);return c}],"*":[ln,ei(ln),(u,s)=>{let c=1;for(const f of s)c*=f.evaluate(u);return c}],"-":{type:ln,overloads:[[[ln,ln],(u,[s,c])=>s.evaluate(u)-c.evaluate(u)],[[ln],(u,[s])=>-s.evaluate(u)]]},"/":[ln,[ln,ln],(u,[s,c])=>s.evaluate(u)/c.evaluate(u)],"%":[ln,[ln,ln],(u,[s,c])=>s.evaluate(u)%c.evaluate(u)],ln2:[ln,[],()=>Math.LN2],pi:[ln,[],()=>Math.PI],e:[ln,[],()=>Math.E],"^":[ln,[ln,ln],(u,[s,c])=>Math.pow(s.evaluate(u),c.evaluate(u))],sqrt:[ln,[ln],(u,[s])=>Math.sqrt(s.evaluate(u))],log10:[ln,[ln],(u,[s])=>Math.log(s.evaluate(u))/Math.LN10],ln:[ln,[ln],(u,[s])=>Math.log(s.evaluate(u))],log2:[ln,[ln],(u,[s])=>Math.log2(s.evaluate(u))],sin:[ln,[ln],(u,[s])=>Math.sin(s.evaluate(u))],cos:[ln,[ln],(u,[s])=>Math.cos(s.evaluate(u))],tan:[ln,[ln],(u,[s])=>Math.tan(s.evaluate(u))],asin:[ln,[ln],(u,[s])=>Math.asin(s.evaluate(u))],acos:[ln,[ln],(u,[s])=>Math.acos(s.evaluate(u))],atan:[ln,[ln],(u,[s])=>Math.atan(s.evaluate(u))],min:[ln,ei(ln),(u,s)=>Math.min(...s.map(c=>c.evaluate(u)))],max:[ln,ei(ln),(u,s)=>Math.max(...s.map(c=>c.evaluate(u)))],abs:[ln,[ln],(u,[s])=>Math.abs(s.evaluate(u))],round:[ln,[ln],(u,[s])=>{const c=s.evaluate(u);return c<0?-Math.round(-c):Math.round(c)}],floor:[ln,[ln],(u,[s])=>Math.floor(s.evaluate(u))],ceil:[ln,[ln],(u,[s])=>Math.ceil(s.evaluate(u))],"filter-==":[ur,[lr,Hr],(u,[s,c])=>u.properties()[s.value]===c.value],"filter-id-==":[ur,[Hr],(u,[s])=>u.id()===s.value],"filter-type-==":[ur,[lr],(u,[s])=>u.geometryType()===s.value],"filter-<":[ur,[lr,Hr],(u,[s,c])=>{const f=u.properties()[s.value],p=c.value;return typeof f==typeof p&&f<p}],"filter-id-<":[ur,[Hr],(u,[s])=>{const c=u.id(),f=s.value;return typeof c==typeof f&&c<f}],"filter->":[ur,[lr,Hr],(u,[s,c])=>{const f=u.properties()[s.value],p=c.value;return typeof f==typeof p&&f>p}],"filter-id->":[ur,[Hr],(u,[s])=>{const c=u.id(),f=s.value;return typeof c==typeof f&&c>f}],"filter-<=":[ur,[lr,Hr],(u,[s,c])=>{const f=u.properties()[s.value],p=c.value;return typeof f==typeof p&&f<=p}],"filter-id-<=":[ur,[Hr],(u,[s])=>{const c=u.id(),f=s.value;return typeof c==typeof f&&c<=f}],"filter->=":[ur,[lr,Hr],(u,[s,c])=>{const f=u.properties()[s.value],p=c.value;return typeof f==typeof p&&f>=p}],"filter-id->=":[ur,[Hr],(u,[s])=>{const c=u.id(),f=s.value;return typeof c==typeof f&&c>=f}],"filter-has":[ur,[Hr],(u,[s])=>s.value in u.properties()],"filter-has-id":[ur,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[ur,[Bs(lr)],(u,[s])=>s.value.indexOf(u.geometryType())>=0],"filter-id-in":[ur,[Bs(Hr)],(u,[s])=>s.value.indexOf(u.id())>=0],"filter-in-small":[ur,[lr,Bs(Hr)],(u,[s,c])=>c.value.indexOf(u.properties()[s.value])>=0],"filter-in-large":[ur,[lr,Bs(Hr)],(u,[s,c])=>function(f,p,_,b){for(;_<=b;){const T=_+b>>1;if(p[T]===f)return!0;p[T]>f?b=T-1:_=T+1}return!1}(u.properties()[s.value],c.value,0,c.value.length-1)],all:{type:ur,overloads:[[[ur,ur],(u,[s,c])=>s.evaluate(u)&&c.evaluate(u)],[ei(ur),(u,s)=>{for(const c of s)if(!c.evaluate(u))return!1;return!0}]]},any:{type:ur,overloads:[[[ur,ur],(u,[s,c])=>s.evaluate(u)||c.evaluate(u)],[ei(ur),(u,s)=>{for(const c of s)if(c.evaluate(u))return!0;return!1}]]},"!":[ur,[ur],(u,[s])=>!s.evaluate(u)],"is-supported-script":[ur,[lr],(u,[s])=>{const c=u.globals&&u.globals.isSupportedScript;return!c||c(s.evaluate(u))}],upcase:[lr,[lr],(u,[s])=>s.evaluate(u).toUpperCase()],downcase:[lr,[lr],(u,[s])=>s.evaluate(u).toLowerCase()],concat:[lr,ei(Hr),(u,s)=>s.map(c=>bs(c.evaluate(u))).join("")],"resolved-locale":[lr,[oa],(u,[s])=>s.evaluate(u).resolvedLocale()],random:[ln,[ln,ln,Hr],(u,s)=>{const[c,f,p]=s.map(b=>b.evaluate(u));if(c>f||c===f)return c;let _;if(typeof p=="string")_=function(b){let T=0;if(b.length===0)return T;for(let I=0;I<b.length;I++)T=(T<<5)-T+b.charCodeAt(I),T|=0;return T}(p);else{if(typeof p!="number")throw new Ln(`Invalid seed input: ${p}`);_=p}return c+In(_)()*(f-c)}]});class Go{constructor(s,c,f,p,_){this.expression=s,this._warningHistory={},this._evaluator=new Mc(f,p,_),this._defaultValue=c?function(b){return b.type==="color"&&(_r(b.default)||Array.isArray(b.default))?new Ii(0,0,0,0):b.type==="color"?Ii.parse(b.default)||null:b.default===void 0?null:b.default}(c):null,this._enumValues=c&&c.type==="enum"?c.values:null,this.configDependencies=cg(s)}evaluateWithoutErrorHandling(s,c,f,p,_,b,T,I){return this._evaluator.globals=s,this._evaluator.feature=c,this._evaluator.featureState=f,this._evaluator.canonical=p||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=b,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=I||null,this.expression.evaluate(this._evaluator)}evaluate(s,c,f,p,_,b,T,I,M){this._evaluator.globals=s,this._evaluator.feature=c||null,this._evaluator.featureState=f||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=b||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=I||null,this._evaluator.iconImageUseTheme=M||null;try{const O=this.expression.evaluate(this._evaluator);if(O==null||typeof O=="number"&&O!=O)return this._defaultValue;if(this._enumValues&&!(O in this._enumValues))throw new Ln(`Expected value to be one of ${Object.keys(this._enumValues).map(z=>JSON.stringify(z)).join(", ")}, but found ${JSON.stringify(O)} instead.`);return O}catch(O){return this._warningHistory[O.message]||(this._warningHistory[O.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${O.message}`)),this._defaultValue}}}function hl(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in sn}function pa(u,s,c,f,p){const _=new iu(sn,[],s?function(T){const I={color:$i,string:lr,number:ln,enum:lr,boolean:ur,formatted:Aa,resolvedImage:Oa};return T.type==="array"?Bs(I[T.value]||Hr,T.length):I[T.type]}(s):void 0,void 0,void 0,c,f,p),b=_.parse(u,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return b?Rr(new Go(b,s,c,f,p)):Di(_.errors)}class ms{constructor(s,c,f,p){this.kind=s,this._styleExpression=c,this.isLightConstant=f,this.isLineProgressConstant=p,this.isStateDependent=s!=="constant"&&!jy(c.expression),this.configDependencies=cg(c.expression)}evaluateWithoutErrorHandling(s,c,f,p,_,b){return this._styleExpression.evaluateWithoutErrorHandling(s,c,f,p,_,b)}evaluate(s,c,f,p,_,b,T){return this._styleExpression.evaluate(s,c,f,p,_,b,void 0,void 0,T)}}class ws{constructor(s,c,f,p,_,b){this.kind=s,this.zoomStops=f,this._styleExpression=c,this.isStateDependent=s!=="camera"&&!jy(c.expression),this.isLightConstant=_,this.isLineProgressConstant=b,this.configDependencies=cg(c.expression),this.interpolationType=p}evaluateWithoutErrorHandling(s,c,f,p,_,b){return this._styleExpression.evaluateWithoutErrorHandling(s,c,f,p,_,b)}evaluate(s,c,f,p,_,b){return this._styleExpression.evaluate(s,c,f,p,_,b)}interpolationFactor(s,c,f){return this.interpolationType?Oc.interpolationFactor(this.interpolationType,s,c,f):0}}function za(u,s,c,f,p){if((u=pa(u,s,c,f,p)).result==="error")return u;const _=u.value.expression,b=Gp(_);if(!b&&!ps(s))return Di([new kn("","data expressions not supported")]);const T=Hp(_,["zoom","pitch","distance-from-center"]);if(!T&&!Zi(s))return Di([new kn("","zoom expressions not supported")]);const I=Hp(_,["measure-light"]);if(!I&&!mo(s))return Di([new kn("","measure-light expression not supported")]);const M=Hp(_,["line-progress"]);if(!M&&!function(q){return ri(q.expression,"line-progress")}(s))return Di([new kn("","line-progress expression not supported")]);const O=s.expression&&s.expression.relaxZoomRestriction,z=Io(_);return z||T||O?z instanceof kn?Di([z]):z instanceof Oc&&!ti(s)?Di([new kn("",'"interpolate" expressions cannot be used with this property')]):Rr(z?new ws(b&&M?"camera":"composite",u.value,z.labels,z instanceof Oc?z.interpolation:void 0,I,M):new ms(b&&M?"constant":"source",u.value,I,M)):Di([new kn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Ws{constructor(s,c){this._parameters=s,this._specification=c,Object.assign(this,Fi(this._parameters,this._specification))}static deserialize(s){return new Ws(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function Io(u){let s=null;if(u instanceof hg)s=Io(u.result);else if(u instanceof dg){for(const c of u.args)if(s=Io(c),s)break}else(u instanceof su||u instanceof Oc)&&u.input instanceof po&&u.input.name==="zoom"&&(s=u);return s instanceof kn||u.eachChild(c=>{const f=Io(c);f instanceof kn?s=f:s&&f&&s!==f&&(s=new kn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}var Hl,Ba,Wl=function(){if(Ba)return Hl;Ba=1,Hl=s;var u=3;function s(c,f,p){var _=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var b=new Int32Array(this.arrayBuffer);c=b[0],this.d=(f=b[1])+2*(p=b[2]);for(var T=0;T<this.d*this.d;T++){var I=b[u+T],M=b[u+T+1];_.push(I===M?null:b.subarray(I,M))}var O=b[u+_.length+1];this.keys=b.subarray(b[u+_.length],O),this.bboxes=b.subarray(O),this.insert=this._insertReadonly}else{this.d=f+2*p;for(var z=0;z<this.d*this.d;z++)_.push([]);this.keys=[],this.bboxes=[]}this.n=f,this.extent=c,this.padding=p,this.scale=f/c,this.uid=0;var q=p/f*c;this.min=-q,this.max=c+q}return s.prototype.insert=function(c,f,p,_,b){this._forEachCell(f,p,_,b,this._insertCell,this.uid++),this.keys.push(c),this.bboxes.push(f),this.bboxes.push(p),this.bboxes.push(_),this.bboxes.push(b)},s.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},s.prototype._insertCell=function(c,f,p,_,b,T){this.cells[b].push(T)},s.prototype.query=function(c,f,p,_,b){var T=this.min,I=this.max;if(c<=T&&f<=T&&I<=p&&I<=_&&!b)return Array.prototype.slice.call(this.keys);var M=[];return this._forEachCell(c,f,p,_,this._queryCell,M,{},b),M},s.prototype._queryCell=function(c,f,p,_,b,T,I,M){var O=this.cells[b];if(O!==null)for(var z=this.keys,q=this.bboxes,K=0;K<O.length;K++){var Y=O[K];if(I[Y]===void 0){var ae=4*Y;(M?M(q[ae+0],q[ae+1],q[ae+2],q[ae+3]):c<=q[ae+2]&&f<=q[ae+3]&&p>=q[ae+0]&&_>=q[ae+1])?(I[Y]=!0,T.push(z[Y])):I[Y]=!1}}},s.prototype._forEachCell=function(c,f,p,_,b,T,I,M){for(var O=this._convertToCellCoord(c),z=this._convertToCellCoord(f),q=this._convertToCellCoord(p),K=this._convertToCellCoord(_),Y=O;Y<=q;Y++)for(var ae=z;ae<=K;ae++){var le=this.d*ae+Y;if((!M||M(this._convertFromCellCoord(Y),this._convertFromCellCoord(ae),this._convertFromCellCoord(Y+1),this._convertFromCellCoord(ae+1)))&&b.call(this,c,f,p,_,le,T,I,M))return}},s.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale},s.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))},s.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,f=u+this.cells.length+1+1,p=0,_=0;_<this.cells.length;_++)p+=this.cells[_].length;var b=new Int32Array(f+p+this.keys.length+this.bboxes.length);b[0]=this.extent,b[1]=this.n,b[2]=this.padding;for(var T=f,I=0;I<c.length;I++){var M=c[I];b[u+I]=T,b.set(M,T),T+=M.length}return b[u+c.length]=T,b.set(this.keys,T),b[u+c.length+1]=T+=this.keys.length,b.set(this.bboxes,T),T+=this.bboxes.length,b.buffer},Hl}(),Us=_i(Wl);const Ua={};function Pn(u,s,c={}){Object.defineProperty(u,"_classRegistryKey",{value:s,writable:!1}),Ua[s]={klass:u,omit:c.omit||[]}}Pn(Object,"Object"),Us.serialize=function(u,s){const c=u.toArrayBuffer();return s&&s.add(c),{buffer:c}},Us.deserialize=function(u){return new Us(u.buffer)},Object.defineProperty(Us,"name",{value:"Grid"}),Pn(Us,"Grid"),delete zt.prototype.constructor,typeof DOMMatrix<"u"&&Pn(DOMMatrix,"DOMMatrix"),Pn(Ii,"Color"),Pn(Error,"Error"),Pn(eo,"Formatted"),Pn(yd,"FormattedSection"),Pn(ng,"AJAXError"),Pn(fo,"ResolvedImage"),Pn(Ws,"StylePropertyFunction"),Pn(Go,"StyleExpression",{omit:["_evaluator"]}),Pn(ho,"ImageId"),Pn(Ta,"ImageVariant"),Pn(ws,"ZoomDependentExpression"),Pn(ms,"ZoomConstantExpression"),Pn(po,"CompoundExpression",{omit:["_evaluate"]});for(const u in sn)Ua[sn[u]._classRegistryKey]||Pn(sn[u],`Expression${u}`);function fl(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function go(u){return self.ImageBitmap&&u instanceof ImageBitmap}function No(u,s){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp)return u;if(fl(u)||go(u))return s&&s.add(u),u;if(ArrayBuffer.isView(u))return s&&s.add(u.buffer),u;if(u instanceof ImageData)return s&&s.add(u.data.buffer),u;if(Array.isArray(u)){const c=[];for(const f of u)c.push(No(f,s));return c}if(u instanceof Map){const c={$name:"Map",entries:[]};for(const[f,p]of u.entries())c.entries.push(No(f),No(p,s));return c}if(u instanceof Set){const c={$name:"Set"};let f=0;for(const p of u.values())c[++f]=No(p);return c}if(u instanceof DOMMatrix){const c={$name:"DOMMatrix"},f=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const p of f)c[p]=u[p];return c}if(typeof u=="bigint")return{$name:"BigInt",value:u.toString()};if(typeof u=="object"){const c=u.constructor,f=c._classRegistryKey;if(!f)throw new Error(`Can't serialize object of unregistered class "${c.name}".`);const p=c.serialize?c.serialize(u,s):{};if(!c.serialize){for(const _ in u)u.hasOwnProperty(_)&&(Ua[f].omit.indexOf(_)>=0||(p[_]=No(u[_],s)));u instanceof Error&&(p.message=u.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(p.$name=f),p}throw new Error("can't serialize object of type "+typeof u)}function yo(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||fl(u)||go(u)||ArrayBuffer.isView(u)||u instanceof ImageData)return u;if(Array.isArray(u))return u.map(yo);if(typeof u=="object"){const s=u.$name||"Object";if(s==="Map"){const p=u.entries||[],_=new Map;for(let b=0;b<p.length;b+=2)_.set(yo(p[b]),yo(p[b+1]));return _}if(s==="Set"){const p=new Set;for(const _ of Object.keys(u))_!=="$name"&&p.add(yo(u[_]));return p}if(s==="DOMMatrix"){let p;return p=u.is2D?[u.a,u.b,u.c,u.d,u.e,u.f]:[u.m11,u.m12,u.m13,u.m14,u.m21,u.m22,u.m23,u.m24,u.m31,u.m32,u.m33,u.m34,u.m41,u.m42,u.m43,u.m44],new DOMMatrix(p)}if(s==="BigInt")return BigInt(u.value);const{klass:c}=Ua[s];if(!c)throw new Error(`Can't deserialize unregistered class "${s}".`);if(c.deserialize)return c.deserialize(u);const f=Object.create(c.prototype);for(const p of Object.keys(u))p!=="$name"&&(f[p]=yo(u[p]));return f}throw new Error("can't deserialize object of type "+typeof u)}const nr={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519,Osage:u=>u>=66736&&u<=66815,"CJK Unified Ideographs Extension B":u=>u>=131072&&u<=173791};function ma(u){for(const s of u)if(Cd(s.charCodeAt(0)))return!0;return!1}function yc(u){for(const s of u)if(!vc(s.charCodeAt(0)))return!1;return!0}function vc(u){return!(nr.Arabic(u)||nr["Arabic Supplement"](u)||nr["Arabic Extended-A"](u)||nr["Arabic Presentation Forms-A"](u)||nr["Arabic Presentation Forms-B"](u))}function Cd(u){return!(u!==746&&u!==747&&(u<4352||!(nr["Bopomofo Extended"](u)||nr.Bopomofo(u)||nr["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||nr["CJK Compatibility Ideographs"](u)||nr["CJK Compatibility"](u)||nr["CJK Radicals Supplement"](u)||nr["CJK Strokes"](u)||!(!nr["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||nr["CJK Unified Ideographs Extension A"](u)||nr["CJK Unified Ideographs"](u)||nr["Enclosed CJK Letters and Months"](u)||nr["Hangul Compatibility Jamo"](u)||nr["Hangul Jamo Extended-A"](u)||nr["Hangul Jamo Extended-B"](u)||nr["Hangul Jamo"](u)||nr["Hangul Syllables"](u)||nr.Hiragana(u)||nr["Ideographic Description Characters"](u)||nr.Kanbun(u)||nr["Kangxi Radicals"](u)||nr["Katakana Phonetic Extensions"](u)||nr.Katakana(u)&&u!==12540||!(!nr["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!nr["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||nr["Unified Canadian Aboriginal Syllabics"](u)||nr["Unified Canadian Aboriginal Syllabics Extended"](u)||nr["Vertical Forms"](u)||nr["Yijing Hexagram Symbols"](u)||nr["Yi Syllables"](u)||nr["Yi Radicals"](u))))}function au(u){return!(Cd(u)||function(s){return!!(nr["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||nr["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||nr["Letterlike Symbols"](s)||nr["Number Forms"](s)||nr["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||nr["Control Pictures"](s)&&s!==9251||nr["Optical Character Recognition"](s)||nr["Enclosed Alphanumerics"](s)||nr["Geometric Shapes"](s)||nr["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||nr["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||nr["CJK Symbols and Punctuation"](s)||nr.Katakana(s)||nr["Private Use Area"](s)||nr["CJK Compatibility Forms"](s)||nr["Small Form Variants"](s)||nr["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)}(u))}function pl(u){return nr.Arabic(u)||nr["Arabic Supplement"](u)||nr["Arabic Extended-A"](u)||nr["Arabic Presentation Forms-A"](u)||nr["Arabic Presentation Forms-B"](u)}function fg(u){return u>=1424&&u<=2303||nr["Arabic Presentation Forms-A"](u)||nr["Arabic Presentation Forms-B"](u)}function Gv(u,s){return!(!s&&fg(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||nr.Khmer(u))}function By(u){for(const s of u)if(fg(s.charCodeAt(0)))return!0;return!1}const Qo={unavailable:"unavailable",deferred:"deferred",loading:"loading",parsing:"parsing",parsed:"parsed",loaded:"loaded",error:"error"};let Hv=null,Nl=Qo.unavailable,Ed=null;const ih=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&(Nl=Qo.error),Hv&&Hv(u)};function Wv(){Zv.fire(new El("pluginStateChange",{pluginStatus:Nl,pluginURL:Ed}))}const Zv=new gd,Uy=function(){return Nl},Hh=function(){if(Nl!==Qo.deferred||!Ed)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Nl=Qo.loading,Wv(),Ed&&uc({url:Ed},u=>{u?ih(u):(Nl=Qo.loaded,Wv())})},Fc={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Nl===Qo.loaded||Fc.applyArabicShaping!=null,isLoading:()=>Nl===Qo.loading,setState(u){Nl=u.pluginStatus,Ed=u.pluginURL},isParsing:()=>Nl===Qo.parsing,isParsed:()=>Nl===Qo.parsed,getPluginURL:()=>Ed};class hs{constructor(s,c){this.zoom=s,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.transition=c.transition,this.pitch=c.pitch,this.brightness=c.brightness,this.worldview=c.worldview):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(s){return function(c,f){for(const p of c)if(!Gv(p.charCodeAt(0),f))return!1;return!0}(s,Fc.isLoaded())}}class Wh{constructor(s,c,f,p,_){this.property=s,this.value=c,this.expression=function(b,T,I,M,O){if(_r(b))return new Ws(b,T);if(hl(b)||Array.isArray(b)&&b.length>0){const z=za(b,T,I,M,O);if(z.result==="error")throw new Error(z.value.map(q=>`${q.key}: ${q.message}`).join(", "));return z.value}{let z=b;return typeof b=="string"&&T.type==="color"&&(z=Ii.parse(b)),{kind:"constant",configDependencies:new Set,evaluate:()=>z}}}(c===void 0?s.specification.default:c,s.specification,f,p,_)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(s,c,f,p){return this.property.possiblyEvaluate(this,s,c,f,p)}}class Yp{constructor(s,c,f,p){this.property=s,this.value=new Wh(s,void 0,c,f,p)}transitioned(s,c){return new zc(this.property,this.value,c,Object.assign({},s.transition,this.transition),s.now)}untransitioned(){return new zc(this.property,this.value,null,{},0)}}class Vy{constructor(s,c,f,p){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues),this._scope=c,this._options=f,this._iconImageUseTheme=p,this.configDependencies=new Set}getValue(s){return Fr(this._values[s].value.value)}setValue(s,c){this._values.hasOwnProperty(s)||(this._values[s]=new Yp(this._values[s].property,this._scope,this._options,this._iconImageUseTheme)),this._values[s].value=new Wh(this._values[s].property,c===null?void 0:Fr(c),this._scope,this._options,this._iconImageUseTheme),this._values[s].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[s].value.expression.configDependencies]))}setTransitionOrValue(s,c){c&&(this._options=c);const f=this._properties.properties;if(s)for(const p in s){const _=s[p];if(p.endsWith("-transition")){const b=p.slice(0,-11);f[b]&&this.setTransition(b,_)}else f.hasOwnProperty(p)&&this.setValue(p,_)}}getTransition(s){return Fr(this._values[s].transition)}setTransition(s,c){this._values.hasOwnProperty(s)||(this._values[s]=new Yp(this._values[s].property)),this._values[s].transition=Fr(c)||void 0}serialize(){const s={};for(const c of Object.keys(this._values)){const f=this.getValue(c);f!==void 0&&(s[c]=f);const p=this.getTransition(c);p!==void 0&&(s[`${c}-transition`]=p)}return s}transitioned(s,c){const f=new $y(this._properties);for(const p of Object.keys(this._values))f._values[p]=this._values[p].transitioned(s,c._values[p]);return f}untransitioned(){const s=new $y(this._properties);for(const c of Object.keys(this._values))s._values[c]=this._values[c].untransitioned();return s}}class zc{constructor(s,c,f,p,_){const b=p.delay||0,T=p.duration||0;_=_||0,this.property=s,this.value=c,this.begin=_+b,this.end=this.begin+T,s.specification.transition&&(p.delay||p.duration)&&(this.prior=f)}possiblyEvaluate(s,c,f){const p=s.now||0,_=this.value.possiblyEvaluate(s,c,f),b=this.prior;if(b){if(p>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(p<this.begin)return b.possiblyEvaluate(s,c,f);{const T=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(s,c,f),_,Ie(T))}}return _}}class $y{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,c,f){const p=new Zh(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].possiblyEvaluate(s,c,f);return p}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class Wf{constructor(s,c,f,p){this._properties=s,this._values=Object.create(s.defaultPropertyValues),this._scope=c,this._options=f,this._iconImageUseTheme=p,this.configDependencies=new Set}getValue(s){return Fr(this._values[s].value)}setValue(s,c){this._values[s]=new Wh(this._values[s].property,c===null?void 0:Fr(c),this._scope,this._options,this._iconImageUseTheme),this._values[s].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[s].expression.configDependencies]))}serialize(){const s={};for(const c of Object.keys(this._values)){const f=this.getValue(c);f!==void 0&&(s[c]=f)}return s}possiblyEvaluate(s,c,f,p){const _=new Zh(this._properties);for(const b of Object.keys(this._values))_._values[b]=this._values[b].possiblyEvaluate(s,c,f,p);return _}}class Pd{constructor(s,c,f,p){this.property=s,this.value=c,this.parameters=f,this.iconImageUseTheme=p}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,c,f,p){return this.property.evaluate(this.value,this.parameters,s,c,f,p,this.iconImageUseTheme)}}class Zh{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class un{constructor(s){this.specification=s}possiblyEvaluate(s,c){return s.expression.evaluate(c)}interpolate(s,c,f){const p=Zt[this.specification.type];return p?p(s,c,f):s}}class wn{constructor(s,c){this.specification=s,this.overrides=c}possiblyEvaluate(s,c,f,p,_){return s.expression.kind==="constant"||s.expression.kind==="camera"?new Pd(this,{kind:"constant",value:s.expression.evaluate(c,null,{},f,p,void 0,_)},c):new Pd(this,s.expression,c,_)}interpolate(s,c,f){if(s.value.kind!=="constant"||c.value.kind!=="constant")return s;if(s.value.value===void 0||c.value.value===void 0)return new Pd(this,{kind:"constant",value:void 0},s.parameters);const p=Zt[this.specification.type];return p?new Pd(this,{kind:"constant",value:p(s.value.value,c.value.value,f)},s.parameters):s}evaluate(s,c,f,p,_,b,T){return s.kind==="constant"?s.value:s.evaluate(c,f,p,_,b,void 0,T)}}class Zf{constructor(s){this.specification=s}possiblyEvaluate(s,c,f,p){return!!s.expression.evaluate(c,null,{},f,p)}interpolate(){return!1}}class Zs{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const c=new hs(0,{});for(const f in s){const p=s[f];p.specification.overridable&&this.overridableProperties.push(f);const _=this.defaultPropertyValues[f]=new Wh(p,void 0),b=this.defaultTransitionablePropertyValues[f]=new Yp(p);this.defaultTransitioningPropertyValues[f]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=_.possiblyEvaluate(c)}}}Pn(wn,"DataDrivenProperty"),Pn(un,"DataConstantProperty"),Pn(Zf,"ColorRampProperty");var yt=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"modelNodeOverride":{"orientation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360}},"modelNodeOverrides":{"*":{"type":"modelNodeOverride"}},"modelMaterialOverride":{"model-color":{"type":"color"},"model-color-mix-intensity":{"type":"number"},"model-opacity":{"type":"number"},"model-emissive-strength":{"type":"number"}},"modelMaterialOverrides":{"*":{"type":"modelMaterialOverride"}},"modelSourceModel":{"uri":{"type":"string"},"position":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[-180,-90],"maximum":[180,90]},"orientation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360},"nodeOverrides":{"type":"modelNodeOverrides"},"materialOverrides":{"type":"modelMaterialOverrides"},"nodeOverrideNames":{"type":"array","value":"string"},"materialOverrideNames":{"type":"array","value":"string"},"featureProperties":{"type":"*"}},"modelSourceModels":{"*":{"type":"modelSourceModel"}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"},"models":{"type":"modelSourceModels"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"},"appearances":{"type":"array","value":"appearance","supported-layer-types":["symbol"]}},"appearance":{"condition":{"type":"boolean","expression":{"parameters":["zoom","pitch","feature","feature-state","measure-light","distance-from-center"]},"property-type":"data-driven"},"name":{"type":"string"},"properties":{"type":"*"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-facade":{"type":"boolean","default":false,"expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-facade-floors":{"type":"number","minimum":1,"maximum":200,"default":3,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-unit-width":{"type":"number","minimum":1,"maximum":20,"default":3.1,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-window":{"type":"array","length":2,"value":"number","minimum":0.1,"maximum":1,"default":[0.9,0.9],"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"building-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"building-flip-roof-orientation":{"property-type":"data-driven","type":"boolean","default":false,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"appearance":true,"use-theme":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","expression":{}},"buildingFeaturesetId":{"type":"string","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"parameters":[]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","use-theme":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-facade-emissive-chance":{"type":"number","default":0.35,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["measure-light","zoom"]}},"building-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"building-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"building-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"building-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-gradient":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"use-theme":true,"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"use-theme":true,"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white","use-theme":true},"sky-atmosphere-color":{"type":"color","default":"white","use-theme":true},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"use-theme":true,"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]},"model-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{}}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function pg(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function ou(u){if(Array.isArray(u))return u.map(ou);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const s={};for(const c in u)s[c]=ou(u[c]);return s}return pg(u)}function qy(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const s of u.slice(1))if(!qy(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}function Xp(u,s="",c=null,f="fill"){if(u==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};qy(u)||(u=cu(u));const p=u;let _=!0;try{_=function(O){if(!Jp(O))return O;let z=ou(O);return lu(z),z=Wx(z),z}(p)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(p,null,2)}
        `)}let b=null,T=null;if(f!=="background"&&f!=="sky"&&f!=="slot"){T=yt[`filter_${f}`];const O=pa(_,T,s,c);if(O.result==="error")throw new Error(O.value.map(z=>`${z.key}: ${z.message}`).join(", "));b=(z,q,K)=>O.value.evaluate(z,q,{},K)}let I=null,M=null;if(_!==p){const O=pa(p,T,s,c);if(O.result==="error")throw new Error(O.value.map(z=>`${z.key}: ${z.message}`).join(", "));I=(z,q,K,Y,ae)=>O.value.evaluate(z,q,{},K,void 0,void 0,Y,ae),M=!Gp(O.value.expression)}return{filter:b,dynamicFilter:I||void 0,needGeometry:mg(_),needFeature:!!M}}function Wx(u){if(!Array.isArray(u))return u;const s=function(c){if(Qp.has(c[0])){for(let f=1;f<c.length;f++)if(Jp(c[f]))return!0}return c}(u);return s===!0?s:s.map(c=>Wx(c))}function lu(u){let s=!1;const c=[];if(u[0]==="case"){for(let f=1;f<u.length-1;f+=2)s=s||Jp(u[f]),c.push(u[f+1]);c.push(u[u.length-1])}else if(u[0]==="match"){s=s||Jp(u[1]);for(let f=2;f<u.length-1;f+=2)c.push(u[f+1]);c.push(u[u.length-1])}else if(u[0]==="step"){s=s||Jp(u[1]);for(let f=1;f<u.length-1;f+=2)c.push(u[f+1])}s&&(u.length=0,u.push("any",...c));for(let f=1;f<u.length;f++)lu(u[f])}function Jp(u){if(!Array.isArray(u))return!1;if((s=u[0])==="pitch"||s==="distance-from-center")return!0;var s;for(let c=1;c<u.length;c++)if(Jp(u[c]))return!0;return!1}const Qp=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Kv(u,s){return u<s?-1:u>s?1:0}function mg(u){if(!Array.isArray(u))return!1;if(u[0]==="within"||u[0]==="distance")return!0;for(let s=1;s<u.length;s++)if(mg(u[s]))return!0;return!1}function cu(u){if(!u)return!0;const s=u[0];return u.length<=1?s!=="any":s==="=="?kd(u[1],u[2],"=="):s==="!="?em(kd(u[1],u[2],"==")):s==="<"||s===">"||s==="<="||s===">="?kd(u[1],u[2],s):s==="any"?(c=u.slice(1),["any"].concat(c.map(cu))):s==="all"?["all"].concat(u.slice(1).map(cu)):s==="none"?["all"].concat(u.slice(1).map(cu).map(em)):s==="in"?sh(u[1],u.slice(2)):s==="!in"?em(sh(u[1],u.slice(2))):s==="has"?gg(u[1]):s!=="!has"||em(gg(u[1]));var c}function kd(u,s,c){switch(u){case"$type":return[`filter-type-${c}`,s];case"$id":return[`filter-id-${c}`,s];default:return[`filter-${c}`,u,s]}}function sh(u,s){if(s.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(c=>typeof c!=typeof s[0])?["filter-in-large",u,["literal",s.sort(Kv)]]:["filter-in-small",u,["literal",s]]}}function gg(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function em(u){return["!",u]}const tm="";function nm(u,s){return s?`${u}${tm}${s}`:u}let yg;const Gy=()=>yg||(yg=new Zs({"icon-size":new wn(yt.layout_symbol["icon-size"]),"icon-image":new wn(yt.layout_symbol["icon-image"]),"icon-rotate":new wn(yt.layout_symbol["icon-rotate"]),"icon-offset":new wn(yt.layout_symbol["icon-offset"])}));class xN{constructor(s,c,f,p,_,b){const T=pa(s,yt.appearance.condition);if(T.result==="success"&&(this.condition=T.value),this.name=c,f){this.properties=new Zh(Gy()),this.unevaluatedLayout=new Wf(Gy(),p,_,b);for(const I in f)this.unevaluatedLayout.setValue(I,f[I])}}isActive(s){return!(this.condition||!s.isHidden||this.name!=="hidden")||this.condition.evaluate(s.globals,s.feature,s.featureState,s.canonical)}getCondition(){return this.condition}getName(){return this.name}getProperty(s){return this.properties.get(s)}getUnevaluatedProperties(){return this.unevaluatedLayout}serialize(){const s={};return s.condition=this.condition.expression.serialize(),this.name&&(s.name=this.name),this.properties&&(s.properties=this.properties),s}}const pT="-transition",mT=new Set(["fill","line","background","hillshade","raster"]);class Zl extends gd{constructor(s,c,f,p,_,b){if(super(),this.id=s.id,this.fqid=nm(this.id,f),this.type=s.type,this.scope=f,this.lut=p,this.options=_,this.iconImageUseTheme=b,this.appearances=new Array,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,s.type!=="custom"){if(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type&&s.type!=="background"&&s.type!=="sky"&&s.type!=="slot"){this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter;const T=pa(this.filter,yt[`filter_${s.type}`]);T.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...T.value.configDependencies]))}if(s.slot&&(this.slot=s.slot),s.appearances&&s.appearances.forEach(T=>{this.appearances.push(new xN(T.condition,T.name,T.properties,this.scope,_,this.iconImageUseTheme))}),c.layout&&(this._unevaluatedLayout=new Wf(c.layout,this.scope,_,this.iconImageUseTheme),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),c.paint){this._transitionablePaint=new Vy(c.paint,this.scope,_);for(const T in s.paint)this.setPaintProperty(T,s.paint[T]);for(const T in s.layout)this.setLayoutProperty(T,s.layout[T]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Zh(c.paint)}}}onAdd(s){}onRemove(s){}isDraped(s){return!this.is3D(!0)&&mT.has(this.type)}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,c){if(this.type==="custom"&&s==="visibility")return void(this.visibility=c);const f=this._unevaluatedLayout;f._properties.properties[s]&&(f.setValue(s,c),this.configDependencies=new Set([...this.configDependencies,...f.configDependencies]),s==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(s){return s.endsWith(pT)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,c){const f=this._transitionablePaint,p=f._properties.properties;if(s.endsWith(pT)){const z=s.slice(0,-11);return p[z]&&f.setTransition(z,c||void 0),!1}if(!p[s])return!1;const _=f._values[s],b=_.value.isDataDriven(),T=_.value;f.setValue(s,c),this.configDependencies=new Set([...this.configDependencies,...f.configDependencies]),this._handleSpecialPaintPropertyUpdate(s);const I=f._values[s].value,M=I.isDataDriven(),O=s.endsWith("pattern")||s==="line-dasharray";return M||b||O||this._handleOverridablePaintPropertyUpdate(s,T,I)}_handleSpecialPaintPropertyUpdate(s){}getProgramIds(){return null}getDefaultProgramParams(s,c,f){return null}_handleOverridablePaintPropertyUpdate(s,c,f){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,c){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,c,this.iconImageUseTheme)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,c)}serialize(){const s={id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.appearances.length!==0&&(s.appearances=this.appearances.map(c=>c.serialize())),Gr(s,(c,f)=>!(c===void 0||f==="layout"&&!Object.keys(c).length||f==="paint"&&!Object.keys(c).length))}is3D(s){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}_clear(){}isStateDependent(){for(const s in this.paint._values){const c=this.paint.get(s);if(c instanceof Pd&&ps(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1}compileFilter(s){this._filterCompiled||(this._featureFilter=Xp(this.filter,this.scope,s),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(s){this._stats&&(s.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}getAppearances(){return this.appearances}queryRadius(s){}queryIntersectsFeature(s,c,f,p,_,b,T,I,M){}}const rm={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Hy{constructor(s,c){this._structArray=s,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ds{constructor(){this.capacity=-1,this.resize(0)}static serialize(s,c){return s._trim(),c&&c.add(s.arrayBuffer),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const c=Object.create(this.prototype);return c.arrayBuffer=s.arrayBuffer,c.length=s.length,c.capacity=s.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...s){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...s){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ti(u,s=1){let c=0,f=0;return{members:u.map(p=>{const _=rm[p.type].BYTES_PER_ELEMENT,b=c=gT(c,Math.max(s,_)),T=p.components||1;return f=Math.max(f,_),c+=_*T,{name:p.name,type:p.type,components:T,offset:b}}),size:gT(c,Math.max(f,s)),alignment:s}}function gT(u,s){return Math.ceil(u/s)*s}class im extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c){const f=this.length;return this.resize(f+1),this.emplace(f,s,c)}emplace(s,c,f){const p=2*s;return this.int16[p+0]=c,this.int16[p+1]=f,s}}im.prototype.bytesPerElement=4,Pn(im,"StructArrayLayout2i4");class vg extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,f){const p=this.length;return this.resize(p+1),this.emplace(p,s,c,f)}emplace(s,c,f,p){const _=3*s;return this.int16[_+0]=c,this.int16[_+1]=f,this.int16[_+2]=p,s}}vg.prototype.bytesPerElement=6,Pn(vg,"StructArrayLayout3i6");class _g extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,f,p){const _=this.length;return this.resize(_+1),this.emplace(_,s,c,f,p)}emplace(s,c,f,p,_){const b=4*s;return this.int16[b+0]=c,this.int16[b+1]=f,this.int16[b+2]=p,this.int16[b+3]=_,s}}_g.prototype.bytesPerElement=8,Pn(_g,"StructArrayLayout4i8");class sm extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.float32[1*s+0]=c,s}}sm.prototype.bytesPerElement=4,Pn(sm,"StructArrayLayout1f4");class t2 extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f){const p=this.length;return this.resize(p+1),this.emplace(p,s,c,f)}emplace(s,c,f,p){const _=4*s,b=2*s;return this.int16[_+0]=c,this.int16[_+1]=f,this.float32[b+1]=p,s}}t2.prototype.bytesPerElement=8,Pn(t2,"StructArrayLayout2i1f8");class Zx extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,f){const p=this.length;return this.resize(p+1),this.emplace(p,s,c,f)}emplace(s,c,f,p){const _=4*s;return this.int16[_+0]=c,this.int16[_+1]=f,this.int16[_+2]=p,s}}Zx.prototype.bytesPerElement=8,Pn(Zx,"StructArrayLayout3i8");class n2 extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,s,c,f,p,_)}emplace(s,c,f,p,_,b){const T=5*s;return this.int16[T+0]=c,this.int16[T+1]=f,this.int16[T+2]=p,this.int16[T+3]=_,this.int16[T+4]=b,s}}n2.prototype.bytesPerElement=10,Pn(n2,"StructArrayLayout5i10");class Kx extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_,b,T){const I=this.length;return this.resize(I+1),this.emplace(I,s,c,f,p,_,b,T)}emplace(s,c,f,p,_,b,T,I){const M=6*s,O=12*s,z=3*s;return this.int16[M+0]=c,this.int16[M+1]=f,this.uint8[O+4]=p,this.uint8[O+5]=_,this.uint8[O+6]=b,this.uint8[O+7]=T,this.float32[z+2]=I,s}}Kx.prototype.bytesPerElement=12,Pn(Kx,"StructArrayLayout2i4ub1f12");class Bc extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f){const p=this.length;return this.resize(p+1),this.emplace(p,s,c,f)}emplace(s,c,f,p){const _=3*s;return this.float32[_+0]=c,this.float32[_+1]=f,this.float32[_+2]=p,s}}Bc.prototype.bytesPerElement=12,Pn(Bc,"StructArrayLayout3f12");class am extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,s,c,f,p,_)}emplace(s,c,f,p,_,b){const T=6*s,I=3*s;return this.uint16[T+0]=c,this.uint16[T+1]=f,this.uint16[T+2]=p,this.uint16[T+3]=_,this.float32[I+2]=b,s}}am.prototype.bytesPerElement=12,Pn(am,"StructArrayLayout4ui1f12");class Wy extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,f,p){const _=this.length;return this.resize(_+1),this.emplace(_,s,c,f,p)}emplace(s,c,f,p,_){const b=4*s;return this.uint16[b+0]=c,this.uint16[b+1]=f,this.uint16[b+2]=p,this.uint16[b+3]=_,s}}Wy.prototype.bytesPerElement=8,Pn(Wy,"StructArrayLayout4ui8");class Yx extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_,b){const T=this.length;return this.resize(T+1),this.emplace(T,s,c,f,p,_,b)}emplace(s,c,f,p,_,b,T){const I=6*s;return this.int16[I+0]=c,this.int16[I+1]=f,this.int16[I+2]=p,this.int16[I+3]=_,this.int16[I+4]=b,this.int16[I+5]=T,s}}Yx.prototype.bytesPerElement=12,Pn(Yx,"StructArrayLayout6i12");class r2 extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_,b,T,I,M,O,z,q){const K=this.length;return this.resize(K+1),this.emplace(K,s,c,f,p,_,b,T,I,M,O,z,q)}emplace(s,c,f,p,_,b,T,I,M,O,z,q,K){const Y=12*s;return this.int16[Y+0]=c,this.int16[Y+1]=f,this.int16[Y+2]=p,this.int16[Y+3]=_,this.uint16[Y+4]=b,this.uint16[Y+5]=T,this.uint16[Y+6]=I,this.uint16[Y+7]=M,this.int16[Y+8]=O,this.int16[Y+9]=z,this.int16[Y+10]=q,this.int16[Y+11]=K,s}}r2.prototype.bytesPerElement=24,Pn(r2,"StructArrayLayout4i4ui4i24");class i2 extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_,b){const T=this.length;return this.resize(T+1),this.emplace(T,s,c,f,p,_,b)}emplace(s,c,f,p,_,b,T){const I=10*s,M=5*s;return this.int16[I+0]=c,this.int16[I+1]=f,this.int16[I+2]=p,this.float32[M+2]=_,this.float32[M+3]=b,this.float32[M+4]=T,s}}i2.prototype.bytesPerElement=20,Pn(i2,"StructArrayLayout3i3f20");class ah extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f,p){const _=this.length;return this.resize(_+1),this.emplace(_,s,c,f,p)}emplace(s,c,f,p,_){const b=4*s;return this.float32[b+0]=c,this.float32[b+1]=f,this.float32[b+2]=p,this.float32[b+3]=_,s}}ah.prototype.bytesPerElement=16,Pn(ah,"StructArrayLayout4f16");class Zy extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint32[1*s+0]=c,s}}Zy.prototype.bytesPerElement=4,Pn(Zy,"StructArrayLayout1ul4");class so extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c){const f=this.length;return this.resize(f+1),this.emplace(f,s,c)}emplace(s,c,f){const p=2*s;return this.uint16[p+0]=c,this.uint16[p+1]=f,s}}so.prototype.bytesPerElement=4,Pn(so,"StructArrayLayout2ui4");class Ky extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_,b,T,I,M,O,z,q,K){const Y=this.length;return this.resize(Y+1),this.emplace(Y,s,c,f,p,_,b,T,I,M,O,z,q,K)}emplace(s,c,f,p,_,b,T,I,M,O,z,q,K,Y){const ae=20*s,le=10*s;return this.int16[ae+0]=c,this.int16[ae+1]=f,this.int16[ae+2]=p,this.int16[ae+3]=_,this.int16[ae+4]=b,this.float32[le+3]=T,this.float32[le+4]=I,this.float32[le+5]=M,this.float32[le+6]=O,this.int16[ae+14]=z,this.uint32[le+8]=q,this.uint16[ae+18]=K,this.uint16[ae+19]=Y,s}}Ky.prototype.bytesPerElement=40,Pn(Ky,"StructArrayLayout5i4f1i1ul2ui40");class Xx extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_,b,T){const I=this.length;return this.resize(I+1),this.emplace(I,s,c,f,p,_,b,T)}emplace(s,c,f,p,_,b,T,I){const M=8*s;return this.int16[M+0]=c,this.int16[M+1]=f,this.int16[M+2]=p,this.int16[M+4]=_,this.int16[M+5]=b,this.int16[M+6]=T,this.int16[M+7]=I,s}}Xx.prototype.bytesPerElement=16,Pn(Xx,"StructArrayLayout3i2i2i16");class s2 extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,s,c,f,p,_)}emplace(s,c,f,p,_,b){const T=4*s,I=8*s;return this.float32[T+0]=c,this.float32[T+1]=f,this.float32[T+2]=p,this.int16[I+6]=_,this.int16[I+7]=b,s}}s2.prototype.bytesPerElement=16,Pn(s2,"StructArrayLayout2f1f2i16");class a2 extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_,b){const T=this.length;return this.resize(T+1),this.emplace(T,s,c,f,p,_,b)}emplace(s,c,f,p,_,b,T){const I=20*s,M=5*s;return this.uint8[I+0]=c,this.uint8[I+1]=f,this.float32[M+1]=p,this.float32[M+2]=_,this.float32[M+3]=b,this.float32[M+4]=T,s}}a2.prototype.bytesPerElement=20,Pn(a2,"StructArrayLayout2ub4f20");class vo extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,f){const p=this.length;return this.resize(p+1),this.emplace(p,s,c,f)}emplace(s,c,f,p){const _=3*s;return this.uint16[_+0]=c,this.uint16[_+1]=f,this.uint16[_+2]=p,s}}vo.prototype.bytesPerElement=6,Pn(vo,"StructArrayLayout3ui6");class Yv extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_,b,T,I,M,O,z,q,K,Y,ae,le,ce,Se,Ae,Ee,Ze){const Ke=this.length;return this.resize(Ke+1),this.emplace(Ke,s,c,f,p,_,b,T,I,M,O,z,q,K,Y,ae,le,ce,Se,Ae,Ee,Ze)}emplace(s,c,f,p,_,b,T,I,M,O,z,q,K,Y,ae,le,ce,Se,Ae,Ee,Ze,Ke){const tt=30*s,at=15*s,ct=60*s;return this.int16[tt+0]=c,this.int16[tt+1]=f,this.int16[tt+2]=p,this.float32[at+2]=_,this.float32[at+3]=b,this.uint16[tt+8]=T,this.uint16[tt+9]=I,this.uint32[at+5]=M,this.uint32[at+6]=O,this.uint32[at+7]=z,this.uint16[tt+16]=q,this.uint16[tt+17]=K,this.uint16[tt+18]=Y,this.float32[at+10]=ae,this.float32[at+11]=le,this.uint8[ct+48]=ce,this.uint8[ct+49]=Se,this.uint8[ct+50]=Ae,this.uint32[at+13]=Ee,this.int16[tt+28]=Ze,this.uint8[ct+58]=Ke,s}}Yv.prototype.bytesPerElement=60,Pn(Yv,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class o2 extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_,b,T,I,M,O,z,q,K,Y,ae,le,ce,Se,Ae,Ee,Ze,Ke,tt,at,ct,qt,_t,Xt,an,Jt,en,hn,Vt){const nn=this.length;return this.resize(nn+1),this.emplace(nn,s,c,f,p,_,b,T,I,M,O,z,q,K,Y,ae,le,ce,Se,Ae,Ee,Ze,Ke,tt,at,ct,qt,_t,Xt,an,Jt,en,hn,Vt)}emplace(s,c,f,p,_,b,T,I,M,O,z,q,K,Y,ae,le,ce,Se,Ae,Ee,Ze,Ke,tt,at,ct,qt,_t,Xt,an,Jt,en,hn,Vt,nn){const Lt=20*s,It=40*s,fn=80*s;return this.float32[Lt+0]=c,this.float32[Lt+1]=f,this.int16[It+4]=p,this.int16[It+5]=_,this.int16[It+6]=b,this.int16[It+7]=T,this.int16[It+8]=I,this.int16[It+9]=M,this.int16[It+10]=O,this.int16[It+11]=z,this.int16[It+12]=q,this.uint16[It+13]=K,this.uint16[It+14]=Y,this.uint16[It+15]=ae,this.uint16[It+16]=le,this.uint16[It+17]=ce,this.uint16[It+18]=Se,this.uint16[It+19]=Ae,this.uint16[It+20]=Ee,this.uint16[It+21]=Ze,this.uint16[It+22]=Ke,this.uint16[It+23]=tt,this.uint16[It+24]=at,this.uint16[It+25]=ct,this.uint16[It+26]=qt,this.uint16[It+27]=_t,this.uint32[Lt+14]=Xt,this.float32[Lt+15]=an,this.float32[Lt+16]=Jt,this.float32[Lt+17]=en,this.float32[Lt+18]=hn,this.uint8[fn+76]=Vt,this.uint16[It+39]=nn,s}}o2.prototype.bytesPerElement=80,Pn(o2,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class Xv extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_,b){const T=this.length;return this.resize(T+1),this.emplace(T,s,c,f,p,_,b)}emplace(s,c,f,p,_,b,T){const I=6*s;return this.float32[I+0]=c,this.float32[I+1]=f,this.float32[I+2]=p,this.float32[I+3]=_,this.float32[I+4]=b,this.float32[I+5]=T,s}}Xv.prototype.bytesPerElement=24,Pn(Xv,"StructArrayLayout6f24");class xg extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,s,c,f,p,_)}emplace(s,c,f,p,_,b){const T=5*s;return this.float32[T+0]=c,this.float32[T+1]=f,this.float32[T+2]=p,this.float32[T+3]=_,this.float32[T+4]=b,s}}xg.prototype.bytesPerElement=20,Pn(xg,"StructArrayLayout5f20");class l2 extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_,b,T){const I=this.length;return this.resize(I+1),this.emplace(I,s,c,f,p,_,b,T)}emplace(s,c,f,p,_,b,T,I){const M=7*s;return this.float32[M+0]=c,this.float32[M+1]=f,this.float32[M+2]=p,this.float32[M+3]=_,this.float32[M+4]=b,this.float32[M+5]=T,this.float32[M+6]=I,s}}l2.prototype.bytesPerElement=28,Pn(l2,"StructArrayLayout7f28");class Jx extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_,b,T,I,M,O,z){const q=this.length;return this.resize(q+1),this.emplace(q,s,c,f,p,_,b,T,I,M,O,z)}emplace(s,c,f,p,_,b,T,I,M,O,z,q){const K=11*s;return this.float32[K+0]=c,this.float32[K+1]=f,this.float32[K+2]=p,this.float32[K+3]=_,this.float32[K+4]=b,this.float32[K+5]=T,this.float32[K+6]=I,this.float32[K+7]=M,this.float32[K+8]=O,this.float32[K+9]=z,this.float32[K+10]=q,s}}Jx.prototype.bytesPerElement=44,Pn(Jx,"StructArrayLayout11f44");class Jv extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_,b,T,I,M){const O=this.length;return this.resize(O+1),this.emplace(O,s,c,f,p,_,b,T,I,M)}emplace(s,c,f,p,_,b,T,I,M,O){const z=9*s;return this.float32[z+0]=c,this.float32[z+1]=f,this.float32[z+2]=p,this.float32[z+3]=_,this.float32[z+4]=b,this.float32[z+5]=T,this.float32[z+6]=I,this.float32[z+7]=M,this.float32[z+8]=O,s}}Jv.prototype.bytesPerElement=36,Pn(Jv,"StructArrayLayout9f36");class Yy extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c){const f=this.length;return this.resize(f+1),this.emplace(f,s,c)}emplace(s,c,f){const p=2*s;return this.float32[p+0]=c,this.float32[p+1]=f,s}}Yy.prototype.bytesPerElement=8,Pn(Yy,"StructArrayLayout2f8");class Qx extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,f,p){const _=this.length;return this.resize(_+1),this.emplace(_,s,c,f,p)}emplace(s,c,f,p,_){const b=6*s;return this.uint32[3*s+0]=c,this.uint16[b+2]=f,this.uint16[b+3]=p,this.uint16[b+4]=_,s}}Qx.prototype.bytesPerElement=12,Pn(Qx,"StructArrayLayout1ul3ui12");class e1 extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint16[1*s+0]=c,s}}e1.prototype.bytesPerElement=2,Pn(e1,"StructArrayLayout1ui2");class c2 extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_,b,T,I,M,O,z,q,K,Y,ae,le){const ce=this.length;return this.resize(ce+1),this.emplace(ce,s,c,f,p,_,b,T,I,M,O,z,q,K,Y,ae,le)}emplace(s,c,f,p,_,b,T,I,M,O,z,q,K,Y,ae,le,ce){const Se=16*s;return this.float32[Se+0]=c,this.float32[Se+1]=f,this.float32[Se+2]=p,this.float32[Se+3]=_,this.float32[Se+4]=b,this.float32[Se+5]=T,this.float32[Se+6]=I,this.float32[Se+7]=M,this.float32[Se+8]=O,this.float32[Se+9]=z,this.float32[Se+10]=q,this.float32[Se+11]=K,this.float32[Se+12]=Y,this.float32[Se+13]=ae,this.float32[Se+14]=le,this.float32[Se+15]=ce,s}}c2.prototype.bytesPerElement=64,Pn(c2,"StructArrayLayout16f64");class Xy extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,f,p,_,b,T){const I=this.length;return this.resize(I+1),this.emplace(I,s,c,f,p,_,b,T)}emplace(s,c,f,p,_,b,T,I){const M=10*s,O=5*s;return this.uint16[M+0]=c,this.uint16[M+1]=f,this.uint16[M+2]=p,this.uint16[M+3]=_,this.float32[O+2]=b,this.float32[O+3]=T,this.float32[O+4]=I,s}}Xy.prototype.bytesPerElement=20,Pn(Xy,"StructArrayLayout4ui3f20");class Jy extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.int16[1*s+0]=c,s}}Jy.prototype.bytesPerElement=2,Pn(Jy,"StructArrayLayout1i2");class t1 extends Ds{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint8[1*s+0]=c,s}}t1.prototype.bytesPerElement=1,Pn(t1,"StructArrayLayout1ub1");class yT extends Hy{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}yT.prototype.size=40;class u2 extends Ky{get(s){return new yT(this,s)}}Pn(u2,"CollisionBoxArray");class vT extends Hy{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(s){this._structArray.uint8[this._pos1+49]=s}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(s){this._structArray.uint8[this._pos1+50]=s}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(s){this._structArray.uint32[this._pos4+13]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(s){this._structArray.uint8[this._pos1+58]=s}}vT.prototype.size=60;class n1 extends Yv{get(s){return new vT(this,s)}}Pn(n1,"PlacedSymbolArray");class _T extends Hy{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(s){this._structArray.uint32[this._pos4+14]=s}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(s){this._structArray.float32[this._pos4+18]=s}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}_T.prototype.size=80;class xT extends o2{get(s){return new _T(this,s)}}Pn(xT,"SymbolInstanceArray");class bT extends sm{getoffsetX(s){return this.float32[1*s+0]}}Pn(bT,"GlyphOffsetArray");class wT extends im{getx(s){return this.int16[2*s+0]}gety(s){return this.int16[2*s+1]}}Pn(wT,"SymbolLineVertexArray");class d2 extends Hy{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}d2.prototype.size=12;class ST extends Qx{get(s){return new d2(this,s)}}Pn(ST,"FeatureIndexArray");class AT extends so{geta_centroid_pos0(s){return this.uint16[2*s+0]}geta_centroid_pos1(s){return this.uint16[2*s+1]}}Pn(AT,"FillExtrusionCentroidArray");class TT extends Hy{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}TT.prototype.size=6;class CT extends vg{get(s){return new TT(this,s)}}Pn(CT,"FillExtrusionWallArray");const bN=Ti([{name:"a_pos",components:2,type:"Int16"}],4),wN=Ti([{name:"a_circle_z_offset",components:1,type:"Float32"}],4),SN=Ti([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Qs{constructor(s=[]){this.segments=s}_prepareSegment(s,c,f,p){let _=this.segments[this.segments.length-1];return s>Qs.MAX_VERTEX_ARRAY_LENGTH&&ai(`Max vertices per segment is ${Qs.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!_||_.vertexLength+s>Qs.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==p)&&(_={vertexOffset:c,primitiveOffset:f,vertexLength:0,primitiveLength:0},p!==void 0&&(_.sortKey=p),this.segments.push(_)),_}prepareSegment(s,c,f,p){return this._prepareSegment(s,c.length,f.length,p)}get(){return this.segments}destroy(){for(const s of this.segments)for(const c in s.vaos)s.vaos[c].destroy()}static simpleSegment(s,c,f,p){return new Qs([{vertexOffset:s,primitiveOffset:c,vertexLength:f,primitiveLength:p,vaos:{},sortKey:0}])}}function Qv(u,s){return 256*(u=We(Math.floor(u),0,255))+We(Math.floor(s),0,255)}Qs.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Pn(Qs,"SegmentVector");const AN=Ti([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),TN=Ti([{name:"a_pattern_b",components:4,type:"Uint16"}]),r1=Ti([{name:"a_dash",components:4,type:"Uint16"}]);class e_{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(s,c,f,p){this.ids.push(h2(s)),this.positions.push(c,f,p)}eachPosition(s,c){const f=h2(s);let p=0,_=this.ids.length-1;for(;p<_;){const b=p+_>>1;this.ids[b]>=f?_=b:p=b+1}for(;this.ids[p]===f;)c(this.positions[3*p],this.positions[3*p+1],this.positions[3*p+2]),p++}static serialize(s,c){const f=new Float64Array(s.ids),p=new Uint32Array(s.positions);return f2(f,p,0,f.length-1),c&&(c.add(f.buffer),c.add(p.buffer)),{ids:f,positions:p}}static deserialize(s){const c=new e_;let f;c.ids=s.ids,c.positions=s.positions;for(const p of c.ids)p!==f&&c.uniqueIds.push(p),f=p;return c.indexed=!0,c}}function h2(u){const s=+u;return Number.isSafeInteger(s)?s:Oh(String(u))}function f2(u,s,c,f){for(;c<f;){const p=u[c+f>>1];let _=c-1,b=f+1;for(;;){do _++;while(u[_]<p);do b--;while(u[b]>p);if(_>=b)break;t_(u,_,b),t_(s,3*_,3*b),t_(s,3*_+1,3*b+1),t_(s,3*_+2,3*b+2)}b-c<f-b?(f2(u,s,c,b),c=b+1):(f2(u,s,b+1,f),f=b)}}function t_(u,s,c){const f=u[s];u[s]=u[c],u[c]=f}Pn(e_,"FeaturePositionMap");class Kh{constructor(s){this.gl=s.gl,this.initialized=!1}fetchUniformLocation(s,c){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(s,c),this.initialized=!0),!!this.location}set(s,c,f){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class n_ extends Kh{constructor(s){super(s),this.current=0}set(s,c,f){this.fetchUniformLocation(s,c)&&this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}}class Na extends Kh{constructor(s){super(s),this.current=0}set(s,c,f){this.fetchUniformLocation(s,c)&&this.current!==f&&(this.current=f,this.gl.uniform1f(this.location,f))}}class Yh extends Kh{constructor(s){super(s),this.current=[0,0]}set(s,c,f){this.fetchUniformLocation(s,c)&&(f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1])))}}class r_ extends Kh{constructor(s){super(s),this.current=[0,0,0]}set(s,c,f){this.fetchUniformLocation(s,c)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2])))}}class i_ extends Kh{constructor(s){super(s),this.current=[0,0,0,0]}set(s,c,f){this.fetchUniformLocation(s,c)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]&&f[3]===this.current[3]||(this.current=f,this.gl.uniform4f(this.location,f[0],f[1],f[2],f[3])))}}class ET extends Kh{constructor(s){super(s),this.current=Ii.transparent.toPremultipliedRenderColor(null)}set(s,c,f){this.fetchUniformLocation(s,c)&&(f.r===this.current.r&&f.g===this.current.g&&f.b===this.current.b&&f.a===this.current.a||(this.current=f,this.gl.uniform4f(this.location,f.r,f.g,f.b,f.a)))}}const CN=new Float32Array(16);class s_ extends Kh{constructor(s){super(s),this.current=CN}set(s,c,f){if(this.fetchUniformLocation(s,c)){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let p=1;p<16;p++)if(f[p]!==this.current[p]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}}}const EN=new Float32Array(9),PN=new Float32Array(4);class i1 extends Kh{constructor(s){super(s),this.current=PN}set(s,c,f){if(this.fetchUniformLocation(s,c)){for(let p=0;p<4;p++)if(f[p]!==this.current[p]){this.current=f,this.gl.uniformMatrix2fv(this.location,!1,f);break}}}}function a_(u){return[Qv(255*u.r,255*u.g),Qv(255*u.b,255*u.a)]}class Bu{constructor(s,c,f,p){this.value=s,this.uniformNames=c.map(_=>`u_${_}`),this.type=f,this.context=p}setUniform(s,c,f,p,_){const b=p.constantOr(this.value);c.set(s,_,b instanceof Ii?b.toPremultipliedRenderColor(this.lutExpression&&this.lutExpression.kind==="constant"&&this.lutExpression.value==="none"?null:this.context.lut):b)}getBinding(s,c){return this.type==="color"?new ET(s):new Na(s)}}class bg{constructor(s,c){this.uniformNames=c.map(f=>`u_${f}`),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(s,c){this.pixelRatio=s.pixelRatio||1,this.pattern=s.tl.concat(s.br),this.patternTransition=c?c.tl.concat(c.br):this.pattern}setUniform(s,c,f,p,_){let b=null;_!=="u_pattern"&&_!=="u_dash"||(b=this.pattern),_==="u_pattern_b"&&(b=this.patternTransition),_==="u_pixel_ratio"&&(b=this.pixelRatio),b&&c.set(s,_,b)}getBinding(s,c){return c==="u_pattern"||c==="u_pattern_b"||c==="u_dash"?new i_(s):new Na(s)}}class om{constructor(s,c,f,p){this.expression=s,this.type=f,this.maxValue=0,this.paintVertexAttributes=c.map(_=>({name:`a_${_}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(s,c,f,p,_,b,T,I){const M=this.paintVertexArray.length,O=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new hs(0,{brightness:b,worldview:I}),c,{},_,p,T):this.expression.kind==="constant"&&this.expression.value,z=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new hs(0,{brightness:b,worldview:I}),c,{},_,p,T):this.lutExpression.value)==="none";this.paintVertexArray.resize(s),this._setPaintValue(M,s,O,z?null:this.context.lut)}updatePaintArray(s,c,f,p,_,b,T,I){const M=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:T,worldview:I},f,p,void 0,_):this.expression.kind==="constant"&&this.expression.value,O=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new hs(0,{brightness:T,worldview:I}),f,p,void 0,_):this.lutExpression.value)==="none";this._setPaintValue(s,c,M,O?null:this.context.lut)}_setPaintValue(s,c,f,p){if(this.type==="color"){const _=a_(f.toPremultipliedRenderColor(p));for(let b=s;b<c;b++)this.paintVertexArray.emplace(b,_[0],_[1])}else{for(let _=s;_<c;_++)this.paintVertexArray.emplace(_,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Kf{constructor(s,c,f,p,_,b){this.expression=s,this.uniformNames=c.map(T=>`u_${T}_t`),this.type=f,this.useIntegerZoom=p,this.context=_,this.maxValue=0,this.paintVertexAttributes=c.map(T=>({name:`a_${T}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new b}populatePaintArray(s,c,f,p,_,b,T,I){const M=this.expression.evaluate(new hs(this.context.zoom,{brightness:b,worldview:I}),c,{},_,p,T),O=this.expression.evaluate(new hs(this.context.zoom+1,{brightness:b,worldview:I}),c,{},_,p,T),z=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new hs(0,{brightness:b,worldview:I}),c,{},_,p,T):this.lutExpression.value)==="none",q=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(q,s,M,O,z?null:this.context.lut)}updatePaintArray(s,c,f,p,_,b,T,I){const M=this.expression.evaluate({zoom:this.context.zoom,brightness:T,worldview:I},f,p,void 0,_),O=this.expression.evaluate({zoom:this.context.zoom+1,brightness:T,worldview:I},f,p,void 0,_),z=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new hs(0,{brightness:T,worldview:I}),f,p,void 0,_):this.lutExpression.value)==="none";this._setPaintValue(s,c,M,O,z?null:this.context.lut)}_setPaintValue(s,c,f,p,_){if(this.type==="color"){const b=a_(f.toPremultipliedRenderColor(_)),T=a_(f.toPremultipliedRenderColor(_));for(let I=s;I<c;I++)this.paintVertexArray.emplace(I,b[0],b[1],T[0],T[1])}else{for(let b=s;b<c;b++)this.paintVertexArray.emplace(b,f,p);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(p))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,c,f,p,_){const b=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,T=We(this.expression.interpolationFactor(b,this.context.zoom,this.context.zoom+1),0,1);c.set(s,_,T)}getBinding(s,c){return new Na(s)}}class Yf{constructor(s,c,f,p,_){this.expression=s,this.layerId=_,this.paintVertexAttributes=(f==="array"?r1:AN).members;for(let b=0;b<c.length;++b);this.paintVertexArray=new p,this.paintTransitionVertexArray=new Wy}populatePaintArray(s,c,f,p){const _=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValues(_,s,c.patterns&&c.patterns[this.layerId],f)}updatePaintArray(s,c,f,p,_,b,T){this._setPaintValues(s,c,f.patterns&&f.patterns[this.layerId],b)}_setPaintValues(s,c,f,p){if(!p||!f)return;const _=p[f[0]],b=p[f[1]];if(_){if(_){const{tl:T,br:I,pixelRatio:M}=_;for(let O=s;O<c;O++)this.paintVertexArray.emplace(O,T[0],T[1],I[0],I[1],M)}if(b){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:T,br:I}=b;for(let M=s;M<c;M++)this.paintTransitionVertexArray.emplace(M,T[0],T[1],I[0],I[1])}}}upload(s){const c=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,c)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=s.createVertexBuffer(this.paintTransitionVertexArray,TN.members,c))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class wg{constructor(s,c,f=()=>!0){this.binders={},this._buffers=[],this.context=c;const p=[];for(const _ in s.paint._values){const b=s.paint.get(_);if(_.endsWith("-use-theme")||!f(_)||!(b instanceof Pd&&ps(b.property.specification)))continue;const T=x8(_,s.type),I=b.value,M=b.property.specification.type,O=!!b.property.useIntegerZoom,z=_==="line-dasharray"||_.endsWith("pattern"),q=s.paint.get(`${_}-use-theme`),K=_==="line-dasharray"&&s.layout.get("line-cap").value.kind!=="constant"||q&&q.value.kind!=="constant";if(I.kind!=="constant"||K)if(I.kind==="source"||K||z){const Y=d(_,M,"source");this.binders[_]=z?new Yf(I,T,M,Y,s.id):new om(I,T,M,Y),p.push(`/a_${_}`)}else{const Y=d(_,M,"composite");this.binders[_]=new Kf(I,T,M,O,c,Y),p.push(`/z_${_}`)}else this.binders[_]=z?new bg(I.value,T):new Bu(I.value,T,M,c),p.push(`/u_${_}`);q&&(this.binders[_].lutExpression=q.value)}this.cacheKey=p.sort().join("")}getMaxValue(s){const c=this.binders[s];return c instanceof om||c instanceof Kf?c.maxValue:0}populatePaintArrays(s,c,f,p,_,b,T,I){for(const M in this.binders){const O=this.binders[M];O.context=this.context,(O instanceof om||O instanceof Kf||O instanceof Yf)&&O.populatePaintArray(s,c,f,p,_,b,T,I)}}setConstantPatternPositions(s,c){for(const f in this.binders){const p=this.binders[f];p instanceof bg&&p.setConstantPatternPositions(s,c)}}getPatternTransitionVertexBuffer(s){const c=this.binders[s];return c instanceof Yf?c.paintTransitionVertexBuffer:null}updatePaintArrays(s,c,f,p,_,b,T,I,M,O){let z=!1;const q=Object.keys(s),K=q.length!==0&&!I,Y=K?q:c.uniqueIds;this.context.lut=_.lut;for(const ae in this.binders){const le=this.binders[ae];if(le.context=this.context,(le instanceof om||le instanceof Kf||le instanceof Yf)&&le.expression&&le.expression.kind&&le.expression.kind!=="constant"&&(le.expression.isStateDependent===!0||le.expression.isLightConstant===!1)){const ce=_.paint.get(ae);le.expression=ce.value;for(const Se of Y){const Ae=s[Se.toString()];c.eachPosition(Se,(Ee,Ze,Ke)=>{const tt=p.feature(Ee);le.updatePaintArray(Ze,Ke,tt,Ae,b,T,M,O)})}if(!K)for(const Se of f.uniqueIds){const Ae=s[Se.toString()];f.eachPosition(Se,(Ee,Ze,Ke)=>{const tt=p.feature(Ee);le.updatePaintArray(Ze,Ke,tt,Ae,b,T,M,O)})}z=!0}}return z}defines(){const s=[];for(const c in this.binders){const f=this.binders[c];(f instanceof Bu||f instanceof bg)&&s.push(...f.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s){const c=[];for(const f in this.binders){const p=this.binders[f];if(p instanceof Bu||p instanceof bg||p instanceof Kf)for(const _ of p.uniformNames)c.push({name:_,property:f,binding:p.getBinding(s,_)})}return c}setUniforms(s,c,f,p,_){for(const{name:b,property:T,binding:I}of f)this.binders[T].setUniform(s,I,_,p.get(T),b)}updatePaintBuffers(){this._buffers=[];for(const s in this.binders){const c=this.binders[s];(c instanceof om||c instanceof Kf||c instanceof Yf)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer),c instanceof Yf&&c.paintTransitionVertexBuffer&&this._buffers.push(c.paintTransitionVertexBuffer)}}upload(s){for(const c in this.binders){const f=this.binders[c];(f instanceof om||f instanceof Kf||f instanceof Yf)&&f.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const c=this.binders[s];(c instanceof om||c instanceof Kf||c instanceof Yf)&&c.destroy()}}}class oh{constructor(s,c,f=()=>!0){this.programConfigurations={};for(const p of s)this.programConfigurations[p.id]=new wg(p,c,f);this.needsUpload=!1,this._featureMap=new e_,this._featureMapWithoutIds=new e_,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(s,c,f,p,_,b,T,I,M){for(const O in this.programConfigurations)this.programConfigurations[O].populatePaintArrays(s,c,p,_,b,T,I,M);c.id!==void 0?this._featureMap.add(c.id,f,this._bufferOffset,s):(this._featureMapWithoutIds.add(this._idlessCounter,f,this._bufferOffset,s),this._idlessCounter+=1),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,c,f,p,_,b,T,I){for(const M of f)this.needsUpload=this.programConfigurations[M.id].updatePaintArrays(s,this._featureMap,this._featureMapWithoutIds,c,M,p,_,b,T||0,I)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}const PT={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"],"fill-bridge-guard-rail-color":["structure_color"],"fill-tunnel-structure-color":["structure_color"]};function x8(u,s){return PT[u]||[u.replace(`${s}-`,"").replace(/-/g,"_")]}const g={"line-pattern":{source:am,composite:am},"fill-pattern":{source:am,composite:am},"fill-extrusion-pattern":{source:am,composite:am},"line-dasharray":{source:Wy,composite:Wy}},o={color:{source:Yy,composite:ah},number:{source:sm,composite:Yy}};function d(u,s,c){const f=g[u];return f&&f[c]||o[s][c]}Pn(Bu,"ConstantBinder"),Pn(bg,"PatternConstantBinder"),Pn(om,"SourceExpressionBinder"),Pn(Yf,"PatternCompositeBinder"),Pn(Kf,"CompositeExpressionBinder"),Pn(wg,"ProgramConfiguration",{omit:["_buffers"]}),Pn(oh,"ProgramConfigurationSet");const m=yn/Math.PI/2,S=5,A=6,k=16383,N=64,R=[N,32,16],V=-m,G=m;function X(u,s,c,f=m){return c=lt(c),[u*Math.sin(c)*f,-s*f,u*Math.cos(c)*f]}function W(u,s,c){return X(Math.cos(lt(u)),Math.sin(lt(u)),s,c)}const te=63710088e-1,ie=2*Math.PI*te;class se{constructor(s,c){if(isNaN(s)||isNaN(c))throw new Error(`Invalid LngLat object: (${s}, ${c})`);if(this.lng=+s,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new se(ot(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const c=Math.PI/180,f=this.lat*c,p=s.lat*c,_=Math.sin(f)*Math.sin(p)+Math.cos(f)*Math.cos(p)*Math.cos((s.lng-this.lng)*c);return te*Math.acos(Math.min(_,1))}toBounds(s=0){const c=360*s/40075017,f=c/Math.cos(Math.PI/180*this.lat);return new ve({lng:this.lng-f,lat:this.lat-c},{lng:this.lng+f,lat:this.lat+c})}toEcef(s){return W(this.lat,this.lng,m+s*m/te)}static convert(s){if(s instanceof se)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new se(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new se(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ve{constructor(s,c){s&&(c?this.setSouthWest(s).setNorthEast(c):Array.isArray(s)&&s.length===4?this.setSouthWest([s[0],s[1]]).setNorthEast([s[2],s[3]]):this.setSouthWest(s[0]).setNorthEast(s[1]))}setNorthEast(s){return this._ne=s instanceof se?new se(s.lng,s.lat):se.convert(s),this}setSouthWest(s){return this._sw=s instanceof se?new se(s.lng,s.lat):se.convert(s),this}extend(s){const c=this._sw,f=this._ne;let p,_;if(s instanceof se)p=s,_=s;else{if(!(s instanceof ve))return Array.isArray(s)?s.length===4||s.every(Array.isArray)?this.extend(ve.convert(s)):this.extend(se.convert(s)):typeof s=="object"&&s!==null&&s.hasOwnProperty("lat")&&(s.hasOwnProperty("lon")||s.hasOwnProperty("lng"))?this.extend(se.convert(s)):this;if(p=s._sw,_=s._ne,!p||!_)return this}return c||f?(c.lng=Math.min(p.lng,c.lng),c.lat=Math.min(p.lat,c.lat),f.lng=Math.max(_.lng,f.lng),f.lat=Math.max(_.lat,f.lat)):(this._sw=new se(p.lng,p.lat),this._ne=new se(_.lng,_.lat)),this}getCenter(){return new se((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new se(this.getWest(),this.getNorth())}getSouthEast(){return new se(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:c,lat:f}=se.convert(s);let p=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&p}static convert(s){if(s)return s instanceof ve?s:new ve(s)}}const ue=0,be=25.5;function Te(u){return ie*Math.cos(u*Math.PI/180)}function ke(u){return(180+u)/360}function Ue(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function Fe(u,s){return u/Te(s)}function Ve(u){return 360*u-180}function ze(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function Oe(u,s){return u*Te(ze(s))}const Ge=85.051129;function Tt(u){return Math.cos(lt(We(u,-Ge,Ge)))}function ut(u,s){const c=We(s,ue,be),f=Math.pow(2,c);return Tt(u)*ie/(512*f)}function jt(u){return 1/Math.cos(u*Math.PI/180)}function bt(u,s=0){const c=Math.exp(Math.PI*(1-(u.y+s/yn)/(1<<u.z)*2));return 80150034*c/(c*c+1)/yn/(1<<u.z)}class Dt{constructor(s,c,f=0){this.x=+s,this.y=+c,this.z=+f}static fromLngLat(s,c=0){const f=se.convert(s);return new Dt(ke(f.lng),Ue(f.lat),Fe(c,f.lat))}toLngLat(){return new se(Ve(this.x),ze(this.y))}toAltitude(){return Oe(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/ie*jt(ze(this.y))}}function gn(u,s,c,f,p,_,b,T,I){const M=(s+f)/2,O=(c+p)/2,z=new zt(M,O);T(z),function(q,K,Y,ae,le,ce){const Se=Y-le,Ae=ae-ce;return Math.abs((ae-K)*Se-(Y-q)*Ae)/Math.hypot(Se,Ae)}(z.x,z.y,_.x,_.y,b.x,b.y)>=I?(gn(u,s,c,M,O,_,z,T,I),gn(u,M,O,f,p,z,b,T,I)):u.push(b)}function St(u,s,c){let f=u[0],p=f.x,_=f.y;s(f);const b=[f];for(let T=1;T<u.length;T++){const I=u[T],{x:M,y:O}=I;s(I),gn(b,p,_,M,O,f,I,s,c),p=M,_=O,f=I}return b}function it(u,s,c,f){if(f(s,c)){const p=s.add(c)._mult(.5);it(u,s,p,f),it(u,p,c,f)}else u.push(c)}function Ut(u,s){let c=u[0];const f=[c];for(let p=1;p<u.length;p++){const _=u[p];it(f,c,_,s),c=_}return f}const Nt=Math.pow(2,14)-1,Qt=-Nt-1;function mn(u,s){const c=Math.round(u.x*s),f=Math.round(u.y*s);return u.x=We(c,Qt,Nt),u.y=We(f,Qt,Nt),(c<u.x||c>u.x+1||f<u.y||f>u.y+1)&&ai("Geometry exceeds allowed extent, reduce your vector tile buffer size"),u}function Nn(u,s,c){const f=u.loadGeometry(),p=u.extent,_=yn/p;if(s&&c&&c.projection.isReprojectedInTileSpace){const b=1<<s.z,{scale:T,x:I,y:M,projection:O}=c,z=q=>{const K=Ve((s.x+q.x/p)/b),Y=ze((s.y+q.y/p)/b),ae=O.project(K,Y);q.x=(ae.x*T-I)*p,q.y=(ae.y*T-M)*p};for(let q=0;q<f.length;q++)if(u.type!==1)f[q]=St(f[q],z,1);else{const K=[];for(const Y of f[q])Y.x<0||Y.x>=p||Y.y<0||Y.y>=p||(z(Y),K.push(Y));f[q]=K}}for(const b of f)for(const T of b)mn(T,_);return f}function dn(u,s){return{type:u.type,id:u.id,properties:u.properties,geometry:s?Nn(u):[]}}class rn{constructor(s,c,f,p,_){this.properties={},this.extent=f,this.type=0,this.id=void 0,this._pbf=s,this._geometry=-1,this._keys=p,this._values=_,s.readFields(Qn,this,c)}loadGeometry(){const s=this._pbf;s.pos=this._geometry;const c=s.readVarint()+s.pos,f=[];let p,_=1,b=0,T=0,I=0;for(;s.pos<c;){if(b<=0){const M=s.readVarint();_=7&M,b=M>>3}if(b--,_===1||_===2)T+=s.readSVarint(),I+=s.readSVarint(),_===1&&(p&&f.push(p),p=[]),p&&p.push(new zt(T,I));else{if(_!==7)throw new Error(`unknown command ${_}`);p&&p.push(p[0].clone())}}return p&&f.push(p),f}bbox(){const s=this._pbf;s.pos=this._geometry;const c=s.readVarint()+s.pos;let f=1,p=0,_=0,b=0,T=1/0,I=-1/0,M=1/0,O=-1/0;for(;s.pos<c;){if(p<=0){const z=s.readVarint();f=7&z,p=z>>3}if(p--,f===1||f===2)_+=s.readSVarint(),b+=s.readSVarint(),_<T&&(T=_),_>I&&(I=_),b<M&&(M=b),b>O&&(O=b);else if(f!==7)throw new Error(`unknown command ${f}`)}return[T,M,I,O]}toGeoJSON(s,c,f){const p=this.extent*Math.pow(2,f),_=this.extent*s,b=this.extent*c,T=this.loadGeometry();function I(q){return[360*(q.x+_)/p-180,360/Math.PI*Math.atan(Math.exp((1-2*(q.y+b)/p)*Math.PI))-90]}function M(q){return q.map(I)}let O;if(this.type===1){const q=[];for(const Y of T)q.push(Y[0]);const K=M(q);O=q.length===1?{type:"Point",coordinates:K[0]}:{type:"MultiPoint",coordinates:K}}else if(this.type===2){const q=T.map(M);O=q.length===1?{type:"LineString",coordinates:q[0]}:{type:"MultiLineString",coordinates:q}}else{if(this.type!==3)throw new Error("unknown feature type");{const q=function(Y){const ae=Y.length;if(ae<=1)return[Y];const le=[];let ce,Se;for(let Ae=0;Ae<ae;Ae++){const Ee=Kn(Y[Ae]);Ee!==0&&(Se===void 0&&(Se=Ee<0),Se===Ee<0?(ce&&le.push(ce),ce=[Y[Ae]]):ce&&ce.push(Y[Ae]))}return ce&&le.push(ce),le}(T),K=[];for(const Y of q)K.push(Y.map(M));O=K.length===1?{type:"Polygon",coordinates:K[0]}:{type:"MultiPolygon",coordinates:K}}}const z={type:"Feature",geometry:O,properties:this.properties};return this.id!=null&&(z.id=this.id),z}}function Qn(u,s,c){u===1?s.id=c.readVarint():u===2?function(f,p){const _=f.readVarint()+f.pos;for(;f.pos<_;){const b=p._keys[f.readVarint()],T=p._values[f.readVarint()];p.properties[b]=T}}(c,s):u===3?s.type=c.readVarint():u===4&&(s._geometry=c.pos)}function Kn(u){let s=0;for(let c,f,p=0,_=u.length,b=_-1;p<_;b=p++)c=u[p],f=u[b],s+=(f.x-c.x)*(c.y+f.y);return s}rn.types=["Unknown","Point","LineString","Polygon"];class Jn{constructor(s,c){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(Zn,this,c),this.length=this._features.length}feature(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];const c=this._pbf.readVarint()+this._pbf.pos;return new rn(this._pbf,c,this.extent,this._keys,this._values)}}function Zn(u,s,c){u===15?s.version=c.readVarint():u===1?s.name=c.readString():u===5?s.extent=c.readVarint():u===2?s._features.push(c.pos):u===3?s._keys.push(c.readString()):u===4&&s._values.push(function(f){let p=null;const _=f.readVarint()+f.pos;for(;f.pos<_;){const b=f.readVarint()>>3;p=b===1?f.readString():b===2?f.readFloat():b===3?f.readDouble():b===4?f.readVarint64():b===5?f.readVarint():b===6?f.readSVarint():b===7?f.readBoolean():null}if(p==null)throw new Error("unknown feature value");return p}(c))}class Er{constructor(s,c){this.layers=s.readFields(Vr,{},c)}}function Vr(u,s,c){if(u===3){const f=new Jn(c,c.readVarint()+c.pos);f.length&&(s[f.name]=f)}}const Wr="3d_elevation_id",Ki="level";class Nr{constructor(){this._valid=!1}reset(s){return this.feature=s,this._valid=!0,this._geometry=s.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(s,c){return this._valid&&s(c(this._geometry)),this}require(s,c,f){return this.get(s,!0,c,f)}optional(s,c,f){return this.get(s,!1,c,f)}success(){return this._valid}get(s,c,f,p){const _=this.feature.properties.hasOwnProperty(s)?+this.feature.properties[s]:void 0;return this._valid&&_!==void 0&&!Number.isNaN(_)?f(p?p(_):_):c&&(this._valid=!1),this}}class Ri{constructor(s,c){this.featureFunc=s,this.vertexFunc=c}parseFeature(s,c,f){return this.featureFunc(s,c,f)}parseVertex(s,c,f){return this.vertexFunc(s,c,f)}}const qi=new Ri((u,s,c)=>u.reset(s).require(Wr,f=>{c.id=f}).optional("fixed_height_relative",f=>{c.constantHeight=f},$r.decodeRelativeHeight).geometry(f=>{c.bounds=f},Fu).success(),(u,s,c)=>u.reset(s).require(Wr,f=>{c.id=f}).require("elevation_idx",f=>{c.idx=f}).require("extent",f=>{c.extent=f}).require("height_relative",f=>{c.height=f},$r.decodeRelativeHeight).geometry(f=>{c.position=f},$r.getPoint).success()),Rs=new Ri((u,s,c)=>u.reset(s).require(Wr,f=>{c.id=f}).optional("fixed_height",f=>{c.constantHeight=f},$r.decodeMetricHeight).geometry(f=>{c.bounds=f},Fu).success(),(u,s,c)=>u.reset(s).require(Wr,f=>{c.id=f}).require("elevation_idx",f=>{c.idx=f}).require("extent",f=>{c.extent=f}).require("height",f=>{c.height=f},$r.decodeMetricHeight).geometry(f=>{c.position=f},$r.getPoint).success());class $r{static getPoint(s){return Hi(s[0][0].x,s[0][0].y)}static decodeRelativeHeight(s){return 1e-4*s*5}static decodeMetricHeight(s){return 1e-4*s}static getVersionSchema(s){return s?s==="1.0.1"?Rs:void 0:qi}static parse(s){const c=[],f=[],p=s.length,_=new Nr;for(let b=0;b<p;b++){const T=s.feature(b),I=T.properties.version,M=$r.getVersionSchema(I);if(M===void 0){ai(`Unknown elevation feature version number ${I||"(unknown)"}`);continue}const O=T.properties.type;if(!O)continue;const z=rn.types[T.type];if(z==="Point"&&O==="curve_point"){const q={};M.parseVertex(_,T,q)&&c.push(q)}else if(z==="Polygon"&&O==="curve_meta"){const q={};M.parseFeature(_,T,q)&&f.push(q)}}return{vertices:c,features:f}}}class zi{constructor(s,c){this.pos=s,this.dir=c}intersectsPlane(s,c,f){const p=Ur(c,this.dir);if(Math.abs(p)<1e-6)return!1;const _=((s[0]-this.pos[0])*c[0]+(s[1]-this.pos[1])*c[1])/p;return f[0]=this.pos[0]+this.dir[0]*_,f[1]=this.pos[1]+this.dir[1]*_,!0}}class ji{constructor(s,c){this.pos=s,this.dir=c}intersectsPlane(s,c,f){const p=dt(c,this.dir);if(Math.abs(p)<1e-6)return!1;const _=((s[0]-this.pos[0])*c[0]+(s[1]-this.pos[1])*c[1]+(s[2]-this.pos[2])*c[2])/p;return f[0]=this.pos[0]+this.dir[0]*_,f[1]=this.pos[1]+this.dir[1]*_,f[2]=this.pos[2]+this.dir[2]*_,!0}closestPointOnSphere(s,c,f){if(function(K,Y){var ae=K[0],le=K[1],ce=K[2],Se=Y[0],Ae=Y[1],Ee=Y[2];return Math.abs(ae-Se)<=y*Math.max(1,Math.abs(ae),Math.abs(Se))&&Math.abs(le-Ae)<=y*Math.max(1,Math.abs(le),Math.abs(Ae))&&Math.abs(ce-Ee)<=y*Math.max(1,Math.abs(ce),Math.abs(Ee))}(this.pos,s)||c===0)return f[0]=f[1]=f[2]=0,!1;const[p,_,b]=this.dir,T=this.pos[0]-s[0],I=this.pos[1]-s[1],M=this.pos[2]-s[2],O=p*p+_*_+b*b,z=2*(T*p+I*_+M*b),q=z*z-4*O*(T*T+I*I+M*M-c*c);if(q<0){const K=Math.max(-z/2,0),Y=T+p*K,ae=I+_*K,le=M+b*K,ce=Math.hypot(Y,ae,le);return f[0]=Y*c/ce,f[1]=ae*c/ce,f[2]=le*c/ce,!1}{const K=(-z-Math.sqrt(q))/(2*O);if(K<0){const Y=Math.hypot(T,I,M);return f[0]=T*c/Y,f[1]=I*c/Y,f[2]=M*c/Y,!1}return f[0]=T+p*K,f[1]=I+_*K,f[2]=M+b*K,!0}}}class Ui{constructor(s,c,f,p,_){this.TL=s,this.TR=c,this.BR=f,this.BL=p,this.horizon=_}static fromInvProjectionMatrix(s,c,f){const p=[-1,1,1],_=[1,1,1],b=[1,-1,1],T=[-1,-1,1],I=Pt(p,p,s),M=Pt(_,_,s),O=Pt(b,b,s),z=Pt(T,T,s);return new Ui(I,M,O,z,c/f)}}function Vs(u,s,c){let f=1/0,p=-1/0;const _=[];for(const b of u){st(_,b,s);const T=dt(_,c);f=Math.min(f,T),p=Math.max(p,T)}return[f,p]}function ba(u,s){let c=!0;for(let f=0;f<u.planes.length;f++){const p=u.planes[f];let _=0;for(let b=0;b<s.length;b++)_+=+(dt(p,s[b])+p[3]>=0);if(_===0)return 0;_!==s.length&&(c=!1)}return c?2:1}function Mo(u,s){for(const c of u.projections){const f=Vs(s,u.points[0],c.axis);if(c.projection[1]<f[0]||c.projection[0]>f[1])return 0}return 1}function $s(u,s){let c=0;const f=[0,0,0,0];for(let b=0;b<u.length;b++)f[0]=u[b][0],f[1]=u[b][1],f[2]=u[b][2],f[3]=1,(p=f)[0]*(_=s)[0]+p[1]*_[1]+p[2]*_[2]+p[3]*_[3]>=0&&c++;var p,_;return c}class Zr{constructor(s,c){this.points=s||new Array(8).fill([0,0,0]),this.planes=c||new Array(6).fill([0,0,0,0]),this.bounds=gr.fromPoints(this.points),this.projections=[],this.frustumEdges=[st([],this.points[2],this.points[3]),st([],this.points[0],this.points[3]),st([],this.points[4],this.points[0]),st([],this.points[5],this.points[1]),st([],this.points[6],this.points[2]),st([],this.points[7],this.points[3])];for(const f of this.frustumEdges){const p=[0,-f[2],f[1]],_=[f[2],0,-f[0]];this.projections.push({axis:p,projection:Vs(this.points,this.points[0],p)}),this.projections.push({axis:_,projection:Vs(this.points,this.points[0],_)})}}static fromInvProjectionMatrix(s,c,f,p){const _=Math.pow(2,f),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(M=>{const O=wt([],M,s),z=1/O[3]/c*_;return(q=O)[0]=(K=O)[0]*(Y=[z,z,p?1/O[3]:z,z])[0],q[1]=K[1]*Y[1],q[2]=K[2]*Y[2],q[3]=K[3]*Y[3],q;var q,K,Y}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(M=>{const O=gt([],At([],st([],b[M[0]],b[M[1]]),st([],b[M[2]],b[M[1]]))),z=-dt(O,b[M[1]]);return O.concat(z)}),I=[];for(let M=0;M<b.length;M++)I.push([b[M][0],b[M][1],b[M][2]]);return new Zr(I,T)}intersectsPrecise(s,c,f){for(let p=0;p<c.length;p++)if(!$s(s,c[p]))return 0;for(let p=0;p<this.planes.length;p++)if(!$s(s,this.planes[p]))return 0;for(const p of f)for(const _ of this.frustumEdges){const b=At([],p,_),T=Ce(b);if(T===0)continue;xt(b,b,1/T);const I=Vs(this.points,this.points[0],b),M=Vs(s,this.points[0],b);if(I[0]>M[1]||M[0]>I[1])return 0}return 1}containsPoint(s){for(const c of this.planes){const f=c[3];if(dt([c[0],c[1],c[2]],s)+f<0)return!1}return!0}}class gr{static fromPoints(s){const c=[1/0,1/0,1/0],f=[-1/0,-1/0,-1/0];for(const p of s)De(c,c,p),Ct(f,f,p);return new gr(c,f)}static fromTileIdAndHeight(s,c,f){const p=1<<s.canonical.z,_=s.canonical.x,b=s.canonical.y;return new gr([_/p,b/p,c],[(_+1)/p,(b+1)/p,f])}static applyTransform(s,c){const f=s.getCorners();for(let p=0;p<f.length;++p)Pt(f[p],f[p],c);return gr.fromPoints(f)}static applyTransformFast(s,c){const f=[c[12],c[13],c[14]],p=[...f];for(let _=0;_<3;_++)for(let b=0;b<3;b++){const T=c[4*b+_],I=T*s.min[b],M=T*s.max[b];f[_]+=Math.min(I,M),p[_]+=Math.max(I,M)}return new gr(f,p)}static projectAabbCorners(s,c){const f=s.getCorners();for(let p=0;p<f.length;++p)Pt(f[p],f[p],c);return f}constructor(s,c){this.min=s,this.max=c,this.center=xt([],Qe([],this.min,this.max),.5)}quadrant(s){const c=[s%2==0,s<2],f=ge(this.min),p=ge(this.max);for(let _=0;_<c.length;_++)f[_]=c[_]?this.min[_]:this.center[_],p[_]=c[_]?this.center[_]:this.max[_];return p[2]=this.max[2],new gr(f,p)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}distanceZ(s){return Math.max(Math.min(this.max[2],s[2]),this.min[2])-s[2]}getCorners(){const s=this.min,c=this.max;return[[s[0],s[1],s[2]],[c[0],s[1],s[2]],[c[0],c[1],s[2]],[s[0],c[1],s[2]],[s[0],s[1],c[2]],[c[0],s[1],c[2]],[c[0],c[1],c[2]],[s[0],c[1],c[2]]]}intersects(s){return this.intersectsAabb(s.bounds)?ba(s,this.getCorners()):0}intersectsFlat(s){return this.intersectsAabb(s.bounds)?ba(s,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(s,c){return c||this.intersects(s)?Mo(s,this.getCorners()):0}intersectsPreciseFlat(s,c){return c||this.intersectsFlat(s)?Mo(s,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(s){for(let c=0;c<3;++c)if(this.min[c]>s.max[c]||s.min[c]>this.max[c])return!1;return!0}intersectsAabbXY(s){return!(this.min[0]>s.max[0]||s.min[0]>this.max[0]||this.min[1]>s.max[1]||s.min[1]>this.max[1])}encapsulate(s){for(let c=0;c<3;c++)this.min[c]=Math.min(this.min[c],s.min[c]),this.max[c]=Math.max(this.max[c],s.max[c])}encapsulatePoint(s){for(let c=0;c<3;c++)this.min[c]=Math.min(this.min[c],s[c]),this.max[c]=Math.max(this.max[c],s[c])}closestPoint(s){return[Math.max(Math.min(this.max[0],s[0]),this.min[0]),Math.max(Math.min(this.max[1],s[1]),this.min[1]),Math.max(Math.min(this.max[2],s[2]),this.min[2])]}}Pn(gr,"Aabb");class Yi{constructor(s,c){this.feature=s,this.metersToTile=c,this.index=0}get(){const s=this.feature.vertices[this.index],c=this.feature.vertexProps[this.index].dir,f=c[1],p=-c[0],_=(s.extent+1)*this.metersToTile;return[new zt(Math.trunc(s.position[0]+f*_),Math.trunc(s.position[1]+p*_)),new zt(Math.trunc(s.position[0]-f*_),Math.trunc(s.position[1]-p*_))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class la{constructor(s,c,f,p,_,b){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this._tmpVec2=[dr(),dr(),dr(),dr(),dr(),dr(),dr()],this.id=s,this.heightRange={min:f,max:f},this.safeArea=c,this.constantHeight=f,this.constantHeight==null&&(this.constantHeight!=null||p.length!==0)){this.vertices=p,this.edges=_,this.edges=this.edges.filter(T=>{return T.a<this.vertices.length&&T.b<this.vertices.length&&!((I=this.vertices[T.a].position)[0]===(M=this.vertices[T.b].position)[0]&&I[1]===M[1]);var I,M}),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const T of this.vertices)this.vertexProps.push({dir:Hi(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,T.height),this.heightRange.max=Math.max(this.heightRange.max,T.height);for(const T of this.edges){const I=this.vertices[T.a].position,M=this.vertices[T.b].position,O=fi(dr(),M,I),z=bn(O),q=Cn(dr(),O,1/z);this.edgeProps.push({vec:O,dir:q,len:z});const K=this.vertexProps[T.a].dir,Y=this.vertexProps[T.b].dir;Cr(K,K,q),Cr(Y,Y,q)}for(const T of this.vertexProps)T.dir[0]===0&&T.dir[1]===0||fr(T.dir,T.dir);this.tessellate(b)}}pointElevation(s){if(this.constantHeight!=null)return this.constantHeight;const c=this.getClosestEdge(s);if(c==null)return 0;const[f,p]=c;return qe(this.vertices[this.edges[f].a].height,this.vertices[this.edges[f].b].height,p)}computeSlopeNormal(s,c){const f=this.getClosestEdge(s);if(!f)return xe(0,0,1);const p=f[0],_=this.edges[p],b=this.edgeProps[p].vec,T=xe(b[0],b[1],(this.vertices[_.b].height-this.vertices[_.a].height)*c),I=xe(T[1],-T[0],0);At(I,I,T);const M=Ce(I);return M>0?xt(I,I,1/M):Re(I,0,0,1)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(s){if(this.edges.length===0)return;let c=0,f=Number.POSITIVE_INFINITY,p=0;const[_,b,T,I,M,O,z]=this._tmpVec2;Bi(z,s.x,s.y);const q=new zi(z,null);for(let K=0;K<this.edges.length;K++){const Y=this.edges[K],ae=this.edgeProps[K].dir;q.dir=ae;const le=this.vertices[Y.a].position,ce=this.vertices[Y.b].position,Se=q.intersectsPlane(le,this.vertexProps[Y.a].dir,_),Ae=q.intersectsPlane(ce,this.vertexProps[Y.b].dir,b);if(!Se||!Ae)continue;fi(T,b,_),fi(I,z,_);const Ee=Ur(T,T),Ze=Ee>0?Ur(I,T)/Ee:0,Ke=We(Ze,0,1),tt=Math.abs((Ze-Ke)*this.edgeProps[K].len);fi(M,z,le),Bi(O,ae[1],-ae[0]);const at=tt+Math.abs(Ur(M,O));at<f&&(c=K,f=at,p=Ke)}return[c,p]}tessellate(s){const c=fe(),f=fe(),p=fe(),_=fe();for(let b=this.edges.length-1;b>=0;--b){const T=this.edges[b].a,I=this.edges[b].b,{position:M,height:O,extent:z}=this.vertices[T],{position:q,height:K,extent:Y}=this.vertices[I],ae=this.vertexProps[T].dir,le=this.vertexProps[I].dir;if(Re(c,M[0]/s,M[1]/s,O),Re(f,q[0]/s,q[1]/s,K),Re(p,ae[1],-ae[0],0),xt(p,p,z),Re(_,le[1],-le[0],0),xt(_,_,Y),this.distSqLines(xe(c[0]+.5*p[0],c[1]+.5*p[1],c[2]+.5*p[2]),xe(f[0]-.5*_[0],f[1]-.5*_[1],f[2]-.5*_[2]),xe(c[0]-.5*p[0],c[1]-.5*p[1],c[2]-.5*p[2]),xe(f[0]+.5*_[0],f[1]+.5*_[1],f[2]+.5*_[2]))<=.0025000000000000005)continue;const ce=this.vertices.length,Se=Cr(dr(),M,q);this.vertices.push({position:Cn(Se,Se,.5),height:.5*(O+K),extent:.5*(z+Y)});const Ae=Cr(dr(),ae,le);this.vertexProps.push({dir:fr(Ae,Ae)}),this.edges.splice(b,1),this.edgeProps.splice(b,1),this.edges.push({a:T,b:ce}),this.edges.push({a:ce,b:I});const Ee=fi(dr(),this.vertices[ce].position,M),Ze=bn(Ee),Ke={vec:Ee,dir:Cn(dr(),Ee,1/Ze),len:Ze};this.edgeProps.push(Ke),this.edgeProps.push(Ke)}}distSqLines(s,c,f,p){const _=et(fe(),c,s),b=et(fe(),p,f),T=et(fe(),s,f),I=dt(_,_),M=dt(_,b),O=dt(_,T),z=dt(b,b),q=dt(b,T),K=I*z-M*M;if(K===0)return Ye(mt(_,f,p,dt(T,b)/dt(b,b)),s);const Y=(I*q-M*O)/K;return Ye(mt(_,s,c,(M*q-O*z)/K),mt(b,f,p,Y))}}class Ks{static parseFrom(s,c){const f=$r.parse(s);if(!f)return[];let{vertices:p,features:_}=f;const b=1/bt(c);_.sort((O,z)=>O.id-z.id),p.sort((O,z)=>O.id-z.id||O.idx-z.idx),p=p.filter((O,z,q)=>z===q.findIndex(K=>K.id===O.id&&K.idx===O.idx));const T=new Array;let I=0;const M=p.length;for(const O of _){if(O.constantHeight){T.push(new la(O.id,O.bounds,O.constantHeight));continue}for(;I!==M&&p[I].id<O.id;)I++;if(I===M||p[I].id!==O.id)continue;const z=new Array,q=new Array,K=I;for(;I!==M&&p[I].id===O.id;){const Y=p[I];if(z.push({position:Y.position,height:Y.height,extent:Y.extent}),I!==K&&p[I-1].idx===Y.idx-1){const ae=I-K;q.push({a:ae-1,b:ae})}I++}T.push(new la(O.id,O.bounds,void 0,z,q,b))}return T}static getElevationFeature(s,c){if(!c)return;const f=+s.properties[Wr];return Number.isNaN(f)?void 0:c.find(p=>p.id===f)}}class Va{constructor(s,c){this.zScale=1,this.xOffset=0,this.yOffset=0,s.equals(c)||(this.zScale=Math.pow(2,c.z-s.z),this.xOffset=(s.x*this.zScale-c.x)*yn,this.yOffset=(s.y*this.zScale-c.y)*yn)}constantElevation(s,c){if(s.constantHeight!=null)return this.computeBiasedHeight(s.constantHeight,c)}pointElevation(s,c,f){const p=this.constantElevation(c,f);return p??(s.x=s.x*this.zScale+this.xOffset,s.y=s.y*this.zScale+this.yOffset,this.computeBiasedHeight(c.pointElevation(s),f))}computeBiasedHeight(s,c){return c<=0?s:s+c*kt(0,c,s>=0?s:Math.abs(.5*s))}}Pn(la,"ElevationFeature");class el{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=s.index,this.hasPattern=!1,this.projection=s.projection,this.layoutVertexArray=new im,this.indexArray=new vo,this.segments=new Qs,this.programConfigurations=new oh(s.layers,{zoom:s.zoom,lut:s.lut}),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.elevationMode=this.layers[0].layout.get("circle-elevation-reference"),this.hasElevation=!1,this.elevationMode!=="none"&&(this.elevatedLayoutVertexArray=new sm),this.worldview=s.worldview}updateFootprints(s,c){}populate(s,c,f,p){const _=this.layers[0],b=[];let T=null;_.type==="circle"&&(T=_.layout.get("circle-sort-key"));for(const{feature:M,id:O,index:z,sourceLayerIndex:q}of s){const K=this.layers[0]._featureFilter.needGeometry,Y=dn(M,K);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom,{worldview:this.worldview}),Y,f))continue;const ae=T?T.evaluate(Y,{},f):void 0,le={id:O,properties:M.properties,type:M.type,sourceLayerIndex:q,index:z,geometry:K?Y.geometry:Nn(M,f,p),patterns:{},sortKey:ae};b.push(le)}T&&b.sort((M,O)=>M.sortKey-O.sortKey);let I=null;p.projection.name==="globe"&&(this.globeExtVertexArray=new Yx,I=p.projection);for(const M of b){const{geometry:O,index:z,sourceLayerIndex:q}=M,K=s[z].feature;this.addFeature(M,O,z,c.availableImages,f,I,c.brightness,c.elevationFeatures),c.featureIndex.insert(K,O,z,q,this.index)}this.hasElevation||(this.elevatedLayoutVertexArray=void 0)}update(s,c,f,p,_,b,T){this.programConfigurations.updatePaintArrays(s,c,_,f,p,b,T,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,bN.members),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,SN.members)),this.elevatedLayoutVertexArray&&(this.elevatedLayoutVertexBuffer=s.createVertexBuffer(this.elevatedLayoutVertexArray,wN.members))),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy())}addFeature(s,c,f,p,_,b,T,I){let M;this.elevationMode!=="none"&&(M=Ks.getElevationFeature(s,I));for(const O of c)for(const z of O){const q=z.x,K=z.y;if(q<0||q>=yn||K<0||K>=yn)continue;if(b){const le=b.projectTilePoint(q,K,_),ce=b.upVector(_,q,K);this.addGlobeExtVertex(le,ce),this.addGlobeExtVertex(le,ce),this.addGlobeExtVertex(le,ce),this.addGlobeExtVertex(le,ce)}const Y=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),ae=Y.vertexLength;if(this.addCircleVertex(q,K,-1,-1),this.addCircleVertex(q,K,1,-1),this.addCircleVertex(q,K,1,1),this.addCircleVertex(q,K,-1,1),this.elevationMode!=="none"){const le=M?M.pointElevation(new zt(q,K)):0;this.hasElevation=this.hasElevation||le!==0;for(let ce=0;ce<4;ce++)this.elevatedLayoutVertexArray.emplaceBack(le)}this.indexArray.emplaceBack(ae,ae+1,ae+2),this.indexArray.emplaceBack(ae,ae+2,ae+3),Y.vertexLength+=4,Y.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,{},p,_,T,void 0,this.worldview)}addCircleVertex(s,c,f,p){this.layoutVertexArray.emplaceBack(2*s+(f+1)/2,2*c+(p+1)/2)}addGlobeExtVertex(s,c){this.globeExtVertexArray.emplaceBack(s.x,s.y,s.z,c[0]*16384,c[1]*16384,c[2]*16384)}}function Uu(u,s){for(let c=0;c<u.length;c++)if(Lo(s,u[c]))return!0;for(let c=0;c<s.length;c++)if(Lo(u,s[c]))return!0;return!!_c(u,s)}function Vu(u,s,c){return!!Lo(u,s)||!!wa(s,u,c)}function uu(u,s){if(u.length===1)return ao(s,u[0]);for(let c=0;c<s.length;c++){const f=s[c];for(let p=0;p<f.length;p++)if(Lo(u,f[p]))return!0}for(let c=0;c<u.length;c++)if(ao(s,u[c]))return!0;for(let c=0;c<s.length;c++)if(_c(u,s[c]))return!0;return!1}function du(u,s,c){if(u.length>1){if(_c(u,s))return!0;for(let f=0;f<s.length;f++)if(wa(s[f],u,c))return!0}for(let f=0;f<u.length;f++)if(wa(u[f],s,c))return!0;return!1}function _c(u,s){if(u.length===0||s.length===0)return!1;for(let c=0;c<u.length-1;c++){const f=u[c],p=u[c+1];for(let _=0;_<s.length-1;_++)if(Id(f,p,s[_],s[_+1]))return!0}return!1}function Id(u,s,c,f){return Js(u,c,f)!==Js(s,c,f)&&Js(u,s,c)!==Js(u,s,f)}function lh(u,s,c){return(u.x-c.x)*(s.y-c.y)-(u.y-c.y)*(s.x-c.x)}function ga(u,s,c,f){const p=lh(u,s,f),_=lh(u,s,c);if(Math.sign(p)===Math.sign(_))return;const b=lh(c,f,u),T=b+_-p;return Math.sign(b)!==Math.sign(T)?[b/(b-T),_/(_-p)]:void 0}function wa(u,s,c){const f=c*c;if(s.length===1)return u.distSqr(s[0])<f;for(let p=1;p<s.length;p++)if(Ys(u,s[p-1],s[p])<f)return!0;return!1}function Ys(u,s,c){const f=s.distSqr(c);if(f===0)return u.distSqr(s);const p=((u.x-s.x)*(c.x-s.x)+(u.y-s.y)*(c.y-s.y))/f;return u.distSqr(p<0?s:p>1?c:c.sub(s)._mult(p)._add(s))}function ao(u,s){let c,f,p,_=!1;for(let b=0;b<u.length;b++){c=u[b];for(let T=0,I=c.length-1;T<c.length;I=T++)f=c[T],p=c[I],f.y>s.y!=p.y>s.y&&s.x<(p.x-f.x)*(s.y-f.y)/(p.y-f.y)+f.x&&(_=!_)}return _}function Lo(u,s){let c=!1;for(let f=0,p=u.length-1;f<u.length;p=f++){const _=u[f],b=u[p];_.y>s.y!=b.y>s.y&&s.x<(b.x-_.x)*(s.y-_.y)/(b.y-_.y)+_.x&&(c=!c)}return c}function Ma(u,s,c,f,p){for(const b of u)if(s<=b.x&&c<=b.y&&f>=b.x&&p>=b.y)return!0;const _=[new zt(s,c),new zt(s,p),new zt(f,p),new zt(f,c)];if(u.length>2){for(const b of _)if(Lo(u,b))return!0}for(let b=0;b<u.length-1;b++)if(Ml(u[b],u[b+1],_))return!0;return!1}function Ml(u,s,c){const f=c[0],p=c[2];if(u.x<f.x&&s.x<f.x||u.x>p.x&&s.x>p.x||u.y<f.y&&s.y<f.y||u.y>p.y&&s.y>p.y)return!1;const _=Js(u,s,c[0]);return _!==Js(u,s,c[1])||_!==Js(u,s,c[2])||_!==Js(u,s,c[3])}function Xh(u,s,c,f,p,_){let b=s.y-u.y,T=u.x-s.x;if(_=_||0){const I=b*b+T*T;if(I===0)return!0;const M=Math.sqrt(I);b/=M,T/=M}return!((c.x-u.x)*b+(c.y-u.y)*T-_<0||(f.x-u.x)*b+(f.y-u.y)*T-_<0||(p.x-u.x)*b+(p.y-u.y)*T-_<0)}function Xf(u,s,c,f,p,_,b){return!(Xh(u,s,f,p,_,b)||Xh(s,c,f,p,_,b)||Xh(c,u,f,p,_,b)||Xh(f,p,u,s,c,b)||Xh(p,_,u,s,c,b)||Xh(_,f,u,s,c,b))}function ch(u,s,c){const f=s.paint.get(u).value;return f.kind==="constant"?f.value:c.programConfigurations.get(s.id).getMaxValue(u)}function lm(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function cm(u,s,c,f,p){if(!s[0]&&!s[1])return u;const _=zt.convert(s)._mult(p);c==="viewport"&&_._rotate(-f);const b=[];for(let T=0;T<u.length;T++)b.push(u[T].sub(_));return b}function Jh(u,s,c,f){const p=zt.convert(u)._mult(f);return s==="viewport"&&p._rotate(-c),p}let Qy,Jf;function Qh(u,s,c){var f=2*Math.PI*6378137/256/Math.pow(2,c);return[u*f-2*Math.PI*6378137/2,s*f-2*Math.PI*6378137/2]}Pn(el,"CircleBucket",{omit:["layers"]});class Qf{constructor(s,c,f){this.z=s,this.x=c,this.y=f,this.key=a1(0,s,s,c,f)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}isChildOf(s){const c=this.z-s.z;return s.z===0||s.z<this.z&&s.x===this.x>>c&&s.y===this.y>>c}url(s,c){const f=function(_,b,T){var I=Qh(256*_,256*(b=Math.pow(2,T)-b-1),T),M=Qh(256*(_+1),256*(b+1),T);return I[0]+","+I[1]+","+M[0]+","+M[1]}(this.x,this.y,this.z),p=function(_,b,T){let I,M="";for(let O=_;O>0;O--)I=1<<O-1,M+=(b&I?1:0)+(T&I?2:0);return M}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",f)}toString(){return`${this.z}/${this.x}/${this.y}`}}class s1{constructor(s,c){this.wrap=s,this.canonical=c,this.key=a1(s,c.z,c.z,c.x,c.y)}}class xc{constructor(s,c,f,p,_){this.overscaledZ=s,this.wrap=c,this.canonical=new Qf(f,+p,+_),this.key=c===0&&s===f?this.canonical.key:a1(c,s,f,p,_)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){const c=this.canonical.z-s;return s>this.canonical.z?new xc(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new xc(s,this.wrap,s,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(s,c=!0){if(this.overscaledZ===s&&c)return this.key;if(s>this.canonical.z)return a1(this.wrap*+c,s,this.canonical.z,this.canonical.x,this.canonical.y);{const f=this.canonical.z-s;return a1(this.wrap*+c,s,s,this.canonical.x>>f,this.canonical.y>>f)}}isChildOf(s){if(s.wrap!==this.wrap)return!1;const c=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.z<this.canonical.z&&s.canonical.x===this.canonical.x>>c&&s.canonical.y===this.canonical.y>>c}children(s){if(this.overscaledZ>=s)return[new xc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,f=2*this.canonical.x,p=2*this.canonical.y;return[new xc(c,this.wrap,c,f,p),new xc(c,this.wrap,c,f+1,p),new xc(c,this.wrap,c,f,p+1),new xc(c,this.wrap,c,f+1,p+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new xc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new xc(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new s1(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function a1(u,s,c,f,p){const _=1<<Math.min(c,22);let b=_*(p%_)+f%_;return u&&c<22&&(b+=_*_*((u<0?-2*u-1:2*u)%(1<<2*(22-c)))),16*(32*b+c)+(s-c)}const Ofe=[u=>{let s=u.canonical.x-1,c=u.wrap;return s<0&&(s=(1<<u.canonical.z)-1,c--),new xc(u.overscaledZ,c,u.canonical.z,s,u.canonical.y)},u=>{let s=u.canonical.x+1,c=u.wrap;return s===1<<u.canonical.z&&(s=0,c++),new xc(u.overscaledZ,c,u.canonical.z,s,u.canonical.y)},u=>new xc(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,(u.canonical.y===0?1<<u.canonical.z:u.canonical.y)-1),u=>new xc(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y===(1<<u.canonical.z)-1?0:u.canonical.y+1)];Pn(Qf,"CanonicalTileID"),Pn(xc,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Ffe=Ti([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:kT}=Ffe,zfe=Ti([{name:"a_pos_3",components:3,type:"Int16"}]);var b8=Ti([{name:"a_pos",type:"Int16",components:2}]);function IT(u){return u*m/te}const Bfe=[new gr([V,V,V],[G,G,G]),new gr([V,V,V],[0,0,G]),new gr([0,V,V],[G,0,G]),new gr([V,0,V],[0,G,G]),new gr([0,0,V],[G,G,G])];function w8(u,s,c,f=!0){const p=xt([],u._camera.position,u.worldSize),_=[s,c,1,1];wt(_,_,u.pixelMatrixInverse),On(_,_,1/_[3]);const b=gt([],st([],_,p)),T=u.globeMatrix,I=[T[12],T[13],T[14]],M=st([],I,p),O=Ce(M),z=gt([],M),q=u.worldSize/(2*Math.PI),K=dt(z,b),Y=Math.asin(q/O);if(Y<Math.acos(K)){if(!f)return null;const qt=[],_t=[];xt(qt,b,O/K),gt(_t,st(_t,qt,M)),gt(b,Qe(b,M,xt(b,_t,Math.tan(Y)*O)))}const ae=[];new ji(p,b).closestPointOnSphere(I,q,ae);const le=gt([],zs(T,0)),ce=gt([],zs(T,1)),Se=gt([],zs(T,2)),Ae=dt(le,ae),Ee=dt(ce,ae),Ze=dt(Se,ae),Ke=de(Math.asin(-Ee/q));let tt=de(Math.atan2(Ae,Ze));tt=u.center.lng+function(qt,_t){const Xt=(_t-qt+180)%360-180;return Xt<-180?Xt+360:Xt}(u.center.lng,tt);const at=ke(tt),ct=We(Ue(Ke),0,1);return new Dt(at,ct)}class Ufe{constructor(s,c,f){this.a=st([],s,f),this.b=st([],c,f),this.center=f;const p=gt([],this.a),_=gt([],this.b);this.angle=Math.acos(dt(p,_))}}function kN(u,s){if(u.angle===0)return null;let c;return c=u.a[s]===0?1/u.angle*.5*Math.PI:1/u.angle*Math.atan(u.b[s]/u.a[s]/Math.sin(u.angle)-1/Math.tan(u.angle)),c<0||c>1?null:function(f,p,_,b){const T=Math.sin(_);return f*(Math.sin((1-b)*_)/T)+p*(Math.sin(b*_)/T)}(u.a[s],u.b[s],u.angle,We(c,0,1))+u.center[s]}function um(u){if(u.z<=1)return Bfe[u.z+2*u.y+u.x];const s=IN(NT(u));return gr.fromPoints(s)}function Sg(u,s,c){return xt(u,u,1-c),me(u,u,s,c)}function S8(u,s,c){for(const f of u)Pt(f,f,s),xt(f,f,c)}function A8(u,s,c,f){const p=s/u.worldSize,_=u.globeMatrix;if(c.z<=1){const ct=um(c).getCorners();return S8(ct,_,p),gr.fromPoints(ct)}const b=NT(c,f),T=IN(b,m+IT(u._tileCoverLift));S8(T,_,p);const I=Number.MAX_VALUE,M=[-I,-I,-I],O=[I,I,I];if(b.contains(u.center)){for(const _t of T)De(O,O,_t),Ct(M,M,_t);M[2]=0;const ct=u.point,qt=[ct.x*p,ct.y*p,0];return De(O,O,qt),Ct(M,M,qt),new gr(O,M)}if(u._tileCoverLift>0){for(const ct of T)De(O,O,ct),Ct(M,M,ct);return new gr(O,M)}const z=[_[12]*p,_[13]*p,_[14]*p],q=b.getCenter(),K=We(u.center.lat,-Ge,Ge),Y=We(q.lat,-Ge,Ge),ae=ke(u.center.lng),le=Ue(K);let ce=ae-ke(q.lng);const Se=le-Ue(Y);ce>.5?ce-=1:ce<-.5&&(ce+=1);let Ae=0;Math.abs(ce)>Math.abs(Se)?Ae=ce>=0?1:3:(Ae=Se>=0?0:2,me(z,z,[_[4]*p,_[5]*p,_[6]*p],-Math.sin(lt(Se>=0?b.getSouth():b.getNorth()))*m));const Ee=T[Ae],Ze=T[(Ae+1)%4],Ke=new Ufe(Ee,Ze,z),tt=[kN(Ke,0)||Ee[0],kN(Ke,1)||Ee[1],kN(Ke,2)||Ee[2]],at=e0(u.zoom);if(at>0){const ct=function({x:_t,y:Xt,z:an},Jt,en,hn,Vt){const nn=1/(1<<an);let Lt=_t*nn,It=Lt+nn,fn=Xt*nn,cn=fn+nn,tr=0;const Fn=(Lt+It)/2-hn;return Fn>.5?tr=-1:Fn<-.5&&(tr=1),Lt=((Lt+tr)*Jt-(hn*=Jt))*en+hn,It=((It+tr)*Jt-hn)*en+hn,fn=(fn*Jt-(Vt*=Jt))*en+Vt,cn=(cn*Jt-Vt)*en+Vt,[[Lt,cn,0],[It,cn,0],[It,fn,0],[Lt,fn,0]]}(c,s,u._pixelsPerMercatorPixel,ae,le);for(let _t=0;_t<T.length;_t++)Sg(T[_t],ct[_t],at);const qt=Qe([],ct[Ae],ct[(Ae+1)%4]);xt(qt,qt,.5),Sg(tt,qt,at)}for(const ct of T)De(O,O,ct),Ct(M,M,ct);return O[2]=Math.min(Ee[2],Ze[2]),De(O,O,tt),Ct(M,M,tt),new gr(O,M)}function NT({x:u,y:s,z:c},f=!1){const p=1/(1<<c),_=new se(Ve(u*p),s===(1<<c)-1&&f?-90:ze((s+1)*p)),b=new se(Ve((u+1)*p),s===0&&f?90:ze(s*p));return new ve(_,b)}function IN(u,s=m){const c=lt(u.getNorth()),f=lt(u.getSouth()),p=Math.cos(c),_=Math.cos(f),b=Math.sin(c),T=Math.sin(f),I=u.getWest(),M=u.getEast();return[X(_,T,I,s),X(_,T,M,s),X(p,b,M,s),X(p,b,I,s)]}function p2(u,s,c,f){const p=1<<c.z,_=(u/yn+c.x)/p;return W(ze((s/yn+c.y)/p),Ve(_),f)}function MT({min:u,max:s}){return k/Math.max(s[0]-u[0],s[1]-u[1],s[2]-u[2])}const T8=new Float64Array(16);function LT(u){const s=MT(u),c=ne(T8,[s,s,s]);return $(c,c,vt([],u.min))}function NN(u){const s=(f=u.min,(c=T8)[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=f[0],c[13]=f[1],c[14]=f[2],c[15]=1,c);var c,f;const p=1/MT(u);return H(s,s,[p,p,p])}function MN(u){const s=yn/(2*Math.PI);return u/(2*Math.PI)/s}function C8(u,s){return yn/(512*Math.pow(2,u))*MT(um(s))}function E8(u,s,c,f,p){const _=MN(c),b=[u,s,-c/(2*Math.PI)],T=D(new Float64Array(16));return $(T,T,b),H(T,T,[_,_,_]),J(T,T,lt(-p)),ee(T,T,lt(-f)),T}function e0(u){return kt(S,A,u)}function P8(u,s){const c=W(s.lat,s.lng),f=function(Y){const ae=W(Y._center.lat,Y._center.lng);let le=At([],xe(0,1,0),ae);const ce=pe([],-Y.angle,ae);le=Pt(le,le,ce),pe(ce,-Y._pitch,le);const Se=gt([],ae);return xt(Se,Se,IT(Y.cameraToCenterDistance/Y.pixelsPerMeter)),Pt(Se,Se,ce),Qe([],ae,Se)}(u);return b=(p=et([],f,c))[0],T=p[1],I=p[2],M=(_=c)[0],O=_[1],z=_[2],K=(q=Math.sqrt((b*b+T*T+I*I)*(M*M+O*O+z*z)))&&dt(p,_)/q,Math.acos(Math.min(Math.max(K,-1),1));var p,_,b,T,I,M,O,z,q,K}function LN(u,s){return P8(u,s)>Math.PI/2*1.01}const k8=lt(85),Vfe=Math.cos(k8),$fe=Math.sin(k8),qfe=j(),I8=u=>{const s=[];return u.paint.get("circle-pitch-alignment")==="map"&&s.push("PITCH_WITH_MAP"),u.paint.get("circle-pitch-scale")==="map"&&s.push("SCALE_WITH_MAP"),s};function N8(u,s,c,f,p,_,b,T,I){if(_&&u.queryGeometry.isAboveHorizon)return!1;_&&(I*=u.pixelToTileUnitsFactor);const M=u.tileID.canonical,O=c.projection.upVectorScale(M,c.center.lat,c.worldSize).metersToTile;for(const z of s)for(const q of z){const K=q.add(T),Y=p&&c.elevation?c.elevation.exaggeration()*p.getElevationAt(K.x,K.y,!0):0,ae=c.projection.projectTilePoint(K.x,K.y,M);if(Y>0){const Ae=c.projection.upVector(M,K.x,K.y);ae.x+=Ae[0]*O*Y,ae.y+=Ae[1]*O*Y,ae.z+=Ae[2]*O*Y}const le=_?K:Gfe(ae.x,ae.y,ae.z,f),ce=_?u.tilespaceRays.map(Ae=>Wfe(Ae,Y)):u.queryGeometry.screenGeometry,Se=wt([],[ae.x,ae.y,ae.z,1],f);if(!b&&_?I*=Se[3]/c.cameraToCenterDistance:b&&!_&&(I*=c.cameraToCenterDistance/Se[3]),_){const Ae=ze((q.y/yn+M.y)/(1<<M.z));I/=c.projection.pixelsPerMeter(Ae,1)/Fe(1,Ae)}if(Vu(ce,le,I))return!0}return!1}function Gfe(u,s,c,f){const p=wt([],[u,s,c,1],f);return new zt(p[0]/p[3],p[1]/p[3])}const M8=xe(0,0,0),Hfe=xe(0,0,1);function Wfe(u,s){const c=fe();return M8[2]=s,u.intersectsPlane(M8,Hfe,c),new zt(c[0],c[1])}class L8 extends el{}let D8,R8,j8,O8;function F8(u,{width:s,height:c},f,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==s*c*f)throw new RangeError("mismatched image size")}else p=new Uint8Array(s*c*f);return u.width=s,u.height=c,u.data=p,u}function z8(u,s,c){const{width:f,height:p}=s;f===u.width&&p===u.height||(DN(u,s,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,f),height:Math.min(u.height,p)},c,null),u.width=f,u.height=p,u.data=s.data)}function DN(u,s,c,f,p,_,b,T){if(p.width===0||p.height===0)return s;if(p.width>u.width||p.height>u.height||c.x>u.width-p.width||c.y>u.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>s.width||p.height>s.height||f.x>s.width-p.width||f.y>s.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const I=u.data,M=s.data,O=_===4&&T;for(let z=0;z<p.height;z++){const q=((c.y+z)*u.width+c.x)*_,K=((f.y+z)*s.width+f.x)*_;if(O)for(let Y=0;Y<p.width;Y++){const ae=q+Y*_+3,le=K+Y*_;M[le+0]=255,M[le+1]=255,M[le+2]=255,M[le+3]=I[ae]}else if(b)for(let Y=0;Y<p.width;Y++){const ae=q+Y*_,le=K+Y*_,ce=new Ii(I[ae+0]/255,I[ae+1]/255,I[ae+2]/255,I[ae+3]).toNonPremultipliedRenderColor(b).toArray();M[le+0]=ce[0],M[le+1]=ce[1],M[le+2]=ce[2],M[le+3]=ce[3]}else for(let Y=0;Y<p.width*_;Y++)M[K+Y]=I[q+Y]}return s}Pn(L8,"HeatmapBucket",{omit:["layers"]});class t0{constructor(s,c){F8(this,s,1,c)}resize(s){z8(this,new t0(s),1)}clone(){return new t0({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,c,f,p,_){DN(s,c,f,p,_,1,null)}}class Ll{constructor(s,c){F8(this,s,4,c)}resize(s){z8(this,new Ll(s),4)}replace(s,c){c?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new Ll({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,c,f,p,_,b,T){DN(s,c,f,p,_,4,b,T)}}class B8{constructor(s,c){this.width=s.width,this.height=s.height,this.data=c instanceof Uint8Array?new Float32Array(c.buffer):c}}function m2(u){const s={},c=u.resolution||256,f=u.clips?u.clips.length:1,p=u.image||new Ll({width:c,height:f}),_=(b,T,I)=>{s[u.evaluationKey]=I;const M=u.expression.evaluate(s),O=M?M.toNonPremultipliedRenderColor(null):null;O&&(p.data[b+T+0]=Math.floor(255*O.r),p.data[b+T+1]=Math.floor(255*O.g),p.data[b+T+2]=Math.floor(255*O.b),p.data[b+T+3]=Math.floor(255*O.a))};if(u.clips)for(let b=0,T=0;b<f;++b,T+=4*c)for(let I=0,M=0;I<c;I++,M+=4){const O=I/(c-1),{start:z,end:q}=u.clips[b];_(T,M,z*(1-O)+q*O)}else for(let b=0,T=0;b<c;b++,T+=4)_(0,T,b/(c-1));return p}Pn(t0,"AlphaImage"),Pn(Ll,"RGBAImage");const Zfe=Ti([{name:"a_pos",components:2,type:"Int16"}],4),Kfe=Ti([{name:"a_road_z_offset",components:1,type:"Float32"}],4),Yfe=Ti([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),Xfe=Ti([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function o1(u,s,c=2){const f=s&&s.length,p=f?s[0]*c:u.length;let _=U8(u,0,p,c,!0);const b=[];if(!_||_.next===_.prev)return b;let T,I,M;if(f&&(_=function(O,z,q,K){const Y=[];for(let ae=0,le=z.length;ae<le;ae++){const ce=U8(O,z[ae]*K,ae<le-1?z[ae+1]*K:O.length,K,!1);ce===ce.next&&(ce.steiner=!0),Y.push(spe(ce))}Y.sort(npe);for(let ae=0;ae<Y.length;ae++)q=rpe(Y[ae],q);return q}(u,s,_,c)),u.length>80*c){T=u[0],I=u[1];let O=T,z=I;for(let q=c;q<p;q+=c){const K=u[q],Y=u[q+1];K<T&&(T=K),Y<I&&(I=Y),K>O&&(O=K),Y>z&&(z=Y)}M=Math.max(O-T,z-I),M=M!==0?32767/M:0}return g2(_,b,c,T,I,M,0),b}function U8(u,s,c,f,p){let _;if(p===function(b,T,I,M){let O=0;for(let z=T,q=I-M;z<I;z+=M)O+=(b[q]-b[z])*(b[z+1]+b[q+1]),q=z;return O}(u,s,c,f)>0)for(let b=s;b<c;b+=f)_=G8(b/f|0,u[b],u[b+1],_);else for(let b=c-f;b>=s;b-=f)_=G8(b/f|0,u[b],u[b+1],_);return _&&l1(_,_.next)&&(_2(_),_=_.next),_}function o_(u,s){if(!u)return u;s||(s=u);let c,f=u;do if(c=!1,f.steiner||!l1(f,f.next)&&Ho(f.prev,f,f.next)!==0)f=f.next;else{if(_2(f),f=s=f.prev,f===f.next)break;c=!0}while(c||f!==s);return s}function g2(u,s,c,f,p,_,b){if(!u)return;!b&&_&&function(I,M,O,z){let q=I;do q.z===0&&(q.z=RN(q.x,q.y,M,O,z)),q.prevZ=q.prev,q.nextZ=q.next,q=q.next;while(q!==I);q.prevZ.nextZ=null,q.prevZ=null,function(K){let Y,ae=1;do{let le,ce=K;K=null;let Se=null;for(Y=0;ce;){Y++;let Ae=ce,Ee=0;for(let Ke=0;Ke<ae&&(Ee++,Ae=Ae.nextZ,Ae);Ke++);let Ze=ae;for(;Ee>0||Ze>0&&Ae;)Ee!==0&&(Ze===0||!Ae||ce.z<=Ae.z)?(le=ce,ce=ce.nextZ,Ee--):(le=Ae,Ae=Ae.nextZ,Ze--),Se?Se.nextZ=le:K=le,le.prevZ=Se,Se=le;ce=Ae}Se.nextZ=null,ae*=2}while(Y>1)}(q)}(u,f,p,_);let T=u;for(;u.prev!==u.next;){const I=u.prev,M=u.next;if(_?Qfe(u,f,p,_):Jfe(u))s.push(I.i,u.i,M.i),_2(u),u=M.next,T=M.next;else if((u=M)===T){b?b===1?g2(u=epe(o_(u),s),s,c,f,p,_,2):b===2&&tpe(u,s,c,f,p,_):g2(o_(u),s,c,f,p,_,1);break}}}function Jfe(u){const s=u.prev,c=u,f=u.next;if(Ho(s,c,f)>=0)return!1;const p=s.x,_=c.x,b=f.x,T=s.y,I=c.y,M=f.y,O=Math.min(p,_,b),z=Math.min(T,I,M),q=Math.max(p,_,b),K=Math.max(T,I,M);let Y=f.next;for(;Y!==s;){if(Y.x>=O&&Y.x<=q&&Y.y>=z&&Y.y<=K&&y2(p,T,_,I,b,M,Y.x,Y.y)&&Ho(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function Qfe(u,s,c,f){const p=u.prev,_=u,b=u.next;if(Ho(p,_,b)>=0)return!1;const T=p.x,I=_.x,M=b.x,O=p.y,z=_.y,q=b.y,K=Math.min(T,I,M),Y=Math.min(O,z,q),ae=Math.max(T,I,M),le=Math.max(O,z,q),ce=RN(K,Y,s,c,f),Se=RN(ae,le,s,c,f);let Ae=u.prevZ,Ee=u.nextZ;for(;Ae&&Ae.z>=ce&&Ee&&Ee.z<=Se;){if(Ae.x>=K&&Ae.x<=ae&&Ae.y>=Y&&Ae.y<=le&&Ae!==p&&Ae!==b&&y2(T,O,I,z,M,q,Ae.x,Ae.y)&&Ho(Ae.prev,Ae,Ae.next)>=0||(Ae=Ae.prevZ,Ee.x>=K&&Ee.x<=ae&&Ee.y>=Y&&Ee.y<=le&&Ee!==p&&Ee!==b&&y2(T,O,I,z,M,q,Ee.x,Ee.y)&&Ho(Ee.prev,Ee,Ee.next)>=0))return!1;Ee=Ee.nextZ}for(;Ae&&Ae.z>=ce;){if(Ae.x>=K&&Ae.x<=ae&&Ae.y>=Y&&Ae.y<=le&&Ae!==p&&Ae!==b&&y2(T,O,I,z,M,q,Ae.x,Ae.y)&&Ho(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.prevZ}for(;Ee&&Ee.z<=Se;){if(Ee.x>=K&&Ee.x<=ae&&Ee.y>=Y&&Ee.y<=le&&Ee!==p&&Ee!==b&&y2(T,O,I,z,M,q,Ee.x,Ee.y)&&Ho(Ee.prev,Ee,Ee.next)>=0)return!1;Ee=Ee.nextZ}return!0}function epe(u,s){let c=u;do{const f=c.prev,p=c.next.next;!l1(f,p)&&$8(f,c,c.next,p)&&v2(f,p)&&v2(p,f)&&(s.push(f.i,c.i,p.i),_2(c),_2(c.next),c=u=p),c=c.next}while(c!==u);return o_(c)}function tpe(u,s,c,f,p,_){let b=u;do{let T=b.next.next;for(;T!==b.prev;){if(b.i!==T.i&&ape(b,T)){let I=q8(b,T);return b=o_(b,b.next),I=o_(I,I.next),g2(b,s,c,f,p,_,0),void g2(I,s,c,f,p,_,0)}T=T.next}b=b.next}while(b!==u)}function npe(u,s){let c=u.x-s.x;return c===0&&(c=u.y-s.y,c===0)&&(c=(u.next.y-u.y)/(u.next.x-u.x)-(s.next.y-s.y)/(s.next.x-s.x)),c}function rpe(u,s){const c=function(p,_){let b=_;const T=p.x,I=p.y;let M,O=-1/0;if(l1(p,b))return b;do{if(l1(p,b.next))return b.next;if(I<=b.y&&I>=b.next.y&&b.next.y!==b.y){const ae=b.x+(I-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(ae<=T&&ae>O&&(O=ae,M=b.x<b.next.x?b:b.next,ae===T))return M}b=b.next}while(b!==_);if(!M)return null;const z=M,q=M.x,K=M.y;let Y=1/0;b=M;do{if(T>=b.x&&b.x>=q&&T!==b.x&&V8(I<K?T:O,I,q,K,I<K?O:T,I,b.x,b.y)){const ae=Math.abs(I-b.y)/(T-b.x);v2(b,p)&&(ae<Y||ae===Y&&(b.x>M.x||b.x===M.x&&ipe(M,b)))&&(M=b,Y=ae)}b=b.next}while(b!==z);return M}(u,s);if(!c)return s;const f=q8(c,u);return o_(f,f.next),o_(c,c.next)}function ipe(u,s){return Ho(u.prev,u,s.prev)<0&&Ho(s.next,u,u.next)<0}function RN(u,s,c,f,p){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-c)*p|0)|u<<8))|u<<4))|u<<2))|u<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-f)*p|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function spe(u){let s=u,c=u;do(s.x<c.x||s.x===c.x&&s.y<c.y)&&(c=s),s=s.next;while(s!==u);return c}function V8(u,s,c,f,p,_,b,T){return(p-b)*(s-T)>=(u-b)*(_-T)&&(u-b)*(f-T)>=(c-b)*(s-T)&&(c-b)*(_-T)>=(p-b)*(f-T)}function y2(u,s,c,f,p,_,b,T){return!(u===b&&s===T)&&V8(u,s,c,f,p,_,b,T)}function ape(u,s){return u.next.i!==s.i&&u.prev.i!==s.i&&!function(c,f){let p=c;do{if(p.i!==c.i&&p.next.i!==c.i&&p.i!==f.i&&p.next.i!==f.i&&$8(p,p.next,c,f))return!0;p=p.next}while(p!==c);return!1}(u,s)&&(v2(u,s)&&v2(s,u)&&function(c,f){let p=c,_=!1;const b=(c.x+f.x)/2,T=(c.y+f.y)/2;do p.y>T!=p.next.y>T&&p.next.y!==p.y&&b<(p.next.x-p.x)*(T-p.y)/(p.next.y-p.y)+p.x&&(_=!_),p=p.next;while(p!==c);return _}(u,s)&&(Ho(u.prev,u,s.prev)||Ho(u,s.prev,s))||l1(u,s)&&Ho(u.prev,u,u.next)>0&&Ho(s.prev,s,s.next)>0)}function Ho(u,s,c){return(s.y-u.y)*(c.x-s.x)-(s.x-u.x)*(c.y-s.y)}function l1(u,s){return u.x===s.x&&u.y===s.y}function $8(u,s,c,f){const p=RT(Ho(u,s,c)),_=RT(Ho(u,s,f)),b=RT(Ho(c,f,u)),T=RT(Ho(c,f,s));return p!==_&&b!==T||!(p!==0||!DT(u,c,s))||!(_!==0||!DT(u,f,s))||!(b!==0||!DT(c,u,f))||!(T!==0||!DT(c,s,f))}function DT(u,s,c){return s.x<=Math.max(u.x,c.x)&&s.x>=Math.min(u.x,c.x)&&s.y<=Math.max(u.y,c.y)&&s.y>=Math.min(u.y,c.y)}function RT(u){return u>0?1:u<0?-1:0}function v2(u,s){return Ho(u.prev,u,u.next)<0?Ho(u,s,u.next)>=0&&Ho(u,u.prev,s)>=0:Ho(u,s,u.prev)<0||Ho(u,u.next,s)<0}function q8(u,s){const c=jN(u.i,u.x,u.y),f=jN(s.i,s.x,s.y),p=u.next,_=s.prev;return u.next=s,s.prev=u,c.next=p,p.prev=c,f.next=c,c.prev=f,_.next=f,f.prev=_,f}function G8(u,s,c,f){const p=jN(u,s,c);return f?(p.next=f.next,p.prev=f,f.next.prev=p,f.next=p):(p.prev=p,p.next=p),p}function _2(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function jN(u,s,c){return{i:u,x:s,y:c,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function x2(u,s){const c=u.length;if(c<=1)return[u];const f=[];let p,_;for(let b=0;b<c;b++){const T=ha(u[b]);T!==0&&(u[b].area=Math.abs(T),_===void 0&&(_=T<0),_===T<0?(p&&f.push(p),p=[u[b]]):p.push(u[b]))}if(p&&f.push(p),s>1)for(let b=0;b<f.length;b++)f[b].length<=s||(Ou(f[b],s,1,f[b].length-1,ope),f[b]=f[b].slice(0,s));return f}function ope(u,s){return s.area-u.area}function H8(u,s,c=1){if(!u)return null;const f=typeof u=="string"?fo.from(u).getPrimary():u.getPrimary(),p=typeof u=="string"?null:u.getSecondary();for(const _ of[f,p]){if(!_)continue;const b=_.id.toString();s.has(b)||s.set(b,[]),_.scaleSelf(c),s.get(b).push(_)}return{primary:f.toString(),secondary:p?p.toString():null}}function ON(u,s,c,f){const p=f.patternDependencies;let _=!1;for(const b of s){const T=b.paint.get(`${u}-pattern`);T.isConstant()||(_=!0),H8(T.constantOr(null),p,c)&&(_=!0)}return _}function FN(u,s,c,f,p,_){const b=_.patternDependencies;for(const T of s){const I=T.paint.get(`${u}-pattern`).value;if(I.kind!=="constant"){let M=I.evaluate({zoom:f},c,{},_.availableImages);M=M&&M.name?M.name:M;const O=H8(M,b,p);if(!O)continue;const{primary:z,secondary:q}=O;z&&(c.patterns[T.id]=[z,q].filter(Boolean))}}return c}class W8{constructor(){this.polygons=new Map}add(s,...c){const f=this.polygons.get(s);f?f.push(...c):this.polygons.set(s,c)}merge(s){for(const[c,f]of s.polygons)this.add(c,...f)}}class Ag{constructor(){this.portals=[]}static isOnBorder(s,c){return s<=0&&c<=0||s>=yn&&c>=yn}static evaluate(s){if(s.length===0)return new Ag;let c=[];for(const I of s)c.push(...I.portals);if(c.length===0)return new Ag;for(const I of c){const M=I.va,O=I.vb;(Ag.isOnBorder(M.x,O.x)||Ag.isOnBorder(M.y,O.y))&&(I.type="border")}const f=c.filter(I=>I.type!=="unevaluated"),p=c.filter(I=>I.type==="unevaluated");if(p.length===0)return new Ag;p.sort((I,M)=>I.hash===M.hash?I.isTunnel===M.isTunnel?0:I.isTunnel?-1:1:I.hash<M.hash?1:-1),c=f.concat(p);let _=f.length,b=_,T=_;do if(b++,b===c.length||c[_].hash!==c[b].hash){if(b-_==2){T<_&&(c[T]=c[_],c[_]=null);const I=c[T],M=c[b-1];I.type=I.isTunnel!==M.isTunnel?"tunnel":"polygon",I.connection={a:I.connection.a,b:M.connection.a},T++}_=b}while(_!==c.length);return c.splice(T),c.sort((I,M)=>I.hash<M.hash?1:-1),{portals:c}}}Pn(Ag,"ElevationPortalGraph"),Pn(W8,"ElevationPolygons");class lpe{constructor(s,c,f){this.outPositions=s,this.outNormals=c,this.outIndices=f,this.vertexLookup=new Map}addVertex(s,c,f){let p=s[2];f!=null&&(p*=f);const _=`${s[0]},${s[1]},${s[2]},${c[0]},${c[1]},${c[2]}`,b=this.vertexLookup.get(_);if(b!=null)return b;const T=this.outPositions.length;this.vertexLookup.set(_,T);const I=Math.trunc(16384*c[0]),M=Math.trunc(16384*c[1]),O=Math.trunc(16384*c[2]);return this.outPositions.emplaceBack(s[0],s[1],p),this.outNormals.emplaceBack(I,M,O),T}addTriangle(s,c,f){this.outIndices.emplaceBack(s,c,f)}addTriangles(s,c,f){if(s.length===0)return;const p=f.length===1,_=fe(),b=fe();for(let T=0;T<s.length;T+=3){const I=c[s[T+0]],M=c[s[T+1]],O=c[s[T+2]],z=p?f[0]:f[s[T+1]],q=p?f[0]:f[s[T+2]];Re(_,I.x,I.y,p?f[0]:f[s[T+0]]);const K=this.addVertex(_,b);Re(_,M.x,M.y,z);const Y=this.addVertex(_,b);Re(_,O.x,O.y,q);const ae=this.addVertex(_,b);this.outIndices.emplaceBack(K,Y,ae)}}addQuad(s,c,f,p,_,b){const T=this.addVertex(s,_,b),I=this.addVertex(c,_,b),M=this.addVertex(f,_,b),O=this.addVertex(p,_,b);this.addTriangle(T,I,M),this.addTriangle(M,O,T)}getVertexCount(){return this.outPositions.length}clearVertexLookup(){this.vertexLookup.clear()}}class $u{constructor(s,c,f,p){this.unevaluatedPortals=new Ag,this.portalPolygons=new W8,this.bridgeFeatureSections=[],this.tunnelFeatureSections=[],this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new t2,this.vertexNormals=new Zx,this.indexArray=new vo,this.tileToMeters=bt(s),this.bridgeProgramConfigurations=new oh(c,{zoom:f,lut:p},_=>_!=="fill-tunnel-structure-color"),this.tunnelProgramConfigurations=new oh(c,{zoom:f,lut:p},_=>_!=="fill-bridge-guard-rail-color")}addVertices(s,c){const f=this.unevalVertices.length;for(let p=0;p<s.length;p++)this.unevalVertices.push(s[p]),this.unevalHeights.push(c[p]);return f}addTriangles(s,c,f){const p=f?this.unevalTunnelTriangles:this.unevalTriangles;for(const _ of s)p.push(_+c)}addRenderableRing(s,c,f,p,_,b){const T=[new zt(_.min.x,_.min.y),new zt(_.max.x,_.min.y),new zt(_.max.x,_.max.y),new zt(_.min.x,_.max.y)];for(let I=0;I<f-1;I++){const M=c+I,O=M+1,z=this.unevalVertices[M],q=this.unevalVertices[O];if(!(z.x>=_.min.x&&z.x<=_.max.x&&z.y>=_.min.y&&z.y<=_.max.y||q.x>=_.min.x&&q.x<=_.max.x&&q.y>=_.min.y&&q.y<=_.max.y||Ml(z,q,T))||this.isOnBorder(z.x,q.x)||this.isOnBorder(z.y,q.y))continue;const K=$u.computeEdgeHash(this.unevalVertices[M],this.unevalVertices[O]);let Y,ae=this.vertexHashLookup.get($u.computePosHash(z));ae!=null?Y=ae.next:(ae=this.vertexHashLookup.get($u.computePosHash(q)),Y=ae!=null?ae.prev:K),this.unevalEdges.push({polygonIdx:s,a:M,b:O,hash:K,portalHash:Y,isTunnel:p,type:"unevaluated",featureInfo:b})}}addPortalCandidates(s,c,f,p,_){if(c.length===0)return;this.portalPolygons.add(s,{geometry:c,zLevel:_});const b=c[0];this.vertexHashLookup.clear();let T=$u.computeEdgeHash(b[b.length-2],b[b.length-1]);for(let I=0;I<b.length-1;I++){const M=b[I+0],O=b[I+1],z=Hi(O.x-M.x,O.y-M.y),q=bn(z);if(q===0)continue;let K="unevaluated";const Y=p.pointElevation(M),ae=p.pointElevation(O);Math.abs(Y)<.01&&Math.abs(ae)<.01?K="entrance":(this.isOnBorder(M.x,O.x)||this.isOnBorder(M.y,O.y))&&(K="border");const le=$u.computeEdgeHash(M,O);this.unevaluatedPortals.portals.push({connection:{a:s,b:void 0},va:M,vb:O,vab:z,length:q,hash:le,isTunnel:f,type:K});const ce=$u.computePosHash(M);this.vertexHashLookup.set(ce,{prev:T,next:le}),T=le}}construct(s){if(this.unevalVertices.length===0)return;const c=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),f=q=>{q.primitiveLength=this.indexArray.length-q.primitiveOffset},p=new lpe(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(s.portals,this.unevalEdges);const _=c(),b=c(),T=c(),I=(q,K)=>{q.sort((ae,le)=>ae.type===K&&le.type!==K?-1:ae.type!==K&&le.type===K?1:0);const Y=q.findIndex(ae=>ae.type!==K);return Y>=0?Y:q.length};let M=0;this.unevalEdges.length>0&&(M=I(this.unevalEdges,"none"),this.constructBridgeStructures(p,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:M},this.tileToMeters)),f(T);const O=c(),z=c();if(this.unevalEdges.length>0){const q=this.unevalEdges.splice(M),K=I(q,"tunnel")+M;this.unevalEdges.push(...q),this.constructTunnelStructures(p,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:M},{min:M,max:K})}f(O),p.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),f(z),p.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),f(b),p.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),f(_),this.maskSegments=Qs.simpleSegment(0,z.primitiveOffset,0,z.primitiveLength),this.depthSegments=Qs.simpleSegment(0,b.primitiveOffset,0,b.primitiveLength),this.renderableBridgeSegments=Qs.simpleSegment(0,T.primitiveOffset,0,T.primitiveLength),this.renderableTunnelSegments=Qs.simpleSegment(0,O.primitiveOffset,0,O.primitiveLength),this.shadowCasterSegments=Qs.simpleSegment(0,_.primitiveOffset,0,_.primitiveLength)}update(s,c,f,p,_,b,T,I){this.bridgeProgramConfigurations.updatePaintArrays(s,c,_,f,p,b,T,I),this.tunnelProgramConfigurations.updatePaintArrays(s,c,_,f,p,b,T,I)}upload(s){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=s.createVertexBuffer(this.vertexPositions,Yfe.members),this.vertexBufferNormal=s.createVertexBuffer(this.vertexNormals,Xfe.members),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.bridgeProgramConfigurations.upload(s),this.tunnelProgramConfigurations.upload(s))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableBridgeSegments.destroy(),this.renderableTunnelSegments.destroy(),this.shadowCasterSegments.destroy()),this.bridgeProgramConfigurations.destroy(),this.tunnelProgramConfigurations.destroy()}populatePaintArrays(s,c,f,p,_){const b=(T,I)=>{for(let M=0;M<I.length-1;M++){const O=I[M].featureIndex,z=I[M+1].vertexStart,q=s.feature(O);T.populatePaintArrays(z,q,O,{},f,c,p,void 0,_)}};b(this.bridgeProgramConfigurations,this.bridgeFeatureSections),b(this.tunnelProgramConfigurations,this.tunnelFeatureSections)}computeVertexConnections(s,c,f,p,_){const b=new Map;for(let T=p;T<_;T++){const I=f[T],M=I.a,O=I.b,z=$u.computePosHash(s[M]),q=$u.computePosHash(s[O]);let K=b.get(z);K||(K={},b.set(z,K));let Y=b.get(q);Y||(Y={},b.set(q,Y)),c[M]<=0&&c[O]<=0||(K.to=O,Y.from=M)}return b}isTerminalVertex(s,c){const f=$u.computePosHash(this.unevalVertices[s]),p=c.get(f);return!p||!p.from||!p.to}constructBridgeStructures(s,c,f,p,_,b){s.clearVertexLookup();const T=this.computeVertexConnections(c,f,p,_.min,_.max),I=1/b,M=.5*I,O=(en,hn)=>Re(en,c[hn].x,c[hn].y,f[hn]*I),z=fe(),q=fe(),K=fe(),Y=fe(),ae=fe(),le=(en,hn)=>{const Vt=T.get($u.computePosHash(c[hn])),nn=Vt.from,Lt=Vt.to;if(!nn||!Lt)return;O(z,nn),O(q,hn),O(K,Lt),Un(Y),Kt(z,q)||(st(ae,q,z),gt(Y,ae)),Kt(K,q)||(st(ae,K,q),Qe(Y,Y,gt(ae,ae)));const It=Or(Y);return It>0?xt(en,Y,1/It):void 0};let ce=Number.POSITIVE_INFINITY;this.sortSubarray(p,_.min,_.max,(en,hn)=>en.featureInfo.featureIndex-hn.featureInfo.featureIndex);const Se=fe(),Ae=fe(),Ee=fe(),Ze=fe(),Ke=fe(),tt=fe(),at=fe(),ct=fe(),qt=fe(),_t=[fe(),fe(),fe(),fe()],Xt=[fe(),fe(),fe(),fe()],an=[{coord:new zt(0,0),height:0},{coord:new zt(0,0),height:0}],Jt=(en,hn)=>en>hn;for(let en=_.min;en<_.max;en++){const hn=p[en];if(!hn.featureInfo.guardRailEnabled||!this.prepareEdgePoints(an,c,f,hn,Jt))continue;const[Vt,nn]=an;if(Re(Se,Vt.coord.x,Vt.coord.y,I*Vt.height),Re(Ae,nn.coord.x,nn.coord.y,I*nn.height),Kt(Se,Ae))continue;st(Ee,Ae,Se),gt(Ee,Ee);const Lt=le(ct,hn.a)||Ee,It=le(qt,hn.b)||Ee;Re(Ze,Lt[1],-Lt[0],0),gt(Ze,Ze),Re(Ke,It[1],-It[0],0),gt(Ke,Ke),At(ct,Ze,Lt),gt(tt,ct),At(ct,Ke,It),gt(at,ct),Qe(_t[0],Se,xt(ct,st(ct,Ze,tt),M)),Qe(_t[1],Se,xt(ct,Qe(ct,Ze,tt),M)),Qe(_t[2],Se,xt(ct,tt,M)),_t[3]=Se,Qe(Xt[0],Ae,xt(ct,st(ct,Ke,at),M)),Qe(Xt[1],Ae,xt(ct,Qe(ct,Ke,at),M)),Qe(Xt[2],Ae,xt(ct,at,M)),Xt[3]=Ae,ce=this.addFeatureSection(hn.featureInfo.featureIndex,ce,this.bridgeFeatureSections,s);const fn=s.addVertex(_t[0],Ze,b),cn=s.addVertex(_t[1],Ze,b),tr=s.addVertex(Xt[0],Ke,b),Fn=s.addVertex(Xt[1],Ke,b);s.addTriangle(fn,cn,tr),s.addTriangle(cn,Fn,tr);const qn=s.addVertex(_t[1],tt,b),vn=s.addVertex(_t[2],tt,b),er=s.addVertex(Xt[1],at,b),Ir=s.addVertex(Xt[2],at,b);s.addTriangle(qn,vn,er),s.addTriangle(vn,Ir,er),vt(Ze,Ze),vt(Ke,Ke);const En=s.addVertex(_t[2],Ze,b),Yn=s.addVertex(_t[3],Ze,b),pr=s.addVertex(Xt[2],Ke,b),Lr=s.addVertex(Xt[3],Ke,b);s.addTriangle(En,Yn,pr),s.addTriangle(Yn,Lr,pr);const ii=this.isTerminalVertex(hn.a,T),zr=this.isTerminalVertex(hn.b,T);Vt.height<.01&&ii&&s.addQuad(_t[3],_t[2],_t[1],_t[0],vt(Lt,Lt),b),nn.height<.01&&zr&&s.addQuad(Xt[0],Xt[1],Xt[2],Xt[3],It,b)}this.bridgeFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:s.getVertexCount()})}constructTunnelStructures(s,c,f,p,_,b){s.clearVertexLookup();let T=Number.POSITIVE_INFINITY;const I=(ce,Se)=>ce.featureInfo.featureIndex-Se.featureInfo.featureIndex;this.sortSubarray(p,_.min,_.max,I),this.sortSubarray(p,b.min,b.max,I);const M=ce=>gt(ce,ce),O=[{coord:new zt(0,0),height:0},{coord:new zt(0,0),height:0}],z=(ce,Se)=>ce<Se,q=fe(),K=fe(),Y=fe(),ae=fe(),le=fe();for(let ce=_.min;ce<_.max;ce++){if(!this.prepareEdgePoints(O,c,f,p[ce],z))continue;const[Se,Ae]=O,Ee=M(Re(le,-(Ae.coord.y-Se.coord.y),Ae.coord.x-Se.coord.x,0));T=this.addFeatureSection(p[ce].featureInfo.featureIndex,T,this.tunnelFeatureSections,s),s.addQuad(Re(q,Se.coord.x,Se.coord.y,Se.height),Re(K,Ae.coord.x,Ae.coord.y,Ae.height),Re(Y,Ae.coord.x,Ae.coord.y,p[ce].isTunnel?-.1:0),Re(ae,Se.coord.x,Se.coord.y,p[ce].isTunnel?-.1:0),Ee)}for(let ce=b.min;ce<b.max;ce++){const Se=p[ce];Se.isTunnel&&([Se.a,Se.b]=[Se.b,Se.a]);const Ae=c[Se.a],Ee=c[Se.b],Ze=M(Re(le,-(Ee.y-Ae.y),Ee.x-Ae.x,0));T=this.addFeatureSection(Se.featureInfo.featureIndex,T,this.tunnelFeatureSections,s),s.addQuad(Re(q,Ee.x,Ee.y,0),Re(K,Ae.x,Ae.y,0),Re(Y,Ae.x,Ae.y,f[Se.a]+4),Re(ae,Ee.x,Ee.y,f[Se.b]+4),Ze),s.addQuad(Re(q,Ae.x,Ae.y,0),Re(K,Ee.x,Ee.y,0),Re(Y,Ee.x,Ee.y,f[Se.b]+4),Re(ae,Ae.x,Ae.y,f[Se.a]+4),Ze)}this.tunnelFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:s.getVertexCount()})}setElevatedPoint(s,c,f,p){s.coord.x=c,s.coord.y=f,s.height=p}prepareEdgePoints(s,c,f,p,_){let b=c[p.a].x,T=c[p.a].y,I=c[p.b].x,M=c[p.b].y,O=f[p.a],z=f[p.b];const q=_(O,0),K=_(z,0);if(q&&K)return this.setElevatedPoint(s[0],b,T,O),this.setElevatedPoint(s[1],I,M,z),!0;if(!q&&!K)return!1;if(q){if(!K){const Y=z/(z-O);I=qe(I,b,Y),M=qe(M,T,Y),z=qe(z,O,Y)}}else{const Y=O/(O-z);b=qe(b,I,Y),T=qe(T,M,Y),O=qe(O,z,Y)}return this.setElevatedPoint(s[0],b,T,O),this.setElevatedPoint(s[1],I,M,z),!0}prepareEdges(s,c){if(c.length===0)return;c.sort((T,I)=>T.hash===I.hash?I.polygonIdx-T.polygonIdx:I.hash>T.hash?1:-1);let f=0,p=0,_=0,b=c[f].polygonIdx;do p++,(p===c.length||c[f].hash!==c[p].hash)&&((p-f==1||c[p-1].polygonIdx!==b)&&(_<f&&(c[_]=c[f],c[f]=null),c[_].type="none",_++),f=p,f!==c.length&&(b=c[f].polygonIdx));while(f!==c.length);if(c.splice(_),c.length!==0&&s.length!==0){c.sort((M,O)=>M.portalHash<O.portalHash?1:-1);let T=0,I=0;for(;T!==c.length&&I!==s.length;){const M=c[T],O=s[I];M.portalHash>O.hash?T++:O.hash>M.portalHash?I++:(M.type=O.type,T++)}}}isOnBorder(s,c){return s<=0&&c<=0||s>=yn&&c>=yn}addFeatureSection(s,c,f,p){return s!==c&&(c=s,f.push({featureIndex:s,vertexStart:p.getVertexCount()}),p.clearVertexLookup()),c}sortSubarray(s,c,f,p){const _=s.slice(c,f);_.sort(p),s.splice(c,_.length,..._)}static computeEdgeHash(s,c){return(s.y===c.y&&s.x>c.x||s.y>c.y)&&([s,c]=[c,s]),BigInt($u.computePosHash(s))<<32n|BigInt($u.computePosHash(c))}static computePosHash(s){return((65535&s.x)<<16|65535&s.y)>>>0}}var Z8,K8={exports:{}},Y8=(Z8||(Z8=1,function(u,s){(function(c){function f(Me,Le){return Me>Le?1:Me<Le?-1:0}var p=function(Me,Le){Me===void 0&&(Me=f),Le===void 0&&(Le=!1),this._compare=Me,this._root=null,this._size=0,this._noDuplicates=!!Le},_={size:{configurable:!0}};function b(Me,Le,Mt,$t,Tn){var An=Tn-$t;if(An>0){var zn=$t+Math.floor(An/2),or={key:Le[zn],data:Mt[zn],parent:Me};return or.left=b(or,Le,Mt,$t,zn),or.right=b(or,Le,Mt,zn+1,Tn),or}return null}function T(Me,Le,Mt,$t,Tn){if(!(Mt>=$t)){for(var An=Me[Mt+$t>>1],zn=Mt-1,or=$t+1;;){do zn++;while(Tn(Me[zn],An)<0);do or--;while(Tn(Me[or],An)>0);if(zn>=or)break;var si=Me[zn];Me[zn]=Me[or],Me[or]=si,si=Le[zn],Le[zn]=Le[or],Le[or]=si}T(Me,Le,Mt,or,Tn),T(Me,Le,or+1,$t,Tn)}}p.prototype.rotateLeft=function(Me){var Le=Me.right;Le&&(Me.right=Le.left,Le.left&&(Le.left.parent=Me),Le.parent=Me.parent),Me.parent?Me===Me.parent.left?Me.parent.left=Le:Me.parent.right=Le:this._root=Le,Le&&(Le.left=Me),Me.parent=Le},p.prototype.rotateRight=function(Me){var Le=Me.left;Le&&(Me.left=Le.right,Le.right&&(Le.right.parent=Me),Le.parent=Me.parent),Me.parent?Me===Me.parent.left?Me.parent.left=Le:Me.parent.right=Le:this._root=Le,Le&&(Le.right=Me),Me.parent=Le},p.prototype._splay=function(Me){for(;Me.parent;){var Le=Me.parent;Le.parent?Le.left===Me&&Le.parent.left===Le?(this.rotateRight(Le.parent),this.rotateRight(Le)):Le.right===Me&&Le.parent.right===Le?(this.rotateLeft(Le.parent),this.rotateLeft(Le)):Le.left===Me&&Le.parent.right===Le?(this.rotateRight(Le),this.rotateLeft(Le)):(this.rotateLeft(Le),this.rotateRight(Le)):Le.left===Me?this.rotateRight(Le):this.rotateLeft(Le)}},p.prototype.splay=function(Me){for(var Le,Mt,$t,Tn,An;Me.parent;)(Mt=(Le=Me.parent).parent)&&Mt.parent?(($t=Mt.parent).left===Mt?$t.left=Me:$t.right=Me,Me.parent=$t):(Me.parent=null,this._root=Me),Tn=Me.left,An=Me.right,Me===Le.left?(Mt&&(Mt.left===Le?(Le.right?(Mt.left=Le.right,Mt.left.parent=Mt):Mt.left=null,Le.right=Mt,Mt.parent=Le):(Tn?(Mt.right=Tn,Tn.parent=Mt):Mt.right=null,Me.left=Mt,Mt.parent=Me)),An?(Le.left=An,An.parent=Le):Le.left=null,Me.right=Le,Le.parent=Me):(Mt&&(Mt.right===Le?(Le.left?(Mt.right=Le.left,Mt.right.parent=Mt):Mt.right=null,Le.left=Mt,Mt.parent=Le):(An?(Mt.left=An,An.parent=Mt):Mt.left=null,Me.right=Mt,Mt.parent=Me)),Tn?(Le.right=Tn,Tn.parent=Le):Le.right=null,Me.left=Le,Le.parent=Me)},p.prototype.replace=function(Me,Le){Me.parent?Me===Me.parent.left?Me.parent.left=Le:Me.parent.right=Le:this._root=Le,Le&&(Le.parent=Me.parent)},p.prototype.minNode=function(Me){if(Me===void 0&&(Me=this._root),Me)for(;Me.left;)Me=Me.left;return Me},p.prototype.maxNode=function(Me){if(Me===void 0&&(Me=this._root),Me)for(;Me.right;)Me=Me.right;return Me},p.prototype.insert=function(Me,Le){var Mt=this._root,$t=null,Tn=this._compare;if(this._noDuplicates)for(;Mt;){if($t=Mt,Tn(Mt.key,Me)===0)return;Mt=Tn(Mt.key,Me)<0?Mt.right:Mt.left}else for(;Mt;)$t=Mt,Mt=Tn(Mt.key,Me)<0?Mt.right:Mt.left;return Mt={key:Me,data:Le,left:null,right:null,parent:$t},$t?Tn($t.key,Mt.key)<0?$t.right=Mt:$t.left=Mt:this._root=Mt,this.splay(Mt),this._size++,Mt},p.prototype.find=function(Me){for(var Le=this._root,Mt=this._compare;Le;){var $t=Mt(Le.key,Me);if($t<0)Le=Le.right;else{if(!($t>0))return Le;Le=Le.left}}return null},p.prototype.contains=function(Me){for(var Le=this._root,Mt=this._compare;Le;){var $t=Mt(Me,Le.key);if($t===0)return!0;Le=$t<0?Le.left:Le.right}return!1},p.prototype.remove=function(Me){var Le=this.find(Me);if(!Le)return!1;if(this.splay(Le),Le.left)if(Le.right){var Mt=this.minNode(Le.right);Mt.parent!==Le&&(this.replace(Mt,Mt.right),Mt.right=Le.right,Mt.right.parent=Mt),this.replace(Le,Mt),Mt.left=Le.left,Mt.left.parent=Mt}else this.replace(Le,Le.left);else this.replace(Le,Le.right);return this._size--,!0},p.prototype.removeNode=function(Me){if(!Me)return!1;if(this.splay(Me),Me.left)if(Me.right){var Le=this.minNode(Me.right);Le.parent!==Me&&(this.replace(Le,Le.right),Le.right=Me.right,Le.right.parent=Le),this.replace(Me,Le),Le.left=Me.left,Le.left.parent=Le}else this.replace(Me,Me.left);else this.replace(Me,Me.right);return this._size--,!0},p.prototype.erase=function(Me){var Le=this.find(Me);if(Le){this.splay(Le);var Mt=Le.left,$t=Le.right,Tn=null;Mt&&(Mt.parent=null,Tn=this.maxNode(Mt),this.splay(Tn),this._root=Tn),$t&&(Mt?Tn.right=$t:this._root=$t,$t.parent=Tn),this._size--}},p.prototype.pop=function(){var Me=this._root,Le=null;if(Me){for(;Me.left;)Me=Me.left;Le={key:Me.key,data:Me.data},this.remove(Me.key)}return Le},p.prototype.next=function(Me){var Le=Me;if(Le)if(Le.right)for(Le=Le.right;Le&&Le.left;)Le=Le.left;else for(Le=Me.parent;Le&&Le.right===Me;)Me=Le,Le=Le.parent;return Le},p.prototype.prev=function(Me){var Le=Me;if(Le)if(Le.left)for(Le=Le.left;Le&&Le.right;)Le=Le.right;else for(Le=Me.parent;Le&&Le.left===Me;)Me=Le,Le=Le.parent;return Le},p.prototype.forEach=function(Me){for(var Le=this._root,Mt=[],$t=!1,Tn=0;!$t;)Le?(Mt.push(Le),Le=Le.left):Mt.length>0?(Me(Le=Mt.pop(),Tn++),Le=Le.right):$t=!0;return this},p.prototype.range=function(Me,Le,Mt,$t){for(var Tn=[],An=this._compare,zn=this._root;Tn.length!==0||zn;)if(zn)Tn.push(zn),zn=zn.left;else{if(An((zn=Tn.pop()).key,Le)>0)break;if(An(zn.key,Me)>=0&&Mt.call($t,zn))return this;zn=zn.right}return this},p.prototype.keys=function(){for(var Me=this._root,Le=[],Mt=[],$t=!1;!$t;)Me?(Le.push(Me),Me=Me.left):Le.length>0?(Me=Le.pop(),Mt.push(Me.key),Me=Me.right):$t=!0;return Mt},p.prototype.values=function(){for(var Me=this._root,Le=[],Mt=[],$t=!1;!$t;)Me?(Le.push(Me),Me=Me.left):Le.length>0?(Me=Le.pop(),Mt.push(Me.data),Me=Me.right):$t=!0;return Mt},p.prototype.at=function(Me){for(var Le=this._root,Mt=[],$t=!1,Tn=0;!$t;)if(Le)Mt.push(Le),Le=Le.left;else if(Mt.length>0){if(Le=Mt.pop(),Tn===Me)return Le;Tn++,Le=Le.right}else $t=!0;return null},p.prototype.load=function(Me,Le,Mt){if(Me===void 0&&(Me=[]),Le===void 0&&(Le=[]),Mt===void 0&&(Mt=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var $t=Me.length;return Mt&&T(Me,Le,0,$t-1,this._compare),this._root=b(null,Me,Le,0,$t),this._size=$t,this},p.prototype.min=function(){var Me=this.minNode(this._root);return Me?Me.key:null},p.prototype.max=function(){var Me=this.maxNode(this._root);return Me?Me.key:null},p.prototype.isEmpty=function(){return this._root===null},_.size.get=function(){return this._size},p.createTree=function(Me,Le,Mt,$t,Tn){return new p(Mt,Tn).load(Me,Le,$t)},Object.defineProperties(p.prototype,_);var I=0,M=1,O=2,z=3,q=0,K=1,Y=2,ae=3;function le(Me,Le,Mt){Le===null?(Me.inOut=!1,Me.otherInOut=!0):(Me.isSubject===Le.isSubject?(Me.inOut=!Le.inOut,Me.otherInOut=Le.otherInOut):(Me.inOut=!Le.otherInOut,Me.otherInOut=Le.isVertical()?!Le.inOut:Le.inOut),Le&&(Me.prevInResult=!ce(Le,Mt)||Le.isVertical()?Le.prevInResult:Le));var $t=ce(Me,Mt);Me.resultTransition=$t?function(Tn,An){var zn,or=!Tn.inOut,si=!Tn.otherInOut;switch(An){case q:zn=or&&si;break;case K:zn=or||si;break;case ae:zn=or^si;break;case Y:zn=Tn.isSubject?or&&!si:si&&!or}return zn?1:-1}(Me,Mt):0}function ce(Me,Le){switch(Me.type){case I:switch(Le){case q:return!Me.otherInOut;case K:return Me.otherInOut;case Y:return Me.isSubject&&Me.otherInOut||!Me.isSubject&&!Me.otherInOut;case ae:return!0}break;case O:return Le===q||Le===K;case z:return Le===Y;case M:return!1}return!1}var Se=function(Me,Le,Mt,$t,Tn){this.left=Le,this.point=Me,this.otherEvent=Mt,this.isSubject=$t,this.type=Tn||I,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},Ae={inResult:{configurable:!0}};function Ee(Me,Le){return Me[0]===Le[0]&&Me[1]===Le[1]}Se.prototype.isBelow=function(Me){var Le=this.point,Mt=this.otherEvent.point;return this.left?(Le[0]-Me[0])*(Mt[1]-Me[1])-(Mt[0]-Me[0])*(Le[1]-Me[1])>0:(Mt[0]-Me[0])*(Le[1]-Me[1])-(Le[0]-Me[0])*(Mt[1]-Me[1])>0},Se.prototype.isAbove=function(Me){return!this.isBelow(Me)},Se.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},Ae.inResult.get=function(){return this.resultTransition!==0},Se.prototype.clone=function(){var Me=new Se(this.point,this.left,this.otherEvent,this.isSubject,this.type);return Me.contourId=this.contourId,Me.resultTransition=this.resultTransition,Me.prevInResult=this.prevInResult,Me.isExteriorRing=this.isExteriorRing,Me.inOut=this.inOut,Me.otherInOut=this.otherInOut,Me},Object.defineProperties(Se.prototype,Ae);var Ze=11102230246251565e-32,Ke=134217729,tt=(3+8*Ze)*Ze;function at(Me,Le,Mt,$t,Tn){var An,zn,or,si,oi=Le[0],Jr=$t[0],Xi=0,qs=0;Jr>oi==Jr>-oi?(An=oi,oi=Le[++Xi]):(An=Jr,Jr=$t[++qs]);var Kr=0;if(Xi<Me&&qs<Mt)for(Jr>oi==Jr>-oi?(or=An-((zn=oi+An)-oi),oi=Le[++Xi]):(or=An-((zn=Jr+An)-Jr),Jr=$t[++qs]),An=zn,or!==0&&(Tn[Kr++]=or);Xi<Me&&qs<Mt;)Jr>oi==Jr>-oi?(or=An-((zn=An+oi)-(si=zn-An))+(oi-si),oi=Le[++Xi]):(or=An-((zn=An+Jr)-(si=zn-An))+(Jr-si),Jr=$t[++qs]),An=zn,or!==0&&(Tn[Kr++]=or);for(;Xi<Me;)or=An-((zn=An+oi)-(si=zn-An))+(oi-si),oi=Le[++Xi],An=zn,or!==0&&(Tn[Kr++]=or);for(;qs<Mt;)or=An-((zn=An+Jr)-(si=zn-An))+(Jr-si),Jr=$t[++qs],An=zn,or!==0&&(Tn[Kr++]=or);return An===0&&Kr!==0||(Tn[Kr++]=An),Kr}function ct(Me){return new Float64Array(Me)}var qt=33306690738754716e-32,_t=22204460492503146e-32,Xt=11093356479670487e-47,an=ct(4),Jt=ct(8),en=ct(12),hn=ct(16),Vt=ct(4);function nn(Me,Le,Mt){var $t=function(Tn,An,zn,or,si,oi){var Jr=(An-oi)*(zn-si),Xi=(Tn-si)*(or-oi),qs=Jr-Xi;if(Jr===0||Xi===0||Jr>0!=Xi>0)return qs;var Kr=Math.abs(Jr+Xi);return Math.abs(qs)>=qt*Kr?qs:-function(Ss,ns,Oi,Es,Ps,gs,As){var rs,li,os,ea,yr,Ni,ks,ca,js,oo,fs,Wa,hu,Dl,ml,fu,fm,lo,Do=Ss-Ps,Rl=Oi-Ps,bc=ns-gs,Kl=Es-gs;an[0]=(ml=(ca=Do-(ks=(Ni=Ke*Do)-(Ni-Do)))*(oo=Kl-(js=(Ni=Ke*Kl)-(Ni-Kl)))-((Dl=Do*Kl)-ks*js-ca*js-ks*oo))-((fs=ml-(fm=(ca=bc-(ks=(Ni=Ke*bc)-(Ni-bc)))*(oo=Rl-(js=(Ni=Ke*Rl)-(Ni-Rl)))-((fu=bc*Rl)-ks*js-ca*js-ks*oo)))+(yr=ml-fs))+(yr-fm),an[1]=(hu=Dl-((Wa=Dl+fs)-(yr=Wa-Dl))+(fs-yr))-((fs=hu-fu)+(yr=hu-fs))+(yr-fu),an[2]=Wa-((lo=Wa+fs)-(yr=lo-Wa))+(fs-yr),an[3]=lo;var l0=function(kXe,u$){for(var d$=u$[0],qM=1;qM<4;qM++)d$+=u$[qM];return d$}(0,an),X2=_t*As;if(l0>=X2||-l0>=X2||(rs=Ss-(Do+(yr=Ss-Do))+(yr-Ps),os=Oi-(Rl+(yr=Oi-Rl))+(yr-Ps),li=ns-(bc+(yr=ns-bc))+(yr-gs),ea=Es-(Kl+(yr=Es-Kl))+(yr-gs),rs===0&&li===0&&os===0&&ea===0)||(X2=Xt*As+tt*Math.abs(l0),(l0+=Do*ea+Kl*rs-(bc*os+Rl*li))>=X2||-l0>=X2))return l0;Vt[0]=(ml=(ca=rs-(ks=(Ni=Ke*rs)-(Ni-rs)))*(oo=Kl-(js=(Ni=Ke*Kl)-(Ni-Kl)))-((Dl=rs*Kl)-ks*js-ca*js-ks*oo))-((fs=ml-(fm=(ca=li-(ks=(Ni=Ke*li)-(Ni-li)))*(oo=Rl-(js=(Ni=Ke*Rl)-(Ni-Rl)))-((fu=li*Rl)-ks*js-ca*js-ks*oo)))+(yr=ml-fs))+(yr-fm),Vt[1]=(hu=Dl-((Wa=Dl+fs)-(yr=Wa-Dl))+(fs-yr))-((fs=hu-fu)+(yr=hu-fs))+(yr-fu),Vt[2]=Wa-((lo=Wa+fs)-(yr=lo-Wa))+(fs-yr),Vt[3]=lo;var hye=at(4,an,4,Vt,Jt);Vt[0]=(ml=(ca=Do-(ks=(Ni=Ke*Do)-(Ni-Do)))*(oo=ea-(js=(Ni=Ke*ea)-(Ni-ea)))-((Dl=Do*ea)-ks*js-ca*js-ks*oo))-((fs=ml-(fm=(ca=bc-(ks=(Ni=Ke*bc)-(Ni-bc)))*(oo=os-(js=(Ni=Ke*os)-(Ni-os)))-((fu=bc*os)-ks*js-ca*js-ks*oo)))+(yr=ml-fs))+(yr-fm),Vt[1]=(hu=Dl-((Wa=Dl+fs)-(yr=Wa-Dl))+(fs-yr))-((fs=hu-fu)+(yr=hu-fs))+(yr-fu),Vt[2]=Wa-((lo=Wa+fs)-(yr=lo-Wa))+(fs-yr),Vt[3]=lo;var fye=at(hye,Jt,4,Vt,en);Vt[0]=(ml=(ca=rs-(ks=(Ni=Ke*rs)-(Ni-rs)))*(oo=ea-(js=(Ni=Ke*ea)-(Ni-ea)))-((Dl=rs*ea)-ks*js-ca*js-ks*oo))-((fs=ml-(fm=(ca=li-(ks=(Ni=Ke*li)-(Ni-li)))*(oo=os-(js=(Ni=Ke*os)-(Ni-os)))-((fu=li*os)-ks*js-ca*js-ks*oo)))+(yr=ml-fs))+(yr-fm),Vt[1]=(hu=Dl-((Wa=Dl+fs)-(yr=Wa-Dl))+(fs-yr))-((fs=hu-fu)+(yr=hu-fs))+(yr-fu),Vt[2]=Wa-((lo=Wa+fs)-(yr=lo-Wa))+(fs-yr),Vt[3]=lo;var pye=at(fye,en,4,Vt,hn);return hn[pye-1]}(Tn,An,zn,or,si,oi,Kr)}(Me[0],Me[1],Le[0],Le[1],Mt[0],Mt[1]);return $t>0?-1:$t<0?1:0}function Lt(Me,Le){var Mt=Me.point,$t=Le.point;return Mt[0]>$t[0]?1:Mt[0]<$t[0]?-1:Mt[1]!==$t[1]?Mt[1]>$t[1]?1:-1:function(Tn,An,zn,or){return Tn.left!==An.left?Tn.left?1:-1:nn(zn,Tn.otherEvent.point,An.otherEvent.point)!==0?Tn.isBelow(An.otherEvent.point)?-1:1:!Tn.isSubject&&An.isSubject?1:-1}(Me,Le,Mt)}function It(Me,Le,Mt){var $t=new Se(Le,!1,Me,Me.isSubject),Tn=new Se(Le,!0,Me.otherEvent,Me.isSubject);return Ee(Me.point,Me.otherEvent.point)&&console.warn("what is that, a collapsed segment?",Me),$t.contourId=Tn.contourId=Me.contourId,Lt(Tn,Me.otherEvent)>0&&(Me.otherEvent.left=!0,Tn.left=!1),Me.otherEvent.otherEvent=Tn,Me.otherEvent=$t,Mt.push(Tn),Mt.push($t),Mt}function fn(Me,Le){return Me[0]*Le[1]-Me[1]*Le[0]}function cn(Me,Le){return Me[0]*Le[0]+Me[1]*Le[1]}function tr(Me,Le,Mt){var $t=function(si,oi,Jr,Xi,qs){var Kr=[oi[0]-si[0],oi[1]-si[1]],Ss=[Xi[0]-Jr[0],Xi[1]-Jr[1]];function ns(Ni,ks,ca){return[Ni[0]+ks*ca[0],Ni[1]+ks*ca[1]]}var Oi=[Jr[0]-si[0],Jr[1]-si[1]],Es=fn(Kr,Ss),Ps=Es*Es,gs=cn(Kr,Kr);if(Ps>0){var As=fn(Oi,Ss)/Es;if(As<0||As>1)return null;var rs=fn(Oi,Kr)/Es;return rs<0||rs>1?null:As===0||As===1?[ns(si,As,Kr)]:rs===0||rs===1?[ns(Jr,rs,Ss)]:[ns(si,As,Kr)]}if((Ps=(Es=fn(Oi,Kr))*Es)>0)return null;var li=cn(Kr,Oi)/gs,os=li+cn(Kr,Ss)/gs,ea=Math.min(li,os),yr=Math.max(li,os);return ea<=1&&yr>=0?ea===1?[ns(si,ea>0?ea:0,Kr)]:yr===0?[ns(si,yr<1?yr:1,Kr)]:[ns(si,ea>0?ea:0,Kr),ns(si,yr<1?yr:1,Kr)]:null}(Me.point,Me.otherEvent.point,Le.point,Le.otherEvent.point),Tn=$t?$t.length:0;if(Tn===0||Tn===1&&(Ee(Me.point,Le.point)||Ee(Me.otherEvent.point,Le.otherEvent.point))||Tn===2&&Me.isSubject===Le.isSubject)return 0;if(Tn===1)return Ee(Me.point,$t[0])||Ee(Me.otherEvent.point,$t[0])||It(Me,$t[0],Mt),Ee(Le.point,$t[0])||Ee(Le.otherEvent.point,$t[0])||It(Le,$t[0],Mt),1;var An=[],zn=!1,or=!1;return Ee(Me.point,Le.point)?zn=!0:Lt(Me,Le)===1?An.push(Le,Me):An.push(Me,Le),Ee(Me.otherEvent.point,Le.otherEvent.point)?or=!0:Lt(Me.otherEvent,Le.otherEvent)===1?An.push(Le.otherEvent,Me.otherEvent):An.push(Me.otherEvent,Le.otherEvent),zn&&or||zn?(Le.type=M,Me.type=Le.inOut===Me.inOut?O:z,zn&&!or&&It(An[1].otherEvent,An[0].point,Mt),2):or?(It(An[0],An[1].point,Mt),3):An[0]!==An[3].otherEvent?(It(An[0],An[1].point,Mt),It(An[1],An[2].point,Mt),3):(It(An[0],An[1].point,Mt),It(An[3].otherEvent,An[2].point,Mt),3)}function Fn(Me,Le){if(Me===Le)return 0;if(nn(Me.point,Me.otherEvent.point,Le.point)!==0||nn(Me.point,Me.otherEvent.point,Le.otherEvent.point)!==0)return Ee(Me.point,Le.point)?Me.isBelow(Le.otherEvent.point)?-1:1:Me.point[0]===Le.point[0]?Me.point[1]<Le.point[1]?-1:1:Lt(Me,Le)===1?Le.isAbove(Me.point)?-1:1:Me.isBelow(Le.point)?-1:1;if(Me.isSubject!==Le.isSubject)return Me.isSubject?-1:1;var Mt=Me.point,$t=Le.point;return Mt[0]===$t[0]&&Mt[1]===$t[1]?(Mt=Me.otherEvent.point)[0]===($t=Le.otherEvent.point)[0]&&Mt[1]===$t[1]?0:Me.contourId>Le.contourId?1:-1:Lt(Me,Le)===1?1:-1}var qn=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function vn(Me,Le,Mt,$t){var Tn,An=Me+1,zn=Le[Me].point,or=Le.length;for(An<or&&(Tn=Le[An].point);An<or&&Tn[0]===zn[0]&&Tn[1]===zn[1];){if(!Mt[An])return An;++An<or&&(Tn=Le[An].point)}for(An=Me-1;Mt[An]&&An>$t;)An--;return An}qn.prototype.isExterior=function(){return this.holeOf==null};var er=En,Ir=En;function En(Me,Le){if(!(this instanceof En))return new En(Me,Le);if(this.data=Me||[],this.length=this.data.length,this.compare=Le||Yn,this.length>0)for(var Mt=(this.length>>1)-1;Mt>=0;Mt--)this._down(Mt)}function Yn(Me,Le){return Me<Le?-1:Me>Le?1:0}En.prototype={push:function(Me){this.data.push(Me),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var Me=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),Me}},peek:function(){return this.data[0]},_up:function(Me){for(var Le=this.data,Mt=this.compare,$t=Le[Me];Me>0;){var Tn=Me-1>>1,An=Le[Tn];if(Mt($t,An)>=0)break;Le[Me]=An,Me=Tn}Le[Me]=$t},_down:function(Me){for(var Le=this.data,Mt=this.compare,$t=this.length>>1,Tn=Le[Me];Me<$t;){var An=1+(Me<<1),zn=An+1,or=Le[An];if(zn<this.length&&Mt(Le[zn],or)<0&&(An=zn,or=Le[zn]),Mt(or,Tn)>=0)break;Le[Me]=or,Me=An}Le[Me]=Tn}},er.default=Ir;var pr=Math.max,Lr=Math.min,ii=0;function zr(Me,Le,Mt,$t,Tn,An){var zn,or,si,oi,Jr,Xi;for(zn=0,or=Me.length-1;zn<or;zn++)if(oi=Me[zn+1],Jr=new Se(si=Me[zn],!1,void 0,Le),Xi=new Se(oi,!1,Jr,Le),Jr.otherEvent=Xi,si[0]!==oi[0]||si[1]!==oi[1]){Jr.contourId=Xi.contourId=Mt,An||(Jr.isExteriorRing=!1,Xi.isExteriorRing=!1),Lt(Jr,Xi)>0?Xi.left=!0:Jr.left=!0;var qs=si[0],Kr=si[1];Tn[0]=Lr(Tn[0],qs),Tn[1]=Lr(Tn[1],Kr),Tn[2]=pr(Tn[2],qs),Tn[3]=pr(Tn[3],Kr),$t.push(Jr),$t.push(Xi)}}var Bn=[];function jr(Me,Le,Mt){typeof Me[0][0][0]=="number"&&(Me=[Me]),typeof Le[0][0][0]=="number"&&(Le=[Le]);var $t=function(Kr,Ss,ns){var Oi=null;return Kr.length*Ss.length==0&&(ns===q?Oi=Bn:ns===Y?Oi=Kr:ns!==K&&ns!==ae||(Oi=Kr.length===0?Ss:Kr)),Oi}(Me,Le,Mt);if($t)return $t===Bn?null:$t;var Tn=[1/0,1/0,-1/0,-1/0],An=[1/0,1/0,-1/0,-1/0],zn=function(Kr,Ss,ns,Oi,Es){var Ps,gs,As,rs,li,os,ea=new er(null,Lt);for(As=0,rs=Kr.length;As<rs;As++)for(li=0,os=(Ps=Kr[As]).length;li<os;li++)(gs=li===0)&&ii++,zr(Ps[li],!0,ii,ea,ns,gs);for(As=0,rs=Ss.length;As<rs;As++)for(li=0,os=(Ps=Ss[As]).length;li<os;li++)gs=li===0,Es===Y&&(gs=!1),gs&&ii++,zr(Ps[li],!1,ii,ea,Oi,gs);return ea}(Me,Le,Tn,An,Mt);if($t=function(Kr,Ss,ns,Oi,Es){var Ps=null;return(ns[0]>Oi[2]||Oi[0]>ns[2]||ns[1]>Oi[3]||Oi[1]>ns[3])&&(Es===q?Ps=Bn:Es===Y?Ps=Kr:Es!==K&&Es!==ae||(Ps=Kr.concat(Ss))),Ps}(Me,Le,Tn,An,Mt))return $t===Bn?null:$t;for(var or=function(Kr){var Ss,ns,Oi=function(As){var rs,li,os,ea,yr=[];for(li=0,os=As.length;li<os;li++)((rs=As[li]).left&&rs.inResult||!rs.left&&rs.otherEvent.inResult)&&yr.push(rs);for(var Ni=!1;!Ni;)for(Ni=!0,li=0,os=yr.length;li<os;li++)li+1<os&&Lt(yr[li],yr[li+1])===1&&(ea=yr[li],yr[li]=yr[li+1],yr[li+1]=ea,Ni=!1);for(li=0,os=yr.length;li<os;li++)(rs=yr[li]).otherPos=li;for(li=0,os=yr.length;li<os;li++)(rs=yr[li]).left||(ea=rs.otherPos,rs.otherPos=rs.otherEvent.otherPos,rs.otherEvent.otherPos=ea);return yr}(Kr),Es={},Ps=[],gs=function(){if(!Es[Ss]){var As=Ps.length,rs=function(yr,Ni,ks){var ca=new qn;if(yr.prevInResult!=null){var js=yr.prevInResult,oo=js.outputContourId;if(js.resultTransition>0){var fs=Ni[oo];if(fs.holeOf!=null){var Wa=fs.holeOf;Ni[Wa].holeIds.push(ks),ca.holeOf=Wa,ca.depth=Ni[oo].depth}else Ni[oo].holeIds.push(ks),ca.holeOf=oo,ca.depth=Ni[oo].depth+1}else ca.holeOf=null,ca.depth=Ni[oo].depth}else ca.holeOf=null,ca.depth=0;return ca}(Oi[Ss],Ps,As),li=function(yr){Es[yr]=!0,yr<Oi.length&&Oi[yr]&&(Oi[yr].outputContourId=As)},os=Ss,ea=Ss;for(rs.points.push(Oi[Ss].point);li(os),li(os=Oi[os].otherPos),rs.points.push(Oi[os].point),!((os=vn(os,Oi,Es,ea))==ea||os>=Oi.length)&&Oi[os];);Ps.push(rs)}};for(Ss=0,ns=Oi.length;Ss<ns;Ss++)gs();return Ps}(function(Kr,Ss,ns,Oi,Es,Ps){for(var gs,As,rs,li=new p(Fn),os=[],ea=Math.min(Oi[2],Es[2]);Kr.length!==0;){var yr=Kr.pop();if(os.push(yr),Ps===q&&yr.point[0]>ea||Ps===Y&&yr.point[0]>Oi[2])break;if(yr.left){As=gs=li.insert(yr),gs=gs!==(rs=li.minNode())?li.prev(gs):null,As=li.next(As);var Ni=gs?gs.key:null;if(le(yr,Ni,Ps),As&&tr(yr,As.key,Kr)===2&&(le(yr,Ni,Ps),le(As.key,yr,Ps)),gs&&tr(gs.key,yr,Kr)===2){var ks=gs;le(Ni,(ks=ks!==rs?li.prev(ks):null)?ks.key:null,Ps),le(yr,Ni,Ps)}}else As=gs=li.find(yr=yr.otherEvent),gs&&As&&(gs=gs!==rs?li.prev(gs):null,As=li.next(As),li.remove(yr),As&&gs&&tr(gs.key,As.key,Kr))}return os}(zn,0,0,Tn,An,Mt)),si=[],oi=0;oi<or.length;oi++){var Jr=or[oi];if(Jr.isExterior()){for(var Xi=[Jr.points],qs=0;qs<Jr.holeIds.length;qs++)Xi.push(or[Jr.holeIds[qs]].points);si.push(Xi)}}return si}var ki={UNION:K,DIFFERENCE:Y,INTERSECTION:q,XOR:ae};c.diff=function(Me,Le){return jr(Me,Le,Y)},c.intersection=function(Me,Le){return jr(Me,Le,q)},c.operations=ki,c.union=function(Me,Le){return jr(Me,Le,K)},c.xor=function(Me,Le){return jr(Me,Le,ae)},Object.defineProperty(c,"__esModule",{value:!0})})(s)}(0,K8.exports)),K8.exports);/**
 * martinez v0.7.4
 * Martinez polygon clipping algorithm, does boolean operation on polygons (multipolygons, polygons with holes etc): intersection, union, difference, xor
 *
 * @author Alex Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */function jT(u,s,c,f){const p=[],_=f===0?(b,T,I,M,O,z)=>{b.push(new zt(z,I+(z-T)/(M-T)*(O-I)))}:(b,T,I,M,O,z)=>{b.push(new zt(T+(z-I)/(O-I)*(M-T),z))};for(const b of u){const T=[];for(const I of b){if(I.length<=2)continue;const M=[];for(let q=0;q<I.length-1;q++){const K=I[q].x,Y=I[q].y,ae=I[q+1].x,le=I[q+1].y,ce=f===0?K:Y,Se=f===0?ae:le;ce<s?Se>s&&_(M,K,Y,ae,le,s):ce>c?Se<c&&_(M,K,Y,ae,le,c):M.push(I[q]),Se<s&&ce>=s&&_(M,K,Y,ae,le,s),Se>c&&ce<=c&&_(M,K,Y,ae,le,c)}let O=I[I.length-1];const z=f===0?O.x:O.y;z>=s&&z<=c&&M.push(O),M.length&&(O=M[M.length-1],M[0].x===O.x&&M[0].y===O.y||M.push(M[0]),T.push(M))}T.length&&p.push(T)}return p}function cpe(u,s){const c=zN(u),f=zN([s]),p=Y8.intersection(c,f);return p==null?[]:X8(p)}function upe(u,s){let f=zN(u,65536);const p=[];for(;s.valid();s.next()){const[_,b]=s.get(),T=_.x*65536,I=_.y*65536,M=b.x*65536,O=b.y*65536,z=M-T,q=O-I,K=Math.hypot(z,q);if(K===0)continue;const Y=Math.trunc(q/K*3),ae=-Math.trunc(z/K*3);p.push([[[T,I],[M,O],[M+Y,O+ae],[T+Y,I+ae],[T,I]]])}return p.length>0&&(f=Y8.diff(f,p)),X8(f,1/65536)}function zN(u,s=1){return[u.map(c=>c.map(f=>[f.x*s,f.y*s]))]}function X8(u,s=1){return u.map(c=>c.map((f,p)=>{const _=f.map(b=>new zt(b[0]*s,b[1]*s).round());return p>0&&_.reverse(),_}))}class BN{constructor(s,c){this.layoutVertexArray=new im,this.indexArray=new vo,this.lineIndexArray=new so,this.triangleSegments=new Qs,this.lineSegments=new Qs,this.programConfigurations=new oh(s.layers,{zoom:s.zoom,lut:s.lut}),this.uploaded=!1,c&&(this.elevatedLayoutVertexArray=new sm)}update(s,c,f,p,_,b,T,I){this.programConfigurations.updatePaintArrays(s,c,_,f,p,b,T,I)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Zfe.members),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.lineIndexBuffer=s.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=s.createVertexBuffer(this.elevatedLayoutVertexArray,Kfe.members))),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(s,c,f,p,_,b,T){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,c,f,p,_,b,void 0,T)}}class UN{constructor(s){this.zoom=s.zoom,this.pixelRatio=s.pixelRatio,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.lut=s.lut,this.bufferData=new BN(s,!1),this.elevationBufferData=new BN(s,!0),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.projection=s.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference"),this.sourceLayerIndex=s.sourceLayerIndex,this.worldview=s.worldview}updateFootprints(s,c){}populate(s,c,f,p){this.hasPattern=ON("fill",this.layers,this.pixelRatio,c);const _=this.layers[0].layout.get("fill-sort-key"),b=[];for(const{feature:T,id:I,index:M,sourceLayerIndex:O}of s){const z=this.layers[0]._featureFilter.needGeometry,q=dn(T,z);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom,{worldview:this.worldview}),q,f))continue;const K=_?_.evaluate(q,{},f,c.availableImages):void 0,Y={id:I,properties:T.properties,type:T.type,sourceLayerIndex:O,index:M,geometry:z?q.geometry:Nn(T,f,p),patterns:{},sortKey:K};b.push(Y)}_&&b.sort((T,I)=>T.sortKey-I.sortKey);for(const T of b){const{geometry:I,index:M,sourceLayerIndex:O}=T;if(this.hasPattern){const z=FN("fill",this.layers,T,this.zoom,this.pixelRatio,c);this.patternFeatures.push(z)}else this.addFeature(T,I,M,f,{},c.availableImages,c.brightness,c.elevationFeatures);c.featureIndex.insert(s[M].feature,I,M,O,this.index)}}update(s,c,f,p,_,b,T){this.bufferData.update(s,c,f,p,_,b,T,this.worldview),this.elevationBufferData.update(s,c,f,p,_,b,T,this.worldview),this.elevatedStructures&&this.elevatedStructures.update(s,c,f,p,_,b,T,this.worldview)}addFeatures(s,c,f,p,_,b){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,c,f,p,b,s.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(s){this.bufferData.upload(s),this.elevationBufferData.upload(s),this.elevatedStructures&&this.elevatedStructures.upload(s)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(s,c,f,p,_,b=[],T,I){const M=x2(c,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(s,M,p,f,I):this.addGeometry(M,this.bufferData),this.bufferData.populatePaintArrays(s,f,_,b,p,T,this.worldview),this.elevationBufferData.populatePaintArrays(s,f,_,b,p,T,this.worldview)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(s,c,f,p,_){this.elevatedStructures&&(this.elevatedStructures.construct(s),this.elevatedStructures.populatePaintArrays(c,f,p,_,this.worldview))}addElevatedRoadFeature(s,c,f,p,_){const b=new Array,T=Ks.getElevationFeature(s,_);if(!T)return void this.addGeometry(c,this.bufferData);{const M=this.clipPolygonsToTile(c,1);M.length>0&&b.push({polygons:M,elevationFeature:T,elevationTileID:f})}const I={guardRailEnabled:this.layers[0].layout.get("fill-construct-bridge-guard-rail").evaluate(s,{},f),featureIndex:p};for(const M of b)if(M.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new $u(M.elevationTileID,this.layers,this.zoom,this.lut));const z=M.elevationFeature.isTunnel();let q=0;s.properties.hasOwnProperty(Ki)&&(q=+s.properties[Ki]);for(const K of M.polygons)this.elevatedStructures.addPortalCandidates(M.elevationFeature.id,K,z,M.elevationFeature,q)}M.elevationFeature.constantHeight==null&&(M.polygons=this.prepareElevatedPolygons(M.polygons,M.elevationFeature,M.elevationTileID));const O=new Va(f,M.elevationTileID);this.addElevatedGeometry(M.polygons,O,M.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,p,I)}}addElevatedGeometry(s,c,f,p,_,b){const T={elevation:f,elevationSampler:c,bias:p,index:_,featureInfo:b},[I,M]=this.addGeometry(s,this.elevationBufferData,T);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:I,max:M}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,I),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,M))}addGeometry(s,c,f){let p=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,b=null;f&&(b=f.elevationSampler.constantElevation(f.elevation,f.bias),b!=null&&(p=b,_=b));const T=(I,M,O)=>{if(f!=null)if(M.push(I),b!=null)c.elevatedLayoutVertexArray.emplaceBack(b),O.push(b);else{const z=f.elevationSampler.pointElevation(I,f.elevation,f.bias);c.elevatedLayoutVertexArray.emplaceBack(z),O.push(z),p=Math.min(p,z),_=Math.max(_,z)}};for(const I of s){let M=0;for(const Ae of I)M+=Ae.length;const O=c.triangleSegments.prepareSegment(M,c.layoutVertexArray,c.indexArray),z=O.vertexLength,q=[],K=[],Y=[],ae=[],le=[],ce=c.layoutVertexArray.length;for(const Ae of I){if(Ae.length===0)continue;Ae!==I[0]&&K.push(q.length/2);const Ee=c.lineSegments.prepareSegment(Ae.length,c.layoutVertexArray,c.lineIndexArray),Ze=Ee.vertexLength;f&&le.push(c.layoutVertexArray.length-ce),T(Ae[0],Y,ae),c.layoutVertexArray.emplaceBack(Ae[0].x,Ae[0].y),c.lineIndexArray.emplaceBack(Ze+Ae.length-1,Ze),q.push(Ae[0].x),q.push(Ae[0].y);for(let Ke=1;Ke<Ae.length;Ke++)T(Ae[Ke],Y,ae),c.layoutVertexArray.emplaceBack(Ae[Ke].x,Ae[Ke].y),c.lineIndexArray.emplaceBack(Ze+Ke-1,Ze+Ke),q.push(Ae[Ke].x),q.push(Ae[Ke].y);Ee.vertexLength+=Ae.length,Ee.primitiveLength+=Ae.length}const Se=o1(q,K);for(let Ae=0;Ae<Se.length;Ae+=3)c.indexArray.emplaceBack(z+Se[Ae],z+Se[Ae+1],z+Se[Ae+2]);if(Se.length>0&&f&&this.elevationMode==="hd-road-base"){const Ae=f.elevation.isTunnel(),Ee=f.elevation.safeArea,Ze=this.elevatedStructures.addVertices(Y,ae);this.elevatedStructures.addTriangles(Se,Ze,Ae);const Ke=le.length;if(Ke>0){for(let tt=0;tt<Ke-1;tt++)this.elevatedStructures.addRenderableRing(f.index,le[tt]+Ze,le[tt+1]-le[tt],Ae,Ee,f.featureInfo);this.elevatedStructures.addRenderableRing(f.index,le[Ke-1]+Ze,Y.length-le[Ke-1],Ae,Ee,f.featureInfo)}}O.vertexLength+=M,O.primitiveLength+=Se.length/3}return[p,_]}prepareElevatedPolygons(s,c,f){const p=1/bt(f),_=[];for(const b of s){const T=upe(b,new Yi(c,p));_.push(...T)}return _}clipPolygonsToTile(s,c){const f=-c,p=-c,_=yn+c,b=yn+c;let T=0;const I=[],M=[];for(;T<s.length;T++){const q=s[T],K=Fu(q);(K.min.x>=f&&K.max.x<=_&&K.min.y>=p&&K.max.y<=b?I:M).push(q)}if(I.length===s.length)return s;const O=[new zt(f,p),new zt(_,p),new zt(_,b),new zt(f,b),new zt(f,p)],z=I;for(const q of M)z.push(...cpe(q,O));return z}}let J8,Q8,e7,t7;Pn(UN,"FillBucket",{omit:["layers","patternFeatures"]}),Pn(BN,"FillBufferData"),Pn($u,"ElevatedStructures");class OT{constructor(s,c,f,p){if(this.triangleCount=c.length/3,this.min=new zt(0,0),this.max=new zt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||s.length===0)return;const[_,b]=[s[0].clone(),s[0].clone()];for(let z=1;z<s.length;++z){const q=s[z];_.x=Math.min(_.x,q.x),_.y=Math.min(_.y,q.y),b.x=Math.max(b.x,q.x),b.y=Math.max(b.y,q.y)}if(p){const z=Math.ceil(Math.max(b.x-_.x,b.y-_.y)/p);f=Math.max(f,z)}if(f===0)return;this.min=_,this.max=b;const T=this.max.sub(this.min);T.x=Math.max(T.x,1),T.y=Math.max(T.y,1);const I=Math.max(T.x,T.y)/f;this.cellsX=Math.max(1,Math.ceil(T.x/I)),this.cellsY=Math.max(1,Math.ceil(T.y/I)),this.xScale=1/I,this.yScale=1/I;const M=[];for(let z=0;z<this.triangleCount;z++){const q=s[c[3*z+0]].sub(this.min),K=s[c[3*z+1]].sub(this.min),Y=s[c[3*z+2]].sub(this.min),ae=dm(Math.floor(Math.min(q.x,K.x,Y.x)),this.xScale,this.cellsX),le=dm(Math.floor(Math.max(q.x,K.x,Y.x)),this.xScale,this.cellsX),ce=dm(Math.floor(Math.min(q.y,K.y,Y.y)),this.yScale,this.cellsY),Se=dm(Math.floor(Math.max(q.y,K.y,Y.y)),this.yScale,this.cellsY),Ae=new zt(0,0),Ee=new zt(0,0),Ze=new zt(0,0),Ke=new zt(0,0);for(let tt=ce;tt<=Se;++tt){Ae.y=Ee.y=tt*I,Ze.y=Ke.y=(tt+1)*I;for(let at=ae;at<=le;++at)Ae.x=Ze.x=at*I,Ee.x=Ke.x=(at+1)*I,(Xf(q,K,Y,Ae,Ee,Ke)||Xf(q,K,Y,Ae,Ke,Ze))&&M.push({cellIdx:tt*this.cellsX+at,triIdx:z})}}if(M.length===0)return;M.sort((z,q)=>z.cellIdx-q.cellIdx||z.triIdx-q.triIdx);let O=0;for(;O<M.length;){const z=M[O].cellIdx,q={start:this.payload.length,len:0};for(;O<M.length&&M[O].cellIdx===z;)++q.len,this.payload.push(M[O++].triIdx);this.cells[z]=q}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(s,c){if(this.triangleCount===0||this.cells.length===0||s.x>this.max.x||this.min.x>s.x||s.y>this.max.y||this.min.y>s.y)return;const f=dm(s.x-this.min.x,this.xScale,this.cellsX),p=dm(s.y-this.min.y,this.yScale,this.cellsY),_=this.cells[p*this.cellsX+f];if(_){this._lazyInitLookup();for(let b=0;b<_.len;b++){const T=this.payload[_.start+b],I=Math.floor(T/8),M=1<<T%8;if(!(this.lookup[I]&M)&&(this.lookup[I]|=M,c.push(T),c.length===this.triangleCount))return}}}query(s,c,f){if(this.triangleCount===0||this.cells.length===0||s.x>this.max.x||this.min.x>c.x||s.y>this.max.y||this.min.y>c.y)return;this._lazyInitLookup();const p=dm(s.x-this.min.x,this.xScale,this.cellsX),_=dm(c.x-this.min.x,this.xScale,this.cellsX),b=dm(s.y-this.min.y,this.yScale,this.cellsY),T=dm(c.y-this.min.y,this.yScale,this.cellsY);for(let I=b;I<=T;I++)for(let M=p;M<=_;M++){const O=this.cells[I*this.cellsX+M];if(O)for(let z=0;z<O.len;z++){const q=this.payload[O.start+z],K=Math.floor(q/8),Y=1<<q%8;if(!(this.lookup[K]&Y)&&(this.lookup[K]|=Y,f.push(q),f.length===this.triangleCount))return}}}}function dm(u,s,c){return Math.max(0,Math.min(c-1,Math.floor(u*s)))}Pn(OT,"TriangleGridIndex");class n7{constructor(s){this.zoom=s.zoom,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=s.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.footprints=[],this.worldview=s.worldview}updateFootprints(s,c){for(const f of this.footprints)c.push({footprint:f,id:s})}populate(s,c,f,p){const _=[];for(const{feature:b,id:T,index:I,sourceLayerIndex:M}of s){const O=this.layers[0]._featureFilter.needGeometry,z=dn(b,O);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom,{worldview:this.worldview}),z,f))continue;const q={id:T,properties:b.properties,type:b.type,sourceLayerIndex:M,index:I,geometry:O?z.geometry:Nn(b,f,p),patterns:{}};_.push(q)}for(const b of _){const{geometry:T,index:I,sourceLayerIndex:M}=b;this.addFeature(b,T,I,f,{},c.availableImages,c.brightness),c.featureIndex.insert(s[I].feature,T,I,M,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(s){}update(s,c,f,p,_,b,T){}destroy(){}addFeature(s,c,f,p,_,b=[],T){for(const I of x2(c,2)){const M=[],O=[],z=[],q=new zt(1/0,1/0),K=new zt(-1/0,-1/0);for(const le of I)if(le.length!==0){le!==I[0]&&z.push(O.length/2);for(let ce=0;ce<le.length;ce++)O.push(le[ce].x),O.push(le[ce].y),M.push(le[ce]),q.x=Math.min(q.x,le[ce].x),q.y=Math.min(q.y,le[ce].y),K.x=Math.max(K.x,le[ce].x),K.y=Math.max(K.y,le[ce].y)}const Y=o1(O,z),ae=new OT(M,Y,8,256);this.footprints.push({vertices:M,indices:Y,grid:ae,min:q,max:K})}}}Pn(n7,"ClipBucket",{omit:["layers"]});const dpe=Ti([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),hpe=Ti([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),fpe=Ti([{name:"a_centroid_pos",components:2,type:"Uint16"}]),ppe=Ti([{name:"a_join_normal_inside",components:3,type:"Int16"}]),mpe=Ti([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),gpe=Ti([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:ype}=dpe,b2=Number.MAX_SAFE_INTEGER,r7=b2-1;function i7(u,s,c,f){return u.order<s||u.order===b2||!(u.clipMask&c)||function(p,_){return _.length!==0&&_.find(b=>b===p)===void 0}(f,u.clipScope)}function FT(u,s){return u.x-s.x||u.y-s.y}function s7(u,s){return FT(u.min,s.min)===0&&FT(u.max,s.max)===0}function VN(u,s){return!(u.min.x>s.max.x||u.max.x<s.min.x||u.min.y>s.max.y||u.max.y<s.min.y)}function zT(u,s){if(u.length!==s.length)return!1;for(let c=0;c<u.length;c++)if(u[c].sourceId!==s[c].sourceId||!s7(u[c],s[c])||u[c].order!==s[c].order||u[c].clipMask!==s[c].clipMask||!es(u[c].clipScope,s[c].clipScope))return!1;return!0}function a7(u,s,c){const f=1/yn,p=1/(1<<c.canonical.z),_=(s.x*f+c.canonical.x)*p+c.wrap,b=(s.y*f+c.canonical.y)*p;return{min:new zt((u.x*f+c.canonical.x)*p+c.wrap,(u.y*f+c.canonical.y)*p),max:new zt(_,b)}}function vpe(u,s,c){const f=1<<c.canonical.z,p=((s.x-c.wrap)*f-c.canonical.x)*yn,_=(s.y*f-c.canonical.y)*yn;return{min:new zt(((u.x-c.wrap)*f-c.canonical.x)*yn,(u.y*f-c.canonical.y)*yn),max:new zt(p,_)}}function $N(u,s,c,f,p,_,b){const T=u.indices,I=u.vertices,M=[];for(let O=f;O<f+p;O+=3){const z=s[c[O+0]+_],q=s[c[O+1]+_],K=s[c[O+2]+_],Y=Math.min(z.x,q.x,K.x),ae=Math.max(z.x,q.x,K.x),le=Math.min(z.y,q.y,K.y),ce=Math.max(z.y,q.y,K.y);M.length=0,u.grid.query(new zt(Y,le),new zt(ae,ce),M);for(let Se=0;Se<M.length;Se++){const Ae=M[Se];if(Xf(I[T[3*Ae+0]],I[T[3*Ae+1]],I[T[3*Ae+2]],z,q,K,b))return!0}}return!1}function o7(u,s,c,f){if(!u||!c)return!1;let p=u.vertices;if(!s.canonical.equals(f.canonical)||s.wrap!==f.wrap){if(c.vertices.length<u.vertices.length)return o7(c,f,u,s);const _=s.canonical,b=f.canonical,T=Math.pow(2,b.z-_.z);p=u.vertices.map(I=>new zt((I.x+_.x*yn)*T-b.x*yn,(I.y+_.y*yn)*T-b.y*yn))}return $N(c,p,u.indices,0,u.indices.length,0,0)}function l7(u,s,c,f){const p=Math.pow(2,f.z-c.z);return new zt((u+c.x*yn)*p-f.x*yn,(s+c.y*yn)*p-f.y*yn)}function qN(u,s){const c=[];s.grid.queryPoint(u,c);const f=s.indices,p=s.vertices;for(let _=0;_<c.length;_++){const b=c[_];if(Lo([p[f[3*b+0]],p[f[3*b+1]],p[f[3*b+2]]],u))return!0}return!1}const GN=[new zt(0,0),new zt(yn,0),new zt(yn,yn),new zt(0,yn)];function c7(u,s){const c=[];let f=[];if(!s||u.length<2)return[u];if(u.length===2)return Ml(u[0],u[1],GN)?[u]:[];for(let p=0;p<u.length+2;p++){const _=u[p%u.length],b=u[(p+1)%u.length],T=Ml(p===0?u[u.length-1]:u[(p-1)%u.length],_,GN),I=Ml(_,b,GN),M=T||I;M&&f.push(_),M&&I||f.length>0&&(f.length>1&&c.push(f),f=[])}return f.length>1&&c.push(f),c}const HN=rn.types,_pe=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],xpe=["fill-extrusion-flood-light-ground-radius"],bpe=Math.pow(2,13),wpe=Math.pow(2,15)-1,u7=new zt(0,1),n0=2147483648;function w2(u,s,c,f,p,_,b,T){u.emplaceBack((s<<1)+b,(c<<1)+_,(Math.floor(f*bpe)<<1)+p,Math.round(T))}function S2(u,s,c){u.emplaceBack(s.x*yn,s.y*yn,c?1:0)}function BT(u,s,c,f,p,_){u.emplaceBack(s.x,s.y,(c.x<<1)+f,(c.y<<1)+p,_)}function A2(u,s,c){u.emplaceBack(s.x,s.y,s.z,c[0]*16384,c[1]*16384,c[2]*16384)}class d7{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class h7{constructor(){this.centroidXY=new zt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new zt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new zt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0,this.buildingId=0}span(){return new zt(this.max.x-this.min.x,this.max.y-this.min.y)}}class f7{constructor(){this.acc=new zt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(s,c){s.min.x===Number.MAX_VALUE&&(s.min.x=s.max.x=c.x,s.min.y=s.max.y=c.y)}appendEdge(s,c,f){this.accCount++,this.acc._add(c);let p=!!this.borders;c.x<s.min.x?(s.min.x=c.x,p=!0):c.x>s.max.x&&(s.max.x=c.x,p=!0),c.y<s.min.y?(s.min.y=c.y,p=!0):c.y>s.max.y&&(s.max.y=c.y,p=!0),((c.x===0||c.x===yn)&&c.x===f.x)!=((c.y===0||c.y===yn)&&c.y===f.y)&&this.processBorderOverlap(c,f),p&&this.checkBorderIntersection(c,f)}checkBorderIntersection(s,c){c.x<0!=s.x<0&&this.addBorderIntersection(0,qe(c.y,s.y,(0-c.x)/(s.x-c.x))),c.x>yn!=s.x>yn&&this.addBorderIntersection(1,qe(c.y,s.y,(yn-c.x)/(s.x-c.x))),c.y<0!=s.y<0&&this.addBorderIntersection(2,qe(c.x,s.x,(0-c.y)/(s.y-c.y))),c.y>yn!=s.y>yn&&this.addBorderIntersection(3,qe(c.x,s.x,(yn-c.y)/(s.y-c.y)))}addBorderIntersection(s,c){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const f=this.borders[s];c<f[0]&&(f[0]=c),c>f[1]&&(f[1]=c)}processBorderOverlap(s,c){if(s.x===c.x){if(s.y===c.y)return;const f=s.x===0?0:1;this.addBorderIntersection(f,c.y),this.addBorderIntersection(f,s.y)}else{const f=s.y===0?2:3;this.addBorderIntersection(f,c.x),this.addBorderIntersection(f,s.x)}}centroid(){return this.accCount===0?new zt(0,0):new zt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((s,c)=>s+ +(c[0]!==Number.MAX_VALUE),0):0}}function p7(u,s){const c=u.add(s)._unit(),f=We(u.x*c.x+u.y*c.y,-1,1);var p,_,b;return p=Math.acos(f),Math.min(4,Math.max(-4,Math.tan(p)))/4*wpe*((_=u).x*(b=s).y-_.y*b.x<0?-1:1)}const Spe=[u=>u.x<0,u=>u.x>yn,u=>u.y<0,u=>u.y>yn];function Ape(u,s,c,f){const p=[4];if(f===0)return p;c._mult(f);const _=u.sub(c),b=s.sub(c),T=[u,s,_,b];for(let I=0;I<4;I++)for(const M of T)if(Spe[I](M)){p.push(I);break}return p}class WN{constructor(s){this.vertexArray=new n2,this.indexArray=new vo,this.programConfigurations=new oh(s.layers,{zoom:s.zoom,lut:s.lut},c=>xpe.includes(c)),this._segments=new Qs,this.hiddenByLandmarkVertexArray=new t1,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Qs}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(s,c,f,p=!1){const _=s.length;if(_>2){let b=Math.max(0,this._segments.get().length-1);const T=this._segments._prepareSegment(4*_,this.vertexArray.length,2*this._segmentToGroundQuads[b].length);let I;b!==this._segments.get().length-1&&(b++,this._segmentToGroundQuads[b]=[],this._segmentToRegionTriCounts[b]=[0,0,0,0,0]);{const M=s[0],O=s[1];I=p7(M.sub(s[_-1])._perp()._unit(),O.sub(M)._perp()._unit())}for(let M=0;M<_;M++){const O=M===_-1?0:M+1,z=s[M],q=s[O],K=s[O===_-1?0:O+1],Y=q.sub(z)._perp()._unit(),ae=p7(Y,K.sub(q)._perp()._unit()),le=I,ce=ae;if(ZN(z,q,c)||p&&y7(z,c)&&y7(q,c)){I=ae;continue}const Se=T.vertexLength;BT(this.vertexArray,z,q,1,1,le),BT(this.vertexArray,z,q,1,0,le),BT(this.vertexArray,z,q,0,1,ce),BT(this.vertexArray,z,q,0,0,ce),T.vertexLength+=4;const Ae=Ape(z,q,Y,f);for(const Ee of Ae)this._segmentToGroundQuads[b].push({id:Se,region:Ee}),this._segmentToRegionTriCounts[b][Ee]+=2,T.primitiveLength+=2;I=ae}}}prepareBorderSegments(){if(!this.hasData())return;const s=this._segments.get(),c=s.length;for(let f=0;f<c;f++)this._segmentToGroundQuads[f].sort((p,_)=>p.region-_.region);for(let f=0;f<c;f++){const p=this._segmentToGroundQuads[f],_=s[f],b=this._segmentToRegionTriCounts[f];b.reduce((I,M)=>I+M,0);let T=0;for(let I=0;I<=4;I++){const M=b[I];if(M!==0){let O=this.regionSegments[I];O||(O=this.regionSegments[I]=new Qs);const z={vertexOffset:_.vertexOffset,primitiveOffset:_.primitiveOffset+T,vertexLength:_.vertexLength,primitiveLength:M};O.get().push(z)}T+=M}for(let I=0;I<p.length;I++){const M=p[I].id;this.indexArray.emplaceBack(M,M+1,M+3),this.indexArray.emplaceBack(M,M+3,M+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(s,c,f,p,_,b,T){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,s,c,f,p,_,b,void 0,T)}upload(s){this.hasData()&&(this.vertexBuffer=s.createVertexBuffer(this.vertexArray,hpe.members),this.indexBuffer=s.createIndexBuffer(this.indexArray))}uploadPaintProperties(s){this.hasData()&&this.programConfigurations.upload(s)}update(s,c,f,p,_,b,T,I){this.hasData()&&this.programConfigurations.updatePaintArrays(s,c,f,p,_,b,T,I)}updateHiddenByLandmark(s){this.updateHiddenByLandmarkRange(s.groundVertexArrayOffset,s.groundVertexCount,!!(s.flags&n0))}updateHiddenByLandmarkRange(s,c,f){if(!this.hasData())return;const p=c+s;if(c!==0){for(let _=s;_<p;++_)this.hiddenByLandmarkVertexArray.emplace(_,f?1:0);this._needsHiddenByLandmarkUpdate=!0}}uploadHiddenByLandmark(s){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=s.createVertexBuffer(this.hiddenByLandmarkVertexArray,mpe.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let s=0;s<=4;s++){const c=this.regionSegments[s];c&&c.destroy()}}}}class UT{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.overscaling=s.overscaling,this.layers=s.layers,this.pixelRatio=s.pixelRatio,this.layerIds=this.layers.map(c=>c.fqid),this.index=s.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=s.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new vo,this.footprintVertices=new im,this.footprintSegments=[],this.layoutVertexArray=new _g,this.centroidVertexArray=new AT,this.wallVertexArray=new CT,this.indexArray=new vo,this.programConfigurations=new oh(s.layers,{zoom:s.zoom,lut:s.lut},c=>_pe.includes(c)),this.segments=new Qs,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.groundEffect=new WN(s),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[],this.worldview=s.worldview}updateFootprints(s,c){}populate(s,c,f,p){this.features=[],this.hasPattern=ON("fill-extrusion",this.layers,this.pixelRatio,c),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=bt(f),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:_,id:b,index:T,sourceLayerIndex:I}of s){const M=this.layers[0]._featureFilter.needGeometry,O=dn(_,M);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom,{worldview:this.worldview}),O,f))continue;const z={id:b,sourceLayerIndex:I,index:T,geometry:M?O.geometry:Nn(_,f,p),properties:_.properties,type:_.type,patterns:{}},q=this.layoutVertexArray.length,K=HN[z.type]==="Polygon";if(this.hasPattern)this.features.push({featureId:_.id,feature:FN("fill-extrusion",this.layers,z,this.zoom,this.pixelRatio,c)});else if(this.wallMode)for(const Y of z.geometry)for(const ae of c7(Y,K))this.addFeature(_.id,z,[ae],T,f,{},c.availableImages,p,c.brightness);else this.addFeature(_.id,z,z.geometry,T,f,{},c.availableImages,p,c.brightness);c.featureIndex.insert(_,z.geometry,T,I,this.index,q)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(s,c,f,p,_,b){for(const{featureId:T,feature:I}of this.features){const M=HN[I.type]==="Polygon",{geometry:O}=I;if(this.wallMode)for(const z of O)for(const q of c7(z,M))this.addFeature(T,I,[q],I.index,c,f,p,_,b);else this.addFeature(T,I,O,I.index,c,f,p,_,b)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(s,c,f,p,_,b,T){this.programConfigurations.updatePaintArrays(s,c,_,f,p,b,T,this.worldview),this.groundEffect.update(s,c,_,f,p,b,T,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,ype),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.wallVertexBuffer=s.createVertexBuffer(this.wallVertexArray,ppe.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=s.createVertexBuffer(this.layoutVertexExtArray,gpe.members,!0)),this.groundEffect.upload(s)),this.groundEffect.uploadPaintProperties(s),this.programConfigurations.upload(s),this.uploaded=!0}uploadCentroid(s){this.groundEffect.uploadHiddenByLandmark(s),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,fpe.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,c,f,p,_,b,T,I,M){const O=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(c,{})/this.tileToMeter,z=[new zt(0,0),new zt(yn,yn)],q=I.projection,K=q.name==="globe",Y=this.wallMode||HN[c.type]==="Polygon",ae=new f7;ae.centroidDataIndex=this.centroidData.length;const le=new h7;le.buildingId=s,c.properties&&c.properties.hasOwnProperty("building_id")&&(le.buildingId=c.properties.building_id);const ce=this.layers[0].paint.get("fill-extrusion-base").evaluate(c,{},_)<=0,Se=this.layers[0].paint.get("fill-extrusion-height").evaluate(c,{},_);let Ae;if(le.height=Se,le.vertexArrayOffset=this.layoutVertexArray.length,le.groundVertexArrayOffset=this.groundEffect.vertexArray.length,K&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Yx),this.wallMode){if(K)return void ai("Non zero fill-extrusion-line-width is not yet supported on globe.");if(f.length!==1)return;Ae=function(_t){const Xt=_t[0].x===_t[_t.length-1].x&&_t[0].y===_t[_t.length-1].y;(function(vn){let er=0;const Ir=vn.length;for(let En=0;En<Ir;En++)er+=(vn[(En+1)%Ir].x-vn[En].x)*(vn[(En+1)%Ir].y+vn[En].y);return er>=0})(_t)||(_t=_t.reverse());const Jt={geometry:[],joinNormals:[],indices:[]},en=[],hn=[],Vt=[];let nn=_t.length;for(;nn>=2&&_t[nn-1].equals(_t[nn-2]);)nn--;if(nn<(Xt?3:2))return Jt;let Lt,It,fn,cn,tr,Fn=0;for(;Fn<nn-1&&_t[Fn].equals(_t[Fn+1]);)Fn++;Xt&&(Lt=_t[nn-2],tr=_t[Fn].sub(Lt)._unit()._perp());for(let vn=Fn;vn<nn;vn++){if(fn=vn===nn-1?Xt?_t[Fn+1]:void 0:_t[vn+1],fn&&_t[vn].equals(fn))continue;tr&&(cn=tr),Lt&&(It=Lt),Lt=_t[vn],tr=fn?fn.sub(Lt)._unit()._perp():cn,cn=cn||tr;let er=cn.add(tr);er.x===0&&er.y===0||er._unit();const Ir=er.x*tr.x+er.y*tr.y,En=Ir!==0?1/Ir:1/0,Yn=cn.x*tr.y-cn.y*tr.x>0;let pr="miter";const Lr=2;pr==="miter"&&En>Lr&&(pr="bevel"),pr==="bevel"&&(En>100&&(pr="flipbevel"),En<Lr&&(pr="miter"));const ii=(zr,Bn,jr,ki)=>{const Me=new zt(zr.x,zr.y),Le=new zt(zr.x,zr.y);Me.x+=Bn.x*ki,Me.y+=Bn.y*ki,Le.x-=Bn.x*Math.max(jr,1),Le.y-=Bn.y*Math.max(jr,1),Vt.push(Bn),en.push(Me),hn.push(Le)};if(pr==="miter")er._mult(En),ii(Lt,er,0,0);else if(pr==="flipbevel")er=tr.mult(-1),ii(Lt,er,0,0),ii(Lt,er.mult(-1),0,0);else{const zr=-Math.sqrt(En*En-1),Bn=Yn?zr:0,jr=Yn?0:zr;It&&ii(Lt,cn,Bn,jr),fn&&ii(Lt,tr,Bn,jr)}}Jt.geometry=[...en,...hn.reverse(),en[0]],Jt.joinNormals=[...Vt,...Vt.reverse(),Vt[Vt.length-1]];const qn=Jt.geometry.length-1;for(let vn=0;vn<qn/2;vn++)if(vn+1<qn/2){let er=vn,Ir=vn+1,En=qn-1-vn,Yn=qn-2-vn;er=er===0?qn-1:er-1,Ir=Ir===0?qn-1:Ir-1,En=En===0?qn-1:En-1,Yn=Yn===0?qn-1:Yn-1,Jt.indices.push(En),Jt.indices.push(Ir),Jt.indices.push(er),Jt.indices.push(En),Jt.indices.push(Yn),Jt.indices.push(Ir)}return Jt}(f[0]),f=[Ae.geometry]}const Ee=(_t,Xt)=>_t<(Xt.length-1)/2||_t===Xt.length-1,Ze=this.wallMode?[f]:x2(f,500);for(let _t=Ze.length-1;_t>=0;_t--){const Xt=Ze[_t];(Xt.length===0||(Ke=Xt[0]).every(an=>an.x<=0)||Ke.every(an=>an.x>=yn)||Ke.every(an=>an.y<=0)||Ke.every(an=>an.y>=yn))&&Ze.splice(_t,1)}var Ke;let tt;if(K)tt=b7(Ze,z,_);else{tt=[];for(const _t of Ze)tt.push({polygon:_t,bounds:z})}const at=Y?this.edgeRadius:0,ct=at>0&&this.zoom<17,qt=(_t,Xt)=>{if(_t.length===0)return!1;const an=_t[_t.length-1];return Xt.x===an.x&&Xt.y===an.y};for(const{polygon:_t,bounds:Xt}of tt){let an=0,Jt=0;for(const nn of _t)Y&&!nn[0].equals(nn[nn.length-1])&&nn.push(nn[0]),Jt+=Y?nn.length-1:nn.length;const en=this.segments.prepareSegment((Y?5:4)*Jt,this.layoutVertexArray,this.indexArray);le.footprintSegIdx<0&&(le.footprintSegIdx=this.footprintSegments.length),le.polygonSegIdx<0&&(le.polygonSegIdx=this.polygonSegments.length);const hn={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Vt=new d7;if(Vt.vertexOffset=this.footprintVertices.length,Vt.indexOffset=3*this.footprintIndices.length,Vt.ringIndices=[],Y){const nn=[],Lt=[];an=en.vertexLength;for(let fn=0;fn<_t.length;fn++){const cn=_t[fn];cn.length&&fn!==0&&Lt.push(nn.length/2);const tr=[];let Fn,qn;Fn=cn[1].sub(cn[0])._perp()._unit(),Vt.ringIndices.push(cn.length-1);for(let vn=1;vn<cn.length;vn++){const er=cn[vn],Ir=cn[vn===cn.length-1?1:vn+1],En=er.clone();if(at){qn=Ir.sub(er)._perp()._unit();const Yn=Fn.add(qn)._unit(),pr=at*Math.min(4,1/(Fn.x*Yn.x+Fn.y*Yn.y));En.x+=pr*Yn.x,En.y+=pr*Yn.y,En.x=Math.round(En.x),En.y=Math.round(En.y),Fn=qn}if(!ce||at!==0&&!ct||qt(tr,En)||tr.push(En),w2(this.layoutVertexArray,En.x,En.y,0,0,1,1,0),this.wallMode){const Yn=Ee(vn,cn);S2(this.wallVertexArray,Ae.joinNormals[vn],!Yn)}en.vertexLength++,this.footprintVertices.emplaceBack(er.x,er.y),nn.push(er.x,er.y),K&&A2(this.layoutVertexExtArray,q.projectTilePoint(En.x,En.y,_),q.upVector(_,En.x,En.y))}ce&&(at===0||ct)&&(tr.length!==0&&qt(tr,tr[0])&&tr.pop(),this.groundEffect.addData(tr,Xt,O))}const It=this.wallMode?Ae.indices:o1(nn,Lt);for(let fn=0;fn<It.length;fn+=3)this.footprintIndices.emplaceBack(Vt.vertexOffset+It[fn+0],Vt.vertexOffset+It[fn+1],Vt.vertexOffset+It[fn+2]),this.indexArray.emplaceBack(an+It[fn],an+It[fn+2],an+It[fn+1]),en.primitiveLength++;Vt.indexCount+=It.length,Vt.vertexCount+=this.footprintVertices.length-Vt.vertexOffset}for(let nn=0;nn<_t.length;nn++){const Lt=_t[nn];ae.startRing(le,Lt[0]);let It=Lt.length>4&&v7(Lt[Lt.length-2],Lt[0],Lt[1]),fn=at?Tpe(Lt[Lt.length-2],Lt[0],Lt[1],at):0;const cn=[];let tr,Fn,qn;Fn=Lt[1].sub(Lt[0])._perp()._unit();let vn=!0;for(let er=1,Ir=0;er<Lt.length;er++){let En=Lt[er-1],Yn=Lt[er];const pr=Lt[er===Lt.length-1?1:er+1];if(ae.appendEdge(le,Yn,En),ZN(Yn,En,Xt)){at&&(Fn=pr.sub(Yn)._perp()._unit(),vn=!vn);continue}const Lr=Yn.sub(En)._perp(),ii=Lr.x/(Math.abs(Lr.x)+Math.abs(Lr.y)),zr=Lr.y>0?1:0,Bn=En.dist(Yn);if(Ir+Bn>32768&&(Ir=0),at){qn=pr.sub(Yn)._perp()._unit();let Le=g7(En,Yn,pr,m7(Fn,qn),at);isNaN(Le)&&(Le=0);const Mt=Yn.sub(En)._unit();En=En.add(Mt.mult(fn))._round(),Yn=Yn.add(Mt.mult(-Le))._round(),fn=Le,Fn=qn,ce&&this.zoom>=17&&(qt(cn,En)||cn.push(En),qt(cn,Yn)||cn.push(Yn))}const jr=en.vertexLength,ki=Lt.length>4&&v7(En,Yn,pr);let Me=_7(Ir,It,vn);if(w2(this.layoutVertexArray,En.x,En.y,ii,zr,0,0,Me),w2(this.layoutVertexArray,En.x,En.y,ii,zr,0,1,Me),this.wallMode){const Le=Ee(er-1,Lt),Mt=Ae.joinNormals[er-1];S2(this.wallVertexArray,Mt,Le),S2(this.wallVertexArray,Mt,Le)}if(Ir+=Bn,Me=_7(Ir,ki,!vn),It=ki,w2(this.layoutVertexArray,Yn.x,Yn.y,ii,zr,0,0,Me),w2(this.layoutVertexArray,Yn.x,Yn.y,ii,zr,0,1,Me),this.wallMode){const Le=Ee(er,Lt),Mt=Ae.joinNormals[er];S2(this.wallVertexArray,Mt,Le),S2(this.wallVertexArray,Mt,Le)}if(en.vertexLength+=4,this.indexArray.emplaceBack(jr+0,jr+1,jr+2),this.indexArray.emplaceBack(jr+1,jr+3,jr+2),en.primitiveLength+=2,at){const Le=an+(er===1?Lt.length-2:er-2),Mt=er===1?an:Le+1;if(this.indexArray.emplaceBack(jr+1,Le,jr+3),this.indexArray.emplaceBack(Le,Mt,jr+3),en.primitiveLength+=2,tr===void 0&&(tr=jr),!ZN(pr,Lt[er],Xt)){const $t=er===Lt.length-1?tr:en.vertexLength;this.indexArray.emplaceBack(jr+2,jr+3,$t),this.indexArray.emplaceBack(jr+3,$t+1,$t),this.indexArray.emplaceBack(jr+3,Mt,$t+1),en.primitiveLength+=3}vn=!vn}if(K){const Le=this.layoutVertexExtArray,Mt=q.projectTilePoint(En.x,En.y,_),$t=q.projectTilePoint(Yn.x,Yn.y,_),Tn=q.upVector(_,En.x,En.y),An=q.upVector(_,Yn.x,Yn.y);A2(Le,Mt,Tn),A2(Le,Mt,Tn),A2(Le,$t,An),A2(Le,$t,An)}}Y&&(an+=Lt.length-1),ce&&at&&this.zoom>=17&&(cn.length!==0&&qt(cn,cn[0])&&cn.pop(),this.groundEffect.addData(cn,Xt,O,at>0))}this.footprintSegments.push(Vt),hn.triangleCount=this.indexArray.length-hn.triangleArrayOffset,this.polygonSegments.push(hn),++le.footprintSegLen,++le.polygonSegLen}if(le.vertexCount=this.layoutVertexArray.length-le.vertexArrayOffset,le.groundVertexCount=this.groundEffect.vertexArray.length-le.groundVertexArrayOffset,le.vertexCount!==0){if(le.centroidXY=ae.borders?u7:this.encodeCentroid(ae,le),this.centroidData.push(le),ae.borders){this.featuresOnBorder.push(ae);const _t=this.featuresOnBorder.length-1;for(let Xt=0;Xt<ae.borders.length;Xt++)ae.borders[Xt][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Xt].push(_t)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,p,b,T,_,M,void 0,this.worldview),this.groundEffect.addPaintPropertiesData(c,p,b,T,_,M,this.worldview),this.maxHeight=Math.max(this.maxHeight,Se)}}sortBorders(){for(let s=0;s<this.borderFeatureIndices.length;s++)this.borderFeatureIndices[s].sort((c,f)=>this.featuresOnBorder[c].borders[s][0]-this.featuresOnBorder[f].borders[s][0])}splitToSubtiles(){const s=[];for(let T=0;T<this.centroidData.length;T++){const I=this.centroidData[T],M=+(I.min.y+I.max.y>yn),O=2*M+(+(I.min.x+I.max.x>yn)^M);for(let z=0;z<I.polygonSegLen;z++){const q=I.polygonSegIdx+z;s.push({centroidIdx:T,subtile:O,polygonSegmentIdx:q,triangleSegmentIdx:this.polygonSegments[q].triangleSegIdx})}}const c=new vo;s.sort((T,I)=>T.triangleSegmentIdx===I.triangleSegmentIdx?T.subtile-I.subtile:T.triangleSegmentIdx-I.triangleSegmentIdx);let f=0,p=0,_=0;for(const T of s){if(T.triangleSegmentIdx!==f)break;_++}const b=s.length;for(;p!==s.length;){f=s[p].triangleSegmentIdx;let T=0,I=p,M=p;for(let O=I;O<_&&s[O].subtile===T;O++)M++;for(;I!==_;){const O=s[I];T=O.subtile;const z=this.centroidData[O.centroidIdx].min.clone(),q=this.centroidData[O.centroidIdx].max.clone(),K={vertexOffset:this.segments.segments[f].vertexOffset,primitiveOffset:c.length,vertexLength:this.segments.segments[f].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let Y=I;Y<M;Y++){const ae=s[Y],le=this.polygonSegments[ae.polygonSegmentIdx],ce=this.centroidData[ae.centroidIdx].min,Se=this.centroidData[ae.centroidIdx].max,Ae=this.indexArray.uint16;for(let Ee=le.triangleArrayOffset;Ee<le.triangleArrayOffset+le.triangleCount;Ee++)c.emplaceBack(Ae[3*Ee],Ae[3*Ee+1],Ae[3*Ee+2]);K.primitiveLength+=le.triangleCount,z.x=Math.min(z.x,ce.x),z.y=Math.min(z.y,ce.y),q.x=Math.max(q.x,Se.x),q.y=Math.max(q.y,Se.y)}K.primitiveLength>0&&this.triangleSubSegments.push({segment:K,min:z,max:q}),I=M;for(let Y=I;Y<_&&s[Y].subtile===s[I].subtile;Y++)M++}p=_;for(let O=p;O<b&&s[O].triangleSegmentIdx===s[p].triangleSegmentIdx;O++)_++}c._trim(),this.indexArray=c}getVisibleSegments(s,c,f){const p=new Qs;if(this.wallMode){for(const ae of this.triangleSubSegments)p.segments.push(ae.segment);return p}let _=0,b=0;const T=1<<s.canonical.z;if(c){const ae=c.getMinMaxForTile(s);ae&&(_=ae.min,b=ae.max)}b+=this.maxHeight;const I=s.toUnwrapped();let M;const O=[I.canonical.x/T+I.wrap,I.canonical.y/T],z=[(I.canonical.x+1)/T+I.wrap,(I.canonical.y+1)/T],q=(ae,le,ce)=>[ae[0]*(1-ce[0])+le[0]*ce[0],ae[1]*(1-ce[1])+le[1]*ce[1]],K=[],Y=[];for(const ae of this.triangleSubSegments){K[0]=ae.min.x/yn,K[1]=ae.min.y/yn,Y[0]=ae.max.x/yn,Y[1]=ae.max.y/yn;const le=q(O,z,K),ce=q(O,z,Y);if(new gr([le[0],le[1],_],[ce[0],ce[1],b]).intersectsPrecise(f)===0){M&&(p.segments.push(M),M=void 0);continue}const Se=ae.segment;M&&M.vertexOffset!==Se.vertexOffset&&(p.segments.push(M),M=void 0),M?(M.vertexLength+=Se.vertexLength,M.primitiveLength+=Se.primitiveLength):M={vertexOffset:Se.vertexOffset,primitiveLength:Se.primitiveLength,vertexLength:Se.vertexLength,primitiveOffset:Se.primitiveOffset,sortKey:void 0,vaos:{}}}return M&&p.segments.push(M),p}encodeCentroid(s,c){const f=s.centroid(),p=c.span(),_=Math.min(7,Math.round(p.x*this.tileToMeter/10)),b=Math.min(7,Math.round(p.y*this.tileToMeter/10));return new zt(We(f.x,1,yn-1)<<3|_,We(f.y,1,yn-1)<<3|b)}encodeBorderCentroid(s){if(!s.borders)return new zt(0,0);const c=s.borders,f=Number.MAX_VALUE;if(c[0][0]!==f||c[1][0]!==f){const p=c[0][0]!==f?0:1;return new zt(6|(c[0][0]!==f?0:65528),(c[p][0]+c[p][1])/2<<3|6)}{const p=c[2][0]!==f?2:3;return new zt((c[p][0]+c[p][1])/2<<3|6,6|(c[2][0]!==f?0:65528))}}showCentroid(s){const c=this.centroidData[s.centroidDataIndex];c.flags&=2147483647,c.centroidXY.x=0,c.centroidXY.y=0,this.writeCentroidToBuffer(c)}writeCentroidToBuffer(s){this.groundEffect.updateHiddenByLandmark(s);const c=s.vertexArrayOffset,f=s.vertexCount+s.vertexArrayOffset,p=s.flags&n0?u7:s.centroidXY,_=this.centroidVertexArray.geta_centroid_pos0(c);if(this.centroidVertexArray.geta_centroid_pos1(c)!==p.y||_!==p.x){for(let b=c;b<f;++b)this.centroidVertexArray.emplace(b,p.x,p.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const s of this.centroidData)this.writeCentroidToBuffer(s)}updateReplacement(s,c,f){if(c.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=c.updateTime;const p=c.getReplacementRegionsForTile(s.toUnwrapped());if(zT(this.activeReplacements,p))return;if(this.activeReplacements=p,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const b of this.centroidData)b.flags&=2147483647;const _=[];for(const b of this.activeReplacements){if(b.order<f)continue;const T=Math.max(1,Math.pow(2,b.footprintTileId.canonical.z-s.canonical.z));if(b.footprint.buildingId){const I=b.footprint.buildingId;for(const M of this.centroidData)M.buildingId===I&&(M.flags|=n0)}else for(const I of this.centroidData)if(!(I.flags&n0||b.min.x>I.max.x||I.min.x>b.max.x||b.min.y>I.max.y||I.min.y>b.max.y))for(let M=0;M<I.footprintSegLen;M++){const O=this.footprintSegments[I.footprintSegIdx+M];if(_.length=0,Cpe(this.footprintVertices,O.vertexOffset,O.vertexCount,b.footprintTileId.canonical,s.canonical,_),$N(b.footprint,_,this.footprintIndices.uint16,O.indexOffset,O.indexCount,-O.vertexOffset,-T)){I.flags|=n0;break}}}for(const b of this.centroidData)this.writeCentroidToBuffer(b);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(s,c,f){let p=!1;for(let _=0;_<f.footprintSegLen;_++){const b=this.footprintSegments[f.footprintSegIdx+_];let T=0;for(const I of b.ringIndices){for(let M=T,O=I+T-1;M<I+T;O=M++){const z=this.footprintVertices.int16[2*(M+b.vertexOffset)+0],q=this.footprintVertices.int16[2*(M+b.vertexOffset)+1],K=this.footprintVertices.int16[2*(O+b.vertexOffset)+1];q>c!=K>c&&s<(this.footprintVertices.int16[2*(O+b.vertexOffset)+0]-z)*(c-q)/(K-q)+z&&(p=!p)}T=I}}return p}getHeightAtTileCoord(s,c){let f=Number.NEGATIVE_INFINITY,p=!0;const _=4*(s+yn)*yn+(c+yn);if(this.partLookup.hasOwnProperty(_)){const b=this.partLookup[_];return b?{height:b.height,hidden:!!(b.flags&n0)}:void 0}for(const b of this.centroidData)s>b.max.x||b.min.x>s||c>b.max.y||b.min.y>c||b.height<=f||this.footprintContainsPoint(s,c,b)&&(f=b.height,this.partLookup[_]=b,p=!!(b.flags&n0));if(f!==Number.NEGATIVE_INFINITY)return{height:f,hidden:p};this.partLookup[_]=void 0}}function m7(u,s){const c=u.add(s)._unit();return u.x*c.x+u.y*c.y}function Tpe(u,s,c,f){const p=s.sub(u)._perp()._unit(),_=c.sub(s)._perp()._unit();return g7(u,s,c,m7(p,_),f)}function g7(u,s,c,f,p){const _=Math.sqrt(1-f*f);return Math.min(u.dist(s)/3,s.dist(c)/3,p*_/f)}function ZN(u,s,c){return u.x<c[0].x&&s.x<c[0].x||u.x>c[1].x&&s.x>c[1].x||u.y<c[0].y&&s.y<c[0].y||u.y>c[1].y&&s.y>c[1].y}function y7(u,s){return u.x<s[0].x||u.x>s[1].x||u.y<s[0].y||u.y>s[1].y}function v7(u,s,c){if(u.x<0||u.x>=yn||s.x<0||s.x>=yn||c.x<0||c.x>=yn)return!1;const f=c.sub(s),p=f.perp(),_=u.sub(s);return(f.x*_.x+f.y*_.y)/Math.sqrt((f.x*f.x+f.y*f.y)*(_.x*_.x+_.y*_.y))>-.866&&p.x*_.x+p.y*_.y<0}function _7(u,s,c){const f=s?2|u:-3&u;return c?1|f:-2&f}function x7(){const u=Math.PI/32,s=Math.tan(u),c=te;return c*Math.sqrt(1+2*s*s)-c}function b7(u,s,c){const f=1<<c.z,p=Ve(c.x/f),_=Ve((c.x+1)/f),b=ze(c.y/f),T=ze((c.y+1)/f);return function(I,M,O,z,q=0,K){const Y=[];if(!I.length||!O||!z)return Y;const ae=(Ke,tt)=>{for(const at of Ke)Y.push({polygon:at,bounds:tt})},le=Math.ceil(Math.log2(O)),ce=Math.ceil(Math.log2(z)),Se=le-ce,Ae=[];for(let Ke=0;Ke<Math.abs(Se);Ke++)Ae.push(Se>0?0:1);for(let Ke=0;Ke<Math.min(le,ce);Ke++)Ae.push(0),Ae.push(1);let Ee=I;if(Ee=jT(Ee,M[0].y-q,M[1].y+q,1),Ee=jT(Ee,M[0].x-q,M[1].x+q,0),!Ee.length)return Y;const Ze=[];for(Ae.length?Ze.push({polygons:Ee,bounds:M,depth:0}):ae(Ee,M);Ze.length;){const Ke=Ze.pop(),tt=Ke.depth,at=Ae[tt],ct=Ke.bounds[0],qt=Ke.bounds[1],_t=at===0?ct.x:ct.y,Xt=at===0?qt.x:qt.y,an=K?K(at,_t,Xt):.5*(_t+Xt),Jt=jT(Ke.polygons,_t-q,an+q,at),en=jT(Ke.polygons,an-q,Xt+q,at);if(Jt.length){const hn=[ct,new zt(at===0?an:qt.x,at===1?an:qt.y)];Ae.length>tt+1?Ze.push({polygons:Jt,bounds:hn,depth:tt+1}):ae(Jt,hn)}if(en.length){const hn=[new zt(at===0?an:ct.x,at===1?an:ct.y),qt];Ae.length>tt+1?Ze.push({polygons:en,bounds:hn,depth:tt+1}):ae(en,hn)}}return Y}(u,s,Math.ceil((_-p)/11.25),Math.ceil((b-T)/11.25),1,(I,M,O)=>{if(I===0)return .5*(M+O);{const z=ze((c.y+M/yn)/f);return(Ue(.5*(ze((c.y+O/yn)/f)+z))*f-c.y)*yn}})}function Cpe(u,s,c,f,p,_){const b=Math.pow(2,f.z-p.z);for(let T=0;T<c;T++){let I=u.int16[2*(T+s)+0],M=u.int16[2*(T+s)+1];I=(I+p.x*yn)*b-f.x*yn,M=(M+p.y*yn)*b-f.y*yn,_.push(new zt(I,M))}}let w7,S7;Pn(UT,"FillExtrusionBucket",{omit:["layers","features"]}),Pn(h7,"PartData"),Pn(d7,"FootprintSegment"),Pn(f7,"BorderCentroidData"),Pn(WN,"GroundEffect");class l_ extends zt{constructor(s,c,f){super(s,c),this.z=f}}class A7 extends l_{constructor(s,c,f,p){super(s,c,f),this.w=p}}function T7(u,s,c,f){const p=c==="x"?"y":"x",_=(f-u[c])/(s[c]-u[c]);u[p]=Math.round(u[p]+(s[p]-u[p])*_),u[c]=f,u.hasOwnProperty("z")&&(u.z=qe(u.z,s.z,_)),u.hasOwnProperty("w")&&(u.w=qe(u.w,s.w,_))}function C7(u,s,c,f){const p=c,_=f;for(const b of["x","y"]){let T=u,I=s;T[b]>=I[b]&&(T=s,I=u),T[b]<p&&I[b]>p&&T7(T,I,b,p),T[b]<_&&I[b]>_&&T7(I,T,b,_)}}function VT(u,s,c,f,p,_){const b=[];for(let T=0;T<u.length;T++){const I=u[T];let M;const O=b.length;let z=0;for(let q=0;q<I.length-1;q++){let K=I[q],Y=I[q+1],ae=0;const le=z;let ce,Se;_&&(ae=Math.hypot(Y.x-K.x,Y.y-K.y),z+=ae,ce=K,Se=Y),K.x<s&&Y.x<s||(K.x<s?K=new zt(s,K.y+(s-K.x)/(Y.x-K.x)*(Y.y-K.y))._round():Y.x<s&&(Y=new zt(s,K.y+(s-K.x)/(Y.x-K.x)*(Y.y-K.y))._round()),K.y<c&&Y.y<c||(K.y<c?K=new zt(K.x+(c-K.y)/(Y.y-K.y)*(Y.x-K.x),c)._round():Y.y<c&&(Y=new zt(K.x+(c-K.y)/(Y.y-K.y)*(Y.x-K.x),c)._round()),K.x>=f&&Y.x>=f||(K.x>=f?K=new zt(f,K.y+(f-K.x)/(Y.x-K.x)*(Y.y-K.y))._round():Y.x>=f&&(Y=new zt(f,K.y+(f-K.x)/(Y.x-K.x)*(Y.y-K.y))._round()),K.y>=p&&Y.y>=p||(K.y>=p?K=new zt(K.x+(p-K.y)/(Y.y-K.y)*(Y.x-K.x),p)._round():Y.y>=p&&(Y=new zt(K.x+(p-K.y)/(Y.y-K.y)*(Y.x-K.x),p)._round()),M&&K.equals(M[M.length-1])||(M=[K],b.push(M),_&&_.push({progress:{min:le+E7(ce,Se,K)*ae,max:1},parentIndex:T,prevPoint:ce,nextPoint:Se})),M.push(Y),_&&(_[_.length-1].progress.max=le+E7(ce,Se,Y)*ae,_[_.length-1].nextPoint=Se)))))}if(_&&z>0)for(let q=O;q<b.length;q++)_[q].progress.min/=z,_[q].progress.max/=z}return b}function Epe(u,s,c,f,p){if(u.length<2)return void f.push(u);const _=[];for(;s.valid();){const[M,O]=s.get();for(let z=0;z<u.length-1;z++){const q=u[z],K=u[z+1],Y=ga(q,K,M,O);if(Y){const[ae]=Y,le=new zt(qe(q.x,K.x,ae),qe(q.y,K.y,ae));_.push({t:z+ae,distance:0,point:le})}}s.next()}if(_.length===0)return void f.push(u);_.sort((M,O)=>M.t-O.t);let b=0,T=0,I=[];for(f.push(I);b!==u.length;){if(T===_.length){for(;b!==u.length;)I.length!==0&&I[I.length-1].equals(u[b])||I.push(u[b]),b++;break}_[T].t<=b?(I.length!==0&&I[I.length-1].equals(_[T].point)||I.push(_[T].point),Math.trunc(_[T].t),T++):(I.length!==0&&I[I.length-1].equals(u[b])||I.push(u[b]),b++)}}function E7(u,s,c){return u.x!==s.x?(c.x-u.x)/(s.x-u.x):u.y!==s.y?(c.y-u.y)/(s.y-u.y):0}function T2(u,s){return u.x*s.x+u.y*s.y}function P7(u,s){if(u.length===1){let c=0;const f=s[c++];let p;for(;!p||f.equals(p);)if(p=s[c++],!p)return 1/0;for(;c<s.length;c++){const _=s[c],b=u[0],T=p.sub(f),I=_.sub(f),M=b.sub(f),O=T2(T,T),z=T2(T,I),q=T2(I,I),K=T2(M,T),Y=T2(M,I),ae=O*q-z*z,le=(q*K-z*Y)/ae,ce=(O*Y-z*K)/ae,Se=f.z*(1-le-ce)+p.z*le+_.z*ce;if(isFinite(Se))return Se}return 1/0}{let c=1/0;for(const f of s)c=Math.min(c,f.z);return c}}function k7(u,s,c,f,p,_,b,T){const I=b*p.getElevationAt(u,s,!0,!0),M=_[0]!==0,O=M?_[1]===0?b*(_[0]/7-450):b*function(z,q,K){const Y=Math.floor(q[0]/8),ae=Math.floor(q[1]/8),le=10*(q[0]-8*Y),ce=10*(q[1]-8*ae),Se=z.getElevationAt(Y,ae,!0,!0),Ae=z.getMeterToDEM(K),Ee=Math.floor(.5*(le*Ae-1)),Ze=Math.floor(.5*(ce*Ae-1)),Ke=z.tileCoordToPixel(Y,ae),tt=2*Ee+1,at=2*Ze+1,ct=function(en,hn,Vt,nn,Lt){return[en.getElevationAtPixel(hn,Vt,!0),en.getElevationAtPixel(hn+Lt,Vt,!0),en.getElevationAtPixel(hn,Vt+Lt,!0),en.getElevationAtPixel(hn+nn,Vt+Lt,!0)]}(z,Ke.x-Ee,Ke.y-Ze,tt,at),qt=Math.abs(ct[0]-ct[1]),_t=Math.abs(ct[2]-ct[3]),Xt=Math.abs(ct[0]-ct[2])+Math.abs(ct[1]-ct[3]),an=Math.min(.25,.5*Ae*(qt+_t)/tt),Jt=Math.min(.25,.5*Ae*Xt/at);return Se+Math.max(an*le,Jt*ce)}(p,_,T):I;return{base:I+(c===0?-1:c),top:M?Math.max(O+f,I+c+2):I+f}}class Ppe{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class kpe{constructor(){this.tasks={},this.taskQueue=[],ar(["process"],this),this.invoker=new Ppe(this.process),this.nextId=0}add(s,c){const f=this.nextId++,p=function({type:_,isSymbolTile:b,zoom:T}){return T=T||0,_==="message"?0:_!=="maybePrepare"||b?_!=="parseTile"||b?_==="parseTile"&&b?300-T:_==="maybePrepare"&&b?400-T:500:200-T:100-T}(c);if(p===0){try{s()}finally{}return null}return this.tasks[f]={fn:s,metadata:c,priority:p,id:f},this.taskQueue.push(f),this.invoker.trigger(),{cancel:()=>{delete this.tasks[f]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(f=>!!this.tasks[f]),!this.taskQueue.length)return;const s=this.pick();if(s===null)return;const c=this.tasks[s];if(delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),!c)return;c.fn()}finally{}}pick(){let s=null,c=1/0;for(let p=0;p<this.taskQueue.length;p++){const _=this.tasks[this.taskQueue[p]];_.priority<c&&(c=_.priority,s=p)}if(s===null)return null;const f=this.taskQueue[s];return this.taskQueue.splice(s,1),f}remove(){this.invoker.remove()}}class I7{constructor(s,c,f){this.target=s,this.parent=c,this.mapId=f,this.callbacks={},this.cancelCallbacks={},ar(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new kpe}send(s,c,f,p,_=!1,b){const T=Math.round(1e18*Math.random()).toString(36).substring(0,10);f&&(f.metadata=b,this.callbacks[T]=f);const I=new Set;return this.target.postMessage({id:T,type:s,hasCallback:!!f,targetMapId:p,mustQueue:_,sourceMapId:this.mapId,data:No(c,I)},I),{cancel:()=>{f&&delete this.callbacks[T],this.target.postMessage({id:T,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(s){const c=s.data;if(!c)return;const f=c.id;if(f&&(!c.targetMapId||this.mapId===c.targetMapId))if(c.type==="<cancel>"){const p=this.cancelCallbacks[f];delete this.cancelCallbacks[f],p&&p.cancel()}else if(c.mustQueue||Wi(self)){const p=this.callbacks[f],_=this.scheduler.add(()=>this.processTask(f,c),p&&p.metadata||{type:"message"});_&&(this.cancelCallbacks[f]=_)}else this.processTask(f,c)}processTask(s,c){if(delete this.cancelCallbacks[s],c.type==="<response>"){const f=this.callbacks[s];delete this.callbacks[s],f&&(c.error?f(yo(c.error)):f(null,yo(c.data)))}else{const f=new Set,p=c.hasCallback?(b,T)=>{this.target.postMessage({id:s,type:"<response>",sourceMapId:this.mapId,error:b?No(b):null,data:No(T,f)},f)}:()=>{},_=yo(c.data);if(this.parent[c.type])this.parent[c.type](c.sourceMapId,_,p);else if(this.parent.getWorkerSource){const b=c.type.split("."),{source:T,scope:I}=_;this.parent.getWorkerSource(c.sourceMapId,b[0],T,I)[b[1]](_,p)}else p(new Error(`Could not find function ${c.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var C2={workerUrl:"",workerClass:null,workerParams:void 0};const KN="mapboxgl_preloaded_worker_pool";class c_{constructor(){this.active={}}acquire(s,c=c_.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<c;)this.workers.push(C2.workerClass!=null?new C2.workerClass:new self.Worker(C2.workerUrl,C2.workerParams));return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],this.workers&&this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[KN]}numActive(){return Object.keys(this.active).length}}c_.workerCount=2;class c1{constructor(s,c,f="Worker",p=c_.workerCount){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=Yt();const _=this.workerPool.acquire(this.id,p);for(let b=0;b<_.length;b++){const T=new c1.Actor(_[b],c,this.id);T.name=`${f} ${b}`,this.actors.push(T)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(s,c,f){Et(this.actors,(p,_)=>{p.send(s,c,_)},f=f||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(s=>{s.remove()}),this.actors=[],this.workerPool.release(this.id)}}let E2,YN;function $T(){return E2||(E2=new c_),E2}c1.Actor=I7;class Ipe{constructor(s){this.module=s}createIntArray(s){const c=new Int32Array(s),f=this.module.malloc(c.length*c.BYTES_PER_ELEMENT);return this.module.heap32.set(c,f/c.BYTES_PER_ELEMENT),f}createFloatArray(s){const c=new Float32Array(s),f=this.module.malloc(c.length*c.BYTES_PER_ELEMENT);return this.module.heapF32.set(c,f/c.BYTES_PER_ELEMENT),f}createStringBuffer(s){const c=this.module.malloc(s.length+1);for(let f=0;f<s.length;++f)this.module.heapU8[c+f]=s.charCodeAt(f);return this.module.heapU8[c+s.length]=0,c}readStringBuffer(s){let c="";for(;this.module.heapU8[s]!==0;)c+=String.fromCharCode(this.module.heapU8[s]),++s;return c}setStyle(s){const c=s.entranceColorRgb,f=s.facadeGlazingColorRgb,p=s.roofColorRgb,_=s.wallColorRgb,b=s.normalScale;this.module.setStyle(c[0],c[1],c[2],f[0],f[1],f[2],p[0],p[1],p[2],_[0],_[1],_[2],b[0],b[1],b[2],s.tileToMeters)}setAOOptions(s,c){this.module.setAOOptions(s?1:0,c)}setMetricOptions(s,c){this.module.setMetricOptions(s?1:0,c)}setStructuralOptions(s){this.module.setStructuralOptions(s?1:0)}setFacadeOptions(s,c){this.module.setFacadeOptions(s,c?1:0)}setFauxFacadeOptions(s,c,f){this.module.setFauxFacadeOptions(s?1:0,c?1:0,f)}setFacadeClassifierOptions(s){this.module.setFacadeClassifierOptions(s)}generateMesh(s,c){for(const T of s){const I=this.createStringBuffer(T.roofType),M=[0],O=[];for(const K of T.coordinates)if(Array.isArray(K)){for(const Y of K)O.push(Y.x),O.push(Y.y);M.push(O.length)}const z=this.createIntArray(M),q=this.createFloatArray(O);this.module.addFeature(T.id,T.sourceId,T.minHeight,T.height,I,T.roofType.length,q,z,M.length-1),this.module.free(I),this.module.free(z),this.module.free(q)}for(const T of c){let I;I=T.entrances?JSON.parse(T.entrances):[];const M=this.createFloatArray(I),O=[];for(const q of T.coordinates)O.push(q.x),O.push(q.y);const z=this.createFloatArray(O);this.module.addFacade(T.sourceId,T.crossPerc,T.distanceToRoad,M,I.length,z,O.length),this.module.free(M),this.module.free(z)}if(!this.module.generateMesh()){const T=this.module.getLastError();return this.readStringBuffer(T)}const f=this.module.getMeshCount(),p=new Array(f);for(let T=0;T<f;T++){const I=this.module.getPositionsPtr(T),M=this.module.getPositionsLength(T),O=new Float32Array(this.module.heapF32.buffer,I,M),z=this.module.getNormalsPtr(T),q=this.module.getNormalsLength(T),K=new Float32Array(this.module.heapF32.buffer,z,q),Y=this.module.getColorsPtr(T),ae=this.module.getColorsLength(T),le=new Uint8Array(this.module.heapU8.buffer,Y,ae),ce=this.module.getAOPtr(T),Se=this.module.getAOLength(T),Ae=new Float32Array(this.module.heapF32.buffer,ce,Se),Ee=this.module.getUVPtr(T),Ze=this.module.getUVLength(T),Ke=new Float32Array(this.module.heapF32.buffer,Ee,Ze),tt=this.module.getFauxFacadePtr(T),at=this.module.getFauxFacadeLength(T),ct=new Uint8Array(this.module.heapU8.buffer,tt,at),qt=this.module.getIndicesPtr(T),_t=this.module.getIndicesLength(T),Xt=new Int32Array(this.module.heap32.buffer,qt,_t),an=this.module.getBuildingPart(T),Jt=this.readStringBuffer(an);p[T]={positions:O,normals:K,colors:le,ao:Ae,uv:Ke,isFauxFacade:ct,indices:Xt,buildingPart:Jt}}const _=this.module.getRingCount(),b=[];for(let T=0;T<_;T++){const I=this.module.getRingPtr(T),M=this.module.getRingLength(T),O=new Float32Array(this.module.heapF32.buffer,I,M);b.push(O)}return{meshes:p,outerRingLength:this.module.getOuterRingLength(),modifiedPolygonRings:b}}}let P2,XN,ep,u1,JN,d1=null,h1=null,N7=null,qT=null;function M7(){return Wi(self)&&self.worker.dracoUrl?self.worker.dracoUrl:XN||$o.DRACO_URL}function L7(){if(Wi(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(u1)return u1;const u=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return u1=WebAssembly.validate(u)?$o.MESHOPT_SIMD_URL:$o.MESHOPT_URL,u1}function Npe(){return qT}const GT={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Mpe={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},k2={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function D7(u,s,c){const f=c.json.bufferViews.length,p=c.buffers.length;s.bufferView=f,c.json.bufferViews[f]={buffer:p,byteLength:u.byteLength},c.buffers[p]=u}const QN="KHR_draco_mesh_compression";function Lpe(u,s){const c=u.extensions&&u.extensions[QN];if(!c)return;const f=new ep.Decoder,p=F7(s,c.bufferView),_=new ep.Mesh;if(!f.DecodeArrayToMesh(p,p.byteLength,_))throw new Error("Failed to decode Draco mesh");const b=s.json.accessors[u.indices],T=GT[b.componentType],I=b.count*T.BYTES_PER_ELEMENT,M=ep._malloc(I);T===Uint16Array?f.GetTrianglesUInt16Array(_,I,M):f.GetTrianglesUInt32Array(_,I,M),D7(ep.memory.buffer.slice(M,M+I),b,s),ep._free(M);for(const O of Object.keys(c.attributes)){const z=f.GetAttributeByUniqueId(_,c.attributes[O]),q=s.json.accessors[u.attributes[O]],K=Mpe[q.componentType],Y=q.count*k2[q.type]*GT[q.componentType].BYTES_PER_ELEMENT,ae=ep._malloc(Y);f.GetAttributeDataArrayForAllPoints(_,z,ep[K],Y,ae),D7(ep.memory.buffer.slice(ae,ae+Y),q,s),ep._free(ae)}f.destroy(),_.destroy(),delete u.extensions[QN]}const HT="EXT_meshopt_compression";function Dpe(u,s){if(!u.extensions||!u.extensions[HT])return;const c=u.extensions[HT],f=new Uint8Array(s.buffers[c.buffer],c.byteOffset||0,c.byteLength||0),p=new Uint8Array(c.count*c.byteStride);JN.decodeGltfBuffer(p,c.count,c.byteStride,f,c.mode,c.filter),u.buffer=s.buffers.length,u.byteOffset=0,s.buffers[u.buffer]=p.buffer,delete u.extensions[HT]}const R7=1179937895,j7=new TextDecoder("utf8");function O7(u,s){return new URL(u,s).href}function Rpe(u,s,c,f){return fetch(O7(u.uri,f)).then(p=>p.arrayBuffer()).then(p=>{s.buffers[c]=p})}function F7(u,s){const c=u.json.bufferViews[s];return new Uint8Array(u.buffers[c.buffer],c.byteOffset||0,c.byteLength)}function jpe(u,s,c,f){if(u.uri){const p=O7(u.uri,f);return fetch(p).then(_=>_.blob()).then(_=>createImageBitmap(_)).then(_=>{s.images[c]=_})}if(u.bufferView!==void 0){const p=F7(s,u.bufferView),_=new Blob([p],{type:u.mimeType});return createImageBitmap(_).then(b=>{s.images[c]=b})}}function z7(u,s=0,c){const f={json:null,images:[],buffers:[]};if(new Uint32Array(u,s,1)[0]===R7){const O=new Uint32Array(u,s);let z=2;const q=(O[z++]>>2)-3,K=O[z++]>>2;if(z++,f.json=JSON.parse(j7.decode(O.subarray(z,z+K))),z+=K,z<q){const Y=O[z++];z++;const ae=s+(z<<2);f.buffers[0]=u.slice(ae,ae+Y)}}else f.json=JSON.parse(j7.decode(new Uint8Array(u,s)));const{buffers:p,images:_,meshes:b,extensionsUsed:T,bufferViews:I}=f.json;let M=Promise.resolve();if(p){const O=[];for(let z=0;z<p.length;z++){const q=p[z];q.uri?O.push(Rpe(q,f,z,c)):f.buffers[z]||(f.buffers[z]=null)}M=Promise.all(O)}return M.then(()=>{const O=[],z=T&&T.includes(QN),q=T&&T.includes(HT);if(z&&O.push(function(){if(!ep)return P2??(P2=function(K){let Y,ae=null;function le(){Y=new Uint8Array(ae.buffer)}function ce(){throw new Error("Unexpected Draco error.")}const Se={a:{a:ce,d:function(Ae,Ee,Ze){return Y.copyWithin(Ae,Ee,Ee+Ze)},c:function(Ae){const Ee=Y.length,Ze=Math.max(Ae>>>0,Math.ceil(1.2*Ee)),Ke=Math.ceil((Ze-Ee)/65536);try{return ae.grow(Ke),le(),!0}catch{return!1}},b:ce}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(K,Se):K.then(Ae=>Ae.arrayBuffer()).then(Ae=>WebAssembly.instantiate(Ae,Se))).then(Ae=>{const{Rb:Ee,Qb:Ze,P:Ke,T:tt,X:at,Ja:ct,La:qt,Qa:_t,Va:Xt,Wa:an,eb:Jt,jb:en,f:hn,e:Vt,yb:nn,zb:Lt,Ab:It,Bb:fn,Db:cn,Gb:tr}=Ae.instance.exports;ae=Vt;const Fn=(()=>{let qn=0,vn=0,er=0,Ir=0;return En=>{er&&(Ee(Ir),Ee(qn),vn+=er,er=qn=0),qn||(vn+=128,qn=Ze(vn));const Yn=En.length+7&-8;let pr=qn;Yn>=vn&&(er=Yn,pr=Ir=Ze(Yn));for(let Lr=0;Lr<En.length;Lr++)Y[pr+Lr]=En[Lr];return pr}})();return le(),hn(),{memory:Vt,_free:Ee,_malloc:Ze,Mesh:class{constructor(){this.ptr=Ke()}destroy(){tt(this.ptr)}},Decoder:class{constructor(){this.ptr=ct()}destroy(){en(this.ptr)}DecodeArrayToMesh(qn,vn,er){const Ir=Fn(qn),En=qt(this.ptr,Ir,vn,er.ptr);return!!at(En)}GetAttributeByUniqueId(qn,vn){return{ptr:_t(this.ptr,qn.ptr,vn)}}GetTrianglesUInt16Array(qn,vn,er){Xt(this.ptr,qn.ptr,vn,er)}GetTrianglesUInt32Array(qn,vn,er){an(this.ptr,qn.ptr,vn,er)}GetAttributeDataArrayForAllPoints(qn,vn,er,Ir,En){Jt(this.ptr,qn.ptr,vn.ptr,er,Ir,En)}},DT_INT8:nn(),DT_UINT8:Lt(),DT_INT16:It(),DT_UINT16:fn(),DT_UINT32:cn(),DT_FLOAT32:tr()}})}(fetch(M7())),P2.then(K=>{ep=K,P2=void 0}))}()),q&&O.push(function(){if(JN)return;const K=function(Y){let ae;const le=WebAssembly.instantiateStreaming(Y,{}).then(Ae=>{ae=Ae.instance,ae.exports.__wasm_call_ctors()}),ce={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},Se={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:le,supported:!0,decodeGltfBuffer(Ae,Ee,Ze,Ke,tt,at){(function(ct,qt,_t,Xt,an,Jt,en){const hn=ct.exports.sbrk,Vt=Xt+3&-4,nn=hn(Vt*an),Lt=hn(Jt.length),It=new Uint8Array(ct.exports.memory.buffer);It.set(Jt,Lt);const fn=qt(nn,Xt,an,Lt,Jt.length);if(fn===0&&en&&en(nn,Vt,an),_t.set(It.subarray(nn,nn+Xt*an)),hn(nn-hn(0)),fn!==0)throw new Error(`Malformed buffer data: ${fn}`)})(ae,ae.exports[Se[tt]],Ae,Ee,Ze,Ke,ae.exports[ce[at]])}}}(fetch(L7()));return K.ready.then(()=>{JN=K})}()),_)for(let K=0;K<_.length;K++)O.push(jpe(_[K],f,K,c));return(O.length?Promise.all(O):Promise.resolve()).then(()=>{if(z&&b)for(const{primitives:K}of b)for(const Y of K)Lpe(Y,f);if(q&&b&&I)for(const K of I)Dpe(K,f);return f})})}function eM(u){switch(u){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function tM(u){switch(u){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class nM{constructor(s,c,f,p){this.context=s,this.format=f,this.useMipmap=p&&p.useMipmap,this.texture=s.gl.createTexture(),this.update(c,{premultiply:p&&p.premultiply})}update(s,c){const f=s&&s instanceof HTMLVideoElement&&s.width===0?s.videoWidth:s.width,p=s&&s instanceof HTMLVideoElement&&s.height===0?s.videoHeight:s.height,{context:_}=this,{gl:b}=_,{x:T,y:I}=c&&c.position?c.position:{x:0,y:0},M=T+f,O=I+p;!this.size||this.size[0]===M&&this.size[1]===O||(b.bindTexture(b.TEXTURE_2D,null),b.deleteTexture(this.texture),this.texture=b.createTexture(),this.size=null),b.bindTexture(b.TEXTURE_2D,this.texture),_.pixelStoreUnpackFlipY.set(!1),_.pixelStoreUnpack.set(1),_.pixelStoreUnpackPremultiplyAlpha.set(this.format===b.RGBA8&&(!c||c.premultiply!==!1));const z=s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||ImageBitmap&&s instanceof ImageBitmap;if(!this.size&&M>0&&O>0){const q=this.useMipmap?Math.floor(Math.log2(Math.max(M,O)))+1:1;b.texStorage2D(b.TEXTURE_2D,q,this.format,M,O),this.size=[M,O]}this.size&&(z?b.texSubImage2D(b.TEXTURE_2D,0,T,I,eM(this.format),tM(this.format),s):"data"in s&&s.data&&b.texSubImage2D(b.TEXTURE_2D,0,T,I,f,p,eM(this.format),tM(this.format),s.data)),this.useMipmap&&b.generateMipmap(b.TEXTURE_2D)}bind(s,c,f=!1){const{context:p}=this,{gl:_}=p;_.bindTexture(_.TEXTURE_2D,this.texture),s!==this.minFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,s),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this.useMipmap&&!f?s===_.NEAREST?_.NEAREST_MIPMAP_NEAREST:_.LINEAR_MIPMAP_LINEAR:s),this.minFilter=s),c!==this.wrapS&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,c),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,c),this.wrapS=c)}bindExtraParam(s,c,f,p,_){const{context:b}=this,{gl:T}=b;T.bindTexture(T.TEXTURE_2D,this.texture),c!==this.magFilter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,c),this.magFilter=c),s!==this.minFilter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,this.useMipmap?s===T.NEAREST?T.NEAREST_MIPMAP_NEAREST:T.LINEAR_MIPMAP_LINEAR:s),this.minFilter=s),f!==this.wrapS&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,f),this.wrapS=f),p!==this.wrapT&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,p),this.wrapT=p),_!==this.compareMode&&(_?(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_COMPARE_MODE,T.COMPARE_REF_TO_TEXTURE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_COMPARE_FUNC,_)):T.texParameteri(T.TEXTURE_2D,T.TEXTURE_COMPARE_MODE,T.NONE),this.compareMode=_)}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}class I2{constructor(s,c){this.context=s,this.texture=c}bind(s,c){const{context:f}=this,{gl:p}=f;p.bindTexture(p.TEXTURE_2D,this.texture),s!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,s),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,s),this.minFilter=s),c!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,c),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,c),this.wrapS=c)}}const Ope=Ti([{name:"a_pos_3f",components:3,type:"Float32"}]),Fpe=Ti([{name:"a_color_3f",components:3,type:"Float32"}]),zpe=Ti([{name:"a_color_4f",components:4,type:"Float32"}]),Bpe=Ti([{name:"a_uv_2f",components:2,type:"Float32"}]),Upe=Ti([{name:"a_normal_3f",components:3,type:"Float32"}]),Vpe=Ti([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),$pe=Ti([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);function B7(u,s){const c=WT(u.projection,u.zoom,u.width,u.height),f=function(_,b,T,I,M){const O=new se(T.lng-180*r0,T.lat),z=new se(T.lng+180*r0,T.lat),q=_.project(O.lng,O.lat),K=_.project(z.lng,z.lat),Y=-Math.atan2(K.y-q.y,K.x-q.x),ae=Dt.fromLngLat(T);ae.y=We(ae.y,-1+r0,1-r0);const le=ae.toLngLat(),ce=_.project(le.lng,le.lat),Se=Dt.fromLngLat(le);Se.x+=r0;const Ae=Se.toLngLat(),Ee=_.project(Ae.lng,Ae.lat),Ze=V7(Ee.x-ce.x,Ee.y-ce.y,Y),Ke=Dt.fromLngLat(le);Ke.y+=r0;const tt=Ke.toLngLat(),at=_.project(tt.lng,tt.lat),ct=V7(at.x-ce.x,at.y-ce.y,Y),qt=Math.abs(Ze.x)/Math.abs(ct.y),_t=D([]);Q(_t,_t,-Y*(1-(M?0:I)));const Xt=D([]);return H(Xt,Xt,[1,1-(1-qt)*I,1]),Xt[4]=-ct.x/ct.y*I,Q(Xt,Xt,Y),F(Xt,_t,Xt),Xt}(u.projection,0,u.center,c,s),p=U7(u);return H(f,f,[p,p,1]),f}function U7(u){const s=u.projection,c=WT(u.projection,u.zoom,u.width,u.height),f=rM(s,u.center),p=rM(s,se.convert(s.center));return Math.pow(2,f*c+(1-c)*p)}function WT(u,s,c,f,p=1/0){const _=u.range;if(!_)return 0;const b=Math.min(p,Math.max(c,f)),T=Math.log2(b/1024);return kt(_[0]+T,_[1]+T,s)}const r0=1/4e4;function rM(u,s){const c=We(s.lat,-Ge,Ge),f=new se(s.lng-180*r0,c),p=new se(s.lng+180*r0,c),_=u.project(f.lng,c),b=u.project(p.lng,c),T=Dt.fromLngLat(f),I=Dt.fromLngLat(p),M=b.x-_.x,O=b.y-_.y,z=I.x-T.x,q=I.y-T.y,K=Math.sqrt((z*z+q*q)/(M*M+O*O));return Math.log2(K)}function V7(u,s,c){const f=Math.cos(c),p=Math.sin(c);return{x:u*f-s*p,y:u*p+s*f}}function $7(u,s,c){D(u),Q(u,u,lt(s[2])),J(u,u,lt(s[0])),ee(u,u,lt(s[1])),H(u,u,c),F(u,u,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function ZT(u,s,c,f,p,_,b,T){const I=[c[0]-s[0],c[1]-s[1],0],M=[f[0]-s[0],f[1]-s[1],0];if(Ce(I)<1e-12||Ce(M)<1e-12)return xn(u);const O=At([],I,M);gt(O,O),et(M,f,s),I[2]=(_-p)*T,M[2]=(b-p)*T;const z=I;return At(z,I,M),gt(z,z),Qr(u,O,z)}function iM(u,s,c=!1){const f=e0(s.zoom),p=function(_,b,T){const I=b.worldSize,M=[_[12],_[13],_[14]],O=ze(M[1]/I),z=Ve(M[0]/I),q=D([]),K=Fe(1,O)*I,Y=Fe(1,0)*I*ut(O,b.zoom),ae=1/MN(I);let le=Y*ae;if(T){const Ee=WT(b.projection,b.zoom,b.width,b.height,1024);le=ae*b.projection.pixelSpaceConversion(b.center.lat,I,Ee)}const ce=W(O,z);Qe(ce,ce,xt([],gt([],ce),K*le*M[2]));const Se=function(Ee){const Ze=[Ee[0],Ee[1],Ee[2]];let Ke=[0,1,0];const tt=At([],Ke,Ze);return At(Ke,Ze,tt),nt(Ke)===0&&(Ke=[0,1,0],At(tt,Ze,Ke)),gt(tt,tt),gt(Ke,Ke),gt(Ze,Ze),[tt[0],tt[1],tt[2],0,Ke[0],Ke[1],Ke[2],0,Ze[0],Ze[1],Ze[2],0,Ee[0],Ee[1],Ee[2],1]}(ce);H(q,q,[le,le,le*K]),$(q,q,[-M[0],-M[1],-M[2]]);const Ae=F([],b.globeMatrix,Se);return F(Ae,Ae,q),F(Ae,Ae,_),Ae}(u,s,c);if(f>0){const _=function(b,T){const I=T.worldSize,M=Fe(1,0)*I*ut(T.center.lat,T.zoom)/MN(I),O=Fe(1,T.center.lat)*I,z=D([]);ee(z,z,lt(T.center.lng)),J(z,z,lt(T.center.lat)),$(z,z,[0,0,m]),H(z,z,[M,M,M*O]);const q=T.point;return $(z,z,[-q.x,-q.y,0]),F(z,z,b),F(z,T.globeMatrix,z)}(u,s);return function(b,T,I){const M=(Y,ae,le)=>{const ce=Ce(Y),Se=Ce(ae),Ae=Sg(Y,ae,le);return xt(Ae,Ae,1/Ce(Ae)*qe(ce,Se,le))},O=M([b[0],b[1],b[2]],[T[0],T[1],T[2]],I),z=M([b[4],b[5],b[6]],[T[4],T[5],T[6]],I),q=M([b[8],b[9],b[10]],[T[8],T[9],T[10]],I),K=Sg([b[12],b[13],b[14]],[T[12],T[13],T[14]],I);return[O[0],O[1],O[2],0,z[0],z[1],z[2],0,q[0],q[1],q[2],0,K[0],K[1],K[2],1]}(p,_,f)}return p}function q7(u,s,c,f){const p=gr.projectAabbCorners(f,c);let _=Number.MAX_VALUE,b=-1;for(let M=0;M<p.length;++M){const O=p[M];O[0]=(.5*O[0]+.5)*s.width,O[1]=(.5-.5*O[1])*s.height,O[2]<_&&(b=M,_=O[2])}const T=M=>new zt(p[M][0],p[M][1]);let I;switch(b){case 0:case 6:I=[T(1),T(5),T(4),T(7),T(3),T(2),T(1)];break;case 1:case 7:I=[T(0),T(4),T(5),T(6),T(2),T(3),T(0)];break;case 3:case 5:I=[T(1),T(0),T(4),T(7),T(6),T(2),T(1)];break;default:I=[T(1),T(5),T(6),T(7),T(3),T(0),T(1)]}if(Uu(u,I))return _}const u_=64,f1={CoordinateSpaceTile:1,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function G7(u,s,c,f,p,_,b,T,I,M=!1){const O=c.zoom,z=c.project(f),q=ut(f.lat,O),K=1/q;D(u),$(u,u,[z.x+b[0]*K,z.y+b[1]*K,b[2]]);let Y=1,ae=1;const le=c.worldSize;if(M){if(c.projection.name==="mercator"){let Ee=0;c.elevation&&(Ee=c.elevation.getAtPointOrZero(new Dt(z.x/le,z.y/le),0));const Ze=wt([],[z.x,z.y,Ee,1],c.projMatrix)[3]/c.cameraToCenterDistance;Y=Ze,ae=Ze*ut(c.center.lat,O)}else if(c.projection.name==="globe"){const Ee=iM(u,c),Ze=[0,0,0,1];wt(Ze,Ze,F([],c.projMatrix,Ee));const Ke=Ze[3]/c.cameraToCenterDistance,tt=e0(O),at=c.projection.pixelsPerMeter(f.lat,le)*ut(f.lat,O),ct=c.projection.pixelsPerMeter(c.center.lat,le)*ut(c.center.lat,O);Y=Ke/qe(at,Tt(c.center.lat),tt),ae=Ke*q/at,Y*=ct,ae*=ct}}else Y=K;H(u,u,[Y,Y,ae]);const ce=[...u],Se=s.orientation,Ae=[];if($7(Ae,[Se[0]+p[0],Se[1]+p[1],Se[2]+p[2]],_),F(u,ce,Ae),T&&c.elevation){let Ee=0;const Ze=[];if(I&&c.elevation){Ee=function(tt,at,ct,qt,_t){const Xt=at.elevation;if(!Xt)return 0;const an=gr.projectAabbCorners(ct,qt),Jt=Fe(1,_t.lat)*at.worldSize,en=function(vn,er){const Ir=[0,0,1],En=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Yn of En){const pr=vn[Yn.corners[0]],Lr=vn[Yn.corners[1]],ii=vn[Yn.corners[2]],zr=[Lr[0]-pr[0],Lr[1]-pr[1],er*(Lr[2]-pr[2])],Bn=At(zr,zr,[ii[0]-pr[0],ii[1]-pr[1],er*(ii[2]-pr[2])]);gt(Bn,Bn),Yn.dotProductWithUp=dt(Bn,Ir)}return En.sort((Yn,pr)=>Yn.dotProductWithUp-pr.dotProductWithUp),En[0].corners}(an,Jt),hn=an[en[0]],Vt=an[en[1]],nn=an[en[2]],Lt=an[en[3]],It=Xt.getAtPointOrZero(new Dt(hn[0]/at.worldSize,hn[1]/at.worldSize),0),fn=Xt.getAtPointOrZero(new Dt(Vt[0]/at.worldSize,Vt[1]/at.worldSize),0),cn=Xt.getAtPointOrZero(new Dt(nn[0]/at.worldSize,nn[1]/at.worldSize),0),tr=Xt.getAtPointOrZero(new Dt(Lt[0]/at.worldSize,Lt[1]/at.worldSize),0),Fn=(It+tr)/2,qn=(fn+cn)/2;return Fn>qn?fn<cn?ZT(tt,Vt,Lt,hn,fn,tr,It,Jt):ZT(tt,nn,hn,Lt,cn,It,tr,Jt):It<tr?ZT(tt,hn,Vt,nn,It,fn,cn,Jt):ZT(tt,Lt,nn,Vt,tr,cn,fn,Jt),Math.max(Fn,qn)}(Ze,c,s.aabb,u,f);const Ke=F([],he([],Ze),Ae);F(u,ce,Ke)}else Ee=c.elevation.getAtPointOrZero(new Dt(z.x/le,z.y/le),0);Ee!==0&&(u[14]+=Ee)}}function N2(u,s,c=!1){u.uploaded||(u.gfxTexture=new nM(s,u.image,c?s.gl.R8:s.gl.RGBA8,{useMipmap:u.sampler.minFilter>=s.gl.NEAREST_MIPMAP_NEAREST}),u.uploaded=!0,u.image=null)}function qpe(u,s,c){u.indexBuffer=s.createIndexBuffer(u.indexArray,!1,!0),u.vertexBuffer=s.createVertexBuffer(u.vertexArray,Ope.members,!1,!0),u.normalArray&&(u.normalBuffer=s.createVertexBuffer(u.normalArray,Upe.members,!1,!0)),u.texcoordArray&&(u.texcoordBuffer=s.createVertexBuffer(u.texcoordArray,Bpe.members,!1,!0)),u.colorArray&&(u.colorBuffer=s.createVertexBuffer(u.colorArray,(u.colorArray.bytesPerElement===12?Fpe:zpe).members,!1,!0)),u.featureArray&&(u.pbrBuffer=s.createVertexBuffer(u.featureArray,$pe.members,!0)),u.segments=Qs.simpleSegment(0,0,u.vertexArray.length,u.indexArray.length);const f=u.material;f.pbrMetallicRoughness.baseColorTexture&&N2(f.pbrMetallicRoughness.baseColorTexture,s),f.pbrMetallicRoughness.metallicRoughnessTexture&&N2(f.pbrMetallicRoughness.metallicRoughnessTexture,s),f.normalTexture&&N2(f.normalTexture,s),f.occlusionTexture&&N2(f.occlusionTexture,s,c),f.emissionTexture&&N2(f.emissionTexture,s)}function sM(u,s,c){if(u.meshes)for(const f of u.meshes)qpe(f,s,c);if(u.children)for(const f of u.children)sM(f,s,c)}function KT(u){if(u.meshes)for(const s of u.meshes)s.indexArray.destroy(),s.vertexArray.destroy(),s.colorArray&&s.colorArray.destroy(),s.normalArray&&s.normalArray.destroy(),s.texcoordArray&&s.texcoordArray.destroy(),s.featureArray&&s.featureArray.destroy();if(u.children)for(const s of u.children)KT(s)}function aM(u){if(u.meshes)for(const c of u.meshes)c.vertexBuffer&&(c.vertexBuffer.destroy(),c.indexBuffer.destroy(),c.normalBuffer&&c.normalBuffer.destroy(),c.texcoordBuffer&&c.texcoordBuffer.destroy(),c.colorBuffer&&c.colorBuffer.destroy(),c.pbrBuffer&&c.pbrBuffer.destroy(),c.segments.destroy(),c.material&&((s=c.material).pbrMetallicRoughness.baseColorTexture&&s.pbrMetallicRoughness.baseColorTexture.gfxTexture&&s.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),s.pbrMetallicRoughness.metallicRoughnessTexture&&s.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&s.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),s.normalTexture&&s.normalTexture.gfxTexture&&s.normalTexture.gfxTexture.destroy(),s.emissionTexture&&s.emissionTexture.gfxTexture&&s.emissionTexture.gfxTexture.destroy(),s.occlusionTexture&&s.occlusionTexture.gfxTexture&&s.occlusionTexture.gfxTexture.destroy()));var s;if(u.children)for(const c of u.children)aM(c)}function d_(u,s){const c=u.json.bufferViews[s.bufferView],f=GT[s.componentType];return new f(u.buffers[c.buffer],(s.byteOffset||0)+(c.byteOffset||0),s.count*(c.byteStride&&c.byteStride!==k2[s.type]*f.BYTES_PER_ELEMENT?c.byteStride/f.BYTES_PER_ELEMENT:k2[s.type]))}function oM(u,s,c,f){const p=GT[s.componentType],_=function(O){switch(O){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(p),b=u.json.bufferViews[s.bufferView],T=b.byteStride?b.byteStride/p.BYTES_PER_ELEMENT:k2[s.type],I=c.float32,M=I.length/c.capacity;for(let O=0,z=0;O<s.count*T;O+=T,z+=M)for(let q=0;q<M;q++)I[z+q]=f[O+q]*_;c._trim()}function Gpe(u,s,c){const f=u.indices,p=u.attributes,_={};_.indexArray=new vo;const b=s.json.accessors[f],T=b.count/3;_.indexArray.reserve(T);const I=d_(s,b);for(let q=0;q<T;q++)_.indexArray.emplaceBack(I[3*q],I[3*q+1],I[3*q+2]);_.indexArray._trim(),_.vertexArray=new Bc;const M=s.json.accessors[p.POSITION];_.vertexArray.reserve(M.count);const O=d_(s,M);for(let q=0;q<M.count;q++)_.vertexArray.emplaceBack(O[3*q],O[3*q+1],O[3*q+2]);if(_.vertexArray._trim(),_.aabb=new gr(M.min,M.max),_.centroid=function(q,K){const Y=[0,0,0],ae=q.length;if(ae>0){for(let le=0;le<ae;le++){const ce=3*q[le];Y[0]+=K[ce],Y[1]+=K[ce+1],Y[2]+=K[ce+2]}Y[0]/=ae,Y[1]/=ae,Y[2]/=ae}return Y}(I,O),p.COLOR_0!==void 0){const q=s.json.accessors[p.COLOR_0],K=k2[q.type],Y=d_(s,q);_.colorArray=K===3?new Bc:new ah,_.colorArray.resize(q.count),oM(s,q,_.colorArray,Y)}if(p.NORMAL!==void 0){_.normalArray=new Bc;const q=s.json.accessors[p.NORMAL];_.normalArray.resize(q.count);const K=d_(s,q);oM(s,q,_.normalArray,K)}if(p.TEXCOORD_0!==void 0&&c.length>0){_.texcoordArray=new Yy;const q=s.json.accessors[p.TEXCOORD_0];_.texcoordArray.resize(q.count);const K=d_(s,q);oM(s,q,_.texcoordArray,K)}if(p._FEATURE_ID_RGBA4444!==void 0){const q=s.json.accessors[p._FEATURE_ID_RGBA4444];s.json.extensionsUsed&&s.json.extensionsUsed.includes("EXT_meshopt_compression")&&(_.featureData=d_(s,q))}p._FEATURE_RGBA4444!==void 0&&(_.featureData=new Uint32Array(d_(s,s.json.accessors[p._FEATURE_RGBA4444]).buffer));const z=u.material;return _.material=function(q,K){const{emissiveFactor:Y=[0,0,0],alphaMode:ae="OPAQUE",alphaCutoff:le=.5,normalTexture:ce,occlusionTexture:Se,emissiveTexture:Ae,doubleSided:Ee}=q,{baseColorFactor:Ze=[1,1,1,1],metallicFactor:Ke=1,roughnessFactor:tt=1,baseColorTexture:at,metallicRoughnessTexture:ct}=q.pbrMetallicRoughness||{},qt=Se?K[Se.index]:void 0;if(Se&&Se.extensions&&Se.extensions.KHR_texture_transform&&qt){const _t=Se.extensions.KHR_texture_transform;qt.offsetScale=[_t.offset[0],_t.offset[1],_t.scale[0],_t.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Ii(...Ze),metallicFactor:Ke,roughnessFactor:tt,baseColorTexture:at?K[at.index]:void 0,metallicRoughnessTexture:ct?K[ct.index]:void 0},doubleSided:Ee,emissiveFactor:new Ii(...Y),alphaMode:ae,alphaCutoff:le,normalTexture:ce?K[ce.index]:void 0,occlusionTexture:qt,emissionTexture:Ae?K[Ae.index]:void 0,defined:q.defined===void 0}}(z!==void 0?s.json.materials[z]:{defined:!1},c),_}function H7(u,s,c){const{matrix:f,rotation:p,translation:_,scale:b,mesh:T,extras:I,children:M}=u,O={};if(O.matrix=f||function(z,q,K,Y){var ae=q[0],le=q[1],ce=q[2],Se=q[3],Ae=ae+ae,Ee=le+le,Ze=ce+ce,Ke=ae*Ae,tt=ae*Ee,at=ae*Ze,ct=le*Ee,qt=le*Ze,_t=ce*Ze,Xt=Se*Ae,an=Se*Ee,Jt=Se*Ze,en=Y[0],hn=Y[1],Vt=Y[2];return z[0]=(1-(ct+_t))*en,z[1]=(tt+Jt)*en,z[2]=(at-an)*en,z[3]=0,z[4]=(tt-Jt)*hn,z[5]=(1-(Ke+_t))*hn,z[6]=(qt+Xt)*hn,z[7]=0,z[8]=(at+an)*Vt,z[9]=(qt-Xt)*Vt,z[10]=(1-(Ke+ct))*Vt,z[11]=0,z[12]=K[0],z[13]=K[1],z[14]=K[2],z[15]=1,z}([],p||[0,0,0,1],_||[0,0,0],b||[1,1,1]),T!==void 0){O.meshes=c[T];const z=O.anchor=[0,0];for(const q of O.meshes){const{min:K,max:Y}=q.aabb;z[0]+=K[0]+Y[0],z[1]+=K[1]+Y[1]}z[0]=Math.floor(z[0]/O.meshes.length/2),z[1]=Math.floor(z[1]/O.meshes.length/2)}if(I&&(I.id&&(O.id=I.id),I.lights&&(O.lights=function(z){if(!z.length)return[];const q=function(ce){const Se=atob(ce),Ae=new Uint8Array(Se.length);for(let Ee=0;Ee<Se.length;Ee++)Ae[Ee]=Se.codePointAt(Ee);return Ae}(z),K=[],Y=q.length/24,ae=new Uint16Array(q.buffer),le=new Float32Array(q.buffer);for(let ce=0;ce<Y;ce++){const Se=ae[2*ce*6]/30,Ae=ae[2*ce*6+1]/30,Ee=ae[2*ce*6+10]/100,Ze=le[6*ce+1],Ke=le[6*ce+2],tt=le[6*ce+3],at=le[6*ce+4],ct=tt-Ze,qt=at-Ke,_t=Math.hypot(ct,qt);K.push({pos:[Ze+.5*ct,Ke+.5*qt,Ae],normal:[qt/_t,-ct/_t,0],width:_t,height:Se,depth:Ee,points:[Ze,Ke,tt,at]})}return K}(I.lights))),M){const z=[];for(const q of M)z.push(H7(s.json.nodes[q],s,c));O.children=z}return O}function Hpe(u){if(u.vertices.length===0||u.indices.length===0)return null;const s=new OT(u.vertices,u.indices,8,256),[c,f]=[s.min.clone(),s.max.clone()];return{vertices:u.vertices,indices:u.indices,grid:s,min:c,max:f}}function Wpe(u){if(!u.extras||!u.extras.ground)return null;const s=u.extras.ground;if(!s||!Array.isArray(s)||s.length===0)return null;const c=s[0];if(!c||!Array.isArray(c)||c.length===0)return null;const f=[];for(const b of c){if(!Array.isArray(b)||b.length!==2)continue;const T=b[0],I=b[1];typeof T=="number"&&typeof I=="number"&&f.push(new zt(T,I))}if(f.length<3)return null;f.length>1&&f[f.length-1].equals(f[0])&&f.pop();let p=0;for(let b=0;b<f.length;b++){const T=f[b],I=f[(b+1)%f.length],M=f[(b+2)%f.length];p+=(T.x-I.x)*(M.y-I.y)-(M.x-I.x)*(T.y-I.y)}p>0&&f.reverse();const _=o1(f.flatMap(b=>[b.x,b.y]),[]);return _.length===0?null:{vertices:f,indices:_}}function Zpe(u,s){const c=[],f=[];let p=0;const _=[];for(const b of u){p=c.length;const T=b.vertexArray.float32,I=b.indexArray.uint16;for(let M=0;M<b.vertexArray.length;M++)_[0]=T[3*M+0],_[1]=T[3*M+1],_[2]=T[3*M+2],Pt(_,_,s),c.push(new zt(_[0],_[1]));for(let M=0;M<3*b.indexArray.length;M++)f.push(I[M]+p)}if(f.length%3!=0)return null;for(let b=0;b<f.length;b+=3){const T=c[f[b+0]],I=c[f[b+1]],M=c[f[b+2]];(T.x-I.x)*(M.y-I.y)-(M.x-I.x)*(T.y-I.y)>0&&([f[b+1],f[b+2]]=[f[b+2],f[b+1]])}return{vertices:c,indices:f}}function W7(u){const s=function(I,M){const O=[],z=WebGL2RenderingContext;if(I.json.textures)for(const q of I.json.textures){const K={magFilter:z.LINEAR,minFilter:z.NEAREST,wrapS:z.REPEAT,wrapT:z.REPEAT};q.sampler!==void 0&&Object.assign(K,I.json.samplers[q.sampler]),O.push({image:M[q.source],sampler:K,uploaded:!1})}return O}(u,u.images),c=function(I,M){const O=[];for(const z of I.json.meshes){const q=[];for(const K of z.primitives)q.push(Gpe(K,I,M));O.push(q)}return O}(u,s),{scenes:f,scene:p,nodes:_}=u.json,b=f?f[p||0].nodes:[..._.keys()],T=[];for(const I of b)T.push(H7(_[I],u,c));return function(I,M,O){const z={},q=new Set;for(let K=0;K<I.length;K++){const Y=O[M[K]];if(!Y.extras)continue;const ae=Y.extras["mapbox:footprint:version"],le=Y.extras["mapbox:footprint:id"];(ae||le)&&q.add(K),ae==="1.0.0"&&le&&(z[le]=K)}for(let K=0;K<I.length;K++){if(q.has(K))continue;const Y=I[K],ae=O[M[K]];if(!ae.extras)continue;let le=null;Y.id in z&&(le=Zpe(I[z[Y.id]].meshes,Y.matrix)),le||(le=Wpe(ae)),le&&(Y.footprint=Hpe(le))}if(q.size>0){const K=Array.from(q.values()).sort((Y,ae)=>Y-ae);for(let Y=K.length-1;Y>=0;Y--)I.splice(K[Y],1)}}(T,b,u.json.nodes),T}function Kpe(u){u.heightmap=new Float32Array(4096),u.heightmap.fill(-1);const s=u.vertexArray.float32,c=u.aabb.min[0]-1,f=u.aabb.min[1]-1,p=u_/(u.aabb.max[0]-c+2),_=u_/(u.aabb.max[1]-f+2);for(let b=0;b<s.length;b+=3){const T=s[b+2],I=(s[b+0]-c)*p|0,M=(s[b+1]-f)*_|0;T>u.heightmap[M*u_+I]&&(u.heightmap[M*u_+I]=T)}}function Z7(u,s,c,f,p){c.reserve(c.length+4*u.length),f.reserve(f.length+10*u.length),p.reserve(p.length+10*u.length);let _=f.length;for(const b of u){const T=Math.min(10,Math.max(4,1.3*b.height))*s,I=[-b.normal[1],b.normal[0],0],M=Math.min(.29,.1*b.width/b.depth),O=b.width-2*b.depth*s*(M+.01),z=me([],b.pos,I,O/2),q=me([],b.pos,I,-O/2),K=[z[0],z[1],z[2]+b.height],Y=[q[0],q[1],q[2]+b.height],ae=me([],b.normal,I,M);xt(ae,ae,T);const le=me([],b.normal,I,-M);xt(le,le,T),Qe(ae,z,ae),Qe(le,q,le),z[2]+=.1,q[2]+=.1,f.emplaceBack(ae[0],ae[1],ae[2]),f.emplaceBack(le[0],le[1],le[2]),f.emplaceBack(z[0],z[1],z[2]),f.emplaceBack(q[0],q[1],q[2]),f.emplaceBack(K[0],K[1],K[2]),f.emplaceBack(Y[0],Y[1],Y[2]),f.emplaceBack(z[0],z[1],z[2]),f.emplaceBack(q[0],q[1],q[2]),f.emplaceBack(ae[0],ae[1],ae[2]),f.emplaceBack(le[0],le[1],le[2]);const ce=O/T/2;p.emplaceBack(-ce-M,-1,ce,.8),p.emplaceBack(ce+M,-1,ce,.8),p.emplaceBack(-ce,0,ce,1.3),p.emplaceBack(ce,0,ce,1.3),p.emplaceBack(ce+M,-.8,ce,.7),p.emplaceBack(ce+M,-.8,ce,.7),p.emplaceBack(0,0,ce,1.3),p.emplaceBack(0,0,ce,1.3),p.emplaceBack(ce+M,-1.2,ce,.8),p.emplaceBack(ce+M,-1.2,ce,.8),c.emplaceBack(6+_,4+_,8+_),c.emplaceBack(7+_,9+_,5+_),c.emplaceBack(0+_,1+_,2+_),c.emplaceBack(1+_,3+_,2+_),_+=10}}function Ype(u,s){const c={};c.indexArray=new vo,c.vertexArray=new Bc,c.colorArray=new ah,Z7(u,s,c.indexArray,c.vertexArray,c.colorArray);const f={defined:!0};f.emissiveFactor=Ii.black;const p={};return p.baseColorFactor=Ii.white,f.pbrMetallicRoughness=p,c.material=f,c.aabb=new gr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),c}const K7=Ti([{name:"a_pos_3f",components:3,type:"Float32"}]),Xpe=Ti([{name:"a_normal_3",components:3,type:"Int16"}]),Jpe=Ti([{name:"a_centroid_3",components:3,type:"Int16"}]),Y7=Ti([{name:"a_part_color_emissive",components:2,type:"Uint16"}]),Qpe=Ti([{name:"a_faux_facade_color_emissive",components:2,type:"Uint16"}]),eme=Ti([{name:"a_faux_facade_data",components:4,type:"Uint16"}]),tme=Ti([{name:"a_faux_facade_vertical_range",components:2,type:"Uint16"}]),nme=Ti([{name:"a_bloom_attenuation",components:4,type:"Float32"}]),X7=rn.types,lM=32767;function rme(u,s){const c=yn+s;for(const f of u)for(const p of f)if(p.x<-s||p.x>c||p.y<-s||p.y>c)return!1;return!0}class J7{constructor(){this.layoutVertexArray=new Bc,this.layoutAttenuationArray=new ah,this.layoutColorArray=new so,this.indexArray=new vo,this.indexArrayForConflation=new vo,this.segmentsBucket=new Qs}}class cM{constructor(){this.layoutVertexArray=new Bc,this.layoutNormalArray=new vg,this.layoutCentroidArray=new vg,this.layoutColorArray=new so,this.layoutFacadePaintArray=null,this.layoutFacadeDataArray=null,this.layoutFacadeVerticalRangeArray=null,this.layoutAOArray=[],this.indexArray=new vo,this.indexArrayForConflation=new vo,this.segmentsBucket=new Qs,this.entranceBloom=new J7}}class Q7{constructor(s){this.colorBufferUploaded=!1,this.maxHeight=0,this.replacementUpdateTime=0,this.activeReplacements=[],this.footprints=[],this.featuresOnBorder=[],this.buildingFeatures=[],this.buildingWithoutFacade=new cM,this.buildingWithFacade=new cM,this.indexArrayForConflationUploaded=!1,this.footprintLookup={},this.zoom=s.zoom,this.canonical=s.canonical,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=s.index,this.hasPattern=!1,this.worldview=s.worldview,this.lut=s.lut,this.buildingWithFacade.layoutFacadePaintArray=new so,this.buildingWithFacade.layoutFacadeDataArray=new Wy,this.buildingWithFacade.layoutFacadeVerticalRangeArray=new so,this.programConfigurations=new oh(s.layers,{zoom:s.zoom,lut:s.lut}),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.projection=s.projection,this.groundEffect=new WN(s)}updateFootprints(s,c){for(const f of this.footprints)c.push({footprint:f,id:s})}prepare(){return function(){if(qT!=null||N7!=null)return null;if(h1!=null)return h1;const s=fetch($o.BUILDING_GEN_URL);return h1=function(c){let f,p,_,b;function T(){f=new Uint8Array(b.buffer),p=new Int32Array(b.buffer),_=new Float32Array(b.buffer)}function I(){throw new Error("Unexpected BuildingGen error.")}const M=()=>{},O={a:{a:I,f:function(z){const q=f.length,K=Math.max(z>>>0,Math.ceil(1.2*q)),Y=Math.ceil((K-q)/65536);try{return b.grow(Y),T(),!0}catch{return!1}},g:I,b:M,c:M,d:M,e:M}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(c,O):c.then(z=>z.arrayBuffer()).then(z=>WebAssembly.instantiate(z,O))).then(z=>{const q=z.instance.exports;return(0,q.g)(),b=q.f,T(),new Ipe({setStyle:q.h,setAOOptions:q.i,setMetricOptions:q.j,setStructuralOptions:q.k,setFacadeOptions:q.l,setFauxFacadeOptions:q.m,setFacadeClassifierOptions:q.n,addFeature:q.o,addFacade:q.p,generateMesh:q.q,getLastError:q.r,getOuterRingLength:q.s,getMeshCount:q.t,getPositionsPtr:q.u,getPositionsLength:q.v,getNormalsPtr:q.w,getNormalsLength:q.x,getColorsPtr:q.y,getColorsLength:q.z,getAOPtr:q.A,getAOLength:q.B,getUVPtr:q.C,getUVLength:q.D,getFauxFacadePtr:q.E,getFauxFacadeLength:q.F,getIndicesPtr:q.G,getIndicesLength:q.H,getBuildingPart:q.I,getRingCount:q.J,getRingPtr:q.K,getRingLength:q.L,free:q.M,malloc:q.N,heapU8:f,heap32:p,heapF32:_})})}(s).then(c=>(h1=null,qT=c,qT)).catch(c=>{ai("Could not load building-gen"),h1=null,N7=c}),h1}()}populate(s,c,f,p){const _=Npe();if(!_)return;const b=bt(f);this.tileToMeter=b,this.brightness=c.brightness,_.setStyle({convertToMeters:!1,entranceColorRgb:[1,1,1],facadeGlazingColorRgb:[.5607843137254902,.6745098039215687,.7215686274509804],normalScale:[1,-1,b],ridgeHeight:3,roofColorRgb:[.886274516,.784313738,.713725507],tileToMeters:b,tileZoom:16,wallColorRgb:[.988235294,.933333337,.811764717]}),_.setAOOptions(!1,.3),_.setMetricOptions(!1,16),_.setStructuralOptions(!0),_.setFacadeClassifierOptions(3);const T=new Map;for(const{feature:I}of s){if(X7[I.type]!=="LineString")continue;const M=this.layers[0]._featureFilter.needGeometry,O=dn(I,M);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom),O,f))continue;const z=M?O.geometry:Nn(I,f,p),q=[];for(const le of z)for(const ce of le)q.push({x:ce.x,y:ce.y});const K={coordinates:q,crossPerc:I.properties.cross_perc,distanceToRoad:I.properties.distance_to_road,entrances:I.properties.entrances,sourceId:0},Y=I.properties.source_id;let ae=T.get(Y);ae||(ae=[],T.set(Y,ae)),ae.push(K)}this.maxHeight=0;for(const{feature:I,index:M}of s){if(X7[I.type]==="LineString")continue;const O=this.layers[0]._featureFilter.needGeometry,z=dn(I,O);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom),z,f))continue;const q=O?z.geometry:Nn(I,f,p),K=x2(q,500);if(!rme(q,163))continue;const Y=this.layers[0],ae=Y.layout.get("building-base").evaluate(I,{},f),le=Y.layout.get("building-height").evaluate(I,{},f),ce=Y.layout.get("building-roof-shape").evaluate(I,{},f),Se=Y.paint.get("building-ambient-occlusion-intensity"),Ae=Y.paint.get("building-ambient-occlusion-ground-radius")/this.tileToMeter;if(ce==="flat")continue;const Ee=Y.layout.get("building-facade").evaluate(I,{},f);_.setFacadeOptions(4,!0),_.setFauxFacadeOptions(Ee,!1,1);const Ze=I.properties.source_id;let Ke;Ke=T.has(Ze)?T.get(Ze):[];let tt=0,at=0,ct=0,qt=0,_t=0,Xt=0;if(Ee){let Bn=Math.round(Y.layout.get("building-facade-floors").evaluate(I,{},f));if(ae===0){Bn=Math.max(1,Bn-(Ke.length>0?1:0));let ki=4;if(le>100){const Me=[10,13,15];ki=Me[I.id?I.id%Me.length:0],_.setFacadeOptions(ki,!0)}_t=1.6803*ki/b}else _t=ae/b;Xt=le/b,_t=Math.min(_t,Xt),ct=Y.layout.get("building-facade-unit-width").evaluate(I,{},f)/b,qt=(Xt-_t)/Bn,_.setFauxFacadeOptions(!0,!0,ct);const jr=Y.layout.get("building-facade-window").evaluate(I,{},f);tt=jr[0],at=jr[1]}const an=[],Jt=new zt(1/0,1/0),en=new zt(-1/0,-1/0),hn=new zt(0,0);let Vt=0;for(const Bn of K)if(Bn.length>0){const jr=[];for(const ki of Bn){const Me=[];for(let Le=ki.length-1;Le>=0;Le--){const Mt=ki[Le];Me.push({x:Mt.x,y:Mt.y}),Jt.x=Math.min(Jt.x,Mt.x),Jt.y=Math.min(Jt.y,Mt.y),en.x=Math.max(en.x,Mt.x),en.y=Math.max(en.y,Mt.y),hn.x+=Mt.x,hn.y+=Mt.y,Vt++}jr.push(Me)}an.push({id:I.id?I.id:0,height:le,minHeight:ae,sourceId:0,roofType:ce,coordinates:jr})}hn.x/=Vt||1,hn.y/=Vt||1;const nn=_.generateMesh(an,Ke);if(typeof nn=="string"){ai(`Unable to generate building ${I.id}: ${nn}`);continue}if(nn.meshes.length===0||nn.modifiedPolygonRings.length===0)continue;let Lt=0;for(const Bn of nn.meshes)Lt+=Bn.positions.length/3;const It=Ee?this.buildingWithFacade:this.buildingWithoutFacade,fn=It.segmentsBucket.prepareSegment(Lt,It.layoutVertexArray,It.indexArray),cn=[];let tr=null,Fn=0,qn=-1;const vn=It.indexArray.length;let er=0;for(const Bn of nn.meshes){const jr=It.layoutVertexArray.length;if(Bn.buildingPart==="entrance"){const $t=new Array;for(let or=0;or<Bn.indices.length;or+=12){const si=Bn.positions[or+0],oi=Bn.positions[or+1],Jr=Bn.positions[or+3],Xi=Bn.positions[or+4],qs=Bn.positions[or+2],Kr=Bn.positions[or+8]-qs,Ss=1,ns=Jr-si,Oi=Xi-oi,Es=Math.hypot(ns,Oi);$t.push({pos:[si+.5*ns,oi+.5*Oi,qs],normal:[Oi/Es,-ns/Es,0],width:Es,height:Kr,depth:Ss,points:[si,oi,Jr,Xi]})}const Tn=It.entranceBloom.segmentsBucket.prepareSegment(10*$t.length,It.entranceBloom.layoutVertexArray,It.entranceBloom.indexArray),An=It.entranceBloom.layoutVertexArray.length;Fn=It.entranceBloom.indexArray.length,Z7($t,.5/this.tileToMeter,It.entranceBloom.indexArray,It.entranceBloom.layoutVertexArray,It.entranceBloom.layoutAttenuationArray);const zn=It.entranceBloom.layoutVertexArray.length-An;qn=It.entranceBloom.indexArray.length-Fn;for(let or=0;or<zn;or++)It.entranceBloom.layoutColorArray.emplaceBack(65535,65535);Tn.vertexLength+=zn,Tn.primitiveLength+=qn,tr={part:Bn.buildingPart,vertexOffset:An,vertexLength:zn}}for(let $t=0;$t<Bn.positions.length;$t+=3)er=Math.max(er,Bn.positions[$t+2]),It.layoutVertexArray.emplaceBack(Bn.positions[$t],Bn.positions[$t+1],Bn.positions[$t+2]);const ki=Math.floor(hn.x),Me=Math.floor(hn.y),Le=Math.floor(er);for(let $t=0;$t<Bn.positions.length;$t+=3)It.layoutCentroidArray.emplaceBack(ki,Me,Le);for(let $t=0;$t<Bn.normals.length;$t+=3)It.layoutNormalArray.emplaceBack(Bn.normals[$t+0]*lM,Bn.normals[$t+1]*lM,Bn.normals[$t+2]*lM);for(let $t=0;$t<Bn.ao.length;$t++)It.layoutAOArray.push(Bn.ao[$t]);for(let $t=0;$t<Bn.colors.length;$t+=3){const Tn=1+(Bn.ao[$t/3]-1)*Se;It.layoutColorArray.emplaceBack(Bn.colors[$t]*Tn<<8|Bn.colors[$t+1]*Tn,Bn.colors[$t+2]*Tn<<8)}if(Ee){for(let $t=0;$t<Bn.positions.length;$t+=3)It.layoutFacadePaintArray.emplaceBack(65535,255);for(let $t=0;$t<Bn.isFauxFacade.length;$t++)if(Bn.isFauxFacade[$t]){const Tn=1|Math.min(65535,Math.floor(Bn.uv[2*$t]*nn.outerRingLength)),An=Math.floor(255*tt)<<8|Math.floor(255*at),zn=Math.floor(65535*Math.min(1,ct/yn)),or=Math.floor(65535*Math.min(1,qt/yn));It.layoutFacadeDataArray.emplaceBack(Tn,An,zn,or);const si=Math.floor(65535*Math.min(1,_t/yn)),oi=Math.floor(65535*Math.min(1,Xt/yn));It.layoutFacadeVerticalRangeArray.emplaceBack(si,oi)}else It.layoutFacadeDataArray.emplaceBack(0,0,0,0),It.layoutFacadeVerticalRangeArray.emplaceBack(0,0)}const Mt=fn.vertexLength;for(let $t=0;$t<Bn.indices.length;$t+=3)It.indexArray.emplaceBack(Mt+Bn.indices[$t],Mt+Bn.indices[$t+1],Mt+Bn.indices[$t+2]);fn.vertexLength+=Bn.positions.length/3,fn.primitiveLength+=Bn.indices.length/3,(Bn.buildingPart==="roof"||Bn.buildingPart==="wall"||Bn.buildingPart==="facade_glazing"||Bn.buildingPart==="entrance")&&cn.push({part:Bn.buildingPart,vertexOffset:jr,vertexLength:Bn.positions.length/3})}this.maxHeight=Math.max(this.maxHeight,er),this.buildingFeatures.push({feature:z,hasFauxFacade:Ee,segment:fn,parts:cn,buildingBloom:tr});const Ir=It.indexArray.length-vn,En=[],Yn=[],pr=new zt(1/0,1/0),Lr=new zt(-1/0,-1/0),ii=this.groundEffect.vertexArray.length;for(const Bn of nn.modifiedPolygonRings){const jr=[],ki=new zt(1/0,1/0),Me=new zt(-1/0,-1/0);for(let Le=0;Le<Bn.length;Le+=2){const Mt=Bn.length-Le-2;ki.x=Math.min(ki.x,Bn[Mt]),ki.y=Math.min(ki.y,Bn[Mt+1]),Me.x=Math.max(Me.x,Bn[Mt]),Me.y=Math.max(Me.y,Bn[Mt+1]);const $t=new zt(Bn[Mt],Bn[Mt+1]);jr.push($t),En.push($t.x,$t.y),Yn.push($t.clone())}pr.x=Math.min(pr.x,ki.x),pr.y=Math.min(pr.y,ki.y),Lr.x=Math.max(Lr.x,Me.x),Lr.y=Math.max(Lr.y,Me.y),this.groundEffect.addData(jr,[ki,Me],Ae)}const zr=this.groundEffect.vertexArray.length-ii;(Jt.x<0||en.x>yn||Jt.y<0||en.y>yn)&&this.featuresOnBorder.push({featureId:I.id,footprintIndex:this.footprints.length});{const Bn=o1(En,null,2),jr=new OT(Yn,Bn,8,256);let ki=I.id;I.properties&&I.properties.hasOwnProperty("building_id")&&(ki=I.properties.building_id),this.footprints.push({vertices:Yn,indices:Bn,grid:jr,min:pr,max:Lr,buildingId:ki,hiddenFlags:0,indicesOffset:vn,indicesLength:Ir,bloomIndicesOffset:Fn,bloomIndicesLength:qn,groundEffectVertexOffset:ii,groundEffectVertexLength:zr,hasFauxFacade:Ee,segment:fn,height:er})}this.programConfigurations.populatePaintArrays(It.layoutVertexArray.length,I,M,{},c.availableImages,f,c.brightness),this.groundEffect.addPaintPropertiesData(I,M,{},c.availableImages,f,c.brightness)}this.groundEffect.prepareBorderSegments(),this.evaluate(this.layers[0],{})}update(s,c,f,p,_,b,T){this.programConfigurations.updatePaintArrays(s,c,_,f,p,b,T),this.groundEffect.update(s,c,_,f,p,b,T),this.evaluate(this.layers[0],s),this.colorBufferUploaded=!1}isEmpty(){return this.buildingWithoutFacade.layoutVertexArray.length===0&&this.buildingWithFacade.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(s){const c=f=>{f.layoutVertexBuffer=s.createVertexBuffer(f.layoutVertexArray,K7.members),f.layoutNormalBuffer=s.createVertexBuffer(f.layoutNormalArray,Xpe.members),f.layoutCentroidBuffer=s.createVertexBuffer(f.layoutCentroidArray,Jpe.members),f.layoutFacadeDataArray&&f.layoutFacadeDataArray.length&&(f.layoutFacadeDataBuffer=s.createVertexBuffer(f.layoutFacadeDataArray,eme.members)),f.layoutFacadeVerticalRangeArray&&f.layoutFacadeVerticalRangeArray.length&&(f.layoutFacadeVerticalRangeBuffer=s.createVertexBuffer(f.layoutFacadeVerticalRangeArray,tme.members)),f.entranceBloom.layoutVertexArray.length&&(f.entranceBloom.layoutVertexBuffer=s.createVertexBuffer(f.entranceBloom.layoutVertexArray,K7.members),f.entranceBloom.layoutAttenuationBuffer=s.createVertexBuffer(f.entranceBloom.layoutAttenuationArray,nme.members)),this.uploadUpdatedColorBuffer(s),this.uploadUpdatedIndexBuffer(s)};this.uploaded||(c(this.buildingWithoutFacade),c(this.buildingWithFacade),this.groundEffect.upload(s)),this.groundEffect.uploadPaintProperties(s),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){const s=c=>{c.layoutVertexBuffer&&(c.layoutVertexBuffer.destroy(),c.layoutNormalBuffer.destroy(),c.layoutColorBuffer.destroy(),c.segmentsBucket.destroy(),c.indexBuffer&&c.indexBuffer.destroy(),c.entranceBloom.layoutVertexBuffer&&(c.entranceBloom.layoutVertexBuffer.destroy(),c.entranceBloom.layoutColorBuffer.destroy(),c.entranceBloom.layoutAttenuationBuffer.destroy(),c.entranceBloom.indexBuffer.destroy(),c.entranceBloom.segmentsBucket.destroy()))};s(this.buildingWithoutFacade),s(this.buildingWithFacade),this.groundEffect.destroy(),this.programConfigurations.destroy()}updateFootprintHiddenFlags(s,c,f=!0){let p=!1;const _=f?c:0,b=0|(f?-1:~c);this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const T of s){const I=this.footprints[T],M=I.hiddenFlags&b|_;I.hiddenFlags!==M&&(I.hiddenFlags=M,p=!0,this.groundEffect.updateHiddenByLandmarkRange(I.groundEffectVertexOffset,I.groundEffectVertexLength,I.hiddenFlags!==0))}return p&&(this.indexArrayForConflationUploaded=!1),p}uploadUpdatedIndexBuffer(s){if(this.groundEffect.uploadHiddenByLandmark(s),this.indexArrayForConflationUploaded)return;const c=p=>{p.indexArray.length!==0&&(p.indexArrayForConflation.resize(p.indexArray.length),p.indexArrayForConflation.uint16.set(p.indexArray.uint16),p.entranceBloom.indexArrayForConflation.resize(p.entranceBloom.indexArray.length),p.entranceBloom.indexArrayForConflation.uint16.set(p.entranceBloom.indexArray.uint16))};c(this.buildingWithoutFacade),c(this.buildingWithFacade);for(const p of this.footprints){const _=p.hasFauxFacade?this.buildingWithFacade:this.buildingWithoutFacade,b=p.indicesOffset+p.indicesLength;if(p.hiddenFlags!==0){for(let I=p.indicesOffset;I<b;I++)_.indexArrayForConflation.uint16[3*I+0]=0,_.indexArrayForConflation.uint16[3*I+1]=0,_.indexArrayForConflation.uint16[3*I+2]=0;const T=p.bloomIndicesOffset+p.bloomIndicesLength;for(let I=p.bloomIndicesOffset;I<T;I++)_.entranceBloom.indexArrayForConflation.uint16[3*I+0]=0,_.entranceBloom.indexArrayForConflation.uint16[3*I+1]=0,_.entranceBloom.indexArrayForConflation.uint16[3*I+2]=0}}const f=p=>{p.indexArray.length!==0&&(p.indexBuffer?p.indexBuffer.updateData(p.indexArrayForConflation):p.indexBuffer=s.createIndexBuffer(p.indexArrayForConflation,!0),p.entranceBloom.indexBuffer?p.entranceBloom.indexBuffer.updateData(p.entranceBloom.indexArrayForConflation):p.entranceBloom.indexBuffer=s.createIndexBuffer(p.entranceBloom.indexArrayForConflation,!0))};f(this.buildingWithoutFacade),f(this.buildingWithFacade),this.indexArrayForConflationUploaded=!0}uploadUpdatedColorBuffer(s){const c=f=>{f.layoutColorBuffer?f.layoutColorBuffer.updateData(f.layoutColorArray):f.layoutColorBuffer=s.createVertexBuffer(f.layoutColorArray,Y7.members,!0),f.layoutFacadePaintArray&&(f.layoutFacadePaintBuffer?f.layoutFacadePaintBuffer.updateData(f.layoutFacadePaintArray):f.layoutFacadePaintBuffer=s.createVertexBuffer(f.layoutFacadePaintArray,Qpe.members,!0)),f.entranceBloom.layoutColorBuffer?f.entranceBloom.layoutColorBuffer.updateData(f.entranceBloom.layoutColorArray):f.entranceBloom.layoutColorBuffer=s.createVertexBuffer(f.entranceBloom.layoutColorArray,Y7.members,!0)};c(this.buildingWithoutFacade),c(this.buildingWithFacade),this.colorBufferUploaded=!0}evaluate(s,c){const f=s.paint.get("building-ambient-occlusion-intensity");for(const p of this.buildingFeatures){const _=c[p.feature.id],b=p.feature;b.properties["building-part"]="roof";const T=s.paint.get("building-color").evaluate(b,_,this.canonical).toPremultipliedRenderColor(this.lut),I=s.paint.get("building-emissive-strength").evaluate(b,_,this.canonical);b.properties["building-part"]="wall";const M=s.paint.get("building-color").evaluate(b,_,this.canonical).toPremultipliedRenderColor(this.lut),O=s.paint.get("building-emissive-strength").evaluate(b,_,this.canonical);b.properties["building-part"]="window";const z=s.paint.get("building-color").evaluate(b,_,this.canonical).toPremultipliedRenderColor(this.lut),q=s.paint.get("building-emissive-strength").evaluate(b,_,this.canonical);b.properties["building-part"]="door";const K=s.paint.get("building-color").evaluate(b,_,this.canonical).toPremultipliedRenderColor(this.lut),Y=s.paint.get("building-emissive-strength").evaluate(b,_,this.canonical),ae=p.hasFauxFacade?this.buildingWithFacade:this.buildingWithoutFacade;for(const ce of p.parts){let Se,Ae=T;ce.part==="roof"?(Ae=T,Se=I):ce.part==="wall"?(Ae=M,Se=O):ce.part==="facade_glazing"?(Ae=z,Se=q):ce.part==="entrance"&&(Ae=K,Se=Y),Se=We(Se,0,1);for(let Ee=0;Ee<ce.vertexLength;Ee++){const Ze=ce.vertexOffset+Ee,Ke=1+(ae.layoutAOArray[Ze]-1)*f;ae.layoutColorArray.emplace(Ze,Ae.r*Ke*255<<8|Ae.g*Ke*255,Ae.b*Ke*255<<8|255*Se),p.hasFauxFacade&&ae.layoutFacadePaintArray.emplace(Ze,255*z.r<<8|255*z.g,255*z.b<<8|255*q)}}const le=p.buildingBloom;if(le)for(let ce=0;ce<le.vertexLength;ce++)ae.entranceBloom.layoutColorArray.emplace(le.vertexOffset+ce,255*K.r<<8|255*K.g,255*K.b<<8|51*Y)}}needsEvaluation(){return!this.colorBufferUploaded}updateReplacement(s,c,f){if(c.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=c.updateTime;const p=c.getReplacementRegionsForTile(s.toUnwrapped());if(zT(this.activeReplacements,p))return;this.activeReplacements=p;for(const b of this.footprints)b.hiddenFlags&=-2;const _=[];for(const b of this.activeReplacements){if(b.order<=r7)continue;const T=Math.max(1,Math.pow(2,b.footprintTileId.canonical.z-s.canonical.z));for(const I of this.footprints)I.min.x>b.max.x||I.max.x<b.min.x||I.min.y>b.max.y||I.max.y<b.min.y||(_.length=0,ime(I.vertices,0,I.vertices.length,b.footprintTileId.canonical,s.canonical,_),$N(b.footprint,_,I.indices,0,I.indices.length,0,-T)&&(I.hiddenFlags|=1))}this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const b of this.footprints)this.groundEffect.updateHiddenByLandmarkRange(b.groundEffectVertexOffset,b.groundEffectVertexLength,b.hiddenFlags!==0);this.indexArrayForConflationUploaded=!1}getHeightAtTileCoord(s,c){let f=Number.NEGATIVE_INFINITY,p=!0;const _=4*(s+yn)*yn+(c+yn);if(this.footprintLookup.hasOwnProperty(_)){const T=this.footprintLookup[_];return T?{height:T.height,hidden:T.hiddenFlags!==0}:void 0}const b=new zt(s,c);for(const T of this.footprints)s>T.max.x||T.min.x>s||c>T.max.y||T.min.y>c||T.height<=f||qN(b,T)&&(f=T.height,this.footprintLookup[_]=T,p=T.hiddenFlags!==0);if(f!==Number.NEGATIVE_INFINITY)return{height:f,hidden:p};this.footprintLookup[_]=void 0}}function ime(u,s,c,f,p,_){const b=Math.pow(2,f.z-p.z);for(let T=0;T<c;T++){let I=u[T+s].x,M=u[T+s].y;I=(I+p.x*yn)*b-f.x*yn,M=(M+p.y*yn)*b-f.y*yn,_.push(new zt(I,M))}}let eU,tU;Pn(Q7,"BuildingBucket",{omit:["layers"]}),Pn(cM,"BuildingGeometry"),Pn(J7,"BuildingBloomGeometry");const sme=Ti([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),ame=Ti([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:ome}=sme,lme=Ti([{name:"a_packed",components:3,type:"Float32"}]),{members:cme}=lme,ume=Ti([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:dme}=ume;class nU{constructor(s,c){this.width=s,this.height=c,this.nextRow=0,this.image=new t0({width:s,height:c}),this.positions={},this.uploaded=!1}getDash(s,c){const f=this.getKey(s,c);return this.positions[f]}trim(){const s=this.width,c=this.height=Vn(this.nextRow);this.image.resize({width:s,height:c})}getKey(s,c){return s.join(",")+c}getDashRanges(s,c,f){const p=[];let _=s.length%2==1?-s[s.length-1]*f:0,b=s[0]*f,T=!0;p.push({left:_,right:b,isDash:T,zeroLength:s[0]===0});let I=s[0];for(let M=1;M<s.length;M++){T=!T;const O=s[M];_=I*f,I+=O,b=I*f,p.push({left:_,right:b,isDash:T,zeroLength:O===0})}return p}addRoundDash(s,c,f){const p=c/2;for(let _=-f;_<=f;_++){const b=this.width*(this.nextRow+f+_);let T=0,I=s[T];for(let M=0;M<this.width;M++){M/I.right>1&&(I=s[++T]);const O=Math.abs(M-I.left),z=Math.abs(M-I.right),q=Math.min(O,z);let K;const Y=_/f*(p+1);if(I.isDash){const ae=p-Math.abs(Y);K=Math.sqrt(q*q+ae*ae)}else K=p-Math.sqrt(q*q+Y*Y);this.image.data[b+M]=Math.max(0,Math.min(255,K+128))}}}addRegularDash(s,c){for(let I=s.length-1;I>=0;--I){const M=s[I],O=s[I+1];M.zeroLength?s.splice(I,1):O&&O.isDash===M.isDash&&(O.left=M.left,s.splice(I,1))}const f=s[0],p=s[s.length-1];f.isDash===p.isDash&&(f.left=p.left-this.width,p.right=f.right+this.width);const _=this.width*this.nextRow;let b=0,T=s[b];for(let I=0;I<this.width;I++){I/T.right>1&&(T=s[++b]);const M=Math.abs(I-T.left),O=Math.abs(I-T.right),z=Math.min(M,O);this.image.data[_+I]=Math.max(0,Math.min(255,(T.isDash?z:-z)+c+128))}}addDash(s,c){const f=this.getKey(s,c);if(this.positions[f])return this.positions[f];const p=c==="round",_=p?7:0,b=2*_+1;if(this.nextRow+b>this.height)return ai("LineAtlas out of space"),null;s.length===0&&s.push(1);let T=0;for(let O=0;O<s.length;O++)s[O]<0&&(ai("Negative value is found in line dasharray, replacing values with 0"),s[O]=0),T+=s[O];if(T!==0){const O=this.width/T,z=this.getDashRanges(s,this.width,O);p?this.addRoundDash(z,O,_):this.addRegularDash(z,c==="square"?.5*O:0)}const I=this.nextRow+_;this.nextRow+=b;const M={tl:[I,_],br:[T,0]};return this.positions[f]=M,M}}Pn(nU,"LineAtlas");const hme=rn.types,fme=Math.cos(Math.PI/180*37.5),pme=Math.cos(Math.PI/180*5);class uM{constructor(s){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=s.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=s.overscaling,this.pixelRatio=s.pixelRatio,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=s.index,this.projection=s.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new Kx,this.layoutVertexArray2=new Bc,this.patternVertexArray=new Bc,this.indexArray=new vo,this.programConfigurations=new oh(s.layers,{zoom:s.zoom,lut:s.lut}),this.segments=new Qs,this.maxLineLength=0,this.zOffsetVertexArray=new Bc,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.tessellationStep=s.tessellationStep?s.tessellationStep:yn/64,this.worldview=s.worldview}updateFootprints(s,c){}populate(s,c,f,p){this.hasPattern=ON("line",this.layers,this.pixelRatio,c);const _=this.layers[0].layout.get("line-sort-key");this.tileToMeter=bt(f);const b=this.layers[0].layout.get("line-elevation-reference");if(b==="hd-road-markup")this.elevationType="road";else{const q=this.layers[0].layout.get("line-z-offset"),K=q.isConstant()&&!q.constantOr(0);this.elevationType=b!=="sea"&&b!=="ground"&&K?"none":"offset",this.elevationType==="offset"&&b==="none"&&ai(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const T=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&T!==void 0;const I=[];for(const{feature:q,id:K,index:Y,sourceLayerIndex:ae}of s){const le=this.layers[0]._featureFilter.needGeometry,ce=dn(q,le);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom,{worldview:this.worldview}),ce,f))continue;const Se=_?_.evaluate(ce,{},f):void 0,Ae={id:K,properties:q.properties,type:q.type,sourceLayerIndex:ae,index:Y,geometry:le?ce.geometry:Nn(q,f,p),patterns:{},sortKey:Se};I.push(Ae)}_&&I.sort((q,K)=>q.sortKey-K.sortKey);const{lineAtlas:M,featureIndex:O}=c,z=this.addConstantDashes(M);for(const q of I){const{geometry:K,index:Y,sourceLayerIndex:ae}=q;if(z&&this.addFeatureDashes(q,M),this.hasPattern){const le=FN("line",this.layers,q,this.zoom,this.pixelRatio,c);this.patternFeatures.push(le)}else this.addFeature(q,K,Y,f,M.positions,c.availableImages,c.brightness,c.elevationFeatures);O.insert(s[Y].feature,K,Y,ae,this.index)}}addConstantDashes(s){let c=!1;for(const f of this.layers){const p=f.paint.get("line-dasharray").value,_=f.layout.get("line-cap").value;if(p.kind!=="constant"||_.kind!=="constant")c=!0;else{const b=_.value,T=p.value;if(!T)continue;s.addDash(T,b)}}return c}addFeatureDashes(s,c){const f=this.zoom;for(const p of this.layers){const _=p.paint.get("line-dasharray").value,b=p.layout.get("line-cap").value;if(_.kind==="constant"&&b.kind==="constant")continue;let T,I;if(_.kind==="constant"){if(T=_.value,!T)continue}else T=_.evaluate({zoom:f},s);I=b.kind==="constant"?b.value:b.evaluate({zoom:f},s),c.addDash(T,I),s.patterns[p.id]=[c.getKey(T,I)]}}update(s,c,f,p,_,b,T,I){this.programConfigurations.updatePaintArrays(s,c,_,f,p,b,T,I)}addFeatures(s,c,f,p,_,b){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,c,f,p,b)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,cme)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=s.createVertexBuffer(this.patternVertexArray,dme)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=s.createVertexBuffer(this.zOffsetVertexArray,ame.members,!0)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,ome),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s,c){let f,p;if(c&&c>0?(f=`mapbox_clip_start_${c}`,p=`mapbox_clip_end_${c}`):(f="mapbox_clip_start",p="mapbox_clip_end"),s.properties&&s.properties.hasOwnProperty(f)&&s.properties.hasOwnProperty(p))return{start:+s.properties[f],end:+s.properties[p]}}addFeature(s,c,f,p,_,b,T,I){const M=this.layers[0].layout,O=M.get("line-join").evaluate(s,{}),z=M.get("line-cap").evaluate(s,{}),q=M.get("line-miter-limit"),K=M.get("line-round-limit");this.lineClips=this.lineFeatureClips(s),this.lineFeature=s;const Y=!(!s.properties||!s.properties.hasOwnProperty("mapbox_line_metrics"))&&s.properties.mapbox_line_metrics;this.zOffsetValue=M.get("line-z-offset").value;const ae=this.layers[0].paint.get("line-width").value;if(ae.kind!=="constant"&&ae.isLineProgressConstant===!1&&(this.variableWidthValue=ae),this.elevationType==="road"){const le=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(s,c,p,I,O,z,q,K)){const[ce,Se]=this.clipRuntimeLinesToTile(c,1);for(let Ae=0;Ae<ce.length;Ae++){const Ee=ce[Ae],Ze=Se[Ae],Ke={progress:{min:Ze.progress.min,max:Ze.progress.max},nextDir:this.computeSegNextDir(Ze,Ee),prevDir:this.computeSegPrevDir(Ze,Ee)};this.addLine(Ee,s,p,O,z,q,K,Ke,Y&&Ze.parentIndex>0?Ze.parentIndex:null)}this.fillNonElevatedRoadSegment(le)}}else for(let le=0;le<c.length;le++)this.addLine(c[le],s,p,O,z,q,K,void 0,Y&&le>0?le:null);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,f,_,b,p,T,void 0,this.worldview)}computeSegNextDir(s,c){return s.nextPoint.sub(c.at(-2)).unit()}computeSegPrevDir(s,c){return c[1].sub(s.prevPoint).unit()}clipLinesToTile(s,c){return VT(s,-c,-c,yn+c,yn+c)}clipRuntimeLinesToTile(s,c){const f=[];return[VT(s,-c,-c,yn+c,yn+c,f),f]}addElevatedRoadFeature(s,c,f,p,_,b,T,I){const M=[],O=Ks.getElevationFeature(s,p);if(O){const z=this.clipLinesToTile(c,1),q=this.prepareElevatedLines(z,O,f);for(const K of q)M.push({geometry:K,elevation:O,elevationTileID:f,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(M.length===0)return!1;for(const z of M){const q=this.layoutVertexArray.length;this.addLine(z.geometry,s,f,_,b,T,I);const K=new Va(f,z.elevationTileID);if(z.elevation)for(let Y=q;Y<this.layoutVertexArray.length;Y++){const ae=new zt(this.layoutVertexArray.int16[6*Y]>>1,this.layoutVertexArray.int16[6*Y+1]>>1),le=K.pointElevation(ae,z.elevation,.05);this.updateHeightRange(le),this.zOffsetVertexArray.emplaceBack(le,0,0)}else this.fillNonElevatedRoadSegment(q)}return!0}prepareElevatedLines(s,c,f){if(c.constantHeight!=null)return s;const p=[],_=1/bt(f);for(const b of s)Epe(b,new Yi(c,_),0,p);return p}fillNonElevatedRoadSegment(s){for(let c=s;c<this.layoutVertexArray.length;c++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(s){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,s),this.heightRange.max=Math.max(this.heightRange.max,s)):this.heightRange={min:s,max:s}}addLine(s,c,f,p,_,b,T,I,M){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0,this.lineClips=M?this.lineFeatureClips(c,M):this.lineClips;const O=p==="none";this.patternJoinNone=this.hasPattern&&O,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const z=I&&I.progress.min>0,q=I&&I.progress.max<1;if(this.lineClips){let ct={min:this.lineClips.start,max:this.lineClips.end},qt=1;if(I){const an=this.lineClips.end-this.lineClips.start;ct=function(Jt,en,hn){return{min:ac(Jt.min,en,hn),max:ac(Jt.max,en,hn)}}(I.progress,{min:0,max:1},ct),an>0&&(qt=(ct.max-ct.min)/an)}const _t=+c.properties.mapbox_clip_feature_len,Xt=+c.properties.mapbox_clip_seg_len;if(Number.isNaN(_t)||Number.isNaN(Xt)){for(let Jt=0;Jt<s.length-1;Jt++)this.totalDistance+=s[Jt].dist(s[Jt+1]);const an=this.totalDistance/(ct.max-ct.min);this.totalFeatureLength=Number.isFinite(an)?an:0,this.lineClips.start=ct.min,this.lineClips.end=ct.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=_t,this.distance=Xt*qt,this.lineClips.start=ct.min,this.lineClips.end=ct.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const K=hme[c.type]==="Polygon";let Y=s.length;for(;Y>=2&&s[Y-1].equals(s[Y-2]);)Y--;let ae=0;for(;ae<Y-1&&s[ae].equals(s[ae+1]);)ae++;if(Y<(K?3:2))return;p==="bevel"&&(b=1.05);const le=this.segments.prepareSegment(10*Y,this.layoutVertexArray,this.indexArray);let ce,Se,Ae,Ee,Ze,Ke,tt,at;I&&I.prevDir&&(Ke=I.prevDir.perp()),I&&I.nextDir&&(tt=I.nextDir.perp()),this.e1=this.e2=-1,K&&(ce=s[Y-2],Ze=s[ae].sub(ce)._unit()._perp());for(let ct=ae;ct<Y;ct++){if(Ae=ct===Y-1?K?s[ae+1]:void 0:s[ct+1],Ae&&s[ct].equals(Ae))continue;Ze&&(Ee=Ze),ce&&(Se=ce),ce=s[ct],at=this.evaluateLineProgressFeatures(Se?Se.dist(ce):0),Ze=Ae?Ae.sub(ce)._unit()._perp():Ee,Ee=Ee||Ze;const qt=Se&&Ae;let _t=qt?p:K||O?"butt":_;const Xt=Ee.x*Ze.x+Ee.y*Ze.y;if(O){const It=function(fn){if(fn.patternJoinNone){const cn=fn.segmentPoints.length/2,tr=fn.lineSoFar-fn.segmentStart;for(let Fn=0;Fn<cn;++Fn){const qn=fn.segmentPoints[2*Fn+1],vn=Math.round(fn.segmentPoints[2*Fn])+.5+.25*qn;fn.patternVertexArray.emplaceBack(vn,tr,fn.segmentStart),fn.patternVertexArray.emplaceBack(vn,tr,fn.segmentStart)}fn.segmentPoints.length=0}fn.e1=fn.e2=-1};if(qt&&Xt<pme){this.updateDistance(Se,ce),this.addCurrentVertex(ce,Ee,1,1,le,at),It(this),this.addCurrentVertex(ce,Ze,-1,-1,le,at);continue}if(Se){if(!Ae){this.updateDistance(Se,ce),this.addCurrentVertex(ce,Ee,1,1,le,at),It(this);continue}_t="miter"}}let an=Ee.add(Ze);an.x===0&&an.y===0||an._unit();const Jt=an.x*Ze.x+an.y*Ze.y,en=Jt!==0?1/Jt:1/0,hn=2*Math.sqrt(2-2*Jt),Vt=Jt<fme&&Se&&Ae,nn=Ee.x*Ze.y-Ee.y*Ze.x>0,Lt=this.overscaling<=16?15*yn/(512*this.overscaling):0;if(qt&&_t==="round"){if(en<T)_t="miter";else if(en<=2){const It=dM(ce,-10,yn+10);_t=this.elevationType==="offset"&&(It||this.hasCrossSlope)?"miter":"fakeround"}}if(_t==="miter"&&en>b&&(_t="bevel"),_t==="bevel"&&(en>2&&(_t="flipbevel"),en<b&&(_t="miter")),Se&&!(_t==="miter"&&Vt)&&this.updateDistance(Se,ce),_t==="miter")if(Vt){const It=ce.dist(Se);if(It>2*Lt){const cn=ce.sub(ce.sub(Se)._mult(Lt/It)._round());this.updateDistance(Se,cn),this.addCurrentVertex(cn,Ee,0,0,le,at),Se=cn}this.updateDistance(Se,ce),an._mult(en),this.addCurrentVertex(ce,an,0,0,le,at);const fn=ce.dist(Ae);if(fn>2*Lt){const cn=ce.add(Ae.sub(ce)._mult(Lt/fn)._round());this.updateDistance(ce,cn),this.addCurrentVertex(cn,Ze,0,0,le,at),ce=cn}}else an._mult(en),this.addCurrentVertex(ce,an,0,0,le,at);else if(_t==="flipbevel"){if(en>100)an=Ze.mult(-1);else{const It=en*Ee.add(Ze).mag()/Ee.sub(Ze).mag();an._perp()._mult(It*(nn?-1:1))}this.addCurrentVertex(ce,an,0,0,le,at),this.addCurrentVertex(ce,an.mult(-1),0,0,le,at)}else if(_t==="bevel"||_t==="fakeround"){at!=null&&Se&&this.addCurrentVertex(ce,tt||Ee,-1,-1,le,at);const It=ce.dist(Se)<=2*Lt&&_t!=="bevel",fn=an.mult(nn?1:-1);fn._mult(en);const cn=Ze.mult(nn?-1:1),tr=Ee.mult(nn?-1:1),Fn=this.evaluateLineProgressFeatures(this.distance);if(at==null&&(this.addHalfVertex(ce,fn.x,fn.y,!1,!nn,0,le,Fn),It||this.addHalfVertex(ce,fn.x+2*tr.x,fn.y+2*tr.y,!1,nn,0,le,Fn)),_t==="fakeround"){const qn=Math.round(180*hn/Math.PI/20);this.addHalfVertex(ce,tr.x,tr.y,!1,nn,0,le,Fn);for(let vn=0;vn<qn;vn++){let er=vn/qn;if(er!==.5){const En=er-.5;er+=er*En*(er-1)*((1.0904+Xt*(Xt*(3.55645-1.43519*Xt)-3.2452))*En*En+(.848013+Xt*(.215638*Xt-1.06021)))}const Ir=cn.sub(tr)._mult(er)._add(tr)._unit();this.addHalfVertex(ce,Ir.x,Ir.y,!1,nn,0,le,Fn)}this.addHalfVertex(ce,cn.x,cn.y,!1,nn,0,le,Fn)}It||at!=null||this.addHalfVertex(ce,fn.x+2*cn.x,fn.y+2*cn.y,!1,nn,0,le,Fn),at!=null&&Ae&&this.addCurrentVertex(ce,Ke||Ze,1,1,le,at)}else if(_t==="butt")this.addCurrentVertex(ce,an,0,0,le,at);else if(_t==="square"){if(!Se){const It=z?0:-1;this.addCurrentVertex(ce,an,It,It,le,at)}if(this.addCurrentVertex(ce,an,0,0,le,at),Se){const It=q?0:1;this.addCurrentVertex(ce,an,It,It,le,at)}}else if(_t==="round"){if(Se){const It=!qt&&tt?tt:Ee;this.addCurrentVertex(ce,It,0,0,le,at),!qt&&q||this.addCurrentVertex(ce,It,1,1,le,at,!0)}if(Ae){const It=!qt&&Ke?Ke:Ze;!qt&&z||this.addCurrentVertex(ce,It,-1,-1,le,at,!0),this.addCurrentVertex(ce,It,0,0,le,at)}}}}addVerticesTo(s,c,f,p,_,b,T,I,M,O){const z=(c.w-s.w)/this.tessellationStep|0;let q=0;const K=this.scaledDistance;if(z>1){this.lineSoFar=s.w;const ae=(c.x-s.x)/z,le=(c.y-s.y)/z,ce=(c.z-s.z)/z,Se=(c.w-s.w)/z;for(let Ae=1;Ae<z;++Ae){s.x+=ae,s.y+=le,s.z+=ce,this.lineSoFar+=Se,q+=Se;const Ee=this.evaluateLineProgressFeatures(this.prevDistance+q);this.scaledDistance=(this.prevDistance+q)/this.totalDistance,this.addHalfVertex(s,f,p,O,!1,T,M,Ee),this.addHalfVertex(s,_,b,O,!0,-I,M,Ee)}}this.lineSoFar=c.w,this.scaledDistance=K;const Y=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(c,f,p,O,!1,T,M,Y),this.addHalfVertex(c,_,b,O,!0,-I,M,Y)}evaluateLineProgressFeatures(s){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+s)/this.totalFeatureLength):ai(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let c=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(c=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:c}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:c}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:c}}addCurrentVertex(s,c,f,p,_,b,T=!1){const I=c.x+c.y*f,M=c.y-c.x*f,O=c.y*p-c.x,z=-c.y-c.x*p;if(b!=null){const q=this.elevationType==="offset",K=-10,Y=yn+10,ae=b.zOffset,le=new A7(s.x,s.y,ae,this.lineSoFar),ce=!!q&&dM(s,K,Y),Se=this.lineSoFar,Ae=this.distance;if(this.currentVertex)if(ce){const Ee=this.currentVertexIsOutside,Ze=this.currentVertex,Ke=new A7(s.x,s.y,ae,this.lineSoFar);if(C7(Ze,Ke,K,Y),!dM(Ke,K,Y)){if(Ee){this.e1=this.e2=-1,this.distance-=Ze.dist(le),this.lineSoFar=Ze.w;const tt=this.evaluateLineProgressFeatures(Ze.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Ze,I,M,T,!1,f,_,tt),this.addHalfVertex(Ze,O,z,T,!0,-p,_,tt),this.prevDistance=this.distance}this.distance=this.prevDistance+Ze.dist(Ke),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(Ze,Ke,I,M,O,z,f,p,_,T),this.distance=Ae,this.scaledDistance=this.distance/this.totalDistance}}else{const Ee=this.currentVertex;if(this.currentVertexIsOutside){C7(Ee,le,K,Y),this.e1=this.e2=-1,this.distance-=Ee.dist(le),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=Ee.w;const Ze=this.evaluateLineProgressFeatures(Ee.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Ee,I,M,T,!1,f,_,Ze),this.addHalfVertex(Ee,O,z,T,!0,-p,_,Ze),this.prevDistance=this.distance,this.distance=Ae,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(Ee,le,I,M,O,z,f,p,_,T)}else ce||(this.addHalfVertex(s,I,M,T,!1,f,_,b),this.addHalfVertex(s,O,z,T,!0,-p,_,b));this.currentVertex=le,this.currentVertexIsOutside=ce,this.lineSoFar=Se}else this.addHalfVertex(s,I,M,T,!1,f,_,b),this.addHalfVertex(s,O,z,T,!0,-p,_,b)}addHalfVertex({x:s,y:c},f,p,_,b,T,I,M){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),b||this.segmentPoints.push(this.lineSoFar-this.segmentStart,T)),this.layoutVertexArray.emplaceBack((s<<1)+(_?1:0),(c<<1)+(b?1:0),Math.round(63*f)+128,Math.round(63*p)+128,1+(T===0?0:T<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const z=qe(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,z)}const O=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,O),I.primitiveLength++),b?this.e2=O:this.e1=O,M!=null&&this.zOffsetVertexArray.emplaceBack(M.zOffset,M.variableWidth,M.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(s,c){this.prevDistance=this.distance,this.distance+=s.dist(c),this.updateScaledDistance()}}function dM(u,s,c){return u.x<s||u.x>c||u.y<s||u.y>c}let rU,iU;function sU(u,s,c){return s*(yn/(u.tileSize*Math.pow(2,c-u.tileID.overscaledZ)))}Pn(uM,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const aU=(u,s,c)=>(1-c)*u+c*s;function oU(u,s){return 1/sU(u,1,s.tileZoom)}function lU(u,s,c,f){return u.translatePosMatrix(f||s.tileID.projMatrix,s,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}const cU=u=>{const s=[];uU(u)&&s.push("RENDER_LINE_DASH"),u.paint.get("line-gradient")&&s.push("RENDER_LINE_GRADIENT");const c=u.paint.get("line-trim-offset");c[0]===0&&c[1]===0||s.push("RENDER_LINE_TRIM_OFFSET"),u.paint.get("line-border-width").constantOr(1)!==0&&s.push("RENDER_LINE_BORDER");const f=u.layout.get("line-join").constantOr("miter")==="none",p=!!u.paint.get("line-pattern").constantOr(1);return f&&p&&s.push("LINE_JOIN_NONE"),s};function uU(u){const s=u.paint.get("line-dasharray").value;return s.kind!=="constant"||s.value}let hM;const dU=()=>hM||(hM={layout:rU||(rU=new Zs({"line-cap":new wn(yt.layout_line["line-cap"]),"line-join":new wn(yt.layout_line["line-join"]),"line-miter-limit":new un(yt.layout_line["line-miter-limit"]),"line-round-limit":new un(yt.layout_line["line-round-limit"]),"line-sort-key":new wn(yt.layout_line["line-sort-key"]),"line-z-offset":new wn(yt.layout_line["line-z-offset"]),"line-elevation-reference":new un(yt.layout_line["line-elevation-reference"]),"line-cross-slope":new un(yt.layout_line["line-cross-slope"]),visibility:new un(yt.layout_line.visibility),"line-width-unit":new un(yt.layout_line["line-width-unit"])})),paint:iU||(iU=new Zs({"line-opacity":new wn(yt.paint_line["line-opacity"]),"line-color":new wn(yt.paint_line["line-color"]),"line-translate":new un(yt.paint_line["line-translate"]),"line-translate-anchor":new un(yt.paint_line["line-translate-anchor"]),"line-width":new wn(yt.paint_line["line-width"]),"line-gap-width":new wn(yt.paint_line["line-gap-width"]),"line-offset":new wn(yt.paint_line["line-offset"]),"line-blur":new wn(yt.paint_line["line-blur"]),"line-dasharray":new wn(yt.paint_line["line-dasharray"]),"line-pattern":new wn(yt.paint_line["line-pattern"]),"line-pattern-cross-fade":new un(yt.paint_line["line-pattern-cross-fade"]),"line-gradient":new Zf(yt.paint_line["line-gradient"]),"line-trim-offset":new un(yt.paint_line["line-trim-offset"]),"line-trim-fade-range":new un(yt.paint_line["line-trim-fade-range"]),"line-trim-color":new un(yt.paint_line["line-trim-color"]),"line-emissive-strength":new un(yt.paint_line["line-emissive-strength"]),"line-border-width":new wn(yt.paint_line["line-border-width"]),"line-border-color":new wn(yt.paint_line["line-border-color"]),"line-occlusion-opacity":new un(yt.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},hM);class mme extends wn{possiblyEvaluate(s,c){return c=new hs(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,transition:c.transition,worldview:c.worldview}),super.possiblyEvaluate(s,c)}evaluate(s,c,f,p){return c=Object.assign({},c,{zoom:Math.floor(c.zoom)}),super.evaluate(s,c,f,p)}}let M2;function hU(u,s){return s>0?s+2*u:u}const gme=Ti([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),yme=Ti([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),vme=Ti([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ti([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const _me=Ti([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),xme=Ti([{name:"a_x_axis",components:3,type:"Float32"},{name:"a_y_axis",components:3,type:"Float32"}]),bme=Ti([{name:"a_texb",components:2,type:"Uint16"}]),wme=Ti([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),Sme=Ti([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Ti([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const fU=Ti([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Ame=Ti([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ti([{name:"triangle",components:3,type:"Uint16"}]),Ti([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ti([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),Ti([{type:"Float32",name:"offsetX"}]),Ti([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var tl=24;function Tme(u,s,c){return u.sections.forEach(f=>{f.text=function(p,_,b){const T=_.layout.get("text-transform").evaluate(b,{});return T==="uppercase"?p=p.toLocaleUpperCase():T==="lowercase"&&(p=p.toLocaleLowerCase()),Fc.applyArabicShaping&&(p=Fc.applyArabicShaping(p)),p}(f.text,s,c)}),u}const L2={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function Cme(u){return u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""}function Eme(u){return u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""}const fM=4294967296,pU=1/fM,mU=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");let YT=class{constructor(u=new Uint8Array(16)){this.buf=ArrayBuffer.isView(u)?u:new Uint8Array(u),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(u,s,c=this.length){for(;this.pos<c;){const f=this.readVarint(),p=f>>3,_=this.pos;this.type=7&f,u(p,s,this),this.pos===_&&this.skip(f)}return s}readMessage(u,s){return this.readFields(u,s,this.readVarint()+this.pos)}readFixed32(){const u=this.dataView.getUint32(this.pos,!0);return this.pos+=4,u}readSFixed32(){const u=this.dataView.getInt32(this.pos,!0);return this.pos+=4,u}readFixed64(){const u=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*fM;return this.pos+=8,u}readSFixed64(){const u=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*fM;return this.pos+=8,u}readFloat(){const u=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,u}readDouble(){const u=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,u}readVarint(u){const s=this.buf;let c,f;return f=s[this.pos++],c=127&f,f<128?c:(f=s[this.pos++],c|=(127&f)<<7,f<128?c:(f=s[this.pos++],c|=(127&f)<<14,f<128?c:(f=s[this.pos++],c|=(127&f)<<21,f<128?c:(f=s[this.pos],c|=(15&f)<<28,function(p,_,b){const T=b.buf;let I,M;if(M=T[b.pos++],I=(112&M)>>4,M<128||(M=T[b.pos++],I|=(127&M)<<3,M<128)||(M=T[b.pos++],I|=(127&M)<<10,M<128)||(M=T[b.pos++],I|=(127&M)<<17,M<128)||(M=T[b.pos++],I|=(127&M)<<24,M<128)||(M=T[b.pos++],I|=(1&M)<<31,M<128))return p1(p,I,_);throw new Error("Expected varint not more than 10 bytes")}(c,u,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const u=this.readVarint();return u%2==1?(u+1)/-2:u/2}readBoolean(){return!!this.readVarint()}readString(){const u=this.readVarint()+this.pos,s=this.pos;return this.pos=u,u-s>=12&&mU?mU.decode(this.buf.subarray(s,u)):function(c,f,p){let _="",b=f;for(;b<p;){const T=c[b];let I,M,O,z=null,q=T>239?4:T>223?3:T>191?2:1;if(b+q>p)break;q===1?T<128&&(z=T):q===2?(I=c[b+1],(192&I)==128&&(z=(31&T)<<6|63&I,z<=127&&(z=null))):q===3?(I=c[b+1],M=c[b+2],(192&I)==128&&(192&M)==128&&(z=(15&T)<<12|(63&I)<<6|63&M,(z<=2047||z>=55296&&z<=57343)&&(z=null))):q===4&&(I=c[b+1],M=c[b+2],O=c[b+3],(192&I)==128&&(192&M)==128&&(192&O)==128&&(z=(15&T)<<18|(63&I)<<12|(63&M)<<6|63&O,(z<=65535||z>=1114112)&&(z=null))),z===null?(z=65533,q=1):z>65535&&(z-=65536,_+=String.fromCharCode(z>>>10&1023|55296),z=56320|1023&z),_+=String.fromCharCode(z),b+=q}return _}(this.buf,s,u)}readBytes(){const u=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,u);return this.pos=u,s}readPackedVarint(u=[],s){const c=this.readPackedEnd();for(;this.pos<c;)u.push(this.readVarint(s));return u}readPackedSVarint(u=[]){const s=this.readPackedEnd();for(;this.pos<s;)u.push(this.readSVarint());return u}readPackedBoolean(u=[]){const s=this.readPackedEnd();for(;this.pos<s;)u.push(this.readBoolean());return u}readPackedFloat(u=[]){const s=this.readPackedEnd();for(;this.pos<s;)u.push(this.readFloat());return u}readPackedDouble(u=[]){const s=this.readPackedEnd();for(;this.pos<s;)u.push(this.readDouble());return u}readPackedFixed32(u=[]){const s=this.readPackedEnd();for(;this.pos<s;)u.push(this.readFixed32());return u}readPackedSFixed32(u=[]){const s=this.readPackedEnd();for(;this.pos<s;)u.push(this.readSFixed32());return u}readPackedFixed64(u=[]){const s=this.readPackedEnd();for(;this.pos<s;)u.push(this.readFixed64());return u}readPackedSFixed64(u=[]){const s=this.readPackedEnd();for(;this.pos<s;)u.push(this.readSFixed64());return u}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(u){const s=7&u;if(s===0)for(;this.buf[this.pos++]>127;);else if(s===2)this.pos=this.readVarint()+this.pos;else if(s===5)this.pos+=4;else{if(s!==1)throw new Error(`Unimplemented type: ${s}`);this.pos+=8}}writeTag(u,s){this.writeVarint(u<<3|s)}realloc(u){let s=this.length||16;for(;s<this.pos+u;)s*=2;if(s!==this.length){const c=new Uint8Array(s);c.set(this.buf),this.buf=c,this.dataView=new DataView(c.buffer),this.length=s}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(u){this.realloc(4),this.dataView.setInt32(this.pos,u,!0),this.pos+=4}writeSFixed32(u){this.realloc(4),this.dataView.setInt32(this.pos,u,!0),this.pos+=4}writeFixed64(u){this.realloc(8),this.dataView.setInt32(this.pos,-1&u,!0),this.dataView.setInt32(this.pos+4,Math.floor(u*pU),!0),this.pos+=8}writeSFixed64(u){this.realloc(8),this.dataView.setInt32(this.pos,-1&u,!0),this.dataView.setInt32(this.pos+4,Math.floor(u*pU),!0),this.pos+=8}writeVarint(u){(u=+u||0)>268435455||u<0?function(s,c){let f,p;if(s>=0?(f=s%4294967296|0,p=s/4294967296|0):(f=~(-s%4294967296),p=~(-s/4294967296),4294967295^f?f=f+1|0:(f=0,p=p+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),function(_,b,T){T.buf[T.pos++]=127&_|128,_>>>=7,T.buf[T.pos++]=127&_|128,_>>>=7,T.buf[T.pos++]=127&_|128,_>>>=7,T.buf[T.pos++]=127&_|128,T.buf[T.pos]=127&(_>>>=7)}(f,0,c),function(_,b){const T=(7&_)<<4;b.buf[b.pos++]|=T|((_>>>=3)?128:0),_&&(b.buf[b.pos++]=127&_|((_>>>=7)?128:0),_&&(b.buf[b.pos++]=127&_|((_>>>=7)?128:0),_&&(b.buf[b.pos++]=127&_|((_>>>=7)?128:0),_&&(b.buf[b.pos++]=127&_|((_>>>=7)?128:0),_&&(b.buf[b.pos++]=127&_)))))}(p,c)}(u,this):(this.realloc(4),this.buf[this.pos++]=127&u|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))}writeSVarint(u){this.writeVarint(u<0?2*-u-1:2*u)}writeBoolean(u){this.writeVarint(+u)}writeString(u){u=String(u),this.realloc(4*u.length),this.pos++;const s=this.pos;this.pos=function(f,p,_){for(let b,T,I=0;I<p.length;I++){if(b=p.charCodeAt(I),b>55295&&b<57344){if(!T){b>56319||I+1===p.length?(f[_++]=239,f[_++]=191,f[_++]=189):T=b;continue}if(b<56320){f[_++]=239,f[_++]=191,f[_++]=189,T=b;continue}b=T-55296<<10|b-56320|65536,T=null}else T&&(f[_++]=239,f[_++]=191,f[_++]=189,T=null);b<128?f[_++]=b:(b<2048?f[_++]=b>>6|192:(b<65536?f[_++]=b>>12|224:(f[_++]=b>>18|240,f[_++]=b>>12&63|128),f[_++]=b>>6&63|128),f[_++]=63&b|128)}return _}(this.buf,u,this.pos);const c=this.pos-s;c>=128&&gU(s,c,this),this.pos=s-1,this.writeVarint(c),this.pos+=c}writeFloat(u){this.realloc(4),this.dataView.setFloat32(this.pos,u,!0),this.pos+=4}writeDouble(u){this.realloc(8),this.dataView.setFloat64(this.pos,u,!0),this.pos+=8}writeBytes(u){const s=u.length;this.writeVarint(s),this.realloc(s);for(let c=0;c<s;c++)this.buf[this.pos++]=u[c]}writeRawMessage(u,s){this.pos++;const c=this.pos;u(s,this);const f=this.pos-c;f>=128&&gU(c,f,this),this.pos=c-1,this.writeVarint(f),this.pos+=f}writeMessage(u,s,c){this.writeTag(u,2),this.writeRawMessage(s,c)}writePackedVarint(u,s){s.length&&this.writeMessage(u,Pme,s)}writePackedSVarint(u,s){s.length&&this.writeMessage(u,kme,s)}writePackedBoolean(u,s){s.length&&this.writeMessage(u,Mme,s)}writePackedFloat(u,s){s.length&&this.writeMessage(u,Ime,s)}writePackedDouble(u,s){s.length&&this.writeMessage(u,Nme,s)}writePackedFixed32(u,s){s.length&&this.writeMessage(u,Lme,s)}writePackedSFixed32(u,s){s.length&&this.writeMessage(u,Dme,s)}writePackedFixed64(u,s){s.length&&this.writeMessage(u,Rme,s)}writePackedSFixed64(u,s){s.length&&this.writeMessage(u,jme,s)}writeBytesField(u,s){this.writeTag(u,2),this.writeBytes(s)}writeFixed32Field(u,s){this.writeTag(u,5),this.writeFixed32(s)}writeSFixed32Field(u,s){this.writeTag(u,5),this.writeSFixed32(s)}writeFixed64Field(u,s){this.writeTag(u,1),this.writeFixed64(s)}writeSFixed64Field(u,s){this.writeTag(u,1),this.writeSFixed64(s)}writeVarintField(u,s){this.writeTag(u,0),this.writeVarint(s)}writeSVarintField(u,s){this.writeTag(u,0),this.writeSVarint(s)}writeStringField(u,s){this.writeTag(u,2),this.writeString(s)}writeFloatField(u,s){this.writeTag(u,5),this.writeFloat(s)}writeDoubleField(u,s){this.writeTag(u,1),this.writeDouble(s)}writeBooleanField(u,s){this.writeVarintField(u,+s)}};function p1(u,s,c){return c?4294967296*s+(u>>>0):4294967296*(s>>>0)+(u>>>0)}function gU(u,s,c){const f=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(7*Math.LN2));c.realloc(f);for(let p=c.pos-1;p>=u;p--)c.buf[p+f]=c.buf[p]}function Pme(u,s){for(let c=0;c<u.length;c++)s.writeVarint(u[c])}function kme(u,s){for(let c=0;c<u.length;c++)s.writeSVarint(u[c])}function Ime(u,s){for(let c=0;c<u.length;c++)s.writeFloat(u[c])}function Nme(u,s){for(let c=0;c<u.length;c++)s.writeDouble(u[c])}function Mme(u,s){for(let c=0;c<u.length;c++)s.writeBoolean(u[c])}function Lme(u,s){for(let c=0;c<u.length;c++)s.writeFixed32(u[c])}function Dme(u,s){for(let c=0;c<u.length;c++)s.writeSFixed32(u[c])}function Rme(u,s){for(let c=0;c<u.length;c++)s.writeFixed64(u[c])}function jme(u,s){for(let c=0;c<u.length;c++)s.writeSFixed64(u[c])}const pM=3;function Ome(u,s,c){s.glyphs=[],u===1&&c.readMessage(Fme,s)}function Fme(u,s,c){if(u===3){const{id:f,bitmap:p,width:_,height:b,left:T,top:I,advance:M}=c.readMessage(zme,{});s.glyphs.push({id:f,bitmap:new t0({width:_+2*pM,height:b+2*pM},p),metrics:{width:_,height:b,left:T,top:I,advance:M}})}else u===4?s.ascender=c.readSVarint():u===5&&(s.descender=c.readSVarint())}function zme(u,s,c){u===1?s.id=c.readVarint():u===2?s.bitmap=c.readBytes():u===3?s.width=c.readVarint():u===4?s.height=c.readVarint():u===5?s.left=c.readSVarint():u===6?s.top=c.readSVarint():u===7&&(s.advance=c.readVarint())}const yU=pM,qu={horizontal:1,vertical:2,horizontalOnly:3};class D2{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(s,c){const f=new D2;return f.scale=s||1,f.fontStack=c,f}static forImage(s){const c=new D2;return c.image=s,c}}class m1{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,c,f){const p=new m1;for(let _=0;_<s.sections.length;_++){const b=s.sections[_];b.image?p.addImageSection(b,f):p.addTextSection(b,c)}return p}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSections(){return this.sections}getSectionIndex(s){return this.sectionIndex[s]}getCodePoint(s){return this.text.codePointAt(s)}verticalizePunctuation(s){this.text=function(c,f){let p="";for(let _=0;_<c.length;_++){const b=c.charCodeAt(_+1)||null,T=c.charCodeAt(_-1)||null;p+=!f&&(b&&au(b)&&!L2[c[_+1]]||T&&au(T)&&!L2[c[_-1]])||!L2[c[_]]?c[_]:L2[c[_]]}return p}(this.text,s)}trim(){let s=0;for(let f=0;f<this.text.length&&XT[this.text.charCodeAt(f)];f++)s++;let c=this.text.length;for(let f=this.text.length-1;f>=0&&f>=s&&XT[this.text.charCodeAt(f)];f--)c--;this.text=this.text.substring(s,c),this.sectionIndex=this.sectionIndex.slice(s,c)}substring(s,c){const f=new m1;return f.text=this.text.substring(s,c),f.sectionIndex=this.sectionIndex.slice(s,c),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,c)=>Math.max(s,this.sections[c].scale),0)}addTextSection(s,c){this.text+=s.text,this.sections.push(D2.forText(s.scale,s.fontStack||c));const f=this.sections.length-1;for(let p=0;p<s.text.length;++p)this.sectionIndex.push(f)}addImageSection(s,c){const f=s.image?s.image.getPrimary():null;if(!f)return void ai("Can't add FormattedSection with an empty image.");f.scaleSelf(c);const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCodePoint(p),this.sections.push(D2.forImage(f)),this.sectionIndex.push(this.sections.length-1)):ai("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function mM(u,s,c,f,p,_,b,T,I,M,O,z,q,K,Y,ae=1){const le=m1.fromFeature(u,p,ae);z===qu.vertical&&le.verticalizePunctuation(q);let ce=[];const Se=function(tt,at,ct,qt,_t,Xt){if(!tt)return[];const an=[],Jt=function(nn,Lt,It,fn,cn,tr){let Fn=0;for(let qn=0;qn<nn.length();qn++){const vn=nn.getSection(qn);Fn+=vU(nn.getCodePoint(qn),vn,fn,cn,Lt,tr)}return Fn/Math.max(1,Math.ceil(Fn/It))}(tt,at,ct,qt,_t,Xt),en=tt.text.indexOf("")>=0;let hn=0;for(let nn=0;nn<tt.length();nn++){const Lt=tt.getSection(nn),It=tt.getCodePoint(nn);if(XT[It]||(hn+=vU(It,Lt,qt,_t,at,Xt)),nn<tt.length()-1){const fn=!((Vt=It)<11904||!(nr["Bopomofo Extended"](Vt)||nr.Bopomofo(Vt)||nr["CJK Compatibility Forms"](Vt)||nr["CJK Compatibility Ideographs"](Vt)||nr["CJK Compatibility"](Vt)||nr["CJK Radicals Supplement"](Vt)||nr["CJK Strokes"](Vt)||nr["CJK Symbols and Punctuation"](Vt)||nr["CJK Unified Ideographs Extension A"](Vt)||nr["CJK Unified Ideographs"](Vt)||nr["Enclosed CJK Letters and Months"](Vt)||nr["Halfwidth and Fullwidth Forms"](Vt)||nr.Hiragana(Vt)||nr["Ideographic Description Characters"](Vt)||nr["Kangxi Radicals"](Vt)||nr["Katakana Phonetic Extensions"](Vt)||nr.Katakana(Vt)||nr["Vertical Forms"](Vt)||nr["Yi Radicals"](Vt)||nr["Yi Syllables"](Vt)));(Bme[It]||fn||Lt.image)&&an.push(xU(nn+1,hn,Jt,an,Ume(It,tt.getCodePoint(nn+1),fn&&en),!1))}}var Vt;return bU(xU(tt.length(),hn,Jt,an,0,!0))}(le,M,_,s,f,K),{processBidirectionalText:Ae,processStyledBidirectionalText:Ee}=Fc;if(Ae&&le.sections.length===1){const tt=Ae(le.toString(),Se);for(const at of tt){const ct=new m1;ct.text=at,ct.sections=le.sections;for(let qt=0;qt<at.length;qt++)ct.sectionIndex.push(0);ce.push(ct)}}else if(Ee){const tt=Ee(le.text,le.sectionIndex,Se);for(const at of tt){const ct=new m1;ct.text=at[0],ct.sectionIndex=at[1],ct.sections=le.sections,ce.push(ct)}}else ce=function(tt,at){const ct=[],qt=tt.text;let _t=0;for(const Xt of at)ct.push(tt.substring(_t,Xt)),_t=Xt;return _t<qt.length&&ct.push(tt.substring(_t,qt.length)),ct}(le,Se);const Ze=[],Ke={positionedLines:Ze,text:le.toString(),top:O[1],bottom:O[1],left:O[0],right:O[0],writingMode:z,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(tt,at,ct,qt,_t,Xt,an,Jt,en,hn,Vt,nn){let Lt=0,It=0,fn=0;const cn=Jt==="right"?1:Jt==="left"?0:.5;let tr=!1;for(const En of _t){const Yn=En.getSections();for(const pr of Yn){if(pr.image)continue;const Lr=at[pr.fontStack];if(Lr&&(tr=Lr.ascender!==void 0&&Lr.descender!==void 0,!tr))break}if(!tr)break}let Fn=0;for(const En of _t){En.trim();const Yn=En.getMaxScale(),pr=(Yn-1)*tl,Lr={positionedGlyphs:[],lineOffset:0};tt.positionedLines[Fn]=Lr;const ii=Lr.positionedGlyphs;let zr=0;if(!En.length()){It+=Xt,++Fn;continue}let Bn=0,jr=0;for(let Me=0;Me<En.length();Me++){const Le=En.getSection(Me),Mt=En.getSectionIndex(Me),$t=En.getCodePoint(Me);let Tn=Le.scale,An=null,zn=null,or=null,si=tl,oi=0,Jr=en;Jr===qu.vertical&&((qn=$t)===12312||qn===12313||qn===12316||qn===12540||qn===12448)&&(Jr=qu.horizontal);const Xi=!(Jr===qu.horizontal||!Vt&&!Cd($t)||Vt&&(XT[$t]||pl($t)));if(Le.image){const qs=qt.get(Le.image.toString());if(!qs)continue;or=Le.image,tt.iconsInText=tt.iconsInText||!0,zn=qs.paddedRect;const Kr=qs.displaySize;Tn=Tn*tl/nn,An={width:Kr[0],height:Kr[1],left:0,top:-yU,advance:Xi?Kr[1]:Kr[0],localGlyph:!1},oi=tr?-An.height*Tn:Yn*tl-17-Kr[1]*Tn,si=An.advance;const Ss=(Xi?Kr[0]:Kr[1])*Tn-tl*Yn;Ss>0&&Ss>zr&&(zr=Ss)}else{const qs=ct[Le.fontStack];if(!qs)continue;qs[$t]&&(zn=qs[$t]);const Kr=at[Le.fontStack];if(!Kr)continue;const Ss=Kr.glyphs[$t];if(!Ss)continue;if(An=Ss.metrics,si=$t!==8203?tl:0,tr){const ns=Kr.ascender!==void 0?Math.abs(Kr.ascender):0,Oi=Kr.descender!==void 0?Math.abs(Kr.descender):0,Es=(ns+Oi)*Tn;Bn<Es&&(Bn=Es,jr=(ns-Oi)/2*Tn),oi=-ns*Tn}else oi=(Yn-Tn)*tl-17}Xi?(tt.verticalizable=!0,ii.push({glyph:$t,image:or,x:Lt,y:It+oi,vertical:Xi,scale:Tn,localGlyph:An.localGlyph,fontStack:Le.fontStack,sectionIndex:Mt,metrics:An,rect:zn}),Lt+=si*Tn+hn):(ii.push({glyph:$t,image:or,x:Lt,y:It+oi,vertical:Xi,scale:Tn,localGlyph:An.localGlyph,fontStack:Le.fontStack,sectionIndex:Mt,metrics:An,rect:zn}),Lt+=An.advance*Tn+hn)}ii.length!==0&&(fn=Math.max(Lt-hn,fn),tr?wU(ii,cn,zr,jr,Xt*Yn/2):wU(ii,cn,zr,0,Xt/2)),Lt=0;const ki=Xt*Yn+zr;Lr.lineOffset=Math.max(zr,pr),It+=ki,++Fn}var qn;const vn=It,{horizontalAlign:er,verticalAlign:Ir}=gM(an);(function(En,Yn,pr,Lr,ii,zr){const Bn=(Yn-pr)*ii,jr=-zr*Lr;for(const ki of En)for(const Me of ki.positionedGlyphs)Me.x+=Bn,Me.y+=jr})(tt.positionedLines,cn,er,Ir,fn,vn),tt.top+=-Ir*vn,tt.bottom=tt.top+vn,tt.left+=-er*fn,tt.right=tt.left+fn,tt.hasBaseline=tr}(Ke,s,c,f,ce,b,T,I,z,M,q,Y),!function(tt){for(const at of tt)if(at.positionedGlyphs.length!==0)return!1;return!0}(Ze))return Ke}const XT={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Bme={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function vU(u,s,c,f,p,_){if(s.image){const b=f.get(s.image.toString());return b?b.displaySize[0]*s.scale*tl/_+p:0}{const b=c[s.fontStack],T=b&&b.glyphs[u];return T?T.metrics.advance*s.scale+p:0}}function _U(u,s,c,f){const p=Math.pow(u-s,2);return f?u<s?p/2:2*p:p+Math.abs(c)*c}function Ume(u,s,c){let f=0;return u===10&&(f-=1e4),c&&(f+=150),u!==40&&u!==65288||(f+=50),s!==41&&s!==65289||(f+=50),f}function xU(u,s,c,f,p,_){let b=null,T=_U(s,c,p,_);for(const I of f){const M=_U(s-I.x,c,p,_)+I.badness;M<=T&&(b=I,T=M)}return{index:u,x:s,priorBreak:b,badness:T}}function bU(u){return u?bU(u.priorBreak).concat(u.index):[]}function gM(u){let s=.5,c=.5;switch(u){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:s,verticalAlign:c}}function wU(u,s,c,f,p){if(!(s||c||f||p))return;const _=u.length-1,b=u[_],T=(b.x+b.metrics.advance*b.scale)*s;for(let I=0;I<=_;I++)u[I].x-=T,u[I].y+=c+f+p}function SU(u){return u.imagePrimary!==void 0&&u.top!==void 0&&u.bottom!==void 0&&u.left!==void 0&&u.right!==void 0}function Vme(u,s,c,f){const{horizontalAlign:p,verticalAlign:_}=gM(f),b=c[0]-u.displaySize[0]*p,T=c[1]-u.displaySize[1]*_;return{imagePrimary:u,imageSecondary:s,top:T,bottom:T+u.displaySize[1],left:b,right:b+u.displaySize[0]}}function AU(u,s,c,f,p,_){const b=u.imagePrimary;let T;if(b.content){const le=b.content,ce=b.pixelRatio||1;T=[le[0]/ce,le[1]/ce,b.displaySize[0]-le[2]/ce,b.displaySize[1]-le[3]/ce]}const I=s.left*_,M=s.right*_;let O,z,q,K;c==="width"||c==="both"?(K=p[0]+I-f[3],z=p[0]+M+f[1]):(K=p[0]+(I+M-b.displaySize[0])/2,z=K+b.displaySize[0]);const Y=s.top*_,ae=s.bottom*_;return c==="height"||c==="both"?(O=p[1]+Y-f[0],q=p[1]+ae+f[2]):(O=p[1]+(Y+ae-b.displaySize[1])/2,q=O+b.displaySize[1]),{imagePrimary:b,imageSecondary:void 0,top:O,right:z,bottom:q,left:K,collisionPadding:T}}function TU(u){return!u.imagePrimary.stretchX}function CU(u){return!u.imagePrimary.stretchY}function EU(u){return{width:u.right-u.left,height:u.bottom-u.top}}const hm=128;function PU(u,s,c){const{expression:f}=s;if(f.kind==="constant")return{kind:"constant",layoutSize:f.evaluate(new hs(u+1,{worldview:c}))};if(f.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:_}=f;let b=0;for(;b<p.length&&p[b]<=u;)b++;b=Math.max(0,b-1);let T=b;for(;T<p.length&&p[T]<u+1;)T++;T=Math.min(p.length-1,T);const I=p[b],M=p[T];return f.kind==="composite"?{kind:"composite",minZoom:I,maxZoom:M,interpolationType:_}:{kind:"camera",minZoom:I,maxZoom:M,minSize:f.evaluate(new hs(I,{worldview:c})),maxSize:f.evaluate(new hs(M,{worldview:c})),interpolationType:_}}}function yM(u,{uSize:s,uSizeT:c},{lowerSize:f,upperSize:p}){return u.kind==="source"?f/hm:u.kind==="composite"?qe(f/hm,p/hm,c):s}function R2(u,s,c=1){let f=0,p=0;if(u.kind==="constant")p=u.layoutSize*c;else if(u.kind!=="source"){const{interpolationType:_,minZoom:b,maxZoom:T}=u,I=_?We(Oc.interpolationFactor(_,s,b,T),0,1):0;u.kind==="camera"?p=qe(u.minSize,u.maxSize,I)*c:f=I*c}return{uSizeT:f,uSize:p}}class Tg extends zt{constructor(s,c,f,p,_){super(s,c),this.angle=p,this.z=f,_!==void 0&&(this.segment=_)}clone(){return new Tg(this.x,this.y,this.z,this.angle,this.segment)}}function kU(u,s,c,f,p){if(s.segment===void 0)return!0;let _=s,b=s.segment+1,T=0;for(;T>-c/2;){if(b--,b<0)return!1;T-=u[b].dist(_),_=u[b]}T+=u[b].dist(u[b+1]),b++;const I=[];let M=0;for(;T<c/2;){const O=u[b],z=u[b+1];if(!z)return!1;let q=u[b-1].angleTo(O)-O.angleTo(z);for(q=Math.abs((q+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:T,angleDelta:q}),M+=q;T-I[0].distance>f;)M-=I.shift().angleDelta;if(M>p)return!1;b++,T+=O.dist(z)}return!0}function IU(u){let s=0;for(let c=0;c<u.length-1;c++)s+=u[c].dist(u[c+1]);return s}function NU(u,s,c){return u?.6*s*c:0}function MU(u,s){return Math.max(u?u.right-u.left:0,s?s.right-s.left:0)}function $me(u,s,c,f,p,_){const b=NU(c,p,_),T=MU(c,f)*_;let I=0;const M=IU(u)/2;for(let O=0;O<u.length-1;O++){const z=u[O],q=u[O+1],K=z.dist(q);if(I+K>M){const Y=(M-I)/K,ae=qe(z.x,q.x,Y),le=qe(z.y,q.y,Y),ce=new Tg(ae,le,0,q.angleTo(z),O);return!b||kU(u,ce,T,b,s)?ce:void 0}I+=K}}function qme(u,s,c,f,p,_,b,T,I){const M=NU(f,_,b),O=MU(f,p),z=O*b,q=u[0].x===0||u[0].x===I||u[0].y===0||u[0].y===I;return s-z<s/4&&(s=z+s/4),LU(u,q?s/2*T%s:(O/2+2*_)*b*T%s,s,M,c,z,q,!1,I)}function LU(u,s,c,f,p,_,b,T,I){const M=_/2,O=IU(u);let z=0,q=s-c,K=[];for(let Y=0;Y<u.length-1;Y++){const ae=u[Y],le=u[Y+1],ce=ae.dist(le),Se=le.angleTo(ae);for(;q+c<z+ce;){q+=c;const Ae=(q-z)/ce,Ee=qe(ae.x,le.x,Ae),Ze=qe(ae.y,le.y,Ae);if(Ee>=0&&Ee<I&&Ze>=0&&Ze<I&&q-M>=0&&q+M<=O){const Ke=new Tg(Ee,Ze,0,Se,Y);f&&!kU(u,Ke,_,f,p)||K.push(Ke)}}z+=ce}return T||K.length||b||(K=LU(u,z/2,c,f,p,_,b,!0,I)),K}function DU(u){let s=0,c=0;for(const b of u)s+=b.w*b.h,c=Math.max(c,b.w);u.sort((b,T)=>T.h-b.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),c),h:1/0}];let p=0,_=0;for(const b of u)for(let T=f.length-1;T>=0;T--){const I=f[T];if(!(b.w>I.w||b.h>I.h)){if(b.x=I.x,b.y=I.y,_=Math.max(_,b.y+b.h),p=Math.max(p,b.x+b.w),b.w===I.w&&b.h===I.h){const M=f.pop();M&&T<f.length&&(f[T]=M)}else b.h===I.h?(I.x+=b.w,I.w-=b.w):b.w===I.w?(I.y+=b.h,I.h-=b.h):(f.push({x:I.x+b.w,y:I.y,w:I.w-b.w,h:b.h}),I.y+=b.h,I.h-=b.h);break}}return{w:p,h:_,fill:s/(p*_)||0}}Pn(Tg,"Anchor");const h_=1;class j2{static getImagePositionScale(s,c,f){if(c&&s&&s.options&&s.options.transform){const p=s.options.transform;return{x:p.a,y:p.d}}return{x:f,y:f}}constructor(s,c,f,p){this.paddedRect=s;const{pixelRatio:_,version:b,stretchX:T,stretchY:I,content:M,sdf:O,usvg:z}=c;this.pixelRatio=_,this.stretchX=T,this.stretchY=I,this.content=M,this.version=b,this.padding=f,this.sdf=O,this.usvg=z,this.scale=j2.getImagePositionScale(p,z,_)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function vM(u,s,c){const f=Ta.parse(u),p=function(_,b,T=[1,1]){return{x:0,y:0,w:(_.data?_.data.width:_.width*T[0])+2*b,h:(_.data?_.data.height:_.height*T[1])+2*b}}(s,c,[f.options.transform.a,f.options.transform.d]);return{bin:p,imagePosition:new j2(p,s,c,f),imageVariant:f}}class RU{constructor(s,c,f){const p=new Map,_=new Map;this.haveRenderCallbacks=[];const b=[];this.addImages(s,p,h_,b),this.addImages(c,_,2,b);const{w:T,h:I}=DU(b),M=new Ll({width:T||1,height:I||1});for(const[O,z]of s.entries()){const q=p.get(O).paddedRect;Ll.copy(z.data,M,{x:0,y:0},{x:q.x+h_,y:q.y+h_},z.data,null,z.sdf)}for(const[O,z]of c.entries()){const q=_.get(O),K=q.paddedRect;let Y=q.padding;const ae=K.x+Y,le=K.y+Y,ce=z.data.width,Se=z.data.height;Y=Y>1?Y-1:Y,Ll.copy(z.data,M,{x:0,y:0},{x:ae,y:le},z.data,f),Ll.copy(z.data,M,{x:0,y:Se-Y},{x:ae,y:le-Y},{width:ce,height:Y},f),Ll.copy(z.data,M,{x:0,y:0},{x:ae,y:le+Se},{width:ce,height:Y},f),Ll.copy(z.data,M,{x:ce-Y,y:0},{x:ae-Y,y:le},{width:Y,height:Se},f),Ll.copy(z.data,M,{x:0,y:0},{x:ae+ce,y:le},{width:Y,height:Se},f),Ll.copy(z.data,M,{x:ce-Y,y:Se-Y},{x:ae-Y,y:le-Y},{width:Y,height:Y},f),Ll.copy(z.data,M,{x:0,y:Se-Y},{x:ae+ce,y:le-Y},{width:Y,height:Y},f),Ll.copy(z.data,M,{x:0,y:0},{x:ae+ce,y:le+Se},{width:Y,height:Y},f),Ll.copy(z.data,M,{x:ce-Y,y:0},{x:ae-Y,y:le+Se},{width:Y,height:Y},f)}this.lut=f,this.image=M,this.iconPositions=p,this.patternPositions=_}addImages(s,c,f,p){for(const[_,b]of s.entries()){const{bin:T,imagePosition:I,imageVariant:M}=vM(_,b,f);c.set(_,I),p.push(T),b.hasRenderCallback&&this.haveRenderCallbacks.push(M.id)}}patchUpdatedImages(s,c,f){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(p=>s.hasImage(p,f)),s.dispatchRenderCallbacks(this.haveRenderCallbacks,f);for(const p of s.getUpdatedImages(f)){for(const _ of this.iconPositions.keys()){const b=Ta.parse(_);if(ho.isEqual(b.id,p)){const T=s.getImage(p,f);this.patchUpdatedImage(this.iconPositions.get(_),T,c,null)}}for(const _ of this.patternPositions.keys()){const b=Ta.parse(_);if(ho.isEqual(b.id,p)){const T=s.getImage(p,f);this.patchUpdatedImage(this.patternPositions.get(_),T,c,this.lut)}}}}patchUpdatedImage(s,c,f,p=null){if(!s||!c||s.version===c.version)return;s.version=c.version;const[_,b]=s.tl,T=s.sdf;if(this.lut||T){const I={width:c.data.width,height:c.data.height},M=new Ll(I);Ll.copy(c.data,M,{x:0,y:0},{x:0,y:0},I,p,T),f.update(M,{position:{x:_,y:b}})}else f.update(c.data,{position:{x:_,y:b}})}}Pn(j2,"ImagePosition"),Pn(RU,"ImageAtlas");const O2=1e20;function jU(u,s,c,f,p,_,b,T,I){for(let M=s;M<s+f;M++)OU(u,c*_+M,_,p,b,T,I);for(let M=c;M<c+p;M++)OU(u,M*_+s,1,f,b,T,I)}function OU(u,s,c,f,p,_,b){_[0]=0,b[0]=-O2,b[1]=O2,p[0]=u[s];for(let T=1,I=0,M=0;T<f;T++){p[T]=u[s+T*c];const O=T*T;do{const z=_[I];M=(p[T]-p[z]+O-z*z)/(T-z)/2}while(M<=b[I]&&--I>-1);I++,_[I]=T,b[I]=M,b[I+1]=O2}for(let T=0,I=0;T<f;T++){for(;b[I+1]<T;)I++;const M=_[I],O=T-M;u[s+T*c]=p[M]+O*O}}const tp=2,_M={none:0,ideographs:1,all:2};class g1{constructor(s,c,f){this.requestManager=s,this.localGlyphMode=c,this.localFontFamily=f,this.url="",this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(s){this.url=s}getGlyphs(s,c){const f=[],p=this.url||$o.GLYPHS_URL;for(const _ in s)for(const b of s[_])f.push({stack:_,id:b});Et(f,({stack:_,id:b},T)=>{let I=this.entries[_];I||(I=this.entries[_]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let M=I.glyphs[b];if(M!==void 0)return void T(null,{stack:_,id:b,glyph:M});if(M=this._tinySDF(I,_,b),M)return I.glyphs[b]=M,void T(null,{stack:_,id:b,glyph:M});const O=Math.floor(b/256);if(256*O>65535)return ai("glyphs > 65535 not supported"),void T(null,{stack:_,id:b,glyph:M});if(I.ranges[O])return void T(null,{stack:_,id:b,glyph:M});let z=I.requests[O];z||(z=I.requests[O]=[],g1.loadGlyphRange(_,O,p,this.requestManager,(q,K)=>{if(K){I.ascender=K.ascender,I.descender=K.descender;for(const Y in K.glyphs)this._doesCharSupportLocalGlyph(+Y)||(I.glyphs[+Y]=K.glyphs[+Y]);I.ranges[O]=!0}for(const Y of z)Y(q,K);delete I.requests[O]})),z.push((q,K)=>{q?T(q):K&&T(null,{stack:_,id:b,glyph:K.glyphs[b]||null})})},(_,b)=>{if(_)c(_);else if(b){const T={};for(const{stack:I,id:M,glyph:O}of b)T[I]===void 0&&(T[I]={}),T[I].glyphs===void 0&&(T[I].glyphs={}),T[I].glyphs[M]=O&&{id:O.id,bitmap:O.bitmap.clone(),metrics:O.metrics},T[I].ascender=this.entries[I].ascender,T[I].descender=this.entries[I].descender;c(null,T)}})}_doesCharSupportLocalGlyph(s){return this.localGlyphMode!==_M.none&&(this.localGlyphMode===_M.all?!!this.localFontFamily:!!this.localFontFamily&&(nr["CJK Unified Ideographs"](s)||nr["Hangul Syllables"](s)||nr.Hiragana(s)||nr.Katakana(s)||nr["CJK Symbols and Punctuation"](s)||nr["CJK Unified Ideographs Extension A"](s)||nr["CJK Unified Ideographs Extension B"](s)||nr.Osage(s)))}_tinySDF(s,c,f){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(f))return;let _=s.tinySDF;if(!_){let ae="400";/bold/i.test(c)?ae="900":/medium/i.test(c)?ae="500":/light/i.test(c)&&(ae="200"),_=s.tinySDF=new g1.TinySDF({fontFamily:p,fontWeight:ae,fontSize:24*tp,buffer:3*tp,radius:8*tp}),_.fontWeight=ae}if(this.localGlyphs[_.fontWeight][f])return this.localGlyphs[_.fontWeight][f];const b=String.fromCodePoint(f),{data:T,width:I,height:M,glyphWidth:O,glyphHeight:z,glyphLeft:q,glyphTop:K,glyphAdvance:Y}=_.draw(b);return this.localGlyphs[_.fontWeight][f]={id:f,bitmap:new t0({width:I,height:M},T),metrics:{width:O/tp,height:z/tp,left:q/tp,top:K/tp-27,advance:Y/tp,localGlyph:!0}}}}g1.loadGlyphRange=function(u,s,c,f,p){const _=256*s,b=_+255,T=f.transformRequest(f.normalizeGlyphsURL(c).replace("{fontstack}",u).replace("{range}",`${_}-${b}`),jp.Glyphs);uc(T,(I,M)=>{if(I)p(I);else if(M){const O={},z=function(q){return new YT(q).readFields(Ome,{})}(M);for(const q of z.glyphs)O[q.id]=q;p(null,{glyphs:O,ascender:z.ascender,descender:z.descender})}})},g1.TinySDF=class{constructor({fontSize:u=24,buffer:s=3,radius:c=8,cutoff:f=.25,fontFamily:p="sans-serif",fontWeight:_="normal",fontStyle:b="normal",lang:T=null}={}){this.buffer=s,this.cutoff=f,this.radius=c,this.lang=T;const I=this.size=u+4*s,M=this._createCanvas(I),O=this.ctx=M.getContext("2d",{willReadFrequently:!0});O.font=`${b} ${_} ${u}px ${p}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(I*I),this.gridInner=new Float64Array(I*I),this.f=new Float64Array(I),this.z=new Float64Array(I+1),this.v=new Uint16Array(I)}_createCanvas(u){const s=document.createElement("canvas");return s.width=s.height=u,s}draw(u){const{width:s,actualBoundingBoxAscent:c,actualBoundingBoxDescent:f,actualBoundingBoxLeft:p,actualBoundingBoxRight:_}=this.ctx.measureText(u),b=Math.ceil(c),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-p))),I=Math.min(this.size-this.buffer,b+Math.ceil(f)),M=T+2*this.buffer,O=I+2*this.buffer,z=Math.max(M*O,0),q=new Uint8ClampedArray(z),K={data:q,width:M,height:O,glyphWidth:T,glyphHeight:I,glyphTop:b,glyphLeft:0,glyphAdvance:s};if(T===0||I===0)return K;const{ctx:Y,buffer:ae,gridInner:le,gridOuter:ce}=this;this.lang&&(Y.lang=this.lang),Y.clearRect(ae,ae,T,I),Y.fillText(u,ae,ae+b);const Se=Y.getImageData(ae,ae,T,I);ce.fill(O2,0,z),le.fill(0,0,z);for(let Ae=0;Ae<I;Ae++)for(let Ee=0;Ee<T;Ee++){const Ze=Se.data[4*(Ae*T+Ee)+3]/255;if(Ze===0)continue;const Ke=(Ae+ae)*M+Ee+ae;if(Ze===1)ce[Ke]=0,le[Ke]=O2;else{const tt=.5-Ze;ce[Ke]=tt>0?tt*tt:0,le[Ke]=tt<0?tt*tt:0}}jU(ce,0,0,M,O,M,this.f,this.v,this.z),jU(le,ae,ae,T,I,M,this.f,this.v,this.z);for(let Ae=0;Ae<z;Ae++){const Ee=Math.sqrt(ce[Ae])-Math.sqrt(le[Ae]);q[Ae]=Math.round(255-255*(Ee/this.radius+this.cutoff))}return K}};const i0=h_;function FU(u,s){return u+s[1]-s[0]}function zU(u,s,c,f,p=1){const _=[],b=u.imagePrimary,T=b.pixelRatio,I=b.paddedRect.w-2*i0,M=b.paddedRect.h-2*i0,O=(u.right-u.left)*p,z=(u.bottom-u.top)*p,q=b.stretchX||[[0,I]],K=b.stretchY||[[0,M]],Y=q.reduce(FU,0),ae=K.reduce(FU,0),le=I-Y,ce=M-ae;let Se=0,Ae=Y,Ee=0,Ze=ae,Ke=0,tt=le,at=0,ct=ce;if(b.content&&f){const _t=b.content;Se=JT(q,0,_t[0]),Ee=JT(K,0,_t[1]),Ae=JT(q,_t[0],_t[2]),Ze=JT(K,_t[1],_t[3]),Ke=_t[0]-Se,at=_t[1]-Ee,tt=_t[2]-_t[0]-Ae,ct=_t[3]-_t[1]-Ze}const qt=(_t,Xt,an,Jt)=>{const en=QT(_t.stretch-Se,Ae,O,u.left*p),hn=eC(_t.fixed-Ke,tt,_t.stretch,Y),Vt=QT(Xt.stretch-Ee,Ze,z,u.top*p),nn=eC(Xt.fixed-at,ct,Xt.stretch,ae),Lt=QT(an.stretch-Se,Ae,O,u.left*p),It=eC(an.fixed-Ke,tt,an.stretch,Y),fn=QT(Jt.stretch-Ee,Ze,z,u.top*p),cn=eC(Jt.fixed-at,ct,Jt.stretch,ae),tr=new zt(en,Vt),Fn=new zt(Lt,Vt),qn=new zt(Lt,fn),vn=new zt(en,fn),er=new zt(hn/T,nn/T),Ir=new zt(It/T,cn/T),En=s*Math.PI/180;if(En){const Bn=Math.sin(En),jr=Math.cos(En),ki=[jr,-Bn,Bn,jr];tr._matMult(ki),Fn._matMult(ki),vn._matMult(ki),qn._matMult(ki)}const Yn=_t.stretch+_t.fixed,pr=an.stretch+an.fixed,Lr=Xt.stretch+Xt.fixed,ii=Jt.stretch+Jt.fixed,zr=u.imageSecondary;return{tl:tr,tr:Fn,bl:vn,br:qn,texPrimary:{x:b.paddedRect.x+i0+Yn,y:b.paddedRect.y+i0+Lr,w:pr-Yn,h:ii-Lr},texSecondary:zr?{x:zr.paddedRect.x+i0+Yn,y:zr.paddedRect.y+i0+Lr,w:pr-Yn,h:ii-Lr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:er,pixelOffsetBR:Ir,minFontScaleX:tt/T/O,minFontScaleY:ct/T/z,isSDF:c}};if(f&&(b.stretchX||b.stretchY)){const _t=BU(q,le,Y),Xt=BU(K,ce,ae);for(let an=0;an<_t.length-1;an++){const Jt=_t[an],en=_t[an+1];for(let hn=0;hn<Xt.length-1;hn++)_.push(qt(Jt,Xt[hn],en,Xt[hn+1]))}}else _.push(qt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:I+1},{fixed:0,stretch:M+1}));return _}function JT(u,s,c){let f=0;for(const p of u)f+=Math.max(s,Math.min(c,p[1]))-Math.max(s,Math.min(c,p[0]));return f}function BU(u,s,c){const f=[{fixed:-i0,stretch:0}];for(const[p,_]of u){const b=f[f.length-1];f.push({fixed:p-b.stretch,stretch:b.stretch}),f.push({fixed:p-b.stretch,stretch:b.stretch+(_-p)})}return f.push({fixed:s+i0,stretch:c}),f}function QT(u,s,c,f){return u/s*c+f}function eC(u,s,c,f){return u-s*c/f}function Gme(u,s,c,f){const p=s+u.positionedLines[f].lineOffset;return f===0?c+p/2:c+(p+(s+u.positionedLines[f-1].lineOffset))/2}function Hme(u,s=1,c=!1){let f=1/0,p=1/0,_=-1/0,b=-1/0;const T=u[0];for(let K=0;K<T.length;K++){const Y=T[K];(!K||Y.x<f)&&(f=Y.x),(!K||Y.y<p)&&(p=Y.y),(!K||Y.x>_)&&(_=Y.x),(!K||Y.y>b)&&(b=Y.y)}const I=Math.min(_-f,b-p);let M=I/2;const O=new ag([],Wme);if(I===0)return new zt(f,p);for(let K=f;K<_;K+=I)for(let Y=p;Y<b;Y+=I)O.push(new y1(K+M,Y+M,M,u));let z=function(K){let Y=0,ae=0,le=0;const ce=K[0];for(let Se=0,Ae=ce.length,Ee=Ae-1;Se<Ae;Ee=Se++){const Ze=ce[Se],Ke=ce[Ee],tt=Ze.x*Ke.y-Ke.x*Ze.y;ae+=(Ze.x+Ke.x)*tt,le+=(Ze.y+Ke.y)*tt,Y+=3*tt}return new y1(ae/Y,le/Y,0,K)}(u),q=O.length;for(;O.length;){const K=O.pop();(K.d>z.d||!z.d)&&(z=K,c&&console.log("found best %d after %d probes",Math.round(1e4*K.d)/1e4,q)),K.max-z.d<=s||(M=K.h/2,O.push(new y1(K.p.x-M,K.p.y-M,M,u)),O.push(new y1(K.p.x+M,K.p.y-M,M,u)),O.push(new y1(K.p.x-M,K.p.y+M,M,u)),O.push(new y1(K.p.x+M,K.p.y+M,M,u)),q+=4)}return c&&(console.log(`num probes: ${q}`),console.log(`best distance: ${z.d}`)),z.p}function Wme(u,s){return s.max-u.max}class y1{constructor(s,c,f,p){this.p=new zt(s,c),this.h=f,this.d=function(_,b){let T=!1,I=1/0;for(let M=0;M<b.length;M++){const O=b[M];for(let z=0,q=O.length,K=q-1;z<q;K=z++){const Y=O[z],ae=O[K];Y.y>_.y!=ae.y>_.y&&_.x<(ae.x-Y.x)*(_.y-Y.y)/(ae.y-Y.y)+Y.x&&(T=!T),I=Math.min(I,Ys(_,Y,ae))}}return(T?1:-1)*Math.sqrt(I)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}}const Zme=Object.keys,xM=Number.POSITIVE_INFINITY,Kme=Math.sqrt(2);function UU(u,[s,c]){let f=0,p=0;if(c===xM){s<0&&(s=0);const _=s/Kme;switch(u){case"top-right":case"top-left":p=_-7;break;case"bottom-right":case"bottom-left":p=7-_;break;case"bottom":p=7-s;break;case"top":p=s-7}switch(u){case"top-right":case"bottom-right":f=-_;break;case"top-left":case"bottom-left":f=_;break;case"left":f=s;break;case"right":f=-s}}else{switch(s=Math.abs(s),c=Math.abs(c),u){case"top-right":case"top-left":case"top":p=c-7;break;case"bottom-right":case"bottom-left":case"bottom":p=7-c}switch(u){case"top-right":case"bottom-right":case"right":f=-s;break;case"top-left":case"bottom-left":case"left":f=s}}return[f,p]}function tC(u,s,c,f,p,_,b,T,I){if(!s||!s.usvg)return;const M=EU(f),O=EU(p),z=_!=="both"&&_!=="width"||!TU(f)?1:O.width/M.width,q=_!=="both"&&_!=="height"||!CU(f)?1:O.height/M.height;c.scaleSelf(z,q);const K=c.toString();b.set(K,c),T.set(K,s);const{imagePosition:Y}=vM(K,s,h_);I.set(K,Y)}function VU(u,s,c,f,p,_,b,T,I){if(!u)return;const M=function(O,z,q,K,Y,ae){if(O.kind==="camera")return O.maxSize;if(O.kind==="composite"){const le=z.possiblyEvaluate(new hs(O.maxZoom,{worldview:ae}),q).evaluate(Y,{},q),ce=z.possiblyEvaluate(new hs(O.minZoom,{worldview:ae}),q).evaluate(Y,{},q);return Math.max(le,ce)}return z.possiblyEvaluate(new hs(K,{worldview:ae})).evaluate(Y,{},q)}(s,c,f,p,_,I);return u.scaleSelf(M*T*b)}function $U(u,s,c,f,p,_,b,T,I){return{iconPrimary:VU(u.getPrimary(),s,c,f,p,_,b,T,I),iconSecondary:VU(u.getSecondary(),s,c,f,p,_,b,T,I)}}function Yme(u,s,c){if(!s)return;const f=c.get(u.toString()),p=c.get(s.toString());f&&p&&(f.paddedRect.w===p.paddedRect.w&&f.paddedRect.h===p.paddedRect.h||ai(`Mismatch in icon variant sizes: ${u.toString()} and ${s.toString()}`),f.usvg!==p.usvg&&ai(`Mismatch in icon variant image types: ${u.id} and ${s.id}`))}function qU(u,s,c,f){if(!u)return;const p=s.get(c.toString());if(u.imagePrimary=p,f){const _=s.get(f.toString());u.imageSecondary=_}}function Xme(u,s){for(const c in u.horizontal)GU(u.horizontal[c],s);GU(u.vertical,s)}function GU(u,s){if(u){for(const c of u.positionedLines)for(const f of c.positionedGlyphs)if(f.image!==null){const p=f.image.toString();f.rect=s.get(p).paddedRect}}}function bM(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Jme(u,s,c,f,p,_,b,T,I){const M=wM(_.horizontal)||_.vertical,O=c.get("icon-text-fit-padding").evaluate(f,{},p);let z,q=s;return s&&I!=="none"&&(u.allowVerticalPlacement&&_.vertical&&(z=AU(s,_.vertical,I,O,T,b)),M&&(q=AU(s,M,I,O,T,b))),{defaultShapedIcon:q,verticallyShapedIcon:z}}function Qme(u,s,c,f,p,_,b,T,I,M,O,z,q,K,Y,ae,le,ce,Se,Ae){let Ee=b.textMaxSize.evaluate(s,{},q);Ee===void 0?Ee=T*b.textScaleFactor:Ee*=b.textScaleFactor;const Ze=u.layers[0].layout,Ke=wM(c.horizontal)||c.vertical,tt=K.name==="globe",at=tl,ct=u.tilePixelRatio*Ee/at,qt=(hn=u.overscaling,u.zoom>18&&hn>2&&(hn>>=1),Math.max(yn/(512*hn),1)*Ze.get("symbol-spacing")),_t=Ze.get("text-padding")*u.tilePixelRatio,Xt=Ze.get("icon-padding")*u.tilePixelRatio,an=lt(Ze.get("text-max-angle")),Jt=Ze.get("icon-rotation-alignment")==="map"&&Ae!=="point",en=qt/2;var hn;u.hasAnyIconTextFit===!1&&le!=="none"&&(u.hasAnyIconTextFit=!0);const Vt=s.properties?+s.properties[Wr]:null,nn=Vt&&u.elevationFeatureIdToIndex?u.elevationFeatureIdToIndex.get(Vt):65535,Lt=(It,fn,cn)=>{if(fn.x<0||fn.x>=yn||fn.y<0||fn.y>=yn)return;let tr=null;if(tt){const{x:Fn,y:qn,z:vn}=K.projectTilePoint(fn.x,fn.y,cn);tr={anchor:new Tg(Fn,qn,vn,0,void 0),up:K.upVector(cn,fn.x,fn.y)}}(function(Fn,qn,vn,er,Ir,En,Yn,pr,Lr,ii,zr,Bn,jr,ki,Me,Le,Mt,$t,Tn,An,zn,or,si,oi,Jr,Xi,qs,Kr,Ss){const ns=Fn.addToLineVertexArray(qn,er);let Oi,Es,Ps,gs,As,rs,li,os=0,ea=0,yr=0,Ni=0,ks=-1,ca=-1;const js={};let oo=Oh("");const fs=vn?vn.anchor:qn,Wa=Kr!=="none";let hu=0,Dl=0;if(Lr._unevaluatedLayout.getValue("text-radial-offset")===void 0){const lo=Lr.layout.get("text-offset").evaluate(zn,{},Jr);hu=lo[0]*tl,Dl=lo[1]*tl}else hu=Lr.layout.get("text-radial-offset").evaluate(zn,{},Jr)*tl,Dl=xM;if(Fn.allowVerticalPlacement&&Ir.vertical){const lo=Ir.vertical;if(Me)rs=SM(lo),pr&&(li=SM(pr));else{const Do=Lr.layout.get("text-rotate").evaluate(zn,{},Jr)+90;Ps=nC(ii,fs,qn,zr,Bn,jr,lo,ki,Do,Le),pr&&(gs=nC(ii,fs,qn,zr,Bn,jr,pr,$t,Do))}}if(En){const lo=Fn.iconSizeData,Do=Lr.layout.get("icon-rotate").evaluate(zn,{},Jr),Rl=zU(En,Do,si,Wa,or.iconScaleFactor),bc=pr?zU(pr,Do,si,Wa,or.iconScaleFactor):void 0;Es=nC(ii,fs,qn,zr,Bn,jr,En,$t,Do,null),os=4*Rl.length;let Kl=null;lo.kind==="source"?(Kl=[hm*Lr.layout.get("icon-size").evaluate(zn,{},Jr)*or.iconScaleFactor],Kl[0]>s0&&ai(`${Fn.layerIds[0]}: Value for "icon-size" is >= ${F2}. Reduce your "icon-size".`)):lo.kind==="composite"&&(Kl=[hm*or.compositeIconSizes[0].evaluate(zn,{},Jr)*or.iconScaleFactor,hm*or.compositeIconSizes[1].evaluate(zn,{},Jr)*or.iconScaleFactor],(Kl[0]>s0||Kl[1]>s0)&&ai(`${Fn.layerIds[0]}: Value for "icon-size" is >= ${F2}. Reduce your "icon-size".`)),Fn.addSymbols(Fn.icon,Rl,Kl,An,Tn,zn,void 0,vn,qn,ns.lineStartIndex,ns.lineLength,-1,oi,Jr,Xi,qs),ks=Fn.icon.placedSymbolArray.length-1,bc&&(ea=4*bc.length,Fn.addSymbols(Fn.icon,bc,Kl,An,Tn,zn,qu.vertical,vn,qn,ns.lineStartIndex,ns.lineLength,-1,oi,Jr,Xi,qs),ca=Fn.icon.placedSymbolArray.length-1)}for(const lo in Ir.horizontal){const Do=lo,Rl=Ir.horizontal[Do];Oi||(oo=Oh(Rl.text),Me?As=SM(Rl):Oi=nC(ii,fs,qn,zr,Bn,jr,Rl,ki,Lr.layout.get("text-rotate").evaluate(zn,{},Jr),Le));const bc=Rl.positionedLines.length===1;if(yr+=HU(Fn,vn,qn,Rl,Yn,Lr,Me,zn,Le,ns,Ir.vertical?qu.horizontal:qu.horizontalOnly,bc?Zme(Ir.horizontal):[Do],js,ks,or,oi,Jr,Xi),bc)break}Ir.vertical&&(Ni+=HU(Fn,vn,qn,Ir.vertical,Yn,Lr,Me,zn,Le,ns,qu.vertical,["vertical"],js,ca,or,oi,Jr,Xi));let ml=-1;const fu=(lo,Do)=>lo?Math.max(lo,Do):Do;ml=fu(As,ml),ml=fu(rs,ml),ml=fu(li,ml);const fm=ml>-1?1:0;Fn.glyphOffsetArray.length>=65535&&ai("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),zn.sortKey!==void 0&&Fn.addToSortKeyRanges(Fn.symbolInstances.length,zn.sortKey),Fn.symbolInstances.emplaceBack(qn.x,qn.y,fs.x,fs.y,fs.z,js.right>=0?js.right:-1,js.center>=0?js.center:-1,js.left>=0?js.left:-1,js.vertical>=0?js.vertical:-1,ks,ca,oo,Oi!==void 0?Oi:Fn.collisionBoxArray.length,Oi!==void 0?Oi+1:Fn.collisionBoxArray.length,Ps!==void 0?Ps:Fn.collisionBoxArray.length,Ps!==void 0?Ps+1:Fn.collisionBoxArray.length,Es!==void 0?Es:Fn.collisionBoxArray.length,Es!==void 0?Es+1:Fn.collisionBoxArray.length,gs||Fn.collisionBoxArray.length,gs?gs+1:Fn.collisionBoxArray.length,zr,yr,Ni,os,ea,fm,0,hu,Dl,ml,0,Wa?1:0,Ss)})(u,fn,tr,It,c,f,_,p,u.layers[0],u.collisionBoxArray,s.index,s.sourceLayerIndex,u.index,_t,Se,M,0,Xt,Jt,ce,s,b,O,z,q,Y,ae,le,nn)};if(Ae==="line")for(const It of VT(s.geometry,0,0,yn,yn)){const fn=qme(It,qt,an,c.vertical||Ke,f,at,ct,u.overscaling,yn);for(const cn of fn)Ke&&ege(u,Ke.text,en,cn)||Lt(It,cn,q)}else if(Ae==="line-center"){for(const It of s.geometry)if(It.length>1){const fn=$me(It,an,c.vertical||Ke,f,at,ct);fn&&Lt(It,fn,q)}}else if(s.type==="Polygon")for(const It of x2(s.geometry,0)){const fn=Hme(It,16);Lt(It[0],new Tg(fn.x,fn.y,0,0,void 0),q)}else if(s.type==="LineString")for(const It of s.geometry)Lt(It,new Tg(It[0].x,It[0].y,0,0,void 0),q);else if(s.type==="Point")for(const It of s.geometry)for(const fn of It)Lt([fn],new Tg(fn.x,fn.y,0,0,void 0),q)}const F2=255,s0=F2*hm;function HU(u,s,c,f,p,_,b,T,I,M,O,z,q,K,Y,ae,le,ce){const Se=function(Ze,Ke,tt,at,ct,qt,_t,Xt){const an=[];if(Ke.positionedLines.length===0)return an;const Jt=at.layout.get("text-rotate").evaluate(qt,{})*Math.PI/180,en=function(It){const fn=It[0],cn=It[1],tr=fn*cn;return tr>0?[fn,-cn]:tr<0?[-fn,cn]:fn===0?[cn,fn]:[cn,-fn]}(tt);let hn=Math.abs(Ke.top-Ke.bottom);for(const It of Ke.positionedLines)hn-=It.lineOffset;const Vt=Ke.positionedLines.length,nn=hn/Vt;let Lt=Ke.top-tt[1];for(let It=0;It<Vt;++It){const fn=Ke.positionedLines[It];Lt=Gme(Ke,nn,Lt,It);for(const cn of fn.positionedGlyphs){if(!cn.rect)continue;const tr=cn.rect||{};let Fn=yU+1,qn=!0,vn=1,er=0;if(cn.image){const zn=_t.get(cn.image.toString());if(!zn)continue;if(zn.sdf){ai("SDF images are not supported in formatted text and will be ignored.");continue}qn=!1,vn=zn.pixelRatio,Fn=h_/vn}const Ir=(ct||Xt)&&cn.vertical,En=cn.metrics.advance*cn.scale/2,Yn=cn.metrics,pr=cn.rect;if(pr===null)continue;Xt&&Ke.verticalizable&&(er=cn.image?En-cn.metrics.width*cn.scale/2:0);const Lr=ct?[cn.x+En,cn.y]:[0,0];let ii=[0,0],zr=[0,0],Bn=!1;ct||(Ir?(zr=[cn.x+En+en[0],cn.y+en[1]-er],Bn=!0):ii=[cn.x+En+tt[0],cn.y+tt[1]-er]);const jr=pr.w*cn.scale/(vn*(cn.localGlyph?tp:1)),ki=pr.h*cn.scale/(vn*(cn.localGlyph?tp:1));let Me,Le,Mt,$t;if(Ir){const zn=cn.y-Lt,or=new zt(-En,En-zn),si=-Math.PI/2,oi=new zt(...zr);Me=new zt(-En+ii[0],ii[1]),Me._rotateAround(si,or)._add(oi),Me.x+=-zn+En,Me.y-=(Yn.left-Fn)*cn.scale;const Jr=cn.image?Yn.advance*cn.scale:tl*cn.scale,Xi=String.fromCodePoint(cn.glyph);Cme(Xi)?Me.x+=(1-Fn)*cn.scale:Eme(Xi)?Me.x+=Jr-Yn.height*cn.scale+(-Fn-1)*cn.scale:Me.x+=cn.image||Yn.width+2*Fn===pr.w&&Yn.height+2*Fn===pr.h?(Jr-ki)/2:(Jr-(Yn.height+2*Fn)*cn.scale)/2,Le=new zt(Me.x,Me.y-jr),Mt=new zt(Me.x+ki,Me.y),$t=new zt(Me.x+ki,Me.y-jr)}else{const zn=(Yn.left-Fn)*cn.scale-En+ii[0],or=(-Yn.top-Fn)*cn.scale+ii[1],si=zn+jr,oi=or+ki;Me=new zt(zn,or),Le=new zt(si,or),Mt=new zt(zn,oi),$t=new zt(si,oi)}if(Jt){let zn;zn=ct?new zt(0,0):Bn?new zt(en[0],en[1]):new zt(tt[0],tt[1]),Me._rotateAround(Jt,zn),Le._rotateAround(Jt,zn),Mt._rotateAround(Jt,zn),$t._rotateAround(Jt,zn)}const Tn=new zt(0,0),An=new zt(0,0);an.push({tl:Me,tr:Le,bl:Mt,br:$t,texPrimary:tr,texSecondary:void 0,writingMode:Ke.writingMode,glyphOffset:Lr,sectionIndex:cn.sectionIndex,isSDF:qn,pixelOffsetTL:Tn,pixelOffsetBR:An,minFontScaleX:0,minFontScaleY:0})}}return an}(0,f,I,_,b,T,p,u.allowVerticalPlacement),Ae=u.textSizeData;let Ee=null;Ae.kind==="source"?(Ee=[hm*_.layout.get("text-size").evaluate(T,{},le)*Y.textScaleFactor],Ee[0]>s0&&ai(`${u.layerIds[0]}: Value for "text-size" is >= ${F2}. Reduce your "text-size".`)):Ae.kind==="composite"&&(Ee=[hm*Y.compositeTextSizes[0].evaluate(T,{},le)*Y.textScaleFactor,hm*Y.compositeTextSizes[1].evaluate(T,{},le)*Y.textScaleFactor],(Ee[0]>s0||Ee[1]>s0)&&ai(`${u.layerIds[0]}: Value for "text-size" is >= ${F2}. Reduce your "text-size".`)),u.addSymbols(u.text,Se,Ee,I,b,T,O,s,c,M.lineStartIndex,M.lineLength,K,ae,le,ce,!1);for(const Ze of z)q[Ze]=u.text.placedSymbolArray.length-1;return 4*Se.length}function wM(u){for(const s in u)return u[s];return null}function nC(u,s,c,f,p,_,b,T,I,M){let O=b.top,z=b.bottom,q=b.left,K=b.right;if(SU(b)&&b.collisionPadding){const Y=b.collisionPadding;q-=Y[0],O-=Y[1],K+=Y[2],z+=Y[3]}if(I){const Y=new zt(q,O),ae=new zt(K,O),le=new zt(q,z),ce=new zt(K,z),Se=lt(I);let Ae=new zt(0,0);M&&(Ae=new zt(M[0],M[1])),Y._rotateAround(Se,Ae),ae._rotateAround(Se,Ae),le._rotateAround(Se,Ae),ce._rotateAround(Se,Ae),q=Math.min(Y.x,ae.x,le.x,ce.x),K=Math.max(Y.x,ae.x,le.x,ce.x),O=Math.min(Y.y,ae.y,le.y,ce.y),z=Math.max(Y.y,ae.y,le.y,ce.y)}return u.emplaceBack(s.x,s.y,s.z,c.x,c.y,q,O,K,z,T,f,p,_),u.length-1}function SM(u){SU(u)&&u.collisionPadding&&(u.top-=u.collisionPadding[1],u.bottom+=u.collisionPadding[3]);const s=u.bottom-u.top;return s>0?Math.max(10,s):null}function ege(u,s,c,f){const p=u.compareText;if(s in p){const _=p[s];for(let b=_.length-1;b>=0;b--)if(f.dist(_[b])<c)return!0}else p[s]=[];return p[s].push(f),!1}function WU(u,s){const c=u.fovAboveCenter,f=u.elevation?u.elevation.getMinElevationBelowMSL()*s:0,p=(u._camera.position[2]*u.worldSize-f)/Math.cos(u._pitch),_=Math.sin(c)*p/Math.sin(Math.max(Math.PI/2-u._pitch-c,.01));let b=Math.sin(u._pitch)*_+p;const T=p*(1/u._horizonShift);if(!u.elevation||u.elevation.exaggeration()===0){let I=Math.max(u.zoom-17,0);u.isOrthographic&&(I/=10),b*=1+I}return Math.min(1.01*b,T)}function z2(u,s){if(!s.isReprojectedInTileSpace)return{scale:1<<u.z,x:u.x,y:u.y,x2:u.x+1,y2:u.y+1,projection:s};const c=Math.pow(2,-u.z),f=u.x*c,p=(u.x+1)*c,_=u.y*c,b=(u.y+1)*c,T=Ve(f),I=Ve(p),M=ze(_),O=ze(b),z=s.project(T,M),q=s.project(I,M),K=s.project(I,O),Y=s.project(T,O);let ae=Math.min(z.x,q.x,K.x,Y.x),le=Math.min(z.y,q.y,K.y,Y.y),ce=Math.max(z.x,q.x,K.x,Y.x),Se=Math.max(z.y,q.y,K.y,Y.y);const Ae=c/16;function Ee(Ke,tt,at,ct,qt,_t){const Xt=(at+qt)/2,an=(ct+_t)/2,Jt=s.project(Ve(Xt),ze(an)),en=Math.max(0,ae-Jt.x,le-Jt.y,Jt.x-ce,Jt.y-Se);ae=Math.min(ae,Jt.x),ce=Math.max(ce,Jt.x),le=Math.min(le,Jt.y),Se=Math.max(Se,Jt.y),en>Ae&&(Ee(Ke,Jt,at,ct,Xt,an),Ee(Jt,tt,Xt,an,qt,_t))}Ee(z,q,f,_,p,_),Ee(q,K,p,_,p,b),Ee(K,Y,p,b,f,b),Ee(Y,z,f,b,f,_),ae-=Ae,le-=Ae,ce+=Ae,Se+=Ae;const Ze=1/Math.max(ce-ae,Se-le);return{scale:Ze,x:ae*Ze,y:le*Ze,x2:ce*Ze,y2:Se*Ze,projection:s}}function ZU(u,{x:s,y:c},f=0){return new zt(((s-f)*u.scale-u.x)*yn,(c*u.scale-u.y)*yn)}const tge=D(new Float32Array(16));class a0{constructor(s){this.spec=s,this.name=s.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(s,c){return{x:0,y:0,z:0}}unproject(s,c){return new se(0,0)}projectTilePoint(s,c,f){return{x:s,y:c,z:0}}locationPoint(s,c,f,p=!0){return s._coordinatePoint(s.locationCoordinate(c,f),p)}pixelsPerMeter(s,c){return Fe(1,s)*c}pixelSpaceConversion(s,c,f){return 1}farthestPixelDistance(s){return WU(s,s.pixelsPerMeter)}pointCoordinate(s,c,f,p){const _=s.horizonLineFromTop(!1),b=new zt(c,Math.max(_,f));return s.rayIntersectionCoordinate(s.pointRayIntersection(b,p))}pointCoordinate3D(s,c,f){const p=new zt(c,f);if(s.elevation)return s.elevation.pointCoordinate(p);{const _=this.pointCoordinate(s,p.x,p.y,0);return[_.x,_.y,_.z]}}isPointAboveHorizon(s,c){if(s.elevation&&s.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(s,c.x,c.y);const f=s.horizonLineFromTop();return c.y<f}createInversionMatrix(s,c){return tge}createTileMatrix(s,c,f){let p,_,b;const T=f.canonical,I=D(new Float64Array(16));if(this.isReprojectedInTileSpace){const M=z2(T,this);p=1,_=M.x+f.wrap*M.scale,b=M.y,H(I,I,[p/M.scale,p/M.scale,s.pixelsPerMeter/c])}else p=c/s.zoomScale(T.z),_=(T.x+Math.pow(2,T.z)*f.wrap)*p,b=T.y*p;return $(I,I,[_,b,0]),H(I,I,[p/yn,p/yn,1]),I}upVector(s,c,f){return[0,0,1]}upVectorScale(s,c,f){return{metersToTile:1}}}class nge extends a0{constructor(s){super(s),this.range=[4,7],this.center=s.center||[-96,37.5];const[c,f]=this.parallels=s.parallels||[29.5,45.5],p=Math.sin(lt(c));this.n=(p+Math.sin(lt(f)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(s,c){const{n:f,c:p,r0:_}=this,b=lt(s-this.center[0]),T=lt(c),I=Math.sqrt(p-2*f*Math.sin(T))/f;return{x:I*Math.sin(b*f),y:I*Math.cos(b*f)-_,z:0}}unproject(s,c){const{n:f,c:p,r0:_}=this,b=_+c;let T=Math.atan2(s,Math.abs(b))*Math.sign(b);b*f<0&&(T-=Math.PI*Math.sign(s)*Math.sign(b));const I=lt(this.center[0])*f;T=ot(T,-Math.PI-I,Math.PI-I);const M=We(de(T/f)+this.center[0],-180,180),O=Math.asin(We((p-(s*s+b*b)*f*f)/(2*f),-1,1)),z=We(de(O),-Ge,Ge);return new se(M,z)}}const B2=1.340264,U2=-.081106,V2=893e-6,$2=.003796,rC=Math.sqrt(3)/2;class rge extends a0{project(s,c){c=c/180*Math.PI,s=s/180*Math.PI;const f=Math.asin(rC*Math.sin(c)),p=f*f,_=p*p*p;return{x:.5*(s*Math.cos(f)/(rC*(B2+3*U2*p+_*(7*V2+9*$2*p)))/Math.PI+.5),y:1-.5*(f*(B2+U2*p+_*(V2+$2*p))/Math.PI+1),z:0}}unproject(s,c){s=(2*s-.5)*Math.PI;let f=c=(2*(1-c)-1)*Math.PI,p=f*f,_=p*p*p;for(let O,z,q,K=0;K<12&&(z=f*(B2+U2*p+_*(V2+$2*p))-c,q=B2+3*U2*p+_*(7*V2+9*$2*p),O=z/q,f=We(f-O,-Math.PI/3,Math.PI/3),p=f*f,_=p*p*p,!(Math.abs(O)<1e-12));++K);const b=rC*s*(B2+3*U2*p+_*(7*V2+9*$2*p))/Math.cos(f),T=Math.asin(Math.sin(f)/rC),I=We(180*b/Math.PI,-180,180),M=We(180*T/Math.PI,-Ge,Ge);return new se(I,M)}}class ige extends a0{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0}project(s,c){return{x:.5+s/360,y:.5-c/360,z:0}}unproject(s,c){const f=360*(s-.5),p=We(360*(.5-c),-Ge,Ge);return new se(f,p)}}const v1=Math.PI/2;function iC(u){return Math.tan((v1+u)/2)}class sge extends a0{constructor(s){super(s),this.center=s.center||[0,30];const[c,f]=this.parallels=s.parallels||[30,30];let p=lt(c),_=lt(f);this.southernCenter=p+_<0,this.southernCenter&&(p=-p,_=-_);const b=Math.cos(p),T=iC(p);this.n=p===_?Math.sin(p):Math.log(b/Math.cos(_))/Math.log(iC(_)/T),this.f=b*Math.pow(iC(p),this.n)/this.n}project(s,c){c=lt(c),this.southernCenter&&(c=-c),s=lt(s-this.center[0]);const f=1e-6,{n:p,f:_}=this;_>0?c<-v1+f&&(c=-v1+f):c>v1-f&&(c=v1-f);const b=_/Math.pow(iC(c),p);let T=b*Math.sin(p*s),I=_-b*Math.cos(p*s);return T=.5*(T/Math.PI+.5),I=.5*(I/Math.PI+.5),{x:T,y:this.southernCenter?I:1-I,z:0}}unproject(s,c){s=(2*s-.5)*Math.PI,this.southernCenter&&(c=1-c),c=(2*(1-c)-.5)*Math.PI;const{n:f,f:p}=this,_=p-c,b=Math.sign(_),T=Math.sign(f)*Math.sqrt(s*s+_*_);let I=Math.atan2(s,Math.abs(_))*b;_*f<0&&(I-=Math.PI*Math.sign(s)*b);const M=We(de(I/f)+this.center[0],-180,180),O=We(de(2*Math.atan(Math.pow(p/T,1/f))-v1),-Ge,Ge);return new se(M,this.southernCenter?-O:O)}}class KU extends a0{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(s,c){return{x:ke(s),y:Ue(c),z:0}}unproject(s,c){const f=Ve(s),p=ze(c);return new se(f,p)}}const YU=lt(Ge);class age extends a0{project(s,c){const f=(c=lt(c))*c,p=f*f;return{x:.5*((s=lt(s))*(.8707-.131979*f+p*(p*(.003971*f-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(c*(1.007226+f*(.015085+p*(.028874*f-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(s,c){s=(2*s-.5)*Math.PI;let f=c=(2*(1-c)-1)*Math.PI,p=25,_=0,b=f*f;do{b=f*f;const M=b*b;_=(f*(1.007226+b*(.015085+M*(.028874*b-.044475-.005916*M)))-c)/(1.007226+b*(.045255+M*(.259866*b-.311325-.005916*11*M))),f=We(f-_,-YU,YU)}while(Math.abs(_)>1e-6&&--p>0);b=f*f;const T=We(de(s/(.8707+b*(b*(b*b*b*(.003971-.001529*b)-.013791)-.131979))),-180,180),I=de(f);return new se(T,I)}}const XU=lt(Ge);class oge extends a0{project(s,c){c=lt(c),s=lt(s);const f=Math.cos(c),p=2/Math.PI,_=Math.acos(f*Math.cos(s/2)),b=Math.sin(_)/_,T=.5*(s*p+2*f*Math.sin(s/2)/b)||0,I=.5*(c+Math.sin(c)/b)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(I/Math.PI+1),z:0}}unproject(s,c){let f=s=(2*s-.5)*Math.PI,p=c=(2*(1-c)-1)*Math.PI,_=25;const b=1e-6;let T=0,I=0;do{const M=Math.cos(p),O=Math.sin(p),z=2*O*M,q=O*O,K=M*M,Y=Math.cos(f/2),ae=Math.sin(f/2),le=2*Y*ae,ce=ae*ae,Se=1-K*Y*Y,Ae=Se?1/Se:0,Ee=Se?Math.acos(M*Y)*Math.sqrt(1/Se):0,Ze=.5*(2*Ee*M*ae+2*f/Math.PI)-s,Ke=.5*(Ee*O+p)-c,tt=.5*Ae*(K*ce+Ee*M*Y*q)+1/Math.PI,at=Ae*(le*z/4-Ee*O*ae),ct=.125*Ae*(z*ae-Ee*O*K*le),qt=.5*Ae*(q*Y+Ee*ce*M)+.5,_t=at*ct-qt*tt;T=(Ke*at-Ze*qt)/_t,I=(Ze*ct-Ke*tt)/_t,f=We(f-T,-Math.PI,Math.PI),p=We(p-I,-XU,XU)}while((Math.abs(T)>b||Math.abs(I)>b)&&--_>0);return new se(de(f),de(p))}}class JU extends a0{constructor(s){super(s),this.center=s.center||[0,0],this.parallels=s.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(lt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(s,c){const{scale:f,cosPhi:p}=this;return{x:lt(s)*p*f+.5,y:-Math.sin(lt(c))/p*f+.5,z:0}}unproject(s,c){const{scale:f,cosPhi:p}=this,_=-(c-.5)/f,b=We(de((s-.5)/f)/p,-180,180),T=Math.asin(We(_*p,-1,1)),I=We(de(T),-Ge,Ge);return new se(b,I)}}class lge extends KU{constructor(s){super(s),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(s,c,f){const p=p2(s,c,f);return Pt(p,p,LT(um(f))),{x:p[0],y:p[1],z:p[2]}}locationPoint(s,c,f){const p=W(c.lat,c.lng),_=gt([],p),b=f?s._centerAltitude+f:s.elevation?s.elevation.getAtPointOrZero(s.locationCoordinate(c),s._centerAltitude):s._centerAltitude;me(p,p,_,Fe(1,0)*yn*b);const T=D(new Float64Array(16));return F(T,s.pixelMatrix,s.globeMatrix),Pt(p,p,T),new zt(p[0],p[1])}pixelsPerMeter(s,c){return Fe(1,0)*c}pixelSpaceConversion(s,c,f){const p=Fe(1,s)*c,_=qe(Fe(1,45)*c,p,f);return this.pixelsPerMeter(s,c)/_}createTileMatrix(s,c,f){const p=NN(um(f.canonical));return F(new Float64Array(16),s.globeMatrix,p)}createInversionMatrix(s,c){const{center:f}=s,p=LT(um(c));return ee(p,p,lt(f.lng)),J(p,p,lt(f.lat)),H(p,p,[s._pixelsPerMercatorPixel,s._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(s,c,f,p){return w8(s,c,f,!0)||new Dt(0,0)}pointCoordinate3D(s,c,f){const p=this.pointCoordinate(s,c,f,0);return[p.x,p.y,p.z]}isPointAboveHorizon(s,c){return!w8(s,c.x,c.y,!1)}farthestPixelDistance(s){const c=function(p,_){const b=p.cameraToCenterDistance,T=p._centerAltitude*_,I=p._camera,M=p._camera.forward(),O=Qe([],xt([],M,-b),[0,0,T]),z=p.worldSize/(2*Math.PI),q=[0,0,-z],K=p.width/p.height,Y=Math.tan(p.fovAboveCenter),ae=xt([],I.up(),Y),le=xt([],I.right(),Y*K),ce=gt([],Qe([],Qe([],M,ae),le)),Se=[];let Ae;if(new ji(O,ce).closestPointOnSphere(q,z,Se)){const Ee=Qe([],Se,q),Ze=st([],Ee,O);Ae=Math.cos(p.fovAboveCenter)*Ce(Ze)}else{const Ee=st([],O,q),Ze=st([],q,O);gt(Ze,Ze);const Ke=Ce(Ee)-z;Ae=Math.sqrt(Ke*(Ke+2*z));const tt=Math.acos(Ae/(z+Ke))-Math.acos(dt(M,Ze));Ae*=Math.cos(tt)}return 1.01*Ae}(s,this.pixelsPerMeter(s.center.lat,s.worldSize)),f=e0(s.zoom);if(f>0){const p=WU(s,Fe(1,s.center.lat)*s.worldSize),_=s.worldSize/(2*Math.PI),b=Math.max(s.width,s.height)/s.worldSize*Math.PI;return qe(c,p+_*(1-Math.cos(b)),Math.pow(f,10))}return c}upVector(s,c,f){return p2(c,f,s,1)}upVectorScale(s){return{metersToTile:IT(MT(um(s)))}}}function QU(u){const s=u.parallels,c=!!s&&Math.abs(s[0]+s[1])<.01;switch(u.name){case"mercator":return new KU(u);case"equirectangular":return new ige(u);case"naturalEarth":return new age(u);case"equalEarth":return new rge(u);case"winkelTripel":return new oge(u);case"albers":return c?new JU(u):new nge(u);case"lambertConformalConic":return c?new JU(u):new sge(u);case"globe":return new lge(u)}throw new Error(`Invalid projection name: ${u.name}`)}const cge=rn.types,uge=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function sC(u,s,c,f,p,_,b,T,I,M,O,z,q){const K=T?Math.min(s0,Math.round(T[0])):0,Y=T?Math.min(s0,Math.round(T[1])):0;u.emplaceBack(s,c,Math.round(32*f),Math.round(32*p),_,b,(K<<1)+(I?1:0),Y,16*M,16*O,256*z,256*q)}function aC(u,s,c){u.emplaceBack(s,c)}function oC(u,s,c,f,p,_,b){u.emplaceBack(s,c,f,p,_,b)}const lC=(u,s,c,f)=>{for(let p=0;p<s;p++)u.emplaceBack(c[0],c[1],c[2],f[0],f[1],f[2])};function cC(u,s,c,f,p){u.emplaceBack(s,c,f,p),u.emplaceBack(s,c,f,p),u.emplaceBack(s,c,f,p),u.emplaceBack(s,c,f,p)}function dge(u){for(const s of u.sections)if(By(s.text))return!0;return!1}class AM{constructor(s){this.layoutVertexArray=new r2,this.indexArray=new vo,this.programConfigurations=s,this.segments=new Qs,this.dynamicLayoutVertexArray=new ah,this.opacityVertexArray=new Zy,this.placedSymbolArray=new n1,this.iconTransitioningVertexArray=new so,this.globeExtVertexArray=new i2,this.zOffsetVertexArray=new sm,this.orientationVertexArray=new Xv}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(s,c,f,p,_){this.isEmpty()||(f&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,gme.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,vme.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,uge,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=s.createVertexBuffer(this.iconTransitioningVertexArray,bme.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,yme.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||_)&&(this.zOffsetVertexBuffer=s.createVertexBuffer(this.zOffsetVertexArray,_me.members,!0)),!this.orientationVertexBuffer&&this.orientationVertexArray&&this.orientationVertexArray.length>0&&(this.orientationVertexBuffer=s.createVertexBuffer(this.orientationVertexArray,xme.members,!0)),this.opacityVertexBuffer.itemSize=1),(f||p)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.orientationVertexBuffer&&this.orientationVertexBuffer.destroy())}}Pn(AM,"SymbolBuffers");class TM{constructor(s,c,f){this.layoutVertexArray=new s,this.layoutAttributes=c,this.indexArray=new f,this.segments=new Qs,this.collisionVertexArray=new a2,this.collisionVertexArrayExt=new ah}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,wme.members,!0),this.collisionVertexBufferExt=s.createVertexBuffer(this.collisionVertexArrayExt,Sme.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Pn(TM,"CollisionBuffers");class uC{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(b=>b.fqid),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=D([]),this.placementViewportMatrix=D([]);const c=this.layers[0]._unevaluatedLayout._values;this.worldview=s.worldview,this.textSizeData=PU(this.zoom,c["text-size"],this.worldview),this.iconSizeData=PU(this.zoom,c["icon-size"],this.worldview);const f=this.layers[0].layout,p=f.get("symbol-sort-key"),_=f.get("symbol-z-order");this.lut=s.lut,this.canOverlap=f.get("text-allow-overlap")||f.get("icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=f.get("text-writing-mode").map(b=>qu[b]),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id),this.sourceID=s.sourceID,this.projection=s.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.hasAnySecondaryIcon=!1}createArrays(){this.text=new AM(new oh(this.layers,{zoom:this.zoom,lut:this.lut},s=>s.startsWith("text")||s.startsWith("symbol"))),this.icon=new AM(new oh(this.layers,{zoom:this.zoom,lut:this.lut},s=>s.startsWith("icon")||s.startsWith("symbol"))),this.glyphOffsetArray=new bT,this.lineVertexArray=new wT,this.symbolInstances=new xT}calculateGlyphDependencies(s,c,f,p,_){for(const b of s){const T=b.codePointAt(0);if(T===void 0)break;if(c[T]=!0,p&&_&&T<=65535){const I=L2[b];I&&(c[I.charCodeAt(0)]=!0)}}}updateFootprints(s,c){}updateReplacement(s,c){if(c.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=c.updateTime;const f=c.getReplacementRegionsForTile(s.toUnwrapped(),!0);return!zT(this.activeReplacements,f)&&(this.activeReplacements=f,!0)}populate(s,c,f,p){const _=this.layers[0],b=_.layout,T=this.projection.name==="globe",I=b.get("text-font"),M=b.get("text-field"),O=b.get("icon-image"),[z,q]=b.get("icon-size-scale-range"),K=We(c.scaleFactor||1,z,q),Y=(M.value.kind!=="constant"||M.value.value instanceof eo&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&(I.value.kind!=="constant"||I.value.value.length>0),ae=O.value.kind!=="constant"||!!O.value.value||Object.keys(O.parameters).length>0,le=b.get("symbol-sort-key");if(this.features=[],!Y&&!ae)return;const ce=c.iconDependencies,Se=c.glyphDependencies,Ae=c.availableImages,Ee=new hs(this.zoom,{worldview:this.worldview});for(const{feature:Ze,id:Ke,index:tt,sourceLayerIndex:at}of s){const ct=_._featureFilter.needGeometry,qt=dn(Ze,ct);if(!_._featureFilter.filter(Ee,qt,f))continue;if(ct||(qt.geometry=Nn(Ze,f,p)),T&&Ze.type!==1&&f.z<=5){const en=qt.geometry,hn=.98078528056,Vt=(nn,Lt)=>dt(p2(nn.x,nn.y,f,1),p2(Lt.x,Lt.y,f,1))<hn;for(let nn=0;nn<en.length;nn++)en[nn]=Ut(en[nn],Vt)}let _t,Xt;if(Y){const en=_.getValueAndResolveTokens("text-field",qt,f,Ae),hn=eo.factory(en);dge(hn)&&(this.hasRTLText=!0),(!this.hasRTLText||Uy()==="unavailable"||this.hasRTLText&&Fc.isParsed())&&(_t=Tme(hn,_,qt))}if(ae){const en=_.getValueAndResolveTokens("icon-image",qt,f,Ae);Xt=typeof en=="string"?fo.build(en):en}if(!_t&&!Xt)continue;const an=this.sortFeaturesByKey?le.evaluate(qt,{},f):void 0,Jt={id:Ke,text:_t,icon:Xt,index:tt,sourceLayerIndex:at,geometry:qt.geometry,properties:Ze.properties,type:cge[Ze.type],sortKey:an};if(this.features.push(Jt),Xt){const en=this.layers[0]._unevaluatedLayout._values,{iconPrimary:hn,iconSecondary:Vt}=$U(Xt,this.iconSizeData,en["icon-size"],f,this.zoom,Jt,this.pixelRatio,K,this.worldview),nn=hn.id.toString();if(ce.has(nn)?ce.get(nn).push(hn):ce.set(nn,[hn]),Vt){this.hasAnySecondaryIcon=!0;const Lt=Vt.id.toString();ce.has(Lt)?ce.get(Lt).push(Vt):ce.set(Lt,[Vt])}}if(_t){const en=I.evaluate(qt,{},f).join(","),hn=b.get("text-rotation-alignment")==="map"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(qu.vertical)>=0;for(const Vt of _t.sections)if(Vt.image){const nn=Vt.image.getPrimary().scaleSelf(this.pixelRatio),Lt=nn.id.toString(),It=ce.get(Lt)||[];It.push(nn),ce.set(Lt,It)}else{const nn=ma(_t.toString()),Lt=Vt.fontStack||en,It=Se[Lt]=Se[Lt]||{};this.calculateGlyphDependencies(Vt.text,It,hn,this.allowVerticalPlacement,nn)}}}if(b.get("symbol-placement")==="line"&&(this.features=function(Ze){const Ke={},tt={},at=[];let ct=0;function qt(Jt){at.push(Ze[Jt]),ct++}function _t(Jt,en,hn){const Vt=tt[Jt];return delete tt[Jt],tt[en]=Vt,at[Vt].geometry[0].pop(),at[Vt].geometry[0]=at[Vt].geometry[0].concat(hn[0]),Vt}function Xt(Jt,en,hn){const Vt=Ke[en];return delete Ke[en],Ke[Jt]=Vt,at[Vt].geometry[0].shift(),at[Vt].geometry[0]=hn[0].concat(at[Vt].geometry[0]),Vt}function an(Jt,en,hn){const Vt=hn?en[0][en[0].length-1]:en[0][0];return`${Jt}:${Vt.x}:${Vt.y}`}for(let Jt=0;Jt<Ze.length;Jt++){const en=Ze[Jt],hn=en.geometry,Vt=en.text?en.text.toString():null;if(!Vt){qt(Jt);continue}const nn=an(Vt,hn),Lt=an(Vt,hn,!0);if(nn in tt&&Lt in Ke&&tt[nn]!==Ke[Lt]){const It=Xt(nn,Lt,hn),fn=_t(nn,Lt,at[It].geometry);delete Ke[nn],delete tt[Lt],tt[an(Vt,at[fn].geometry,!0)]=fn,at[It].geometry=null}else nn in tt?_t(nn,Lt,hn):Lt in Ke?Xt(nn,Lt,hn):(qt(Jt),Ke[nn]=ct-1,tt[Lt]=ct-1)}return at.filter(Jt=>Jt.geometry)}(this.features)),b.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",c.elevationFeatures){!this.elevationFeatures&&c.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const Ze of c.elevationFeatures)this.elevationFeatureIdToIndex.set(Ze.id,this.elevationFeatures.length),this.elevationFeatures.push(Ze)}}else b.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((Ze,Ke)=>Ze.sortKey-Ke.sortKey)}update(s,c,f,p,_,b,T){this.text.programConfigurations.updatePaintArrays(s,c,_,f,p,b,T,this.worldview),this.icon.programConfigurations.updatePaintArrays(s,c,_,f,p,b,T,this.worldview)}updateRoadElevation(s){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let c=!1;const f=bt(s),p=1/f;let _=!1,b=!1;for(let T=0;T<this.symbolInstances.length;T++){const I=this.symbolInstances.get(T),M=xe(1,0,0),O=xe(0,1,0),{numHorizontalGlyphVertices:z,numVerticalGlyphVertices:q,numIconVertices:K,numVerticalIconVertices:Y}=I,ae=z>0||q>0,le=K>0,ce=this.elevationFeatures[I.elevationFeatureIndex];if(ce){const Se=new zt(I.tileAnchorX,I.tileAnchorY),Ae=.075+ce.pointElevation(Se);I.zOffset!==Ae&&(c=!0,I.zOffset=Ae);const Ee=ce.computeSlopeNormal(Se,p),Ze=Qr(Wt(),xe(0,0,1),Ee);Ot(M,M,Ze),Ot(O,O,Ze),M[2]*=f,O[2]*=f,M[0]===1&&M[1]===0&&M[2]===0&&O[0]===0&&O[1]===1&&O[2]===0||(_=_||ae,b=b||le)}if(ae&&(lC(this.text.orientationVertexArray,z,M,O),lC(this.text.orientationVertexArray,q,M,O)),le){const{placedIconSymbolIndex:Se,verticalPlacedIconSymbolIndex:Ae}=I;Se>=0&&lC(this.icon.orientationVertexArray,K,M,O),Ae>=0&&lC(this.icon.orientationVertexArray,Y,M,O)}}_||(this.text.orientationVertexArray=void 0),b||(this.icon.orientationVertexArray=void 0),c&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const s=(_,b,T)=>{f+=b,f>_.length&&_.resize(f);for(let I=-b;I<0;I++)_.emplace(I+f,T)},c=(_,b,T)=>{p+=b,p>_.length&&_.resize(p);for(let I=-b;I<0;I++)_.emplace(I+p,T)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let f=0,p=0;for(let _=0;_<this.symbolInstances.length;_++){const b=this.symbolInstances.get(_),{numHorizontalGlyphVertices:T,numVerticalGlyphVertices:I,numIconVertices:M}=b,O=b.zOffset,z=M>0;if((T>0||I>0)&&(s(this.text.zOffsetVertexArray,T,O),s(this.text.zOffsetVertexArray,I,O)),z){const{placedIconSymbolIndex:q,verticalPlacedIconSymbolIndex:K}=b;q>=0&&c(this.icon.zOffsetVertexArray,M,O),K>=0&&c(this.icon.zOffsetVertexArray,b.numVerticalIconVertices,O)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=QU(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,c){const f=this.lineVertexArray.length;if(s.segment!==void 0)for(const{x:p,y:_}of c)this.lineVertexArray.emplaceBack(p,_);return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(s,c,f,p,_,b,T,I,M,O,z,q,K,Y,ae,le){const ce=s.indexArray,Se=s.layoutVertexArray,Ae=s.globeExtVertexArray,Ee=s.segments.prepareSegment(4*c.length,Se,ce,this.canOverlap?b.sortKey:void 0),Ze=this.glyphOffsetArray.length,Ke=Ee.vertexLength,tt=this.allowVerticalPlacement&&T===qu.vertical?Math.PI/2:0,at=b.text&&b.text.sections;for(let qt=0;qt<c.length;qt++){const{tl:_t,tr:Xt,bl:an,br:Jt,texPrimary:en,texSecondary:hn,pixelOffsetTL:Vt,pixelOffsetBR:nn,minFontScaleX:Lt,minFontScaleY:It,glyphOffset:fn,isSDF:cn,sectionIndex:tr}=c[qt],Fn=Ee.vertexLength,qn=fn[1];if(sC(Se,M.x,M.y,_t.x,qn+_t.y,en.x,en.y,f,cn,Vt.x,Vt.y,Lt,It),sC(Se,M.x,M.y,Xt.x,qn+Xt.y,en.x+en.w,en.y,f,cn,nn.x,Vt.y,Lt,It),sC(Se,M.x,M.y,an.x,qn+an.y,en.x,en.y+en.h,f,cn,Vt.x,nn.y,Lt,It),sC(Se,M.x,M.y,Jt.x,qn+Jt.y,en.x+en.w,en.y+en.h,f,cn,nn.x,nn.y,Lt,It),I){const{x:vn,y:er,z:Ir}=I.anchor,[En,Yn,pr]=I.up;oC(Ae,vn,er,Ir,En,Yn,pr),oC(Ae,vn,er,Ir,En,Yn,pr),oC(Ae,vn,er,Ir,En,Yn,pr),oC(Ae,vn,er,Ir,En,Yn,pr),cC(s.dynamicLayoutVertexArray,vn,er,Ir,tt)}else cC(s.dynamicLayoutVertexArray,M.x,M.y,M.z,tt);if(le){const vn=hn||en;aC(s.iconTransitioningVertexArray,vn.x,vn.y),aC(s.iconTransitioningVertexArray,vn.x+vn.w,vn.y),aC(s.iconTransitioningVertexArray,vn.x,vn.y+vn.h),aC(s.iconTransitioningVertexArray,vn.x+vn.w,vn.y+vn.h)}ce.emplaceBack(Fn,Fn+1,Fn+2),ce.emplaceBack(Fn+1,Fn+2,Fn+3),Ee.vertexLength+=4,Ee.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(fn[0]),qt!==c.length-1&&tr===c[qt+1].sectionIndex||s.programConfigurations.populatePaintArrays(Se.length,b,b.index,{},K,Y,ae,at&&at[tr],this.worldview)}const ct=I?I.anchor:M;s.placedSymbolArray.emplaceBack(ct.x,ct.y,ct.z,M.x,M.y,Ze,this.glyphOffsetArray.length-Ze,Ke,O,z,M.segment,f?f[0]:0,f?f[1]:0,p[0],p[1],T,0,0,0,q,0)}_commitLayoutVertex(s,c,f,p,_,b,T){s.emplaceBack(c,f,p,_,b,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(s,c,f,p,_,b,T){const I=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),M=I.vertexLength,O=T.tileAnchorX,z=T.tileAnchorY;for(let K=0;K<4;K++)f.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(f.collisionVertexArrayExt,c,s.padding,T.zOffset),this._commitLayoutVertex(f.layoutVertexArray,p,_,b,O,z,new zt(s.x1,s.y1)),this._commitLayoutVertex(f.layoutVertexArray,p,_,b,O,z,new zt(s.x2,s.y1)),this._commitLayoutVertex(f.layoutVertexArray,p,_,b,O,z,new zt(s.x2,s.y2)),this._commitLayoutVertex(f.layoutVertexArray,p,_,b,O,z,new zt(s.x1,s.y2)),I.vertexLength+=4;const q=f.indexArray;q.emplaceBack(M,M+1),q.emplaceBack(M+1,M+2),q.emplaceBack(M+2,M+3),q.emplaceBack(M+3,M),I.primitiveLength+=4}_addTextDebugCollisionBoxes(s,c,f,p,_,b){for(let T=p;T<_;T++){const I=f.get(T),M=this.getSymbolInstanceTextSize(s,b,c,T);this._addCollisionDebugVertices(I,M,this.textCollisionBox,I.projectedAnchorX,I.projectedAnchorY,I.projectedAnchorZ,b)}}_addIconDebugCollisionBoxes(s,c,f,p,_,b){for(let T=p;T<_;T++){const I=f.get(T),M=this.getSymbolInstanceIconSize(s,c,b.placedIconSymbolIndex);this._addCollisionDebugVertices(I,M,this.iconCollisionBox,I.projectedAnchorX,I.projectedAnchorY,I.projectedAnchorZ,b)}}generateCollisionDebugBuffers(s,c,f){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new TM(Xx,fU.members,so),this.iconCollisionBox=new TM(Xx,fU.members,so);const p=R2(this.iconSizeData,s),_=R2(this.textSizeData,s,f);for(let b=0;b<this.symbolInstances.length;b++){const T=this.symbolInstances.get(b);this._addTextDebugCollisionBoxes(_,s,c,T.textBoxStartIndex,T.textBoxEndIndex,T),this._addTextDebugCollisionBoxes(_,s,c,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._addIconDebugCollisionBoxes(p,s,c,T.iconBoxStartIndex,T.iconBoxEndIndex,T),this._addIconDebugCollisionBoxes(p,s,c,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T)}}getSymbolInstanceTextSize(s,c,f,p){const _=this.text.placedSymbolArray.get(c.rightJustifiedTextSymbolIndex>=0?c.rightJustifiedTextSymbolIndex:c.centerJustifiedTextSymbolIndex>=0?c.centerJustifiedTextSymbolIndex:c.leftJustifiedTextSymbolIndex>=0?c.leftJustifiedTextSymbolIndex:c.verticalPlacedTextSymbolIndex>=0?c.verticalPlacedTextSymbolIndex:p),b=yM(this.textSizeData,s,_)/tl;return this.tilePixelRatio*b}getSymbolInstanceIconSize(s,c,f){const p=this.icon.placedSymbolArray.get(f),_=yM(this.iconSizeData,s,p);return this.tilePixelRatio*_}_commitDebugCollisionVertexUpdate(s,c,f,p){s.emplaceBack(c,-f,-f,p),s.emplaceBack(c,f,-f,p),s.emplaceBack(c,f,f,p),s.emplaceBack(c,-f,f,p)}_updateTextDebugCollisionBoxes(s,c,f,p,_,b,T){for(let I=p;I<_;I++){const M=f.get(I),O=this.getSymbolInstanceTextSize(s,b,c,I);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,O,M.padding,b.zOffset)}}_updateIconDebugCollisionBoxes(s,c,f,p,_,b,T){for(let I=p;I<_;I++){const M=f.get(I),O=this.getSymbolInstanceIconSize(s,c,b.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,O,M.padding,b.zOffset)}}updateCollisionDebugBuffers(s,c,f,p){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const _=R2(this.iconSizeData,s,p),b=R2(this.textSizeData,s,f);for(let T=0;T<this.symbolInstances.length;T++){const I=this.symbolInstances.get(T);this._updateTextDebugCollisionBoxes(b,s,c,I.textBoxStartIndex,I.textBoxEndIndex,I,f),this._updateTextDebugCollisionBoxes(b,s,c,I.verticalTextBoxStartIndex,I.verticalTextBoxEndIndex,I,f),this._updateIconDebugCollisionBoxes(_,s,c,I.iconBoxStartIndex,I.iconBoxEndIndex,I,p),this._updateIconDebugCollisionBoxes(_,s,c,I.verticalIconBoxStartIndex,I.verticalIconBoxEndIndex,I,p)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(s,c,f,p,_,b,T,I,M){const O={};if(c<f){const{x1:z,y1:q,x2:K,y2:Y,padding:ae,projectedAnchorX:le,projectedAnchorY:ce,projectedAnchorZ:Se,tileAnchorX:Ae,tileAnchorY:Ee,featureIndex:Ze}=s.get(c);O.textBox={x1:z,y1:q,x2:K,y2:Y,padding:ae,projectedAnchorX:le,projectedAnchorY:ce,projectedAnchorZ:Se,tileAnchorX:Ae,tileAnchorY:Ee},O.textFeatureIndex=Ze}if(p<_){const{x1:z,y1:q,x2:K,y2:Y,padding:ae,projectedAnchorX:le,projectedAnchorY:ce,projectedAnchorZ:Se,tileAnchorX:Ae,tileAnchorY:Ee,featureIndex:Ze}=s.get(p);O.verticalTextBox={x1:z,y1:q,x2:K,y2:Y,padding:ae,projectedAnchorX:le,projectedAnchorY:ce,projectedAnchorZ:Se,tileAnchorX:Ae,tileAnchorY:Ee},O.verticalTextFeatureIndex=Ze}if(b<T){const{x1:z,y1:q,x2:K,y2:Y,padding:ae,projectedAnchorX:le,projectedAnchorY:ce,projectedAnchorZ:Se,tileAnchorX:Ae,tileAnchorY:Ee,featureIndex:Ze}=s.get(b);O.iconBox={x1:z,y1:q,x2:K,y2:Y,padding:ae,projectedAnchorX:le,projectedAnchorY:ce,projectedAnchorZ:Se,tileAnchorX:Ae,tileAnchorY:Ee},O.iconFeatureIndex=Ze}if(I<M){const{x1:z,y1:q,x2:K,y2:Y,padding:ae,projectedAnchorX:le,projectedAnchorY:ce,projectedAnchorZ:Se,tileAnchorX:Ae,tileAnchorY:Ee,featureIndex:Ze}=s.get(I);O.verticalIconBox={x1:z,y1:q,x2:K,y2:Y,padding:ae,projectedAnchorX:le,projectedAnchorY:ce,projectedAnchorZ:Se,tileAnchorX:Ae,tileAnchorY:Ee},O.verticalIconFeatureIndex=Ze}return O}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const f=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(s,c){const f=s.placedSymbolArray.get(c),p=f.vertexStartIndex+4*f.numGlyphs;for(let _=f.vertexStartIndex;_<p;_+=4)s.indexArray.emplaceBack(_,_+1,_+2),s.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const c=Math.sin(s),f=Math.cos(s),p=[],_=[],b=[];for(let T=0;T<this.symbolInstances.length;++T){b.push(T);const I=this.symbolInstances.get(T);p.push(0|Math.round(c*I.tileAnchorX+f*I.tileAnchorY)),_.push(I.featureIndex)}return b.sort((T,I)=>p[T]-p[I]||_[I]-_[T]),b}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let s=0;s<this.symbolInstances.length;++s)this.symbolInstanceIndexesSortedZOffset.push(s)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((s,c)=>this.symbolInstances.get(c).zOffset-this.symbolInstances.get(s).zOffset)}addToSortKeyRanges(s,c){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===c?f.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const f=this.symbolInstances.get(c);this.featureSortOrder.push(f.featureIndex);const{rightJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:_,leftJustifiedTextSymbolIndex:b,verticalPlacedTextSymbolIndex:T,placedIconSymbolIndex:I,verticalPlacedIconSymbolIndex:M}=f;p>=0&&this.addIndicesForPlacedSymbol(this.text,p),_>=0&&_!==p&&this.addIndicesForPlacedSymbol(this.text,_),b>=0&&b!==_&&b!==p&&this.addIndicesForPlacedSymbol(this.text,b),T>=0&&this.addIndicesForPlacedSymbol(this.text,T),I>=0&&this.addIndicesForPlacedSymbol(this.icon,I),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let eV,tV,CM;Pn(uC,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),uC.addDynamicAttributes=cC;class nV{constructor(s){this.type=s.property.overrides?s.property.overrides.runtimeType:Mr,this.defaultValue=s}evaluate(s){if(s.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(s.formattedSection))return c.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Pn(nV,"FormatSectionOverride",{omit:["defaultValue"]});const EM=()=>CM||(CM={layout:eV||(eV=new Zs({"symbol-placement":new un(yt.layout_symbol["symbol-placement"]),"symbol-spacing":new un(yt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new un(yt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new wn(yt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new un(yt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new un(yt.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new un(yt.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new un(yt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new un(yt.layout_symbol["icon-ignore-placement"]),"icon-optional":new un(yt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new un(yt.layout_symbol["icon-rotation-alignment"]),"icon-size":new wn(yt.layout_symbol["icon-size"]),"icon-size-scale-range":new un(yt.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new wn(yt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new wn(yt.layout_symbol["icon-text-fit-padding"]),"icon-image":new wn(yt.layout_symbol["icon-image"]),"icon-image-use-theme":new un({type:"string",default:"default","property-type":"data-constant"}),"icon-rotate":new wn(yt.layout_symbol["icon-rotate"]),"icon-padding":new un(yt.layout_symbol["icon-padding"]),"icon-keep-upright":new un(yt.layout_symbol["icon-keep-upright"]),"icon-offset":new wn(yt.layout_symbol["icon-offset"]),"icon-anchor":new wn(yt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new un(yt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new un(yt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new un(yt.layout_symbol["text-rotation-alignment"]),"text-field":new wn(yt.layout_symbol["text-field"]),"text-font":new wn(yt.layout_symbol["text-font"]),"text-size":new wn(yt.layout_symbol["text-size"]),"text-size-scale-range":new un(yt.layout_symbol["text-size-scale-range"]),"text-max-width":new wn(yt.layout_symbol["text-max-width"]),"text-line-height":new wn(yt.layout_symbol["text-line-height"]),"text-letter-spacing":new wn(yt.layout_symbol["text-letter-spacing"]),"text-justify":new wn(yt.layout_symbol["text-justify"]),"text-radial-offset":new wn(yt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new un(yt.layout_symbol["text-variable-anchor"]),"text-anchor":new wn(yt.layout_symbol["text-anchor"]),"text-max-angle":new un(yt.layout_symbol["text-max-angle"]),"text-writing-mode":new un(yt.layout_symbol["text-writing-mode"]),"text-rotate":new wn(yt.layout_symbol["text-rotate"]),"text-padding":new un(yt.layout_symbol["text-padding"]),"text-keep-upright":new un(yt.layout_symbol["text-keep-upright"]),"text-transform":new wn(yt.layout_symbol["text-transform"]),"text-offset":new wn(yt.layout_symbol["text-offset"]),"text-allow-overlap":new un(yt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new un(yt.layout_symbol["text-ignore-placement"]),"text-optional":new un(yt.layout_symbol["text-optional"]),visibility:new un(yt.layout_symbol.visibility)})),paint:tV||(tV=new Zs({"icon-opacity":new wn(yt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new wn(yt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new wn(yt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new wn(yt.paint_symbol["text-emissive-strength"]),"icon-color":new wn(yt.paint_symbol["icon-color"]),"icon-halo-color":new wn(yt.paint_symbol["icon-halo-color"]),"icon-halo-width":new wn(yt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new wn(yt.paint_symbol["icon-halo-blur"]),"icon-translate":new un(yt.paint_symbol["icon-translate"]),"icon-translate-anchor":new un(yt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new un(yt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new wn(yt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new wn(yt.paint_symbol["text-occlusion-opacity"]),"text-color":new wn(yt.paint_symbol["text-color"],{runtimeType:$i,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new wn(yt.paint_symbol["text-halo-color"]),"text-halo-width":new wn(yt.paint_symbol["text-halo-width"]),"text-halo-blur":new wn(yt.paint_symbol["text-halo-blur"]),"text-translate":new un(yt.paint_symbol["text-translate"]),"text-translate-anchor":new un(yt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new un(yt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new un(yt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new un(yt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new un(yt.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new wn(yt.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},CM);class dC extends Zl{constructor(s,c,f,p){super(s,EM(),c,f,p,s.layout?s.layout["icon-image-use-theme"]:null),this._colorAdjustmentMatrix=D([]),this.hasOcclusionOpacityProperties=s.paint!==void 0&&("icon-occlusion-opacity"in s.paint||"text-occlusion-opacity"in s.paint)}_handleSpecialPaintPropertyUpdate(s){s!=="icon-occlusion-opacity"&&s!=="text-occlusion-opacity"||(this.hasOcclusionOpacityProperties=!0)}recalculate(s,c){super.recalculate(s,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const f=this.layout.get("text-writing-mode");if(f){const p=[];for(const _ of f)p.indexOf(_)<0&&p.push(_);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(s,c,f,p){return this._saturation===s&&this._contrast===c&&this._brightnessMin===f&&this._brightnessMax===p||(this._colorAdjustmentMatrix=function(_,b,T,I){_=Cl(_),b=Vo(b);const M=j(),O=_/3,z=1-2*O,q=[z,O,O,0,O,z,O,0,O,O,z,0,0,0,0,1],K=.5-.5*b,Y=I-T;return F(M,[Y,0,0,0,0,Y,0,0,0,0,Y,0,T,T,T,1],[b,0,0,0,0,b,0,0,0,0,b,0,K,K,K,1]),F(M,M,q),M}(s,c,f,p),this._saturation=s,this._contrast=c,this._brightnessMin=f,this._brightnessMax=p),this._colorAdjustmentMatrix}getValueAndResolveTokens(s,c,f,p){const _=this.layout.get(s).evaluate(c,{},f,p),b=this._unevaluatedLayout._values[s];return b.isDataDriven()||hl(b.value)||!_?_:function(T,I){return I.replace(/{([^{}]+)}/g,(M,O)=>O in T?String(T[O]):"")}(c.properties,_)}createBucket(s){return new uC(s)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const s of EM().paint.overridableProperties){if(!dC.hasPaintOverride(this.layout,s))continue;const c=this.paint.get(s),f=new nV(c),p=new Go(f,c.property.specification,this.scope,this.options,this.layout.get("icon-image-use-theme"));let _=null;_=c.value.kind==="constant"||c.value.kind==="source"?new ms("source",p):new ws("composite",p,c.value.zoomStops,c.value.interpolationType),this.paint._values[s]=new Pd(c.property,_,c.parameters)}}_handleOverridablePaintPropertyUpdate(s,c,f){return!(!this.layout||c.isDataDriven()||f.isDataDriven())&&dC.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,c){const f=s.get("text-field"),p=EM().paint.properties[c];let _=!1;const b=T=>{for(const I of T)if(p.overrides&&p.overrides.hasOverride(I))return void(_=!0)};if(f.value.kind==="constant"&&f.value.value instanceof eo)b(f.value.value.sections);else if(f.value.kind==="source"){const T=M=>{_||(M instanceof kr&&Ca(M.value)===Aa?b(M.value.sections):M instanceof Nc?b(M.sections):M.eachChild(T))},I=f.value;I._styleExpression&&T(I._styleExpression.expression)}return _}getProgramIds(){return["symbol"]}getDefaultProgramParams(s,c,f){return{config:new wg(this,{zoom:c,lut:f}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let rV,iV,sV,aV;var PM=Ti([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function hC(u,s,c,f,p,_,b,T){const I=[u,s,1,c,f,1,p,_,1],M=[b,T,1],O=P([],I),[z,q,K]=Ht(M,M,O);return E(I,I,[z,0,0,0,q,0,0,0,K])}function oV(u,s,c,f,p,_,b,T){const I=function(M,O,z,q,K,Y,ae,le){const ce=hC(0,0,1,0,1,1,0,1),Se=hC(M,O,z,q,K,Y,ae,le);return E(Se,Se,P([],ce))}(u,s,c,f,p,_,b,T);return[I[2]/I[8]/yn,I[5]/I[8]/yn]}function fC(u){return[u[0],Math.min(Math.max(u[1],-Ge),Ge)]}class lV extends gd{constructor(s,c,f,p){super(),this.id=s,this.dispatcher=f,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(p),this.options=c,this._dirty=!1}load(s,c){if(this._loaded=c||!1,this.fire(new El("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return s&&(this.coordinates=s),this._loaded=!0,void this._finishLoading();this._imageRequest=tu(this.map._requestManager.transformRequest(this.url,jp.Image),(f,p)=>{this._imageRequest=null,this._loaded=!0,f?this.fire(new eh(f)):p&&(this.image=p instanceof HTMLImageElement?Yc.getImageData(p):p,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,s&&(this.coordinates=s),this._finishLoading())})}loaded(){return this._loaded}updateImage(s){return s.url?(this._imageRequest&&s.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=s.url,this.load(s.coordinates,this._loaded),this):this}setTexture(s){if(!(s.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new I2(this.map.painter.context,s.handle),this.width=s.dimensions[0],this.height=s.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new El("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}onRemove(s){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof I2||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(s){if(this.coordinates=s,this._boundsArray=void 0,this._unsupportedCoords=!1,!s.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let c=s[0][1],f=s[0][1];for(const _ of s)_[1]>f&&(f=_[1]),_[1]<c&&(c=_[1]);const p=(f+c)/2;if(p>Ge?this.onNorthPole=!0:p<-Ge&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const _=s.map(Dt.fromLngLat);this.tileID=function(b){let T=1/0,I=1/0,M=-1/0,O=-1/0;for(const ae of b)T=Math.min(T,ae.x),I=Math.min(I,ae.y),M=Math.max(M,ae.x),O=Math.max(O,ae.y);const z=Math.max(M-T,O-I),q=Math.max(0,Math.floor(-Math.log2(z))),K=Math.pow(2,q);let Y=Math.floor((T+M)/2*K);return Y>1&&(Y-=1),new Qf(q,Y,Math.floor((I+O)/2*K))}(_),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new El("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){!this.texture||this.texture instanceof I2||(this.texture.destroy(),this._dirty=!0),this.texture=null,this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(s){for(const ce in this.tiles){const Se=this.tiles[ce];Se.state!=="loaded"&&(Se.state="loaded",Se.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const c=z2(new Qf(0,0,0),this.map.transform.projection),f=[c.projection.project(this.coordinates[0][0],this.coordinates[0][1]),c.projection.project(this.coordinates[1][0],this.coordinates[1][1]),c.projection.project(this.coordinates[2][0],this.coordinates[2][1]),c.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(ce){const Se=ce[1].x-ce[0].x,Ae=ce[1].y-ce[0].y,Ee=ce[2].x-ce[1].x,Ze=ce[2].y-ce[1].y,Ke=ce[3].x-ce[2].x,tt=ce[3].y-ce[2].y,at=ce[0].x-ce[3].x,ct=ce[0].y-ce[3].y,qt=Se*Ze-Ee*Ae,_t=Ee*tt-Ke*Ze,Xt=Ke*ct-at*tt,an=at*Ae-Se*ct;return qt>0&&_t>0&&Xt>0&&an>0||qt<0&&_t<0&&Xt<0&&an<0}(f))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const p=z2(this.tileID,this.map.transform.projection),[_,b,T,I]=this.coordinates.map(ce=>{const Se=p.projection.project(ce[0],ce[1]);return ZU(p,Se)._round()});this.perspectiveTransform=oV(_.x,_.y,b.x,b.y,T.x,T.y,I.x,I.y);const M=this._boundsArray=new _g;M.emplaceBack(_.x,_.y,0,0),M.emplaceBack(b.x,b.y,yn,0),M.emplaceBack(I.x,I.y,0,yn),M.emplaceBack(T.x,T.y,yn,yn),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=s.createVertexBuffer(M,PM.members),this.boundsSegments=Qs.simpleSegment(0,0,4,2);const O=[],z=[fC((q=this.coordinates)[0]),fC(q[1]),fC(q[2]),fC(q[3])];var q;const[K,Y,ae,le]=function(ce){let Se=ce[0][0],Ae=Se,Ee=ce[0][1],Ze=Ee;for(let Ke=1;Ke<ce.length;Ke++)ce[Ke][0]<Se?Se=ce[Ke][0]:ce[Ke][0]>Ae&&(Ae=ce[Ke][0]),ce[Ke][1]<Ee?Ee=ce[Ke][1]:ce[Ke][1]>Ze&&(Ze=ce[Ke][1]);return[Se,Ee,Ae-Se,Ze-Ee]}(z);{const ce=new _g,[Se,Ae,Ee,Ze]=function(Vt){let nn=Vt[0].x,Lt=nn,It=Vt[0].y,fn=It;for(let cn=1;cn<Vt.length;cn++)Vt[cn].x<nn?nn=Vt[cn].x:Vt[cn].x>Lt&&(Lt=Vt[cn].x),Vt[cn].y<It?It=Vt[cn].y:Vt[cn].y>fn&&(fn=Vt[cn].y);return[nn,It,Lt-nn,fn-It]}(f),Ke=Vt=>[(Vt.x-Se)/Ee,(Vt.y-Ae)/Ze],[tt,at,ct,qt]=f.map(Ke),_t=function(Vt,nn,Lt,It,fn,cn,tr,Fn){const qn=hC(0,0,1,0,1,1,0,1);return E(qn,qn,P([],hC(Vt,nn,Lt,It,fn,cn,tr,Fn)))}(tt[0],tt[1],at[0],at[1],ct[0],ct[1],qt[0],qt[1]);this.elevatedGlobePerspectiveTransform=oV(tt[0],tt[1],at[0],at[1],ct[0],ct[1],qt[0],qt[1]);const Xt=(Vt,nn)=>{O.push(Vt.lng);const Lt=Math.round((Vt.lng-K)/ae*yn),It=Math.round((Vt.lat-Y)/le*yn),fn=Ke(nn),cn=Ht([],[fn[0],fn[1],1],_t),tr=Math.round(cn[0]/cn[2]*yn),Fn=Math.round(cn[1]/cn[2]*yn);ce.emplaceBack(Lt,It,tr,Fn)},an=f[3].x-f[0].x,Jt=f[3].y-f[0].y,en=f[2].x-f[1].x,hn=f[2].y-f[1].y;for(let Vt=0;Vt<65;Vt++){const nn=Vt/64,Lt=[f[0].x+nn*an,f[0].y+nn*Jt],It=[f[1].x+nn*en,f[1].y+nn*hn],fn=It[0]-Lt[0],cn=It[1]-Lt[1];for(let tr=0;tr<65;tr++){const Fn=tr/64,qn={x:Lt[0]+fn*Fn,y:Lt[1]+cn*Fn};Xt(c.projection.unproject(qn.x,qn.y),qn)}}this.elevatedGlobeVertexBuffer=s.createVertexBuffer(ce,PM.members)}{this.maxLongitudeTriangleSize=0;let ce=[],Se=new vo;const Ae=(Ee,Ze,Ke)=>{Se.emplaceBack(Ee,Ze,Ke);const tt=O[Ee],at=O[Ze],ct=O[Ke],qt=Math.min(Math.min(tt,at),ct),_t=Math.max(Math.max(tt,at),ct)-qt;_t>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=_t),ce.push(qt+_t/2)};for(let Ee=0;Ee<64;Ee++)for(let Ze=0;Ze<64;Ze++){const Ke=65*Ee+Ze,tt=Ke+1,at=Ke+65,ct=at+1;Ae(Ke,at,tt),Ae(tt,at,ct)}[ce,Se]=function(Ee,Ze){const Ke=Array.from({length:Ee.length},(ct,qt)=>qt);Ke.sort((ct,qt)=>Ee[ct]-Ee[qt]);const tt=[],at=new vo;for(let ct=0;ct<Ke.length;ct++){const qt=Ke[ct];tt.push(Ee[qt]);const _t=3*qt,Xt=_t+1;at.emplaceBack(Ze.uint16[_t],Ze.uint16[Xt],Ze.uint16[Xt+1])}return[tt,at]}(ce,Se),this.elevatedGlobeTrianglesCenterLongitudes=ce,this.elevatedGlobeIndexBuffer=s.createIndexBuffer(Se)}this.elevatedGlobeSegments=Qs.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,ae/yn,0,le/yn,0,0,Y,K,0])}prepare(){const s=Object.keys(this.tiles).length!==0;if(this.tileID&&!s)return;const c=this.map.painter.context,f=c.gl;!this._dirty||this.texture instanceof I2||(this.texture?this.texture.update(this.image):(this.texture=new nM(c,this.image,f.RGBA8),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE)),this._dirty=!1),s&&this._prepareData(c)}loadTile(s,c){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={},c(null)):(s.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(s){const c=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!c)return null;const f=this.elevatedGlobeTrianglesCenterLongitudes;let p=(_=s+180)+360*Math.round((f[0]-_)/360);var _;const b=new Qs,T=(z,q)=>{b.segments.push({vertexOffset:0,primitiveOffset:z,vertexLength:c.segments[0].vertexLength,primitiveLength:q,sortKey:void 0,vaos:{}})},I=.51*this.maxLongitudeTriangleSize;if(Math.abs(f[0]-p)<=I){const z=Ja(f,0,f.length,p+I);return z===f.length||T(z,as(f,z+1,f.length,p+360-I)-z),b}p<f[0]&&(p+=360);const M=as(f,0,f.length,p-I);if(M===f.length)return T(0,f.length),b;T(0,M-0);const O=Ja(f,M+1,f.length,p+I);return O!==f.length&&T(O,f.length-O),b}}const hge=(Math.pow(256,2)-1)/16907520;class cV extends Zl{constructor(s,c,f,p){super(s,{layout:sV||(sV=new Zs({visibility:new un(yt.layout_raster.visibility)})),paint:aV||(aV=new Zs({"raster-opacity":new un(yt.paint_raster["raster-opacity"]),"raster-color":new Zf(yt.paint_raster["raster-color"]),"raster-color-mix":new un(yt.paint_raster["raster-color-mix"]),"raster-color-range":new un(yt.paint_raster["raster-color-range"]),"raster-hue-rotate":new un(yt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new un(yt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new un(yt.paint_raster["raster-brightness-max"]),"raster-saturation":new un(yt.paint_raster["raster-saturation"]),"raster-contrast":new un(yt.paint_raster["raster-contrast"]),"raster-resampling":new un(yt.paint_raster["raster-resampling"]),"raster-fade-duration":new un(yt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new un(yt.paint_raster["raster-emissive-strength"]),"raster-array-band":new un(yt.paint_raster["raster-array-band"]),"raster-elevation":new un(yt.paint_raster["raster-elevation"]),"raster-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},c,f,p),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(s){return!(s&&s._source instanceof lV&&(s._source.onNorthPole||s._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(s){s!=="raster-color"&&s!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}updateColorRamp(s){if(!this.hasColorMap()||!this._curRampRange)return;const c=this._transitionablePaint._values["raster-color"].value.expression,[f,p]=s||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(f)&&isNaN(p)||f===this._curRampRange[0]&&p===this._curRampRange[1]||(this.colorRamp=m2({expression:c,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:f,end:p}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[f,p])}}let uV,dV,hV,fV,pV;class mV extends Zl{constructor(s,c,f,p){super(s,{layout:uV||(uV=new Zs({visibility:new un(yt["layout_raster-particle"].visibility)})),paint:dV||(dV=new Zs({"raster-particle-array-band":new un(yt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new un(yt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Zf(yt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new un(yt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new un(yt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new un(yt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new un(yt["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new un(yt["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},c,f,p),this._updateColorRamp(),this.lastInvalidatedAt=Yc.now()}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this.tileFramebuffer&&(this.tileFramebuffer.destroy(),this.tileFramebuffer=null),this.particleFramebuffer&&(this.particleFramebuffer.destroy(),this.particleFramebuffer=null)}onRemove(s){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(s){return!1}_handleSpecialPaintPropertyUpdate(s){s!=="raster-particle-color"&&s!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),s==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const s=this._transitionablePaint._values["raster-particle-color"].value.expression,c=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=m2({expression:s,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:c}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Yc.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class fge extends Zl{constructor(s,c){super(s,{},c,null),this.implementation=s,s.slot&&(this.slot=s.slot)}is3D(s){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(s){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(s){this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)}onRemove(s){this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)}}function kM(u,s,c){const f=[0,0,1],p=xn([]);return Sn(p,p,c?-lt(u)+Math.PI:lt(u)),Rn(p,p,-lt(s)),Ot(f,f,p),gt(f,f)}const gV={None:0,Model:1,Symbol:2,FillExtrusion:4};class pC{constructor(s,c,f,p){this.message=(s?`${s}: `:"")+f,p&&(this.identifier=p),c!=null&&c.__line__&&(this.line=c.__line__)}}function IM(u,s){const c=u.indexOf("://")===-1;try{return new URL(u,c&&s?"http://example.com":void 0),!0}catch{return!1}}class yV{constructor(s,c){this.feature=s,this.instancedDataOffset=c,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class vV{constructor(){this.instancedDataArray=new c2,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class NM{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.fqid),this.projection=s.projection,this.index=s.index,this.worldview=s.worldview,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z+1?0:this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=s.styleDefinedModelURLs}updateFootprints(s,c){}populate(s,c,f,p){this.tileToMeter=bt(f);const _=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:b,id:T,index:I,sourceLayerIndex:M}of s){const O=T??(b.properties&&b.properties.hasOwnProperty("id")?b.properties.id:void 0),z=dn(b,_);if(!this.layers[0]._featureFilter.filter(new hs(this.zoom,{worldview:this.worldview}),z,f))continue;const q={id:O,sourceLayerIndex:M,index:I,geometry:_?z.geometry:Nn(b,f,p),properties:b.properties,type:b.type,patterns:{}},K=this.addFeature(q,q.geometry,z);K&&c.featureIndex.insert(b,q.geometry,I,M,this.index,this.instancesPerModel[K].instancedDataArray.length,yn/32)}this.lookup=null}update(s,c,f,p){for(const _ in this.instancesPerModel){const b=this.instancesPerModel[_];for(const T in s)b.idToFeaturesIndex.hasOwnProperty(T)&&(this.evaluate(b.features[b.idToFeaturesIndex[T]],s[T],b,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let s=!1;for(const c in this.instancesPerModel){const f=this.instancesPerModel[c];for(const p of f.features){const _=this.layers[0],b=p.feature,T=this.canonical,I=_.paint.get("model-rotation").evaluate(b,{},T),M=_.paint.get("model-scale").evaluate(b,{},T),O=_.paint.get("model-translation").evaluate(b,{},T);Kt(p.rotation,I)&&Kt(p.scale,M)&&Kt(p.translation,O)||(this.evaluate(p,p.featureStates,f,!0),s=!0)}}return s}updateReplacement(s,c,f,p){if(c.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=c.updateTime;const _=c.getReplacementRegionsForTile(s.toUnwrapped(),!0);if(zT(this.activeReplacements,_))return!1;this.activeReplacements=_;let b=!1;for(const T in this.instancesPerModel){const I=this.instancesPerModel[T],M=I.instancedDataArray;for(const O of I.features){const z=O.instancedDataOffset,q=O.instancedDataCount;for(let K=0;K<q;K++){const Y=16*(K+z);let ae=M.float32[Y+0];const le=ae>yn;ae=le?ae-yn:ae;const ce=Math.floor(ae),Se=M.float32[Y+1];let Ae=!1;for(const Ee of this.activeReplacements)if(!i7(Ee,f,gV.Model,p)&&!(Ee.min.x>ce||ce>Ee.max.x||Ee.min.y>Se||Se>Ee.max.y)&&(Ae=qN(l7(ce,Se,s.canonical,Ee.footprintTileId.canonical),Ee.footprint),Ae))break;M.float32[Y]=Ae?ae+yn:ae,b=b||Ae!==le}}}return b}isEmpty(){for(const s in this.instancesPerModel)if(this.instancesPerModel[s].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(s){if(!this.uploaded)for(const c in this.instancesPerModel){const f=this.instancesPerModel[c];f.instancedDataArray.length<0||f.instancedDataArray.length===0||(f.instancedDataBuffer?f.instancedDataBuffer.updateData(f.instancedDataArray):f.instancedDataBuffer=s.createVertexBuffer(f.instancedDataArray,Vpe.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const c in this.instancesPerModel){const f=this.instancesPerModel[c];f.instancedDataArray.length!==0&&f.instancedDataBuffer&&f.instancedDataBuffer.destroy()}const s=this.layers[0].modelManager;if(s&&this.modelUris&&this.modelsRequested)for(const c of this.modelUris)s.removeModel(c,"",!0)}addFeature(s,c,f){const p=this.layers[0],_=p.layout.get("model-id").evaluate(f,{},this.canonical);if(!_)return ai(`modelId is not evaluated for layer ${p.id} and it is not going to get rendered.`),_;(IM(_,!1)||this.styleDefinedModelURLs[_]!==void 0)&&(this.modelUris.includes(_)||this.modelUris.push(_)),this.instancesPerModel[_]||(this.instancesPerModel[_]=new vV);const b=this.instancesPerModel[_],T=b.instancedDataArray,I=new yV(f,T.length);for(const M of c)for(const O of M){if(O.x<0||O.x>=yn||O.y<0||O.y>=yn)continue;if(this.lookupDim!==0){const q=(this.lookupDim-1)/yn,K=this.lookupDim*(O.y*q|0)+O.x*q|0;if(this.lookup){if(this.lookup[K]!==0)continue;this.lookup[K]=1}}this.instanceCount++;const z=T.length;T.resize(z+1),b.instancesEvaluatedElevation.push(0),T.float32[16*z]=O.x,T.float32[16*z+1]=O.y}return I.instancedDataCount=b.instancedDataArray.length-I.instancedDataOffset,I.instancedDataCount>0&&(s.id&&(b.idToFeaturesIndex[s.id]=b.features.length),b.features.push(I),this.evaluate(I,{},b,!1)),_}getModelUris(){return this.modelUris}evaluate(s,c,f,p){const _=this.layers[0],b=s.feature,T=this.canonical,I=s.rotation=_.paint.get("model-rotation").evaluate(b,c,T),M=s.scale=_.paint.get("model-scale").evaluate(b,c,T),O=s.translation=_.paint.get("model-translation").evaluate(b,c,T),z=_.paint.get("model-color").evaluate(b,c,T);z.a=_.paint.get("model-color-mix-intensity").evaluate(b,c,T);const q=[];this.maxVerticalOffset<O[2]&&(this.maxVerticalOffset=O[2]),this.maxScale=Math.max(Math.max(this.maxScale,M[0]),Math.max(M[1],M[2])),$7(q,I,M);const K=Math.round(100*z.a)+z.b/1.05;for(let Y=0;Y<s.instancedDataCount;++Y){const ae=s.instancedDataOffset+Y,le=16*ae,ce=f.instancedDataArray.float32;let Se=0;p&&(Se=ce[le+6]-f.instancesEvaluatedElevation[ae]);const Ae=0|ce[le+1];ce[le]=(0|ce[le])+z.r/1.05,ce[le+1]=Ae+z.g/1.05,ce[le+2]=K,ce[le+3]=1/(T.z>10?this.tileToMeter:bt(T,Ae)),ce[le+4]=O[0],ce[le+5]=O[1],ce[le+6]=O[2]+Se,ce[le+7]=q[0],ce[le+8]=q[1],ce[le+9]=q[2],ce[le+10]=q[4],ce[le+11]=q[5],ce[le+12]=q[6],ce[le+13]=q[8],ce[le+14]=q[9],ce[le+15]=q[10],f.instancesEvaluatedElevation[ae]=O[2]}}}let _V,xV;Pn(NM,"ModelBucket",{omit:["layers"]}),Pn(vV,"PerModelAttributes"),Pn(yV,"ModelFeature");class _1{constructor(s,c,f){this._demTile=s,this._dem=this._demTile.dem,this._scale=c,this._offset=f}static create(s,c,f){const p=f||s.findDEMTileFor(c);if(!p||!p.dem)return;const _=p.dem,b=p.tileID,T=1<<c.canonical.z-b.canonical.z;return new _1(p,_.dim/yn/T,[(c.canonical.x/T-b.canonical.x)*_.dim,(c.canonical.y/T-b.canonical.y)*_.dim])}tileCoordToPixel(s,c){const f=c*this._scale+this._offset[1];return new zt(Math.floor(s*this._scale+this._offset[0]),Math.floor(f))}getElevationAt(s,c,f,p){const _=s*this._scale+this._offset[0],b=c*this._scale+this._offset[1],T=Math.floor(_),I=Math.floor(b),M=this._dem;return p=!!p,f?qe(qe(M.get(T,I,p),M.get(T,I+1,p),b-I),qe(M.get(T+1,I,p),M.get(T+1,I+1,p),b-I),_-T):M.get(T,I,p)}getElevationAtPixel(s,c,f){return this._dem.get(s,c,!!f)}getMeterToDEM(s){return(1<<this._demTile.tileID.canonical.z)*Fe(1,s)*this._dem.stride}}const MM=new Float32Array(262144),f_=new Uint8Array(262144);function bV(u){let s=0;if(u.meshes)for(const c of u.meshes)s=Math.max(s,c.aabb.max[2]);if(u.children)for(const c of u.children)s=Math.max(s,bV(c));return s}function wV(u,s,c){if(u.meshes)for(const f of u.meshes){if(f.aabb.min[0]===1/0)continue;const p=gr.applyTransform(f.aabb,u.matrix);c.insert(s,p.min[0],p.min[1],p.max[0],p.max[1])}if(u.children)for(const f of u.children)wV(f,s,c)}const SV=["","wall","door","roof","window","lamp","logo"];class AV{constructor(s){this.node=s,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedTranslation=[0,0,0],this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:s.id,geometry:[],properties:{height:bV(s)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new gr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let s=0;const c=new gr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const f of this.node.meshes)this.node.lightMeshIndex!==s&&(f.transformedAabb=gr.applyTransformFast(f.aabb,this.node.matrix),c.encapsulate(f.transformedAabb)),s++;this.aabb=c}return this.aabb}}class mC{constructor(s,c,f,p,_,b,T,I){this.id=f,this.layers=s,this.layerIds=this.layers.map(M=>M.fqid),this.stateDependentLayerIds=this.layers.filter(M=>M.isStateDependent()).map(M=>M.id),this.modelTraits|=f1.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,p&&(this.modelTraits|=f1.HasMapboxMeshFeatures),_&&(this.modelTraits|=f1.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=b,this.worldview=I,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const M of c)this.nodesInfo.push(new AV(M)),wV(M,T.featureIndexArray.length,T.grid),T.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,T.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(s,c){for(const f of this.getNodesInfo()){const p=f.node;p.footprint&&c.push({footprint:p.footprint,id:s})}}update(s){const c=Object.keys(s).length!==0;if(c&&!this.stateDependentLayers.length)return;const f=c?this.stateDependentLayers:this.layers;if(!es(s,this.states))for(const p of f)this.evaluate(p,s);this.states=structuredClone(s)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(s){if(!this.needsUpload)return;const c=this.getNodesInfo();for(const f of c){const p=f.node;this.uploaded?this.updatePbrBuffer(p):sM(p,s,!0)}for(const f of c)KT(f.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(s){let c=!1;if(!s.meshes)return c;for(const f of s.meshes)f.pbrBuffer&&(f.pbrBuffer.updateData(f.featureArray),c=!0);return c}needsReEvaluation(s,c,f){const p=s.transform.projectionOptions,_=s.style.getBrightness(),b=this.brightness!==_;if(!this.uploaded||this.dirty||p.name!==this.projection.name||q2(f.paint.get("model-color").value,b)||q2(f.paint.get("model-color-mix-intensity").value,b)||q2(f.paint.get("model-roughness").value,b)||q2(f.paint.get("model-emissive-strength").value,b)||q2(f.paint.get("model-height-based-emissive-strength-multiplier").value,b)){this.projection=p,this.brightness=_;const T=this.getNodesInfo();for(const I of T)I.state=null;return!0}return!1}evaluateTransform(s,c){if(s.transform.zoom===this.zoom)return;this.zoom=s.transform.zoom;const f=this.getNodesInfo(),p=this.id.canonical;for(const _ of f){const b=_.feature;_.evaluatedTranslation=c.paint.get("model-translation").evaluate(b,{},p),_.evaluatedScale=c.paint.get("model-scale").evaluate(b,{},p)}}evaluate(s,c){const f=this.getNodesInfo();for(const p of f){if(!p.node.meshes)continue;const _=p.feature,b=c&&c[_.id];if(es(b,p.state))continue;p.state=structuredClone(b);const T=p.node.meshes&&p.node.meshes[0].featureData,I=p.evaluatedColor[2],M=p.evaluatedRMEA[2],O=this.id.canonical;if(p.hasTranslucentParts=!1,T){for(let z=0;z<SV.length;z++){const q=SV[z];q.length&&(_.properties.part=q);const K=s.paint.get("model-color").evaluate(_,b,O).toPremultipliedRenderColor(null),Y=s.paint.get("model-color-mix-intensity").evaluate(_,b,O);p.evaluatedColor[z]=[K.r,K.g,K.b,Y],p.evaluatedRMEA[z][0]=s.paint.get("model-roughness").evaluate(_,b,O),p.evaluatedRMEA[z][2]=s.paint.get("model-emissive-strength").evaluate(_,b,O),p.evaluatedRMEA[z][3]=K.a,p.emissionHeightBasedParams[z]=s.paint.get("model-height-based-emissive-strength-multiplier").evaluate(_,b,O),!p.hasTranslucentParts&&K.a<1&&(p.hasTranslucentParts=!0)}delete _.properties.part,mge(p,I!==p.evaluatedColor[2]||M!==p.evaluatedRMEA[2],this.modelTraits)}else p.evaluatedRMEA[0][2]=s.paint.get("model-emissive-strength").evaluate(_,b,O);p.evaluatedTranslation=s.paint.get("model-translation").evaluate(_,b,O),p.evaluatedScale=s.paint.get("model-scale").evaluate(_,b,O),this.updatePbrBuffer(p.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(s,c,f,p){const _=s.findDEMTileFor(f);if(_&&(_.tileID.canonical!==this.terrainTile||c!==this.terrainExaggeration)){if(_.dem&&_.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=_.tileID.overscaledZ;const b=_1.create(s,f,_);if(!b)return;this.modelTraits&f1.HasMapboxMeshFeatures&&this.updateDEM(s,b,f,p);for(const T of this.getNodesInfo()){const I=T.node;if(!I.footprint||!I.footprint.vertices||!I.footprint.vertices.length)continue;const M=I.footprint.vertices;let O=b.getElevationAt(M[0].x,M[0].y,!0,!0);for(let z=1;z<M.length;z++)O=Math.min(O,b.getElevationAt(M[z].x,M[z].y,!0,!0));I.elevation=O}}this.terrainTile=_.tileID.canonical,this.terrainExaggeration=c}}updateDEM(s,c,f,p){let _=c._dem._modifiedForSources[p];if(_===void 0&&(c._dem._modifiedForSources[p]=[],_=c._dem._modifiedForSources[p]),_.includes(f.canonical))return;const b=c._dem.dim;_.push(f.canonical);let T=!1;for(const I of this.getNodesInfo()){const M=I.node;if(!M.footprint||!M.footprint.grid)continue;const O=M.footprint.grid,z=c.tileCoordToPixel(O.min.x,O.min.y),q=c.tileCoordToPixel(O.max.x,O.max.y),K=Math.min(Math.min(b-q.y,z.x),Math.min(z.y,b-q.x));if(K<0)continue;const Y=We(K,2,5);let ae=Math.max(0,z.x-Y),le=Math.max(0,z.y-Y),ce=Math.min(q.x+Y,b-1),Se=Math.min(q.y+Y,b-1);for(let Ke=le;Ke<=Se;++Ke)for(let tt=ae;tt<=ce;++tt)f_[Ke*b+tt]=255;let Ae=0,Ee=0;for(let Ke=0;Ke<O.cellsY;++Ke)for(let tt=0;tt<O.cellsX;++tt){if(!O.cells[Ke*O.cellsX+tt])continue;const at=c.tileCoordToPixel(O.min.x+tt/O.xScale,O.min.y+Ke/O.yScale),ct=c.tileCoordToPixel(O.min.x+(tt+1)/O.xScale,O.min.y+(Ke+1)/O.yScale);for(let qt=at.y;qt<=Math.min(ct.y+1,b-1);++qt)for(let _t=at.x;_t<=Math.min(ct.x+1,b-1);++_t)f_[qt*b+_t]===255&&(f_[qt*b+_t]=0,Ae+=c.getElevationAtPixel(_t,qt),Ee++)}const Ze=Ae/Ee;ae=Math.max(1,z.x-Y),le=Math.max(1,z.y-Y),ce=Math.min(q.x+Y,b-2),Se=Math.min(q.y+Y,b-2),T=!0;for(let Ke=le;Ke<=Se;++Ke)for(let tt=ae;tt<=ce;++tt)f_[Ke*b+tt]===0&&(MM[Ke*b+tt]=c._dem.set(tt,Ke,Ze));for(let Ke=1;Ke<Y;++Ke){ae=Math.max(1,z.x-Ke),le=Math.max(1,z.y-Ke),ce=Math.min(q.x+Ke,b-2),Se=Math.min(q.y+Ke,b-2);for(let tt=le;tt<=Se;++tt)for(let at=ae;at<=ce;++at){const ct=tt*b+at;if(f_[ct]===255){let qt=0,_t=0,Xt=-1,an=-1;for(let Jt=-1;Jt<=1;++Jt)for(let en=-1;en<=1;++en){const hn=(tt+Jt)*b+at+en;if(f_[hn]>=Ke)continue;const Vt=MM[hn],nn=Math.abs(Vt);nn>_t&&(qt=Vt,_t=nn,Xt=en,an=Jt)}if(_t>.1){const Jt=1-(Ke+.5*Math.abs(Xt*an))/Y;let en=c._dem.get(at,tt)+qt*Jt;const hn=c._dem.get(at+Xt,tt+an),Vt=c._dem.get(at-Xt,tt-an,!0);(en-hn)*(en-Vt)>0&&(en=(hn+Vt)/2),MM[ct]=c._dem.set(at,tt,en),f_[ct]=Ke}}}}}T&&(c._demTile.needsDEMTextureUpload=!0,c._dem._timestamp=Yc.now())}setFilter(s){this.filter=s?Xp(s):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(s=>this.filter.filter(new hs(this.id.overscaledZ,{worldview:this.worldview}),s.feature,this.id.canonical)):this.nodesInfo}destroy(){const s=this.getNodesInfo();for(const c of s)KT(c.node),aM(c.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(s,c){if(c.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=c.updateTime;const f=c.getReplacementRegionsForTile(s.toUnwrapped());for(const p of this.getNodesInfo()){const _=p.node.footprint;p.hiddenByReplacement=!!_&&!f.find(b=>b.footprint===_)}}getHeightAtTileCoord(s,c){const f=[],p=[0,0,0],_=D([]);for(const b of this.getNodesInfo()){const T=b.node.meshes[0],I=T.transformedAabb;if(s<I.min[0]||c<I.min[1]||s>I.max[0]||c>I.max[1])continue;if(b.node.hidden===!0)return{height:1/0,maxHeight:b.feature.properties.height,hidden:!1,verticalScale:b.evaluatedScale[2]};B(_,b.node.matrix),p[0]=s,p[1]=c,Pt(p,p,_);const M=(p[0]-T.aabb.min[0])/(T.aabb.max[0]-T.aabb.min[0])*u_|0,O=Math.min(63,(p[1]-T.aabb.min[1])/(T.aabb.max[1]-T.aabb.min[1])*u_|0)*u_+Math.min(63,M),z=T.heightmap[O];if(!(z<0&&b.node.footprint))return b.hiddenByReplacement?void 0:{height:z,maxHeight:b.feature.properties.height,hidden:!1,verticalScale:b.evaluatedScale[2]};if(b.node.footprint.grid.query(new zt(s,c),new zt(s,c),f),f.length>0)return{height:void 0,maxHeight:b.feature.properties.height,hidden:b.hiddenByReplacement,verticalScale:b.evaluatedScale[2]}}}}function q2(u,s){return u instanceof ms&&!u.isLightConstant&&s}function pge(u,s,c,f,p,_,b,T){let I=(61440&s|(61440&s)>>4)>>8,M=(3840&s|(3840&s)>>4)>>4,O=240&s|(240&s)>>4;c[3]>0&&(I=qe(I,255*c[0],c[3]),M=qe(M,255*c[1],c[3]),O=qe(O,255*c[2],c[3]));const z=I<<8|M,q=O<<8|Math.floor(255*f[3]),K=function(Ke){const tt=We(Ke,0,2);return Math.min(Math.round(.5*tt*255),255)}(f[2])<<8|15*f[0]<<4|15*f[1],Y=We(p[0],0,1),ae=We(p[1],0,1),le=We(p[2],0,1),ce=We(p[3],0,1);let Se,Ae,Ee,Ze;if(Y!==ae&&b!==_&&ae!==Y){const Ke=b-_;Ae=1/(Ke*(ae-Y)),Ee=-(_+Ke*Y)/(Ke*(ae-Y));const tt=We(p[4],-1,1);Ze=Math.pow(10,tt),Se=255*le<<8|255*ce}else Se=65535,Ae=0,Ee=1,Ze=1;if(u.emplaceBack(z,q,K,Se,Ae,Ee,Ze),T){const Ke=T.length;T.clear();for(let tt=0;tt<Ke;tt++)T.emplaceBack(z,q,K,Se,Ae,Ee,Ze)}}function mge(u,s,c){const f=u.node;let p=0;const _=c&f1.HasMeshoptCompression;for(const b of f.meshes){if(f.lights&&f.lightMeshIndex===p||!b.featureData)continue;b.featureArray=new Xy,b.featureArray.reserve(b.featureData.length);let T=s;for(const I of b.featureData){const M=_?65535&I:I>>16&65535,O=_?I>>16&65535:65535&I,z=(15&O)<8?15&O:0,q=u.evaluatedRMEA[z],K=u.evaluatedColor[z],Y=u.emissionHeightBasedParams[z];let ae;if(T&&z===2&&f.lights&&(ae=new Xy,ae.resize(10*f.lights.length)),pge(b.featureArray,M,K,q,Y,b.aabb.min[2],b.aabb.max[2],ae),ae&&T){T=!1;const le=f.meshes[f.lightMeshIndex];le.featureArray=ae,le.featureArray._trim()}}b.featureArray._trim(),p++}}function TV(u,s,c,f){const p=1<<u.z;s.lat=ze((f/yn+u.y)/p),s.lng=Ve((c/yn+u.x)/p)}function gge(u,s,c,f){const p=u.getNodesInfo()[s];if(!p||p.hiddenByReplacement||!p.node.meshes)return;let _=Number.MAX_VALUE;const b=p.node,T=c.tile,I=f.calculatePosMatrix(T.tileID.toUnwrapped(),f.worldSize),M=p.evaluatedScale;let O=0;f.elevation&&b.elevation&&(O=b.elevation*f.elevation.exaggeration()),$(I,I,[(b.anchor?b.anchor[0]:0)*(M[0]-1),(b.anchor?b.anchor[1]:0)*(M[1]-1),O]),H(I,I,M);const z=c.queryGeometry,q=z.isPointQuery()?z.screenBounds:z.screenGeometry,K=function(ae){const le=F([],I,ae.matrix);F(le,f.expandedFarZProjMatrix,le);for(let ce=0;ce<ae.meshes.length;++ce){const Se=ae.meshes[ce];if(ce===ae.lightMeshIndex)continue;const Ae=q7(q,f,le,Se.aabb);Ae!=null&&(_=Math.min(Ae,_))}if(ae.children)for(const ce of ae.children)K(ce)};if(K(b),_===Number.MAX_VALUE)return;const Y=new se(0,0);return TV(T.tileID.canonical,Y,p.node.anchor[0],p.node.anchor[1]),{intersectionZ:_,position:Y,feature:p.feature}}Pn(mC,"Tiled3dModelBucket",{omit:["layers"]}),Pn(AV,"Tiled3dModelFeature");const yge={circle:class extends Zl{constructor(u,s,c,f){super(u,{layout:Qy||(Qy=new Zs({"circle-sort-key":new wn(yt.layout_circle["circle-sort-key"]),"circle-elevation-reference":new un(yt.layout_circle["circle-elevation-reference"]),visibility:new un(yt.layout_circle.visibility)})),paint:Jf||(Jf=new Zs({"circle-radius":new wn(yt.paint_circle["circle-radius"]),"circle-color":new wn(yt.paint_circle["circle-color"]),"circle-blur":new wn(yt.paint_circle["circle-blur"]),"circle-opacity":new wn(yt.paint_circle["circle-opacity"]),"circle-translate":new un(yt.paint_circle["circle-translate"]),"circle-translate-anchor":new un(yt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new un(yt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new un(yt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new wn(yt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new wn(yt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new wn(yt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new un(yt.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},s,c,f)}createBucket(u){return new el(u)}queryRadius(u){const s=u;return ch("circle-radius",this,s)+ch("circle-stroke-width",this,s)+lm(this.paint.get("circle-translate"))}queryIntersectsFeature(u,s,c,f,p,_,b,T){const I=Jh(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,u.pixelToTileUnitsFactor),M=this.paint.get("circle-radius").evaluate(s,c)+this.paint.get("circle-stroke-width").evaluate(s,c);return N8(u,f,_,b,T,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",I,M)}getProgramIds(){return["circle"]}getDefaultProgramParams(u,s,c){const f=I8(this);return{config:new wg(this,{zoom:s,lut:c}),defines:f,overrideFog:!1}}is3D(u){return!u&&!!this.layout&&this.layout.get("circle-elevation-reference")!=="none"}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends Zl{createBucket(u){return new L8(u)}constructor(u,s,c,f){super(u,{layout:D8||(D8=new Zs({visibility:new un(yt.layout_heatmap.visibility)})),paint:R8||(R8=new Zs({"heatmap-radius":new wn(yt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new wn(yt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new un(yt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Zf(yt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new un(yt.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},s,c,f),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=m2({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}_clear(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}queryRadius(u){return ch("heatmap-radius",this,u)}queryIntersectsFeature(u,s,c,f,p,_,b,T){const I=this.paint.get("heatmap-radius").evaluate(s,c);return N8(u,f,_,b,T,!0,!0,new zt(0,0),I)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(u,s,c){return u==="heatmap"?{config:new wg(this,{zoom:s,lut:c}),overrideFog:!1}:{}}},hillshade:class extends Zl{constructor(u,s,c,f){super(u,{layout:j8||(j8=new Zs({visibility:new un(yt.layout_hillshade.visibility)})),paint:O8||(O8=new Zs({"hillshade-illumination-direction":new un(yt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new un(yt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new un(yt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new un(yt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new un(yt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new un(yt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new un(yt.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},s,c,f)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(u,s,c){return{overrideFog:!1}}},fill:class extends Zl{constructor(u,s,c,f){super(u,{layout:J8||(J8=new Zs({"fill-sort-key":new wn(yt.layout_fill["fill-sort-key"]),visibility:new un(yt.layout_fill.visibility),"fill-elevation-reference":new un(yt.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new wn(yt.layout_fill["fill-construct-bridge-guard-rail"])})),paint:Q8||(Q8=new Zs({"fill-antialias":new un(yt.paint_fill["fill-antialias"]),"fill-opacity":new wn(yt.paint_fill["fill-opacity"]),"fill-color":new wn(yt.paint_fill["fill-color"]),"fill-outline-color":new wn(yt.paint_fill["fill-outline-color"]),"fill-translate":new un(yt.paint_fill["fill-translate"]),"fill-translate-anchor":new un(yt.paint_fill["fill-translate-anchor"]),"fill-pattern":new wn(yt.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new un(yt.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new un(yt.paint_fill["fill-emissive-strength"]),"fill-z-offset":new wn(yt.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new wn(yt.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new wn(yt.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},s,c,f)}getProgramIds(){const u=this.paint.get("fill-pattern"),s=u&&u.constantOr(1),c=[s?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&c.push(s&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),c}getDefaultProgramParams(u,s,c){return{config:new wg(this,{zoom:s,lut:c}),overrideFog:!1}}recalculate(u,s){super.recalculate(u,s);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new UN(u)}queryRadius(){return lm(this.paint.get("fill-translate"))}queryIntersectsFeature(u,s,c,f,p,_){return!u.queryGeometry.isAboveHorizon&&uu(cm(u.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,u.pixelToTileUnitsFactor),f)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(u){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const s=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return u!=null?s&&!u:s}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends Zl{constructor(u,s,c,f){super(u,{layout:w7||(w7=new Zs({visibility:new un(yt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new un(yt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:S7||(S7=new Zs({"fill-extrusion-opacity":new un(yt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new wn(yt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new un(yt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new un(yt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new wn(yt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new un(yt["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new wn(yt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new wn(yt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new un(yt["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new un(yt["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new un(yt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new un(yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new un(yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new un(yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new un(yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new un(yt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new un(yt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new un(yt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new wn(yt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new wn(yt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new un(yt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new un(yt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new un(yt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new un(yt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new wn(yt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new wn(yt["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new un(yt["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},s,c,f),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new UT(u)}queryRadius(){return lm(this.paint.get("fill-extrusion-translate"))}is3D(u){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(u,s,c,f,p,_,b,T,I){const M=Jh(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,u.pixelToTileUnitsFactor),O=this.paint.get("fill-extrusion-height").evaluate(s,c),z=this.paint.get("fill-extrusion-base").evaluate(s,c),q=[0,0],K=T&&_.elevation,Y=_.elevation?_.elevation.exaggeration():1,ae=u.tile.getBucket(this);if(K&&ae instanceof UT){const Ee=ae.centroidVertexArray,Ze=I+1;Ze<Ee.length&&(q[0]=Ee.geta_centroid_pos0(Ze),q[1]=Ee.geta_centroid_pos1(Ze))}if(q[0]===0&&q[1]===1)return!1;_.projection.name==="globe"&&(f=b7([f],[new zt(0,0),new zt(yn,yn)],u.tileID.canonical).map(Ee=>Ee.polygon).flat());const le=K?T:null,[ce,Se]=function(Ee,Ze,Ke,tt,at,ct,qt,_t,Xt,an,Jt){return Ee.projection.name==="globe"?function(en,hn,Vt,nn,Lt,It,fn,cn,tr,Fn,qn){const vn=[],er=[],Ir=en.projection.upVectorScale(qn,en.center.lat,en.worldSize).metersToTile,En=[0,0,0,1],Yn=[0,0,0,1],pr=(ii,zr,Bn,jr)=>{ii[0]=zr,ii[1]=Bn,ii[2]=jr,ii[3]=1},Lr=x7();Vt>0&&(Vt+=Lr),nn+=Lr;for(const ii of hn){const zr=[],Bn=[];for(const jr of ii){const ki=jr.x+Lt.x,Me=jr.y+Lt.y,Le=en.projection.projectTilePoint(ki,Me,qn),Mt=en.projection.upVector(qn,jr.x,jr.y);let $t=Vt,Tn=nn;if(fn){const An=k7(ki,Me,Vt,nn,fn,cn,tr,Fn);$t+=An.base,Tn+=An.top}Vt!==0?pr(En,Le.x+Mt[0]*Ir*$t,Le.y+Mt[1]*Ir*$t,Le.z+Mt[2]*Ir*$t):pr(En,Le.x,Le.y,Le.z),pr(Yn,Le.x+Mt[0]*Ir*Tn,Le.y+Mt[1]*Ir*Tn,Le.z+Mt[2]*Ir*Tn),Pt(En,En,It),Pt(Yn,Yn,It),zr.push(new l_(En[0],En[1],En[2])),Bn.push(new l_(Yn[0],Yn[1],Yn[2]))}vn.push(zr),er.push(Bn)}return[vn,er]}(Ee,Ze,Ke,tt,at,ct,qt,_t,Xt,an,Jt):qt?function(en,hn,Vt,nn,Lt,It,fn,cn,tr){const Fn=[],qn=[],vn=[0,0,0,1];for(const er of en){const Ir=[],En=[];for(const Yn of er){const pr=Yn.x+nn.x,Lr=Yn.y+nn.y,ii=k7(pr,Lr,hn,Vt,It,fn,cn,tr);vn[0]=pr,vn[1]=Lr,vn[2]=ii.base,vn[3]=1,wt(vn,vn,Lt),vn[3]=Math.max(vn[3],1e-5);const zr=new l_(vn[0]/vn[3],vn[1]/vn[3],vn[2]/vn[3]);vn[0]=pr,vn[1]=Lr,vn[2]=ii.top,vn[3]=1,wt(vn,vn,Lt),vn[3]=Math.max(vn[3],1e-5);const Bn=new l_(vn[0]/vn[3],vn[1]/vn[3],vn[2]/vn[3]);Ir.push(zr),En.push(Bn)}Fn.push(Ir),qn.push(En)}return[Fn,qn]}(Ze,Ke,tt,at,ct,qt,_t,Xt,an):function(en,hn,Vt,nn,Lt){const It=[],fn=[],cn=Lt[8]*hn,tr=Lt[9]*hn,Fn=Lt[10]*hn,qn=Lt[11]*hn,vn=Lt[8]*Vt,er=Lt[9]*Vt,Ir=Lt[10]*Vt,En=Lt[11]*Vt;for(const Yn of en){const pr=[],Lr=[];for(const ii of Yn){const zr=ii.x+nn.x,Bn=ii.y+nn.y,jr=Lt[0]*zr+Lt[4]*Bn+Lt[12],ki=Lt[1]*zr+Lt[5]*Bn+Lt[13],Me=Lt[2]*zr+Lt[6]*Bn+Lt[14],Le=Lt[3]*zr+Lt[7]*Bn+Lt[15],Mt=jr+cn,$t=ki+tr,Tn=Me+Fn,An=Math.max(Le+qn,1e-5),zn=jr+vn,or=ki+er,si=Me+Ir,oi=Math.max(Le+En,1e-5);pr.push(new l_(Mt/An,$t/An,Tn/An)),Lr.push(new l_(zn/oi,or/oi,si/oi))}It.push(pr),fn.push(Lr)}return[It,fn]}(Ze,Ke,tt,at,ct)}(_,f,z,O,M,b,le,q,Y,_.center.lat,u.tileID.canonical),Ae=u.queryGeometry;return function(Ee,Ze,Ke){let tt=1/0;uu(Ke,Ze)&&(tt=P7(Ke,Ze[0]));for(let at=0;at<Ze.length;at++){const ct=Ze[at],qt=Ee[at];for(let _t=0;_t<ct.length-1;_t++){const Xt=ct[_t],an=[Xt,ct[_t+1],qt[_t+1],qt[_t],Xt];Uu(Ke,an)&&(tt=Math.min(tt,P7(Ke,an)))}}return tt!==1/0&&tt}(ce,Se,Ae.isPointQuery()?Ae.screenBounds:Ae.screenGeometry)}},building:class extends Zl{constructor(u,s,c,f){super(u,{layout:eU||(eU=new Zs({visibility:new un(yt.layout_building.visibility),"building-facade":new wn(yt.layout_building["building-facade"]),"building-facade-floors":new wn(yt.layout_building["building-facade-floors"]),"building-facade-unit-width":new wn(yt.layout_building["building-facade-unit-width"]),"building-facade-window":new wn(yt.layout_building["building-facade-window"]),"building-roof-shape":new wn(yt.layout_building["building-roof-shape"]),"building-height":new wn(yt.layout_building["building-height"]),"building-base":new wn(yt.layout_building["building-base"]),"building-flood-light-wall-radius":new wn(yt.layout_building["building-flood-light-wall-radius"]),"building-flood-light-ground-radius":new wn(yt.layout_building["building-flood-light-ground-radius"]),"building-flip-roof-orientation":new wn(yt.layout_building["building-flip-roof-orientation"])})),paint:tU||(tU=new Zs({"building-opacity":new un(yt.paint_building["building-opacity"]),"building-ambient-occlusion-intensity":new un(yt.paint_building["building-ambient-occlusion-intensity"]),"building-ambient-occlusion-ground-intensity":new un(yt.paint_building["building-ambient-occlusion-ground-intensity"]),"building-ambient-occlusion-ground-radius":new un(yt.paint_building["building-ambient-occlusion-ground-radius"]),"building-ambient-occlusion-ground-attenuation":new un(yt.paint_building["building-ambient-occlusion-ground-attenuation"]),"building-vertical-scale":new un(yt.paint_building["building-vertical-scale"]),"building-cast-shadows":new un(yt.paint_building["building-cast-shadows"]),"building-color":new wn(yt.paint_building["building-color"]),"building-emissive-strength":new wn(yt.paint_building["building-emissive-strength"]),"building-facade-emissive-chance":new un(yt.paint_building["building-facade-emissive-chance"]),"building-cutoff-fade-range":new un(yt.paint_building["building-cutoff-fade-range"]),"building-flood-light-color":new un(yt.paint_building["building-flood-light-color"]),"building-flood-light-intensity":new un(yt.paint_building["building-flood-light-intensity"]),"building-flood-light-ground-attenuation":new un(yt.paint_building["building-flood-light-ground-attenuation"]),"building-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"building-flood-light-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},s,c,f),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new Q7(u)}cutoffRange(){return this.paint.get("building-cutoff-fade-range")}hasShadowPass(){return this.paint.get("building-cast-shadows")}hasLightBeamPass(){return!0}canCastShadows(){return!0}is3D(u){return!0}},line:class extends Zl{constructor(u,s,c,f){const p=dU();super(u,p,s,c,f),p.layout&&(this.layout=new Zh(p.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const s=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=s._styleExpression&&s._styleExpression.expression instanceof su,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(u,s){super.recalculate(u,s),this.paint._values["line-floorwidth"]=(()=>{if(M2)return M2;const c=dU();return M2=new mme(c.paint.properties["line-width"].specification),M2.useIntegerZoom=!0,M2})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new uM(u)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(u,s,c){const f=cU(this);return{config:new wg(this,{zoom:s,lut:c}),defines:f,overrideFog:!1}}queryRadius(u){const s=u,c=hU(ch("line-width",this,s),ch("line-gap-width",this,s)),f=ch("line-offset",this,s);return c/2+Math.abs(f)+lm(this.paint.get("line-translate"))}queryIntersectsFeature(u,s,c,f,p,_){if(u.queryGeometry.isAboveHorizon)return!1;const b=cm(u.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,u.pixelToTileUnitsFactor),T=u.pixelToTileUnitsFactor/2*hU(this.paint.get("line-width").evaluate(s,c),this.paint.get("line-gap-width").evaluate(s,c)),I=this.paint.get("line-offset").evaluate(s,c);return I&&(f=function(M,O){const z=[],q=new zt(0,0);for(let K=0;K<M.length;K++){const Y=M[K],ae=[];for(let le=0;le<Y.length;le++){const ce=Y[le],Se=Y[le+1],Ae=le===0?q:ce.sub(Y[le-1])._unit()._perp(),Ee=le===Y.length-1?q:Se.sub(ce)._unit()._perp(),Ze=Ae._add(Ee)._unit();Ze._mult(1/(Ze.x*Ee.x+Ze.y*Ee.y)),ae.push(Ze._mult(O)._add(ce))}z.push(ae)}return z}(f,I*u.pixelToTileUnitsFactor)),function(M,O,z){for(let q=0;q<O.length;q++){const K=O[q];if(M.length>=3){for(let Y=0;Y<K.length;Y++)if(Lo(M,K[Y]))return!0}if(du(M,K,z))return!0}return!1}(b,f,T)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(u){return!this.hasElevatedBuckets||this.layout&&this.layout.get("line-elevation-reference")==="hd-road-markup"}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:dC,background:class extends Zl{constructor(u,s,c,f){super(u,{layout:rV||(rV=new Zs({visibility:new un(yt.layout_background.visibility)})),paint:iV||(iV=new Zs({"background-pitch-alignment":new un(yt.paint_background["background-pitch-alignment"]),"background-color":new un(yt.paint_background["background-color"]),"background-pattern":new un(yt.paint_background["background-pattern"]),"background-opacity":new un(yt.paint_background["background-opacity"]),"background-emissive-strength":new un(yt.paint_background["background-emissive-strength"]),"background-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},s,c,f)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(u,s,c){return{overrideFog:!1}}is3D(u){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:cV,"raster-particle":mV,sky:class extends Zl{constructor(u,s,c,f){super(u,{layout:hV||(hV=new Zs({visibility:new un(yt.layout_sky.visibility)})),paint:fV||(fV=new Zs({"sky-type":new un(yt.paint_sky["sky-type"]),"sky-atmosphere-sun":new un(yt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new un(yt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new un(yt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new un(yt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Zf(yt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new un(yt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new un(yt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new un(yt.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},s,c,f),this._updateColorRamp()}_clear(){this.skyboxFbo&&(this.skyboxFbo.destroy(),this.skyboxFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this._skyboxInvalidated=!0}_handleSpecialPaintPropertyUpdate(u){u==="sky-gradient"?this._updateColorRamp():u!=="sky-atmosphere-sun"&&u!=="sky-atmosphere-halo-color"&&u!=="sky-atmosphere-color"&&u!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=m2({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(u){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const s=u.style.light.properties.get("position");return this._lightPosition.azimuthal!==s.azimuthal||this._lightPosition.polar!==s.polar}return!1}getCenter(u,s){if(this.paint.get("sky-type")==="atmosphere"){const f=this.paint.get("sky-atmosphere-sun"),p=!f,_=u.style.light,b=_.properties.get("position");return p&&_.properties.get("anchor")==="viewport"&&ai("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?kM(b.azimuthal,90-b.polar,s):kM(f[0],90-f[1],s)}const c=this.paint.get("sky-gradient-center");return kM(c[0],90-c[1],s)}isSky(){return!0}markSkyboxValid(u){this._skyboxInvalidated=!1,this._lightPosition=u.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const u=this.paint.get("sky-type");return u==="atmosphere"?["skyboxCapture","skybox"]:u==="gradient"?["skyboxGradient"]:null}},slot:class extends Zl{constructor(u,s,c,f){super(u,{paint:pV||(pV=new Zs({}))},s,null)}},model:class extends Zl{constructor(u,s,c,f){super(u,{layout:_V||(_V=new Zs({visibility:new un(yt.layout_model.visibility),"model-id":new wn(yt.layout_model["model-id"])})),paint:xV||(xV=new Zs({"model-opacity":new wn(yt.paint_model["model-opacity"]),"model-rotation":new wn(yt.paint_model["model-rotation"]),"model-scale":new wn(yt.paint_model["model-scale"]),"model-translation":new wn(yt.paint_model["model-translation"]),"model-color":new wn(yt.paint_model["model-color"]),"model-color-mix-intensity":new wn(yt.paint_model["model-color-mix-intensity"]),"model-type":new un(yt.paint_model["model-type"]),"model-cast-shadows":new un(yt.paint_model["model-cast-shadows"]),"model-receive-shadows":new un(yt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new un(yt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new wn(yt.paint_model["model-emissive-strength"]),"model-roughness":new wn(yt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new wn(yt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new un(yt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new un(yt.paint_model["model-front-cutoff"]),"model-elevation-reference":new un(yt.paint_model["model-elevation-reference"]),"model-color-use-theme":new wn({type:"string",default:"default","property-type":"data-driven"})}))},s,c,f),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new NM(u)}getProgramIds(){return["model"]}is3D(u){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(u){return u instanceof mC?yn-1:0}queryIntersectsFeature(u,s,c,f,p,_){if(!this.modelManager)return!1;const b=this.modelManager,T=u.tile.getBucket(this);if(!(T&&T instanceof NM))return!1;for(const I in T.instancesPerModel){const M=T.instancesPerModel[I],O=s.id!==void 0?s.id:s.properties&&s.properties.hasOwnProperty("id")?s.properties.id:void 0;if(M.idToFeaturesIndex.hasOwnProperty(O)){const z=M.features[M.idToFeaturesIndex[O]],q=b.getModel(I,this.scope);if(!q)return!1;let K=j();const Y=new se(0,0),ae=T.canonical;let le=Number.MAX_VALUE;for(let ce=0;ce<z.instancedDataCount;++ce){const Se=16*(z.instancedDataOffset+ce),Ae=M.instancedDataArray.float32,Ee=[Ae[Se+4],Ae[Se+5],Ae[Se+6]];TV(ae,Y,Ae[Se],0|Ae[Se+1]),G7(K,q,_,Y,z.rotation,z.scale,Ee,!1,!1,!1),_.projection.name==="globe"&&(K=iM(K,_));const Ze=F([],_.projMatrix,K),Ke=u.queryGeometry,tt=q7(Ke.isPointQuery()?Ke.screenBounds:Ke.screenGeometry,_,Ze,q.aabb);tt!=null&&(le=Math.min(tt,le))}return le!==Number.MAX_VALUE&&le}}return!1}_handleOverridablePaintPropertyUpdate(u,s,c){return!(!this.layout||s.isDataDriven()||c.isDataDriven()||u!=="model-color"&&u!=="model-color-mix-intensity"&&u!=="model-rotation"&&u!=="model-scale"&&u!=="model-translation"&&u!=="model-emissive-strength")}_isPropertyZoomDependent(u){const s=this._transitionablePaint._values[u];return s!=null&&s.value!=null&&s.value.expression!=null&&s.value.expression instanceof ws}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends Zl{constructor(u,s,c,f){super(u,{layout:e7||(e7=new Zs({"clip-layer-types":new un(yt.layout_clip["clip-layer-types"]),"clip-layer-scope":new un(yt.layout_clip["clip-layer-scope"])})),paint:t7||(t7=new Zs({}))},s,c,f)}recalculate(u,s){super.recalculate(u,s)}createBucket(u){return new n7(u)}is3D(u){return!0}}},LM=new Ii(0,0,0),DM={PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},RM={LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},gC={LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},vge={PAINT_ORDER_FILL_AND_STROKE:1},G2={PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},CV={MASK_TYPE_LUMINANCE:1};function _ge(u,s,c){u===1&&s.icons.push(function(f,p){return function(_){if(_.usvg_tree.height||(_.usvg_tree.height=_.usvg_tree.width),!_.metadata)return _;const{metadata:b}=_;if(b.content_area){const{content_area:T}=b;T.left==null&&(T.left=0),T.top==null&&(T.top=T.left),T.width==null&&(T.width=_.usvg_tree.width),T.height==null&&(T.height=T.width)}if(b.text_placeholder){const{text_placeholder:T}=b;T.top==null&&(T.top=T.left),T.height==null&&(T.height=T.width)}return b.stretch_x&&b.stretch_x.length&&EV(b,"x"),b.stretch_y&&b.stretch_y.length&&EV(b,"y"),_}(f.readFields(xge,{name:void 0},p))}(c,c.readVarint()+c.pos))}function EV(u,s){const c=[],f=u[`stretch_${s}`];let p=null;for(let _=0;_<f.length;_++)p===null?p=c.length===0?f[0]:c[c.length-1][1]+f[_]:(c.push([p,p+f[_]]),p=null);u[`stretch_${s}_areas`]=c}function xge(u,s,c){u===1?s.name=c.readString():u===2?s.metadata=function(f,p){return f.readFields(bge,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},p)}(c,c.readVarint()+c.pos):u===3&&(s.usvg_tree=function(f,p){return f.readFields(Age,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},p)}(c,c.readVarint()+c.pos),s.data="usvg_tree")}function bge(u,s,c){u===1?s.stretch_x=c.readPackedVarint():u===2?s.stretch_y=c.readPackedVarint():u===3?s.content_area=PV(c,c.readVarint()+c.pos):u===4?s.variables.push(function(f,p){return f.readFields(Sge,{name:void 0},p)}(c,c.readVarint()+c.pos)):u===5&&(s.text_placeholder=PV(c,c.readVarint()+c.pos))}function PV(u,s){return u.readFields(wge,{},s)}function wge(u,s,c){u===1?s.left=c.readVarint():u===2?s.width=c.readVarint():u===3?s.top=c.readVarint():u===4&&(s.height=c.readVarint())}function Sge(u,s,c){u===1?s.name=c.readString():u===2&&(s.rgb_color=_C(c.readVarint()),s.value="rgb_color")}function Age(u,s,c){u===1?s.width=s.height=c.readVarint():u===2?s.height=c.readVarint():u===3?s.children.push(yC(c,c.readVarint()+c.pos)):u===4?s.linear_gradients.push(function(f,p){return f.readFields(Nge,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},p)}(c,c.readVarint()+c.pos)):u===5?s.radial_gradients.push(function(f,p){return f.readFields(Lge,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},p)}(c,c.readVarint()+c.pos)):u===7?s.clip_paths.push(function(f,p){return f.readFields(Dge,{children:[]},p)}(c,c.readVarint()+c.pos)):u===8&&s.masks.push(function(f,p){const _=f.readFields(Rge,{left:0,width:20,mask_type:CV.MASK_TYPE_LUMINANCE,children:[]},p);return _.height==null&&(_.height=_.width),_.top==null&&(_.top=_.left),_}(c,c.readVarint()+c.pos))}function yC(u,s){return u.readFields(Tge,{},s)}function Tge(u,s,c){u===1?(s.group=function(f,p){return f.readFields(Cge,{opacity:255,children:[]},p)}(c,c.readVarint()+c.pos),s.node="group"):u===2&&(s.path=function(f,p){return f.readFields(Pge,{paint_order:1,commands:[],step:1,diffs:[],rule:DM.PATH_RULE_NON_ZERO},p)}(c,c.readVarint()+c.pos),s.node="path")}function Cge(u,s,c){u===1?s.transform=vC(c,c.readVarint()+c.pos):u===2?s.opacity=c.readVarint():u===5?s.clip_path_idx=c.readVarint():u===6?s.mask_idx=c.readVarint():u===7&&s.children.push(yC(c,c.readVarint()+c.pos))}function vC(u,s){return u.readFields(Ege,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},s)}function Ege(u,s,c){u===1?s.sx=c.readFloat():u===2?s.ky=c.readFloat():u===3?s.kx=c.readFloat():u===4?s.sy=c.readFloat():u===5?s.tx=c.readFloat():u===6&&(s.ty=c.readFloat())}function Pge(u,s,c){u===1?s.fill=function(f,p){return f.readFields(kge,{rgb_color:LM,paint:"rgb_color",opacity:255},p)}(c,c.readVarint()+c.pos):u===2?s.stroke=function(f,p){return f.readFields(Ige,{rgb_color:LM,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},p)}(c,c.readVarint()+c.pos):u===3?s.paint_order=c.readVarint():u===5?c.readPackedVarint(s.commands):u===6?s.step=c.readFloat():u===7?c.readPackedSVarint(s.diffs):u===8&&(s.rule=c.readVarint())}function kge(u,s,c){u===1?(s.rgb_color=_C(c.readVarint()),s.paint="rgb_color"):u===2?(s.linear_gradient_idx=c.readVarint(),s.paint="linear_gradient_idx"):u===3?(s.radial_gradient_idx=c.readVarint(),s.paint="radial_gradient_idx"):u===5&&(s.opacity=c.readVarint())}function _C(u){return new Ii((u>>16&255)/255,(u>>8&255)/255,(255&u)/255,1)}function Ige(u,s,c){u===1?(s.rgb_color=_C(c.readVarint()),s.paint="rgb_color"):u===2?(s.linear_gradient_idx=c.readVarint(),s.paint="linear_gradient_idx"):u===3?(s.radial_gradient_idx=c.readVarint(),s.paint="radial_gradient_idx"):u===5?c.readPackedFloat(s.dasharray):u===6?s.dashoffset=c.readFloat():u===7?s.miterlimit=c.readFloat():u===8?s.opacity=c.readVarint():u===9?s.width=c.readFloat():u===10?s.linecap=c.readVarint():u===11&&(s.linejoin=c.readVarint())}function Nge(u,s,c){u===1?s.transform=vC(c,c.readVarint()+c.pos):u===2?s.spread_method=c.readVarint():u===3?s.stops.push(kV(c,c.readVarint()+c.pos)):u===4?s.x1=c.readFloat():u===5?s.y1=c.readFloat():u===6?s.x2=c.readFloat():u===7&&(s.y2=c.readFloat())}function kV(u,s){return u.readFields(Mge,{offset:0,opacity:255,rgb_color:LM},s)}function Mge(u,s,c){u===1?s.offset=c.readFloat():u===2?s.opacity=c.readVarint():u===3&&(s.rgb_color=_C(c.readVarint()))}function Lge(u,s,c){u===1?s.transform=vC(c,c.readVarint()+c.pos):u===2?s.spread_method=c.readVarint():u===3?s.stops.push(kV(c,c.readVarint()+c.pos)):u===4?s.cx=c.readFloat():u===5?s.cy=c.readFloat():u===6?s.r=c.readFloat():u===7?s.fx=c.readFloat():u===8?s.fy=c.readFloat():u===9&&(s.fr=c.readFloat())}function Dge(u,s,c){u===1?s.transform=vC(c,c.readVarint()+c.pos):u===2?s.clip_path_idx=c.readVarint():u===3&&s.children.push(yC(c,c.readVarint()+c.pos))}function Rge(u,s,c){u===1?s.left=s.top=c.readFloat():u===2?s.width=s.height=c.readFloat():u===3?s.top=c.readFloat():u===4?s.height=c.readFloat():u===5?s.mask_type=c.readVarint():u===6?s.mask_idx=c.readVarint():u===7&&s.children.push(yC(c,c.readVarint()+c.pos))}class jge{static calculate(s={},c=[]){const f=new Map,p=new Map;if(Object.keys(s).length===0)return f;c.forEach(_=>{p.set(_.name,_.rgb_color||new Ii(0,0,0))});for(const[_,b]of Object.entries(s))p.has(_)?f.set(p.get(_).toString(),b):console.warn(`Ignoring unknown image variable "${_}"`);return f}}function x1(u,s=255,c){const f=s/255,p=u.toString(),_=c.has(p)?c.get(p).clone():u.clone();return _.a*=f,_.toString()}function H2(u,s){if(!Mf()){const c=document.createElement("canvas");return c.width=u,c.height=s,c}return new OffscreenCanvas(u,s)}function Oge(u,s){const c=jge.calculate(s.params,u.metadata?u.metadata.variables:[]),f=u.usvg_tree,p=f.width,_=f.height,b=s.transform?s.transform:new DOMMatrix,T=Math.max(1,Math.round(p*b.a)),I=Math.max(1,Math.round(_*b.d)),M=new DOMMatrix([T/p,0,0,I/_,0,0]),O=H2(T,I).getContext("2d");return jM(O,M,f,f,c),O.getImageData(0,0,T,I)}function jM(u,s,c,f,p){for(const _ of f.children)IV(u,s,c,_,p)}function IV(u,s,c,f,p){f.group?(u.save(),function(_,b,T,I,M){const O=I.mask_idx!=null?T.masks[I.mask_idx]:null,z=I.clip_path_idx!=null?T.clip_paths[I.clip_path_idx]:null;if(I.transform&&(b=b1(I.transform).preMultiplySelf(b)),!function(Y,ae,le){return Y.opacity!==255||ae||le}(I,z!=null,O!=null))return void jM(_,b,T,I,M);const q=H2(_.canvas.width,_.canvas.height),K=q.getContext("2d");jM(K,b,T,I,M),z&&OV(K,b,T,z),O&&FV(K,b,T,O,M),_.globalAlpha=I.opacity/255,_.drawImage(q,0,0)}(u,s,c,f.group,p),u.restore()):f.path&&(u.save(),function(_,b,T,I,M){_.setTransform(b),I.paint_order===vge.PAINT_ORDER_FILL_AND_STROKE?(NV(_,T,I,M),LV(_,T,I,M)):(LV(_,T,I,M),NV(_,T,I,M))}(u,s,c,f.path,p),u.restore())}function NV(u,s,c,f){const p=c.fill;if(!p)return;const _=p.opacity/255;switch(u.save(),u.beginPath(),zV(c,u),p.paint){case"rgb_color":u.fillStyle=x1(p.rgb_color,p.opacity,f);break;case"linear_gradient_idx":{const b=s.linear_gradients[p.linear_gradient_idx];b.transform&&u.setTransform(b1(b.transform).preMultiplySelf(u.getTransform())),u.fillStyle=DV(u,b,_,f);break}case"radial_gradient_idx":{const b=s.radial_gradients[p.radial_gradient_idx];b.transform&&u.setTransform(b1(b.transform).preMultiplySelf(u.getTransform())),u.fillStyle=RV(u,b,_,f)}}u.fill(MV(c)),u.restore()}function MV(u){return u.rule===DM.PATH_RULE_NON_ZERO?"nonzero":u.rule===DM.PATH_RULE_EVEN_ODD?"evenodd":void 0}function LV(u,s,c,f){const p=c.stroke;if(!p)return;const _=BV(c);u.lineWidth=p.width,u.miterLimit=p.miterlimit,u.setLineDash(p.dasharray),u.lineDashOffset=p.dashoffset;const b=p.opacity/255;switch(p.paint){case"rgb_color":u.strokeStyle=x1(p.rgb_color,p.opacity,f);break;case"linear_gradient_idx":u.strokeStyle=DV(u,s.linear_gradients[p.linear_gradient_idx],b,f,!0);break;case"radial_gradient_idx":u.strokeStyle=RV(u,s.radial_gradients[p.radial_gradient_idx],b,f,!0)}switch(p.linejoin){case gC.LINE_JOIN_MITER_CLIP:case gC.LINE_JOIN_MITER:u.lineJoin="miter";break;case gC.LINE_JOIN_ROUND:u.lineJoin="round";break;case gC.LINE_JOIN_BEVEL:u.lineJoin="bevel"}switch(p.linecap){case RM.LINE_CAP_BUTT:u.lineCap="butt";break;case RM.LINE_CAP_ROUND:u.lineCap="round";break;case RM.LINE_CAP_SQUARE:u.lineCap="square"}u.stroke(_)}function DV(u,s,c,f,p=!1){if(s.stops.length===1){const q=s.stops[0];return x1(q.rgb_color,q.opacity*c,f)}const{x1:_,y1:b,x2:T,y2:I}=s;let M=new DOMPoint(_,b),O=new DOMPoint(T,I);if(p){const q=b1(s.transform);M=q.transformPoint(M),O=q.transformPoint(O)}const z=u.createLinearGradient(M.x,M.y,O.x,O.y);for(const q of s.stops)z.addColorStop(q.offset,x1(q.rgb_color,q.opacity*c,f));return z}function RV(u,s,c,f,p=!1){if(s.stops.length===1){const ce=s.stops[0];return x1(ce.rgb_color,ce.opacity*c,f)}const _=b1(s.transform),{fx:b,fy:T,fr:I,cx:M,cy:O,r:z}=s;let q=new DOMPoint(b,T),K=new DOMPoint(M,O),Y=I,ae=z;if(p){q=_.transformPoint(q),K=_.transformPoint(K);const ce=(_.a+_.d)/2;Y=I*ce,ae=s.r*ce}const le=u.createRadialGradient(q.x,q.y,Y,K.x,K.y,ae);for(const ce of s.stops)le.addColorStop(ce.offset,x1(ce.rgb_color,ce.opacity*c,f));return le}function jV(u,s,c,f){const p=f.transform?b1(f.transform).preMultiplySelf(s):s,_=H2(u.canvas.width,u.canvas.height),b=_.getContext("2d");for(const I of f.children)if(I.group)jV(b,p,c,I.group);else if(I.path){const M=I.path,O=new Path2D;O.addPath(BV(M),p),b.fill(O,MV(M))}const T=f.clip_path_idx!=null?c.clip_paths[f.clip_path_idx]:null;T&&OV(b,p,c,T),u.globalCompositeOperation="source-over",u.drawImage(_,0,0)}function OV(u,s,c,f){const p=H2(u.canvas.width,u.canvas.height);jV(p.getContext("2d"),s,c,f),u.globalCompositeOperation="destination-in",u.drawImage(p,0,0)}function FV(u,s,c,f,p){if(f.children.length===0)return;const _=f.mask_idx!=null?c.masks[f.mask_idx]:null;_&&FV(u,s,c,_,p);const b=u.canvas.width,T=u.canvas.height,I=H2(b,T),M=I.getContext("2d"),O=f.width,z=f.height,q=f.left,K=f.top,Y=new Path2D,ae=new Path2D;ae.rect(q,K,O,z),Y.addPath(ae,s),M.clip(Y);for(const Se of f.children)IV(M,s,c,Se,p);const le=M.getImageData(0,0,b,T),ce=le.data;if(f.mask_type===CV.MASK_TYPE_LUMINANCE)for(let Se=0;Se<ce.length;Se+=4)ce[Se+3]=ce[Se+3]/255*(.2126*ce[Se]+.7152*ce[Se+1]+.0722*ce[Se+2]);M.putImageData(le,0,0),u.globalCompositeOperation="destination-in",u.drawImage(I,0,0)}function b1(u){return u?new DOMMatrix([u.sx,u.ky,u.kx,u.sy,u.tx,u.ty]):new DOMMatrix}function zV(u,s){const c=u.step;let f=u.diffs[0]*c,p=u.diffs[1]*c;s.moveTo(f,p);for(let _=0,b=2;_<u.commands.length;_++)switch(u.commands[_]){case G2.PATH_COMMAND_MOVE:f+=u.diffs[b++]*c,p+=u.diffs[b++]*c,s.moveTo(f,p);break;case G2.PATH_COMMAND_LINE:f+=u.diffs[b++]*c,p+=u.diffs[b++]*c,s.lineTo(f,p);break;case G2.PATH_COMMAND_QUAD:{const T=f+u.diffs[b++]*c,I=p+u.diffs[b++]*c;f=T+u.diffs[b++]*c,p=I+u.diffs[b++]*c,s.quadraticCurveTo(T,I,f,p);break}case G2.PATH_COMMAND_CUBIC:{const T=f+u.diffs[b++]*c,I=p+u.diffs[b++]*c,M=T+u.diffs[b++]*c,O=I+u.diffs[b++]*c;f=M+u.diffs[b++]*c,p=O+u.diffs[b++]*c,s.bezierCurveTo(T,I,M,O,f,p);break}case G2.PATH_COMMAND_CLOSE:s.closePath()}return s}function BV(u){return zV(u,new Path2D)}class xC{constructor(s){this.capacity=s,this.cache=new Map}get(s){if(!this.cache.has(s))return;const c=this.cache.get(s);return this.cache.delete(s),this.cache.set(s,c),c}put(s,c){this.cache.has(s)?this.cache.delete(s):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(s,c)}delete(s){this.cache.delete(s)}}Pn(xC,"LRUCache");class OM{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(s){return new Ll(s,s.data)}getFromCache(s,c,f){return this.cacheMap.has(f)||this.cacheMap.set(f,new xC(150)),this.cacheMap.get(f).get(nm(s.toString(),c))}setInCache(s,c,f,p){this.cacheDependenciesMap.has(p)||this.cacheDependenciesMap.set(p,new Map),this.cacheMap.has(p)||this.cacheMap.set(p,new xC(150));const _=this.cacheDependenciesMap.get(p),b=nm(s.id.toString(),f);_.get(b)||_.set(b,new Set);const T=this.cacheMap.get(p),I=s.toString();_.get(b).add(I),T.put(nm(s.toString(),f),c)}removeImagesFromCacheByIds(s,c,f=0){if(!this.cacheMap.has(f)||!this.cacheDependenciesMap.has(f))return;const p=this.cacheMap.get(f),_=this.cacheDependenciesMap.get(f);for(const b of s){const T=nm(b.toString(),c);if(_.has(T)){for(const I of _.get(T))p.delete(I);_.delete(T)}}}rasterize(s,c,f,p,_=Oge){const b=this.getFromCache(s,f,p);if(b)return b.clone();const T=_(c.icon,s.options),I=OM._getImage(T);return this.setInCache(s,I,f,p),I.clone()}}class UV{constructor(s){this.size=s,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(s,c){const f=this.toIdx(s,c);return{min:this.minimums[f],max:this.maximums[f]}}isLeaf(s,c){return this.leaves[this.toIdx(s,c)]}toIdx(s,c){return c*this.size+s}}function VV(u,s,c,f){let p=0,_=Number.MAX_VALUE;for(let b=0;b<3;b++)if(Math.abs(f[b])<1e-15){if(c[b]<u[b]||c[b]>s[b])return null}else{const T=1/f[b];let I=(u[b]-c[b])*T,M=(s[b]-c[b])*T;if(I>M){const O=I;I=M,M=O}if(I>p&&(p=I),M<_&&(_=M),p>_)return null}return p}function $V(u,s,c,f,p,_,b,T,I,M,O){const z=f-u,q=p-s,K=_-c,Y=b-u,ae=T-s,le=I-c,ce=O[1]*le-O[2]*ae,Se=O[2]*Y-O[0]*le,Ae=O[0]*ae-O[1]*Y,Ee=z*ce+q*Se+K*Ae;if(Math.abs(Ee)<1e-15)return null;const Ze=1/Ee,Ke=M[0]-u,tt=M[1]-s,at=M[2]-c,ct=(Ke*ce+tt*Se+at*Ae)*Ze;if(ct<0||ct>1)return null;const qt=tt*K-at*q,_t=at*z-Ke*K,Xt=Ke*q-tt*z,an=(O[0]*qt+O[1]*_t+O[2]*Xt)*Ze;return an<0||ct+an>1?null:(Y*qt+ae*_t+le*Xt)*Ze}function qV(u,s,c){return(u-s)/(c-s)}function GV(u,s,c,f,p,_,b,T,I){const M=1<<c,O=_-f,z=b-p,q=(u+1)/M*O+f,K=(s+0)/M*z+p,Y=(s+1)/M*z+p;T[0]=(u+0)/M*O+f,T[1]=K,I[0]=q,I[1]=Y}class HV{constructor(s){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=s,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const c=function(_){const b=Math.ceil(Math.log2(_.dim/8)),T=[];let I=Math.ceil(Math.pow(2,b));const M=1/I,O=(K,Y,ae,le,ce)=>{const Se=le?1:0,Ae=(K+1)*ae-Se,Ee=Y*ae,Ze=(Y+1)*ae-Se;ce[0]=K*ae,ce[1]=Ee,ce[2]=Ae,ce[3]=Ze};let z=new UV(I);const q=[];for(let K=0;K<I*I;K++){O(K%I,Math.floor(K/I),M,!1,q);const Y=o0(q[0],q[1],_),ae=o0(q[2],q[1],_),le=o0(q[2],q[3],_),ce=o0(q[0],q[3],_);z.minimums.push(Math.min(Y,ae,le,ce)),z.maximums.push(Math.max(Y,ae,le,ce)),z.leaves.push(1)}for(T.push(z),I/=2;I>=1;I/=2){const K=T[T.length-1];z=new UV(I);for(let Y=0;Y<I*I;Y++){O(Y%I,Math.floor(Y/I),2,!0,q);const ae=K.getElevation(q[0],q[1]),le=K.getElevation(q[2],q[1]),ce=K.getElevation(q[2],q[3]),Se=K.getElevation(q[0],q[3]),Ae=K.isLeaf(q[0],q[1]),Ee=K.isLeaf(q[2],q[1]),Ze=K.isLeaf(q[2],q[3]),Ke=K.isLeaf(q[0],q[3]),tt=Math.min(ae.min,le.min,ce.min,Se.min),at=Math.max(ae.max,le.max,ce.max,Se.max),ct=Ae&&Ee&&Ze&&Ke;z.maximums.push(at),z.minimums.push(tt),z.leaves.push(at-tt<=5&&ct?1:0)}T.push(z)}return T}(this.dem),f=c.length-1,p=c[f];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(c,0,0,f,0)}raycastRoot(s,c,f,p,_,b,T=1){return VV([s,c,-100],[f,p,this.maximums[0]*T],_,b)}raycast(s,c,f,p,_,b,T=1){if(!this.nodeCount)return null;const I=this.raycastRoot(s,c,f,p,_,b,T);if(I==null)return null;const M=[],O=[],z=[],q=[],K=[{idx:0,t:I,nodex:0,nodey:0,depth:0}];for(;K.length>0;){const{idx:Y,t:ae,nodex:le,nodey:ce,depth:Se}=K.pop();if(this.leaves[Y]){GV(le,ce,Se,s,c,f,p,z,q);const Ee=1<<Se,Ze=(le+0)/Ee,Ke=(le+1)/Ee,tt=(ce+0)/Ee,at=(ce+1)/Ee,ct=o0(Ze,tt,this.dem)*T,qt=o0(Ke,tt,this.dem)*T,_t=o0(Ke,at,this.dem)*T,Xt=o0(Ze,at,this.dem)*T,an=$V(z[0],z[1],ct,q[0],z[1],qt,q[0],q[1],_t,_,b),Jt=$V(q[0],q[1],_t,z[0],q[1],Xt,z[0],z[1],ct,_,b),en=Math.min(an!==null?an:Number.MAX_VALUE,Jt!==null?Jt:Number.MAX_VALUE);if(en!==Number.MAX_VALUE)return en;{const hn=me([],_,b,ae);if(WV(ct,qt,Xt,_t,qV(hn[0],z[0],q[0]),qV(hn[1],z[1],q[1]))>=hn[2])return ae}continue}let Ae=0;for(let Ee=0;Ee<this._siblingOffset.length;Ee++){GV((le<<1)+this._siblingOffset[Ee][0],(ce<<1)+this._siblingOffset[Ee][1],Se+1,s,c,f,p,z,q),z[2]=-100,q[2]=this.maximums[this.childOffsets[Y]+Ee]*T;const Ze=VV(z,q,_,b);if(Ze!=null){const Ke=Ze;M[Ee]=Ke;let tt=!1;for(let at=0;at<Ae&&!tt;at++)Ke>=M[O[at]]&&(O.splice(at,0,Ee),tt=!0);tt||(O[Ae]=Ee),Ae++}}for(let Ee=0;Ee<Ae;Ee++){const Ze=O[Ee];K.push({idx:this.childOffsets[Y]+Ze,t:M[Ze],nodex:(le<<1)+this._siblingOffset[Ze][0],nodey:(ce<<1)+this._siblingOffset[Ze][1],depth:Se+1})}}return null}_addNode(s,c,f){return this.minimums.push(s),this.maximums.push(c),this.leaves.push(f),this.childOffsets.push(0),this.nodeCount++}_construct(s,c,f,p,_){if(s[p].isLeaf(c,f)===1)return;this.childOffsets[_]||(this.childOffsets[_]=this.nodeCount);const b=p-1,T=s[b];let I=0,M=0;for(let O=0;O<this._siblingOffset.length;O++){const z=2*c+this._siblingOffset[O][0],q=2*f+this._siblingOffset[O][1],K=T.getElevation(z,q),Y=T.isLeaf(z,q),ae=this._addNode(K.min,K.max,Y);Y&&(I|=1<<O),M||(M=ae)}for(let O=0;O<this._siblingOffset.length;O++)I&1<<O||this._construct(s,2*c+this._siblingOffset[O][0],2*f+this._siblingOffset[O][1],b,M+O)}}function WV(u,s,c,f,p,_){return qe(qe(u,c,_),qe(s,f,_),p)}function o0(u,s,c){const f=c.dim,p=We(u*f-.5,0,f-1),_=We(s*f-.5,0,f-1),b=Math.floor(p),T=Math.floor(_),I=Math.min(b+1,f-1),M=Math.min(T+1,f-1);return WV(c.get(b,T),c.get(I,T),c.get(b,M),c.get(I,M),p-b,_-T)}const Fge={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function zge(u,s,c){return(256*u*256+256*s+c)/10-1e4}function Bge(u,s,c){return 256*u+s+c/256-32768}class bC{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(s,c,f,p=!1){if(this.uid=s,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(f&&f!=="mapbox"&&f!=="terrarium")return void ai(`"${f}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const _=this.dim=c.height-2,b=new Uint32Array(c.data.buffer);if(this.pixels=new Uint8Array(c.data.buffer),this.floatView=new Float32Array(c.data.buffer),this.borderReady=p,this._modifiedForSources={},!p){for(let I=0;I<_;I++)b[this._idx(-1,I)]=b[this._idx(0,I)],b[this._idx(_,I)]=b[this._idx(_-1,I)],b[this._idx(I,-1)]=b[this._idx(I,0)],b[this._idx(I,_)]=b[this._idx(I,_-1)];b[this._idx(-1,-1)]=b[this._idx(0,0)],b[this._idx(_,-1)]=b[this._idx(_-1,0)],b[this._idx(-1,_)]=b[this._idx(0,_-1)],b[this._idx(_,_)]=b[this._idx(_-1,_-1)]}const T=f==="terrarium"?Bge:zge;for(let I=0;I<b.length;++I){const M=4*I;this.floatView[I]=T(this.pixels[M],this.pixels[M+1],this.pixels[M+2])}this._timestamp=Yc.now()}_buildQuadTree(){this._tree=new HV(this)}get(s,c,f=!1){f&&(s=We(s,-1,this.dim),c=We(c,-1,this.dim));const p=this._idx(s,c);return this.floatView[p]}set(s,c,f){const p=this._idx(s,c),_=this.floatView[p];return this.floatView[p]=f,f-_}static getUnpackVector(s){return Fge[s]}_idx(s,c){if(s<-1||s>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(s+1)}static pack(s,c){const f=[0,0,0,0],p=bC.getUnpackVector(c);let _=Math.floor((s+p[3])/p[2]);return f[2]=_%256,_=Math.floor(_/256),f[1]=_%256,_=Math.floor(_/256),f[0]=_,f}getPixels(){return new B8({width:this.stride,height:this.stride},this.pixels)}backfillBorder(s,c,f){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let p=c*this.dim,_=c*this.dim+this.dim,b=f*this.dim,T=f*this.dim+this.dim;switch(c){case-1:p=_-1;break;case 1:_=p+1}switch(f){case-1:b=T-1;break;case 1:T=b+1}const I=-c*this.dim,M=-f*this.dim;for(let O=b;O<T;O++)for(let z=p;z<_;z++){const q=4*this._idx(z,O),K=4*this._idx(z+I,O+M);this.pixels[q+0]=s.pixels[K+0],this.pixels[q+1]=s.pixels[K+1],this.pixels[q+2]=s.pixels[K+2],this.pixels[q+3]=s.pixels[K+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function Uge(u,s,c){u===1?s.headerLength=c.readFixed32():u===2?s.x=c.readVarint():u===3?s.y=c.readVarint():u===4?s.z=c.readVarint():u===5&&s.layers.push(function(f,p){return f.readFields(Hge,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},p)}(c,c.readVarint()+c.pos))}function Vge(u,s,c){u===1?(s.delta_filter=function(f,p){return f.readFields($ge,{blockSize:0},p)}(c,c.readVarint()+c.pos),s.filter="delta_filter"):u===2?(c.readVarint(),s.filter="zigzag_filter"):u===3?(c.readVarint(),s.filter="bitshuffle_filter"):u===4&&(c.readVarint(),s.filter="byteshuffle_filter")}function $ge(u,s,c){u===1&&(s.blockSize=c.readVarint())}function qge(u,s,c){u===1?(c.readVarint(),s.codec="gzip_data"):u===2?(c.readVarint(),s.codec="jpeg_image"):u===3?(c.readVarint(),s.codec="webp_image"):u===4&&(c.readVarint(),s.codec="png_image")}function Gge(u,s,c){let f=0,p=0;u===1?s.firstByte=c.readFixed64():u===2?s.lastByte=c.readFixed64():u===3?s.filters.push(function(_,b){return _.readFields(Vge,{},b)}(c,c.readVarint()+c.pos)):u===4?s.codec=function(_,b){return _.readFields(qge,{},b)}(c,c.readVarint()+c.pos):u===5?p=c.readFloat():u===6?f=c.readFloat():u===7?s.bands.push(c.readString()):u===8?s.offset=c.readDouble():u===9&&(s.scale=c.readDouble()),s.offset===0&&(s.offset=p),s.scale===0&&(s.scale=f)}function Hge(u,s,c){u===1?s.version=c.readVarint():u===2?s.name=c.readString():u===3?s.units=c.readString():u===4?s.tileSize=c.readVarint():u===5?s.buffer=c.readVarint():u===6?s.pixelFormat=c.readVarint():u===7&&s.dataIndex.push(function(f,p){return f.readFields(Gge,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},p)}(c,c.readVarint()+c.pos))}function Wge(u,s,c){if(u===2)(function(f,p,_){f.readFields(Zge,_,p)})(c,c.readVarint()+c.pos,s);else if(u===3)throw new Error("Not implemented")}function Zge(u,s,c){if(u===1){let f=0;const p=c.readVarint()+c.pos;for(;c.pos<p;)s[f++]=c.readVarint()}}function Kge(u,s){if(s.length!==4)throw new Error(`Expected data of dimension 4 but got ${s.length}.`);let c=s[3];for(let f=2;f>=1;f--){const p=f===1?1:0,_=f===2?1:0;for(let b=0;b<s[0];b++){const T=s[1]*b;for(let I=p;I<s[1];I++){const M=s[2]*(I+T);for(let O=_;O<s[2];O++){const z=s[3]*(O+M);for(let q=0;q<s[3];q++){const K=z+q;u[K]+=u[K-c]}}}}c*=s[f]}return u}function Yge(u){for(let s=0,c=u.length;s<c;s++)u[s]=u[s]>>>1^-(1&u[s]);return u}function Xge(u,s){switch(s){case"uint32":return u;case"uint16":for(let c=0;c<u.length;c+=2){const f=u[c],p=u[c+1];u[c]=(240&f)>>4|(61440&f)>>8|(240&p)<<4|61440&p,u[c+1]=15&f|(3840&f)>>4|(15&p)<<8|(3840&p)<<4}return u;case"uint8":for(let c=0;c<u.length;c+=4){const f=u[c],p=u[c+1],_=u[c+2],b=u[c+3];u[c+0]=(192&f)>>6|(192&p)>>4|(192&_)>>2|192&b,u[c+1]=(48&f)>>4|(48&p)>>2|48&_|(48&b)<<2,u[c+2]=(12&f)>>2|12&p|(12&_)<<2|(12&b)<<4,u[c+3]=3&f|(3&p)<<2|(3&_)<<4|(3&b)<<6}return u;default:throw new Error(`Invalid pixel format, "${s}"`)}}Pn(bC,"DEMData"),Pn(HV,"DemMinMaxQuadTree",{omit:["dem"]});var uh=Uint8Array,W2=Uint16Array,Jge=Int32Array,ZV=new uh([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),KV=new uh([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Qge=new uh([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),YV=function(u,s){for(var c=new W2(31),f=0;f<31;++f)c[f]=s+=1<<u[f-1];var p=new Jge(c[30]);for(f=1;f<30;++f)for(var _=c[f];_<c[f+1];++_)p[_]=_-c[f]<<5|f;return{b:c,r:p}},XV=YV(ZV,2),JV=XV.b,eye=XV.r;JV[28]=258,eye[258]=28;for(var tye=YV(KV,0).b,QV=new W2(32768),_o=0;_o<32768;++_o){var w1=(43690&_o)>>1|(21845&_o)<<1;QV[_o]=((65280&(w1=(61680&(w1=(52428&w1)>>2|(13107&w1)<<2))>>4|(3855&w1)<<4))>>8|(255&w1)<<8)>>1}var Z2=function(u,s,c){for(var f=u.length,p=0,_=new W2(s);p<f;++p)u[p]&&++_[u[p]-1];var b,T=new W2(s);for(p=1;p<s;++p)T[p]=T[p-1]+_[p-1]<<1;b=new W2(1<<s);var I=15-s;for(p=0;p<f;++p)if(u[p])for(var M=p<<4|u[p],O=s-u[p],z=T[u[p]-1]++<<O,q=z|(1<<O)-1;z<=q;++z)b[QV[z]>>I]=M;return b},K2=new uh(288);for(_o=0;_o<144;++_o)K2[_o]=8;for(_o=144;_o<256;++_o)K2[_o]=9;for(_o=256;_o<280;++_o)K2[_o]=7;for(_o=280;_o<288;++_o)K2[_o]=8;var e$=new uh(32);for(_o=0;_o<32;++_o)e$[_o]=5;var nye=Z2(K2,9),rye=Z2(e$,5),FM=function(u){for(var s=u[0],c=1;c<u.length;++c)u[c]>s&&(s=u[c]);return s},np=function(u,s,c){var f=s/8|0;return(u[f]|u[f+1]<<8)>>(7&s)&c},zM=function(u,s){var c=s/8|0;return(u[c]|u[c+1]<<8|u[c+2]<<16)>>(7&s)},iye=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],rp=function(u,s,c){var f=new Error(s||iye[u]);if(f.code=u,Error.captureStackTrace&&Error.captureStackTrace(f,rp),!c)throw f;return f},sye=new uh(0),aye=typeof TextDecoder<"u"&&new TextDecoder;try{aye.decode(sye,{stream:!0})}catch{}const oye={gzip_data:"gzip"};class ef extends Error{constructor(s){super(s),this.name="MRTError"}}const lye={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},t$={uint32:1,uint16:2,uint8:4},cye={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let BM;class wC{constructor(s=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=s}getLayer(s){const c=this.layers[s];if(!c)throw new ef(`Layer '${s}' not found`);return c}getHeaderLength(s){const c=new Uint8Array(s),f=new DataView(s);if(c[0]!==13)throw new ef("File is not a valid MRT.");return f.getUint32(1,!0)}parseHeader(s){const c=new Uint8Array(s),f=this.getHeaderLength(s);if(c.length<f)throw new ef(`Expected header with length >= ${f} but got buffer of length ${c.length}`);const p=new BM(c.subarray(0,f)).readFields(Uge,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0);if(!isNaN(this.x)&&(this.x!==p.x||this.y!==p.y||this.z!==p.z))throw new ef(`Invalid attempt to parse header ${p.z}/${p.x}/${p.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=p.x,this.y=p.y,this.z=p.z;for(const _ of p.layers)this.layers[_.name]=new n$(_,{cacheSize:this._cacheSize});return this}createDecodingTask(s){const c=[],f=this.getLayer(s.layerName);for(let p of s.blockIndices){const _=f.dataIndex[p],b=_.firstByte-s.firstByte,T=_.lastByte-s.firstByte;if(f._blocksInProgress.has(p))continue;const I={layerName:f.name,firstByte:b,lastByte:T,pixelFormat:f.pixelFormat,blockIndex:p,blockShape:[_.bands.length].concat(f.bandShape),buffer:f.buffer,codec:_.codec.codec,filters:_.filters.map(M=>M.filter)};f._blocksInProgress.add(p),c.push(I)}return new r$(c,()=>{c.forEach(p=>f._blocksInProgress.delete(p.blockIndex))},(p,_)=>{if(c.forEach(b=>f._blocksInProgress.delete(b.blockIndex)),p)throw p;_.forEach(b=>{this.getLayer(b.layerName).processDecodedData(b)})})}}class n${constructor({version:s,name:c,units:f,tileSize:p,pixelFormat:_,buffer:b,dataIndex:T},I){if(this.version=s,this.version!==1)throw new ef(`Cannot parse raster layer encoded with MRT version ${s}`);this.name=c,this.units=f,this.tileSize=p,this.buffer=b,this.pixelFormat=lye[_],this.dataIndex=T,this.bandShape=[p+2*b,p+2*b,t$[this.pixelFormat]],this._decodedBlocks=new xC(I?I.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return t$[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:s})=>s).flat()}processDecodedData(s){const c=s.blockIndex.toString();this._decodedBlocks.get(c)||this._decodedBlocks.put(c,s.data)}getBlockForBand(s){let c=0;switch(typeof s){case"string":for(const[f,p]of this.dataIndex.entries()){for(const[_,b]of p.bands.entries())if(b===s)return{bandIndex:c+_,blockIndex:f,blockBandIndex:_};c+=p.bands.length}break;case"number":for(const[f,p]of this.dataIndex.entries()){if(s>=c&&s<c+p.bands.length)return{bandIndex:s,blockIndex:f,blockBandIndex:s-c};c+=p.bands.length}break;default:throw new ef(`Invalid band \`${JSON.stringify(s)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(s){let c=1/0,f=-1/0;const p=[],_=new Set;for(const b of s){const{blockIndex:T}=this.getBlockForBand(b);if(T<0)throw new ef(`Invalid band: ${JSON.stringify(b)}`);const I=this.dataIndex[T];p.includes(T)||p.push(T),_.add(T),c=Math.min(c,I.firstByte),f=Math.max(f,I.lastByte)}if(_.size>this.cacheSize)throw new ef(`Number of blocks to decode (${_.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:c,lastByte:f,blockIndices:p}}hasBand(s){const{blockIndex:c}=this.getBlockForBand(s);return c>=0}hasDataForBand(s){const{blockIndex:c}=this.getBlockForBand(s);return c>=0&&!!this._decodedBlocks.get(c.toString())}getBandView(s){const{blockIndex:c,blockBandIndex:f}=this.getBlockForBand(s);if(c<0)throw new ef(`Band not found: ${JSON.stringify(s)}`);const p=this._decodedBlocks.get(c.toString());if(!p)throw new ef(`Data for band ${JSON.stringify(s)} of layer "${this.name}" not decoded.`);const _=this.dataIndex[c],b=this.bandShape.reduce((M,O)=>M*O,1),T=f*b,I=p.subarray(T,T+b);return{data:I,bytes:new Uint8Array(I.buffer).subarray(I.byteOffset,I.byteOffset+I.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:_.offset,scale:_.scale}}}wC.setPbf=function(u){BM=u};class r${constructor(s,c,f){this.tasks=s,this._onCancel=c,this._onComplete=f,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(s,c){this._finalized||(this._onComplete(s,c),this._finalized=!0)}}wC.performDecoding=function(u,s){const c=new Uint8Array(u);return Promise.all(s.tasks.map(f=>{const{layerName:p,firstByte:_,lastByte:b,pixelFormat:T,blockShape:I,blockIndex:M,filters:O,codec:z}=f,q=c.subarray(_,b+1),K=new Uint32Array(I[0]*I[1]*I[2]);let Y;if(z!=="gzip_data")throw new ef(`Unhandled codec: ${z}`);return Y=function(ae,le){if(!globalThis.DecompressionStream&&le==="gzip_data")return Promise.resolve(((Ee=function(tt){tt[0]==31&&tt[1]==139&&tt[2]==8||rp(6,"invalid gzip data");var at=tt[3],ct=10;4&at&&(ct+=2+(tt[10]|tt[11]<<8));for(var qt=(at>>3&1)+(at>>4&1);qt>0;qt-=!tt[ct++]);return ct+(2&at)}(Ae=ae))+8>Ae.length&&rp(6,"invalid gzip data"),function(tt,at,ct,qt){var _t=tt.length;if(!_t||at.f&&!at.l)return ct||new uh(0);var Xt=!ct,an=Xt||at.i!=2,Jt=at.i;Xt&&(ct=new uh(3*_t));var en,hn,Vt=function(Es){var Ps=ct.length;if(Es>Ps){var gs=new uh(Math.max(2*Ps,Es));gs.set(ct),ct=gs}},nn=at.f||0,Lt=at.p||0,It=at.b||0,fn=at.l,cn=at.d,tr=at.m,Fn=at.n,qn=8*_t;do{if(!fn){nn=np(tt,Lt,1);var vn=np(tt,Lt+1,3);if(Lt+=3,!vn){var er=tt[(Me=4+((Lt+7)/8|0))-4]|tt[Me-3]<<8,Ir=Me+er;if(Ir>_t){Jt&&rp(0);break}an&&Vt(It+er),ct.set(tt.subarray(Me,Ir),It),at.b=It+=er,at.p=Lt=8*Ir,at.f=nn;continue}if(vn==1)fn=nye,cn=rye,tr=9,Fn=5;else if(vn==2){var En=np(tt,Lt,31)+257,Yn=np(tt,Lt+10,15)+4,pr=En+np(tt,Lt+5,31)+1;Lt+=14;for(var Lr=new uh(pr),ii=new uh(19),zr=0;zr<Yn;++zr)ii[Qge[zr]]=np(tt,Lt+3*zr,7);Lt+=3*Yn;var Bn=FM(ii),jr=(1<<Bn)-1,ki=Z2(ii,Bn);for(zr=0;zr<pr;){var Me,Le=ki[np(tt,Lt,jr)];if(Lt+=15&Le,(Me=Le>>4)<16)Lr[zr++]=Me;else{var Mt=0,$t=0;for(Me==16?($t=3+np(tt,Lt,3),Lt+=2,Mt=Lr[zr-1]):Me==17?($t=3+np(tt,Lt,7),Lt+=3):Me==18&&($t=11+np(tt,Lt,127),Lt+=7);$t--;)Lr[zr++]=Mt}}var Tn=Lr.subarray(0,En),An=Lr.subarray(En);tr=FM(Tn),Fn=FM(An),fn=Z2(Tn,tr),cn=Z2(An,Fn)}else rp(1);if(Lt>qn){Jt&&rp(0);break}}an&&Vt(It+131072);for(var zn=(1<<tr)-1,or=(1<<Fn)-1,si=Lt;;si=Lt){var oi=(Mt=fn[zM(tt,Lt)&zn])>>4;if((Lt+=15&Mt)>qn){Jt&&rp(0);break}if(Mt||rp(2),oi<256)ct[It++]=oi;else{if(oi==256){si=Lt,fn=null;break}var Jr=oi-254;oi>264&&(Jr=np(tt,Lt,(1<<(Kr=ZV[zr=oi-257]))-1)+JV[zr],Lt+=Kr);var Xi=cn[zM(tt,Lt)&or],qs=Xi>>4;if(Xi||rp(3),Lt+=15&Xi,An=tye[qs],qs>3){var Kr=KV[qs];An+=zM(tt,Lt)&(1<<Kr)-1,Lt+=Kr}if(Lt>qn){Jt&&rp(0);break}an&&Vt(It+131072);var Ss=It+Jr;if(It<An){var ns=0-An,Oi=Math.min(An,Ss);for(ns+It<0&&rp(3);It<Oi;++It)ct[It]=(void 0)[ns+It]}for(;It<Ss;++It)ct[It]=ct[It-An]}}at.l=fn,at.p=si,at.b=It,at.f=nn,fn&&(nn=1,at.m=tr,at.d=cn,at.n=Fn)}while(!nn);return It!=ct.length&&Xt?(en=ct,((hn=It)==null||hn>en.length)&&(hn=en.length),new uh(en.subarray(0,hn))):ct.subarray(0,It)}(Ae.subarray(Ee,-8),{i:2},new uh(((ce=Ae)[(Se=ce.length)-4]|ce[Se-3]<<8|ce[Se-2]<<16|ce[Se-1]<<24)>>>0))));var ce,Se,Ae,Ee;const Ze=oye[le];if(!Ze)throw new Error(`Unhandled codec: ${le}`);const Ke=new globalThis.DecompressionStream(Ze);return new Response(new Blob([ae]).stream().pipeThrough(Ke)).arrayBuffer().then(tt=>new Uint8Array(tt))}(q,z).then(ae=>(function(le,ce){le.readFields(Wge,ce)}(new BM(ae),K),new cye[T](K.buffer))),Y.then(ae=>{for(let le=O.length-1;le>=0;le--)switch(O[le]){case"delta_filter":Kge(ae,I);break;case"zigzag_filter":Yge(ae);break;case"bitshuffle_filter":Xge(ae,T);break;default:throw new ef(`Unhandled filter "${O[le]}"`)}return{layerName:p,blockIndex:M,data:ae}}).catch(ae=>{throw ae})}))},Pn(r$,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),Pn(wC,"MapboxRasterTile"),Pn(n$,"MapboxRasterLayer",{omit:["_blocksInProgress"]});class i${constructor(s){this._stringToNumber={},this._numberToString=[];for(let c=0;c<s.length;c++){const f=s[c];this._stringToNumber[f]=c,this._numberToString[c]=f}}encode(s){return this._stringToNumber[s]}decode(s){return this._numberToString[s]}}const uye=["id","tile","layer","source","sourceLayer","state"];class S1{constructor(s,c,f,p,_){this.type="Feature",this._vectorTileFeature=s,this._z=c,this._x=f,this._y=p,this.properties=s.properties,this.id=_}clone(){const s=new S1(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(s.state=Object.assign({},this.state)),this.layer&&(s.layer=Object.assign({},this.layer)),this.source&&(s.source=this.source),this.sourceLayer&&(s.sourceLayer=this.sourceLayer),s}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const c of uye)this[c]!==void 0&&(s[c]=this[c]);return s}}class s${constructor(s,c){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Us(yn,16,0),this.featureIndexArray=new ST,this.promoteId=c,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(s,c,f,p,_,b=0,T=0){const I=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,p,_,b);const M=this.grid;for(let O=0;O<c.length;O++){const z=c[O],q=[1/0,1/0,-1/0,-1/0];for(let K=0;K<z.length;K++){const Y=z[K];q[0]=Math.min(q[0],Y.x),q[1]=Math.min(q[1],Y.y),q[2]=Math.max(q[2],Y.x),q[3]=Math.max(q[3],Y.y)}T!==0&&(q[0]-=T,q[1]-=T,q[2]+=T,q[3]+=T),q[0]<yn&&q[1]<yn&&q[2]>=0&&q[3]>=0&&M.insert(I,q[0],q[1],q[2],q[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Er(new YT(this.rawTileData)).layers,this.sourceLayerCoder=new i$(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const s in this.vtLayers)this.vtFeatures[s]=[]}return this.vtLayers}query(s,c){const{tilespaceGeometry:f,transform:p,tileTransform:_,pixelPosMatrix:b,availableImages:T,worldview:I}=c;this.loadVTLayers(),this.serializedLayersCache.clear();const M=f.bufferedTilespaceBounds,O=this.grid.query(M.min.x,M.min.y,M.max.x,M.max.y,(Y,ae,le,ce)=>Ma(f.bufferedTilespaceGeometry,Y,ae,le,ce));O.sort(dye);let z=null;p.elevation&&O.length>0&&(z=_1.create(p.elevation,this.tileID));const q={};let K;for(let Y=0;Y<O.length;Y++){const ae=O[Y];if(ae===K)continue;K=ae;const le=this.featureIndexArray.get(ae);let ce=null;this.is3DTile?this.loadMatchingModelFeature(q,le,s,f,p,I):this.loadMatchingFeature(q,le,s,T,I,(Se,Ae,Ee,Ze=0)=>(ce||(ce=Nn(Se,this.tileID.canonical,_)),Ae.queryIntersectsFeature(f,Se,Ee,ce,this.z,p,b,z,Ze)))}return q}loadMatchingFeature(s,c,f,p,_,b){const{featureIndex:T,bucketIndex:I,sourceLayerIndex:M,layoutVertexArrayOffset:O}=c,z=this.bucketLayerIDs[I],q=f.layers,K=Object.keys(q);if(K.length&&!pi(K,z))return;const Y=f.sourceCache,ae=this.sourceLayerCoder.decode(M),le=this.vtLayers[ae].feature(T),ce=this.getId(le,ae);for(let Se=0;Se<z.length;Se++){const Ae=z[Se];if(!q[Ae])continue;const{styleLayer:Ee,targets:Ze}=q[Ae];let Ke={};ce!==void 0&&(Ke=Y.getFeatureState(Ee.sourceLayer,ce));const tt=!b||b(le,Ee,Ke,O);if(!tt)continue;const at=new S1(le,this.z,this.x,this.y,ce);at.tile=this.tileID.canonical,at.state=Ke;let ct=this.serializedLayersCache.get(Ae);ct||(ct=Ee.serialize(),ct.id=Ae,this.serializedLayersCache.set(Ae,ct)),at.source=ct.source,at.sourceLayer=ct["source-layer"],at.layer=Object.assign({},ct),at.layer.paint=a$(ct.paint,Ee.paint,le,Ke,p),at.layer.layout=a$(ct.layout,Ee.layout,le,Ke,p);let qt=!1;for(const _t of Ze){this.updateFeatureProperties(at,_t);const{filter:Xt}=_t;if(Xt){if(le.properties=at.properties,Xt.needGeometry){const an=dn(le,!0);if(!Xt.filter(new hs(this.tileID.overscaledZ,{worldview:_}),an,this.tileID.canonical))continue}else if(!Xt.filter(new hs(this.tileID.overscaledZ,{worldview:_}),le))continue}qt=!0,_t.targetId&&this.addFeatureVariant(at,_t)}qt&&this.appendToResult(s,Ae,T,at,tt)}}loadMatchingModelFeature(s,c,f,p,_,b){const{featureIndex:T,bucketIndex:I}=c,M=this.bucketLayerIDs[I],O=f.layers,z=Object.keys(O);if(!z.length||pi(z,M))for(let q=0;q<M.length;q++){const K=M[q],{styleLayer:Y,targets:ae}=O[K];if(Y.type!=="model")continue;const le=p.tile,ce=le.getBucket(Y);if(!(ce&&ce instanceof mC))continue;const Se=gge(ce,T,p,_);if(!Se)continue;const{z:Ae,x:Ee,y:Ze}=le.tileID.canonical,{feature:Ke,intersectionZ:tt,position:at}=Se;let ct={};Ke.id!==void 0&&(ct=f.sourceCache.getFeatureState(Y.sourceLayer,Ke.id));const qt=new S1({},Ae,Ee,Ze,Ke.id);qt.tile=this.tileID.canonical,qt.state=ct,qt.properties=Ke.properties,qt.geometry={type:"Point",coordinates:[at.lng,at.lat]};let _t=this.serializedLayersCache.get(K);_t||(_t=Y.serialize(),_t.id=K,this.serializedLayersCache.set(K,_t)),qt.source=_t.source,qt.sourceLayer=_t["source-layer"],qt.layer=Object.assign({},_t);let Xt=!1;for(const an of ae){this.updateFeatureProperties(qt,an);const{filter:Jt}=an;if(Jt){if(Ke.properties=qt.properties,Jt.needGeometry){if(!Jt.filter(new hs(this.tileID.overscaledZ,{worldview:b}),Ke,this.tileID.canonical))continue}else if(!Jt.filter(new hs(this.tileID.overscaledZ,{worldview:b}),Ke))continue}Xt=!0,an.targetId&&this.addFeatureVariant(qt,an)}Xt&&this.appendToResult(s,K,T,qt,tt)}}updateFeatureProperties(s,c,f){if(c.properties){const p={};for(const _ in c.properties){const b=c.properties[_].evaluate({zoom:this.z},s._vectorTileFeature,s.state,s.tile,f);b!=null&&(p[_]=b)}s.properties=p}}addFeatureVariant(s,c,f){const p={target:c.target,namespace:c.namespace,uniqueFeatureID:c.uniqueFeatureID};c.properties&&(p.properties=s.properties),s.variants=s.variants||{},s.variants[c.targetId]=s.variants[c.targetId]||[],s.variants[c.targetId].push(p)}appendToResult(s,c,f,p,_){let b=s[c];b===void 0&&(b=s[c]=[]),b.push({featureIndex:f,feature:p,intersectionZ:_})}lookupSymbolFeatures(s,c,f,p,_,b){const T={};this.loadVTLayers();for(const I of s)this.loadMatchingFeature(T,{bucketIndex:c,sourceLayerIndex:f,featureIndex:I,layoutVertexArrayOffset:0},p,_,b);return T}loadFeature(s){const{featureIndex:c,sourceLayerIndex:f}=s;this.loadVTLayers();const p=this.sourceLayerCoder.decode(f),_=this.vtFeatures[p];if(_[c])return _[c];const b=this.vtLayers[p].feature(c);return _[c]=b,b}hasLayer(s){for(const c of this.bucketLayerIDs)for(const f of c)if(s===f)return!0;return!1}getId(s,c){let f=s.id;if(this.promoteId){const p=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[c];if(p!=null)if(Array.isArray(p)){if(!this.promoteIdExpression){const _=pa(p);if(_.result!=="success"){const b=_.value.map(T=>`${T.key}: ${T.message}`).join(", ");return void ai(`Failed to create expression for promoteId: ${b}`)}this.promoteIdExpression=_.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new Mc),f=this.promoteIdExpression.evaluate({zoom:0},s)}else f=s.properties[p];typeof f=="boolean"&&(f=Number(f))}return f}}function a$(u,s,c,f,p){return vr(u,(_,b)=>{const T=s instanceof Zh?s.get(b):null;return T&&T.evaluate?T.evaluate(c,f,void 0,p):T})}function dye(u,s){return s-u}Pn(s$,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const o$=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class UM{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,f]=new Uint8Array(s,0,2);if(c!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=f>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const _=o$[15&f];if(!_)throw new Error("Unrecognized array type.");const[b]=new Uint16Array(s,2,1),[T]=new Uint32Array(s,4,1);return new UM(T,b,_,s)}constructor(s,c=64,f=Float64Array,p){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=f,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const _=o$.indexOf(this.ArrayType),b=2*s*this.ArrayType.BYTES_PER_ELEMENT,T=s*this.IndexArrayType.BYTES_PER_ELEMENT,I=(8-T%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${f}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+T+I,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+b+T+I),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+T+I,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=s)}add(s,c){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=s,this.coords[this._pos++]=c,f}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return VM(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,c,f,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:b,nodeSize:T}=this,I=[0,_.length-1,0],M=[];for(;I.length;){const O=I.pop()||0,z=I.pop()||0,q=I.pop()||0;if(z-q<=T){for(let le=q;le<=z;le++){const ce=b[2*le],Se=b[2*le+1];ce>=s&&ce<=f&&Se>=c&&Se<=p&&M.push(_[le])}continue}const K=q+z>>1,Y=b[2*K],ae=b[2*K+1];Y>=s&&Y<=f&&ae>=c&&ae<=p&&M.push(_[K]),(O===0?s<=Y:c<=ae)&&(I.push(q),I.push(K-1),I.push(1-O)),(O===0?f>=Y:p>=ae)&&(I.push(K+1),I.push(z),I.push(1-O))}return M}within(s,c,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:_,nodeSize:b}=this,T=[0,p.length-1,0],I=[],M=f*f;for(;T.length;){const O=T.pop()||0,z=T.pop()||0,q=T.pop()||0;if(z-q<=b){for(let le=q;le<=z;le++)c$(_[2*le],_[2*le+1],s,c)<=M&&I.push(p[le]);continue}const K=q+z>>1,Y=_[2*K],ae=_[2*K+1];c$(Y,ae,s,c)<=M&&I.push(p[K]),(O===0?s-f<=Y:c-f<=ae)&&(T.push(q),T.push(K-1),T.push(1-O)),(O===0?s+f>=Y:c+f>=ae)&&(T.push(K+1),T.push(z),T.push(1-O))}return I}}function VM(u,s,c,f,p,_){if(p-f<=c)return;const b=f+p>>1;l$(u,s,b,f,p,_),VM(u,s,c,f,b-1,1-_),VM(u,s,c,b+1,p,1-_)}function l$(u,s,c,f,p,_){for(;p>f;){if(p-f>600){const M=p-f+1,O=c-f+1,z=Math.log(M),q=.5*Math.exp(2*z/3),K=.5*Math.sqrt(z*q*(M-q)/M)*(O-M/2<0?-1:1);l$(u,s,c,Math.max(f,Math.floor(c-O*q/M+K)),Math.min(p,Math.floor(c+(M-O)*q/M+K)),_)}const b=s[2*c+_];let T=f,I=p;for(Y2(u,s,f,c),s[2*p+_]>b&&Y2(u,s,f,p);T<I;){for(Y2(u,s,T,I),T++,I--;s[2*T+_]<b;)T++;for(;s[2*I+_]>b;)I--}s[2*f+_]===b?Y2(u,s,f,I):(I++,Y2(u,s,I,p)),I<=c&&(f=I+1),c<=I&&(p=I-1)}}function Y2(u,s,c,f){$M(u,c,f),$M(s,2*c,2*f),$M(s,2*c+1,2*f+1)}function $M(u,s,c){const f=u[s];u[s]=u[c],u[c]=f}function c$(u,s,c,f){const p=u-c,_=s-f;return p*p+_*_}i.$=ql,i.A=Ta,i.B=nm,i.C=2,i.D=c1,i.E=gd,i.F=j2,i.G=DU,i.H=xd,i.I=ho,i.J=pg,i.K=hr,i.L=dl,i.M=ti,i.N=ps,i.O=Zi,i.P=zt,i.Q=hl,i.R=jp,i.S=ou,i.T=nM,i.U=pa,i.V=pC,i.W=za,i.X=Hp,i.Y=Gp,i.Z=jy,i._=po,i.a=function(u){return $o.API_CDN_URL_REGEX.test(u)},i.a$=ze,i.a0=Ru,i.a1=zp,i.a2=qy,i.a3=class extends pC{},i.a4=_r,i.a5=mo,i.a6=yt,i.a7=function(u){const s=u.value;return s?Ru(s)?IM(s,!0)?[]:[new pC(u.key,s,`invalid url "${s}"`)]:[new pC(u.key,s,`string expected, "${hr(s)}" found`)]:[]},i.a8=Vy,i.a9=Zs,i.aA=We,i.aB=F,i.aC=wt,i.aD=m,i.aE=Lo,i.aF=ke,i.aG=St,i.aH=function(u,s){const c={};for(let f=0;f<s.length;f++){const p=s[f];p in u&&(c[p]=u[p])}return c},i.aI=ve,i.aJ=Ue,i.aK=class{constructor(u){this.entries={},this.scheduler=u}request(u,s,c,f){const p=this.entries[u]=this.entries[u]||{callbacks:[]};if(p.result){const[_,b]=p.result;return this.scheduler?this.scheduler.add(()=>{f(_,b)},s):f(_,b),()=>{}}return p.callbacks.push(f),p.cancel||(p.cancel=c((_,b)=>{p.result=[_,b];for(const T of p.callbacks)this.scheduler?this.scheduler.add(()=>{T(_,b)},s):T(_,b);setTimeout(()=>delete this.entries[u],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(_=>_!==f),p.callbacks.length||(p.cancel(),delete this.entries[u]))}}},i.aL=function(u,s,c){const f=JSON.stringify(u.request);return u.data&&(this.deduped.entries[f]={result:[null,u.data]}),this.deduped.request(f,{type:"parseTile",isSymbolTile:u.isSymbolTile,zoom:u.tileZoom},p=>{const _=uc(u.request,(b,T,I,M)=>{b?p(b):T&&p(null,{vectorTile:c?void 0:new Er(new YT(T)),rawData:T,cacheControl:I,expires:M})});return()=>{_.cancel(),p()}},s)},i.aM=function(u){Jc++,Jc>Xc&&(u.getActor().send("enforceCacheSizeLimit",cc),Jc=0)},i.aN=function(u){return u<=1?1:Math.pow(2,Math.floor(Math.log2(u)))},i.aO=xc,i.aP=cV,i.aQ=mV,i.aR=se,i.aS=lV,i.aT=function(u,s){const c=document.createElement("video");c.muted=!0,c.onloadstart=function(){s(null,c)};for(let f=0;f<u.length;f++){const p=document.createElement("source");Cy(u[f])||(c.crossOrigin="Anonymous"),p.src=u[f],c.appendChild(p)}return{cancel:()=>{}}},i.aU=I2,i.aV=function(u){return fetch(u).then(s=>s.arrayBuffer()).then(s=>z7(s,0,u))},i.aW=W7,i.aX=class{constructor(u,s,c,f){this.id=u,this.position=s!=null?new se(s[0],s[1]):new se(0,0),this.orientation=c??[0,0,0],this.nodes=f,this.uploaded=!1,this.aabb=new gr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(u,s){if(F(u.matrix,s,u.matrix),u.meshes)for(const c of u.meshes){const f=gr.applyTransformFast(c.aabb,u.matrix);this.aabb.encapsulate(f)}if(u.children)for(const c of u.children)this._applyTransformations(c,u.matrix)}computeBoundsAndApplyParent(){const u=D([]);for(const s of this.nodes)this._applyTransformations(s,u)}computeModelMatrix(u,s,c,f,p,_,b=!1){G7(this.matrix,this,u.transform,this.position,s,c,f,p,_,b)}upload(u){if(!this.uploaded){for(const s of this.nodes)sM(s,u);for(const s of this.nodes)KT(s);this.uploaded=!0}}destroy(){for(const u of this.nodes)aM(u)}},i.aY=ar,i.aZ=z2,i.a_=Ve,i.aa=un,i.ab=class{constructor(u){this.specification=u}possiblyEvaluate(u,s){return xa(u.expression.evaluate(s))}interpolate(u,s,c){return{x:qe(u.x,s.x,c),y:qe(u.y,s.y,c),z:qe(u.z,s.z,c),azimuthal:qe(u.azimuthal,s.azimuthal,c),polar:qe(u.polar,s.polar,c)}}},i.ac=hs,i.ad=ws,i.ae=Dt,i.af=Pt,i.ag=Ce,i.ah=kt,i.ai=Zh,i.aj=e0,i.ak=qe,i.al=yn,i.am=Rt,i.an=lt,i.ao=Ii,i.ap=class{constructor(u){this.specification=u}possiblyEvaluate(u,s){return function([c,f]){const p=xa([1,c,f]);return{x:p.x,y:p.y,z:p.z}}(u.expression.evaluate(s))}interpolate(u,s,c){return{x:qe(u.x,s.x,c),y:qe(u.y,s.y,c),z:qe(u.z,s.z,c)}}},i.aq=function(u,s,c=0,f=!0){const p=new zt(c,c),_=u.sub(p),b=s.add(p),T=[_,new zt(b.x,_.y),b,new zt(_.x,b.y)];return f&&T.push(_.clone()),T},i.ar=function(u,s){const c=[];for(let f=0;f<u.length;f++){const p=ot(f-1,-1,u.length-1),_=ot(f+1,-1,u.length-1),b=u[f],T=u[_],I=u[p].sub(b).unit(),M=T.sub(b).unit(),O=M.angleWithSep(I.x,I.y),z=I.add(M).unit().mult(-1*s/Math.sin(O/2));c.push(b.add(z))}return c},i.as=ZU,i.at=Ma,i.au=function(u,s,c=0){return xe(((s.x-c)*u.scale-u.x)*yn,(s.y*u.scale-u.y)*yn,Oe(s.z,s.y))},i.av=st,i.aw=gt,i.ax=ji,i.ay=sU,i.az=function(u){let s=1/0,c=1/0,f=-1/0,p=-1/0;for(const _ of u)s=Math.min(s,_.x),c=Math.min(c,_.y),f=Math.max(f,_.x),p=Math.max(p,_.y);return{min:new zt(s,c),max:new zt(f,p)}},i.b=function(u){return $o.API_FONTS_REGEX.test(u)},i.b$=qN,i.b0=_g,i.b1=vo,i.b2=Yt,i.b3=u2,i.b4=uC,i.b5=function(){Fc.isLoading()||Fc.isLoaded()||Uy()!=="deferred"||Hh()},i.b6=Xp,i.b7=dn,i.b8=S1,i.b9=bi,i.bA=D,i.bB=Q,i.bC=j,i.bD=function(u,s){const{x:c,y:f}=u.point,p=E8(c,f,u.worldSize/u._pixelsPerMercatorPixel,0,0);return F(p,p,NN(um(s)))},i.bE=w,i.bF=Un,i.bG=function(u,s){var c=s[0]-u[0],f=s[1]-u[1],p=s[2]-u[2];return Math.sqrt(c*c+f*f+p*p)},i.bH=me,i.bI=At,i.bJ=dt,i.bK=R2,i.bL=qu,i.bM=yM,i.bN=function(u,s,c,f,p){const _=5*s+2;u.float32[_+0]=c,u.float32[_+1]=f,u.float32[_+2]=p},i.bO=cC,i.bP=Hi,i.bQ=Cn,i.bR=Cr,i.bS=ts,i.bT=ot,i.bU=function(u,s,c,f){var p=new x(4);return p[0]=u,p[1]=s,p[2]=c,p[3]=f,p},i.bV=VT,i.bW=Uu,i.bX=tl,i.bY=i7,i.bZ=gV,i.b_=l7,i.ba=uM,i.bb=UN,i.bc=Nn,i.bd=im,i.be=e1,i.bf=b8,i.bg=Qs,i.bh=o1,i.bi=PM,i.bj=function(u,s){const c=e0(s.zoom);if(c===0)return um(u);const f=NT(u),p=IN(f),_=ke(f.getWest())*s.worldSize,b=ke(f.getEast())*s.worldSize,T=Ue(f.getNorth())*s.worldSize,I=Ue(f.getSouth())*s.worldSize,M=[_,T,0],O=[b,T,0],z=[_,I,0],q=[b,I,0],K=B([],s.globeMatrix);return Pt(M,M,K),Pt(O,O,K),Pt(z,z,K),Pt(q,q,K),p[0]=Sg(p[0],z,c),p[1]=Sg(p[1],q,c),p[2]=Sg(p[2],O,c),p[3]=Sg(p[3],M,c),gr.fromPoints(p)},i.bk=LT,i.bl=B,i.bm=p2,i.bn=Sg,i.bo=vg,i.bp=zfe,i.bq=ne,i.br=$,i.bs=wC,i.bt=YT,i.bu=uc,i.bv=function(u,s){const c=[];for(const f in u)f in s||c.push(f);return c},i.bw=Et,i.bx=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.by=es,i.bz=function(u){var s=new x(16);return s[0]=u[0],s[1]=u[1],s[2]=u[2],s[3]=u[3],s[4]=u[4],s[5]=u[5],s[6]=u[6],s[7]=u[7],s[8]=u[8],s[9]=u[9],s[10]=u[10],s[11]=u[11],s[12]=u[12],s[13]=u[13],s[14]=u[14],s[15]=u[15],s},i.c=Qm,i.c$=function(u){return u*u*u*u*u},i.c0=gM,i.c1=UU,i.c2=bM,i.c3=UM,i.c4=xt,i.c5=Or,i.c6=xn,i.c7=function(u,s,c){c*=.5;var f=s[0],p=s[1],_=s[2],b=s[3],T=Math.sin(c),I=Math.cos(c);return u[0]=f*I+p*T,u[1]=p*I-f*T,u[2]=_*I+b*T,u[3]=b*I-_*T,u},i.c8=Rn,i.c9=zs,i.cA=Zr,i.cB=U7,i.cC=Qf,i.cD=A8,i.cE=function(u,s,c,f,p,_,b,T,I){if(I.name==="globe")return A8(u,s,new Qf(c,f,p),!1);const M=z2({z:c,x:f,y:p},I);return new gr([(_+M.x/M.scale)*s,s*(M.y/M.scale),b],[(_+M.x2/M.scale)*s,s*(M.y2/M.scale),T])},i.cF=function(u,s,c){return u[0]=Math.min(s[0],c[0]),u[1]=Math.min(s[1],c[1]),u[2]=Math.min(s[2],c[2]),u[3]=Math.min(s[3],c[3]),u},i.cG=function(u,s,c){return u[0]=Math.max(s[0],c[0]),u[1]=Math.max(s[1],c[1]),u[2]=Math.max(s[2],c[2]),u[3]=Math.max(s[3],c[3]),u},i.cH=function(u){const s=Math.round((u+45+360)%360/90)%4;return _e[s]},i.cI=Ge,i.cJ=On,i.cK=A,i.cL=function(u){const s=D(new Float64Array(16));F(s,u.pixelMatrix,u.globeMatrix);const c=[0,V,0],f=[0,G,0];return Pt(c,c,s),Pt(f,f,s),[c[0]>0&&c[0]<=u.width&&c[1]>0&&c[1]<=u.height&&!LN(u,new se(u.center.lat,90)),f[0]>0&&f[0]<=u.width&&f[1]>0&&f[1]<=u.height&&!LN(u,new se(u.center.lat,-90))]},i.cM=function(u,s){const{scale:c}=u.tileTransform,f=c*yn/(u.tileSize*Math.pow(2,s.zoom-u.tileID.overscaledZ+u.tileID.canonical.z));return function(p,_,b){var T=_[1],I=_[2],M=_[3],O=b[0],z=b[1];return p[0]=_[0]*O,p[1]=T*O,p[2]=I*z,p[3]=M*z,p}(new Float32Array(4),s.inverseAdjustmentMatrix,[f,f])},i.cN=WT,i.cO=we,i.cP=B7,i.cQ=function(u){const s=B7(u,!0);return w([],[s[0],s[1],s[4],s[5]])},i.cR=H,i.cS=Ui,i.cT=J,i.cU=function(u){const{x:s,y:c}=u.point,{lng:f,lat:p}=u._center;return E8(s,c,u.worldSize,f,p)},i.cV=je,i.cW=de,i.cX=a1,i.cY=Ml,i.cZ=S,i.c_=function(u,s,c){let f=0;for(let p=0;p<2;++p)u[p]>0&&(f+=(u[p]-0)*(u[p]-0)),s[p]<0&&(f+=(0-s[p])*(0-s[p]));return f},i.ca=function(u,s){return u[0]=-s[0],u[1]=-s[1],u[2]=-s[2],u[3]=s[3],u},i.cb=he,i.cc=function(u,s,c,f,p){var _=1/Math.tan(s/2);if(u[0]=_/c,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=_,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,p!=null&&p!==1/0){var b=1/(f-p);u[10]=(p+f)*b,u[14]=2*p*f*b}else u[10]=-1,u[14]=-2*f;return u},i.cd=function(u,s,c,f,p,_,b){var T=1/(s-c),I=1/(f-p),M=1/(_-b);return u[0]=-2*T,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*I,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*M,u[11]=0,u[12]=(s+c)*T,u[13]=(p+f)*I,u[14]=(b+_)*M,u[15]=1,u},i.ce=Fe,i.cf=function(u,s,c){u[4*s+0]=c[0],u[4*s+1]=c[1],u[4*s+2]=c[2],u[4*s+3]=c[3]},i.cg=n_,i.ch=r_,i.ci=Na,i.cj=Yh,i.ck=s_,i.cl=QU,i.cm=function(){var u=new x(4);return x!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u},i.cn=function(u,s,c){var f=s[0],p=s[1],_=s[2],b=s[3],T=Math.sin(c),I=Math.cos(c);return u[0]=f*I+_*T,u[1]=p*I+b*T,u[2]=f*-T+_*I,u[3]=p*-T+b*I,u},i.co=function(u,s){return u[0]===s[0]&&u[1]===s[1]&&u[2]===s[2]&&u[3]===s[3]},i.cp=Kt,i.cq=function(u){var s=u[0],c=u[1],f=u[2],p=u[3];return Math.sqrt(s*s+c*c+f*f+p*p)},i.cr=wr,i.cs=Ot,i.ct=s1,i.cu=3,i.cv=2,i.cw=7,i.cx=6,i.cy=mt,i.cz=fe,i.d=function(u){return $o.API_TILEJSON_REGEX.test(u)},i.d$=cU,i.d0=Te,i.d1=45,i.d2=i_,i.d3=function(u,s,c){const f=Math.sqrt(u*u+s*s+c*c),p=f>0?Math.acos(c/f)*qr:0;let _=u!==0||s!==0?Math.atan2(-s,-u)*qr+90:0;return _<0&&(_+=360),[f,_,p]},i.d4=xe,i.d5=xa,i.d6=bt,i.d7=Qe,i.d8=gr,i.d9=et,i.dA=function(u,s,c){const f=e0(c.zoom),p=u.style.map._antialias,_=u.terrain&&u.terrain.exaggeration()>0;return f===0&&!p&&!_},i.dB=function(u){const s=u.pixelsPerMeter,c=s/Fe(1,u.center.lat),f=D(new Float64Array(16));return $(f,f,[u.point.x,u.point.y,0]),H(f,f,[c,c,s]),Float32Array.from(f)},i.dC=NT,i.dD=function(u){const s=Ge-5;u=We(u,-s,s)/s*90;const c=Math.pow(Math.abs(Math.sin(lt(u))),3);return Math.round(c*(R.length-1))},i.dE=function(u,s,c,f){const p=s.getNorth(),_=s.getSouth(),b=s.getWest(),T=s.getEast(),I=1<<u.z,M=T-b,O=p-_,z=M/N,q=-O/R[c],K=[0,z,0,q,0,0,p,b,0];if(u.z>0){const Y=180/f;E(K,K,[Y/M+1,0,0,0,Y/O+1,0,-.5*Y/z,.5*Y/q,1])}return K[2]=I,K[5]=u.x,K[8]=u.y,K},i.dF=um,i.dG=function(u,s,c){const f=D(new Float64Array(16)),p=(s/(1<<u)-.5)*Math.PI*2;return ee(f,c.globeMatrix,p),Float32Array.from(f)},i.dH=class{isDataAvailableAtPoint(u){const s=this._source();if(this.isUsingMockSource()||!s||u.y<0||u.y>1)return!1;const c=s.getSource().maxzoom,f=1<<c,p=Math.floor(u.x),_=Math.floor((u.x-p)*f),b=Math.floor(u.y*f),T=this.findDEMTileFor(new xc(c,p,c,_,b));return!(!T||!T.dem)}getAtPointOrZero(u,s=0){return this.getAtPoint(u,s)||0}getAtPoint(u,s,c=!0){if(this.isUsingMockSource())return null;s==null&&(s=null);const f=this._source();if(!f||u.y<0||u.y>1)return s;const p=f.getSource().maxzoom,_=1<<p,b=Math.floor(u.x),T=u.x-b,I=new xc(p,b,p,Math.floor(T*_),Math.floor(u.y*_)),M=this.findDEMTileFor(I);if(!M||!M.dem)return s;const O=M.dem,z=1<<M.tileID.canonical.z,q=(T*z-M.tileID.canonical.x)*O.dim,K=(u.y*z-M.tileID.canonical.y)*O.dim,Y=Math.floor(q),ae=Math.floor(K);return(c?this.exaggeration():1)*qe(qe(O.get(Y,ae),O.get(Y,ae+1),K-ae),qe(O.get(Y+1,ae),O.get(Y+1,ae+1),K-ae),q-Y)}getAtTileOffset(u,s,c){const f=1<<u.canonical.z;return this.getAtPointOrZero(new Dt(u.wrap+(u.canonical.x+s/yn)/f,(u.canonical.y+c/yn)/f))}getAtTileOffsetFunc(u,s,c,f){return p=>{const _=this.getAtTileOffset(u,p.x,p.y),b=f.upVector(u.canonical,p.x,p.y);return xt(b,b,_*f.upVectorScale(u.canonical,s,c).metersToTile),b}}getForTilePoints(u,s,c,f){if(this.isUsingMockSource())return!1;const p=_1.create(this,u,f);return!!p&&(s.forEach(_=>{_[2]=this.exaggeration()*p.getElevationAt(_[0],_[1],c)}),!0)}getMinMaxForTile(u){if(this.isUsingMockSource())return null;const s=this.findDEMTileFor(u);if(!s||!s.dem)return null;const c=s.dem.tree,f=s.tileID,p=1<<u.canonical.z-f.canonical.z;let _=u.canonical.x/p-f.canonical.x,b=u.canonical.y/p-f.canonical.y,T=0;for(let I=0;I<u.canonical.z-f.canonical.z&&!c.leaves[T];I++){_*=2,b*=2;const M=2*Math.floor(b)+Math.floor(_);T=c.childOffsets[T]+M,_%=1,b%=1}return{min:this.exaggeration()*c.minimums[T],max:this.exaggeration()*c.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(u,s,c){throw new Error("Pure virtual method called.")}pointCoordinate(u){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(u){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const u=this.visibleDemTiles;if(u.length===0)return null;let s=!1,c=Number.MAX_VALUE,f=Number.MIN_VALUE;for(const p of u){const _=this.getMinMaxForTile(p.tileID);_&&(c=Math.min(c,_.min),f=Math.max(f,_.max),s=!0)}return s?{min:c,max:f}:null}},i.dI=B8,i.dJ=IT,i.dK=function(u,s){return[Math.pow(u[0],2.2)*s,Math.pow(u[1],2.2)*s,Math.pow(u[2],2.2)*s]},i.dL=C,i.dM=function(u,s){var c=Math.sin(s),f=Math.cos(s);return u[0]=f,u[1]=c,u[2]=0,u[3]=-c,u[4]=f,u[5]=0,u[6]=0,u[7]=0,u[8]=1,u},i.dN=Ht,i.dO=C8,i.dP=Vo,i.dQ=Cl,i.dR=256,i.dS=function(u,s){const c=[0,0,0];return Pt(c,c,LT(um(s.canonical))),Pt(c,c,u),c},i.dT=u=>({u_matrix:new s_(u),u_texsize:new Yh(u),u_pixels_to_tile_units:new i1(u),u_device_pixel_ratio:new Na(u),u_width_scale:new Na(u),u_floor_width_scale:new Na(u),u_image:new n_(u),u_units_to_pixels:new Yh(u),u_tile_units_to_pixels:new Na(u),u_alpha_discard_threshold:new Na(u),u_trim_offset:new Yh(u),u_trim_fade_range:new Yh(u),u_trim_color:new i_(u),u_emissive_strength:new Na(u),u_zbias_factor:new Na(u),u_tile_to_meter:new Na(u),u_ground_shadow_factor:new r_(u),u_pattern_transition:new Na(u)}),i.dU=u=>({u_matrix:new s_(u),u_pixels_to_tile_units:new i1(u),u_device_pixel_ratio:new Na(u),u_width_scale:new Na(u),u_floor_width_scale:new Na(u),u_units_to_pixels:new Yh(u),u_dash_image:new n_(u),u_gradient_image:new n_(u),u_image_height:new Na(u),u_texsize:new Yh(u),u_tile_units_to_pixels:new Na(u),u_alpha_discard_threshold:new Na(u),u_trim_offset:new Yh(u),u_trim_fade_range:new Yh(u),u_trim_color:new i_(u),u_emissive_strength:new Na(u),u_zbias_factor:new Na(u),u_tile_to_meter:new Na(u),u_ground_shadow_factor:new r_(u)}),i.dV=u=>({u_camera_to_center_distance:new Na(u),u_extrude_scale:new i1(u),u_device_pixel_ratio:new Na(u),u_matrix:new s_(u),u_inv_rot_matrix:new s_(u),u_merc_center:new Yh(u),u_tile_id:new r_(u),u_zoom_transition:new Na(u),u_up_dir:new r_(u),u_emissive_strength:new Na(u)}),i.dW=s2,i.dX=Ame,i.dY=class{constructor(u,s,c,f){this.context=u,this.format=f,this.size=c,this.texture=u.gl.createTexture();const[p,_,b]=this.size,{gl:T}=u;T.bindTexture(T.TEXTURE_3D,this.texture),u.pixelStoreUnpackFlipY.set(!1),u.pixelStoreUnpack.set(1),u.pixelStoreUnpackPremultiplyAlpha.set(!1),"data"in s&&s.data&&T.texImage3D(T.TEXTURE_3D,0,this.format,p,_,b,0,eM(this.format),tM(this.format),s.data)}bind(u,s){const{context:c}=this,{gl:f}=c;f.bindTexture(f.TEXTURE_3D,this.texture),u!==this.minFilter&&(f.texParameteri(f.TEXTURE_3D,f.TEXTURE_MAG_FILTER,u),f.texParameteri(f.TEXTURE_3D,f.TEXTURE_MIN_FILTER,u),this.minFilter=u),s!==this.wrapS&&(f.texParameteri(f.TEXTURE_3D,f.TEXTURE_WRAP_S,s),f.texParameteri(f.TEXTURE_3D,f.TEXTURE_WRAP_T,s),this.wrapS=s)}destroy(){const{gl:u}=this.context;u.deleteTexture(this.texture),this.texture=null}},i.dZ=I8,i.d_=(u,s,c,f,p,_)=>{const b=u.transform,T=b.projection.name==="globe";let I;if(_.paint.get("circle-pitch-alignment")==="map")if(T){const O=C8(b.zoom,s.canonical)*b._pixelsPerMercatorPixel;I=Float32Array.from([O,0,0,O])}else I=b.calculatePixelsToTileUnitsMatrix(c);else I=new Float32Array([b.pixelsToGLUnits[0],0,0,b.pixelsToGLUnits[1]]);const M={u_camera_to_center_distance:u.transform.getCameraToCenterDistance(b.projection),u_matrix:u.translatePosMatrix(s.projMatrix,c,_.paint.get("circle-translate"),_.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Yc.devicePixelRatio,u_extrude_scale:I,u_inv_rot_matrix:qfe,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:_.paint.get("circle-emissive-strength")};if(T){M.u_inv_rot_matrix=f,M.u_merc_center=p,M.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],M.u_zoom_transition=e0(b.zoom);const O=p[0]*yn,z=p[1]*yn;M.u_up_dir=b.projection.upVector(new Qf(0,0,0),O,z)}return M},i.da=function(u){return[Math.pow(u[0],1/2.2),Math.pow(u[1],1/2.2),Math.pow(u[2],1/2.2)]},i.db=IM,i.dc=function(u,s){return u.readFields(_ge,{icons:[]},s)},i.dd=$T,i.de=g1,i.df=_M,i.dg=Op,i.dh=ih,i.di=Rp,i.dj=Oh,i.dk=Fr,i.dl=function(u){const s=u.indexOf(tm);return s>=0?u.slice(0,s):u},i.dm=function(u){return u.indexOf(tm)>=0},i.dn=function(u){const s=u.lastIndexOf(tm);return s>=0?u.slice(s+1):""},i.dp=function(u){const s=[],c=u.id;return c===void 0&&s.push({message:`layers.${c}: missing required property "id"`}),u.render===void 0&&s.push({message:`layers.${c}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&s.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),s},i.dq=function(u,s,c,f){return u.type==="custom"?new fge(u,s):new yge[u.type](u,s,c,f)},i.dr=Gr,i.ds=function(u){const s=u.indexOf(tm);return s>=0?u.slice(s+1):""},i.dt=class extends S1{constructor(u,s){super(u._vectorTileFeature,u._z,u._x,u._y,u.id),u.state&&(this.state=Object.assign({},u.state)),this.target=s.target,this.namespace=s.namespace,s.properties&&(this.properties=s.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=u.source,this.sourceLayer=u.sourceLayer,this.layer=u.layer)}toJSON(){const u=super.toJSON();return u.target=this.target,u.namespace=this.namespace,u}},i.du=Zv,i.dv=mi,i.dw=function(u){return u({pluginStatus:Nl,pluginURL:Ed}),Zv.on("pluginStateChange",u),u},i.dx=ET,i.dy=class extends Kh{constructor(u){super(u),this.current=EN}set(u,s,c){if(this.fetchUniformLocation(u,s)){for(let f=0;f<9;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix3fv(this.location,!1,c);break}}}},i.dz=Ie,i.e=$o,i.e$=function(){const u=E2;u&&(u.isPreloaded()&&u.numActive()===1?(u.release(KN),E2=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.e0=fo,i.e1=(u,s,c,f,p,_,b,T,I,M)=>{const O=u.transform,z=O.pitch<15?aU(.07,.7,We((14-O.zoom)/5,0,1)):.07,q=c.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:lU(u,s,c,f),u_texsize:s.imageAtlasTexture?s.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:O.calculatePixelsToTileUnitsMatrix(s),u_device_pixel_ratio:p,u_width_scale:_,u_floor_width_scale:b,u_image:0,u_tile_units_to_pixels:oU(s,O),u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:T,u_trim_fade_range:c.paint.get("line-trim-fade-range"),u_trim_color:c.paint.get("line-trim-color").toPremultipliedRenderColor(q?null:c.lut).toArray01(),u_emissive_strength:c.paint.get("line-emissive-strength"),u_zbias_factor:z,u_tile_to_meter:bt(s.tileID.canonical,0),u_ground_shadow_factor:I,u_pattern_transition:M}},i.e2=(u,s,c,f,p,_,b,T,I,M)=>{const O=u.transform,z=O.calculatePixelsToTileUnitsMatrix(s),q=c.paint.get("line-trim-color-use-theme").constantOr("default")==="none",K=O.pitch<15?aU(.07,.7,We((14-O.zoom)/5,0,1)):.07;return{u_matrix:lU(u,s,c,f),u_pixels_to_tile_units:z,u_device_pixel_ratio:_,u_width_scale:b,u_floor_width_scale:T,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:p,u_texsize:uU(c)&&s.lineAtlasTexture?s.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:oU(s,u.transform),u_alpha_discard_threshold:0,u_trim_offset:I,u_trim_fade_range:c.paint.get("line-trim-fade-range"),u_trim_color:c.paint.get("line-trim-color").toPremultipliedRenderColor(q?null:c.lut).toArray01(),u_emissive_strength:c.paint.get("line-emissive-strength"),u_zbias_factor:K,u_tile_to_meter:bt(s.tileID.canonical,0),u_ground_shadow_factor:M}},i.e3=Vn,i.e4=m2,i.e5=Oe,i.e6=Ofe,i.e7=UT,i.e8=x7,i.e9=n0,i.eA=so,i.eB=Yy,i.eC=function(u,s,c,f,p,_,b,T,I,M,O,z,q,K,Y,ae){var le=new x(16);return le[0]=u,le[1]=s,le[2]=c,le[3]=f,le[4]=p,le[5]=_,le[6]=b,le[7]=T,le[8]=I,le[9]=M,le[10]=O,le[11]=z,le[12]=q,le[13]=K,le[14]=Y,le[15]=ae,le},i.eD=te,i.eE=Jv,i.eF=Jx,i.eG=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new zt(1/0,1/0),max:new zt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(u,s=!1){const c=a7(new zt(0,0),new zt(yn,yn),u),f=[];if(s&&!VN(c,this._globalClipBounds))return f;for(const p of this._activeRegions){if(p.hiddenByOverlap||!VN(c,p))continue;const _=vpe(p.min,p.max,u);f.push({min:_.min,max:_.max,sourceId:this._sourceIds[p.priority],footprint:p.footprint,footprintTileId:p.tileId,order:p.order,clipMask:p.clipMask,clipScope:p.clipScope})}return f}setSources(u){this._setSources(u.map(s=>({getSourceId:()=>s.cache.id,getFootprints:()=>{const c=[];for(const f of s.cache.getVisibleCoordinates()){const p=s.cache.getTile(f).buckets[s.layer];p&&p.updateFootprints(f.toUnwrapped(),c)}return c},getOrder:()=>s.order,getClipMask:()=>s.clipMask,getClipScope:()=>s.clipScope})))}_addSource(u){const s=u.getFootprints();if(s.length===0)return;const c=u.getOrder(),f=u.getClipMask(),p=u.getClipScope();for(const _ of s){if(!_.footprint)continue;const b=a7(_.footprint.min,_.footprint.max,_.id);this._activeRegions.push({min:b.min,max:b.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:_.id,footprint:_.footprint,order:c,clipMask:f,clipScope:p})}this._sourceIds.push(u.getSourceId())}_computeReplacement(){this._activeRegions.sort((s,c)=>s.priority-c.priority||FT(s.min,c.min)||FT(s.max,c.max)||s.order-c.order||s.clipMask-c.clipMask||function(f,p){const _=(b,T)=>b+T;return f.length-p.length||f.reduce(_,"").localeCompare(p.reduce(_,""))}(s.clipScope,c.clipScope));let u=this._activeRegions.length!==this._prevRegions.length;if(!u){let s=0;for(;!u&&s!==this._activeRegions.length;){const c=this._activeRegions[s],f=this._prevRegions[s];u=c.priority!==f.priority||!s7(c,f)||c.order!==f.order||c.clipMask!==f.clipMask||!es(c.clipScope,f.clipScope),++s}}if(u){++this._updateTime;for(const c of this._activeRegions)c.order!==b2&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,c.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,c.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,c.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,c.max.y));const s=c=>{const f=this._activeRegions;if(c>=f.length)return c;const p=f[c].priority;for(;c<f.length&&f[c].priority===p;)++c;return c};if(this._sourceIds.length>1){let c=0,f=s(c);for(;c!==f;){let p=c;const _=c;for(;p!==f;){const b=this._activeRegions[p];b.hiddenByOverlap=!1;for(let T=0;T<_;T++){const I=this._activeRegions[T];if(!I.hiddenByOverlap&&b.order===b2&&VN(b,I)&&(b.hiddenByOverlap=o7(b.footprint,b.tileId,I.footprint,I.tileId),b.hiddenByOverlap))break}++p}c=f,f=s(c)}}}}_setSources(u){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let s=u.length-1;s>=0;s--)this._addSource(u[s]);this._computeReplacement()}},i.eH=b2,i.eI=class{constructor(u){this._createGrid(u),this._createPoles(u)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const u of this._poleSegments)u.destroy();for(const u of this._gridSegments)u.withSkirts.destroy(),u.withoutSkirts.destroy()}_fillGridMeshWithLods(u,s){const c=new im,f=new vo,p=[],_=u+1+2,b=s[0]+1,T=s[0]+1+(1+s.length),I=(M,O,z)=>{let q=M===_-1?M-2:M===0?M:M-1;return q+=z?24575:0,[q,O]};for(let M=0;M<_;++M)c.emplaceBack(...I(M,0,!0));for(let M=0;M<b;++M)for(let O=0;O<_;++O)c.emplaceBack(...I(O,M,(O===0||O===_-1)&&!0));for(let M=0;M<s.length;++M){const O=s[M];for(let z=0;z<_;++z)c.emplaceBack(...I(z,O,!0))}for(let M=0;M<s.length;++M){const O=f.length,z=s[M]+1+2,q=new vo;for(let ae=0;ae<z-1;ae++){const le=ae===z-2,ce=le?_*(T-s.length+M-ae):_;for(let Se=0;Se<_-1;Se++){const Ae=ae*_+Se;ae===0||le||Se===0||Se===_-2?(q.emplaceBack(Ae+1,Ae,Ae+ce),q.emplaceBack(Ae+ce,Ae+ce+1,Ae+1)):(f.emplaceBack(Ae+1,Ae,Ae+ce),f.emplaceBack(Ae+ce,Ae+ce+1,Ae+1))}}const K=Qs.simpleSegment(0,O,c.length,f.length-O);for(let ae=0;ae<q.uint16.length;ae+=3)f.emplaceBack(q.uint16[ae],q.uint16[ae+1],q.uint16[ae+2]);const Y=Qs.simpleSegment(0,O,c.length,f.length-O);p.push({withoutSkirts:K,withSkirts:Y})}return{vertices:c,indices:f,segments:p}}_createGrid(u){const s=this._fillGridMeshWithLods(N,R);this._gridSegments=s.segments,this._gridBuffer=u.createVertexBuffer(s.vertices,b8.members),this._gridIndexBuffer=u.createIndexBuffer(s.indices,!0)}_createPoles(u){const s=new vo;for(let b=0;b<=N;b++)s.emplaceBack(0,b+1,b+2);this._poleIndexBuffer=u.createIndexBuffer(s,!0);const c=new xg,f=new xg,p=new xg,_=new xg;this._poleSegments=[];for(let b=0,T=0;b<S;b++){const I=360/(1<<b);c.emplaceBack(0,-m,0,.5,0),f.emplaceBack(0,-m,0,.5,1),p.emplaceBack(0,-m,0,.5,.5),_.emplaceBack(0,-m,0,.5,.5);for(let M=0;M<=N;M++){let O=M/N,z=0;const q=qe(0,I,O),[K,Y,ae]=X(Vfe,$fe,q,m);c.emplaceBack(K,Y,ae,O,z),f.emplaceBack(K,Y,ae,O,1-z);const le=lt(q);O=.5+.5*Math.sin(le),z=.5+.5*Math.cos(le),p.emplaceBack(K,Y,ae,O,z),_.emplaceBack(K,Y,ae,O,1-z)}this._poleSegments.push(Qs.simpleSegment(T,0,66,64)),T+=66}this._poleNorthVertexBuffer=u.createVertexBuffer(c,kT,!1),this._poleSouthVertexBuffer=u.createVertexBuffer(f,kT,!1),this._texturedPoleNorthVertexBuffer=u.createVertexBuffer(p,kT,!1),this._texturedPoleSouthVertexBuffer=u.createVertexBuffer(_,kT,!1)}getGridBuffers(u,s){return[this._gridBuffer,this._gridIndexBuffer,s?this._gridSegments[u].withSkirts:this._gridSegments[u].withoutSkirts]}getPoleBuffers(u,s){return[s?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,s?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[u]]}},i.eJ=r7,i.eK=Xe,i.eL=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.eM=He,i.eN=jt,i.eO=function(u,s,c){return u[0]=s[0]/c[0],u[1]=s[1]/c[1],u[2]=s[2]/c[2],u},i.eP=Dr,i.eQ=W,i.eR=nt,i.eS=Re,i.eT=function([u,s,c]){const f=Math.hypot(u,s,c),p=Math.atan2(u,c),_=.5*Math.PI-Math.acos(-s/f);return new se(de(p),de(_))},i.eU=ht,i.eV=rM,i.eW=function(u){const s=u.navigator?u.navigator.userAgent:null;return!!function(c){if(Ns==null){const f=c.navigator?c.navigator.userAgent:null;Ns=!!c.safari||!(!f||!(/\b(iPad|iPhone|iPod)\b/.test(f)||f.match("Safari")&&!f.match("Chrome")))}return Ns}(u)&&!(!s||!(s.match("Version/15.4")||s.match("Version/15.5")||s.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},i.eX=function(u,s){cc=u,Xc=s},i.eY=LN,i.eZ=P8,i.e_=function(u){const s=[0,0,0],c=D(new Float64Array(16));return F(c,u.pixelMatrix,u.globeMatrix),Pt(s,s,c),new zt(s[0],s[1])},i.ea=450,i.eb=7,i.ec=ut,i.ed=function(u,s){if(u===s){var c=s[1],f=s[2],p=s[3],_=s[6],b=s[7],T=s[11];u[1]=s[4],u[2]=s[8],u[3]=s[12],u[4]=c,u[6]=s[9],u[7]=s[13],u[8]=f,u[9]=_,u[11]=s[14],u[12]=p,u[13]=b,u[14]=T}else u[0]=s[0],u[1]=s[4],u[2]=s[8],u[3]=s[12],u[4]=s[1],u[5]=s[5],u[6]=s[9],u[7]=s[13],u[8]=s[2],u[9]=s[6],u[10]=s[10],u[11]=s[14],u[12]=s[3],u[13]=s[7],u[14]=s[11],u[15]=s[15];return u},i.ee=hge,i.ef=Ti,i.eg=Jy,i.eh=256,i.ei=NN,i.ej=Bc,i.ek=ee,i.el=function(u,s){return u[0]=s[0],u[1]=s[1],u[2]=s[2],u[3]=s[4],u[4]=s[5],u[5]=s[6],u[6]=s[8],u[7]=s[9],u[8]=s[10],u},i.em=xg,i.en=l2,i.eo=In,i.ep=function(u,s,c,f,p){return We((u-s)/(c-s)*(p-f)+f,f,p)},i.eq=Sn,i.er=function(u,s){var c=s[0],f=s[1],p=s[2],_=s[3],b=s[4],T=s[5],I=s[6],M=s[7],O=s[8],z=O*b-T*M,q=-O*_+T*I,K=M*_-b*I,Y=c*z+f*q+p*K;return Y?(u[0]=z*(Y=1/Y),u[1]=(-O*f+p*M)*Y,u[2]=(T*f-p*b)*Y,u[3]=q*Y,u[4]=(O*c-p*I)*Y,u[5]=(-T*c+p*_)*Y,u[6]=K*Y,u[7]=(-M*c+f*I)*Y,u[8]=(b*c-f*_)*Y,u):null},i.es=2,i.et=vt,i.eu=iM,i.ev=[1,1,1],i.ew=_1,i.ex=Br,i.ey=function(u,s,c,f){var p=s[0],_=s[1],b=s[2],T=s[3];return u[0]=p+f*(c[0]-p),u[1]=_+f*(c[1]-_),u[2]=b+f*(c[2]-b),u[3]=T+f*(c[3]-T),u},i.ez=f1,i.f=function(u){return btoa(encodeURIComponent(u).replace(/%([0-9A-F]{2})/g,(s,c)=>String.fromCharCode(+("0x"+c))))},i.f0=function(){$T().acquire(KN)},i.f1=Uy,i.f2=function(u,s,c=!1){if(Nl===Qo.deferred||Nl===Qo.loading||Nl===Qo.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ed=Yc.resolveURL(u),Nl=Qo.deferred,Hv=s,Wv(),c||Hh()},i.f3=function(u){u1=Yc.resolveURL(u),d1||(d1=new c1($T(),new gd)),d1.broadcast("setMeshoptUrl",u1)},i.f4=L7,i.f5=function(u){XN=Yc.resolveURL(u),d1||(d1=new c1($T(),new gd)),d1.broadcast("setDracoUrl",XN)},i.f6=M7,i.f7=C2,i.f8=function(u){const s=tg();if(!s)return;const c=s.delete(Qa);u&&c.then(()=>u()).catch(u)},i.f9=c_,i.fA=function(u){Lf(),Po!=null&&Po.then(s=>{s.keys().then(c=>{for(let f=0;f<c.length-u;f++)s.delete(c[f]).catch(p=>ai(p.message))}).catch(c=>ai(c.message))}).catch(s=>ai(s.message))},i.fa=Pn,i.fb=t0,i.fc=tp,i.fd=i$,i.fe=s$,i.ff=nU,i.fg=Wr,i.fh="hd_road_elevation",i.fi=Ks,i.fj=vr,i.fk=Ag,i.fl=vM,i.fm=h_,i.fn=function(u,s,c,f,p,_,b,T=1,I,M,O){u.createArrays(),u.tilePixelRatio=yn/(512*u.overscaling),u.compareText={},u.iconsNeedLinear=!1;const z=u.layers[0].layout,q=u.layers[0]._unevaluatedLayout._values,K={};K.scaleFactor=T,K.textSizeScaleRange=z.get("text-size-scale-range"),K.iconSizeScaleRange=z.get("icon-size-scale-range");const[Y,ae]=K.textSizeScaleRange,[le,ce]=K.iconSizeScaleRange;K.textScaleFactor=We(K.scaleFactor,Y,ae),K.iconScaleFactor=We(K.scaleFactor,le,ce);const Se=q["text-size"],Ae=q["icon-size"];if(u.textSizeData.kind==="composite"){const{minZoom:ct,maxZoom:qt}=u.textSizeData;K.compositeTextSizes=[Se.possiblyEvaluate(new hs(ct,{worldview:O}),_),Se.possiblyEvaluate(new hs(qt,{worldview:O}),_)]}if(u.iconSizeData.kind==="composite"){const{minZoom:ct,maxZoom:qt}=u.iconSizeData;K.compositeIconSizes=[Ae.possiblyEvaluate(new hs(ct,{worldview:O}),_),Ae.possiblyEvaluate(new hs(qt,{worldview:O}),_)]}K.layoutTextSize=Se.possiblyEvaluate(new hs(b+1,{worldview:O}),_),K.layoutIconSize=Ae.possiblyEvaluate(new hs(b+1,{worldview:O}),_),K.textMaxSize=Se.possiblyEvaluate(new hs(18,{worldview:O}),_);const Ee=z.get("symbol-placement"),Ze=z.get("text-rotation-alignment")==="map"&&Ee!=="point",Ke=z.get("text-size");let tt=!1;const at=[];for(const ct of u.features){const qt=z.get("text-font").evaluate(ct,{},_).join(","),_t=Ke.evaluate(ct,{},_)*K.textScaleFactor,Xt=K.layoutTextSize.evaluate(ct,{},_)*K.textScaleFactor,an=K.layoutIconSize.evaluate(ct,{},_)*K.iconScaleFactor,Jt={horizontal:{},vertical:void 0},en=ct.text;let hn,Vt=[0,0];if(en){const Yn=en.toString(),pr=z.get("text-letter-spacing").evaluate(ct,{},_)*tl,Lr=z.get("text-line-height").evaluate(ct,{},_)*tl,ii=yc(Yn)?pr:0,zr=z.get("text-anchor").evaluate(ct,{},_),Bn=z.get("text-variable-anchor");if(!Bn){const Mt=z.get("text-radial-offset").evaluate(ct,{},_);if(Mt)Vt=UU(zr,[Mt*tl,xM]);else{const $t=z.get("text-offset").evaluate(ct,{},_);Vt=[$t[0]*tl,$t[1]*tl]}}let jr=Ze?"center":z.get("text-justify").evaluate(ct,{},_);const ki=Ee==="point",Me=ki?z.get("text-max-width").evaluate(ct,{},_)*tl:1/0,Le=Mt=>{u.allowVerticalPlacement&&ma(Yn)&&(Jt.vertical=mM(en,s,c,p,qt,Me,Lr,zr,Mt,ii,Vt,qu.vertical,!0,Xt,_t,I))};if(!Ze&&Bn){const Mt=jr==="auto"?Bn.map(Tn=>bM(Tn)):[jr];let $t=!1;for(let Tn=0;Tn<Mt.length;Tn++){const An=Mt[Tn];if(!Jt.horizontal[An])if($t)Jt.horizontal[An]=Jt.horizontal[0];else{const zn=mM(en,s,c,p,qt,Me,Lr,"center",An,ii,Vt,qu.horizontal,!1,Xt,_t,I);zn&&(Jt.horizontal[An]=zn,$t=zn.positionedLines.length===1)}}Le("left")}else{if(jr==="auto"&&(jr=bM(zr)),ki||z.get("text-writing-mode").indexOf("horizontal")>=0||!ma(Yn)){const Mt=mM(en,s,c,p,qt,Me,Lr,zr,jr,ii,Vt,qu.horizontal,!1,Xt,_t,I);Mt&&(Jt.horizontal[jr]=Mt)}Le(ki?"left":jr)}}let nn,Lt,It,fn,cn,tr,Fn=!1;const qn=z.get("icon-text-fit").evaluate(ct,{},_);if(ct.icon&&ct.icon.hasPrimary()){const Yn=$U(ct.icon,u.iconSizeData,q["icon-size"],_,u.zoom,ct,I,K.iconScaleFactor,O);nn=Yn.iconPrimary,It=Yn.iconSecondary;const pr=nn.toString();if(Lt=f.get(pr),Lt&&(cn=z.get("icon-offset").evaluate(ct,{},_),tr=z.get("icon-anchor").evaluate(ct,{},_),hn=Vme(p.get(pr),It?p.get(It.toString()):void 0,cn,tr),Fn=Lt.sdf,u.sdfIcons===void 0?u.sdfIcons=Lt.sdf:u.sdfIcons!==Lt.sdf&&ai("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Lt.pixelRatio!==u.pixelRatio||z.get("icon-rotate").constantOr(1)!==0)&&(u.iconsNeedLinear=!0)),It){const Lr=It.toString();fn=f.get(Lr)}}tt=tt||!(!ct.icon||!ct.icon.hasSecondary());const vn=wM(Jt.horizontal)||Jt.vertical;u.iconsInText||(u.iconsInText=!!vn&&vn.iconsInText);const er=Xt*K.textScaleFactor/tl,{defaultShapedIcon:Ir,verticallyShapedIcon:En}=Jme(u,hn,z,ct,_,Jt,er,cn,qn);qn!=="none"&&hn&&(TU(hn)||CU(hn))&&(tC(0,Lt,nn,hn,Ir,qn,M,f,p),tC(0,fn,It,hn,Ir,qn,M,f,p),En&&(tC(0,Lt,nn,hn,En,qn,M,f,p),tC(0,fn,It,hn,En,qn,M,f,p))),hn=Ir,at.push({feature:ct,shapedTextOrientations:Jt,shapedText:vn,shapedIcon:hn,iconPrimary:nn,iconSecondary:It,iconOffset:cn,iconAnchor:tr,verticallyShapedIcon:En,layoutTextSize:Xt,layoutIconSize:an,textOffset:Vt,isSDFIcon:Fn,iconTextFit:qn})}return{featureData:at,sizes:K,hasAnySecondaryIcon:tt,textAlongLine:Ze,symbolPlacement:Ee}},i.fo=RU,i.fp=function(u,s,c,f,p,_,b,T,I,M){const{featureData:O,hasAnySecondaryIcon:z,sizes:q,textAlongLine:K,symbolPlacement:Y}=s;for(const ae of O){const{shapedIcon:le,verticallyShapedIcon:ce,feature:Se,shapedTextOrientations:Ae,shapedText:Ee,layoutTextSize:Ze,textOffset:Ke,isSDFIcon:tt,iconPrimary:at,iconSecondary:ct,iconTextFit:qt,iconOffset:_t}=ae;qU(le,M.iconPositions,at,ct),qU(ce,M.iconPositions,at,ct),Xme(Ae,M.iconPositions),Yme(at,ct,M.iconPositions),(Ee||le)&&Qme(u,Se,Ae,le,ce,I,q,Ze,0,Ke,tt,f,p,b,T,z,qt,_t,K,Y)}c&&u.generateCollisionDebugBuffers(_,u.collisionBoxArray,q.textScaleFactor)},i.fq=Er,i.fr=bC,i.fs=rn,i.ft=function(u){let s=0;if(new Uint32Array(u,0,1)[0]!==R7){const c=new Uint32Array(u,0,7),[,,f,p,_,b]=c;s=c.byteLength+p+_+b+_,(f!==u.byteLength||s>=u.byteLength)&&ai("Invalid b3dm header information.")}return z7(u,s)},i.fu=function(u,s){const c=W7(u);for(const f of c){for(const p of f.meshes)Kpe(p);f.lights&&(f.lightMeshIndex=f.meshes.length,f.meshes.push(Ype(f.lights,s)))}return c},i.fv=mC,i.fw=Wi,i.fx=I7,i.fy=Fc,i.fz=Qo,i.g=function(u,s){return mi(Object.assign(u,{method:"GET"}),s)},i.h=function(u){return u.indexOf("mapbox:")===0},i.i=function(u){return $o.API_STYLE_REGEX.test(u)&&!Qm(u)},i.j=Pa,i.k=Nu,i.l=function(u){return decodeURIComponent(atob(u).split("").map(s=>"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)).join(""))},i.m=function(u,s){return mi(Object.assign(u,{type:"json"}),s)},i.n=tu,i.o=Yc,i.p=function(u,s){return mi(Object.assign(u,{method:"POST"}),s)},i.q=Ll,i.r=Mf,i.s=function(u){try{const s=self[u];return s.setItem("_mapbox_test_",1),s.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=function(){return YN||(YN=new c_),YN},i.u=function(){return function u(s){return s?(s^Math.random()*(16>>s/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,u)}()},i.v=function(u){return!!u&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(u)},i.w=ai,i.x=OM,i.y=eh,i.z=El}),l(["./shared"],function(i){function y(lt){const de=lt?lt.url.toString():void 0;return de?performance.getEntriesByName(de):[]}function x(lt){if(typeof lt=="number"||typeof lt=="boolean"||typeof lt=="string"||lt==null)return JSON.stringify(lt);if(Array.isArray(lt)){let _e="[";for(const Ie of lt)_e+=`${x(Ie)},`;return`${_e}]`}let de="{";for(const _e of Object.keys(lt).sort())de+=`${_e}:${x(lt[_e])},`;return`${de}}`}function w(lt){let de="";for(const _e of i.bx)de+=`/${x(lt[_e])}`;return de}class C{constructor(de){this.keyCache={},this._layers={},this._layerConfigs={},de&&this.replace(de)}replace(de,_e){this._layerConfigs={},this._layers={},this.update(de,[],_e)}update(de,_e,Ie){this._options=Ie;for(const He of de)this._layerConfigs[He.id]=He,(this._layers[He.id]=i.dq(He,this.scope,null,this._options)).compileFilter(Ie),this.keyCache[He.id]&&delete this.keyCache[He.id];for(const He of _e)delete this.keyCache[He],delete this._layerConfigs[He],delete this._layers[He];this.familiesBySource={};const Xe=function(He,We){const kt={};for(let Et=0;Et<He.length;Et++){const on=He[Et];let Yt=We&&We[on.id];Yt||(on.type==="symbol"?Yt=on.id:(Yt=w(on),on.type==="line"&&on.paint&&function ar(vr){return typeof vr=="string"&&vr==="line-progress"||(Array.isArray(vr)?vr.some(ar):!(!vr||typeof vr!="object")&&Object.values(vr).some(ar))}(on.paint["line-width"])&&(Yt+=`/${x(on.paint["line-width"])}`))),We&&(We[on.id]=Yt);let Vn=kt[Yt];Vn||(Vn=kt[Yt]=[]),Vn.push(on)}const ot=[];for(const Et in kt)ot.push(kt[Et]);return ot}(Object.values(this._layerConfigs),this.keyCache);for(const He of Xe){const We=He.map(Vn=>this._layers[Vn.id]),kt=We[0];if(kt.visibility==="none")continue;const ot=kt.source||"";let Et=this.familiesBySource[ot];Et||(Et=this.familiesBySource[ot]={});const on=kt.sourceLayer||"_geojsonTileLayer";let Yt=Et[on];Yt||(Yt=Et[on]=[]),Yt.push(We)}}}const P=1*i.fc;class E{constructor(de){const _e={},Ie=[];for(const kt in de){const ot=de[kt],Et=_e[kt]={};for(const on in ot.glyphs){const Yt=ot.glyphs[+on];if(!Yt||Yt.bitmap.width===0||Yt.bitmap.height===0)continue;const Vn=Yt.metrics.localGlyph?P:1,ar={x:0,y:0,w:Yt.bitmap.width+2*Vn,h:Yt.bitmap.height+2*Vn};Ie.push(ar),Et[on]=ar}}const{w:Xe,h:He}=i.G(Ie),We=new i.fb({width:Xe||1,height:He||1});for(const kt in de){const ot=de[kt];for(const Et in ot.glyphs){const on=ot.glyphs[+Et];if(!on||on.bitmap.width===0||on.bitmap.height===0)continue;const Yt=_e[kt][Et],Vn=on.metrics.localGlyph?P:1;i.fb.copy(on.bitmap,We,{x:0,y:0},{x:Yt.x+Vn,y:Yt.y+Vn},on.bitmap)}}this.image=We,this.positions=_e}}i.fa(E,"GlyphAtlas");class j{constructor(de){this.tileID=new i.aO(de.tileID.overscaledZ,de.tileID.wrap,de.tileID.canonical.z,de.tileID.canonical.x,de.tileID.canonical.y),this.tileZoom=de.tileZoom,this.uid=de.uid,this.zoom=de.zoom,this.lut=de.lut,this.canonical=de.tileID.canonical,this.pixelRatio=de.pixelRatio,this.tileSize=de.tileSize,this.source=de.source,this.scope=de.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=de.showCollisionBoxes,this.collectResourceTiming=!!de.request&&de.request.collectResourceTiming,this.promoteId=de.promoteId,this.isSymbolTile=de.isSymbolTile,this.tileTransform=i.aZ(de.tileID.canonical,de.projection),this.projection=de.projection,this.worldview=de.worldview,this.localizableLayerIds=de.localizableLayerIds,this.brightness=de.brightness,this.extraShadowCaster=!!de.extraShadowCaster,this.tessellationStep=de.tessellationStep,this.scaleFactor=de.scaleFactor,this.worldview=de.worldview}parse(de,_e,Ie,Xe,He,We){this.status="parsing",this.data=de,this.collisionBoxArray=new i.b3;const kt=new i.fd(Object.keys(de.layers).sort()),ot=new i.fe(this.tileID,this.promoteId);ot.bucketLayerIDs=[];const Et={},on=new i.ff(256,256),Yt={featureIndex:ot,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:on,availableImages:Ie,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},Vn=[],ar=_e.familiesBySource[this.source];for(const Gr in ar){const Fr=de.layers[Gr];if(!Fr)continue;let pi=!1,Vi=!1,ai=!1;for(const Wi of ar[Gr])Wi[0].type==="symbol"?pi=!0:Vi=!0,Wi[0].is3D()&&Wi[0].type!=="model"&&(ai=!0);if(this.extraShadowCaster&&!ai||this.isSymbolTile===!0&&!pi||this.isSymbolTile===!1&&!Vi)continue;Fr.version===1&&i.w(`Vector tile source "${this.source}" layer "${Gr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Js=kt.encode(Gr),ha=[];let xa=!1;for(let Wi=0,bi=0;Wi<Fr.length;Wi++){const Ns=Fr.feature(Wi),zs=ot.getId(Ns,Gr);if(this.localizableLayerIds&&this.localizableLayerIds.has(Gr)){const as=Ns.properties?Ns.properties.worldview:null;if(this.worldview&&typeof as=="string")if(as==="all")Ns.properties.$localized=!0;else{if(!as.split(",").includes(this.worldview))continue;Ns.properties.$localized=!0,Ns.properties.worldview=this.worldview}}!xa&&Ns.properties&&Ns.properties.hasOwnProperty(i.fg)&&(xa=!0),ha.push({feature:Ns,id:zs,index:bi,sourceLayerIndex:Js}),bi++}xa&&!Yt.elevationFeatures&&de.layers.hasOwnProperty(i.fh)&&(Yt.elevationFeatures=i.fi.parseFrom(de.layers[i.fh],this.canonical));for(const Wi of ar[Gr]){const bi=Wi[0];if(this.extraShadowCaster&&(!bi.is3D()||bi.type==="model")||this.isSymbolTile!==void 0&&bi.type==="symbol"!==this.isSymbolTile||bi.minzoom&&this.zoom<Math.floor(bi.minzoom)||bi.maxzoom&&this.zoom>=bi.maxzoom||bi.visibility==="none")continue;D(Wi,this.zoom,Yt.brightness,Ie,this.worldview);const Ns=Et[bi.id]=bi.createBucket({index:ot.bucketLayerIDs.length,layers:Wi,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Js,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:Xe,worldview:this.worldview});ot.bucketLayerIDs.push(Wi.map(as=>i.B(as.id,as.scope)));let zs=Ns.prepare?Ns.prepare():null;zs!=null?(zs=zs.then(()=>Ns.populate(ha,Yt,this.tileID.canonical,this.tileTransform)),Vn.push(zs)):Ns.populate(ha,Yt,this.tileID.canonical,this.tileTransform)}}const vr=()=>{let Gr,Fr,pi,Vi,ai,Js;on.trim();const ha={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},xa=()=>{if(Gr)return this.status="done",We(Gr);if(this.extraShadowCaster)this.status="done",We(null,{buckets:Object.values(Et).filter(bi=>!bi.isEmpty()),featureIndex:ot,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Yt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Fr&&pi&&Vi){const bi=new E(Fr),Ns=new Map;for(const[Ja,Vo]of pi.entries()){const{imagePosition:Cl}=i.fl(Ja,Vo,i.fm);Ns.set(Ja,Cl)}const zs={};for(const Ja in Et){const Vo=Et[Ja];Vo instanceof i.b4&&(D(Vo.layers,this.zoom,Yt.brightness,Ie,this.worldview),zs[Ja]=i.fn(Vo,Fr,bi.positions,pi,Ns,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,ai,this.worldview))}const as={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(He,pi,ai,()=>{as.iconsPending=!1,Wi(zs,bi,as)}),this.rasterizeIfNeeded(He,Vi,Js,()=>{as.patternsPending=!1,Wi(zs,bi,as)})}},Wi=(bi,Ns,zs,as)=>{if(zs.iconsPending||zs.patternsPending)return;const Ja=new i.fo(pi,Vi,this.lut);for(const Vo in Et){const Cl=Et[Vo];if(Vo in bi)i.fp(Cl,bi[Vo],this.showCollisionBoxes,Ie,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,pi,Ja);else if(Cl.hasPattern&&(Cl instanceof i.ba||Cl instanceof i.bb||Cl instanceof i.e7)){D(Cl.layers,this.zoom,Yt.brightness,Ie,this.worldview);const ac=Object.fromEntries(Ja.patternPositions);Cl.addFeatures(Yt,this.tileID.canonical,ac,Ie,this.tileTransform,this.brightness)}}this.status="done",We(null,{buckets:Object.values(Et).filter(Vo=>!Vo.isEmpty()),featureIndex:ot,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ns.image,lineAtlas:on,imageAtlas:Ja,brightness:Yt.brightness})};if(!this.extraShadowCaster){const bi=i.fj(Yt.glyphDependencies,as=>Object.keys(as).map(Number));Object.keys(bi).length?He.send("getGlyphs",{uid:this.uid,stacks:bi},(as,Ja)=>{Gr||(Gr=as,Fr=Ja,xa())},void 0,!1,ha):Fr={};const Ns=Array.from(Yt.iconDependencies.keys()).map(as=>i.I.parse(as));Ns.length?He.send("getImages",{images:Ns,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(as,Ja)=>{Gr||(Gr=as,pi=new Map,ai=this.updateImageMapAndGetImageTaskQueue(pi,Ja,Yt.iconDependencies),xa())},void 0,!1,ha):(pi=new Map,ai=new Map);const zs=Array.from(Yt.patternDependencies.keys()).map(as=>i.I.parse(as));zs.length?He.send("getImages",{images:zs,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(as,Ja)=>{Gr||(Gr=as,Vi=new Map,Js=this.updateImageMapAndGetImageTaskQueue(Vi,Ja,Yt.patternDependencies),xa())},void 0,!1,ha):(Vi=new Map,Js=new Map)}if(Yt.elevationFeatures&&Yt.elevationFeatures.length>0){const bi=[];for(const zs of Object.values(Et))if(zs instanceof i.bb){const as=zs.getUnevaluatedPortalGraph();as&&bi.push(as)}const Ns=i.fk.evaluate(bi);for(const zs of Object.values(Et))if(zs instanceof i.bb){const as=de.layers[kt.decode(zs.sourceLayerIndex)];zs.setEvaluatedPortalGraph(Ns,as,this.tileID.canonical,Yt.availableImages,Yt.brightness)}}xa()};Vn.length>0?Promise.allSettled(Vn).then(vr).catch(We):vr()}rasterizeIfNeeded(de,_e,Ie,Xe){Array.from(_e.values()).some(He=>He.usvg)?this.rasterize(de,_e,Ie,Xe):Xe()}updateImageMapAndGetImageTaskQueue(de,_e,Ie){const Xe=new Map;for(const He of _e.keys()){const We=Ie.get(He)||[];for(const kt of We){const ot=kt.toString(),Et=_e.get(kt.id.toString());Et.usvg?Xe.has(ot)||(Xe.set(ot,kt),de.set(ot,Object.assign({},Et))):de.set(ot,Et)}}return Xe}rasterize(de,_e,Ie,Xe){this.rasterizeTask=de.send("rasterizeImages",{scope:this.scope,tasks:Ie},(He,We)=>{if(!He)for(const[kt,ot]of We.entries()){const Et=Object.assign(_e.get(kt),{data:ot});_e.set(kt,Et)}Xe()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function D(lt,de,_e,Ie,Xe){const He=new i.ac(de,{brightness:_e,worldview:Xe});for(const We of lt)We.recalculate(He,Ie)}class B extends i.E{constructor(de,_e,Ie,Xe,He,We,kt){super(),this.actor=de,this.layerIndex=_e,this.availableImages=Ie,this.availableModels=Xe,this.loadVectorData=We||i.aL,this.loading={},this.loaded={},this.deduped=new i.aK(de.scheduler),this.isSpriteLoaded=He,this.scheduler=de.scheduler,this.brightness=kt}loadTile(de,_e){const Ie=de.uid,Xe=de&&de.request,He=Xe&&Xe.collectResourceTiming,We=this.loading[Ie]=new j(de);We.abort=this.loadVectorData(de,(kt,ot)=>{const Et=!this.loading[Ie];if(delete this.loading[Ie],We.cancelRasterize(),Et||kt||!ot)return We.status="done",Et||(this.loaded[Ie]=We),_e(kt);const on=ot.rawData,Yt={};ot.expires&&(Yt.expires=ot.expires),ot.cacheControl&&(Yt.cacheControl=ot.cacheControl),We.vectorTile=ot.vectorTile||new i.fq(new i.bt(on));const Vn=()=>{We.parse(We.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,(ar,vr)=>{if(ar||!vr)return _e(ar);const Gr={};if(He){const Fr=y(Xe);Fr.length>0&&(Gr.resourceTiming=JSON.parse(JSON.stringify(Fr)))}_e(null,Object.assign({rawTileData:on.slice(0)},vr,Yt,Gr))})};this.isSpriteLoaded?Vn():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Vn,{type:"parseTile",isSymbolTile:de.isSymbolTile,zoom:de.tileZoom}):Vn()}),this.loaded=this.loaded||{},this.loaded[Ie]=We})}reloadTile(de,_e){const Ie=this.loaded,Xe=de.uid;if(Ie&&Ie[Xe]){const He=Ie[Xe];He.scaleFactor=de.scaleFactor,He.showCollisionBoxes=de.showCollisionBoxes,He.projection=de.projection,He.brightness=de.brightness,He.tileTransform=i.aZ(de.tileID.canonical,de.projection),He.extraShadowCaster=de.extraShadowCaster,He.lut=de.lut,He.worldview=de.worldview;const We=(kt,ot)=>{const Et=He.reloadCallback;Et&&(delete He.reloadCallback,He.parse(He.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,Et)),_e(kt,ot)};He.status==="parsing"?He.reloadCallback=We:He.status==="done"&&(He.vectorTile?He.parse(He.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,We):We())}else _e(null,void 0)}abortTile(de,_e){const Ie=de.uid,Xe=this.loading[Ie];Xe&&(Xe.abort&&Xe.abort(),delete this.loading[Ie]),_e()}removeTile(de,_e){const Ie=this.loaded,Xe=de.uid;Ie&&Ie[Xe]&&delete Ie[Xe],_e()}}class F{loadTile(de,_e){const{uid:Ie,encoding:Xe,rawImageData:He,padding:We}=de,kt=ImageBitmap&&He instanceof ImageBitmap?this.getImageData(He,We):He;_e(null,new i.fr(Ie,kt,Xe,We<1))}reloadTile(de,_e){_e(null,null)}abortTile(de,_e){_e()}removeTile(de,_e){_e()}getImageData(de,_e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(de.width,de.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=de.width,this.offscreenCanvas.height=de.height,this.offscreenCanvasContext.drawImage(de,0,0,de.width,de.height);const Ie=this.offscreenCanvasContext.getImageData(-_e,-_e,de.width+2*_e,de.height+2*_e);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ie}}i.bs.setPbf(i.bt);class ${constructor(de){this._mrt=new i.bs(de.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=de.uid,this.tileID=de.tileID,this.source=de.source}parse(de,_e){const Ie=this._mrt;this.status="parsing",this._entireBuffer=de;try{Ie.parseHeader(de),this._isHeaderLoaded=!0;const Xe=[];for(const He in Ie.layers){const We=Ie.getLayer(He),kt=We.getDataRange(We.getBandList()),ot=Ie.createDecodingTask(kt),Et=de.slice(kt.firstByte,kt.lastByte+1),on=i.bs.performDecoding(Et,ot).then(Yt=>ot.complete(null,Yt)).catch(Yt=>ot.complete(Yt,null));Xe.push(on)}Promise.allSettled(Xe).then(()=>_e(null,Ie)).catch(He=>_e(He))}catch(Xe){_e(Xe)}}}class H{constructor(de){this.actor=de,this.loading={},this.loaded={}}loadTile(de,_e){const Ie=de.uid,Xe=de.request,He=this.loading[Ie]=new $(de),{cancel:We}=i.bu(Xe,(kt,ot,Et,on)=>{const Yt=!this.loading[Ie];if(delete this.loading[Ie],Yt||kt||!ot)return He.status="done",Yt||(this.loaded[Ie]=He),_e(kt);He.parse(ot,(Vn,ar)=>{if(Vn||!ar)return _e(Vn);_e(null,ar,Et,on)}),this.loaded[Ie]=He});He.abort=We}reloadTile(de,_e){_e(null,void 0)}abortTile(de,_e){const Ie=de.uid,Xe=this.loading[Ie];Xe&&(Xe.abort&&Xe.abort(),delete this.loading[Ie]),_e()}removeTile(de,_e){const Ie=de.uid;this.loaded[Ie]&&delete this.loaded[Ie],_e()}decodeRasterArray(de,_e){i.bs.performDecoding(de.buffer,de.task).then(Ie=>_e(null,Ie)).catch(Ie=>_e(Ie))}}const J=i.fs.prototype.toGeoJSON;class ee{constructor(de){this._feature=de,this.extent=i.al,this.type=de.type,this.properties=de.tags,"id"in de&&!isNaN(de.id)&&(this.id=parseInt(de.id,10))}loadGeometry(){if(this._feature.type===1){const de=[];for(const _e of this._feature.geometry)de.push([new i.P(_e[0],_e[1])]);return de}{const de=[];for(const _e of this._feature.geometry){const Ie=[];for(const Xe of _e)Ie.push(new i.P(Xe[0],Xe[1]));de.push(Ie)}return de}}toGeoJSON(de,_e,Ie){return J.call(this,de,_e,Ie)}}class Q{constructor(de,_e){this.name=de,this.extent=i.al,this.length=_e.length,this._jsonFeatures=_e}feature(de){return new ee(this._jsonFeatures[de])}}class ne{constructor(de){this.layers={},this.extent=i.al;for(const _e of Object.keys(de))this.layers[_e]=new Q(_e,de[_e])}}const pe=64/4096,he=128;class we{constructor(){this.features=new Map}clear(){this.features.clear()}load(de=[],_e){for(const Ie of de){const Xe=Ie.id;if(Xe==null)continue;let He=this.features.get(Xe);He&&this.updateCache(He,_e),Ie.geometry?(He=ge(Ie),this.updateCache(He,_e),this.features.set(Xe,He)):this.features.delete(Xe),this.updateCache(He,_e)}}updateCache(de,_e){for(const{canonical:Ie,uid:Xe}of Object.values(_e)){const{z:He,x:We,y:kt}=Ie;fe(de,Math.pow(2,He),We,kt)&&delete _e[Xe]}}getTile(de,_e,Ie){const Xe=Math.pow(2,de),He=[];for(const We of this.features.values())fe(We,Xe,_e,Ie)&&He.push(Qe(We,Xe,_e,Ie));return{features:He}}getFeatures(){return[...this.features.values()]}}function fe({minX:lt,minY:de,maxX:_e,maxY:Ie},Xe,He,We){return lt<(He+1+pe)/Xe&&de<(We+1+pe)/Xe&&_e>(He-pe)/Xe&&Ie>(We-pe)/Xe}function ge(lt){const{id:de,geometry:_e,properties:Ie}=lt;if(!_e)return;if(_e.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Xe,coordinates:He}=_e,We={id:de,type:1,geometry:[],tags:Ie,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},kt=We.geometry;if(Xe==="Point")Ce(He,kt,We);else if(Xe==="MultiPoint")for(const ot of He)Ce(ot,kt,We);else if(Xe==="LineString")We.type=2,xe(He,kt,We);else if(Xe==="MultiLineString")We.type=2,Re(He,kt,We);else if(Xe==="Polygon")We.type=3,Re(He,kt,We,!0);else{if(Xe!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");We.type=3;for(const ot of He)Re(ot,kt,We,!0)}return We}function Ce([lt,de],_e,Ie){const Xe=i.aF(lt);let He=i.aJ(de);He=He<0?0:He>1?1:He,_e.push(Xe,He),Ie.minX=Math.min(Ie.minX,Xe),Ie.minY=Math.min(Ie.minY,He),Ie.maxX=Math.max(Ie.maxX,Xe),Ie.maxY=Math.max(Ie.maxY,He)}function xe(lt,de,_e,Ie=!1,Xe=!1){const He=[];for(const We of lt)Ce(We,He,_e);de.push(He),Ie&&function(We,kt){let ot=0;for(let Et=0,on=We.length,Yt=on-2;Et<on;Yt=Et,Et+=2)ot+=(We[Et]-We[Yt])*(We[Et+1]+We[Yt+1]);if(ot>0===kt)for(let Et=0,on=We.length;Et<on/2;Et+=2){const Yt=We[Et],Vn=We[Et+1];We[Et]=We[on-2-Et],We[Et+1]=We[on-1-Et],We[on-2-Et]=Yt,We[on-1-Et]=Vn}}(He,Xe)}function Re(lt,de,_e,Ie=!1){for(let Xe=0;Xe<lt.length;Xe++)xe(lt[Xe],de,_e,Ie,Xe===0)}function Qe(lt,de,_e,Ie){const{id:Xe,type:He,geometry:We,tags:kt}=lt,ot=[];if(He===1)(function(Et,on,Yt,Vn,ar){for(let vr=0;vr<Et.length;vr+=2){const Gr=Math.round(i.al*(Et[vr+0]*on-Yt)),Fr=Math.round(i.al*(Et[vr+1]*on-Vn));ar.push([Gr,Fr])}})(We,de,_e,Ie,ot);else for(const Et of We)et(Et,de,_e,Ie,ot);return{id:Xe,type:He,geometry:ot,tags:kt}}function et(lt,de,_e,Ie,Xe){const He=-he,We=i.al+he;let kt;for(let ot=0;ot<lt.length-2;ot+=2){let Et=Math.round(i.al*(lt[ot+0]*de-_e)),on=Math.round(i.al*(lt[ot+1]*de-Ie)),Yt=Math.round(i.al*(lt[ot+2]*de-_e)),Vn=Math.round(i.al*(lt[ot+3]*de-Ie));const ar=Yt-Et,vr=Vn-on;Et<He&&Yt<He||(Et<He?(on+=Math.round(vr*((He-Et)/ar)),Et=He):Yt<He&&(Vn=on+Math.round(vr*((He-Et)/ar)),Yt=He),on<He&&Vn<He||(on<He?(Et+=Math.round(ar*((He-on)/vr)),on=He):Vn<He&&(Yt=Et+Math.round(ar*((He-on)/vr)),Vn=He),Et>=We&&Yt>=We||(Et>=We?(on+=Math.round(vr*((We-Et)/ar)),Et=We):Yt>=We&&(Vn=on+Math.round(vr*((We-Et)/ar)),Yt=We),on>=We&&Vn>=We||(on>=We?(Et+=Math.round(ar*((We-on)/vr)),on=We):Vn>=We&&(Yt=Et+Math.round(ar*((We-on)/vr)),Vn=We),kt&&Et===kt[kt.length-1][0]&&on===kt[kt.length-1][1]||(kt=[[Et,on]],Xe.push(kt)),kt.push([Yt,Vn])))))}}function je({name:lt,features:de},_e){_e.writeStringField(1,lt),_e.writeVarintField(5,i.al);const Ie=new Map,Xe=new Map,He={keys:Ie,values:Xe,feature:null};for(const We of de)He.feature=We,_e.writeMessage(2,De,He);for(const We of Ie.keys())_e.writeStringField(3,We);for(const We of Xe.keys())_e.writeMessage(4,nt,We)}function De(lt,de){const _e=lt.feature;_e.id!==void 0&&Number.isSafeInteger(+_e.id)&&de.writeVarintField(1,+_e.id),_e.tags&&de.writeMessage(2,Ct,lt),de.writeVarintField(3,_e.type),de.writeMessage(4,Ye,_e)}function Ct({keys:lt,values:de,feature:_e},Ie){for(const Xe of Object.keys(_e.tags)){let He=_e.tags[Xe];if(He===null)continue;let We=lt.get(Xe);We===void 0&&(We=lt.size,lt.set(Xe,We)),Ie.writeVarint(We);const kt=typeof He;kt!=="string"&&kt!=="boolean"&&kt!=="number"&&(He=JSON.stringify(He));let ot=de.get(He);ot===void 0&&(ot=de.size,de.set(He,ot)),Ie.writeVarint(ot)}}function xt(lt,de){return(de<<3)+(7&lt)}function me(lt){return lt<<1^lt>>31}function Ye(lt,de){const{geometry:_e,type:Ie}=lt;let Xe=0,He=0;if(Ie===1){de.writeVarint(xt(1,_e.length));for(const We of _e){const kt=We[0]-Xe,ot=We[1]-He;de.writeVarint(me(kt)),de.writeVarint(me(ot)),Xe+=kt,He+=ot}}else for(const We of _e){de.writeVarint(xt(1,1));const kt=We.length-(Ie===3?1:0);for(let ot=0;ot<kt;ot++){ot===1&&de.writeVarint(xt(2,kt-1));const Et=We[ot][0]-Xe,on=We[ot][1]-He;de.writeVarint(me(Et)),de.writeVarint(me(on)),Xe+=Et,He+=on}Ie===3&&de.writeVarint(xt(7,1))}}function nt(lt,de){const _e=typeof lt;_e==="string"?de.writeStringField(1,lt):_e==="boolean"?de.writeBooleanField(7,lt):_e==="number"&&(lt%1!=0?de.writeDoubleField(3,lt):lt<0?de.writeSVarintField(6,lt):de.writeVarintField(5,lt))}const vt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:lt=>lt},gt=Math.fround||(dt=new Float32Array(1),lt=>(dt[0]=+lt,dt[0]));var dt;const At=3,mt=5,Pt=6;class Ht{constructor(de){this.options=Object.assign(Object.create(vt),de),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(de){const{log:_e,minZoom:Ie,maxZoom:Xe}=this.options;_e&&console.time("total time");const He=`prepare ${de.length} points`;_e&&console.time(He),this.points=de;const We=[];for(let ot=0;ot<de.length;ot++){const Et=de[ot];if(!Et.geometry)continue;const[on,Yt]=Et.geometry.coordinates,Vn=gt(Kt(on)),ar=gt(st(Yt));We.push(Vn,ar,1/0,ot,-1,1),this.options.reduce&&We.push(0)}let kt=this.trees[Xe+1]=this._createTree(We);_e&&console.timeEnd(He);for(let ot=Xe;ot>=Ie;ot--){const Et=+Date.now();kt=this.trees[ot]=this._createTree(this._cluster(kt,ot)),_e&&console.log("z%d: %d clusters in %dms",ot,kt.numItems,+Date.now()-Et)}return _e&&console.timeEnd("total time"),this}getClusters(de,_e){let Ie=((de[0]+180)%360+360)%360-180;const Xe=Math.max(-90,Math.min(90,de[1]));let He=de[2]===180?180:((de[2]+180)%360+360)%360-180;const We=Math.max(-90,Math.min(90,de[3]));if(de[2]-de[0]>=360)Ie=-180,He=180;else if(Ie>He){const Yt=this.getClusters([Ie,Xe,180,We],_e),Vn=this.getClusters([-180,Xe,He,We],_e);return Yt.concat(Vn)}const kt=this.trees[this._limitZoom(_e)],ot=kt.range(Kt(Ie),st(We),Kt(He),st(Xe)),Et=kt.data,on=[];for(const Yt of ot){const Vn=this.stride*Yt;on.push(Et[Vn+mt]>1?Ot(Et,Vn,this.clusterProps):this.points[Et[Vn+At]])}return on}getChildren(de){const _e=this._getOriginId(de),Ie=this._getOriginZoom(de),Xe="No cluster with the specified id.",He=this.trees[Ie];if(!He)throw new Error(Xe);const We=He.data;if(_e*this.stride>=We.length)throw new Error(Xe);const kt=this.options.radius/(this.options.extent*Math.pow(2,Ie-1)),ot=He.within(We[_e*this.stride],We[_e*this.stride+1],kt),Et=[];for(const on of ot){const Yt=on*this.stride;We[Yt+4]===de&&Et.push(We[Yt+mt]>1?Ot(We,Yt,this.clusterProps):this.points[We[Yt+At]])}if(Et.length===0)throw new Error(Xe);return Et}getLeaves(de,_e,Ie){const Xe=[];return this._appendLeaves(Xe,de,_e=_e||10,Ie=Ie||0,0),Xe}getTile(de,_e,Ie){const Xe=this.trees[this._limitZoom(de)],He=Math.pow(2,de),{extent:We,radius:kt}=this.options,ot=kt/We,Et=(Ie-ot)/He,on=(Ie+1+ot)/He,Yt={features:[]};return this._addTileFeatures(Xe.range((_e-ot)/He,Et,(_e+1+ot)/He,on),Xe.data,_e,Ie,He,Yt),_e===0&&this._addTileFeatures(Xe.range(1-ot/He,Et,1,on),Xe.data,He,Ie,He,Yt),_e===He-1&&this._addTileFeatures(Xe.range(0,Et,ot/He,on),Xe.data,-1,Ie,He,Yt),Yt.features.length?Yt:null}getClusterExpansionZoom(de){let _e=this._getOriginZoom(de)-1;for(;_e<=this.options.maxZoom;){const Ie=this.getChildren(de);if(_e++,Ie.length!==1)break;de=Ie[0].properties.cluster_id}return _e}_appendLeaves(de,_e,Ie,Xe,He){const We=this.getChildren(_e);for(const kt of We){const ot=kt.properties;if(ot&&ot.cluster?He+ot.point_count<=Xe?He+=ot.point_count:He=this._appendLeaves(de,ot.cluster_id,Ie,Xe,He):He<Xe?He++:de.push(kt),de.length===Ie)break}return He}_createTree(de){const _e=new i.c3(de.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ie=0;Ie<de.length;Ie+=this.stride)_e.add(de[Ie],de[Ie+1]);return _e.finish(),_e.data=de,_e}_addTileFeatures(de,_e,Ie,Xe,He,We){for(const kt of de){const ot=kt*this.stride,Et=_e[ot+mt]>1;let on,Yt,Vn;if(Et)on=Un(_e,ot,this.clusterProps),Yt=_e[ot],Vn=_e[ot+1];else{const Gr=this.points[_e[ot+At]];on=Gr.properties;const[Fr,pi]=Gr.geometry.coordinates;Yt=Kt(Fr),Vn=st(pi)}const ar={type:1,geometry:[[Math.round(this.options.extent*(Yt*He-Ie)),Math.round(this.options.extent*(Vn*He-Xe))]],tags:on};let vr;vr=Et||this.options.generateId?_e[ot+At]:this.points[_e[ot+At]].id,vr!==void 0&&(ar.id=vr),We.features.push(ar)}}_limitZoom(de){return Math.max(this.options.minZoom,Math.min(Math.floor(+de),this.options.maxZoom+1))}_cluster(de,_e){const{radius:Ie,extent:Xe,reduce:He,minPoints:We}=this.options,kt=Ie/(Xe*Math.pow(2,_e)),ot=de.data,Et=[],on=this.stride;for(let Yt=0;Yt<ot.length;Yt+=on){if(ot[Yt+2]<=_e)continue;ot[Yt+2]=_e;const Vn=ot[Yt],ar=ot[Yt+1],vr=de.within(ot[Yt],ot[Yt+1],kt),Gr=ot[Yt+mt];let Fr=Gr;for(const pi of vr){const Vi=pi*on;ot[Vi+2]>_e&&(Fr+=ot[Vi+mt])}if(Fr>Gr&&Fr>=We){let pi,Vi=Vn*Gr,ai=ar*Gr,Js=-1;const ha=(Yt/on<<5)+(_e+1)+this.points.length;for(const xa of vr){const Wi=xa*on;if(ot[Wi+2]<=_e)continue;ot[Wi+2]=_e;const bi=ot[Wi+mt];Vi+=ot[Wi]*bi,ai+=ot[Wi+1]*bi,ot[Wi+4]=ha,He&&(pi||(pi=this._map(ot,Yt,!0),Js=this.clusterProps.length,this.clusterProps.push(pi)),He(pi,this._map(ot,Wi)))}ot[Yt+4]=ha,Et.push(Vi/Fr,ai/Fr,1/0,ha,-1,Fr),He&&Et.push(Js)}else{for(let pi=0;pi<on;pi++)Et.push(ot[Yt+pi]);if(Fr>1)for(const pi of vr){const Vi=pi*on;if(!(ot[Vi+2]<=_e)){ot[Vi+2]=_e;for(let ai=0;ai<on;ai++)Et.push(ot[Vi+ai])}}}}return Et}_getOriginId(de){return de-this.points.length>>5}_getOriginZoom(de){return(de-this.points.length)%32}_map(de,_e,Ie){if(de[_e+mt]>1){const We=this.clusterProps[de[_e+Pt]];return Ie?Object.assign({},We):We}const Xe=this.points[de[_e+At]].properties,He=this.options.map(Xe);return Ie&&He===Xe?Object.assign({},He):He}}function Ot(lt,de,_e){return{type:"Feature",id:lt[de+At],properties:Un(lt,de,_e),geometry:{type:"Point",coordinates:[(Ie=lt[de],360*(Ie-.5)),Dr(lt[de+1])]}};var Ie}function Un(lt,de,_e){const Ie=lt[de+mt],Xe=Ie>=1e4?`${Math.round(Ie/1e3)}k`:Ie>=1e3?Math.round(Ie/100)/10+"k":Ie,He=lt[de+Pt],We=He===-1?{}:Object.assign({},_e[He]);return Object.assign(We,{cluster:!0,cluster_id:lt[de+At],point_count:Ie,point_count_abbreviated:Xe})}function Kt(lt){return lt/360+.5}function st(lt){const de=Math.sin(lt*Math.PI/180),_e=.5-.25*Math.log((1+de)/(1-de))/Math.PI;return _e<0?0:_e>1?1:_e}function Dr(lt){const de=(180-360*lt)*Math.PI/180;return 360*Math.atan(Math.exp(de))/Math.PI-90}function Or(lt,de,_e,Ie){let Xe=Ie;const He=de+(_e-de>>1);let We,kt=_e-de;const ot=lt[de],Et=lt[de+1],on=lt[_e],Yt=lt[_e+1];for(let Vn=de+3;Vn<_e;Vn+=3){const ar=Br(lt[Vn],lt[Vn+1],ot,Et,on,Yt);if(ar>Xe)We=Vn,Xe=ar;else if(ar===Xe){const vr=Math.abs(Vn-He);vr<kt&&(We=Vn,kt=vr)}}Xe>Ie&&(We-de>3&&Or(lt,de,We,Ie),lt[We+2]=Xe,_e-We>3&&Or(lt,We,_e,Ie))}function Br(lt,de,_e,Ie,Xe,He){let We=Xe-_e,kt=He-Ie;if(We!==0||kt!==0){const ot=((lt-_e)*We+(de-Ie)*kt)/(We*We+kt*kt);ot>1?(_e=Xe,Ie=He):ot>0&&(_e+=We*ot,Ie+=kt*ot)}return We=lt-_e,kt=de-Ie,We*We+kt*kt}function On(lt,de,_e,Ie){const Xe={id:lt??null,type:de,geometry:_e,tags:Ie,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(de==="Point"||de==="MultiPoint"||de==="LineString")ht(Xe,_e);else if(de==="Polygon")ht(Xe,_e[0]);else if(de==="MultiLineString")for(const He of _e)ht(Xe,He);else if(de==="MultiPolygon")for(const He of _e)ht(Xe,He[0]);return Xe}function ht(lt,de){for(let _e=0;_e<de.length;_e+=3)lt.minX=Math.min(lt.minX,de[_e]),lt.minY=Math.min(lt.minY,de[_e+1]),lt.maxX=Math.max(lt.maxX,de[_e]),lt.maxY=Math.max(lt.maxY,de[_e+1])}function wt(lt,de,_e,Ie){if(!de.geometry)return;const Xe=de.geometry.coordinates;if(Xe&&Xe.length===0)return;const He=de.geometry.type,We=Math.pow(_e.tolerance/((1<<_e.maxZoom)*_e.extent),2);let kt=[],ot=de.id;if(_e.promoteId?ot=de.properties[_e.promoteId]:_e.generateId&&(ot=Ie||0),He==="Point")Wt(Xe,kt);else if(He==="MultiPoint")for(const Et of Xe)Wt(Et,kt);else if(He==="LineString")xn(Xe,kt,We,!1);else if(He==="MultiLineString"){if(_e.lineMetrics){for(const Et of Xe)kt=[],xn(Et,kt,We,!1),lt.push(On(ot,"LineString",kt,de.properties));return}Rn(Xe,kt,We,!1)}else if(He==="Polygon")Rn(Xe,kt,We,!0);else{if(He!=="MultiPolygon"){if(He==="GeometryCollection"){for(const Et of de.geometry.geometries)wt(lt,{id:ot,geometry:Et,properties:de.properties},_e,Ie);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Et of Xe){const on=[];Rn(Et,on,We,!0),kt.push(on)}}lt.push(On(ot,He,kt,de.properties))}function Wt(lt,de){de.push(Sn(lt[0]),Mn(lt[1]),0)}function xn(lt,de,_e,Ie){let Xe,He,We=0;for(let ot=0;ot<lt.length;ot++){const Et=Sn(lt[ot][0]),on=Mn(lt[ot][1]);de.push(Et,on,0),ot>0&&(We+=Ie?(Xe*on-Et*He)/2:Math.sqrt(Math.pow(Et-Xe,2)+Math.pow(on-He,2))),Xe=Et,He=on}const kt=de.length-3;de[2]=1,Or(de,0,kt,_e),de[kt+2]=1,de.size=Math.abs(We),de.start=0,de.end=de.size}function Rn(lt,de,_e,Ie){for(let Xe=0;Xe<lt.length;Xe++){const He=[];xn(lt[Xe],He,_e,Ie),de.push(He)}}function Sn(lt){return lt/360+.5}function Mn(lt){const de=Math.sin(lt*Math.PI/180),_e=.5-.25*Math.log((1+de)/(1-de))/Math.PI;return _e<0?0:_e>1?1:_e}function Ar(lt,de,_e,Ie,Xe,He,We,kt){if(Ie/=de,He>=(_e/=de)&&We<Ie)return lt;if(We<_e||He>=Ie)return null;const ot=[];for(const Et of lt){const on=Et.geometry;let Yt=Et.type;const Vn=Xe===0?Et.minX:Et.minY,ar=Xe===0?Et.maxX:Et.maxY;if(Vn>=_e&&ar<Ie){ot.push(Et);continue}if(ar<_e||Vn>=Ie)continue;let vr=[];if(Yt==="Point"||Yt==="MultiPoint")Pr(on,vr,_e,Ie,Xe);else if(Yt==="LineString")wr(on,vr,_e,Ie,Xe,!1,kt.lineMetrics);else if(Yt==="MultiLineString")dr(on,vr,_e,Ie,Xe,!1);else if(Yt==="Polygon")dr(on,vr,_e,Ie,Xe,!0);else if(Yt==="MultiPolygon")for(const Gr of on){const Fr=[];dr(Gr,Fr,_e,Ie,Xe,!0),Fr.length&&vr.push(Fr)}if(vr.length){if(kt.lineMetrics&&Yt==="LineString"){for(const Gr of vr)ot.push(On(Et.id,Yt,Gr,Et.tags));continue}Yt!=="LineString"&&Yt!=="MultiLineString"||(vr.length===1?(Yt="LineString",vr=vr[0]):Yt="MultiLineString"),Yt!=="Point"&&Yt!=="MultiPoint"||(Yt=vr.length===3?"Point":"MultiPoint"),ot.push(On(Et.id,Yt,vr,Et.tags))}}return ot.length?ot:null}function Pr(lt,de,_e,Ie,Xe){for(let He=0;He<lt.length;He+=3){const We=lt[He+Xe];We>=_e&&We<=Ie&&Hi(de,lt[He],lt[He+1],lt[He+2])}}function wr(lt,de,_e,Ie,Xe,He,We){let kt=Qr(lt);const ot=Xe===0?Bi:Cr;let Et,on,Yt=lt.start;for(let Fr=0;Fr<lt.length-3;Fr+=3){const pi=lt[Fr],Vi=lt[Fr+1],ai=lt[Fr+2],Js=lt[Fr+3],ha=lt[Fr+4],xa=Xe===0?pi:Vi,Wi=Xe===0?Js:ha;let bi=!1;We&&(Et=Math.sqrt(Math.pow(pi-Js,2)+Math.pow(Vi-ha,2))),xa<_e?Wi>_e&&(on=ot(kt,pi,Vi,Js,ha,_e),We&&(kt.start=Yt+Et*on)):xa>Ie?Wi<Ie&&(on=ot(kt,pi,Vi,Js,ha,Ie),We&&(kt.start=Yt+Et*on)):Hi(kt,pi,Vi,ai),Wi<_e&&xa>=_e&&(on=ot(kt,pi,Vi,Js,ha,_e),bi=!0),Wi>Ie&&xa<=Ie&&(on=ot(kt,pi,Vi,Js,ha,Ie),bi=!0),!He&&bi&&(We&&(kt.end=Yt+Et*on),de.push(kt),kt=Qr(lt)),We&&(Yt+=Et)}let Vn=lt.length-3;const ar=lt[Vn],vr=lt[Vn+1],Gr=Xe===0?ar:vr;Gr>=_e&&Gr<=Ie&&Hi(kt,ar,vr,lt[Vn+2]),Vn=kt.length-3,He&&Vn>=3&&(kt[Vn]!==kt[0]||kt[Vn+1]!==kt[1])&&Hi(kt,kt[0],kt[1],kt[2]),kt.length&&de.push(kt)}function Qr(lt){const de=[];return de.size=lt.size,de.start=lt.start,de.end=lt.end,de}function dr(lt,de,_e,Ie,Xe,He){for(const We of lt)wr(We,de,_e,Ie,Xe,He,!1)}function Hi(lt,de,_e,Ie){lt.push(de,_e,Ie)}function Bi(lt,de,_e,Ie,Xe,He){const We=(He-de)/(Ie-de);return Hi(lt,He,_e+(Xe-_e)*We,1),We}function Cr(lt,de,_e,Ie,Xe,He){const We=(He-_e)/(Xe-_e);return Hi(lt,de+(Ie-de)*We,He,1),We}function fi(lt,de){const _e=[];for(let Ie=0;Ie<lt.length;Ie++){const Xe=lt[Ie],He=Xe.type;let We;if(He==="Point"||He==="MultiPoint"||He==="LineString")We=Cn(Xe.geometry,de);else if(He==="MultiLineString"||He==="Polygon"){We=[];for(const kt of Xe.geometry)We.push(Cn(kt,de))}else if(He==="MultiPolygon"){We=[];for(const kt of Xe.geometry){const ot=[];for(const Et of kt)ot.push(Cn(Et,de));We.push(ot)}}_e.push(On(Xe.id,He,We,Xe.tags))}return _e}function Cn(lt,de){const _e=[];_e.size=lt.size,lt.start!==void 0&&(_e.start=lt.start,_e.end=lt.end);for(let Ie=0;Ie<lt.length;Ie+=3)_e.push(lt[Ie]+de,lt[Ie+1],lt[Ie+2]);return _e}function bn(lt,de){if(lt.transformed)return lt;const _e=1<<lt.z,Ie=lt.x,Xe=lt.y;for(const He of lt.features){const We=He.geometry,kt=He.type;if(He.geometry=[],kt===1)for(let ot=0;ot<We.length;ot+=2)He.geometry.push(fr(We[ot],We[ot+1],de,_e,Ie,Xe));else for(let ot=0;ot<We.length;ot++){const Et=[];for(let on=0;on<We[ot].length;on+=2)Et.push(fr(We[ot][on],We[ot][on+1],de,_e,Ie,Xe));He.geometry.push(Et)}}return lt.transformed=!0,lt}function fr(lt,de,_e,Ie,Xe,He){return[Math.round(_e*(lt*Ie-Xe)),Math.round(_e*(de*Ie-He))]}function Ur(lt,de,_e,Ie,Xe){const He=de===Xe.maxZoom?0:Xe.tolerance/((1<<de)*Xe.extent),We={features:[],numPoints:0,numSimplified:0,numFeatures:lt.length,source:null,x:_e,y:Ie,z:de,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const kt of lt)Xs(We,kt,He,Xe);return We}function Xs(lt,de,_e,Ie){const Xe=de.geometry,He=de.type,We=[];if(lt.minX=Math.min(lt.minX,de.minX),lt.minY=Math.min(lt.minY,de.minY),lt.maxX=Math.max(lt.maxX,de.maxX),lt.maxY=Math.max(lt.maxY,de.maxY),He==="Point"||He==="MultiPoint")for(let kt=0;kt<Xe.length;kt+=3)We.push(Xe[kt],Xe[kt+1]),lt.numPoints++,lt.numSimplified++;else if(He==="LineString")_a(We,Xe,lt,_e,!1,!1);else if(He==="MultiLineString"||He==="Polygon")for(let kt=0;kt<Xe.length;kt++)_a(We,Xe[kt],lt,_e,He==="Polygon",kt===0);else if(He==="MultiPolygon")for(let kt=0;kt<Xe.length;kt++){const ot=Xe[kt];for(let Et=0;Et<ot.length;Et++)_a(We,ot[Et],lt,_e,!0,Et===0)}if(We.length){let kt=de.tags||null;if(He==="LineString"&&Ie.lineMetrics){kt={};for(const Et in de.tags)kt[Et]=de.tags[Et];kt.mapbox_clip_start=Xe.start/Xe.size,kt.mapbox_clip_end=Xe.end/Xe.size}const ot={geometry:We,type:He==="Polygon"||He==="MultiPolygon"?3:He==="LineString"||He==="MultiLineString"?2:1,tags:kt};de.id!==null&&(ot.id=de.id),lt.features.push(ot)}}function _a(lt,de,_e,Ie,Xe,He){const We=Ie*Ie;if(Ie>0&&de.size<(Xe?We:Ie))return void(_e.numPoints+=de.length/3);const kt=[];for(let ot=0;ot<de.length;ot+=3)(Ie===0||de[ot+2]>We)&&(_e.numSimplified++,kt.push(de[ot],de[ot+1])),_e.numPoints++;Xe&&function(ot,Et){let on=0;for(let Yt=0,Vn=ot.length,ar=Vn-2;Yt<Vn;ar=Yt,Yt+=2)on+=(ot[Yt]-ot[ar])*(ot[Yt+1]+ot[ar+1]);if(on>0===Et)for(let Yt=0,Vn=ot.length;Yt<Vn/2;Yt+=2){const ar=ot[Yt],vr=ot[Yt+1];ot[Yt]=ot[Vn-2-Yt],ot[Yt+1]=ot[Vn-1-Yt],ot[Vn-2-Yt]=ar,ot[Vn-1-Yt]=vr}}(kt,He),lt.push(kt)}const ts={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class _i{constructor(de,_e){const Ie=(_e=this.options=function(He,We){for(const kt in We)He[kt]=We[kt];return He}(Object.create(ts),_e)).debug;if(Ie&&console.time("preprocess data"),_e.maxZoom<0||_e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(_e.promoteId&&_e.generateId)throw new Error("promoteId and generateId cannot be used together.");let Xe=function(He,We){const kt=[];if(He.type==="FeatureCollection")for(let ot=0;ot<He.features.length;ot++)wt(kt,He.features[ot],We,ot);else wt(kt,He.type==="Feature"?He:{geometry:He},We);return kt}(de,_e);this.tiles={},this.tileCoords=[],Ie&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",_e.indexMaxZoom,_e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Xe=function(He,We){const kt=We.buffer/We.extent;let ot=He;const Et=Ar(He,1,-1-kt,kt,0,-1,2,We),on=Ar(He,1,1-kt,2+kt,0,-1,2,We);return(Et||on)&&(ot=Ar(He,1,-kt,1+kt,0,-1,2,We)||[],Et&&(ot=fi(Et,1).concat(ot)),on&&(ot=ot.concat(fi(on,-1)))),ot}(Xe,_e),Xe.length&&this.splitTile(Xe,0,0,0),Ie&&(Xe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(de,_e,Ie,Xe,He,We,kt){const ot=[de,_e,Ie,Xe],Et=this.options,on=Et.debug;for(;ot.length;){Xe=ot.pop(),Ie=ot.pop(),_e=ot.pop(),de=ot.pop();const Yt=1<<_e,Vn=xs(_e,Ie,Xe);let ar=this.tiles[Vn];if(!ar&&(on>1&&console.time("creation"),ar=this.tiles[Vn]=Ur(de,_e,Ie,Xe,Et),this.tileCoords.push({z:_e,x:Ie,y:Xe}),on)){on>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",_e,Ie,Xe,ar.numFeatures,ar.numPoints,ar.numSimplified),console.timeEnd("creation"));const bi=`z${_e}`;this.stats[bi]=(this.stats[bi]||0)+1,this.total++}if(ar.source=de,He==null){if(_e===Et.indexMaxZoom||ar.numPoints<=Et.indexMaxPoints)continue}else{if(_e===Et.maxZoom||_e===He)continue;if(He!=null){const bi=He-_e;if(Ie!==We>>bi||Xe!==kt>>bi)continue}}if(ar.source=null,de.length===0)continue;on>1&&console.time("clipping");const vr=.5*Et.buffer/Et.extent,Gr=.5-vr,Fr=.5+vr,pi=1+vr;let Vi=null,ai=null,Js=null,ha=null,xa=Ar(de,Yt,Ie-vr,Ie+Fr,0,ar.minX,ar.maxX,Et),Wi=Ar(de,Yt,Ie+Gr,Ie+pi,0,ar.minX,ar.maxX,Et);de=null,xa&&(Vi=Ar(xa,Yt,Xe-vr,Xe+Fr,1,ar.minY,ar.maxY,Et),ai=Ar(xa,Yt,Xe+Gr,Xe+pi,1,ar.minY,ar.maxY,Et),xa=null),Wi&&(Js=Ar(Wi,Yt,Xe-vr,Xe+Fr,1,ar.minY,ar.maxY,Et),ha=Ar(Wi,Yt,Xe+Gr,Xe+pi,1,ar.minY,ar.maxY,Et),Wi=null),on>1&&console.timeEnd("clipping"),ot.push(Vi||[],_e+1,2*Ie,2*Xe),ot.push(ai||[],_e+1,2*Ie,2*Xe+1),ot.push(Js||[],_e+1,2*Ie+1,2*Xe),ot.push(ha||[],_e+1,2*Ie+1,2*Xe+1)}}getTile(de,_e,Ie){de=+de,_e=+_e,Ie=+Ie;const Xe=this.options,{extent:He,debug:We}=Xe;if(de<0||de>24)return null;const kt=1<<de,ot=xs(de,_e=_e+kt&kt-1,Ie);if(this.tiles[ot])return bn(this.tiles[ot],He);We>1&&console.log("drilling down to z%d-%d-%d",de,_e,Ie);let Et,on=de,Yt=_e,Vn=Ie;for(;!Et&&on>0;)on--,Yt>>=1,Vn>>=1,Et=this.tiles[xs(on,Yt,Vn)];return Et&&Et.source?(We>1&&(console.log("found parent tile z%d-%d-%d",on,Yt,Vn),console.time("drilling down")),this.splitTile(Et.source,on,Yt,Vn,de,_e,Ie),We>1&&console.timeEnd("drilling down"),this.tiles[ot]?bn(this.tiles[ot],He):null):null}}function xs(lt,de,_e){return 32*((1<<lt)*_e+de)+lt}function Pi(lt,de){const _e=lt.tileID.canonical;if(!this._geoJSONIndex)return void de(null,null);const Ie=this._geoJSONIndex.getTile(_e.z,_e.x,_e.y);if(!Ie)return void de(null,null);const Xe=Et=>Et.tags&&"3d_elevation_id"in Et.tags&&"source"in Et.tags&&Et.tags.source==="elevation",He=Ie.features.filter(Et=>Xe(Et));let We={_geojsonTileLayer:Ie.features};He.length>0&&(We={_geojsonTileLayer:Ie.features.filter(Et=>!Xe(Et)),hd_road_elevation:He});const kt=new ne(We),ot=function(Et){const on=new i.bt;for(const Yt of Object.keys(Et))on.writeMessage(3,je,{name:Yt,features:Et[Yt]});return on.finish()}(We).buffer;de(null,{vectorTile:kt,rawData:ot})}class zt extends B{constructor(de,_e,Ie,Xe,He,We,kt){super(de,_e,Ie,Xe,He,Pi,kt),We&&(this.loadGeoJSON=We),this._dynamicIndex=new we}loadData(de,_e){const Ie=de&&de.request,Xe=Ie&&Ie.collectResourceTiming;this._geoJSONIndex=null,this.loadGeoJSON(de,(He,We)=>{if(He||!We)return _e(He);if(typeof We!="object")return _e(new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`));{try{if(de.filter){const ot=i.U(de.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ot.result==="error")throw new Error(ot.value.map(Et=>`${Et.key}: ${Et.message}`).join(", "));We.features=We.features.filter(Et=>ot.value.evaluate({zoom:0},Et))}de.dynamic?(We.type==="Feature"&&(We={type:"FeatureCollection",features:[We]}),de.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(We.features,this.loaded),de.cluster&&(We.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=de.cluster?new Ht(function({superclusterOptions:ot,clusterProperties:Et}){if(!Et||!ot)return ot;const on={},Yt={},Vn={accumulated:null,zoom:0},ar={properties:null},vr=Object.keys(Et);for(const Gr of vr){const[Fr,pi]=Et[Gr],Vi=i.U(pi),ai=i.U(typeof Fr=="string"?[Fr,["accumulated"],["get",Gr]]:Fr);on[Gr]=Vi.value,Yt[Gr]=ai.value}return ot.map=Gr=>{ar.properties=Gr;const Fr={};for(const pi of vr)Fr[pi]=on[pi].evaluate(Vn,ar);return Fr},ot.reduce=(Gr,Fr)=>{ar.properties=Fr;for(const pi of vr)Vn.accumulated=Gr[pi],Gr[pi]=Yt[pi].evaluate(Vn,ar)},ot}(de)).load(We.features):de.dynamic?this._dynamicIndex:function(ot,Et){return new _i(ot,Et)}(We,de.geojsonVtOptions)}catch(ot){return _e(ot)}const kt={};if(Xe){const ot=y(Ie);ot&&(kt.resourceTiming={},kt.resourceTiming[de.source]=JSON.parse(JSON.stringify(ot)))}_e(null,kt)}})}reloadTile(de,_e){const Ie=this.loaded;return Ie&&Ie[de.uid]?de.partial?_e(null,void 0):super.reloadTile(de,_e):this.loadTile(de,_e)}loadGeoJSON(de,_e){if(de.request)i.m(de.request,_e);else{if(typeof de.data!="string")return _e(new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`));setTimeout(()=>{try{return _e(null,JSON.parse(de.data))}catch{return _e(new Error(`Input data given to '${de.source}' is not a valid GeoJSON object.`))}},0)}}getClusterExpansionZoom(de,_e){try{_e(null,this._geoJSONIndex.getClusterExpansionZoom(de.clusterId))}catch(Ie){_e(Ie)}}getClusterChildren(de,_e){try{_e(null,this._geoJSONIndex.getChildren(de.clusterId))}catch(Ie){_e(Ie)}}getClusterLeaves(de,_e){try{_e(null,this._geoJSONIndex.getLeaves(de.clusterId,de.limit,de.offset))}catch(Ie){_e(Ie)}}}class es{constructor(de,_e,Ie){this.tileID=new i.aO(de.tileID.overscaledZ,de.tileID.wrap,de.tileID.canonical.z,de.tileID.canonical.x,de.tileID.canonical.y),this.tileZoom=de.tileZoom,this.uid=de.uid,this.zoom=de.zoom,this.canonical=de.tileID.canonical,this.pixelRatio=de.pixelRatio,this.tileSize=de.tileSize,this.source=de.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=de.projection,this.brightness=_e,this.worldview=Ie}parse(de,_e,Ie,Xe){this.status="parsing";const He=new i.aO(Ie.tileID.overscaledZ,Ie.tileID.wrap,Ie.tileID.canonical.z,Ie.tileID.canonical.x,Ie.tileID.canonical.y),We=[],kt=_e.familiesBySource[Ie.source],ot=new i.fe(He,Ie.promoteId);ot.bucketLayerIDs=[],ot.is3DTile=!0,i.ft(de).then(Et=>{if(!Et)return Xe(new Error("Could not parse tile"));const on=Et.json.extensionsUsed&&Et.json.extensionsUsed.includes("MAPBOX_mesh_features")||Et.json.asset.extras&&Et.json.asset.extras.MAPBOX_mesh_features,Yt=Et.json.extensionsUsed&&Et.json.extensionsUsed.includes("EXT_meshopt_compression"),Vn=new i.ac(this.zoom,{brightness:this.brightness,worldview:this.worldview});for(const ar in kt)for(const vr of kt[ar]){const Gr=vr[0];ot.bucketLayerIDs.push(vr.map(Vi=>i.B(Vi.id,Vi.scope))),Gr.recalculate(Vn,[]);const Fr=i.fu(Et,1/i.d6(Ie.tileID.canonical)),pi=new i.fv(vr,Fr,He,on,Yt,this.brightness,ot,this.worldview);on||(pi.needsUpload=!0),We.push(pi),pi.evaluate(Gr)}this.status="done",Xe(null,{buckets:We,featureIndex:ot,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(Et=>Xe(new Error(Et.message)))}}class ja{constructor(de,_e,Ie,Xe,He,We,kt,ot){this.actor=de,this.layerIndex=_e,this.availableImages=Ie,this.availableModels=Xe,this.brightness=kt,this.loading={},this.loaded={},this.worldview=ot}loadTile(de,_e){const Ie=de.uid,Xe=this.loading[Ie]=new es(de,this.brightness,this.worldview);i.bu(de.request,(He,We)=>{const kt=!this.loading[Ie];return delete this.loading[Ie],kt||He?(Xe.status="done",kt||(this.loaded[Ie]=Xe),_e(He)):We&&We.byteLength!==0?void Xe.parse(We,this.layerIndex,de,(ot,Et)=>{Xe.status="done",this.loaded=this.loaded||{},this.loaded[Ie]=Xe,ot||!Et?_e(ot):_e(null,Et)}):(Xe.status="done",this.loaded[Ie]=Xe,_e())})}reloadTile(de,_e){const Ie=this.loaded,Xe=de.uid;if(Ie&&Ie[Xe]){const He=Ie[Xe];He.projection=de.projection,He.brightness=de.brightness;const We=(kt,ot)=>{He.reloadCallback&&(delete He.reloadCallback,this.loadTile(de,_e)),_e(kt,ot)};He.status==="parsing"?He.reloadCallback=We:He.status==="done"&&this.loadTile(de,_e)}}abortTile(de,_e){const Ie=de.uid;this.loading[Ie]&&delete this.loading[Ie],_e()}removeTile(de,_e){const Ie=this.loaded,Xe=de.uid;Ie&&Ie[Xe]&&delete Ie[Xe],_e()}}class qr{constructor(de){this.self=de,this.actor=new i.fx(de,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new i.x,this.rtlPluginParsingListeners=[],this.projections={},this.defaultProjection=i.cl({name:"mercator"}),this.workerSourceTypes={vector:B,geojson:zt,"raster-dem":F,"raster-array":H,"batched-model":ja},this.workerSources={},this.self.registerWorkerSource=(_e,Ie)=>{if(this.workerSourceTypes[_e])throw new Error(`Worker source with name "${_e}" already registered.`);this.workerSourceTypes[_e]=Ie},this.self.registerRTLTextPlugin=_e=>{if(i.fy.isParsed())throw new Error("RTL text plugin already registered.");i.fy.setState({pluginStatus:i.fz.parsed,pluginURL:i.fy.getPluginURL()}),i.fy.applyArabicShaping=_e.applyArabicShaping,i.fy.processBidirectionalText=_e.processBidirectionalText,i.fy.processStyledBidirectionalText=_e.processStyledBidirectionalText;for(const Ie of this.rtlPluginParsingListeners)Ie(null,!0);this.rtlPluginParsingListeners=[]}}clearCaches(de,_e,Ie){delete this.layerIndexes[de],delete this.availableImages[de],delete this.availableModels[de],delete this.workerSources[de],Ie()}checkIfReady(de,_e,Ie){Ie()}setReferrer(de,_e){this.referrer=_e}spriteLoaded(de,_e){this.isSpriteLoaded[de]||(this.isSpriteLoaded[de]={});const{scope:Ie,isLoaded:Xe}=_e;if(this.isSpriteLoaded[de][Ie]=Xe,this.workerSources[de]&&this.workerSources[de][Ie])for(const He in this.workerSources[de][Ie]){const We=this.workerSources[de][Ie][He];for(const kt in We){const ot=We[kt];ot instanceof B&&(ot.isSpriteLoaded=Xe,ot.fire(new i.z("isSpriteLoaded")))}}}setImages(de,_e,Ie){this.availableImages[de]||(this.availableImages[de]={});const{scope:Xe,images:He}=_e;if(this.availableImages[de][Xe]=He,this.workerSources[de]&&this.workerSources[de][Xe]){for(const We in this.workerSources[de][Xe]){const kt=this.workerSources[de][Xe][We];for(const ot in kt)kt[ot].availableImages=He}Ie()}else Ie()}setModels(de,{scope:_e,models:Ie},Xe){if(this.availableModels[de]||(this.availableModels[de]={}),this.availableModels[de][_e]=Ie,this.workerSources[de]&&this.workerSources[de][_e]){for(const He in this.workerSources[de][_e]){const We=this.workerSources[de][_e][He];for(const kt in We)We[kt].availableModels=Ie}Xe()}else Xe()}setProjection(de,_e){this.projections[de]=i.cl(_e)}setBrightness(de,_e,Ie){this.brightness=_e,Ie()}setWorldview(de,_e,Ie){this.worldview=_e,Ie()}setLayers(de,_e,Ie){this.getLayerIndex(de,_e.scope).replace(_e.layers,_e.options),Ie()}updateLayers(de,_e,Ie){this.getLayerIndex(de,_e.scope).update(_e.layers,_e.removedIds,_e.options),Ie()}loadTile(de,_e,Ie){_e.projection=this.projections[de]||this.defaultProjection,this.getWorkerSource(de,_e.type,_e.source,_e.scope).loadTile(_e,Ie)}decodeRasterArray(de,_e,Ie){this.getWorkerSource(de,_e.type,_e.source,_e.scope).decodeRasterArray(_e,Ie)}reloadTile(de,_e,Ie){_e.projection=this.projections[de]||this.defaultProjection,this.getWorkerSource(de,_e.type,_e.source,_e.scope).reloadTile(_e,Ie)}abortTile(de,_e,Ie){this.getWorkerSource(de,_e.type,_e.source,_e.scope).abortTile(_e,Ie)}removeTile(de,_e,Ie){this.getWorkerSource(de,_e.type,_e.source,_e.scope).removeTile(_e,Ie)}removeSource(de,_e,Ie){if(!(this.workerSources[de]&&this.workerSources[de][_e.scope]&&this.workerSources[de][_e.scope][_e.type]&&this.workerSources[de][_e.scope][_e.type][_e.source]))return;const Xe=this.workerSources[de][_e.scope][_e.type][_e.source];delete this.workerSources[de][_e.scope][_e.type][_e.source],Xe.removeSource!==void 0?Xe.removeSource(_e,Ie):Ie()}loadWorkerSource(de,_e,Ie){try{this.self.importScripts(_e.url),Ie()}catch(Xe){Ie(Xe.toString())}}syncRTLPluginState(de,_e,Ie){if(i.fy.isParsed())Ie(null,!0);else if(i.fy.isParsing())this.rtlPluginParsingListeners.push(Ie);else try{i.fy.setState(_e);const Xe=i.fy.getPluginURL();!i.fy.isLoaded()||i.fy.isParsed()||i.fy.isParsing()||Xe==null||(i.fy.setState({pluginStatus:i.fz.parsing,pluginURL:i.fy.getPluginURL()}),this.self.importScripts(Xe),i.fy.isParsed()?Ie(null,!0):this.rtlPluginParsingListeners.push(Ie))}catch(Xe){Ie(Xe.toString())}}setDracoUrl(de,_e){this.dracoUrl=_e}getAvailableImages(de,_e){this.availableImages[de]||(this.availableImages[de]={});let Ie=this.availableImages[de][_e];return Ie||(Ie=[]),Ie}getAvailableModels(de,_e){this.availableModels[de]||(this.availableModels[de]={});let Ie=this.availableModels[de][_e];return Ie||(Ie={}),Ie}getLayerIndex(de,_e){this.layerIndexes[de]||(this.layerIndexes[de]={});let Ie=this.layerIndexes[de][_e];return Ie||(Ie=this.layerIndexes[de][_e]=new C,Ie.scope=_e),Ie}getWorkerSource(de,_e,Ie,Xe){const He=this.workerSources;return He[de]||(He[de]={}),He[de][Xe]||(He[de][Xe]={}),He[de][Xe][_e]||(He[de][Xe][_e]={}),this.isSpriteLoaded[de]||(this.isSpriteLoaded[de]={}),He[de][Xe][_e][Ie]||(He[de][Xe][_e][Ie]=new this.workerSourceTypes[_e]({send:(We,kt,ot,Et,on,Yt)=>this.actor.send(We,kt,ot,de,on,Yt),scheduler:this.actor.scheduler},this.getLayerIndex(de,Xe),this.getAvailableImages(de,Xe),this.getAvailableModels(de,Xe),this.isSpriteLoaded[de][Xe],void 0,this.brightness,this.worldview)),He[de][Xe][_e][Ie]}rasterizeImagesWorker(de,_e,Ie){const Xe=new Map;for(const[He,{image:We,imageVariant:kt}]of _e.tasks.entries()){const ot=this.imageRasterizer.rasterize(kt,We,_e.scope,de);Xe.set(He,ot)}Ie(void 0,Xe)}removeRasterizedImages(de,_e,Ie){this.imageRasterizer.removeImagesFromCacheByIds(_e.imageIds,_e.scope,de),Ie()}enforceCacheSizeLimit(de,_e){i.fA(_e)}getWorkerPerformanceMetrics(de,_e,Ie){Ie(void 0,void 0)}}return i.fw(self)&&(self.worker=new qr(self)),qr}),l(["./shared"],function(i){var y="3.15.0";const x={create:"create",load:"load",fullLoad:"fullLoad"},w={mark(g){performance.mark(g)},measure(g,o,d){performance.measure(g,o,d)}};function C(g){const o=g.name.split("?")[0];return i.a(o)&&o.includes("mapbox-gl.js")?"javascript":i.a(o)&&o.includes("mapbox-gl.css")?"css":i.b(o)?"fontRange":i.c(o)?"sprite":i.i(o)?"style":i.d(o)?"tilejson":"other"}var P,E={},j=function(){if(P)return E;function g(m){return!o(m)}function o(m){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var A,k,N=new Blob([""],{type:"text/javascript"}),R=URL.createObjectURL(N);try{k=new Worker(R),A=!0}catch{A=!1}return k&&k.terminate(),URL.revokeObjectURL(R),A}()?function(){var A=document.createElement("canvas");A.width=A.height=1;var k=A.getContext("2d");if(!k)return!1;var N=k.getImageData(0,0,1,1);return N&&N.width===A.width}()?(d[S=m&&m.failIfMajorPerformanceCaveat]===void 0&&(d[S]=function(A){var k,N=function(R){var V=document.createElement("canvas"),G=Object.create(g.webGLContextAttributes);return G.failIfMajorPerformanceCaveat=R,V.getContext("webgl2",G)}(A);if(!N)return!1;try{k=N.createShader(N.VERTEX_SHADER)}catch{return!1}return!(!k||N.isContextLost())&&(N.shaderSource(k,"void main() {}"),N.compileShader(k),N.getShaderParameter(k,N.COMPILE_STATUS)===!0)}(S)),d[S]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var S}P=1,E.supported=g,E.notSupportedReason=o;var d={};return g.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},E}();function D(g,o,d){const m=document.createElement(g);return o!=null&&(m.className=o),d&&d.appendChild(m),m}function B(g,o,d){const m=document.createElementNS("http://www.w3.org/2000/svg",g);for(const S of Object.keys(o))m.setAttributeNS(null,S,String(o[S]));return d&&d.appendChild(m),m}const F=typeof document<"u"?document.documentElement&&document.documentElement.style:null,$=F&&F.userSelect!==void 0?"userSelect":"WebkitUserSelect";let H;function J(){F&&$&&(H=F[$],F[$]="none")}function ee(){F&&$&&(F[$]=H)}function Q(g){g.preventDefault(),g.stopPropagation(),window.removeEventListener("click",Q,!0)}function ne(){window.addEventListener("click",Q,!0),window.setTimeout(()=>{window.removeEventListener("click",Q,!0)},0)}function pe(g,o){const d=g.getBoundingClientRect();return fe(g,d,o)}function he(g,o){const d=g.getBoundingClientRect(),m=[];for(let S=0;S<o.length;S++)m.push(fe(g,d,o[S]));return m}function we(g){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&g.button===2&&g.ctrlKey?0:g.button}function fe(g,o,d){const m=g.offsetWidth===o.width?1:g.offsetWidth/o.width;return new i.P((d.clientX-o.left)*m,(d.clientY-o.top)*m)}const ge="01",Ce="NO_ACCESS_TOKEN";class xe{constructor(o,d,m){this._transformRequestFn=o,this._customAccessToken=d,this._silenceAuthErrors=!!m,this._createSkuToken()}_createSkuToken(){const o=function(){let d="";for(let m=0;m<10;m++)d+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ge,d].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=o.token,this._skuTokenExpiresAt=o.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(o,d){return this._transformRequestFn&&this._transformRequestFn(o,d)||{url:o}}normalizeStyleURL(o,d){if(!i.h(o))return o;const m=Qe(o);return m.params.push(`sdk=js-${y}`),m.path=`/styles/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||d)}normalizeGlyphsURL(o,d){if(!i.h(o))return o;const m=Qe(o);return m.path=`/fonts/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||d)}normalizeModelURL(o,d){if(!i.h(o))return o;const m=Qe(o);return m.path=`/models/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||d)}normalizeSourceURL(o,d,m,S){if(!i.h(o))return o;const A=Qe(o);return A.path=`/v4/${A.authority}.json`,A.params.push("secure"),m&&A.params.push(`language=${m}`),S&&A.params.push(`worldview=${S}`),this._makeAPIURL(A,this._customAccessToken||d)}normalizeIconsetURL(o,d){const m=Qe(o);return i.h(o)?(m.path=`/styles/v1${m.path}/iconset.pbf`,this._makeAPIURL(m,this._customAccessToken||d)):et(m)}normalizeSpriteURL(o,d,m,S){const A=Qe(o);return i.h(o)?(A.path=`/styles/v1${A.path}/sprite${d}${m}`,this._makeAPIURL(A,this._customAccessToken||S)):(A.path+=`${d}${m}`,et(A))}normalizeTileURL(o,d,m){if(this._isSkuTokenExpired()&&this._createSkuToken(),o&&!i.h(o))return o;const S=Qe(o);S.path=S.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${d||m&&S.authority!=="raster"&&m===512?"@2x":""}${i.k.supported?".webp":"$1"}`),S.authority==="raster"?S.path=`/${i.e.RASTER_URL_PREFIX}${S.path}`:S.authority==="rasterarrays"?S.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${S.path}`:S.authority==="3dtiles"?S.path=`/${i.e.TILES3D_URL_PREFIX}${S.path}`:(S.path=S.path.replace(/^.+\/v4\//,"/"),S.path=`/${i.e.TILE_URL_VERSION}${S.path}`);const A=this._customAccessToken||function(k){for(const N of k){const R=N.match(/^access_token=(.*)$/);if(R)return R[1]}return null}(S.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&A&&this._skuToken&&S.params.push(`sku=${this._skuToken}`),this._makeAPIURL(S,A)}canonicalizeTileURL(o,d){const m=Qe(o);if(!m.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!m.path.match(/\.[\w]+$/))return o;let S="mapbox://";m.path.match(/^\/raster\/v1\//)?S+=`raster/${m.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:m.path.match(/^\/rasterarrays\/v1\//)?S+=`rasterarrays/${m.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:S+=`tiles/${m.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let A=m.params;return d&&(A=A.filter(k=>!k.match(/^access_token=/))),A.length&&(S+=`?${A.join("&")}`),S}canonicalizeTileset(o,d){const m=!!d&&i.h(d),S=[];for(const A of o.tiles||[])i.j(A)?S.push(this.canonicalizeTileURL(A,m)):S.push(A);return S}_makeAPIURL(o,d){const m="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",S=Qe(i.e.API_URL);if(o.protocol=S.protocol,o.authority=S.authority,o.protocol==="http"){const A=o.params.indexOf("secure");A>=0&&o.params.splice(A,1)}if(S.path!=="/"&&(o.path=`${S.path}${o.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return et(o);if(d=d||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!d)throw new Error(`An API access token is required to use Mapbox GL. ${m}`);if(d[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${m}`)}return o.params=o.params.filter(A=>A.indexOf("access_token")===-1),o.params.push(`access_token=${d||""}`),et(o)}}const Re=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Qe(g){const o=g.match(Re);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function et(g){const o=g.params.length?`?${g.params.join("&")}`:"";return`${g.protocol}://${g.authority}${g.path}${o}`}const je="mapbox.eventData";function De(g){if(!g)return null;const o=g.split(".");if(!o||o.length!==3)return null;try{return JSON.parse(i.l(o[1]))}catch{return null}}class Ct{constructor(o){this.type=o,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(o){const d=De(i.e.ACCESS_TOKEN);let m="";return m=d&&d.u?i.f(d.u):i.e.ACCESS_TOKEN||"",o?`${je}.${o}:${m}`:`${je}:${m}`}fetchEventData(){const o=i.s("localStorage"),d=this.getStorageKey(),m=this.getStorageKey("uuid");if(o)try{const S=localStorage.getItem(d);S&&(this.eventData=JSON.parse(S));const A=localStorage.getItem(m);A&&(this.anonId=A)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const o=i.s("localStorage"),d=this.getStorageKey(),m=this.getStorageKey("uuid"),S=this.anonId;if(o&&S)try{localStorage.setItem(m,S),Object.keys(this.eventData).length>=1&&localStorage.setItem(d,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(o){}postEvent(o,d,m,S){if(!i.e.EVENTS_URL)return;const A=Qe(i.e.EVENTS_URL);A.params.push(`access_token=${S||i.e.ACCESS_TOKEN||""}`);const k={event:this.type,created:new Date(o).toISOString()},N=d?Object.assign(k,d):k,R={url:et(A),headers:{"Content-Type":"text/plain"},body:JSON.stringify([N])};this.pendingRequest=i.p(R,V=>{this.pendingRequest=null,m(V),this.saveEventData(),this.processRequests(S)})}queueRequest(o,d){this.queue.push(o),this.processRequests(d)}}const xt=new class extends Ct{constructor(g){super("appUserTurnstile"),this._customAccessToken=g}postTurnstileEvent(g,o){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(g)&&g.some(d=>i.h(d)||i.j(d))&&this.queueRequest(Date.now(),o)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const o=De(i.e.ACCESS_TOKEN),d=o?o.u:i.e.ACCESS_TOKEN;let m=d!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),m=!0);const S=this.queue.shift();if(this.eventData.lastSuccess){const A=new Date(this.eventData.lastSuccess),k=new Date(S),N=(S-this.eventData.lastSuccess)/864e5;m=m||N>=1||N<-1||A.getDate()!==k.getDate()}else m=!0;m?this.postEvent(S,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:ge,"enabled.telemetry":!1,userId:this.anonId},A=>{A||(this.eventData.lastSuccess=S,this.eventData.tokenU=d)},g):this.processRequests()}},me=xt.postTurnstileEvent.bind(xt),Ye=new class extends Ct{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(g,o,d,m){this.skuToken=o,this.errorCb=m,i.e.EVENTS_URL&&(d||i.e.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},d):this.errorCb(new Error(Ce)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:d}=this.queue.shift();o&&this.success[o]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(d,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:ge,skuToken:this.skuToken,userId:this.anonId},m=>{m?this.errorCb(m):o&&(this.success[o]=!0)},g))}remove(){this.errorCb=null}},nt=Ye.postMapLoadEvent.bind(Ye),vt=new class extends Ct{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(g){let o=this.mapInstanceIdMap.get(g);return o||(o=i.u(),this.mapInstanceIdMap.set(g,o)),o}getEventId(g){const o=this.eventIdPerMapInstanceMap.get(g)||0;return this.eventIdPerMapInstanceMap.set(g,o+1),o}postStyleLoadEvent(g,o){const{map:d,style:m,importedStyles:S}=o;if(!i.e.EVENTS_URL||!g&&!i.e.ACCESS_TOKEN)return;const A=this.getMapInstanceId(d),k={mapInstanceId:A,eventId:this.getEventId(A),style:m};S.length&&(k.importedStyles=S),this.queueRequest({timestamp:Date.now(),payload:k},g)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:o,payload:d}=this.queue.shift();this.postEvent(o,d,()=>{},g)}},gt=vt.postStyleLoadEvent.bind(vt),dt=new class extends Ct{constructor(){super("gljs.performance")}postPerformanceEvent(g,o){i.e.EVENTS_URL&&(g||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:o},g)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:o,performanceData:d}=this.queue.shift(),m=function(S){const A=performance.getEntriesByType("resource"),k=performance.getEntriesByType("mark"),N=function(te){const ie={};if(te){for(const se in te)if(se!=="other")for(const ve of te[se]){const ue=`${se}ResolveRangeMin`,be=`${se}ResolveRangeMax`,Te=`${se}RequestCount`,ke=`${se}RequestCachedCount`;ie[ue]=Math.min(ie[ue]||1/0,ve.startTime),ie[be]=Math.max(ie[be]||-1/0,ve.responseEnd);const Ue=Fe=>{ie[Fe]===void 0&&(ie[Fe]=0),++ie[Fe]};ve.transferSize!==void 0&&ve.transferSize===0&&Ue(ke),Ue(Te)}}return ie}(function(te,ie){const se={};if(te)for(const ve of te){const ue=ie(ve);se[ue]===void 0&&(se[ue]=[]),se[ue].push(ve)}return se}(A,C)),R=window.devicePixelRatio,V=navigator.connection||navigator.mozConnection||navigator.webkitConnection,G=V?V.effectiveType:void 0,X={counters:[],metadata:[],attributes:[]},W=(te,ie,se)=>{se!=null&&te.push({name:ie,value:se.toString()})};for(const te in N)W(X.counters,te,N[te]);if(S.interactionRange[0]!==1/0&&S.interactionRange[1]!==-1/0&&(W(X.counters,"interactionRangeMin",S.interactionRange[0]),W(X.counters,"interactionRangeMax",S.interactionRange[1])),k)for(const te of Object.keys(x)){const ie=x[te],se=k.find(ve=>ve.name===ie);se&&W(X.counters,ie,se.startTime)}return W(X.counters,"visibilityHidden",S.visibilityHidden),W(X.attributes,"style",function(te){if(te)for(const ie of te){const se=ie.name.split("?")[0];if(i.i(se)){const ve=se.split("/").slice(-2);if(ve.length===2)return`mapbox://styles/${ve[0]}/${ve[1]}`}}}(A)),W(X.attributes,"terrainEnabled",S.terrainEnabled?"true":"false"),W(X.attributes,"fogEnabled",S.fogEnabled?"true":"false"),W(X.attributes,"projection",S.projection),W(X.attributes,"zoom",S.zoom),W(X.metadata,"devicePixelRatio",R),W(X.metadata,"connectionEffectiveType",G),W(X.metadata,"navigatorUserAgent",navigator.userAgent),W(X.metadata,"screenWidth",window.screen.width),W(X.metadata,"screenHeight",window.screen.height),W(X.metadata,"windowWidth",window.innerWidth),W(X.metadata,"windowHeight",window.innerHeight),W(X.metadata,"mapWidth",S.width/R),W(X.metadata,"mapHeight",S.height/R),W(X.metadata,"webglRenderer",S.renderer),W(X.metadata,"webglVendor",S.vendor),W(X.metadata,"sdkVersion",y),W(X.metadata,"sdkIdentifier","mapbox-gl-js"),X}(d);for(const S of m.metadata);for(const S of m.counters);for(const S of m.attributes);this.postEvent(o,m,()=>{},g)}},At=dt.postPerformanceEvent.bind(dt),mt=new class extends Ct{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(g,o,d,m){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const S=Qe(i.e.API_URL+i.e.SESSION_PATH);S.params.push(`sku=${o||""}`),S.params.push(`access_token=${m||i.e.ACCESS_TOKEN||""}`);const A={url:et(S),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(A,k=>{this.pendingRequest=null,d(k),this.saveEventData(),this.processRequests(m)})}getSessionAPI(g,o,d,m){this.skuToken=o,this.errorCb=m,i.e.SESSION_PATH&&i.e.API_URL&&(d||i.e.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},d):this.errorCb(new Error(Ce)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:d}=this.queue.shift();o&&this.success[o]||this.getSession(d,this.skuToken,m=>{m?this.errorCb(m):o&&(this.success[o]=!0)},g)}remove(){this.errorCb=null}},Pt=mt.getSessionAPI.bind(mt),Ht=new Set;function Ot(g,o){o?Ht.add(g):Ht.delete(g)}class Un{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(o,d){this._updatedSourceCaches[o]=d,this.setDirty()}discardSourceCacheUpdate(o){delete this._updatedSourceCaches[o]}updateLayer(o){const d=o.scope;this._updatedLayers[d]=this._updatedLayers[d]||new Set,this._updatedLayers[d].add(o.id),this.setDirty()}removeLayer(o){const d=o.scope;this._removedLayers[d]=this._removedLayers[d]||{},this._updatedLayers[d]=this._updatedLayers[d]||new Set,this._removedLayers[d][o.id]=o,this._updatedLayers[d].delete(o.id),this._updatedPaintProps.delete(o.fqid),this.setDirty()}getRemovedLayer(o){return this._removedLayers[o.scope]?this._removedLayers[o.scope][o.id]:null}discardLayerRemoval(o){this._removedLayers[o.scope]&&delete this._removedLayers[o.scope][o.id]}getLayerUpdatesByScope(){const o={};for(const d in this._updatedLayers)o[d]=o[d]||{},o[d].updatedIds=Array.from(this._updatedLayers[d].values());for(const d in this._removedLayers)o[d]=o[d]||{},o[d].removedIds=Object.keys(this._removedLayers[d]);return o}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(o){this._updatedPaintProps.add(o.fqid),this.setDirty()}getUpdatedImages(o){return this._updatedImages[o]?Array.from(this._updatedImages[o].values()):[]}updateImage(o,d){this._updatedImages[d]=this._updatedImages[d]||new Set,this._updatedImages[d].add(i.I.toString(o)),this.setDirty()}resetUpdatedImages(o){this._updatedImages[o]&&this._updatedImages[o].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function Kt(g){const{userImage:o}=g;return!!(o&&o.render&&o.render())&&(g.data.replace(new Uint8Array(o.data.buffer)),!0)}class st extends i.E{constructor(o){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=o,o!=="raster"&&i.r()&&(this.imageRasterizerDispatcher=new i.D(i.t(),this,"Image Rasterizer Worker",1))}addScope(o){this.loaded.set(o,!1),this.imageProviders.set(o,new Map),this.images.set(o,new Map),this.updatedImages.set(o,new Set),this.callbackDispatchedThisFrame.set(o,new Set),this.patterns.set(o,new Map),this.atlasImage.set(o,new i.q({width:1,height:1}))}removeScope(o){this.loaded.delete(o),this.imageProviders.delete(o),this.images.delete(o),this.updatedImages.delete(o),this.callbackDispatchedThisFrame.delete(o),this.patterns.delete(o),this.atlasImage.delete(o);const d=this.atlasTexture.get(o);d&&(d.destroy(),this.atlasTexture.delete(o))}addImageProvider(o,d){this.imageProviders.has(d)||this.imageProviders.set(d,new Map),this.imageProviders.get(d).set(o.id,o)}removeImageProvider(o,d){this.imageProviders.has(d)&&this.imageProviders.get(d).delete(o)}getPendingImageProviders(){const o=[];for(const d of this.imageProviders.values())for(const m of d.values())m.hasPendingRequests()&&o.push(m);return o}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.x),this._imageRasterizer}isLoaded(){for(const o of this.loaded.keys())if(!this.loaded.get(o))return!1;return!0}setLoaded(o,d){if(this.loaded.get(d)!==o&&(this.loaded.set(d,o),o)){for(const{ids:m,callback:S}of this.requestors)this._notify(m,d,S);this.requestors=[]}}hasImage(o,d){return!!this.getImage(o,d)}getImage(o,d){return this.images.get(d).get(o.toString())}addImage(o,d,m){this._validate(o,m)&&this.images.get(d).set(o.toString(),m)}_validate(o,d){let m=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new i.y(new Error(`Image "${o.name}" has invalid "stretchX" value`))),m=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new i.y(new Error(`Image "${o.name}" has invalid "stretchY" value`))),m=!1),this._validateContent(d.content,d)||(this.fire(new i.y(new Error(`Image "${o.name}" has invalid "content" value`))),m=!1),m}_validateStretch(o,d){if(!o)return!0;let m=0;for(const S of o){if(S[0]<m||S[1]<S[0]||d<S[1])return!1;m=S[1]}return!0}_validateContent(o,d){return o?o.length!==4||!d.usvg&&(o[0]<0||d.data.width<o[0]||o[1]<0||d.data.height<o[1]||o[2]<0||d.data.width<o[2]||o[3]<0||d.data.height<o[3])?!1:!(o[2]<o[0]||o[3]<o[1]):!0}updateImage(o,d,m){const S=this.images.get(d).get(o.toString());m.version=S.version+1,this.images.get(d).set(o.toString(),m),this.updatedImages.get(d).add(o),this.removeFromImageRasterizerCache(o,d)}clearUpdatedImages(o){this.updatedImages.get(o).clear()}removeFromImageRasterizerCache(o,d){this.spriteFormat!=="raster"&&(i.r()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[o],scope:d}):this.imageRasterizer.removeImagesFromCacheByIds([o],d))}removeImage(o,d){const m=this.images.get(d),S=m.get(o.toString());m.delete(o.toString()),this.patterns.get(d).delete(o.toString()),this.removeFromImageRasterizerCache(o,d),S.userImage&&S.userImage.onRemove&&S.userImage.onRemove()}listImages(o){return Array.from(this.images.get(o).keys()).map(d=>i.I.from(d))}getImages(o,d,m){const S=[],A=[],k=this.imageProviders.get(d);for(const G of o){if(!G.iconsetId){S.push(G);continue}const X=k.get(G.iconsetId);X&&(this.getImage(G,d)?A.push(G):X.addPendingRequest(G))}if(S.length===0)return void this._notify(A,d,m);let N=!0;const R=!!this.loaded.get(d),V=this.images.get(d);if(!R)for(const G of S)V.has(G.toString())||(N=!1);R||N?this._notify(S,d,m):this.requestors.push({ids:S,scope:d,callback:m})}rasterizeImages(o,d){const m=new Map,{tasks:S,scope:A}=o;for(const[k,N]of S.entries()){const R=this.getImage(N.id,A);R&&m.set(k,{image:R,imageVariant:N})}this._rasterizeImages(A,m,d)}_rasterizeImages(o,d,m){if(i.r())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:d,scope:o},m);else{const S=new Map;for(const[A,{image:k,imageVariant:N}]of d.entries())S.set(A,this.imageRasterizer.rasterize(N,k,o,0));m(void 0,S)}}getUpdatedImages(o){return this.updatedImages.get(o)||new Set}_notify(o,d,m){const S=this.images.get(d),A=new Map;for(const k of o){if(!S.get(k.toString())){if(k.iconsetId)continue;this.fire(new i.z("styleimagemissing",{id:k.name}))}const N=S.get(k.toString());if(!N){i.w(`Image "${k.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const R={data:N.usvg?null:N.data.clone(),pixelRatio:N.pixelRatio,sdf:N.sdf,usvg:N.usvg,version:N.version,stretchX:N.stretchX,stretchY:N.stretchY,content:N.content,hasRenderCallback:!!(N.userImage&&N.userImage.render)};N.usvg&&Object.assign(R,{width:N.icon.usvg_tree.width,height:N.icon.usvg_tree.height}),A.set(i.I.toString(k),R)}m(null,A)}getPixelSize(o){const{width:d,height:m}=this.atlasImage.get(o);return{width:d,height:m}}getPattern(o,d,m){const S=o.toString(),A=this.patterns.get(d),k=A.get(S),N=this.getImage(o,d);if(!N)return null;if(k){if(k.position.version===N.version)return k.position;k.position.version=N.version}else{if(N.usvg&&!N.data){const R=this.getPatternInFlightId(S,d);if(this.patternsInFlight.has(R))return null;this.patternsInFlight.add(R);const V=new i.A(o).scaleSelf(i.o.devicePixelRatio),G=new Map([[V.toString(),{image:N,imageVariant:V}]]);return this._rasterizeImages(d,G,(X,W)=>this.storePatternImage(V,d,N,m,W)),null}this.storePattern(o,d,N)}return this._updatePatternAtlas(d,m),A.get(S).position}getPatternInFlightId(o,d){return i.B(o,d)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(o,d,m,S,A){const k=o.toString(),N=A?A.get(k):void 0;N&&(m.data=N,this.storePattern(o.id,d,m),this._updatePatternAtlas(d,S),this.patternsInFlight.delete(this.getPatternInFlightId(o.id.toString(),d)))}storePattern(o,d,m){const S={w:m.data.width+2*i.C,h:m.data.height+2*i.C,x:0,y:0},A=new i.F(S,m,i.C);this.patterns.get(d).set(o.toString(),{bin:S,position:A})}destroyAtlasTextures(){for(const o of this.atlasTexture.values())o&&o.destroy();this.atlasTexture.clear()}bind(o,d){const m=o.gl;let S=this.atlasTexture.get(d);S?this.dirty&&(S.update(this.atlasImage.get(d)),this.dirty=!1):(S=new i.T(o,this.atlasImage.get(d),m.RGBA8),this.atlasTexture.set(d,S)),S.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(o,d){const m=this.patterns.get(o),S=Array.from(m.values()).map(({bin:V})=>V),{w:A,h:k}=i.G(S),N=this.atlasImage.get(o);N.resize({width:A||1,height:k||1});const R=this.images.get(o);for(const[V,{bin:G,position:X}]of m.entries()){let W=X.padding;const te=G.x+W,ie=G.y+W,se=R.get(V).data,ve=se.width,ue=se.height;W=W>1?W-1:W,i.q.copy(se,N,{x:0,y:0},{x:te,y:ie},{width:ve,height:ue},d),i.q.copy(se,N,{x:0,y:ue-W},{x:te,y:ie-W},{width:ve,height:W},d),i.q.copy(se,N,{x:0,y:0},{x:te,y:ie+ue},{width:ve,height:W},d),i.q.copy(se,N,{x:ve-W,y:0},{x:te-W,y:ie},{width:W,height:ue},d),i.q.copy(se,N,{x:0,y:0},{x:te+ve,y:ie},{width:W,height:ue},d),i.q.copy(se,N,{x:ve-W,y:ue-W},{x:te-W,y:ie-W},{width:W,height:W},d),i.q.copy(se,N,{x:0,y:ue-W},{x:te+ve,y:ie-W},{width:W,height:W},d),i.q.copy(se,N,{x:0,y:0},{x:te+ve,y:ie+ue},{width:W,height:W},d),i.q.copy(se,N,{x:ve-W,y:0},{x:te-W,y:ie+ue},{width:W,height:W},d)}this.dirty=!0}beginFrame(){for(const o of this.images.keys())this.callbackDispatchedThisFrame.set(o,new Set)}dispatchRenderCallbacks(o,d){const m=this.images.get(d);for(const S of o){if(this.callbackDispatchedThisFrame.get(d).has(S.toString()))continue;this.callbackDispatchedThisFrame.get(d).add(S.toString());const A=m.get(S.toString());Kt(A)&&this.updateImage(S,d,A)}}destroy(){this.imageRasterizerDispatcher&&this.imageRasterizerDispatcher.remove()}}function Dr(g){const o=g.value,d=g.valueSpec,m=g.style,S=g.styleSpec,A=g.key,k=g.arrayElementValidator||fr;if(!Array.isArray(o))return[new i.V(A,o,`array expected, ${i.K(o)} found`)];if(d.length&&o.length!==d.length)return[new i.V(A,o,`array length ${d.length} expected, length ${o.length} found`)];if(d["min-length"]&&o.length<d["min-length"])return[new i.V(A,o,`array length at least ${d["min-length"]} expected, length ${o.length} found`)];let N={type:d.value,values:d.values,minimum:d.minimum,maximum:d.maximum,function:void 0};S.$version<7&&(N.function=d.function),i.H(d.value)&&(N=d.value);let R=[];for(let V=0;V<o.length;V++)R=R.concat(k({array:o,arrayIndex:V,value:o[V],valueSpec:N,style:m,styleSpec:S,key:`${A}[${V}]`},!0));return R}function Or(g){const o=g.key,d=g.value,m=g.valueSpec;if(!i.L(d))return[new i.V(o,d,`number expected, ${i.K(d)} found`)];if(d!=d)return[new i.V(o,d,"number expected, NaN found")];if("minimum"in m){let S=m.minimum;if(Array.isArray(m.minimum)&&(S=m.minimum[g.arrayIndex]),d<S)return[new i.V(o,d,`${d} is less than the minimum value ${S}`)]}if("maximum"in m){let S=m.maximum;if(Array.isArray(m.maximum)&&(S=m.maximum[g.arrayIndex]),d>S)return[new i.V(o,d,`${d} is greater than the maximum value ${S}`)]}return[]}function Br(g){const o=g.key,d=g.value;if(!i.H(d))return[new i.V(o,d,`object expected, ${i.K(d)} found`)];const m=g.valueSpec,S=i.J(d.type);let A,k,N,R={};const V=S!=="categorical"&&d.property===void 0,G=!V,X=function(se){const ve=se.stops;return Array.isArray(ve)&&Array.isArray(ve[0])&&i.H(ve[0][0])}(d),W=Ur({key:g.key,value:g.value,valueSpec:g.styleSpec.function,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{stops:function(se){if(S==="identity")return[new i.V(se.key,se.value,'identity function may not have a "stops" property')];let ve=[];const ue=se.value;return ve=ve.concat(Dr({key:se.key,value:ue,valueSpec:se.valueSpec,style:se.style,styleSpec:se.styleSpec,arrayElementValidator:te})),Array.isArray(ue)&&ue.length===0&&ve.push(new i.V(se.key,ue,"array must have at least one stop")),ve},default:function(se){return fr({key:se.key,value:se.value,valueSpec:m,style:se.style,styleSpec:se.styleSpec})}}});return S==="identity"&&V&&W.push(new i.V(g.key,g.value,'missing required property "property"')),S==="identity"||d.stops||W.push(new i.V(g.key,g.value,'missing required property "stops"')),S==="exponential"&&m.expression&&!i.M(m)&&W.push(new i.V(g.key,g.value,"exponential functions not supported")),g.styleSpec.$version>=8&&(G&&!i.N(m)?W.push(new i.V(g.key,g.value,"property functions not supported")):V&&!i.O(m)&&W.push(new i.V(g.key,g.value,"zoom functions not supported"))),S!=="categorical"&&!X||d.property!==void 0||W.push(new i.V(g.key,g.value,'"property" property is required')),W;function te(se){let ve=[];const ue=se.value,be=se.key;if(!Array.isArray(ue))return[new i.V(be,ue,`array expected, ${i.K(ue)} found`)];if(ue.length!==2)return[new i.V(be,ue,`array length 2 expected, length ${ue.length} found`)];if(X){if(!i.H(ue[0]))return[new i.V(be,ue,`object expected, ${i.K(ue[0])} found`)];const Te=ue[0];if(Te.zoom===void 0)return[new i.V(be,ue,"object stop key must have zoom")];if(Te.value===void 0)return[new i.V(be,ue,"object stop key must have value")];const ke=i.J(Te.zoom);if(typeof ke!="number")return[new i.V(be,Te.zoom,"stop zoom values must be numbers")];if(N&&N>ke)return[new i.V(be,Te.zoom,"stop zoom values must appear in ascending order")];ke!==N&&(N=ke,k=void 0,R={}),ve=ve.concat(Ur({key:`${be}[0]`,value:ue[0],valueSpec:{zoom:{}},style:se.style,styleSpec:se.styleSpec,objectElementValidators:{zoom:Or,value:ie}}))}else ve=ve.concat(ie({key:`${be}[0]`,value:ue[0],style:se.style,styleSpec:se.styleSpec},ue));return i.Q(i.S(ue[1]))?ve.concat([new i.V(`${be}[1]`,ue[1],"expressions are not allowed in function stops.")]):ve.concat(fr({key:`${be}[1]`,value:ue[1],valueSpec:m,style:se.style,styleSpec:se.styleSpec}))}function ie(se,ve){const ue=i.K(se.value),be=i.J(se.value),Te=se.value!==null?se.value:ve;if(A){if(ue!==A)return[new i.V(se.key,Te,`${ue} stop domain type must match previous stop domain type ${A}`)]}else A=ue;if(ue!=="number"&&ue!=="string"&&ue!=="boolean"&&typeof be!="number"&&typeof be!="string"&&typeof be!="boolean")return[new i.V(se.key,Te,"stop domain value must be a number, string, or boolean")];if(ue!=="number"&&S!=="categorical"){let ke=`number expected, ${ue} found`;return i.N(m)&&S===void 0&&(ke+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(se.key,Te,ke)]}return S!=="categorical"||ue!=="number"||typeof be=="number"&&isFinite(be)&&Math.floor(be)===be?S!=="categorical"&&ue==="number"&&typeof be=="number"&&typeof k=="number"&&k!==void 0&&be<k?[new i.V(se.key,Te,"stop domain values must appear in ascending order")]:(k=be,S==="categorical"&&be in R?[new i.V(se.key,Te,"stop domain values must be unique")]:(R[be]=!0,[])):[new i.V(se.key,Te,`integer expected, found ${String(be)}`)]}}function On(g){const o=(g.expressionContext==="property"?i.W:i.U)(i.S(g.value),g.valueSpec);if(o.result==="error")return o.value.map(m=>new i.V(`${g.key}${m.key}`,g.value,m.message));const d=o.value.expression||o.value._styleExpression.expression;if(g.expressionContext==="property"&&g.propertyKey==="text-font"&&!d.outputDefined())return[new i.V(g.key,g.value,`Invalid data expression for "${g.propertyKey}". Output values must be contained as literals within the expression.`)];if(g.expressionContext==="property"&&g.propertyType==="layout"&&!i.Z(d))return[new i.V(g.key,g.value,'"feature-state" data expressions are not supported with layout properties.')];if(g.expressionContext==="filter")return ht(d,g);if(g.expressionContext==="appearance")return wt(d,g);if(g.expressionContext&&g.expressionContext.indexOf("cluster")===0){if(!i.X(d,["zoom","feature-state"]))return[new i.V(g.key,g.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(g.expressionContext==="cluster-initial"&&!i.Y(d))return[new i.V(g.key,g.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ht(g,o){const d=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(o.valueSpec&&o.valueSpec.expression)for(const S of o.valueSpec.expression.parameters)d.delete(S);if(d.size===0)return[];const m=[];return g instanceof i._&&d.has(g.name)?[new i.V(o.key,o.value,`["${g.name}"] expression is not supported in a filter for a ${o.object.type} layer with id: ${o.object.id}`)]:(g.eachChild(S=>{m.push(...ht(S,o))}),m)}function wt(g,o){const d=new Set;if(o.valueSpec&&o.valueSpec.expression)for(const S of o.valueSpec.expression.parameters)d.add(S);if(d.size===0)return[];const m=[];return g instanceof i._&&!d.has(g.name)?[new i.V(o.key,o.value,`["${g.name}"] is not an allowed parameter`)]:(g.eachChild(S=>{m.push(...wt(S,o))}),m)}function Wt(g){const o=g.key,d=g.value,m=g.valueSpec,S=[];return Array.isArray(m.values)?m.values.indexOf(i.J(d))===-1&&S.push(new i.V(o,d,`expected one of [${m.values.join(", ")}], ${JSON.stringify(d)} found`)):Object.keys(m.values).indexOf(i.J(d))===-1&&S.push(new i.V(o,d,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(d)} found`)),S}function xn(g){return i.a2(i.S(g.value))?On(Object.assign({},g,{expressionContext:"filter",valueSpec:g.styleSpec[`filter_${g.layerType||"fill"}`]})):Rn(g)}function Rn(g){const o=g.value,d=g.key;if(!Array.isArray(o))return[new i.V(d,o,`array expected, ${i.K(o)} found`)];if(o.length<1)return[new i.V(d,o,"filter array must have at least 1 element")];const m=g.styleSpec;let S=Wt({key:`${d}[0]`,value:o[0],valueSpec:m.filter_operator});switch(i.J(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&i.J(o[1])==="$type"&&S.push(new i.V(d,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":o.length!==3&&S.push(new i.V(d,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(i.a0(o[1])||S.push(new i.V(`${d}[1]`,o[1],`string expected, ${i.K(o[1])} found`)));for(let A=2;A<o.length;A++)i.J(o[1])==="$type"?S=S.concat(Wt({key:`${d}[${A}]`,value:o[A],valueSpec:m.geometry_type})):i.a0(o[A])||i.L(o[A])||i.$(o[A])||S.push(new i.V(`${d}[${A}]`,o[A],`string, number, or boolean expected, ${i.K(o[A])} found.`));break;case"any":case"all":case"none":for(let A=1;A<o.length;A++)S=S.concat(Rn({key:`${d}[${A}]`,value:o[A],style:g.style,styleSpec:g.styleSpec}));break;case"has":case"!has":o.length!==2?S.push(new i.V(d,o,`filter array for "${o[0]}" operator must have 2 elements`)):i.a0(o[1])||S.push(new i.V(`${d}[1]`,o[1],`string expected, ${i.K(o[1])} found`))}return S}function Sn(g,o){const d=g.key,m=g.style,S=g.layer,A=g.styleSpec,k=g.value,N=g.objectKey,R=A[`${o}_${g.layerType}`];if(!R)return[];const V=N.match(/^(.*)-use-theme$/);if(V&&R[V[1]])return i.Q(k)?[].concat(fr({key:g.key,value:k,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:m,styleSpec:A,expressionContext:"property",propertyType:o,propertyKey:N})):fr({key:d,value:k,valueSpec:{type:"string"},style:m,styleSpec:A});const G=N.match(/^(.*)-transition$/);if(o==="paint"&&G&&R[G[1]]&&R[G[1]].transition)return fr({key:d,value:k,valueSpec:A.transition,style:m,styleSpec:A});const X=g.valueSpec||R[N];if(!X)return[new i.a3(d,k,`unknown property "${N}"`)];let W;if(i.a0(k)&&i.N(X)&&!X.tokens&&(W=/^{([^}]+)}$/.exec(k))){const ie=`\`{ "type": "identity", "property": ${W?JSON.stringify(W[1]):'"_"'} }\``;return[new i.V(d,k,`"${N}" does not support interpolation syntax
Use an identity property function instead: ${ie}.`)]}const te=[];if(g.layerType==="symbol")N!=="text-field"||!m||m.glyphs||m.imports||te.push(new i.V(d,k,'use of "text-field" requires a style "glyphs" property')),N==="text-font"&&i.a4(i.S(k))&&i.J(k.type)==="identity"&&te.push(new i.V(d,k,'"text-font" does not support identity functions'));else if(g.layerType==="model"&&o==="paint"&&S&&S.layout&&S.layout.hasOwnProperty("model-id")&&i.N(X)&&(i.a5(X)||i.O(X))){const ie=i.W(i.S(k),X),se=ie.value.expression||ie.value._styleExpression.expression;se&&!i.X(se,["measure-light"])&&(N==="model-emissive-strength"&&i.Y(se)&&i.Z(se)||te.push(new i.V(d,k,`${N} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return te.concat(fr({key:g.key,value:k,valueSpec:X,style:m,styleSpec:A,expressionContext:"property",propertyType:o,propertyKey:N}))}function Mn(g){return Sn(g,"paint")}function Ar(g){return Sn(g,"layout")}function Pr(g){let o=[];const d=g.value,m=g.key,S=g.style,A=g.styleSpec;if(!i.H(d))return[new i.V(m,d,"object expected")];d.type||d.ref||o.push(new i.V(m,d,'either "type" or "ref" is required'));let k=i.J(d.type);const N=i.J(d.ref);if(d.id){const R=i.J(d.id);for(let V=0;V<g.arrayIndex;V++){const G=S.layers[V];i.J(G.id)===R&&o.push(new i.V(m,d.id,`duplicate layer id "${R}", previously used at line ${G.id.__line__}`))}}if("ref"in d){let R;["type","source","source-layer","filter","layout"].forEach(V=>{V in d&&o.push(new i.V(m,d[V],`"${V}" is prohibited for ref layers`))}),S.layers.forEach(V=>{i.J(V.id)===N&&(R=V)}),R?R.ref?o.push(new i.V(m,d.ref,"ref cannot reference another ref layer")):k=i.J(R.type):typeof N=="string"&&o.push(new i.V(m,d.ref,`ref layer "${N}" not found`))}else if(k!=="background"&&k!=="sky"&&k!=="slot")if(d.source)if(i.a0(d.source)){const R=S.sources&&S.sources[d.source],V=R&&i.J(R.type);R?V==="vector"&&k==="raster"?o.push(new i.V(m,d.source,`layer "${d.id}" requires a raster source`)):V==="raster"&&k!=="raster"?o.push(new i.V(m,d.source,`layer "${d.id}" requires a vector source`)):V!=="vector"||d["source-layer"]?V==="raster-dem"&&k!=="hillshade"?o.push(new i.V(m,d.source,"raster-dem source can only be used with layer type 'hillshade'.")):V!=="raster-array"||["raster","raster-particle"].includes(k)?k==="line"&&d.paint&&(d.paint["line-gradient"]||d.paint["line-trim-offset"])&&V==="geojson"&&!R.lineMetrics?o.push(new i.V(m,d,`layer "${d.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):k==="raster-particle"&&V!=="raster-array"&&o.push(new i.V(m,d.source,`layer "${d.id}" requires a 'raster-array' source.`)):o.push(new i.V(m,d.source,"raster-array source can only be used with layer type 'raster'.")):o.push(new i.V(m,d,`layer "${d.id}" must specify a "source-layer"`)):o.push(new i.V(m,d.source,`source "${d.source}" not found`))}else o.push(new i.V(`${m}.source`,d.source,'"source" must be a string'));else o.push(new i.V(m,d,'missing required property "source"'));return o=o.concat(Ur({key:m,value:d,valueSpec:A.layer,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{"*":()=>[],type:()=>fr({key:`${m}.type`,value:d.type,valueSpec:A.layer.type,style:g.style,styleSpec:g.styleSpec,object:d,objectKey:"type"}),filter:R=>xn(Object.assign({layerType:k},R)),layout:R=>Ur({layer:d,key:R.key,value:R.value,valueSpec:{},style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":V=>Ar(Object.assign({layerType:k},V))}}),paint:R=>Ur({layer:d,key:R.key,value:R.value,valueSpec:{},style:R.style,styleSpec:R.styleSpec,objectElementValidators:{"*":V=>Mn(Object.assign({layerType:k,layer:d},V))}}),appearances(R){const V=Dr({key:R.key,value:R.value,valueSpec:R.valueSpec,style:R.style,styleSpec:R.styleSpec,arrayElementValidator:W=>function(te){const{key:ie,layer:se,layerType:ve}=te,ue=i.J(te.value),be=i.J(ue.name),Te=i.J(ue.condition),ke=Ur({key:ie,value:ue,valueSpec:te.styleSpec.appearance,style:te.style,styleSpec:te.styleSpec,objectElementValidators:{condition:Ue=>function(Fe){const Ve=[];return Ve.push(...On({key:Fe.key,value:Fe.object.condition,valueSpec:i.a6.appearance.condition,expressionContext:"appearance"})),Ve}(Object.assign({layer:se,layerType:ve},Ue)),properties:Ue=>function(Fe){const Ve=[],{styleSpec:ze,layer:Oe,layerType:Ge}=Fe,Tt=ze[`paint_${Ge}`],ut=ze[`layout_${Ge}`],jt=Fe.object[Fe.objectKey];for(const bt in jt){const Dt=bt in Tt?"paint":bt in ut?"layout":void 0;if(!Dt){Ve.push(new i.V(Fe.key,bt,`unknown property "${bt}" for layer type "${Ge}"`));continue}const gn=Object.assign({},Fe,{key:`${Fe.key}.${bt}`,object:jt,objectKey:bt,layer:Oe,layerType:Ge,value:jt[bt],valueSpec:Dt==="paint"?Tt[bt]:ut[bt]});Ve.push(...Sn(gn,Dt))}return Ve}(Object.assign({layer:se,layerType:ve},Ue))}});return be==="hidden"||Te||ke.push(new i.V(te.key,"name",'Appearance with name different than "hidden" must have a condition')),ke}(Object.assign({layerType:k,layer:d},W))}),G=Array.isArray(R.value)?R.value:[],X=new Set;return G.forEach((W,te)=>{const ie=i.J(W.name);if(ie)if(X.has(ie)){const se=i.J(d.id);V.push(new i.V(R.key,ie,`Duplicated appearance name "${ie}" for layer "${se}"`))}else X.add(ie)}),V}}})),o}function wr({key:g,value:o}){return i.a0(o)?[]:[new i.V(g,o,`string expected, ${i.K(o)} found`)]}const Qr={promoteId:function g({key:o,value:d}){if(i.a0(d))return wr({key:o,value:d});if(Array.isArray(d)){const S=[],A=i.S(d),k=i.U(A);return k.result==="error"&&k.value.forEach(N=>{S.push(new i.V(`${o}${N.key}`,null,`${N.message}`))}),i.X(k.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||S.push(new i.V(`${o}`,null,"promoteId expression should be only feature dependent")),S}if(!i.H(d))return[new i.V(o,d,`string, expression or object expected, "${i.K(d)}" found`)];const m=[];for(const S in d)m.push(...g({key:`${o}.${S}`,value:d[S]}));return m}};function dr(g){const o=g.value,d=g.key,m=g.styleSpec,S=g.style;if(!i.H(o))return[new i.V(d,o,`object expected, ${i.K(o)} found`)];if(!("type"in o))return[new i.V(d,o,'"type" is required')];const A=i.J(o.type);let k=[];switch(["vector","raster","raster-dem","raster-array"].includes(A)&&("url"in o||"tiles"in o||k.push(new i.a3(d,o,'Either "url" or "tiles" is required.'))),A){case"vector":case"raster":case"raster-dem":case"raster-array":return k=k.concat(Ur({key:d,value:o,valueSpec:m[`source_${A.replace("-","_")}`],style:g.style,styleSpec:m,objectElementValidators:Qr})),k;case"geojson":if(k=Ur({key:d,value:o,valueSpec:m.source_geojson,style:S,styleSpec:m,objectElementValidators:Qr}),"cluster"in o&&"clusterProperties"in o){if(!i.H(o.clusterProperties))return[new i.V(`${d}.clusterProperties`,o,`object expected, ${i.K(o)} found`)];for(const N in o.clusterProperties){const R=o.clusterProperties[N];if(!Array.isArray(R))return[new i.V(`${d}.clusterProperties.${N}`,R,"array expected")];const[V,G]=R,X=typeof V=="string"?[V,["accumulated"],["get",N]]:V;k.push(...On({key:`${d}.${N}.map`,value:G,expressionContext:"cluster-map"})),k.push(...On({key:`${d}.${N}.reduce`,value:X,expressionContext:"cluster-reduce"}))}}return k;case"video":return Ur({key:d,value:o,valueSpec:m.source_video,style:S,styleSpec:m});case"image":return Ur({key:d,value:o,valueSpec:m.source_image,style:S,styleSpec:m});case"canvas":return[new i.V(d,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Wt({key:`${d}.type`,value:o.type,valueSpec:{values:Hi(m)}})}}function Hi(g){return g.source.reduce((o,d)=>{const m=g[d];return m.type.type==="enum"&&(o=o.concat(Object.keys(m.type.values))),o},[])}function Bi(g){const o=g.value,d=g.styleSpec,m=d.light,S=g.style;if(o===void 0)return[];if(!i.H(o))return[new i.V("light",o,`object expected, ${i.K(o)} found`)];let A=[];for(const k in o){const N=k.match(/^(.*)-transition$/),R=k.match(/^(.*)-use-theme$/);A=A.concat(R&&m[R[1]]?fr({key:k,value:o[k],valueSpec:{type:"string"},style:S,styleSpec:d}):N&&m[N[1]]&&m[N[1]].transition?fr({key:k,value:o[k],valueSpec:d.transition,style:S,styleSpec:d}):m[k]?fr({key:k,value:o[k],valueSpec:m[k],style:S,styleSpec:d}):[new i.V(k,o[k],`unknown property "${k}"`)])}return A}function Cr(g){const o=g.value;if(!o)return[];const d=g.key;if(!i.H(o))return[new i.V(d,o,`object expected, ${i.K(o)} found`)];let m=[];const S=g.styleSpec,A=S["light-3d"],k=g.style,N=g.style.lights;for(const G of["type","id"])if(!(G in o))return m=m.concat([new i.V(d,o,`missing property "${G}"`)]),m;if(!i.a0(o.type))return m=m.concat([new i.V(`${d}.type`,o.type,"string expected")]),m;if(N)for(let G=0;G<g.arrayIndex;G++){const X=i.J(o.type),W=N[G];i.J(W.type)===X&&m.push(new i.V(d,o.id,`duplicate light type "${o.type}", previously defined at line ${W.id.__line__}`))}const R=`properties_light_${o.type}`;if(!(R in S))return m=m.concat([new i.V(`${d}.type`,o,`Invalid light type ${o.type}`)]),m;const V=S[R];for(const G in o)if(G==="properties"){const X=o[G];if(!i.H(X))return m=m.concat([new i.V("properties",X,`object expected, ${i.K(X)} found`)]),m;for(const W in X){const te=W.match(/^(.*)-transition$/),ie=W.match(/^(.*)-use-theme$/);m=m.concat(ie&&V[ie[1]]?fr({key:G,value:X[W],valueSpec:{type:"string"},style:k,styleSpec:S}):te&&V[te[1]]&&V[te[1]].transition?fr({key:G,value:o[G],valueSpec:S.transition,style:k,styleSpec:S}):V[W]?fr({key:W,value:X[W],valueSpec:V[W],style:k,styleSpec:S}):[new i.a3(g.key,X[W],`unknown property "${W}"`)])}}else m=m.concat(A[G]?fr({key:G,value:o[G],valueSpec:A[G],style:k,styleSpec:S}):[new i.a3(G,o[G],`unknown property "${G}"`)]);return m}function fi(g){const o=g.value,d=g.key,m=g.style,S=g.styleSpec,A=S.terrain;if(o==null)return[];if(!i.H(o))return[new i.V("terrain",o,`object expected, ${i.K(o)} found`)];let k=[];for(const N in o){const R=N.match(/^(.*)-transition$/),V=N.match(/^(.*)-use-theme$/);k=k.concat(V&&A[V[1]]?fr({key:N,value:o[N],valueSpec:{type:"string"},style:m,styleSpec:S}):R&&A[R[1]]&&A[R[1]].transition?fr({key:N,value:o[N],valueSpec:S.transition,style:m,styleSpec:S}):A[N]?fr({key:N,value:o[N],valueSpec:A[N],style:m,styleSpec:S}):[new i.a3(N,o[N],`unknown property "${N}"`)])}if(o.source)if(i.a0(o.source)){const N=m.sources&&m.sources[o.source],R=N&&i.J(N.type);N?R!=="raster-dem"&&k.push(new i.V(`${d}.source`,o.source,`terrain cannot be used with a source of type ${R}, it only be used with a "raster-dem" source type`)):k.push(new i.V(`${d}.source`,o.source,`source "${o.source}" not found`))}else k.push(new i.V(`${d}.source`,o.source,"source must be a string"));else k.push(new i.V(d,o,'terrain is missing required property "source"'));return k}function Cn(g){const o=g.value,d=g.style,m=g.styleSpec,S=m.fog;if(o===void 0)return[];if(!i.H(o))return[new i.V("fog",o,`object expected, ${i.K(o)} found`)];let A=[];for(const k in o){const N=k.match(/^(.*)-transition$/),R=k.match(/^(.*)-use-theme$/);A=A.concat(R&&S[R[1]]?fr({key:k,value:o[k],valueSpec:{type:"string"},style:d,styleSpec:m}):N&&S[N[1]]&&S[N[1]].transition?fr({key:k,value:o[k],valueSpec:m.transition,style:d,styleSpec:m}):S[k]?fr({key:k,value:o[k],valueSpec:S[k],style:d,styleSpec:m}):[new i.a3(k,o[k],`unknown property "${k}"`)])}return A}const bn={"*":()=>[],array:Dr,boolean:function(g){const o=g.value,d=g.key;return i.$(o)?[]:[new i.V(d,o,`boolean expected, ${i.K(o)} found`)]},number:Or,color:function({key:g,value:o}){return i.a0(o)?i.a1.parseCSSColor(o)===null?[new i.V(g,o,`color expected, "${o}" found`)]:[]:[new i.V(g,o,`color expected, ${i.K(o)} found`)]},enum:Wt,filter:xn,function:Br,layer:Pr,object:Ur,source:dr,model:i.a7,light:Bi,"light-3d":Cr,terrain:fi,fog:Cn,string:wr,formatted:function(g){return wr(g).length===0?[]:On(g)},resolvedImage:function(g){return wr(g).length===0?[]:On(g)},projection:function(g){const o=g.value,d=g.styleSpec,m=d.projection,S=g.style;if(i.H(o)){let A=[];for(const k in o)A=A.concat(fr({key:k,value:o[k],valueSpec:m[k],style:S,styleSpec:d}));return A}return i.a0(o)?[]:[new i.V("projection",o,`object or string expected, ${i.K(o)} found`)]},import:function(g){const o=g.key,{value:d,styleSpec:m}=g;if(!i.H(d))return[new i.V(o,d,"import must be an object")];const{data:S,...A}=d;Object.defineProperty(A,"__line__",{value:d.__line__,enumerable:!1});let k=Ur(Object.assign({},g,{value:A,valueSpec:m.import}));return i.J(A.id)===""&&k.push(new i.V(`${g.key}.id`,A,"import id can't be an empty string")),S&&(k=k.concat(_a(S,m,{key:`${g.key}.data`}))),k},iconset:function(g){const o=g.value,d=g.key,m=g.styleSpec,S=g.style;if(!i.H(o))return[new i.V(d,o,"object expected")];if(!o.type)return[new i.V(d,o,'"type" is required')];const A=i.J(o.type);let k=[];if(k=k.concat(Ur({key:d,value:o,valueSpec:m[`iconset_${A}`],style:S,styleSpec:m})),function(N,R){return!(N!=="source"||!R.source)}(A,o)){const N=S.sources&&S.sources[o.source],R=N&&i.J(N.type);N?R!=="raster-array"&&k.push(new i.V(d,o.source,`iconset cannot be used with a source of type ${String(R)}, it only be used with a "raster-array" source type`)):k.push(new i.V(d,o.source,`source "${o.source}" not found`))}return k}};function fr(g,o=!1){const d=g.value,m=g.valueSpec,S=g.styleSpec;if(m.expression){if(i.a4(i.J(d)))return Br(g);if(i.Q(i.S(d)))return On(g)}if(m.type&&bn[m.type]){const A=bn[m.type](g);return o===!0&&A.length>0&&Array.isArray(g.value)?On(g):A}return Ur(Object.assign({},g,{valueSpec:m.type?S[m.type]:m}))}function Ur(g){const o=g.key,d=g.value,m=g.valueSpec||{},S=g.objectElementValidators||{},A=g.style,k=g.styleSpec;if(!i.H(d))return[new i.V(o,d,`object expected, ${i.K(d)} found`)];let N=[];for(const R in d){const V=R.split(".")[0];let G;S[V]?G=S[V]:m[V]?G=fr:S["*"]?G=S["*"]:m["*"]&&(G=fr),G?N=N.concat(G({key:(o&&`${o}.`)+R,value:d[R],valueSpec:m[V]||m["*"],style:A,styleSpec:k,object:d,objectKey:R},d)):N.push(new i.a3(o,d[R],`unknown property "${R}"`))}for(const R in m)S[R]||m[R].required&&m[R].default===void 0&&d[R]===void 0&&N.push(new i.V(o,d,`missing required property "${R}"`));return N}function Xs({key:g,value:o}){const d=wr({key:g,value:o});if(d.length)return d;const m=o;return m.indexOf("{fontstack}")===-1&&d.push(new i.V(g,o,'"glyphs" url must include a "{fontstack}" token')),m.indexOf("{range}")===-1&&d.push(new i.V(g,o,'"glyphs" url must include a "{range}" token')),d}function _a(g,o=i.a6,d={}){return Ur({key:d.key||"",value:g,valueSpec:Object.assign(o.$root,{"*":{type:"*"}}),styleSpec:o,style:g,objectElementValidators:{glyphs:Xs}})}function ts(g,o=i.a6){return He(_a(g,o))}const _i=g=>He(dr(g)),xs=g=>He(Bi(g)),Pi=g=>He(Cr(g)),zt=g=>He(fi(g)),es=g=>He(Cn(g)),ja=g=>He(function(o){const d=o.value,m=o.style,S=o.styleSpec,A=S.snow;if(d===void 0)return[];if(!i.H(d))return[new i.V("snow",d,`object expected, ${i.K(d)} found`)];let k=[];for(const N in d){const R=N.match(/^(.*)-transition$/);k=k.concat(R&&A[R[1]]&&A[R[1]].transition?fr({key:N,value:d[N],valueSpec:S.transition,style:m,styleSpec:S}):A[N]?fr({key:N,value:d[N],valueSpec:A[N],style:m,styleSpec:S}):[new i.a3(N,d[N],`unknown property "${N}"`)])}return k}(g)),qr=g=>He(function(o){const d=o.value,m=o.style,S=o.styleSpec,A=S.rain;if(d===void 0)return[];if(!i.H(d))return[new i.V("rain",d,`object expected, ${i.K(d)} found`)];let k=[];for(const N in d){const R=N.match(/^(.*)-transition$/);k=k.concat(R&&A[R[1]]&&A[R[1]].transition?fr({key:N,value:d[N],valueSpec:S.transition,style:m,styleSpec:S}):A[N]?fr({key:N,value:d[N],valueSpec:A[N],style:m,styleSpec:S}):[new i.a3(N,d[N],`unknown property "${N}"`)])}return k}(g)),lt=g=>He(Pr(g)),de=g=>He(xn(g)),_e=g=>He(Mn(g)),Ie=g=>He(Ar(g)),Xe=g=>He(i.a7(g));function He(g){return g.slice().sort((o,d)=>o.line&&d.line?o.line-d.line:0)}function We(g,o){let d=!1;if(o&&o.length)for(const m of o)m instanceof i.a3?i.w(m.message):(g.fire(new i.y(new Error(m.message))),d=!0);return d}let kt;class ot extends i.E{constructor(o,d="flat"){super(),this._transitionable=new i.a8(kt||(kt=new i.a9({anchor:new i.aa(i.a6.light.anchor),position:new i.ab(i.a6.light.position),color:new i.aa(i.a6.light.color),intensity:new i.aa(i.a6.light.intensity)}))),this.setLight(o,d),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,d,m={}){this._validate(xs,o,m)||(this._transitionable.setTransitionOrValue(o),this.id=d)}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,m){return(!m||m.validate!==!1)&&We(this,o.call(ts,Object.assign({value:d,style:{glyphs:!0,sprite:!0},styleSpec:i.a6})))}}let Et=class extends i.E{constructor(g,o,d,m,S){super(),this.scope=d,this._transitionable=new i.a8(new i.a9({source:new i.aa(i.a6.terrain.source),exaggeration:new i.aa(i.a6.terrain.exaggeration)}),d,m),this._transitionable.setTransitionOrValue(g,m),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o,this.worldview=S}get(){return this._transitionable.serialize()}set(g,o){this._transitionable.setTransitionOrValue(g,o)}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}getExaggeration(g){return this._transitioning.possiblyEvaluate(new i.ac(g,{worldview:this.worldview})).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const g=this._transitionable._values.exaggeration;if(!g)return null;const o=g.value.expression;if(!o)return null;let d=-1,m=-1,S=1;for(const A of o.zoomStops)S=o.evaluate(new i.ac(A,{worldview:this.worldview})),S>.01?(d=A,m=-1):m=A;return S<.01&&d>0&&m>d?[d,m]:null}isZoomDependent(){const g=this._transitionable._values.exaggeration;return g!=null&&g.value!=null&&g.value.expression!=null&&g.value.expression instanceof i.ad}};const on=45,Yt=65,Vn=.05;function ar(g,o,d,m){const S=i.ah(on,Yt,d),[A,k]=vr(g,m);let N=1-Math.min(1,Math.exp((o-A)/(k-A)*-6));return N*=N*N,N=Math.min(1,1.00747*N),N*S*g.alpha}function vr(g,o){const d=.5/Math.tan(.5*o);return[g.range[0]+d,g.range[1]+d]}function Gr(g,o,d,m,S){const A=i.af([],[o,d,m],S.mercatorFogMatrix);return ar(g,i.ag(A),S.pitch,S._fov)}function Fr(g,o,d,m,S,A,k){const N=[[d,m,0],[S,m,0],[S,A,0],[d,A,0]];let R=Number.MAX_VALUE,V=-Number.MAX_VALUE;for(const G of N){const X=i.af([],G,o),W=i.ag(X);R=Math.min(R,W),V=Math.max(V,W)}return[ar(g,R,k.pitch,k._fov),ar(g,V,k.pitch,k._fov)]}class pi extends i.E{constructor(o,d,m,S){super();const A=new i.a9({range:new i.aa(i.a6.fog.range),color:new i.aa(i.a6.fog.color),"color-use-theme":new i.aa({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.aa(i.a6.fog["high-color"]),"high-color-use-theme":new i.aa({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.aa(i.a6.fog["space-color"]),"space-color-use-theme":new i.aa({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.aa(i.a6.fog["horizon-blend"]),"star-intensity":new i.aa(i.a6.fog["star-intensity"]),"vertical-range":new i.aa(i.a6.fog["vertical-range"])});this._transitionable=new i.a8(A,m,new Map(S)),this.set(o,S),this._transitioning=this._transitionable.untransitioned(),this._transform=d,this.properties=new i.ai(A),this.scope=m}get state(){const o=this._transform,d=o.projection.name==="globe",m=i.aj(o.zoom),S=this.properties.get("range"),A=[.5,3];return{range:d?[i.ak(A[0],S[0],m),i.ak(A[1],S[1],m)]:S,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,d,m={}){if(this._validate(es,o,m))return;const S=Object.assign({},o);for(const A of Object.keys(i.a6.fog))S[A]===void 0&&(S[A]=i.a6.fog[A].default);this._options=S,this._transitionable.setTransitionOrValue(this._options,d)}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const d=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.ah(on,Yt,o))*d.a}getOpacityAtLatLng(o,d){return this._transform.projection.supportsFog?function(m,S,A){const k=i.ae.fromLngLat(S),N=A.elevation?A.elevation.getAtPointOrZero(k):0;return Gr(m,k.x,k.y,N,A)}(this.state,o,d):0}getOpacityForTile(o){if(!this._transform.projection.supportsFog)return[1,1];const d=this._transform.calculateFogTileMatrix(o.toUnwrapped());return Fr(this.state,d,0,0,i.al,i.al,this._transform)}getOpacityForBounds(o,d,m,S,A){return this._transform.projection.supportsFog?Fr(this.state,o,d,m,S,A,this._transform):[1,1]}getFovAdjustedRange(o){return this._transform.projection.supportsFog?vr(this.state,o):[0,1]}isVisibleOnFrustum(o){if(!this._transform.projection.supportsFog)return!1;const d=[4,5,6,7];for(const m of d){const S=o.points[m];let A;if(S[2]>=0)A=S;else{const k=o.points[m-4];A=i.am(k,S,k[2]/(k[2]-S[2]))}if(Gr(this.state,A[0],A[1],0,this._transform)>=Vn)return!0}return!1}updateConfig(o){this._transitionable.setTransitionOrValue(this._options,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,m){return(!m||m.validate!==!1)&&We(this,o.call(ts,Object.assign({value:d,style:{glyphs:!0,sprite:!0},styleSpec:i.a6})))}}let Vi,ai,Js,ha,xa=class extends i.E{constructor(g,o,d,m){super();const S=Vi||(Vi=new i.a9({density:new i.aa(i.a6.snow.density),intensity:new i.aa(i.a6.snow.intensity),color:new i.aa(i.a6.snow.color),opacity:new i.aa(i.a6.snow.opacity),vignette:new i.aa(i.a6.snow.vignette),"vignette-color":new i.aa(i.a6.snow["vignette-color"]),"center-thinning":new i.aa(i.a6.snow["center-thinning"]),direction:new i.aa(i.a6.snow.direction),"flake-size":new i.aa(i.a6.snow["flake-size"])}));this._transitionable=new i.a8(S,d,new Map(m)),this.set(g,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ai(S),this.scope=d}get state(){const g=this.properties.get("opacity"),o=this.properties.get("color"),d=this.properties.get("direction"),m=i.an(d[0]),S=-Math.max(i.an(d[1]),.01),A=[Math.cos(m)*Math.cos(S),Math.sin(m)*Math.cos(S),Math.sin(S)],k=this.properties.get("vignette"),N=this.properties.get("vignette-color");return N.a=k,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.ao(o.r,o.g,o.b,o.a*g),direction:A,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:N}}get(){return this._transitionable.serialize()}set(g,o,d={}){if(this._validate(ja,g,d))return;const m=Object.assign({},g);for(const S of Object.keys(i.a6.snow))m[S]===void 0&&(m[S]=i.a6.snow[S].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,o)}updateConfig(g){this._transitionable.setTransitionOrValue(this._options,new Map(g))}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}_validate(g,o,d){return(!d||d.validate!==!1)&&We(this,g.call(ts,Object.assign({value:o,style:{glyphs:!0,sprite:!0},styleSpec:i.a6})))}},Wi=class extends i.E{constructor(g,o,d,m){super();const S=ai||(ai=new i.a9({density:new i.aa(i.a6.rain.density),intensity:new i.aa(i.a6.rain.intensity),color:new i.aa(i.a6.rain.color),opacity:new i.aa(i.a6.rain.opacity),vignette:new i.aa(i.a6.rain.vignette),"vignette-color":new i.aa(i.a6.rain["vignette-color"]),"center-thinning":new i.aa(i.a6.rain["center-thinning"]),direction:new i.aa(i.a6.rain.direction),"droplet-size":new i.aa(i.a6.rain["droplet-size"]),"distortion-strength":new i.aa(i.a6.rain["distortion-strength"])}));this._transitionable=new i.a8(S,d,new Map(m)),this.set(g,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ai(S),this.scope=d}get state(){const g=this.properties.get("opacity"),o=this.properties.get("color"),d=this.properties.get("direction"),m=i.an(d[0]),S=-Math.max(i.an(d[1]),.01),A=[Math.cos(m)*Math.cos(S),Math.sin(m)*Math.cos(S),Math.sin(S)],k=this.properties.get("vignette-color");return k.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.ao(o.r,o.g,o.b,o.a*g),direction:A,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:k}}get(){return this._transitionable.serialize()}set(g,o,d={}){if(this._validate(qr,g,d))return;const m=Object.assign({},g);for(const S of Object.keys(i.a6.rain))m[S]===void 0&&(m[S]=i.a6.rain[S].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,o)}updateConfig(g){this._transitionable.setTransitionOrValue(this._options,new Map(g))}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}_validate(g,o,d){return(!d||d.validate!==!1)&&We(this,g.call(ts,Object.assign({value:o,style:{glyphs:!0,sprite:!0},styleSpec:i.a6})))}};class bi extends i.E{constructor(o,d,m,S){super(),this.scope=m,this._options=o,this.properties=new i.ai(d),this._transitionable=new i.a8(d,m,new Map(S)),this._transitionable.setTransitionOrValue(o.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(o){this._transitionable.setTransitionOrValue(this._options.properties,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(o,d){this._options=o,this._transitionable.setTransitionOrValue(o.properties,d)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Ns{constructor(o,d,m){this.screenBounds=o,this.cameraPoint=m.getCameraPoint(),this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=d,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,m)}static createFromScreenPoints(o,d){let m,S;if(o instanceof i.P||typeof o[0]=="number"){const A=i.P.convert(o);m=[A],S=d.isPointAboveHorizon(A)}else{const A=i.P.convert(o[0]),k=i.P.convert(o[1]),N=A.add(k)._div(2);m=[A,k],S=i.aq(A,k).every(R=>d.isPointAboveHorizon(R))&&d.isPointAboveHorizon(N)}return new Ns(m,S,d)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return i.aq(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const d=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],S=i.aq(d,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>d.x&&this.cameraPoint.x<m.x?S.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?S[2]=this.cameraPoint:this.cameraPoint.x<=d.x&&(S[3]=this.cameraPoint)),i.ar(S,o)}bufferedCameraGeometryGlobe(o){const d=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],S=i.aq(d,m,o),A=this.cameraPoint.clone();switch(3*((A.y>d.y)+(A.y>m.y))+((A.x>d.x)+(A.x>m.x))){case 0:S[0]=A,S[4]=A.clone();break;case 1:S.splice(1,0,A);break;case 2:S[1]=A;break;case 3:S.splice(4,0,A);break;case 5:S.splice(2,0,A);break;case 6:S[3]=A;break;case 7:S.splice(3,0,A);break;case 8:S[2]=A}return S}containsTile(o,d,m,S=0){const A=o.queryPadding/d._pixelsPerMercatorPixel+1,k=m?this._bufferedCameraMercator(A,d):this._bufferedScreenMercator(A,d);let N=o.tileID.wrap+(k.unwrapped?S:0);const R=k.polygon.map(ve=>i.as(o.tileTransform,ve,N));if(!i.at(R,0,0,i.al,i.al))return;N=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?S:0);const V=this.screenGeometryMercator.polygon.map(ve=>i.au(o.tileTransform,ve,N)),G=V.map(ve=>new i.P(ve[0],ve[1])),X=d.getFreeCameraOptions().position||new i.ae(0,0,0),W=i.au(o.tileTransform,X,N),te=V.map(ve=>{const ue=i.av(ve,ve,W);return i.aw(ue,ue),new i.ax(W,ue)}),ie=i.ay(o,1,d.zoom)*d._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:G,tilespaceRays:te,bufferedTilespaceGeometry:R,bufferedTilespaceBounds:(se=i.az(R),se.min.x=i.aA(se.min.x,0,i.al),se.min.y=i.aA(se.min.y,0,i.al),se.max.x=i.aA(se.max.x,0,i.al),se.max.y=i.aA(se.max.y,0,i.al),se),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:ie};var se}_bufferedScreenMercator(o,d){const m=Ja(o);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{let S;return S=d.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(o),d):{polygon:this.bufferedScreenGeometry(o).map(A=>d.pointCoordinate3D(A)),unwrapped:!0},this._screenRaycastCache[m]=S,S}}_bufferedCameraMercator(o,d){const m=Ja(o);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{let S;return S=d.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),d):{polygon:this.bufferedCameraGeometry(o).map(A=>d.pointCoordinate3D(A)),unwrapped:!0},this._cameraRaycastCache[m]=S,S}}_projectAndResample(o,d){const m=function(A,k){const N=i.aB([],k.pixelMatrix,k.globeMatrix),R=[0,-i.aD,0,1],V=[0,i.aD,0,1],G=[0,0,0,1];i.aC(R,R,N),i.aC(V,V,N),i.aC(G,G,N);const X=new i.P(R[0]/R[3],R[1]/R[3]),W=new i.P(V[0]/V[3],V[1]/V[3]),te=i.aE(A,X)&&R[3]<G[3],ie=i.aE(A,W)&&V[3]<G[3];if(!te&&!ie)return null;const se=function(Ve,ze,Oe){for(let Ge=1;Ge<Ve.length;Ge++){const Tt=as(ze.pointCoordinate3D(Ve[Ge-1]).x),ut=as(ze.pointCoordinate3D(Ve[Ge]).x);if(Oe<0){if(Tt<ut)return{idx:Ge,t:-Tt/(ut-1-Tt)}}else if(ut<Tt)return{idx:Ge,t:(1-Tt)/(ut+1-Tt)}}return null}(A,k,te?-1:1);if(!se)return null;const{idx:ve,t:ue}=se;let be=ve>1?zs(A.slice(0,ve),k):[],Te=ve<A.length?zs(A.slice(ve),k):[];be=be.map(Ve=>new i.P(as(Ve.x),Ve.y)),Te=Te.map(Ve=>new i.P(as(Ve.x),Ve.y));const ke=[...be];ke.length===0&&ke.push(Te[Te.length-1]);const Ue=i.ak(ke[ke.length-1].y,(Te.length===0?be[0]:Te[0]).y,ue);let Fe;return Fe=te?[new i.P(0,Ue),new i.P(0,0),new i.P(1,0),new i.P(1,Ue)]:[new i.P(1,Ue),new i.P(1,1),new i.P(0,1),new i.P(0,Ue)],ke.push(...Fe),Te.length===0?ke.push(be[0]):ke.push(...Te),{polygon:ke.map(Ve=>new i.ae(Ve.x,Ve.y)),unwrapped:!1}}(o,d);if(m)return m;const S=function(A,k){let N=!1,R=-1/0,V=0;for(let X=0;X<A.length-1;X++)A[X].x>R&&(R=A[X].x,V=X);for(let X=0;X<A.length-1;X++){const W=(V+X)%(A.length-1),te=A[W],ie=A[W+1];Math.abs(te.x-ie.x)>.5&&(te.x<ie.x?(te.x+=1,W===0&&(A[A.length-1].x+=1)):(ie.x+=1,W+1===A.length-1&&(A[0].x+=1)),N=!0)}const G=i.aF(k.center.lng);return N&&G<Math.abs(G-1)&&A.forEach(X=>{X.x-=1}),{polygon:A,unwrapped:N}}(zs(o,d).map(A=>new i.P(as(A.x),A.y)),d);return{polygon:S.polygon.map(A=>new i.ae(A.x,A.y)),unwrapped:S.unwrapped}}}function zs(g,o){return i.aG(g,d=>{const m=o.pointCoordinate3D(d);d.x=m.x,d.y=m.y},1/256)}function as(g){return g<0?1+g%1:g%1}function Ja(g){return 100*g|0}function Vo(g,o,d,m,S){const A=function(N,R){if(N)return S(N);if(R){if(g.url&&R.tiles&&g.tiles&&delete g.tiles,R.variants){if(!Array.isArray(R.variants))return S(new Error("variants must be an array"));for(const G of R.variants){if(G==null||typeof G!="object"||G.constructor!==Object)return S(new Error("variant must be an object"));if(!Array.isArray(G.capabilities))return S(new Error("capabilities must be an array"));if(G.capabilities.length===1&&G.capabilities[0]==="meshopt"){R=Object.assign(R,G);break}}}const V=i.aH(Object.assign({},R,g),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);V.tiles=o.canonicalizeTileset(V,g.url),S(null,V)}},k=function(N,R,V){if(!N)return null;if(!R&&!V)return N;V=V||N.worldview_default;const G=Object.values(N.language||{});if(G.length===0)return null;const X=Object.values(N.worldview||{});if(X.length===0)return null;const W=G.every(ie=>ie===R),te=X.every(ie=>ie===V);return W&&te?N:R in(N.language_options||{})||V in(N.worldview_options||{})?null:N.language_options&&N.worldview_options?N:null}(g.data,d,m);return k?i.o.frame(()=>A(null,k)):g.url?i.m(o.transformRequest(o.normalizeSourceURL(g.url,null,d,m),i.R.Source),A):i.o.frame(()=>{const{data:N,...R}=g;A(null,R)})}function Cl(g,o){const d=Math.pow(2,o.z),m=Math.floor(i.aF(g.getWest())*d),S=Math.floor(i.aJ(g.getNorth())*d),A=Math.ceil(i.aF(g.getEast())*d),k=Math.ceil(i.aJ(g.getSouth())*d);return o.x>=m&&o.x<A&&o.y>=S&&o.y<k}class ac{constructor(o,d,m){this.bounds=o?i.aI.convert(this.validateBounds(o)):null,this.minzoom=d||0,this.maxzoom=m||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}addExtraBounds(o){if(o){this.extraBounds||(this.extraBounds=[]);for(const d of o)this.extraBounds.push(i.aI.convert(this.validateBounds(d)))}}contains(o){if(o.z>this.maxzoom||o.z<this.minzoom||this.bounds&&!Cl(this.bounds,o))return!1;if(!this.extraBounds)return!0;for(const d of this.extraBounds)if(Cl(d,o))return!0;return!1}static fromTileJSON(o){if(!o.bounds&&!o.extra_bounds)return null;const d=new ac(o.bounds,o.minzoom,o.maxzoom);return d.addExtraBounds(o.extra_bounds),d}}class $o extends i.E{constructor(o,d,m,S){if(super(),this.id=o,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Object.assign(this,i.aH(d,["url","scheme","tileSize","promoteId"])),this._options=Object.assign({type:"vector"},d),this._collectResourceTiming=!!d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S),this._tileWorkers={},this._deduped=new i.aK}load(o){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const d=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map.getWorldview();this._tileJSONRequest=Vo(this._options,this.map._requestManager,d,m,(S,A)=>{if(this._tileJSONRequest=null,this._loaded=!0,S)d&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${d}`),m&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new i.y(S));else if(A){if(Object.assign(this,A),this.hasWorldviews=!!A.worldview_options,A.worldview_default&&(this.worldviewDefault=A.worldview_default),A.vector_layers){this.vectorLayers=A.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const k of A.vector_layers)this.vectorLayerIds.push(k.id),A.worldview&&A.worldview[k.source]&&this.localizableLayerIds.add(k.id)}this.tileBounds=ac.fromTileJSON(A),me(A.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}o&&o(S)})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();const o=i.B(this.id,this.scope);this.load(()=>this.map.style.clearSource(o))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(o){this.cancelTileJSONRequest()}serialize(){return Object.assign({},this._options)}loadTile(o,d){const m=o.tileID.canonical.url(this.tiles,this.scheme),S=this.map._requestManager.normalizeTileURL(m),A=this.map._requestManager.transformRequest(S,i.R.Tile),k=this.map.style?this.map.style.getLut(this.scope):null,N=k?{image:k.image.clone()}:null,R={request:A,data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,lut:N,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.o.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:o.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:o.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor(),worldview:this.map.getWorldview()||this.worldviewDefault};if(this.hasWorldviews&&i.h(m)&&(R.localizableLayerIds=this.localizableLayerIds),R.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired")o.state==="loading"?o.reloadCallback=d:o.request=o.actor.send("reloadTile",R,V.bind(this));else if(o.actor=this._tileWorkers[S]=this._tileWorkers[S]||this.dispatcher.getActor(),this.dispatcher.ready)o.request=o.actor.send("loadTile",R,V.bind(this),void 0,!0);else{const G=i.aL.call({deduped:this._deduped},R,(X,W)=>{X||!W?V.call(this,X):(R.data={cacheControl:W.cacheControl,expires:W.expires,rawData:W.rawData.slice(0)},o.actor&&o.actor.send("loadTile",R,V.bind(this),void 0,!0))},!0);o.request={cancel:G}}function V(G,X){return delete o.request,o.aborted?d(null):G&&G.status!==404?d(G):(X&&X.resourceTiming&&(o.resourceTiming=X.resourceTiming),this.map._refreshExpiredTiles&&X&&o.setExpiryData(X),o.loadVectorData(X,this.map.painter),i.aM(this.dispatcher),d(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(o,d){o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope}),o.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Pa extends i.E{constructor(o,d,m,S){super(),this.id=o,this.dispatcher=m,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Object.assign({type:"raster"},d),Object.assign(this,i.aH(d,["url","scheme","tileSize"]))}load(o){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const d=this.map.getWorldview();this._tileJSONRequest=Vo(this._options,this.map._requestManager,null,d,(m,S)=>{this._tileJSONRequest=null,this._loaded=!0,m?this.fire(new i.y(m)):S&&(Object.assign(this,S),S.raster_layers&&(this.rasterLayers=S.raster_layers,this.rasterLayerIds=this.rasterLayers.map(A=>A.id)),this.tileBounds=ac.fromTileJSON(S),me(S.tiles),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),o&&o(m)})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();const o=i.B(this.id,this.scope);this.load(()=>this.map.style.clearSource(o))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(o){this.cancelTileJSONRequest()}serialize(){return Object.assign({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,d){const m=i.o.devicePixelRatio>=2,S=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);o.request=i.n(this.map._requestManager.transformRequest(S,i.R.Tile),(A,k,N,R)=>(delete o.request,o.aborted?(o.state="unloaded",d(null)):A?(o.state="errored",d(A)):k?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:N,expires:R}),o.setTexture(k,this.map.painter),o.state="loaded",i.aM(this.dispatcher),void d(null)):d(null)))}abortTile(o,d){o.request&&(o.request.cancel(),delete o.request),d&&d()}unloadTile(o,d){o.texture&&o.texture instanceof i.T?(o.destroy(!0),o.texture&&o.texture instanceof i.T&&this.map.painter.saveTileTexture(o.texture)):o.destroy(),d&&d()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Qm([g,o],d,m,{scaled:S=!0}={}){const{tileSize:A,buffer:k}=m,{x:N,y:R,z:V}=d;if(!isFinite(N)||!isFinite(R)||!isFinite(V))throw new Error("Invalid MRT header");const G=2**V,X=G*i.aF(g),W=G*i.aJ(o);return function([te,ie],se,{scaled:ve=!0}={}){if(!se)throw new Error("bandView is undefined");const{data:ue,tileSize:be,buffer:Te,offset:ke,scale:Ue,dimension:Fe}=se;if(te<-Te||te>be+Te||ie<-Te||ie>be+Te)throw new Error(`Point (${te}, ${ie}) out of bounds for tileSize=${be}, buffer=${Te}`);const Ve=(ie+Te)*(be+2*Te)+(te+Te);if(new Uint32Array(ue.buffer)[Ve]===4294967295)return null;let ze=[];ze=ve?[]:new se.data.constructor(Fe);for(let Oe=0;Oe<Fe;Oe++)ze[Oe]=Math.round(1e12*(ue[Fe*Ve+Oe]*Ue+ke))/1e12;return ze}([Math.min(Math.max(-k,Math.floor((X-N)*A)),A-1+k),Math.min(Math.max(-k,Math.floor((W-R)*A)),A-1+k)],m,{scaled:S})}class ku extends Pa{constructor(o,d,m,S){super(o,d,m,S),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._loadTilePending={},this._loadTileLoaded={},this._options=Object.assign({type:"raster-array"},d)}triggerRepaint(o){const d=this.map.painter._terrain,m=this.map.style.getSourceCache(this.id);d&&d.enabled&&m&&d._clearRenderCacheForTile(m.id,o.tileID),this.map.triggerRepaint()}loadTile(o,d){const m=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),S=this.map._requestManager.transformRequest(m,i.R.Tile),A={request:S,uid:o.uid,tileID:o.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};o.source=this.id,o.scope=this.scope,o.requestParams=S,o.actor||(o.actor=this.dispatcher.getActor());const k=(N,R,V,G)=>{if(delete o.request,o.aborted)return o.state="unloaded",d(null);if(N)return N.name==="AbortError"?void 0:(o.state="errored",d(N));if(this.map._refreshExpiredTiles&&R&&o.setExpiryData({cacheControl:V,expires:G}),this.partial&&o.state!=="expired")o.state="empty";else if(!this.partial){if(!R)return d(null);o.state="loaded",o._isHeaderLoaded=!0,o._mrt=R}d(null)};o.request=this.partial?o.fetchHeader(void 0,k.bind(this)):o.actor.send("loadTile",A,k.bind(this),void 0,!0)}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(o,d){const m=o.texturePerLayer;if(o.flushAllQueues(),m.size){o.destroy(!0);for(const S of m.values())this.map.painter.saveTileTexture(S)}else o.destroy()}prepareTile(o,d,m,S){o._isHeaderLoaded&&(o.state!=="empty"&&(o.state="reloading"),o.fetchBandForRender(d,m,S,(A,k)=>{if(A)return o.state="errored",this.fire(new i.y(A)),void this.triggerRepaint(o);k&&(o._isHeaderLoaded=!0,o.setTexturePerLayer(m,k,this.map.painter),o.state="loaded",this.triggerRepaint(o))}))}getInitialBand(o){if(!this.rasterLayers)return 0;const d=this.rasterLayers.find(({id:A})=>A===o),m=d&&d.fields,S=m&&m.bands&&m.bands;return S?S[0]:0}getTextureDescriptor(o,d,m){if(!o)return;const S=d.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!S)return;let A=null;d instanceof i.aP?A=d.paint.get("raster-array-band"):d instanceof i.aQ&&(A=d.paint.get("raster-particle-array-band"));const k=A||this.getInitialBand(S);if(k==null)return;if(!o.textureDescriptorPerLayer.get(d.id))return void this.prepareTile(o,S,d.id,k);if(o.updateNeeded(d.id,k)&&!m)return;const N=o.textureDescriptorPerLayer.get(d.id);return Object.assign({},N,{texture:o.texturePerLayer.get(d.id)})}getImages(o,d){const m=new Map;for(const S of o)for(const A of d){const[k,N]=A.split("/"),R=S.getLayer(k);if(!R||!R.hasBand(N)||!R.hasDataForBand(N))continue;const{bytes:V,tileSize:G,buffer:X}=R.getBandView(N),W=G+2*X,te={data:new i.q({width:W,height:W},V),pixelRatio:2,sdf:!1,usvg:!1,version:0};m.set(A,te)}return m}queryRasterArrayValueByBandId(o,d,m){const S=d._mrt;return new Promise(A=>{const k={},N=new Set;for(const[R,V]of Object.entries(S.layers)){if(m.layerName&&R!==m.layerName)continue;const G={};k[R]=G;for(const{bands:X}of V.dataIndex)for(const W of X)m.bands&&!m.bands.includes(W)||(N.add(i.B(R,W)),d.fetchBand(R,null,W,te=>{i.o.frame(()=>{G[W]=te?null:Qm([o.lng,o.lat],S,V.getBandView(W)),N.delete(i.B(R,W)),N.size===0&&A(k)})},!1))}N.size===0&&A(k)})}_loadTileForQuery(o,d){if(this._loadTileLoaded[o.uid])return void d(null,o._mrt);if(this._loadTilePending[o.uid])return void this._loadTilePending[o.uid].push(d);this._loadTilePending[o.uid]=[d];const m=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),S=this.map._requestManager.transformRequest(m,i.R.Tile);o.actor.send("loadTile",{request:S,uid:o.uid,tileID:o.tileID,type:this.type,source:this.id,scope:this.scope,partial:!1},(A,k,N,R)=>A?(this._loadTilePending[o.uid].forEach(V=>V(A,null)),void delete this._loadTilePending[o.uid]):k?(this.map._refreshExpiredTiles&&k&&o.setExpiryData({cacheControl:N,expires:R}),o._mrt=k,o._isHeaderLoaded=!0,o.state="loaded",this._loadTilePending[o.uid].forEach(V=>V(null,k)),this._loadTileLoaded[o.uid]=!0,void delete this._loadTilePending[o.uid]):(this._loadTilePending[o.uid].forEach(V=>V(null,null)),void delete this._loadTilePending[o.uid]),void 0,!0)}queryRasterArrayValueByAllBands(o,d,m){return new Promise((S,A)=>{this._loadTileForQuery(d,(k,N)=>{k?A(k):S(N?this.queryRasterArrayValueByBandId(o,d,m):null)})})}queryRasterArrayValue(o,d){const m=i.aR.convert(o),S=this.findLoadedParent(m);return S&&S._mrt?d.bands||!this.partial?this.queryRasterArrayValueByBandId(m,S,d):this.queryRasterArrayValueByAllBands(m,S,d):Promise.resolve(null)}findLoadedParent(o){const d=i.ae.fromLngLat(o,this.map.transform.tileSize),m=this.maxzoom+1,S=1<<m,A=Math.floor(d.x),k=Math.floor((d.x-A)*S),N=Math.floor(d.y*S),R=this.map.style.getSourceCache(this.id),V=new i.aO(m,A,m,k,N);return R.findLoadedParent(V,this.minzoom)}}const oc={vector:$o,raster:Pa,"raster-dem":class extends Pa{constructor(g,o,d,m){super(g,o,d,m),this.type="raster-dem",this.maxzoom=22,this._options=Object.assign({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(g,o){const d=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(S,A){S&&(g.state="errored",o(S)),A&&(g.dem=A,g.dem.onDeserialize(),g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0,g.state="loaded",o(null))}g.request=i.n(this.map._requestManager.transformRequest(d,i.R.Tile),(function(S,A,k,N){if(delete g.request,g.aborted)g.state="unloaded",o(null);else if(S)g.state="errored",o(S);else if(A){this.map._refreshExpiredTiles&&g.setExpiryData({cacheControl:k,expires:N});const R=ImageBitmap&&A instanceof ImageBitmap&&i.r(),V=1-(A.width-i.aN(A.width))/2;V<1||g.neighboringTiles||(g.neighboringTiles=this._getNeighboringTiles(g.tileID));const G=R?A:i.o.getImageData(A,V),X={uid:g.uid,tileID:g.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:G,encoding:this.encoding,padding:V};g.actor&&g.state!=="expired"||(g.actor=this.dispatcher.getActor(),g.actor.send("loadTile",X,m.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(g){const o=g.canonical,d=Math.pow(2,o.z),m=(o.x-1+d)%d,S=o.x===0?g.wrap-1:g.wrap,A=(o.x+1+d)%d,k=o.x+1===d?g.wrap+1:g.wrap,N={};return N[new i.aO(g.overscaledZ,S,o.z,m,o.y).key]={backfilled:!1},N[new i.aO(g.overscaledZ,k,o.z,A,o.y).key]={backfilled:!1},o.y>0&&(N[new i.aO(g.overscaledZ,S,o.z,m,o.y-1).key]={backfilled:!1},N[new i.aO(g.overscaledZ,g.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},N[new i.aO(g.overscaledZ,k,o.z,A,o.y-1).key]={backfilled:!1}),o.y+1<d&&(N[new i.aO(g.overscaledZ,S,o.z,m,o.y+1).key]={backfilled:!1},N[new i.aO(g.overscaledZ,g.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},N[new i.aO(g.overscaledZ,k,o.z,A,o.y+1).key]={backfilled:!1}),N}},"raster-array":ku,geojson:class extends i.E{constructor(g,o,d,m){super(),this.id=g,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(m),this._data=o.data,this._options=Object.assign({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.minzoom!==void 0&&(this.minzoom=o.minzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const S=i.al/this.tileSize;this.workerOptions=Object.assign({source:this.id,scope:this.scope,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*S,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*S,extent:i.al,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:i.al,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*S,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter,dynamic:o.dynamic},o.workerOptions)}onAdd(g){this.map=g,this.setData(this._data)}setData(g){return this._data=g,this._updateWorkerData(),this}updateData(g){if(!this._options.dynamic)return this.fire(new i.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof g!="string"&&(g.type==="Feature"&&(g={type:"FeatureCollection",features:[g]}),g.type!=="FeatureCollection"))return this.fire(new i.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof g!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const o=new Map;for(const d of this._data.features)o.set(d.id,d);for(const d of g.features)o.set(d.id,d);this._data.features=[...o.values()]}else this._data=g;return this._updateWorkerData(!0),this}getClusterExpansionZoom(g,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:g,source:this.id,scope:this.scope},o),this}getClusterChildren(g,o){return this.actor.send("geojson.getClusterChildren",{clusterId:g,source:this.id,scope:this.scope},o),this}getClusterLeaves(g,o,d,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:g,limit:o,offset:d},m),this}_updateWorkerData(g=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.z("dataloading",{dataType:"source"})),this._loaded=!1;const o=Object.assign({append:g},this.workerOptions);o.scope=this.scope;const d=this._data;typeof d=="string"?(o.request=this.map._requestManager.transformRequest(i.o.resolveURL(d),i.R.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(d),this._pendingLoad=this.actor.send(`${this.type}.loadData`,o,(m,S)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new i.y(m));else{const A={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&S&&S.resourceTiming&&S.resourceTiming[this.id]&&(A.resourceTiming=S.resourceTiming[this.id]),g&&(this._partialReload=!0),this.fire(new i.z("data",A)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(g),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const g=i.B(this.id,this.scope);this.map.style.clearSource(g),this._updateWorkerData()}loadTile(g,o){const d=g.actor?"reloadTile":"loadTile";g.actor=this.actor;const m=this.map.style?this.map.style.getLut(this.scope):null,S=m?{image:m.image.clone()}:null,A=this._partialReload,k={type:this.type,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:S,scope:this.scope,pixelRatio:i.o.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:g.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:A,worldview:this.map.getWorldview()};g.request=this.actor.send(d,k,(N,R)=>A&&!R?(g.state="loaded",o(null)):(delete g.request,g.destroy(),g.aborted?o(null):N?o(N):(g.loadVectorData(R,this.map.painter,d==="reloadTile"),o(null))),void 0,d==="loadTile")}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.aborted=!0}unloadTile(g,o){this.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id,scope:this.scope}),g.destroy()}onRemove(g){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return Object.assign({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aS{constructor(g,o,d,m){super(g,o,d,m),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const g=this.options;this.urls=[];for(const o of g.urls)this.urls.push(this.map._requestManager.transformRequest(o,i.R.Source).url);i.aT(this.urls,(o,d)=>{this._loaded=!0,o?this.fire(new i.y(o)):d&&(this.video=d,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(g){if(this.video){const o=this.video.seekable;g<o.start(0)||g>o.end(0)?this.fire(new i.y(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=g}}getVideo(){return this.video}onAdd(g){this.map||(this.map=g,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const g=this.map.painter.context,o=g.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(g,this.video,o.RGBA8),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(g)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aS,model:class extends i.E{constructor(g,o,d,m){super(),this.id=g,this.type="model",this.models=[],this._loaded=!1,this._options=o}load(){const g=[];for(const o in this._options.models){const d=this._options.models[o],m=i.aV(this.map._requestManager.transformRequest(d.uri,i.R.Model).url).then(S=>{if(!S)return;const A=i.aW(S),k=new i.aX(o,d.position,d.orientation,A);k.computeBoundsAndApplyParent(),this.models.push(k)}).catch(S=>{this.fire(new i.y(new Error(`Could not load model ${o} from ${d.uri}: ${S.message}`)))});g.push(m)}Promise.allSettled(g).then(()=>{this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(o=>{this._loaded=!0,this.fire(new i.y(new Error(`Could not load models: ${o.message}`)))})}onAdd(g){this.map=g,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(g,o){}serialize(){return this._options}},"batched-model":class extends i.E{constructor(g,o,d,m){super(),this.type="batched-model",this.id=g,this.tileSize=512,this._options=o,this.tiles=this._options.tiles,this.maxzoom=o.maxzoom||19,this.minzoom=o.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=d,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(m)}onAdd(g){this.map=g,this.load()}reload(){this.cancelTileJSONRequest();const g=i.B(this.id,this.scope);this.load(()=>this.map.style.clearSource(g))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(g){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const o=Array.isArray(this.map._language)?this.map._language.join():this.map._language,d=this.map.getWorldview();this._tileJSONRequest=Vo(this._options,this.map._requestManager,o,d,(m,S)=>{this._tileJSONRequest=null,this._loaded=!0,m?(o&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${o}`),d&&d.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${d}`),this.fire(new i.y(m))):S&&(Object.assign(this,S),S.bounds&&(this.tileBounds=new ac(S.bounds,this.minzoom,this.maxzoom)),me(S.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),g&&g(m)})}hasTransition(){return!1}hasTile(g){return!this.tileBounds||this.tileBounds.contains(g.canonical)}loaded(){return this._loaded}loadTile(g,o){const d=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme)),m={request:this.map._requestManager.transformRequest(d,i.R.Tile),data:void 0,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,tileSize:this.tileSize*g.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:g.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:i.o.devicePixelRatio,promoteId:this.promoteId};if(g.actor&&g.state!=="expired")if(g.state==="loading")g.reloadCallback=o;else{if(g.buckets){const A=Object.values(g.buckets);for(const k of A)k.dirty=!0;return void(g.state="loaded")}g.request=g.actor.send("reloadTile",m,S.bind(this))}else g.actor=this.dispatcher.getActor(),g.request=g.actor.send("loadTile",m,S.bind(this),void 0,!0);function S(A,k){return g.aborted?o(null):A&&A.status!==404?o(A):(this.map._refreshExpiredTiles&&k&&g.setExpiryData(k),g.loadModelData(k,this.map.painter),g.state="loaded",void o(null))}}serialize(){return Object.assign({},this._options)}},canvas:class extends i.aS{constructor(g,o,d,m){super(g,o,d,m),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(S=>!Array.isArray(S)||S.length!==2||S.some(A=>typeof A!="number"))||this.fire(new i.y(new i.V(`sources.${g}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.y(new i.V(`sources.${g}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new i.y(new i.V(`sources.${g}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new i.y(new i.V(`sources.${g}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.y(new i.V(`sources.${g}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(g){this.map=g,this.load(),this.canvas&&this.animate&&this.play()}onRemove(g){this.pause()}prepare(){let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context;this.texture?!g&&!this._playing||this.texture instanceof i.aU||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(o,this.canvas,o.gl.RGBA8,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const g of[this.canvas.width,this.canvas.height])if(isNaN(g)||g<=0)return!0;return!1}},custom:class extends i.E{constructor(g,o,d,m){super(),this.id=g,this.type="custom",this._dataType="raster",this._dispatcher=d,this._implementation=o,this.setEventedParent(m),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new ac(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),Object.assign(this,i.aH(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.aH(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(g){this.map=g,this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(g),this.load()}onRemove(g){this._implementation.onRemove&&this._implementation.onRemove(g)}hasTile(g){if(this._implementation.hasTile){const{x:o,y:d,z:m}=g.canonical;return this._implementation.hasTile({x:o,y:d,z:m})}return!this.tileBounds||this.tileBounds.contains(g.canonical)}loadTile(g,o){const{x:d,y:m,z:S}=g.tileID.canonical,A=new AbortController;g.request=Promise.resolve(this._implementation.loadTile({x:d,y:m,z:S},{signal:A.signal})).then((function(k){return delete g.request,g.aborted?(g.state="unloaded",o(null)):k===void 0?(g.state="errored",o(null)):k===null?(this.loadTileData(g,{width:this.tileSize,height:this.tileSize,data:null}),g.state="loaded",o(null)):function(N){return N instanceof ImageData||N instanceof HTMLCanvasElement||N instanceof ImageBitmap||N instanceof HTMLImageElement}(k)?(this.loadTileData(g,k),g.state="loaded",void o(null)):(g.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(k=>{k.name!=="AbortError"&&(g.state="errored",o(k))}),g.request.cancel=()=>A.abort()}loadTileData(g,o){g.setTexture(o,this.map.painter)}unloadTile(g,o){if(g.texture&&g.texture instanceof i.T?(g.destroy(!0),g.texture&&g.texture instanceof i.T&&this.map.painter.saveTileTexture(g.texture)):g.destroy(),this._implementation.unloadTile){const{x:d,y:m,z:S}=g.tileID.canonical;this._implementation.unloadTile({x:d,y:m,z:S})}o&&o()}abortTile(g,o){g.request&&g.request.cancel&&(g.request.cancel(),delete g.request),o&&o()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(g=>({x:g.canonical.x,y:g.canonical.y,z:g.canonical.z}))}_clearTiles(){const g=i.B(this.id,this.scope);this.map.style.clearSource(g)}_update(){this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}}},Iu=function(g,o,d,m){const S=new oc[o.type](g,o,d,m);if(S.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${S.id}`);return i.aY(["load","abort","unload","serialize","prepare"],S),S};function $l(g,o,d=""){return`${d}:${o.id||""}:${o.layer.id}:${function(m){if("layerId"in m)return`layer:${m.layerId}`;{const{featuresetId:S,importId:A}=m;return`featureset:${S}${A?`:import:${A}`:""}`}}(g.target)}`}function lc(g,o,d,m=""){if(g.uniqueFeatureID){const S=$l(g,o,m);if(d.has(S))return!0;d.add(S)}return!1}function ka(g,o,d,m,S=!1){const A=o.sourceCache.transform,k=o.sourceCache.tilesIn(g,o.has3DLayers,S);k.sort(eg);const N=[];for(const R of k){const V=R.tile.queryRenderedFeatures(o,R,d,m,A,S);Object.keys(V).length&&N.push({wrappedTileID:R.tile.tileID.wrapped().key,queryResults:V})}return N.length===0?{}:function(R){const V={},G={};for(const X of R){const W=X.queryResults,te=X.wrappedTileID,ie=G[te]=G[te]||{};for(const se in W){const ve=W[se],ue=ie[se]=ie[se]||{},be=V[se]=V[se]||[];for(const Te of ve)ue[Te.featureIndex]||(ue[Te.featureIndex]=!0,be.push(Te))}}return V}(N)}function Mf(g,o,d,m,S,A){const k={},N=m.queryRenderedSymbols(g),R=[];for(const V of Object.keys(N).map(Number))R.push(S[V]);R.sort(eg);for(const V of R){const G=V.featureIndex.lookupSymbolFeatures(N[V.bucketInstanceId],V.bucketIndex,V.sourceLayerIndex,o,d,A);for(const X in G){const W=k[X]=k[X]||[],te=G[X];te.sort((ie,se)=>{const ve=V.featureSortOrder;if(ve){const ue=ve.indexOf(ie.featureIndex);return ve.indexOf(se.featureIndex)-ue}return se.featureIndex-ie.featureIndex});for(const ie of te)W.push(ie)}}return k}function Yc(g,o){const d=g.getRenderableIds().map(A=>g.getTileByID(A)),m=[],S={};for(let A=0;A<d.length;A++){const k=d[A],N=k.tileID.canonical.key;S[N]||(S[N]=!0,k.querySourceFeatures(m,o))}return m}function eg(g,o){const d=g.tileID,m=o.tileID;return d.overscaledZ-m.overscaledZ||d.canonical.y-m.canonical.y||d.wrap-m.wrap||d.canonical.x-m.canonical.x}function Rp(g,o){const d={};if(!o)return d;for(const m of g){const S=m.layerIds.map(A=>o.getLayer(A)).filter(Boolean);if(S.length!==0){m.layers=S,m.stateDependentLayerIds&&(m.stateDependentLayers=m.stateDependentLayerIds.map(A=>S.filter(k=>k.id===A)[0]));for(const A of S)d[A.fqid]=m}}return d}const Qa=32,cc=33,Xc=new Uint16Array(8184);for(let g=0;g<2046;g++){let o=g+2,d=0,m=0,S=0,A=0,k=0,N=0;for(1&o?S=A=k=Qa:d=m=N=Qa;(o>>=1)>1;){const V=d+S>>1,G=m+A>>1;1&o?(S=d,A=m,d=k,m=N):(d=S,m=A,S=k,A=N),k=V,N=G}const R=4*g;Xc[R+0]=d,Xc[R+1]=m,Xc[R+2]=S,Xc[R+3]=A}const Xo=new Uint16Array(2178),Po=new Uint8Array(1089),Yd=new Uint16Array(1089);function tg(g){return g===0?-.03125:g===32?.03125:0}const Lf={type:2,extent:i.al,loadGeometry:()=>[[new i.P(0,0),new i.P(i.al+1,0),new i.P(i.al+1,i.al+1),new i.P(0,i.al+1),new i.P(0,0)]]};class Jc{constructor(o,d,m,S,A,k){this.tileID=o,this.uid=i.b2(),this.uses=0,this.tileSize=d,this.tileZoom=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=A,S&&S.style&&(this._lastUpdatedBrightness=S.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",S&&S.transform&&(this.projection=S.transform.projection),this.worldview=k}registerFadeDuration(o){const d=o+this.timeAdded;d<i.o.now()||this.fadeEndTime&&d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aZ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(o,d,m){if(this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=Rp(o.buckets,d.style),this.hasSymbolBuckets=!1;for(const S in this.buckets){const A=this.buckets[S];if(A instanceof i.b4){if(this.hasSymbolBuckets=!0,!m)break;A.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const S in this.buckets){const A=this.buckets[S];if(A instanceof i.b4&&A.hasRTLText){this.hasRTLText=!0,i.b5();break}}this.queryPadding=0;for(const S in this.buckets){const A=this.buckets[S],k=d.style.getOwnLayer(S);if(!k)continue;const N=k.queryRadius(A);this.queryPadding=Math.max(this.queryPadding,N)}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),o.lineAtlas&&(this.lineAtlas=o.lineAtlas),this._lastUpdatedBrightness=o.brightness}else this.collisionBoxArray=new i.b3}unloadVectorData(){if(this.hasData()){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(o,d,m){o&&(o.resourceTiming&&(this.resourceTiming=o.resourceTiming),this.buckets=Object.assign({},this.buckets,Rp(o.buckets,d.style)),o.featureIndex&&(this.latestFeatureIndex=o.featureIndex))}getBucket(o){return this.buckets[o.fqid]}upload(o){for(const S in this.buckets){const A=this.buckets[S];A.uploadPending()&&A.upload(o)}const d=o.gl,m=this.imageAtlas;m&&!m.uploaded&&(this.imageAtlasTexture=new i.T(o,m.image,d.RGBA8,{useMipmap:!!m.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(o,this.glyphAtlasImage,d.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(o,this.lineAtlas.image,d.R8),this.lineAtlas.uploaded=!0)}prepare(o,d,m){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture,m),!d||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const S=d.style.getBrightness();(this._lastUpdatedBrightness||S)&&(this._lastUpdatedBrightness&&S&&Math.abs(this._lastUpdatedBrightness-S)<.001||(this.updateBuckets(d,this._lastUpdatedBrightness!==S),this._lastUpdatedBrightness=S))}queryRenderedFeatures(o,d,m,S,A,k){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const N=function(R,V){const G=i.bq([],[.5*R.width,.5*-R.height,1]);return i.br(G,G,[1,-1,0]),i.aB(G,G,R.calculateProjMatrix(V.toUnwrapped())),Float32Array.from(G)}(A,this.tileID);return this.latestFeatureIndex.query(o,{tilespaceGeometry:d,pixelPosMatrix:N,transform:S,availableImages:m,tileTransform:this.tileTransform,worldview:this.worldview})}querySourceFeatures(o,d){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const S=m.loadVTLayers(),A=d?d.sourceLayer:"",k=S._geojsonTileLayer||S[A];if(!k)return;const N=i.b6(d&&d.filter),{z:R,x:V,y:G}=this.tileID.canonical,X={z:R,x:V,y:G};for(let W=0;W<k.length;W++){const te=k.feature(W);if(N.needGeometry){const ve=i.b7(te,!0);if(!N.filter(new i.ac(this.tileID.overscaledZ,{worldview:this.worldview}),ve,this.tileID.canonical))continue}else if(!N.filter(new i.ac(this.tileID.overscaledZ,{worldview:this.worldview}),te))continue;const ie=m.getId(te,A),se=new i.b8(te,R,V,G,ie);se.tile=X,o.push(se)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(o){const d=this.expirationTime;if(o.cacheControl){const m=i.b9(o.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const m=Date.now();let S=!1;if(this.expirationTime>m)S=!1;else if(d)if(this.expirationTime<d)S=!0;else{const A=this.expirationTime-d;A?this.expirationTime=m+Math.max(A,3e4):S=!0}else S=!0;S?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(o){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&o&&this.updateBuckets(o)}updateBuckets(o,d){if(!this.latestFeatureIndex||!o.style)return;const m=this.latestFeatureIndex.loadVTLayers(),S=o.style.listImages(),A=o.style.getBrightness();for(const k in this.buckets){if(!o.style.hasLayer(k))continue;const N=this.buckets[k],R=N.layers[0],V=R.sourceLayer||"_geojsonTileLayer",G=m[V],X=o.style.getLayerSourceCache(R);let W={};X&&(W=X._state.getState(V,void 0));const te=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},ie=Object.keys(W).length>0&&!d;(ie&&N.stateDependentLayers.length!==0||d)&&N.update(W,G,S,te,ie?N.stateDependentLayers:N.layers,d,A),(N instanceof i.ba||N instanceof i.bb)&&o._terrain&&o._terrain.enabled&&X&&N.uploadPending()&&o._terrain._clearRenderCacheForTile(X.id,this.tileID);const se=o&&o.style&&o.style.getOwnLayer(k);se&&(this.queryPadding=Math.max(this.queryPadding,se.queryRadius(N)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.o.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=i.o.now()+o}setTexture(o,d){const m=d.context,S=m.gl;this.texture=this.texture||d.getTileTexture(o.width),this.texture&&this.texture instanceof i.T?this.texture.update(o):(this.texture=new i.T(m,o,S.RGBA8,{useMipmap:!0}),this.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE))}setDependencies(o,d){const m={};for(const S of d)m[S]=!0;this.dependencies[o]=m}hasDependency(o,d){for(const m of o){const S=this.dependencies[m];if(S){for(const A of d)if(S[A])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(o,d){if(!d||d.name==="mercator"||this._tileDebugBuffer)return;const m=i.bc(Lf,this.tileID.canonical,this.tileTransform)[0],S=new i.bd,A=new i.be;for(let k=0;k<m.length;k++){const{x:N,y:R}=m[k];S.emplaceBack(N,R),A.emplaceBack(k)}A.emplaceBack(0),this._tileDebugIndexBuffer=o.createIndexBuffer(A),this._tileDebugBuffer=o.createVertexBuffer(S,i.bf.members),this._tileDebugSegments=i.bg.simpleSegment(0,0,S.length,A.length)}_makeTileBoundsBuffers(o,d){if(this._tileBoundsBuffer||!d||d.name==="mercator")return;const m=i.bc(Lf,this.tileID.canonical,this.tileTransform)[0];let S,A;if(this.isRaster){const k=function(N,R){const V=i.aZ(N,R),G=Math.pow(2,N.z);for(let ve=0;ve<cc;ve++)for(let ue=0;ue<cc;ue++){const be=i.a_((N.x+(ue+tg(ue))/Qa)/G),Te=i.a$((N.y+(ve+tg(ve))/Qa)/G),ke=R.project(be,Te),Ue=ve*cc+ue;Xo[2*Ue+0]=Math.round((ke.x*V.scale-V.x)*i.al),Xo[2*Ue+1]=Math.round((ke.y*V.scale-V.y)*i.al)}Po.fill(0),Yd.fill(0);for(let ve=2045;ve>=0;ve--){const ue=4*ve,be=Xc[ue+0],Te=Xc[ue+1],ke=Xc[ue+2],Ue=Xc[ue+3],Fe=be+ke>>1,Ve=Te+Ue>>1,ze=Fe+Ve-Te,Oe=Ve+be-Fe,Ge=Te*cc+be,Tt=Ue*cc+ke,ut=Ve*cc+Fe,jt=Math.hypot((Xo[2*Ge+0]+Xo[2*Tt+0])/2-Xo[2*ut+0],(Xo[2*Ge+1]+Xo[2*Tt+1])/2-Xo[2*ut+1])>=16;Po[ut]=Po[ut]||(jt?1:0),ve<1022&&(Po[ut]=Po[ut]||Po[(Te+Oe>>1)*cc+(be+ze>>1)]||Po[(Ue+Oe>>1)*cc+(ke+ze>>1)])}const X=new i.b0,W=new i.b1;let te=0;function ie(ve,ue){const be=ue*cc+ve;return Yd[be]===0&&(X.emplaceBack(Xo[2*be+0],Xo[2*be+1],ve*i.al/Qa,ue*i.al/Qa),Yd[be]=++te),Yd[be]-1}function se(ve,ue,be,Te,ke,Ue){const Fe=ve+be>>1,Ve=ue+Te>>1;if(Math.abs(ve-ke)+Math.abs(ue-Ue)>1&&Po[Ve*cc+Fe])se(ke,Ue,ve,ue,Fe,Ve),se(be,Te,ke,Ue,Fe,Ve);else{const ze=ie(ve,ue),Oe=ie(be,Te),Ge=ie(ke,Ue);W.emplaceBack(ze,Oe,Ge)}}return se(0,0,Qa,Qa,Qa,0),se(Qa,Qa,0,0,0,Qa),{vertices:X,indices:W}}(this.tileID.canonical,d);S=k.vertices,A=k.indices}else{S=new i.b0,A=new i.b1;for(const{x:N,y:R}of m)S.emplaceBack(N,R,0,0);const k=i.bh(S.int16.subarray(0,4*S.length),void 0,4);for(let N=0;N<k.length;N+=3)A.emplaceBack(k[N],k[N+1],k[N+2])}this._tileBoundsBuffer=o.createVertexBuffer(S,i.bi.members),this._tileBoundsIndexBuffer=o.createIndexBuffer(A),this._tileBoundsSegments=i.bg.simpleSegment(0,0,S.length,A.length)}_makeGlobeTileDebugBuffers(o,d){const m=d.projection;if(!m||m.name!=="globe"||d.freezeTileCoverage)return;const S=this.tileID.canonical,A=i.bj(S,d),k=i.bk(A),N=i.aj(d.zoom);let R;N>0&&(R=i.bl(new Float64Array(16),d.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(o,S,d,k,R,N),this._makeGlobeTileDebugTextBuffer(o,S,d,k,R,N)}_globePoint(o,d,m,S,A,k,N){let R=i.bm(o,d,m);if(k){const V=1<<m.z,G=i.aF(S.center.lng),X=i.aJ(S.center.lat),W=(m.x+.5)/V-G;let te=0;W>.5?te=-1:W<-.5&&(te=1);let ie=(o/i.al+m.x)/V+te,se=(d/i.al+m.y)/V;ie=(ie-G)*S._pixelsPerMercatorPixel+G,se=(se-X)*S._pixelsPerMercatorPixel+X;const ve=[ie*S.worldSize,se*S.worldSize,0];i.af(ve,ve,k),R=i.bn(R,ve,N)}return i.af(R,R,A)}_makeGlobeTileDebugBorderBuffer(o,d,m,S,A,k){const N=new i.bd,R=new i.be,V=new i.bo,G=(W,te,ie,se,ve)=>{const ue=(ie-W)/(ve-1),be=(se-te)/(ve-1),Te=N.length;for(let ke=0;ke<ve;ke++){const Ue=W+ke*ue,Fe=te+ke*be;N.emplaceBack(Ue,Fe);const Ve=this._globePoint(Ue,Fe,d,m,S,A,k);V.emplaceBack(Ve[0],Ve[1],Ve[2]),R.emplaceBack(Te+ke)}},X=i.al;G(0,0,X,0,16),G(X,0,X,X,16),G(X,X,0,X,16),G(0,X,0,0,16),this._tileDebugIndexBuffer=o.createIndexBuffer(R),this._tileDebugBuffer=o.createVertexBuffer(N,i.bf.members),this._globeTileDebugBorderBuffer=o.createVertexBuffer(V,i.bp.members),this._tileDebugSegments=i.bg.simpleSegment(0,0,N.length,R.length)}_makeGlobeTileDebugTextBuffer(o,d,m,S,A,k){const N=i.al/4,R=new i.bd,V=new i.b1,G=new i.bo,X=25;V.reserve(32),R.reserve(X),G.reserve(X);const W=(te,ie)=>X*te+ie;for(let te=0;te<X;te++){const ie=te*N;for(let se=0;se<X;se++){const ve=se*N;R.emplaceBack(ve,ie);const ue=this._globePoint(ve,ie,d,m,S,A,k);G.emplaceBack(ue[0],ue[1],ue[2])}}for(let te=0;te<4;te++)for(let ie=0;ie<4;ie++){const se=W(te,ie),ve=W(te,ie+1),ue=W(te+1,ie),be=W(te+1,ie+1);V.emplaceBack(se,ve,ue),V.emplaceBack(ue,ve,be)}this._tileDebugTextIndexBuffer=o.createIndexBuffer(V),this._tileDebugTextBuffer=o.createVertexBuffer(R,i.bf.members),this._globeTileDebugTextBuffer=o.createVertexBuffer(G,i.bp.members),this._tileDebugTextSegments=i.bg.simpleSegment(0,0,X,32)}destroy(o=!1){for(const d in this.buckets)this.buckets[d].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!o&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.bs.setPbf(i.bt);class Nu extends Jc{constructor(o,d,m,S,A){super(o,d,m,S,A),this._workQueuePerLayer=new Map,this._fetchQueuePerLayer=new Map,this._taskQueue=new Map,this._isHeaderLoaded=!1,this.textureDescriptorPerLayer=new Map,this.texturePerLayer=new Map}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(o){return this._mrt&&this._mrt.getLayer(o)}setTexturePerLayer(o,d,m){const S=m.context,A=S.gl;let k=this.texturePerLayer.get(o)||m.getTileTexture(d.width);k&&k instanceof i.T?k.update(d,{premultiply:!1}):k=new i.T(S,d,A.RGBA8,{premultiply:!1}),this.texturePerLayer.has(o)||this.texturePerLayer.set(o,k)}flushQueues(o){const d=this._workQueuePerLayer.get(o)||[],m=this._fetchQueuePerLayer.get(o)||[];for(;d.length;)d.pop()();for(;m.length;)m.pop()()}flushAllQueues(){for(const o of this._workQueuePerLayer.keys()){const d=this._workQueuePerLayer.get(o)||[];for(;d.length;)d.pop()()}for(const o of this._fetchQueuePerLayer.keys()){const d=this._fetchQueuePerLayer.get(o)||[];for(;d.length;)d.pop()()}}fetchHeader(o=16384,d){const m=this._mrt=new i.bs(30),S=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(o-1)}});return this.entireBuffer=null,this.request=i.bu(S,(A,k,N,R)=>{if(A)d(A);else try{const V=m.getHeaderLength(k);if(V>o)return void(this.request=this.fetchHeader(V,d));m.parseHeader(k),this._isHeaderLoaded=!0;let G=0;for(const X of Object.values(m.layers))G=Math.max(G,X.dataIndex[X.dataIndex.length-1].lastByte);k.byteLength>=G&&(this.entireBuffer=k),d(null,this.entireBuffer||k,N,R)}catch(V){d(V)}}),this.request}fetchBandForRender(o,d,m,S){this.fetchBand(o,d,m,A=>{if(A)return void S(A);this.updateTextureDescriptor(o,d,m);const k=this.textureDescriptorPerLayer.get(d);S(null,k?k.img:null)})}fetchBand(o,d,m,S,A=!0){const k=this._mrt;if(!this._isHeaderLoaded||!k)return void S(new Error("Tile header is not ready"));const N=this.actor;if(!N)return void S(new Error("Can't fetch tile band without an actor"));let R;const V=i.B(String(m),i.B(this.tileID.key,o));let G=this._taskQueue.get(V);G?G.add(S):(G=new Set,G.add(S),this._taskQueue.set(V,G));const X=(se,ve)=>{R.complete(se,ve),se?S(se):(G.values().forEach(ue=>ue(null,ve)),this._taskQueue.delete(V))},W=(se,ve)=>{if(se)return S(se);const ue=N.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:ve,task:R},X,void 0,!0);if(d!==null){const be=this._workQueuePerLayer.get(d)||[];be.push(()=>{ue&&ue.cancel(),R.cancel()}),this._workQueuePerLayer.has(d)||this._workQueuePerLayer.set(d,be)}};let te;try{te=k.getLayer(o)}catch(se){if(this.state==="reloading")return;throw se}if(!te)return void S(new Error(`Unknown sourceLayer "${o}"`));if(te.hasDataForBand(m))return G.values().forEach(se=>se(null,null)),void this._taskQueue.delete(V);const ie=te.getDataRange([m]);if(R=k.createDecodingTask(ie),!R||R.tasks.length)if(d!==null&&this.flushQueues(d),this.entireBuffer)W(null,this.entireBuffer.slice(ie.firstByte,ie.lastByte+1));else{const se=Object.assign({},this.requestParams,{headers:{Range:`bytes=${ie.firstByte}-${ie.lastByte}`}}),ve=i.bu(se,W);if(d!==null){const ue=this._fetchQueuePerLayer.get(d)||[];ue.push(()=>{ve.cancel(),R.cancel()}),this._fetchQueuePerLayer.has(d)||this._fetchQueuePerLayer.set(d,ue)}}}updateNeeded(o,d){return(!this.textureDescriptorPerLayer.get(o)||this.textureDescriptorPerLayer.get(o).band!==d||this.refreshedUponExpiration)&&this.state!=="errored"}updateTextureDescriptor(o,d,m){if(!this._mrt)return;const S=this._mrt.getLayer(o);if(!S||!S.hasBand(m)||!S.hasDataForBand(m))return;const{bytes:A,tileSize:k,buffer:N,offset:R,scale:V}=S.getBandView(m),G=k+2*N,X=new i.q({width:G,height:G},A),W=this.texturePerLayer.get(d);W&&W instanceof i.T&&W.update(X,{premultiply:!1}),this.textureDescriptorPerLayer.set(d,{layer:o,band:m,img:X,buffer:N,offset:R,tileSize:k,format:S.pixelFormat,mix:[V,256*V,65536*V,16777216*V]})}destroy(o=!1){if(super.destroy(o),delete this._mrt,!o)for(const d of this.texturePerLayer.values())d&&d instanceof i.T&&d.destroy();this.texturePerLayer.clear(),this.textureDescriptorPerLayer.clear(),this.fbo&&(this.fbo.destroy(),delete this.fbo),delete this.request,delete this.requestParams,this._isHeaderLoaded=!1}}class Qc{constructor(o,d){this.max=o,this.onRemove=d,this.reset()}reset(){for(const o in this.data)for(const d of this.data[o])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(o,d,m){const S=o.wrapped().key;this.data[S]===void 0&&(this.data[S]=[]);const A={value:d,timeout:void 0};if(m!==void 0&&(A.timeout=setTimeout(()=>{this.remove(o,A)},m)),this.data[S].push(A),this.order.push(S),this.order.length>this.max){const k=this._getAndRemoveByKey(this.order[0]);k&&this.onRemove(k)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const d=this.data[o].shift();return d.timeout&&clearTimeout(d.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),d.value}getByKey(o){const d=this.data[o];return d?d[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,d){if(!this.has(o))return this;const m=o.wrapped().key,S=d===void 0?0:this.data[m].indexOf(d),A=this.data[m][S];return this.data[m].splice(S,1),A.timeout&&clearTimeout(A.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(A.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(o){const d=[];for(const m in this.data)for(const S of this.data[m])o(S.value)||d.push(S);for(const m of d)this.remove(m.value.tileID,m)}}class Rh{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,d,m){const S=String(d);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][S]=this.stateChanges[o][S]||{},Object.assign(this.stateChanges[o][S],m),this.deletedStates[o]===null){this.deletedStates[o]={};for(const A in this.state[o])A!==S&&(this.deletedStates[o][A]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][S]===null){this.deletedStates[o][S]={};for(const A in this.state[o][S])m[A]||(this.deletedStates[o][S][A]=null)}else for(const A in m)this.deletedStates[o]&&this.deletedStates[o][S]&&this.deletedStates[o][S][A]===null&&delete this.deletedStates[o][S][A]}removeFeatureState(o,d,m){if(this.deletedStates[o]===null)return;const S=String(d);if(this.deletedStates[o]=this.deletedStates[o]||{},m&&d!==void 0)this.deletedStates[o][S]!==null&&(this.deletedStates[o][S]=this.deletedStates[o][S]||{},this.deletedStates[o][S][m]=null);else if(d!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][S])for(m in this.deletedStates[o][S]={},this.stateChanges[o][S])this.deletedStates[o][S][m]=null;else this.deletedStates[o][S]=null;else this.deletedStates[o]=null}getState(o,d){const m=this.state[o]||{},S=this.stateChanges[o]||{},A=this.deletedStates[o];if(A===null)return{};if(d!==void 0){const N=String(d),R=Object.assign({},m[N],S[N]);if(A){const V=A[d];if(V===null)return{};for(const G in V)delete R[G]}return R}const k=Object.assign({},m,S);if(A)for(const N in A)delete k[N];return k}initializeTileState(o,d){o.refreshFeatureState(d)}coalesceChanges(o,d){const m={};for(const S in this.stateChanges){this.state[S]=this.state[S]||{};const A={};for(const k in this.stateChanges[S])this.state[S][k]||(this.state[S][k]={}),Object.assign(this.state[S][k],this.stateChanges[S][k]),A[k]=this.state[S][k];m[S]=A}for(const S in this.deletedStates){this.state[S]=this.state[S]||{};const A={};if(this.deletedStates[S]===null)for(const k in this.state[S])A[k]={},this.state[S][k]={};else for(const k in this.deletedStates[S]){if(this.deletedStates[S][k]===null)this.state[S][k]={};else if(this.state[S][k])for(const N of Object.keys(this.deletedStates[S][k]))delete this.state[S][k][N];A[k]=this.state[S][k]}m[S]=m[S]||{},Object.assign(m[S],A)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const S in o)o[S].refreshFeatureState(d)}}class qo extends i.E{constructor(o,d,m){super(),this.id=o,this._onlySymbols=m,d.on("data",S=>{S.dataType==="source"&&S.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),d.on("error",()=>{this._sourceErrored=!0}),this._source=d,this._tiles={},this._cache=new Qc(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=d.minTileCacheSize,this._maxTileCacheSize=d.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Rh,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(o){this.map=o,this._minTileCacheSize=this._minTileCacheSize===void 0&&o?o._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&o?o._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles)if(!this._tiles[o].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,d){return o.isSymbolTile=this._onlySymbols,o.isExtraShadowCaster=this._shadowCasterTiles[o.tileID.key],this._source.loadTile(o,d)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o)}_abortTile(o){if(this._source.abortTile)return this._source.abortTile(o)}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const m=this._tiles[d];m.upload(o),m.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(Df).map(o=>o.key)}getRenderableIds(o,d){const m=[];for(const S in this._tiles)this._isIdRenderable(+S,o,d)&&m.push(this._tiles[S]);return o?m.sort((S,A)=>{const k=S.tileID,N=A.tileID,R=new i.P(k.canonical.x,k.canonical.y)._rotate(this.transform.angle),V=new i.P(N.canonical.x,N.canonical.y)._rotate(this.transform.angle);return k.overscaledZ-N.overscaledZ||V.y-R.y||V.x-R.x}).map(S=>S.tileID.key):m.map(S=>S.tileID).sort(Df).map(S=>S.key)}hasRenderableParent(o){const d=this.findLoadedParent(o,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(o,d,m){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(d||!this._tiles[o].holdingForFade())&&(m||!this._shadowCasterTiles[o])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(+o,"reloading")}}_reloadTile(o,d){const m=this._tiles[o];m&&(m.state!=="loading"&&(m.state=d),this._loadTile(m,this._tileLoaded.bind(this,m,o,d)))}_tileLoaded(o,d,m,S){if(S)if(o.state="errored",S.status!==404)this._source.fire(new i.y(S,{tile:o}));else{if(this._source.fire(new i.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:o})),!(o.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const A=this.map.painter.terrain;this.update(this.transform,A.getScaledDemTileSize(),!0),A.resetTileLookupCache(this.id)}else this.update(this.transform)}else o.timeAdded=i.o.now(),m==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(d,o),this._source.type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new i.z("data",{dataType:"source",tile:o,coord:o.tileID,sourceCacheId:this.id}))}_backfillDEM(o){const d=this.getRenderableIds();for(let S=0;S<d.length;S++){const A=d[S];if(o.neighboringTiles&&o.neighboringTiles[A]){const k=this.getTileByID(A);m(o,k),m(k,o)}}function m(S,A){if(!S.dem||S.dem.borderReady)return;S.needsHillshadePrepare=!0,S.needsDEMTextureUpload=!0;let k=A.tileID.canonical.x-S.tileID.canonical.x;const N=A.tileID.canonical.y-S.tileID.canonical.y,R=Math.pow(2,S.tileID.canonical.z),V=A.tileID.key;k===0&&N===0||Math.abs(N)>1||(Math.abs(k)>1&&(Math.abs(k+R)===1?k+=R:Math.abs(k-R)===1&&(k-=R)),A.dem&&S.dem&&(S.dem.backfillBorder(A.dem,k,N),S.neighboringTiles&&S.neighboringTiles[V]&&(S.neighboringTiles[V].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,d,m,S){for(const A in this._tiles){let k=this._tiles[A];if(S[A]||!k.hasData()||k.tileID.overscaledZ<=d||k.tileID.overscaledZ>m)continue;let N=k.tileID;for(;k&&k.tileID.overscaledZ>d+1;){const V=k.tileID.scaledTo(k.tileID.overscaledZ-1);k=this._tiles[V.key],k&&k.hasData()&&(N=V)}let R=N;for(;R.overscaledZ>d;)if(R=R.scaledTo(R.overscaledZ-1),o[R.key]){S[N.key]=N;break}}}findLoadedParent(o,d){if(o.key in this._loadedParentTiles){const m=this._loadedParentTiles[o.key];return m&&m.tileID.overscaledZ>=d?m:null}for(let m=o.overscaledZ-1;m>=d;m--){const S=o.scaledTo(m),A=this._getLoadedTile(S);if(A)return A}}_getLoadedTile(o){const d=this._tiles[o.key];return d&&d.hasData()?d:this._cache.getByKey(this._source.reparseOverscaled?o.wrapped().key:o.canonical.key)}updateCacheSize(o,d){d=d||this._source.tileSize;const m=Math.ceil(o.width/d)+1,S=Math.ceil(o.height/d)+1,A=Math.floor(m*S*5),k=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,A):A,N=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,k):k;this._cache.setMaxSize(N)}handleWrapJump(o){const d=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,d){const m={};for(const S in this._tiles){const A=this._tiles[S];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+d),m[A.tileID.key]=A}this._tiles=m;for(const S in this._timers)clearTimeout(this._timers[S]),delete this._timers[S];for(const S in this._tiles)this._setTileReloadTimer(+S,this._tiles[S])}}update(o,d,m,S,A){if(this.transform=o,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!m)return;this.updateCacheSize(o,d),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const k=this._source.type==="batched-model";let N,R=this._source.maxzoom;const V=this.map&&this.map.painter?this.map.painter._terrain:null;if(V&&V.sourceCache===this&&V.attenuationRange()){const W=V.attenuationRange()[0],te=Math.floor(W)-Math.log2(V.getDemUpscale());R>te&&(R=te)}if(this.used||this.usedForTerrain){if(this._source.tileID)N=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(W=>new i.aO(W.canonical.z,W.wrap,W.canonical.z,W.canonical.x,W.canonical.y));else if(this.tileCoverLift!==0){const W=o.clone();W.tileCoverLift=this.tileCoverLift,N=W.coveringTiles({tileSize:d||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:R,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:k}),this._source.minzoom<=1&&o.projection.name==="globe"&&(N.push(new i.aO(1,0,1,0,0)),N.push(new i.aO(1,0,1,1,0)),N.push(new i.aO(1,0,1,0,1)),N.push(new i.aO(1,0,1,1,1)))}else if(N=o.coveringTiles({tileSize:d||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:R,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:k}),this._source.hasTile){const W=this._source.hasTile.bind(this._source);N=N.filter(te=>W(te))}}else N=[];if(N.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Li(this._source.type)){const W=o.coveringZoomLevel({tileSize:d||this._source.tileSize,roundZoom:this._source.roundZoom&&!m}),te=Math.min(W,this._source.maxzoom);if(k){const ie=o.extendTileCover(N,te);for(const se of ie)N.push(se)}else if(A){const ie=o.extendTileCoverToNearPlane(N,this.transform.getFrustum(te),te);for(const se of ie)N.push(se)}else if(this.castsShadows&&S){const ie=o.extendTileCover(N,te,S);for(const se of ie)this._shadowCasterTiles[se.key]=!0,N.push(se)}}const G=this._updateRetainedTiles(N);if(Li(this._source.type)&&N.length!==0){const W={},te={},ie=Object.keys(G);for(const ve of ie){const ue=G[ve],be=this._tiles[ve];if(!be||be.fadeEndTime&&be.fadeEndTime<=i.o.now())continue;const Te=this.findLoadedParent(ue,Math.max(ue.overscaledZ-qo.maxOverzooming,this._source.minzoom));Te&&(this._addTile(Te.tileID),W[Te.tileID.key]=Te.tileID),te[ve]=ue}const se=N[N.length-1].overscaledZ;for(const ve in this._tiles){const ue=this._tiles[ve];if(G[ve]||!ue.hasData())continue;let be=ue.tileID;for(;be.overscaledZ>se;){be=be.scaledTo(be.overscaledZ-1);const Te=this._tiles[be.key];if(Te&&Te.hasData()&&te[be.key]){G[ve]=ue.tileID;break}}}for(const ve in W)G[ve]||(this._coveredTiles[ve]=!0,G[ve]=W[ve])}for(const W in G)this._tiles[W].clearFadeHold();const X=i.bv(this._tiles,G);for(const W of X){const te=this._tiles[W];te.hasSymbolBuckets&&!te.holdingForFade()?te.setHoldDuration(this.map._fadeDuration):te.hasSymbolBuckets&&!te.symbolFadeFinished()||this._removeTile(+W)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(+o)}_updateRetainedTiles(o){const d={};if(o.length===0)return d;const m={},S=o.reduce((V,G)=>Math.min(V,G.overscaledZ),1/0),A=o[0].overscaledZ,k=Math.max(A-qo.maxOverzooming,this._source.minzoom),N=Math.max(A+qo.maxUnderzooming,this._source.minzoom),R={};for(const V of o){const G=this._addTile(V);d[V.key]=V,G.hasData()||S<this._source.maxzoom&&(R[V.key]=V)}this._retainLoadedChildren(R,S,N,d);for(const V of o){let G=this._tiles[V.key];if(G.hasData())continue;if(V.canonical.z>=this._source.maxzoom){const W=V.children(this._source.maxzoom)[0],te=this.getTile(W);if(te&&te.hasData()){d[W.key]=W;continue}}else{const W=V.children(this._source.maxzoom);if(d[W[0].key]&&d[W[1].key]&&d[W[2].key]&&d[W[3].key])continue}let X=G.wasRequested();for(let W=V.overscaledZ-1;W>=k;--W){const te=V.scaledTo(W);if(m[te.key]||(m[te.key]=!0,G=this.getTile(te),!G&&X&&(G=this._addTile(te)),G&&(d[te.key]=te,X=G.wasRequested(),G.hasData())))break}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const d=[];let m,S=this._tiles[o].tileID;for(;S.overscaledZ>0;){if(S.key in this._loadedParentTiles){m=this._loadedParentTiles[S.key];break}d.push(S.key);const A=S.scaledTo(S.overscaledZ-1);if(m=this._getLoadedTile(A),m)break;S=A}for(const A of d)this._loadedParentTiles[A]=m}}_addTile(o){let d=this._tiles[o.key];if(d)return d.isExtraShadowCaster!==!0||this._shadowCasterTiles[o.key]||this._reloadTile(o.key,"reloading"),d;d=this._cache.getAndRemove(o),d&&(this._setTileReloadTimer(o.key,d),d.tileID=o,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,d)));const m=!!d;if(!m){const S=this.map?this.map.painter:null,A=this._source.tileSize*o.overscaleFactor();d=this._source.type==="raster-array"?new Nu(o,A,this.transform.tileZoom,S,this._isRaster):new Jc(o,A,this.transform.tileZoom,S,this._isRaster,this._source.worldview),this._loadTile(d,this._tileLoaded.bind(this,d,o.key,d.state))}return d.uses++,this._tiles[o.key]=d,m||this._source.fire(new i.z("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(o,d){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const m=d.getExpiryTimeout();m&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},m))}_removeTile(o){const d=this._tiles[o];d&&(d.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),d.uses>0||(d.hasData()&&d.state!=="reloading"||d.state==="empty"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(+o);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(o,d,m){const S=[],A=this.transform;if(!A)return S;const k=A.projection.name==="globe",N=i.aF(A.center.lng);for(const R in this._tiles){const V=this._tiles[R];if(m&&V.clearQueryDebugViz(),V.holdingForFade())continue;let G;if(k){const X=V.tileID.canonical;if(X.z===0){const W=[Math.abs(i.aA(N,...jh(X,-1))-N),Math.abs(i.aA(N,...jh(X,1))-N)];G=[0,2*W.indexOf(Math.min(...W))-1]}else{const W=[Math.abs(i.aA(N,...jh(X,-1))-N),Math.abs(i.aA(N,...jh(X,0))-N),Math.abs(i.aA(N,...jh(X,1))-N)];G=[W.indexOf(Math.min(...W))-1]}}else G=[0];for(const X of G){const W=o.containsTile(V,A,d,X);W&&S.push(W)}}return S}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(o){return this._getRenderableCoordinates(o)}_getRenderableCoordinates(o,d){const m=this.getRenderableIds(o,d).map(A=>this._tiles[A].tileID),S=this.transform.projection.name==="globe";for(const A of m)A.projMatrix=this.transform.calculateProjMatrix(A.toUnwrapped()),A.expandedProjMatrix=S?this.transform.calculateProjMatrix(A.toUnwrapped(),!1,!0):A.projMatrix;return m}sortCoordinatesByDistance(o){const d=o.slice(),m=this.transform._camera.position,S=this.transform._camera.forward(),A={};for(const k of d){const N=1/(1<<k.canonical.z);A[k.key]=((k.canonical.x+.5)*N+k.wrap-m[0])*S[0]+((k.canonical.y+.5)*N-m[1])*S[1]-m[2]*S[2]}return d.sort((k,N)=>A[k.key]-A[N.key]),d}hasTransition(){if(this._source.hasTransition())return!0;if(Li(this._source.type))for(const o in this._tiles){const d=this._tiles[o];if(d.fadeEndTime!==void 0&&d.fadeEndTime>=i.o.now())return!0}return!1}setFeatureState(o,d,m){this._state.updateState(o=o||"_geojsonTileLayer",d,m)}removeFeatureState(o,d,m){this._state.removeFeatureState(o=o||"_geojsonTileLayer",d,m)}getFeatureState(o,d){return this._state.getState(o=o||"_geojsonTileLayer",d)}setDependencies(o,d,m){const S=this._tiles[o];S&&S.setDependencies(d,m)}reloadTilesForDependencies(o,d){for(const m in this._tiles)this._tiles[m].hasDependency(o,d)&&this._reloadTile(+m,"reloading");this._cache.filter(m=>!m.hasDependency(o,d))}_preloadTiles(o,d){if(!this._sourceLoaded){const R=()=>{this._sourceLoaded&&(this._source.off("data",R),this._preloadTiles(o,d))};return void this._source.on("data",R)}const m=new Map,S=Array.isArray(o)?o:[o],A=this.map.painter.terrain,k=this.usedForTerrain&&A?A.getScaledDemTileSize():this._source.tileSize;for(const R of S){const V=R.coveringTiles({tileSize:k,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const G of V)m.set(G.key,G);this.usedForTerrain&&R.updateElevation(!1)}const N=Array.from(m.values());i.bw(N,(R,V)=>{const G=new Jc(R,this._source.tileSize*R.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster,this._source.worldview);this._loadTile(G,X=>{this._source.type==="raster-dem"&&G.dem&&this._backfillDEM(G),V(X,G)})},d)}}function Df(g,o){const d=Math.abs(2*g.wrap)-+(g.wrap<0),m=Math.abs(2*o.wrap)-+(o.wrap<0);return g.overscaledZ-o.overscaledZ||m-d||o.canonical.y-g.canonical.y||o.canonical.x-g.canonical.x}function Li(g){return g==="raster"||g==="image"||g==="video"||g==="custom"}function jh(g,o){const d=1<<g.z;return[g.x/d+o,(g.x+1)/d+o]}qo.maxOverzooming=10,qo.maxUnderzooming=3;class jp{constructor(o){this.style=o,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const o=!1,d=!1;for(const m in this.style._mergedLayers){const S=this.style._mergedLayers[m];if(S.type==="fill-extrusion"||S.type==="building")this.layers.push({layer:S,visible:o,visibilityChanged:d});else if(S.type==="model"){const A=this.style.getLayerSource(S);A&&A.type==="batched-model"&&this.layers.push({layer:S,visible:o,visibilityChanged:d})}}}onNewFrame(o){this.layersGotHidden=!1;for(const d of this.layers){const m=d.layer;let S=!1;m.type==="fill-extrusion"?S=!m.isHidden(o)&&m.paint.get("fill-extrusion-opacity")>0:m.type==="building"?S=!m.isHidden(o)&&m.paint.get("building-opacity")>0:m.type==="model"&&(S=!m.isHidden(o)&&m.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!S&&d.visible,d.visible=S}}updateZOffset(o,d){this.currentBuildingBuckets=[];for(const S of this.layers){const A=S.layer,k=this.style.getLayerSourceCache(A);let N=1;A.type==="fill-extrusion"?N=S.visible?A.paint.get("fill-extrusion-vertical-scale"):0:A.type==="building"&&(N=S.visible?A.paint.get("building-vertical-scale"):0);let R=k?k.getTile(d):null;if(!R&&k)for(const V in k._tiles){const G=k._tiles[V];if(d.canonical.isChildOf(G.tileID.canonical)){R=G;break}}this.currentBuildingBuckets.push({bucket:R?R.getBucket(A):null,tileID:R?R.tileID:d,verticalScale:N})}o.hasAnyZOffset=!1;let m=!1;for(let S=0;S<o.symbolInstances.length;S++){const A=o.symbolInstances.get(S),k=A.zOffset,N=this._getHeightAtTileOffset(d,A.tileAnchorX,A.tileAnchorY);A.zOffset=N!==Number.NEGATIVE_INFINITY?N:k,m||k===A.zOffset||(m=!0),o.hasAnyZOffset||A.zOffset===0||(o.hasAnyZOffset=!0)}m&&(o.zOffsetBuffersNeedUpload=!0,o.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(o,d,m,S){let A=d,k=m;if(o.canonical.z!==S.canonical.z){const N=S.canonical,R=1/(1<<o.canonical.z-N.z);A=(d+o.canonical.x*i.al)*R-N.x*i.al|0,k=(m+o.canonical.y*i.al)*R-N.y*i.al|0}return{tileX:A,tileY:k}}_getHeightAtTileOffset(o,d,m){let S,A;for(let k=0;k<this.layers.length;++k){const N=this.layers[k].layer;if(N.type!=="fill-extrusion"&&N.type!=="building")continue;const{bucket:R,tileID:V,verticalScale:G}=this.currentBuildingBuckets[k];if(!R)continue;const{tileX:X,tileY:W}=this._mapCoordToOverlappingTile(o,d,m,V),te=R.getHeightAtTileCoord(X,W);te&&te.height!==void 0&&(te.hidden?S=te.height:A=Math.max(te.height*G,A||0))}if(A!==void 0)return A;for(let k=0;k<this.layers.length;++k){const N=this.layers[k];if(N.layer.type!=="model"||!N.visible)continue;const{bucket:R,tileID:V}=this.currentBuildingBuckets[k];if(!R)continue;const{tileX:G,tileY:X}=this._mapCoordToOverlappingTile(o,d,m,V),W=R.getHeightAtTileCoord(G,X);if(W&&!W.hidden)return W.height===void 0&&S!==void 0?Math.min(W.maxHeight,S)*W.verticalScale:W.height?W.height*W.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function ng(g,o){const d={};for(const m in g)m!=="ref"&&(d[m]=g[m]);return i.bx.forEach(m=>{m in o&&(d[m]=o[m])}),d}function Op(g){g=g.slice();const o=Object.create(null);for(let d=0;d<g.length;d++)o[g[d].id]=g[d];for(let d=0;d<g.length;d++)"ref"in g[d]&&(g[d]=ng(g[d],o[g[d].ref]));return g}const mi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function uc(g,o,d){d.push({command:mi.addSource,args:[g,o[g]]})}function Cy(g,o,d){o.push({command:mi.removeSource,args:[g]}),d[g]=!0}function Ey(g,o,d,m){Cy(g,d,m),uc(g,o,d)}function Xd(g,o,d){let m;for(m in g[d])if(g[d].hasOwnProperty(m)&&m!=="data"&&!i.by(g[d][m],o[d][m]))return!1;for(m in o[d])if(o[d].hasOwnProperty(m)&&m!=="data"&&!i.by(g[d][m],o[d][m]))return!1;return!0}function eu(g,o,d,m,S,A){let k;for(k in o=o||{},g=g||{})g.hasOwnProperty(k)&&(i.by(g[k],o[k])||d.push({command:A,args:[m,k,o[k],S]}));for(k in o)o.hasOwnProperty(k)&&!g.hasOwnProperty(k)&&(i.by(g[k],o[k])||d.push({command:A,args:[m,k,o[k],S]}))}function tu(g){return g.id}function pd(g,o){return g[o.id]=o,g}function Jd(g,o,d){const m=o.createTileMatrix(g,g.worldSize,d.toUnwrapped());return i.aB(new Float32Array(16),g.projMatrix,m)}function Py(g,o,d){if(o.projection.name===d.projection.name)return g.projMatrix;const m=d.clone();return m.setProjection(o.projection),Jd(m,o.getProjection(),g)}function Mu(g,o,d){return o.name===d.projection.name?g.projMatrix:Jd(d,o,g)}class Fp{constructor(o,d){this.reset(o,d)}reset(o,d){this.points=o||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=i.aA(o,0,1);let d=1,m=this._distances[d];const S=o*this.paddedLength+this.padding;for(;m<S&&d<this._distances.length;)m=this._distances[++d];const A=d-1,k=this._distances[A],N=m-k,R=N>0?(S-k)/N:0;return this.points[A].mult(1-R).add(this.points[d].mult(R))}}class Qd{constructor(o,d,m){const S=this.boxCells=[],A=this.circleCells=[];this.xCellCount=Math.ceil(o/m),this.yCellCount=Math.ceil(d/m);for(let k=0;k<this.xCellCount*this.yCellCount;k++)S.push([]),A.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=d,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,d,m,S,A){this._forEachCell(d,m,S,A,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(d),this.bboxes.push(m),this.bboxes.push(S),this.bboxes.push(A)}insertCircle(o,d,m,S){this._forEachCell(d-S,m-S,d+S,m+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(d),this.circles.push(m),this.circles.push(S)}_insertBoxCell(o,d,m,S,A,k){this.boxCells[A].push(k)}_insertCircleCell(o,d,m,S,A,k){this.circleCells[A].push(k)}_query(o,d,m,S,A,k){if(m<0||o>this.width||S<0||d>this.height)return!A&&[];const N=[];if(o<=0&&d<=0&&this.width<=m&&this.height<=S){if(A)return!0;for(let R=0;R<this.boxKeys.length;R++)N.push({key:this.boxKeys[R],x1:this.bboxes[4*R],y1:this.bboxes[4*R+1],x2:this.bboxes[4*R+2],y2:this.bboxes[4*R+3]});for(let R=0;R<this.circleKeys.length;R++){const V=this.circles[3*R],G=this.circles[3*R+1],X=this.circles[3*R+2];N.push({key:this.circleKeys[R],x1:V-X,y1:G-X,x2:V+X,y2:G+X})}return k?N.filter(k):N}return this._forEachCell(o,d,m,S,this._queryCell,N,{hitTest:A,seenUids:{box:{},circle:{}}},k),A?N.length>0:N}_queryCircle(o,d,m,S,A){const k=o-m,N=o+m,R=d-m,V=d+m;if(N<0||k>this.width||V<0||R>this.height)return!S&&[];const G=[];return this._forEachCell(k,R,N,V,this._queryCellCircle,G,{hitTest:S,circle:{x:o,y:d,radius:m},seenUids:{box:{},circle:{}}},A),S?G.length>0:G}query(o,d,m,S,A){return this._query(o,d,m,S,!1,A)}hitTest(o,d,m,S,A){return this._query(o,d,m,S,!0,A)}hitTestCircle(o,d,m,S){return this._queryCircle(o,d,m,!0,S)}_queryCell(o,d,m,S,A,k,N,R){const V=N.seenUids,G=this.boxCells[A];if(G!==null){const W=this.bboxes;for(const te of G)if(!V.box[te]){V.box[te]=!0;const ie=4*te;if(o<=W[ie+2]&&d<=W[ie+3]&&m>=W[ie+0]&&S>=W[ie+1]&&(!R||R(this.boxKeys[te]))){if(N.hitTest)return k.push(!0),!0;k.push({key:this.boxKeys[te],x1:W[ie],y1:W[ie+1],x2:W[ie+2],y2:W[ie+3]})}}}const X=this.circleCells[A];if(X!==null){const W=this.circles;for(const te of X)if(!V.circle[te]){V.circle[te]=!0;const ie=3*te;if(this._circleAndRectCollide(W[ie],W[ie+1],W[ie+2],o,d,m,S)&&(!R||R(this.circleKeys[te]))){if(N.hitTest)return k.push(!0),!0;{const se=W[ie],ve=W[ie+1],ue=W[ie+2];k.push({key:this.circleKeys[te],x1:se-ue,y1:ve-ue,x2:se+ue,y2:ve+ue})}}}}}_queryCellCircle(o,d,m,S,A,k,N,R){const V=N.circle,G=N.seenUids,X=this.boxCells[A];if(X!==null){const te=this.bboxes;for(const ie of X)if(!G.box[ie]){G.box[ie]=!0;const se=4*ie;if(this._circleAndRectCollide(V.x,V.y,V.radius,te[se+0],te[se+1],te[se+2],te[se+3])&&(!R||R(this.boxKeys[ie])))return k.push(!0),!0}}const W=this.circleCells[A];if(W!==null){const te=this.circles;for(const ie of W)if(!G.circle[ie]){G.circle[ie]=!0;const se=3*ie;if(this._circlesCollide(te[se],te[se+1],te[se+2],V.x,V.y,V.radius)&&(!R||R(this.circleKeys[ie])))return k.push(!0),!0}}}_forEachCell(o,d,m,S,A,k,N,R){const V=this._convertToXCellCoord(o),G=this._convertToYCellCoord(d),X=this._convertToXCellCoord(m),W=this._convertToYCellCoord(S);for(let te=V;te<=X;te++)for(let ie=G;ie<=W;ie++)if(A.call(this,o,d,m,S,this.xCellCount*ie+te,k,N,R))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,d,m,S,A,k){const N=S-o,R=A-d,V=m+k;return V*V>N*N+R*R}_circleAndRectCollide(o,d,m,S,A,k,N){const R=(k-S)/2,V=Math.abs(o-(S+R));if(V>R+m)return!1;const G=(N-A)/2,X=Math.abs(d-(A+G));if(X>G+m)return!1;if(V<=R||X<=G)return!0;const W=V-R,te=X-G;return W*W+te*te<=m*m}}const nu={unknown:0,flipRequired:1,flipNotRequired:2},Oh=Math.tan(85*Math.PI/180);function El(g,o,d,m,S,A,k){const N=i.bC();if(d)if(A.name==="globe"){const R=i.bD(S,o);i.aB(N,N,R)}else{const R=i.bE([],k);N[0]=R[0],N[1]=R[1],N[4]=R[2],N[5]=R[3],m||i.bB(N,N,S.angle)}else i.aB(N,S.labelPlaneMatrix,g);return N}function eh(g,o,d,m,S,A,k){const N=El(g,o,d,m,S,A,k);return A.name==="globe"&&d||(N[2]=N[6]=N[10]=N[14]=0),N}function md(g,o,d,m,S,A,k){if(d){if(A.name==="globe"){const N=El(g,o,d,m,S,A,k);return i.bl(N,N),i.aB(N,g,N),N}{const N=i.bz(g),R=i.bA([]);return R[0]=k[0],R[1]=k[1],R[4]=k[2],R[5]=k[3],i.aB(N,N,R),m||i.bB(N,N,-S.angle),N}}return S.glCoordMatrix}function Pl(g,o,d,m){const S=[g,o,d,1];d?i.aC(S,S,m):Rt(S,S,m);const A=S[3];return S[0]/=A,S[1]/=A,S[2]/=A,S}function gd(g,o){return Math.min(.5+g/o*.5,1.5)}function ho(g,o){const d=g[0]/g[3],m=g[1]/g[3];return d>=-o[0]&&d<=o[0]&&m>=-o[1]&&m<=o[1]}function Lu(g,o,d,m,S,A,k,N,R,V){const G=d.transform,X=m?g.textSizeData:g.iconSizeData,W=i.bK(X,d.transform.zoom),te=G.projection.name==="globe",ie=[256/d.width*2+1,256/d.height*2+1],se=m?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;se.clear();let ve=null;te&&(ve=m?g.text.globeExtVertexArray:g.icon.globeExtVertexArray);const ue=g.lineVertexArray,be=m?g.text.placedSymbolArray:g.icon.placedSymbolArray,Te=d.transform.width/d.transform.height;let ke,Ue=!1;for(let Fe=0;Fe<be.length;Fe++){const Ve=be.get(Fe),{numGlyphs:ze,writingMode:Oe}=Ve;if(Oe!==i.bL.vertical||Ue||ke===i.bL.horizontal||(Ue=!0),ke=Oe,(Ve.hidden||Oe===i.bL.vertical)&&!Ue){qe(ze,se);continue}Ue=!1;const Ge=new i.P(Ve.tileAnchorX,Ve.tileAnchorY);let{x:Tt,y:ut,z:jt}=G.projection.projectTilePoint(Ge.x,Ge.y,V.canonical);if(R){const[rn,Qn,Kn]=R(Ge);Tt+=rn,ut+=Qn,jt+=Kn}const bt=[Tt,ut,jt,1];if(i.aC(bt,bt,o),!ho(bt,ie)){qe(ze,se);continue}const Dt=bt[3],gn=gd(d.transform.getCameraToCenterDistance(G.projection),Dt),St=i.bM(X,W,Ve),it=k?St/gn:St*gn,Ut=Pl(Tt,ut,jt,S);if(Ut[3]<=0){qe(ze,se);continue}let Nt={};const Qt=i.an(g.layers[0].layout.get("text-max-angle")),mn=Math.cos(Qt),Nn=k?null:R,dn=Ii(Ve,it,!1,N,o,S,A,g.glyphOffsetArray,ue,se,ve,Ut,Ge,Nt,Te,Nn,G.projection,V,k,mn);Ue=dn.useVertical,Nn&&dn.needsFlipping&&(Nt={}),(dn.notEnoughRoom||Ue||dn.needsFlipping&&Ii(Ve,it,!0,N,o,S,A,g.glyphOffsetArray,ue,se,ve,Ut,Ge,Nt,Te,Nn,G.projection,V,k,mn).notEnoughRoom)&&qe(ze,se)}m?(g.text.dynamicLayoutVertexBuffer.updateData(se),ve&&g.text.globeExtVertexBuffer&&g.text.globeExtVertexBuffer.updateData(ve)):(g.icon.dynamicLayoutVertexBuffer.updateData(se),ve&&g.icon.globeExtVertexBuffer&&g.icon.globeExtVertexBuffer.updateData(ve))}function Rf(g,o,d,m,S,A,k,N,R,V,G,X,W,te,ie,se,ve){const{lineStartIndex:ue,glyphStartIndex:be,segment:Te}=N,ke=be+N.numGlyphs,Ue=ue+N.lineLength,Fe=o.getoffsetX(be),Ve=o.getoffsetX(ke-1),ze=Pe(g*Fe,d,m,S,A,k,Te,ue,Ue,R,V,G,X,W,!0,te,ie,se,ve);if(!ze)return null;const Oe=Pe(g*Ve,d,m,S,A,k,Te,ue,Ue,R,V,G,X,W,!0,te,ie,se,ve);return Oe?{first:ze,last:Oe}:null}function zp(g,o,d,m){return g===i.bL.horizontal&&Math.abs(m)>Math.abs(d)?{useVertical:!0}:g===i.bL.vertical?m>0?{needsFlipping:!0}:null:o!==nu.unknown&&function(S,A){return S===0||Math.abs(A/S)>Oh}(d,m)?o===nu.flipRequired?{needsFlipping:!0}:null:d<0?{needsFlipping:!0}:null}function Ii(g,o,d,m,S,A,k,N,R,V,G,X,W,te,ie,se,ve,ue,be,Te){const ke=o/24,Ue=g.lineOffsetX*ke,Fe=g.lineOffsetY*ke,{lineStartIndex:Ve,glyphStartIndex:ze,numGlyphs:Oe,segment:Ge,writingMode:Tt,flipState:ut}=g,jt=Ve+g.lineLength,bt=Dt=>{if(G){const[Ut,Nt,Qt]=Dt.up,mn=V.length;i.bN(G,mn+0,Ut,Nt,Qt),i.bN(G,mn+1,Ut,Nt,Qt),i.bN(G,mn+2,Ut,Nt,Qt),i.bN(G,mn+3,Ut,Nt,Qt)}const[gn,St,it]=Dt.point;i.bO(V,gn,St,it,Dt.angle)};if(Oe>1){const Dt=Rf(ke,N,Ue,Fe,d,X,W,g,R,A,te,se,!1,ve,ue,be,Te);if(!Dt)return{notEnoughRoom:!0};if(m&&!d){let[gn,St,it]=Dt.first.point,[Ut,Nt,Qt]=Dt.last.point;[gn,St]=Pl(gn,St,it,k),[Ut,Nt]=Pl(Ut,Nt,Qt,k);const mn=zp(Tt,ut,(Ut-gn)*ie,Nt-St);if(g.flipState=mn&&mn.needsFlipping?nu.flipRequired:nu.flipNotRequired,mn)return mn}bt(Dt.first);for(let gn=ze+1;gn<ze+Oe-1;gn++){const St=Pe(ke*N.getoffsetX(gn),Ue,Fe,d,X,W,Ge,Ve,jt,R,A,te,se,!1,!1,ve,ue,be,Te);if(!St)return V.length-=4*(gn-ze),{notEnoughRoom:!0};bt(St)}bt(Dt.last)}else{if(m&&!d){const gn=Pl(W.x,W.y,0,S),St=Ve+Ge+1,it=new i.P(R.getx(St),R.gety(St)),Ut=Pl(it.x,it.y,0,S),Nt=Ut[3]>0?Ut:re(W,it,gn,1,S,void 0,ve,ue.canonical),Qt=zp(Tt,ut,(Nt[0]-gn[0])*ie,Nt[1]-gn[1]);if(g.flipState=Qt&&Qt.needsFlipping?nu.flipRequired:nu.flipNotRequired,Qt)return Qt}const Dt=Pe(ke*N.getoffsetX(ze),Ue,Fe,d,X,W,Ge,Ve,jt,R,A,te,se,!1,!1,ve,ue,be,Te);if(!Dt)return{notEnoughRoom:!0};bt(Dt)}return{}}function Bp(g,o,d,m,S){const{x:A,y:k,z:N}=m.projectTilePoint(g.x,g.y,o);if(!S)return Pl(A,k,N,d);const[R,V,G]=S(g);return Pl(A+R,k+V,N+G,d)}function re(g,o,d,m,S,A,k,N){const R=Bp(g.sub(o)._unit()._add(g),N,S,k,A);return i.av(R,d,R),i.aw(R,R),i.bH(R,d,R,m)}function Pe(g,o,d,m,S,A,k,N,R,V,G,X,W,te,ie,se,ve,ue,be){const Te=m?g-o:g+o;let ke=Te>0?1:-1,Ue=0;m&&(ke*=-1,Ue=Math.PI),ke<0&&(Ue+=Math.PI);let Fe=N+k+(ke>0?0:1)|0,Ve=S,ze=S,Oe=0,Ge=0;const Tt=Math.abs(Te),ut=[],jt=[];let bt=A,Dt=bt,gn=i.bF([]);const St=()=>re(Dt,bt,ze,Tt-Oe+1,G,W,se,ve.canonical);for(;Oe+Ge<=Tt;){if(Fe+=ke,Fe<N||Fe>=R)return null;if(ze=Ve,Dt=bt,ut.push(ze),te&&jt.push(Dt),bt=new i.P(V.getx(Fe),V.gety(Fe)),Ve=X[Fe],!Ve){const Kn=Bp(bt,ve.canonical,G,se,W);Ve=Kn[3]>0?X[Fe]=Kn:St()}Oe+=Ge;const rn=i.av([],Ve,ze),Qn=i.bG(ze,Ve);if(d&&Qn>0&&Ge>0&&i.bJ(gn,rn)/(Ge*Qn)<be)return null;Ge=Qn,gn=rn}ie&&W&&(X[Fe]&&(Ve=St(),Ge=i.bG(ze,Ve),gn=i.av([],Ve,ze)),X[Fe]=Ve);const it=(Tt-Oe)/Ge,Ut=bt.sub(Dt)._mult(it)._add(Dt),Nt=i.bH([],ze,gn,it);let Qt=[0,0,1],mn=gn[0],Nn=gn[1];if(ue&&(Qt=se.upVector(ve.canonical,Ut.x,Ut.y),Qt[0]!==0||Qt[1]!==0||Qt[2]!==1)){const rn=[Qt[2],0,-Qt[0]],Qn=i.bI([],Qt,rn);i.aw(rn,rn),i.aw(Qn,Qn),mn=i.bJ(gn,rn),Nn=i.bJ(gn,Qn)}if(d){const rn=i.bI([],Qt,gn);i.aw(rn,rn),i.bH(Nt,Nt,rn,d*ke)}const dn=Ue+Math.atan2(Nn,mn);return ut.push(Nt),te&&jt.push(Ut),{point:Nt,angle:dn,path:ut,tilePath:jt,up:Qt}}function qe(g,o){const d=o.length,m=d+4*g;o.resize(m),o.float32.fill(-1/0,4*d,4*m)}function Rt(g,o,d){const m=o[0],S=o[1];return g[0]=d[0]*m+d[4]*S+d[12],g[1]=d[1]*m+d[5]*S+d[13],g[3]=d[3]*m+d[7]*S+d[15],g}const Zt=100;class kn{constructor(o,d,m=new Qd(o.width+200,o.height+200,25),S=new Qd(o.width+200,o.height+200,25)){this.transform=o,this.grid=m,this.ignoredGrid=S,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+Zt,this.screenBottomBoundary=o.height+Zt,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=d}placeCollisionBox(o,d,m,S,A,k,N,R,V,G,X){let W=m.projectedAnchorX,te=m.projectedAnchorY,ie=m.projectedAnchorZ;const se=m.tileAnchorX,ve=m.tileAnchorY,ue=m.elevation,be=m.tileID,Te=o.getProjection();if(ue&&be){const[jt,bt,Dt]=Te.upVector(be.canonical,m.tileAnchorX,m.tileAnchorY),gn=Te.upVectorScale(be.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;W+=jt*ue*gn,te+=bt*ue*gn,ie+=Dt*ue*gn}const ke=o.projection.name==="globe",Ue=o.projection.name==="globe"?i.aj(this.transform.zoom):0;if(be&&ke&&Ue<1&&!k){const jt=1<<be.canonical.z,bt=i.bP(se,ve);i.bQ(bt,bt,1/i.al),i.bR(bt,bt,i.bP(be.canonical.x,be.canonical.y)),i.bQ(bt,bt,1/jt),i.bS(bt,bt,i.bP(S[0],S[1])),bt[0]=i.bT(bt[0],-.5,.5),i.bQ(bt,bt,i.al);const Dt=i.bU(bt[0],bt[1],i.al/(2*Math.PI),1);i.aC(Dt,Dt,A),W=i.ak(W,Dt[0],Ue),te=i.ak(te,Dt[1],Ue),ie=i.ak(ie,Dt[2],Ue)}const Fe=this.projectAndGetPerspectiveRatio(G,W,te,ie,m.tileID,Te.name==="globe"||!!ue||this.transform.pitch>0,Te),Ve=V*Fe.perspectiveRatio,ze=(m.x1*d+N.x-m.padding)*Ve+Fe.point.x,Oe=(m.y1*d+N.y-m.padding)*Ve+Fe.point.y,Ge=(m.x2*d+N.x+m.padding)*Ve+Fe.point.x,Tt=(m.y2*d+N.y+m.padding)*Ve+Fe.point.y,ut=Fe.perspectiveRatio<=.55||Fe.occluded;return!this.isInsideGrid(ze,Oe,Ge,Tt)||!R&&this.grid.hitTest(ze,Oe,Ge,Tt,X)||ut?{box:[],offscreen:!1,occluded:Fe.occluded}:{box:[ze,Oe,Ge,Tt],offscreen:this.isOffscreen(ze,Oe,Ge,Tt),occluded:!1}}placeCollisionCircles(o,d,m,S,A,k,N,R,V,G,X,W,te,ie,se){const ve=[],ue=this.transform.elevation,be=o.getProjection(),Te=ue?ue.getAtTileOffsetFunc(se,this.transform.center.lat,this.transform.worldSize,be):null,ke=new i.P(m.tileAnchorX,m.tileAnchorY);let{x:Ue,y:Fe,z:Ve}=be.projectTilePoint(ke.x,ke.y,se.canonical);if(Te){const[Qt,mn,Nn]=Te(ke);Ue+=Qt,Fe+=mn,Ve+=Nn}const ze=be.name==="globe",Oe=this.projectAndGetPerspectiveRatio(N,Ue,Fe,Ve,se,ze||!!ue||this.transform.pitch>0,be),{perspectiveRatio:Ge}=Oe,Tt=(X?k/Ge:k*Ge)/i.bX,ut=Pl(Ue,Fe,Ve,R),jt=m.lineOffsetX*Tt,bt=m.lineOffsetY*Tt,Dt=i.an(o.layers[0].layout.get("text-max-angle")),gn=Math.cos(Dt),St=Oe.signedDistanceFromCamera>0?Rf(Tt,A,jt,bt,!1,ut,ke,m,S,R,{},ue&&!X?Te:null,X&&!!ue,be,se,X,gn):null;let it=!1,Ut=!1,Nt=!0;if(St&&!Oe.occluded){const Qt=.5*te*Ge+ie,mn=new i.P(-100,-100),Nn=new i.P(this.screenRightBoundary,this.screenBottomBoundary),dn=new Fp,{first:rn,last:Qn}=St,Kn=rn.path.length;let Jn=[];for(let Vr=Kn-1;Vr>=1;Vr--)Jn.push(rn.path[Vr]);for(let Vr=1;Vr<Qn.path.length;Vr++)Jn.push(Qn.path[Vr]);const Zn=2.5*Qt;V&&(Jn=Jn.map(([Vr,Wr,Ki],Nr)=>(Te&&!ze&&(Ki=Te(Nr<Kn-1?rn.tilePath[Kn-1-Nr]:Qn.tilePath[Nr-Kn+2])[2]),Pl(Vr,Wr,Ki,V))),Jn.some(Vr=>Vr[3]<=0)&&(Jn=[]));let Er=[];if(Jn.length>0){let Vr=1/0,Wr=-1/0,Ki=1/0,Nr=-1/0;for(const Ri of Jn)Vr=Math.min(Vr,Ri[0]),Ki=Math.min(Ki,Ri[1]),Wr=Math.max(Wr,Ri[0]),Nr=Math.max(Nr,Ri[1]);Wr>=mn.x&&Vr<=Nn.x&&Nr>=mn.y&&Ki<=Nn.y&&(Er=[Jn.map(Ri=>new i.P(Ri[0],Ri[1]))],(Vr<mn.x||Wr>Nn.x||Ki<mn.y||Nr>Nn.y)&&(Er=i.bV(Er,mn.x,mn.y,Nn.x,Nn.y)))}for(const Vr of Er){dn.reset(Vr,.25*Qt);let Wr=0;Wr=dn.length<=.5*Qt?1:Math.ceil(dn.paddedLength/Zn)+1;for(let Ki=0;Ki<Wr;Ki++){const Nr=Ki/Math.max(Wr-1,1),Ri=dn.lerp(Nr),qi=Ri.x+Zt,Rs=Ri.y+Zt;ve.push(qi,Rs,Qt,0);const $r=qi-Qt,zi=Rs-Qt,ji=qi+Qt,Ui=Rs+Qt;if(Nt=Nt&&this.isOffscreen($r,zi,ji,Ui),Ut=Ut||this.isInsideGrid($r,zi,ji,Ui),!d&&this.grid.hitTestCircle(qi,Rs,Qt,W)&&(it=!0,!G))return{circles:[],offscreen:!1,collisionDetected:it,occluded:!1}}}}return{circles:!G&&it||!Ut?[]:ve,offscreen:Nt,collisionDetected:it,occluded:Oe.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let m=1/0,S=1/0,A=-1/0,k=-1/0;for(const G of o){const X=new i.P(G.x+Zt,G.y+Zt);m=Math.min(m,X.x),S=Math.min(S,X.y),A=Math.max(A,X.x),k=Math.max(k,X.y),d.push(X)}const N=this.grid.query(m,S,A,k).concat(this.ignoredGrid.query(m,S,A,k)),R={},V={};for(const G of N){const X=G.key;if(R[X.bucketInstanceId]===void 0&&(R[X.bucketInstanceId]={}),R[X.bucketInstanceId][X.featureIndex])continue;const W=[new i.P(G.x1,G.y1),new i.P(G.x2,G.y1),new i.P(G.x2,G.y2),new i.P(G.x1,G.y2)];i.bW(d,W)&&(R[X.bucketInstanceId][X.featureIndex]=!0,V[X.bucketInstanceId]===void 0&&(V[X.bucketInstanceId]=[]),V[X.bucketInstanceId].push(X.featureIndex))}return V}insertCollisionBox(o,d,m,S,A){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:S,collisionGroupID:A},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,d,m,S,A){const k=d?this.ignoredGrid:this.grid,N={bucketInstanceId:m,featureIndex:S,collisionGroupID:A};for(let R=0;R<o.length;R+=4)k.insertCircle(N,o[R],o[R+1],o[R+2])}projectAndGetPerspectiveRatio(o,d,m,S,A,k,N){const R=[d,m,S,1];let V=!1;S||this.transform.pitch>0?(i.aC(R,R,o),this.fogState&&A&&N.name!=="globe"&&(V=function(W,te,ie,se,ve,ue){const be=ue.calculateFogTileMatrix(ve),Te=[te,ie,se];return i.af(Te,Te,be),ar(W,i.ag(Te),ue.pitch,ue._fov)}(this.fogState,d,m,S,A.toUnwrapped(),this.transform)>.9)):Rt(R,R,o);const G=R[3];return{point:new i.P((R[0]/G+1)/2*this.transform.width+Zt,(-R[1]/G+1)/2*this.transform.height+Zt),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(N)/G*.5,1.5),signedDistanceFromCamera:G,occluded:k&&R[2]>G||V}}isOffscreen(o,d,m,S){return m<Zt||o>=this.screenRightBoundary||S<Zt||d>this.screenBottomBoundary}isInsideGrid(o,d,m,S){return m>=0&&o<this.gridRightBoundary&&S>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const o=i.bA([]);return i.br(o,o,[-100,-100,0]),o}}class Wn{constructor(o,d,m,S){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?d:-d))):S&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class Mr{constructor(o,d,m,S,A,k=!1){this.text=new Wn(o?o.text:null,d,m,A),this.icon=new Wn(o?o.icon:null,d,S,A),this.clipped=k}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ln{constructor(o,d,m,S=!1){this.text=o,this.icon=d,this.skipFade=m,this.clipped=S}}class lr{constructor(){this.invProjMatrix=i.bC(),this.viewportMatrix=i.bC(),this.circles=[]}}class ur{constructor(o,d,m,S,A){this.bucketInstanceId=o,this.featureIndex=d,this.sourceLayerIndex=m,this.bucketIndex=S,this.tileID=A}}class $i{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const d=++this.maxGroupID;this.collisionGroups[o]={ID:d,predicate:m=>m.collisionGroupID===d}}return this.collisionGroups[o]}}function aa(g,o,d,m,S){const{horizontalAlign:A,verticalAlign:k}=i.c0(g),N=-(A-.5)*o,R=-(k-.5)*d,V=i.c1(g,m);return new i.P(N+V[0]*S,R+V[1]*S)}function Hr(g,o,d,m,S){const A=new i.P(g,o);return d&&A._rotate(m?S:-S),A}class oa{constructor(o,d,m,S,A,k){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new kn(this.transform,A),this.buildingIndex=k,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new $i(m),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,d,m,S,A=1){const k=m.getBucket(d),N=m.latestFeatureIndex;if(!k||!N||d.fqid!==k.layerIds[0])return;const R=k.layers[0].layout,V=k.layers[0].paint,G=m.collisionBoxArray,X=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),W=m.tileSize/i.al,te=m.tileID.toUnwrapped();this.transform.setProjection(k.projection);const ie=(se=m.tileID,ve=k.getProjection(),ue=this.transform,ve.name===this.projection?ue.calculateProjMatrix(se.toUnwrapped()):Jd(ue,ve,se));var se,ve,ue;const be=R.get("text-pitch-alignment")==="map",Te=R.get("text-rotation-alignment")==="map";d.compileFilter(d.options);const ke=d.dynamicFilter(),Ue=d.dynamicFilterNeedsFeature(),Fe=this.transform.calculatePixelsToTileUnitsMatrix(m),Ve=eh(ie,m.tileID.canonical,be,Te,this.transform,k.getProjection(),Fe);let ze=null;const Oe=k.getProjection().createInversionMatrix(this.transform,m.tileID.canonical);if(be){const it=md(ie,m.tileID.canonical,be,Te,this.transform,k.getProjection(),Fe);ze=i.aB([],this.transform.labelPlaneMatrix,it)}let Ge=null;ke&&m.latestFeatureIndex&&(Ge={unwrappedTileID:te,dynamicFilter:ke,dynamicFilterNeedsFeature:Ue}),this.retainedQueryData[k.bucketInstanceId]=new ur(k.bucketInstanceId,N,k.sourceLayerIndex,k.index,m.tileID);const[Tt,ut]=k.layers[0].layout.get("text-size-scale-range"),jt=i.aA(A,Tt,ut),[bt,Dt]=R.get("icon-size-scale-range"),gn=i.aA(A,bt,Dt),St={bucket:k,layout:R,paint:V,posMatrix:ie,invMatrix:Oe,mercatorCenter:[i.aF(this.transform.center.lng),i.aJ(this.transform.center.lat)],textLabelPlaneMatrix:Ve,labelToScreenMatrix:ze,clippingData:Ge,scale:X,textPixelRatio:W,holdingForFade:m.holdingForFade(),collisionBoxArray:G,partiallyEvaluatedTextSize:i.bK(k.textSizeData,this.transform.zoom,jt),partiallyEvaluatedIconSize:i.bK(k.iconSizeData,this.transform.zoom,gn),collisionGroup:this.collisionGroups.get(k.sourceID),latestFeatureIndex:m.latestFeatureIndex};if(S)for(const it of k.sortKeyRanges){const{sortKey:Ut,symbolInstanceStart:Nt,symbolInstanceEnd:Qt}=it;o.push({sortKey:Ut,symbolInstanceStart:Nt,symbolInstanceEnd:Qt,parameters:St})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:k.symbolInstances.length,parameters:St})}attemptAnchorPlacement(o,d,m,S,A,k,N,R,V,G,X,W,te,ie,se,ve,ue,be,Te,ke,Ue){const{textOffset0:Fe,textOffset1:Ve,crossTileID:ze}=se,Oe=[Fe,Ve],Ge=aa(o,k,N,Oe,R),Tt=this.collisionIndex.placeCollisionBox(ue,R,d,m,S,A,Hr(Ge.x,Ge.y,V,G,this.transform.angle),ie,X,W,te.predicate);if(Te){const ut=ue.getSymbolInstanceIconSize(Ue,this.transform.zoom,se.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ue,ut,Te,m,S,A,Hr(Ge.x,Ge.y,V,G,this.transform.angle),ie,X,W,te.predicate).box.length===0)return}if(Tt.box.length>0){let ut;return this.prevPlacement&&this.prevPlacement.variableOffsets[ze]&&this.prevPlacement.placements[ze]&&this.prevPlacement.placements[ze].text&&(ut=this.prevPlacement.variableOffsets[ze].anchor),this.variableOffsets[ze]={textOffset:Oe,width:k,height:N,anchor:o,textScale:R,prevAnchor:ut},this.markUsedJustification(ue,o,se,be),ue.allowVerticalPlacement&&(this.markUsedOrientation(ue,be,se),this.placedOrientations[ze]=be),{shift:Ge,placedGlyphBoxes:Tt}}}placeLayerBucketPart(o,d,m,S,A=1){const{bucket:k,layout:N,paint:R,posMatrix:V,textLabelPlaneMatrix:G,labelToScreenMatrix:X,clippingData:W,textPixelRatio:te,mercatorCenter:ie,invMatrix:se,holdingForFade:ve,collisionBoxArray:ue,partiallyEvaluatedTextSize:be,partiallyEvaluatedIconSize:Te,collisionGroup:ke,latestFeatureIndex:Ue}=o.parameters,Fe=N.get("text-optional"),Ve=N.get("icon-optional"),ze=N.get("text-allow-overlap"),Oe=N.get("icon-allow-overlap"),Ge=N.get("text-rotation-alignment")==="map",Tt=N.get("icon-rotation-alignment")==="map",ut=N.get("text-pitch-alignment")==="map",jt=R.get("symbol-z-offset"),bt=N.get("symbol-elevation-reference")==="sea",Dt=N.get("symbol-placement"),[gn,St]=N.get("text-size-scale-range"),[it,Ut]=N.get("icon-size-scale-range"),Nt=i.aA(A,gn,St),Qt=i.aA(A,it,Ut),mn=N.get("text-variable-anchor"),Nn=Ge&&Dt!=="point",dn=Tt&&Dt!=="point",rn=mn&&k.hasTextData(),Qn=k.hasIconTextFit()&&rn&&k.hasIconData();this.transform.setProjection(k.projection);const Kn=rn||Nn,Jn=dn||Qn;let Zn=ze&&(Oe||!k.hasIconData()||Ve),Er=Oe&&(ze||!k.hasTextData()||Fe);const Vr=!jt.isConstant();!k.collisionArrays&&ue&&k.deserializeCollisionBoxes(ue),m&&S&&k.updateCollisionDebugBuffers(this.transform.zoom,ue,Nt,Qt);const Wr=(Nr,Ri,qi)=>{const{crossTileID:Rs,numVerticalGlyphVertices:$r}=Nr;let zi=null;if(W&&W.dynamicFilterNeedsFeature||Vr){const ga=this.retainedQueryData[k.bucketInstanceId];zi=Ue.loadFeature({featureIndex:Nr.featureIndex,bucketIndex:ga.bucketIndex,sourceLayerIndex:ga.sourceLayerIndex,layoutVertexArrayOffset:0})}if(W&&!(0,W.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},zi,this.retainedQueryData[k.bucketInstanceId].tileID.canonical,new i.P(Nr.tileAnchorX,Nr.tileAnchorY),this.transform.calculateDistanceTileData(W.unwrappedTileID)))return this.placements[Rs]=new ln(!1,!1,!1,!0),void d.add(Rs);const ji=jt.evaluate(zi,{});if(d.has(Rs))return;if(ve)return void(this.placements[Rs]=new ln(!1,!1,!1));let Ui=!1,Vs=!1,ba=!0,Mo=!1,$s=!1,Zr=null,gr={box:null,offscreen:null,occluded:null},Yi={box:null},la=null,Ks=null,Va=null,el=0,Uu=0,Vu=0;qi.textFeatureIndex?el=qi.textFeatureIndex:Nr.useRuntimeCollisionCircles&&(el=Nr.featureIndex),qi.verticalTextFeatureIndex&&(Uu=qi.verticalTextFeatureIndex);const uu=ga=>{ga.tileID=this.retainedQueryData[k.bucketInstanceId].tileID;const wa=this.transform.elevation;ga.elevation=bt?ji:ji+(wa?wa.getAtTileOffset(ga.tileID,ga.tileAnchorX,ga.tileAnchorY):0),ga.elevation+=Nr.zOffset},du=qi.textBox;if(du){uu(du);const ga=Ys=>{let ao=i.bL.horizontal;if(k.allowVerticalPlacement&&!Ys&&this.prevPlacement){const Lo=this.prevPlacement.placedOrientations[Rs];Lo&&(this.placedOrientations[Rs]=Lo,ao=Lo,this.markUsedOrientation(k,ao,Nr))}return ao},wa=(Ys,ao)=>{if(k.allowVerticalPlacement&&$r>0&&qi.verticalTextBox){for(const Lo of k.writingModes)if(Lo===i.bL.vertical?(gr=ao(),Yi=gr):gr=Ys(),gr&&gr.box&&gr.box.length)break}else gr=Ys()};if(mn){let Ys=mn;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Rs]){const Ma=this.prevPlacement.variableOffsets[Rs];Ys.indexOf(Ma.anchor)>0&&(Ys=Ys.filter(Ml=>Ml!==Ma.anchor),Ys.unshift(Ma.anchor))}const ao=(Ma,Ml,Xh)=>{const Xf=k.getSymbolInstanceTextSize(be,Nr,this.transform.zoom,Ri),ch=(Ma.x2-Ma.x1)*Xf+2*Ma.padding,lm=(Ma.y2-Ma.y1)*Xf+2*Ma.padding,cm=Nr.hasIconTextFit&&!Oe?Ml:null;cm&&uu(cm);let Jh={box:[],offscreen:!1,occluded:!1};const Qy=ze?2*Ys.length:Ys.length;for(let Jf=0;Jf<Qy;++Jf){const Qh=this.attemptAnchorPlacement(Ys[Jf%Ys.length],Ma,ie,se,Kn,ch,lm,Xf,Ge,ut,te,V,ke,Jf>=Ys.length,Nr,Ri,k,Xh,cm,be,Te);if(Qh&&(Jh=Qh.placedGlyphBoxes,Jh&&Jh.box&&Jh.box.length)){Ui=!0,Zr=Qh.shift;break}}return Jh};wa(()=>ao(du,qi.iconBox,i.bL.horizontal),()=>{const Ma=qi.verticalTextBox;return Ma&&uu(Ma),k.allowVerticalPlacement&&!(gr&&gr.box&&gr.box.length)&&$r>0&&Ma?ao(Ma,qi.verticalIconBox,i.bL.vertical):{box:null,offscreen:null,occluded:null}}),gr&&(Ui=gr.box,ba=gr.offscreen,Mo=gr.occluded);const Lo=ga(!(!gr||!gr.box));if(!Ui&&this.prevPlacement){const Ma=this.prevPlacement.variableOffsets[Rs];Ma&&(this.variableOffsets[Rs]=Ma,this.markUsedJustification(k,Ma.anchor,Nr,Lo))}}else{const Ys=(ao,Lo)=>{const Ma=k.getSymbolInstanceTextSize(be,Nr,this.transform.zoom,Ri),Ml=this.collisionIndex.placeCollisionBox(k,Ma,ao,ie,se,Kn,new i.P(0,0),ze,te,V,ke.predicate);return Ml&&Ml.box&&Ml.box.length&&(this.markUsedOrientation(k,Lo,Nr),this.placedOrientations[Rs]=Lo),Ml};wa(()=>Ys(du,i.bL.horizontal),()=>{const ao=qi.verticalTextBox;return k.allowVerticalPlacement&&$r>0&&ao?(uu(ao),Ys(ao,i.bL.vertical)):{box:null,offscreen:null,occluded:null}}),ga(!!(gr&&gr.box&&gr.box.length))}}if(la=gr,Ui=la&&la.box&&la.box.length>0,ba=la&&la.offscreen,Mo=la&&la.occluded,Nr.useRuntimeCollisionCircles){const ga=k.text.placedSymbolArray.get(Nr.centerJustifiedTextSymbolIndex>=0?Nr.centerJustifiedTextSymbolIndex:Nr.verticalPlacedTextSymbolIndex),wa=i.bM(k.textSizeData,be,ga),Ys=N.get("text-padding");Ks=this.collisionIndex.placeCollisionCircles(k,ze,ga,k.lineVertexArray,k.glyphOffsetArray,wa,V,G,X,m,ut,ke.predicate,Nr.collisionCircleDiameter*wa/i.bX,Ys,this.retainedQueryData[k.bucketInstanceId].tileID),Ui=ze||Ks.circles.length>0&&!Ks.collisionDetected,ba=ba&&Ks.offscreen,Mo=Ks.occluded}if(qi.iconFeatureIndex&&(Vu=qi.iconFeatureIndex),qi.iconBox){const ga=wa=>{uu(wa);const Ys=Nr.hasIconTextFit&&Zr?Hr(Zr.x,Zr.y,Ge,ut,this.transform.angle):new i.P(0,0),ao=k.getSymbolInstanceIconSize(Te,this.transform.zoom,Nr.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(k,ao,wa,ie,se,Jn,Ys,Oe,te,V,ke.predicate)};Yi&&Yi.box&&Yi.box.length&&qi.verticalIconBox?(Va=ga(qi.verticalIconBox),Vs=Va.box.length>0):(Va=ga(qi.iconBox),Vs=Va.box.length>0),ba=ba&&Va.offscreen,$s=Va.occluded}const _c=Fe||Nr.numHorizontalGlyphVertices===0&&$r===0,Id=Ve||Nr.numIconVertices===0;if(_c||Id?Id?_c||(Vs=Vs&&Ui):Ui=Vs&&Ui:Vs=Ui=Vs&&Ui,Ui&&la&&la.box&&this.collisionIndex.insertCollisionBox(la.box,N.get("text-ignore-placement"),k.bucketInstanceId,Yi&&Yi.box&&Uu?Uu:el,ke.ID),Vs&&Va&&this.collisionIndex.insertCollisionBox(Va.box,N.get("icon-ignore-placement"),k.bucketInstanceId,Vu,ke.ID),Ks&&(Ui&&this.collisionIndex.insertCollisionCircles(Ks.circles,N.get("text-ignore-placement"),k.bucketInstanceId,el,ke.ID),m)){const ga=k.bucketInstanceId;let wa=this.collisionCircleArrays[ga];wa===void 0&&(wa=this.collisionCircleArrays[ga]=new lr);for(let Ys=0;Ys<Ks.circles.length;Ys+=4)wa.circles.push(Ks.circles[Ys+0]),wa.circles.push(Ks.circles[Ys+1]),wa.circles.push(Ks.circles[Ys+2]),wa.circles.push(Ks.collisionDetected?1:0)}const lh=k.projection.name!=="globe";Zn=Zn&&(lh||!Mo),Er=Er&&(lh||!$s),this.placements[Rs]=new ln(Ui||Zn,Vs||Er,ba||k.justReloaded),d.add(Rs)},Ki=this.retainedQueryData[k.bucketInstanceId].tileID;if(k.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(k,Ki),k.elevationType==="road"&&k.updateRoadElevation(Ki.canonical),k.updateZOffset(),k.sortFeaturesByY){const Nr=k.getSortedSymbolIndexes(this.transform.angle);for(let Ri=Nr.length-1;Ri>=0;--Ri){const qi=Nr[Ri];Wr(k.symbolInstances.get(qi),qi,k.collisionArrays[qi])}k.hasAnyZOffset&&i.w(`${k.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(k.hasAnyZOffset){const Nr=k.getSortedIndexesByZOffset();for(let Ri=0;Ri<Nr.length;++Ri){const qi=Nr[Ri];Wr(k.symbolInstances.get(qi),qi,k.collisionArrays[qi])}}else for(let Nr=o.symbolInstanceStart;Nr<o.symbolInstanceEnd;Nr++)Wr(k.symbolInstances.get(Nr),Nr,k.collisionArrays[Nr]);if(m&&k.bucketInstanceId in this.collisionCircleArrays){const Nr=this.collisionCircleArrays[k.bucketInstanceId];i.bl(Nr.invProjMatrix,V),Nr.viewportMatrix=this.collisionIndex.getViewportMatrix()}k.justReloaded=!1}markUsedJustification(o,d,m,S){const{leftJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:k,rightJustifiedTextSymbolIndex:N,verticalPlacedTextSymbolIndex:R,crossTileID:V}=m,G=i.c2(d),X=S===i.bL.vertical?R:G==="left"?A:G==="center"?k:G==="right"?N:-1;A>=0&&(o.text.placedSymbolArray.get(A).crossTileID=X>=0&&A!==X?0:V),k>=0&&(o.text.placedSymbolArray.get(k).crossTileID=X>=0&&k!==X?0:V),N>=0&&(o.text.placedSymbolArray.get(N).crossTileID=X>=0&&N!==X?0:V),R>=0&&(o.text.placedSymbolArray.get(R).crossTileID=X>=0&&R!==X?0:V)}markUsedOrientation(o,d,m){const S=d===i.bL.horizontal||d===i.bL.horizontalOnly?d:0,A=d===i.bL.vertical?d:0,{leftJustifiedTextSymbolIndex:k,centerJustifiedTextSymbolIndex:N,rightJustifiedTextSymbolIndex:R,verticalPlacedTextSymbolIndex:V}=m,G=o.text.placedSymbolArray;k>=0&&(G.get(k).placedOrientation=S),N>=0&&(G.get(N).placedOrientation=S),R>=0&&(G.get(R).placedOrientation=S),V>=0&&(G.get(V).placedOrientation=A)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let m=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const S=d?d.symbolFadeChange(o):1,A=d?d.opacities:{},k=d?d.variableOffsets:{},N=d?d.placedOrientations:{};for(const R in this.placements){const V=this.placements[R],G=A[R];G?(this.opacities[R]=new Mr(G,S,V.text,V.icon,null,V.clipped),m=m||V.text!==G.text.placed||V.icon!==G.icon.placed):(this.opacities[R]=new Mr(null,S,V.text,V.icon,V.skipFade,V.clipped),m=m||V.text||V.icon)}for(const R in A){const V=A[R];if(!this.opacities[R]){const G=new Mr(V,S,!1,!1);G.isHidden()||(this.opacities[R]=G,m=m||V.text.placed||V.icon.placed)}}for(const R in k)this.variableOffsets[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.variableOffsets[R]=k[R]);for(const R in N)this.placedOrientations[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.placedOrientations[R]=N[R]);m?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:o)}updateLayerOpacities(o,d,m,S){const A=new Set;for(const k of d){const N=k.getBucket(o);N&&k.latestFeatureIndex&&o.fqid===N.layerIds[0]&&(this.updateBucketOpacities(N,A,k,k.collisionBoxArray,m,S,k.tileID,o.scope),N.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(N,k.tileID),N.elevationType==="road"&&N.updateRoadElevation(k.tileID.canonical),N.updateZOffset())}}updateBucketOpacities(o,d,m,S,A,k,N,R){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const V=o.layers[0].layout,G=o.layers[0].paint,X=!!o.layers[0].dynamicFilter(),W=new Mr(null,0,!1,!1,!0),te=V.get("text-allow-overlap"),ie=V.get("icon-allow-overlap"),se=V.get("text-variable-anchor"),ve=V.get("text-rotation-alignment")==="map",ue=V.get("text-pitch-alignment")==="map",be=G.get("symbol-z-offset"),Te=V.get("symbol-elevation-reference")==="sea",ke=!be.isConstant(),Ue=new Mr(null,0,te&&(ie||!o.hasIconData()||V.get("icon-optional")),ie&&(te||!o.hasTextData()||V.get("text-optional")),!0);!o.collisionArrays&&S&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(S);const Fe=(ze,Oe,Ge)=>{for(let Tt=0;Tt<Oe/4;Tt++)ze.opacityVertexArray.emplaceBack(Ge)};let Ve=0;k&&o.updateReplacement(N,k);for(let ze=0;ze<o.symbolInstances.length;ze++){const Oe=o.symbolInstances.get(ze),{numHorizontalGlyphVertices:Ge,numVerticalGlyphVertices:Tt,crossTileID:ut,numIconVertices:jt,tileAnchorX:bt,tileAnchorY:Dt}=Oe;let gn=null;const St=this.retainedQueryData[o.bucketInstanceId];ke&&Oe&&St&&(gn=m.latestFeatureIndex.loadFeature({featureIndex:Oe.featureIndex,bucketIndex:St.bucketIndex,sourceLayerIndex:St.sourceLayerIndex,layoutVertexArrayOffset:0}));const it=be.evaluate(gn,{}),Ut=d.has(ut);let Nt=this.opacities[ut];Ut?Nt=W:Nt||(Nt=Ue,this.opacities[ut]=Nt),d.add(ut);const Qt=Ge>0||Tt>0,mn=jt>0,Nn=this.placedOrientations[ut],dn=Nn===i.bL.vertical,rn=Nn===i.bL.horizontal||Nn===i.bL.horizontalOnly;!Qt&&!mn||Nt.isHidden()||Ve++;let Qn=!1;if((Qt||mn)&&k)for(const Kn of o.activeReplacements){if(i.bY(Kn,A,i.bZ.Symbol,R)||Kn.min.x>bt||bt>Kn.max.x||Kn.min.y>Dt||Dt>Kn.max.y)continue;const Jn=i.b_(bt,Dt,N.canonical,Kn.footprintTileId.canonical);if(Qn=i.b$(Jn,Kn.footprint),Qn)break}if(Qt){const Kn=Qn?hc:ru(Nt.text);Fe(o.text,Ge,dn?hc:Kn),Fe(o.text,Tt,rn?hc:Kn);const Jn=Nt.text.isHidden(),{leftJustifiedTextSymbolIndex:Zn,centerJustifiedTextSymbolIndex:Er,rightJustifiedTextSymbolIndex:Vr,verticalPlacedTextSymbolIndex:Wr}=Oe,Ki=o.text.placedSymbolArray,Nr=Jn||dn?1:0;Zn>=0&&(Ki.get(Zn).hidden=Nr),Er>=0&&(Ki.get(Er).hidden=Nr),Vr>=0&&(Ki.get(Vr).hidden=Nr),Wr>=0&&(Ki.get(Wr).hidden=Jn||rn?1:0);const Ri=this.variableOffsets[ut];Ri&&this.markUsedJustification(o,Ri.anchor,Oe,Nn);const qi=this.placedOrientations[ut];qi&&(this.markUsedJustification(o,"left",Oe,qi),this.markUsedOrientation(o,qi,Oe))}if(mn){const Kn=Qn?hc:ru(Nt.icon),{placedIconSymbolIndex:Jn,verticalPlacedIconSymbolIndex:Zn}=Oe,Er=o.icon.placedSymbolArray,Vr=Nt.icon.isHidden()?1:0;Jn>=0&&(Fe(o.icon,jt,dn?hc:Kn),Er.get(Jn).hidden=Vr),Zn>=0&&(Fe(o.icon,Oe.numVerticalIconVertices,rn?hc:Kn),Er.get(Zn).hidden=Vr)}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const Kn=o.collisionArrays[ze];if(Kn){let Jn=new i.P(0,0),Zn=!0;if(Kn.textBox||Kn.verticalTextBox){if(se){const Vr=this.variableOffsets[ut];Vr?(Jn=aa(Vr.anchor,Vr.width,Vr.height,Vr.textOffset,Vr.textScale),ve&&Jn._rotate(ue?this.transform.angle:-this.transform.angle)):Zn=!1}X&&(Zn=!Nt.clipped),Kn.textBox&&Aa(o.textCollisionBox.collisionVertexArray,Nt.text.placed,!Zn||dn,it,Te,Jn.x,Jn.y),Kn.verticalTextBox&&Aa(o.textCollisionBox.collisionVertexArray,Nt.text.placed,!Zn||rn,it,Te,Jn.x,Jn.y)}const Er=Zn&&!!(!rn&&Kn.verticalIconBox);Kn.iconBox&&Aa(o.iconCollisionBox.collisionVertexArray,Nt.icon.placed,Er,it,Te,Oe.hasIconTextFit?Jn.x:0,Oe.hasIconTextFit?Jn.y:0),Kn.verticalIconBox&&Aa(o.iconCollisionBox.collisionVertexArray,Nt.icon.placed,!Er,it,Te,Oe.hasIconTextFit?Jn.x:0,Oe.hasIconTextFit?Jn.y:0)}}}if(o.fullyClipped=Ve===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const ze=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=ze.invProjMatrix,o.placementViewportMatrix=ze.viewportMatrix,o.collisionCircleArray=ze.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,d){const m=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*m>o}setStale(){this.stale=!0}}function Aa(g,o,d,m,S,A,k){g.emplaceBack(o?1:0,d?1:0,A||0,k||0,m,S?1:0),g.emplaceBack(o?1:0,d?1:0,A||0,k||0,m,S?1:0),g.emplaceBack(o?1:0,d?1:0,A||0,k||0,m,S?1:0),g.emplaceBack(o?1:0,d?1:0,A||0,k||0,m,S?1:0)}const Oa=Math.pow(2,25),Bs=Math.pow(2,24),Cs=Math.pow(2,17),dc=Math.pow(2,16),Fh=Math.pow(2,9),zh=Math.pow(2,8),Du=Math.pow(2,1);function ru(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const o=g.placed?1:0,d=Math.floor(127*g.opacity);return d*Oa+o*Bs+d*Cs+o*dc+d*Fh+o*zh+d*Du+o}const hc=0;class yd{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(o,d,m,S,A,k){const N=this._bucketParts;for(;this._currentTileIndex<o.length;)if(d.getBucketParts(N,S,o[this._currentTileIndex],this._sortAcrossTiles,k),this._currentTileIndex++,A())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,N.sort((R,V)=>R.sortKey-V.sortKey));this._currentPartIndex<N.length;){const R=N[this._currentPartIndex];if(d.placeLayerBucketPart(R,this._seenCrossTileIDs,m,R.symbolInstanceStart===0,k),this._currentPartIndex++,A())return!0}return!1}}class eo{constructor(o,d,m,S,A,k,N,R,V){this.placement=new oa(o,A,k,N,R,V),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(o,d,m,S,A){const k=i.o.now(),N=()=>{const R=i.o.now()-k;return!this._forceFullPlacement&&R>2};for(;this._currentPlacementIndex>=0;){const R=d[o[this._currentPlacementIndex]],V=this.placement.collisionIndex.transform.zoom;if(R.type==="symbol"&&(!R.minzoom||R.minzoom<=V)&&(!R.maxzoom||R.maxzoom>V)){const G=R,X=G.layout.get("symbol-z-elevate"),W=G.layout.get("symbol-sort-key").constantOr(1)!==void 0,te=G.layout.get("symbol-z-order"),ie=te==="viewport-y"||te==="auto"&&!(te!=="viewport-y"&&W),se=G.layout.get("text-allow-overlap")||G.layout.get("icon-allow-overlap")||G.layout.get("text-ignore-placement")||G.layout.get("icon-ignore-placement"),ve=ie&&se,ue=this._inProgressLayer=this._inProgressLayer||new yd(G),be=i.B(R.source,R.scope);if(ue.continuePlacement(X||ve?S[be]:m[be],this.placement,this._showCollisionBoxes,R,N,A))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const Ta=512/i.al/2;class fo{constructor(o,d,m){this.tileID=o,this.bucketInstanceId=m,this.index=new i.c3(d.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const S=o.canonical.x*i.al,A=o.canonical.y*i.al;for(let k=0;k<d.length;k++){const{key:N,crossTileID:R,tileAnchorX:V,tileAnchorY:G}=d.get(k),X=Math.floor((S+V)*Ta),W=Math.floor((A+G)*Ta);this.index.add(X,W),this.keys.push(N),this.crossTileIDs.push(R)}this.index.finish()}findMatches(o,d,m){const S=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z),A=Ta/Math.pow(2,d.canonical.z-this.tileID.canonical.z),k=d.canonical.x*i.al,N=d.canonical.y*i.al;for(let R=0;R<o.length;R++){const V=o.get(R);if(V.crossTileID)continue;const{key:G,tileAnchorX:X,tileAnchorY:W}=V,te=Math.floor((k+X)*A),ie=Math.floor((N+W)*A),se=this.index.range(te-S,ie-S,te+S,ie+S).sort((ve,ue)=>ve-ue);for(const ve of se){const ue=this.crossTileIDs[ve];if(this.keys[ve]===G&&!m.has(ue)){m.add(ue),V.crossTileID=ue;break}}}}}class Bh{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class vd{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const d=Math.round((o-this.lng)/360);if(d!==0)for(const m in this.indexes){const S=this.indexes[m],A={};for(const k in S){const N=S[k];N.tileID=N.tileID.unwrapTo(N.tileID.wrap+d),A[N.tileID.key]=N}this.indexes[m]=A}this.lng=o}addBucket(o,d,m){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let A=0;A<d.symbolInstances.length;A++)d.symbolInstances.get(A).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]=new Set);const S=this.usedCrossTileIDs[o.overscaledZ];for(const A in this.indexes){const k=this.indexes[A];if(Number(A)>o.overscaledZ)for(const N in k){const R=k[N];R.tileID.isChildOf(o)&&R.findMatches(d.symbolInstances,o,S)}else{const N=k[o.scaledTo(Number(A)).key];N&&N.findMatches(d.symbolInstances,o,S)}}for(let A=0;A<d.symbolInstances.length;A++){const k=d.symbolInstances.get(A);k.crossTileID||(k.crossTileID=m.generate(),S.add(k.crossTileID))}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new fo(o,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(o,d){for(const m of d.crossTileIDs)this.usedCrossTileIDs[o].delete(m)}removeStaleBuckets(o){let d=!1;for(const m in this.indexes){const S=this.indexes[m];for(const A in S)o[S[A].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,S[A]),delete S[A],d=!0)}return d}}class Ca{constructor(){this.layerIndexes={},this.crossTileIDs=new Bh,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,d,m,S){let A=this.layerIndexes[o.fqid];A===void 0&&(A=this.layerIndexes[o.fqid]=new vd);let k=!1;const N={};S.name!=="globe"&&A.handleWrapJump(m);for(const R of d){const V=R.getBucket(o);V&&o.fqid===V.layerIds[0]&&(V.bucketInstanceId||(V.bucketInstanceId=++this.maxBucketInstanceId),A.addBucket(R.tileID,V,this.crossTileIDs)&&(k=!0),N[V.bucketInstanceId]=!0)}return A.removeStaleBuckets(N)&&(k=!0),k}pruneUnusedLayers(o){const d={};o.forEach(m=>{d[m]=!0});for(const m in this.layerIndexes)d[m]||delete this.layerIndexes[m]}}const bs=771;class kr{constructor(o,d,m,S){this.blendFunction=o,this.blendColor=d.toNonPremultipliedRenderColor(null),this.mask=m,this.blendEquation=S}}kr.Replace=[1,0,1,0],kr.disabled=new kr(kr.Replace,i.ao.transparent,[!1,!1,!1,!1]),kr.unblended=new kr(kr.Replace,i.ao.transparent,[!0,!0,!0,!0]),kr.alphaBlended=new kr([1,bs,1,bs],i.ao.transparent,[!0,!0,!0,!0]),kr.alphaBlendedNonPremultiplied=new kr([770,bs,770,bs],i.ao.transparent,[!0,!0,!0,!0]),kr.multiply=new kr([774,0,774,0],i.ao.transparent,[!0,!0,!0,!0]);class Ln{constructor(o,d,m){this.func=o,this.mask=d,this.range=m}}Ln.ReadOnly=!1,Ln.ReadWrite=!0,Ln.disabled=new Ln(519,Ln.ReadOnly,[0,1]);const Uh=7680;class sr{constructor(o,d,m,S,A,k){this.test=o,this.ref=d,this.mask=m,this.fail=S,this.depthFail=A,this.pass=k}}sr.disabled=new sr({func:519,mask:0},0,0,Uh,Uh,Uh);const Nc=1029,_d=2305;class hr{constructor(o,d,m){this.enable=o,this.mode=d,this.frontFace=m}}function xd(g,o){const d=i.c9(g,3);i.cb(g,o),i.cf(g,3,d)}function Ru(g,o){const d=i.c6([]);return i.c7(d,d,-o),i.c8(d,d,-g),d}function dl(g,o){const d=[g[0],g[1],0],m=[o[0],o[1],0];if(i.ag(d)>=1e-15){const k=i.aw([],d);i.c4(m,k,i.bJ(m,k)),o[0]=m[0],o[1]=m[1]}const S=i.bI([],o,g);if(i.c5(S)<1e-15)return null;const A=Math.atan2(-S[1],S[0]);return Ru(Math.atan2(Math.sqrt(g[0]*g[0]+g[1]*g[1]),-g[2]),A)}hr.disabled=new hr(!1,Nc,_d),hr.backCCW=new hr(!0,Nc,_d),hr.backCW=new hr(!0,Nc,2304),hr.frontCW=new hr(!0,1028,2304),hr.frontCCW=new hr(!0,1028,_d);class ql{constructor(o,d){this.position=o,this.orientation=d}get position(){return this._position}set position(o){if(o){const d=o instanceof i.ae?o:new i.ae(o[0],o[1],o[2]);this._renderWorldCopies&&(d.x=i.bT(d.x,0,1)),this._position=d}else this._position=null}lookAtPoint(o,d){if(this.orientation=null,!this.position)return;const m=this.position,S=this._elevation?this._elevation.getAtPointOrZero(i.ae.fromLngLat(o)):0,A=i.ae.fromLngLat(o,S),k=[A.x-m.x,A.y-m.y,A.z-m.z];d||(d=[0,0,1]),d[2]=Math.abs(d[2]),this.orientation=dl(k,d)}setPitchBearing(o,d){this.orientation=Ru(i.an(o),i.an(-d))}}class ju{constructor(o,d){this._transform=i.bA([]),this.orientation=d,this.position=o}get mercatorPosition(){const o=this.position;return new i.ae(o[0],o[1],o[2])}get position(){const o=i.c9(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var d;o&&i.cf(this._transform,3,[(d=o)[0],d[1],d[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||i.c6([]),o&&xd(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),d=this.right();return{bearing:Math.atan2(-d[1],d[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,d){this._orientation=Ru(o,d),xd(this._transform,this._orientation)}forward(){const o=i.c9(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=i.c9(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=i.c9(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,d){const m=new Float64Array(16);return i.bl(m,this.getWorldToCamera(o,d)),m}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(o,d,m){const S=this.position;i.c4(S,S,-o);const A=new Float64Array(16);return i.bq(A,[m,m,m]),i.br(A,A,S),A[10]*=d,A}getWorldToCamera(o,d){const m=new Float64Array(16),S=new Float64Array(4),A=this.position;return i.ca(S,this._orientation),i.c4(A,A,-o),i.cb(m,S),i.br(m,m,A),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=d,m[9]*=d,m[10]*=d,m[11]*=d,m}getCameraToClipPerspective(o,d,m,S){const A=new Float64Array(16);return i.cc(A,o,d,m,S),A}getCameraToClipOrthographic(o,d,m,S,A,k){const N=new Float64Array(16);return i.cd(N,o,d,m,S,A,k),N}getDistanceToElevation(o,d=!1){const m=o===0?0:i.ce(o,d?i.a$(this.position[1]):this.position[1]),S=this.forward();return(m-this.position[2])/S[2]}clone(){return new ju([...this.position],[...this.orientation])}}const Ms={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class bd{constructor(o=0,d=0,m=0,S=0){if(isNaN(o)||o<0||isNaN(d)||d<0||isNaN(m)||m<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=d,this.left=m,this.right=S}interpolate(o,d,m){return d.top!=null&&o.top!=null&&(this.top=i.ak(o.top,d.top,m)),d.bottom!=null&&o.bottom!=null&&(this.bottom=i.ak(o.bottom,d.bottom,m)),d.left!=null&&o.left!=null&&(this.left=i.ak(o.left,d.left,m)),d.right!=null&&o.right!=null&&(this.right=i.ak(o.right,d.right,m)),this}getCenter(o,d){const m=i.aA((this.left+o-this.right)/2,0,o),S=i.aA((this.top+d-this.bottom)/2,0,d);return new i.P(m,S)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new bd(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Mc=15;class po{constructor(o,d,m,S,A,k,N){this.tileSize=512,this._renderWorldCopies=A===void 0||A,this._minZoom=o||0,this._maxZoom=d||22,this._minPitch=m??0,this._maxPitch=S??60,this.setProjection(k),this.setMaxBounds(N),this.width=0,this.height=0,this._center=new i.aR(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new bd,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new ju,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const o=new po(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o._allowWorldUnderZoom=this._allowWorldUnderZoom,o}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<Mc}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(o,d=!1){const m=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||m)&&this._updateCameraOnTerrain(),(o||m)&&this._constrainCamera(d),this._calcMatrices()}getProjection(){return i.aH(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const d=this.projection?this.getProjection():void 0;this.projection=i.cl(this.projectionOptions);const m=this.getProjection(),S=!i.by(d,m);return S&&this._calcMatrices(),this.mercatorFromTransition=!1,S}setOrthographicProjectionAtLowPitch(o){return this._orthographicProjectionAtLowPitch!==o&&(this._orthographicProjectionAtLowPitch=o,this._calcMatrices(),!0)}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.cl({name:"mercator"});const d=o!==this.projection.name;return d&&this._calcMatrices(),d}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.ce(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bT(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const d=-o*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=i.cm(),i.cn(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const d=i.aA(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=i.an(o),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const d=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._setZoom(d),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(o){this._tileCoverLift!==o&&(this._tileCoverLift=o)}_updateCameraOnTerrain(){const o=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,d=this.elevation&&o===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||o===Number.NEGATIVE_INFINITY&&(!d||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const m=this._elevation;d||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&m.exaggeration()&&this._centerAltitudeValidForExaggeration!==m.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*m.exaggeration(),this._centerAltitudeValidForExaggeration=m.exaggeration()):(this._centerAltitude=o||0,this._centerAltitudeValidForExaggeration=m.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){if(this._centerAltitudeValidForExaggeration===void 0)return;const o=Math.max(0,(this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize);this._seaLevelZoom=this._zoomFromMercatorZ(o)}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,d=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let S=0,A=0;for(let k=0;k<d.length;k++){const N=new i.P(d[k][0]*this.width,m+d[k][1]*(this.height-m)),R=o.pointCoordinate(N);if(!R)continue;const V=1/Math.hypot(R[0]-this._camera.position[0],R[1]-this._camera.position[1]);S+=R[3]*V,A+=V}return A===0?NaN:S/A}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const o=this._seaLevelZoom,d=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),m=this.pixelsPerMeter/this.worldSize*d,S=this._mercatorZfromZoom(o),A=this._mercatorZfromZoom(this._maxZoom),k=Math.max(S-m,A);this._setZoom(this._zoomFromMercatorZ(k))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const d=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let m;m=o.z<this._camera.position[2]?[d.x,d.y,d.z]:[o.x,o.y,o.z];const S=i.ag(i.av([],this._camera.position,m));return i.aA(this._zoomFromMercatorZ(S),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let d=!1;if(o.orientation&&!i.co(o.orientation,this._camera.orientation)&&(d=this._setCameraOrientation(o.orientation)),o.position){const m=[o.position.x,o.position.y,o.position.z];i.cp(m,this._camera.position)||(this._setCameraPosition(m),d=!0)}d&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,d=new ql;return d.position=new i.ae(o[0],o[1],o[2]),d.orientation=this._camera.orientation,d._elevation=this.elevation,d._renderWorldCopies=this.renderWorldCopies,d}_setCameraOrientation(o){if(!i.cq(o))return!1;i.cr(o,o);const d=i.cs([],[0,0,-1],o),m=i.cs([],[0,-1,0],o);if(m[2]<0)return!1;const S=dl(d,m);return!!S&&(this._camera.orientation=S,!0)}_setCameraPosition(o){const d=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,S=this.cameraToCenterDistance;o[2]=i.aA(o[2],S/m,S/d),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,d,m){this._unmodified=!1,this._edgeInsets.interpolate(o,d,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const d=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(o){const d=[new i.ct(0,o)];if(this.renderWorldCopies){const m=this.pointCoordinate(new i.P(0,0)),S=this.pointCoordinate(new i.P(this.width,0)),A=this.pointCoordinate(new i.P(this.width,this.height)),k=this.pointCoordinate(new i.P(0,this.height)),N=Math.floor(Math.min(m.x,S.x,A.x,k.x)),R=Math.floor(Math.max(m.x,S.x,A.x,k.x)),V=1;for(let G=N-V;G<=R+V;G++)G!==0&&d.push(new i.ct(G,o))}return d}isLODDisabled(o){return(!o||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(o,d,m){let S=[];const A=m!=null,k=!A;if(k&&this.zoom<d||A&&m[0]===0&&m[1]===0)return S;const N=new Set,R=(G,X,W,te,ie)=>{const se=i.cX(X,G,W,te,ie);N.has(se)||(S.push(new i.aO(G,X,W,te,ie)),N.add(se))};for(let G=0;G<o.length;G++){const X=o[G];if(k&&X.canonical.z!==d)continue;const W=X.canonical,te=X.overscaledZ,ie=X.wrap,se=1<<W.z,ve=W.x+1<se,ue=W.x>0,be=W.y+1<se,Te=W.y>0,ke=X.wrap-(ue?0:1),Ue=X.wrap+(ve?0:1),Fe=ue?W.x-1:se-1,Ve=ve?W.x+1:0;if(A)m[0]<0?(R(te,Ue,W.z,Ve,W.y),m[1]<0&&be&&(R(te,ie,W.z,W.x,W.y+1),R(te,Ue,W.z,Ve,W.y+1)),m[1]>0&&Te&&(R(te,ie,W.z,W.x,W.y-1),R(te,Ue,W.z,Ve,W.y-1))):m[0]>0?(R(te,ke,W.z,Fe,W.y),m[1]<0&&be&&(R(te,ie,W.z,W.x,W.y+1),R(te,ke,W.z,Fe,W.y+1)),m[1]>0&&Te&&(R(te,ie,W.z,W.x,W.y-1),R(te,ke,W.z,Fe,W.y-1))):m[1]<0&&be?R(te,ie,W.z,W.x,W.y+1):Te&&R(te,ie,W.z,W.x,W.y-1);else{const ze=X.visibleQuadrants;1&ze&&(R(te,ke,W.z,Fe,W.y),Te&&(R(te,ie,W.z,W.x,W.y-1),R(te,ke,W.z,Fe,W.y-1))),2&ze&&(R(te,Ue,W.z,Ve,W.y),Te&&(R(te,ie,W.z,W.x,W.y-1),R(te,Ue,W.z,Ve,W.y-1))),4&ze&&(R(te,ke,W.z,Fe,W.y),be&&(R(te,ie,W.z,W.x,W.y+1),R(te,ke,W.z,Fe,W.y+1))),8&ze&&(R(te,Ue,W.z,Ve,W.y),be&&(R(te,ie,W.z,W.x,W.y+1),R(te,Ue,W.z,Ve,W.y+1)))}}const V=[];for(const G of S)S.some(X=>G.isChildOf(X))||V.push(G);if(S=V.filter(G=>!o.some(X=>!!(G.overscaledZ<d&&X.isChildOf(G))||G.equals(X)||G.isChildOf(X))),k){const G=1<<d,X=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),W=[G*X.x,G*X.y],te=4,ie=te*te;S=S.filter(se=>{const ve=se.canonical.x+.5-W[0],ue=se.canonical.y+.5-W[1];return ve*ve+ue*ue<ie})}return S}extendTileCoverToNearPlane(o,d,m){const S=[],A=new Set;for(const be of o)A.add(be.key);const k=(be,Te,ke,Ue,Fe)=>{const Ve=i.cX(Te,be,ke,Ue,Fe);A.has(Ve)||(S.push(new i.aO(be,Te,ke,Ue,Fe)),A.add(Ve))},N=o.reduce((be,Te)=>Math.max(be,Te.overscaledZ),m),R=1<<m,V=[new i.P(0,0),new i.P(i.al,0),new i.P(i.al,i.al),new i.P(0,i.al)],G=new i.P(0,0),X=new i.P(0,0),W=(be,Te)=>{const ke=Math.floor(be[0]),Ue=Math.floor(be[1]),Fe=(be[0]-ke)*i.al,Ve=(be[1]-Ue)*i.al,ze=Math.floor(Te[0]),Oe=Math.floor(Te[1]),Ge=(Te[0]-ze)*i.al,Tt=(Te[1]-Oe)*i.al;for(let ut=-1;ut<=1;ut++){const jt=ke+ut;if(!(jt<0||jt>=R)){G.x=Fe-ut*i.al,X.x=Ge-(jt-ze)*i.al;for(let bt=-1;bt<=1;bt++){const Dt=Ue+bt;G.y=Ve-bt*i.al,X.y=Tt-(Dt-Oe)*i.al,i.cY(G,X,V)&&k(N,0,m,jt,Dt)}}}},te=d.points,ie=te[i.cu],se=te[i.cv],ve=this._projectToGround(ie,te[i.cw]),ue=this._projectToGround(se,te[i.cx]);return W(ie,ve),W(se,ue),S}_projectToGround(o,d){return i.cy(i.cz(),o,d,o[2]/(o[2]-d[2]))}coveringTiles(o){let d=this.coveringZoomLevel(o);const m=d,S=this.elevation&&this.elevation.exaggeration(),A=S&&!o.isTerrainDEM,k=this.projection.name==="mercator";if(o.minzoom!==void 0&&d<o.minzoom)return[];o.maxzoom!==void 0&&d>o.maxzoom&&(d=o.maxzoom);const N=this.locationCoordinate(this.center),R=this.center.lat,V=1<<d,G=[V*N.x,V*N.y,0],X=this.projection.name==="globe",W=!X,te=i.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d,W),ie=X?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),se=V*i.ce(1,this.center.lat),ve=this._camera.position[2]/i.ce(1,this.center.lat),ue=[V*ie.x,V*ie.y,ve*(W?1:se)],be=X||S,Te=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),ke=this.isLODDisabled(!0)?d:0;let Ue;if(this._elevation&&o.isTerrainDEM)Ue=1e4*this._elevation.exaggeration();else if(this._elevation){const it=this._elevation.getMinMaxForVisibleTiles();Ue=it?it.max:this._centerAltitude}else Ue=this._centerAltitude;const Fe=o.isTerrainDEM?-Ue:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ve=this.projection.isReprojectedInTileSpace?i.cB(this):1,ze=it=>{const Nt=new i.ae(it.x+25e-6,it.y,it.z),Qt=new i.ae(it.x,it.y+25e-6,it.z),mn=it.toLngLat(),Nn=Nt.toLngLat(),dn=Qt.toLngLat(),rn=this.locationCoordinate(mn),Qn=this.locationCoordinate(Nn),Kn=this.locationCoordinate(dn),Jn=Math.hypot(Qn.x-rn.x,Qn.y-rn.y),Zn=Math.hypot(Kn.x-rn.x,Kn.y-rn.y);return Math.sqrt(Jn*Zn)*Ve/25e-6},Oe=it=>{const Ut=Ue,Nt=Fe;return{aabb:i.cE(this,V,0,0,0,it,Nt,Ut,this.projection),zoom:0,x:0,y:0,minZ:Nt,maxZ:Ut,wrap:it,fullyVisible:!1}},Ge=[];let Tt=[];const ut=d,jt=o.reparseOverscaled?m:d,bt=(ve-this._centerAltitude)*se,Dt=it=>{if(!this._elevation||!it.tileID||!k)return;const Ut=this._elevation.getMinMaxForTile(it.tileID),Nt=it.aabb;Ut?(Nt.min[2]=Ut.min,Nt.max[2]=Ut.max,Nt.center[2]=(Nt.min[2]+Nt.max[2])/2):(it.shouldSplit=St(it),it.shouldSplit||(Nt.min[2]=Nt.max[2]=Nt.center[2]=this._centerAltitude))},gn=(it,Ut)=>{if(.707*Ut<it)return 1;const Nt=Ut/it;return Nt/(1.4144271570014144+(Math.pow(1.1,Nt-1.4144271570014144+1)-1)/(1.1-1)-1)},St=it=>{if(it.zoom<ke)return!0;if(it.zoom===ut)return!1;if(it.shouldSplit!=null)return it.shouldSplit;const Ut=it.aabb.distanceX(ue),Nt=it.aabb.distanceY(ue);let Qt=bt,mn=1;if(X){Qt=it.aabb.distanceZ(ue);const Zn=Math.pow(2,it.zoom),Er=i.a$((it.y+1)/Zn),Vr=i.a$(it.y/Zn),Wr=Math.min(Math.max(R,Er),Vr),Ki=i.d0(Wr)/i.d0(R);if(mn=Wr===R?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Ki/this._mercatorScaleRatio),this.zoom<=i.cZ&&it.zoom===ut-1&&Ki>=.9)return!0}else if(A&&(Qt=it.aabb.distanceZ(ue)*se),this.projection.isReprojectedInTileSpace&&m<=5){const Zn=Math.pow(2,it.zoom),Er=ze(new i.ae((it.x+.5)/Zn,(it.y+.5)/Zn));mn=Er>.85?1:Er}if(!k){const Zn=Math.sqrt(Ut*Ut+Nt*Nt+Qt*Qt);let Er=(1<<ut-it.zoom)*Te*mn;return Er*=gn(Math.max(Qt,bt),Zn),Zn<Er}let Nn=Number.MAX_VALUE,dn=0;const rn=it.aabb.getCorners(),Qn=[];for(const Zn of rn){i.av(Qn,Zn,ue),X||(A?Qn[2]*=se:Qn[2]=bt);const Er=i.bJ(Qn,this._camera.forward());Er<Nn&&(Nn=Er,dn=Math.abs(Qn[2]))}let Kn=(1<<ut-it.zoom)*Te*mn;if(Kn*=gn(Math.max(dn,bt),Nn),Nn<Kn)return!0;const Jn=it.aabb.closestPoint(G);return Jn[0]===G[0]&&Jn[1]===G[1]};if(this.renderWorldCopies)for(let it=1;it<=3;it++)Ge.push(Oe(-it)),Ge.push(Oe(it));for(Ge.push(Oe(0));Ge.length>0;){const it=Ge.pop(),Ut=it.x,Nt=it.y;let Qt=it.fullyVisible;const mn=()=>this.projection.name==="globe"&&(it.y===0||it.y===(1<<it.zoom)-1);if(!Qt){let Nn=be?it.aabb.intersects(te):it.aabb.intersectsFlat(te);if(Nn===0&&mn()){const dn=new i.cC(it.zoom,Ut,Nt);Nn=i.cD(this,V,dn,!0).intersects(te)}if(Nn===0)continue;Qt=Nn===2}if(it.zoom!==ut&&St(it))for(let Nn=0;Nn<4;Nn++){const dn=(Ut<<1)+Nn%2,rn=(Nt<<1)+(Nn>>1),Qn={aabb:k?it.aabb.quadrant(Nn):i.cE(this,V,it.zoom+1,dn,rn,it.wrap,it.minZ,it.maxZ,this.projection),zoom:it.zoom+1,x:dn,y:rn,wrap:it.wrap,fullyVisible:Qt,tileID:void 0,shouldSplit:void 0,minZ:it.minZ,maxZ:it.maxZ};A&&!X&&(Qn.tileID=new i.aO(it.zoom+1===ut?jt:it.zoom+1,it.wrap,it.zoom+1,dn,rn),Dt(Qn)),Ge.push(Qn)}else{const Nn=it.zoom===ut?jt:it.zoom;if(o.minzoom&&o.minzoom>Nn)continue;let dn=0;if(!Qt){let Jn=be?it.aabb.intersectsPrecise(te):it.aabb.intersectsPreciseFlat(te);if(Jn===0&&mn()){const Zn=new i.cC(it.zoom,Ut,Nt);Jn=i.cD(this,V,Zn,!0).intersectsPrecise(te)}if(Jn===0)continue;if(o.calculateQuadrantVisibility)if(te.containsPoint(it.aabb.center))dn=15;else for(let Zn=0;Zn<4;Zn++)it.aabb.quadrant(Zn).intersects(te)!==0&&(dn|=1<<Zn)}const rn=G[0]-(.5+Ut+(it.wrap<<it.zoom))*(1<<d-it.zoom),Qn=G[1]-.5-Nt,Kn=it.tileID?it.tileID:new i.aO(Nn,it.wrap,it.zoom,Ut,Nt);o.calculateQuadrantVisibility&&(Kn.visibleQuadrants=dn),Tt.push({tileID:Kn,distanceSq:rn*rn+Qn*Qn})}}if(this.fogCullDistSq){const it=this.fogCullDistSq,Ut=this.horizonLineFromTop();Tt=Tt.filter(Nt=>{const Qt=[0,0,0,1],mn=[i.al,i.al,0,1],Nn=this.calculateFogTileMatrix(Nt.tileID.toUnwrapped());i.aC(Qt,Qt,Nn),i.aC(mn,mn,Nn);const dn=i.cF([],Qt,mn),rn=i.cG([],Qt,mn),Qn=i.c_(dn,rn);if(Qn===0)return!0;let Kn=!1;const Jn=this._elevation;if(Jn&&Qn>it&&Ut!==0){const Zn=this.calculateProjMatrix(Nt.tileID.toUnwrapped());let Er;o.isTerrainDEM||(Er=Jn.getMinMaxForTile(Nt.tileID)),Er||(Er={min:Fe,max:Ue});const Vr=i.cH(this.rotation),Wr=[Vr[0]*i.al,Vr[1]*i.al,Er.max];i.af(Wr,Wr,Zn),Kn=(1-Wr[1])*this.height*.5<Ut}return Qn<it||Kn})}return Tt.sort((it,Ut)=>it.distanceSq-Ut.distanceSq).map(it=>it.tileID)}resize(o,d){this.width=o,this.height=d,this.pixelsToGLUnits=[2/o,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log2(o)}project(o){const d=i.aA(o.lat,-i.cI,i.cI),m=this.projection.project(o.lng,d);return new i.P(m.x*this.worldSize,m.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.ce(1,this.center.lat)/this.worldSize}setLocationAtPoint(o,d){let m,S;const A=this.centerPoint;if(this.projection.name==="globe"){const N=this.worldSize;m=(d.x-A.x)/N,S=(d.y-A.y)/N}else{const N=this.pointCoordinate(d),R=this.pointCoordinate(A);m=N.x-R.x,S=N.y-R.y}const k=this.locationCoordinate(o);this.setLocation(new i.ae(k.x-m,k.y-S))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o,d){return this.projection.locationPoint(this,o,d)}locationPoint3D(o,d){return this.projection.locationPoint(this,o,d,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o,d){return this.coordinateLocation(this.pointCoordinate3D(o,d))}locationCoordinate(o,d){const m=d?i.ce(d,o.lat):void 0,S=this.projection.project(o.lng,o.lat);return new i.ae(S.x,S.y,m)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,d){const m=d??this._centerAltitude,S=[o.x,o.y,0,1],A=[o.x,o.y,1,1];i.aC(S,S,this.pixelMatrixInverse),i.aC(A,A,this.pixelMatrixInverse);const k=A[3];i.cJ(S,S,1/S[3]),i.cJ(A,A,1/k);const N=S[2],R=A[2];return{p0:S,p1:A,t:N===R?0:(m-N)/(R-N)}}screenPointToMercatorRay(o){const d=[o.x,o.y,0,1],m=[o.x,o.y,1,1];return i.aC(d,d,this.pixelMatrixInverse),i.aC(m,m,this.pixelMatrixInverse),i.cJ(d,d,1/d[3]),i.cJ(m,m,1/m[3]),d[2]=i.ce(d[2],this._center.lat)*this.worldSize,m[2]=i.ce(m[2],this._center.lat)*this.worldSize,i.cJ(d,d,1/this.worldSize),i.cJ(m,m,1/this.worldSize),new i.ax([d[0],d[1],d[2]],i.aw([],i.av([],m,d)))}rayIntersectionCoordinate(o){const{p0:d,p1:m,t:S}=o,A=i.ce(d[2],this._center.lat),k=i.ce(m[2],this._center.lat);return new i.ae(i.ak(d[0],m[0],S)/this.worldSize,i.ak(d[1],m[1],S)/this.worldSize,i.ak(A,k,S))}pointCoordinate(o,d=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,d)}pointCoordinate3D(o,d){if(!this.elevation)return this.pointCoordinate(o,d);let m=this.projection.pointCoordinate3D(this,o.x,o.y);if(m)return new i.ae(m[0],m[1],m[2]);let S=0,A=this.horizonLineFromTop();if(o.y>A)return this.pointCoordinate(o,d);const k=.02*A,N=o.clone();for(let R=0;R<10&&A-S>k;R++){N.y=i.ak(S,A,.66);const V=this.projection.pointCoordinate3D(this,N.x,N.y);V?(A=N.y,m=V):S=N.y}return m?new i.ae(m[0],m[1],m[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}isPointOnSurface(o){if(o.y<0||o.y>this.height||o.x<0||o.x>this.width)return!1;if(this.elevation||this.zoom>=i.cK)return!this.isPointAboveHorizon(o);const d=this.pointCoordinate(o);return d.y>=0&&d.y<=1}_coordinatePoint(o,d){const m=d&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,S=[o.x*this.worldSize,o.y*this.worldSize,m+o.toAltitude(),1];return i.aC(S,S,this.pixelMatrix),S[3]>0?new i.P(S[0]/S[3],S[1]/S[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:o,left:d}=this._edgeInsets,m=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,A=this.pointLocation3D(new i.P(d,o)),k=this.pointLocation3D(new i.P(S,o)),N=this.pointLocation3D(new i.P(S,m)),R=this.pointLocation3D(new i.P(d,m));let V=Math.min(A.lng,k.lng,N.lng,R.lng),G=Math.max(A.lng,k.lng,N.lng,R.lng),X=Math.min(A.lat,k.lat,N.lat,R.lat),W=Math.max(A.lat,k.lat,N.lat,R.lat);const te=Math.pow(2,-this.zoom)/16*270,ie=this.projection.name==="globe"?1:4,se=(ve,ue,be,Te,ke)=>{const Ue=(ve+be)/2,Fe=(ue+Te)/2,Ve=new i.P(Ue,Fe),{lng:ze,lat:Oe}=this.pointLocation3D(Ve),Ge=Math.max(0,V-ze,X-Oe,ze-G,Oe-W);V=Math.min(V,ze),G=Math.max(G,ze),X=Math.min(X,Oe),W=Math.max(W,Oe),(ke<ie||Ge>te)&&(se(ve,ue,Ue,Fe,ke+1),se(Ue,Fe,be,Te,ke+1))};if(se(d,o,S,o,1),se(S,o,S,m,1),se(S,m,d,m,1),se(d,m,d,o,1),this.projection.name==="globe"){const[ve,ue]=i.cL(this);ve?(W=90,G=180,V=-180):ue&&(X=-90,G=180,V=-180)}return new i.aI(new i.aR(V,X),new i.aR(G,W))}_getBoundsRectangular(o,d){const{top:m,left:S}=this._edgeInsets,A=this.height-this._edgeInsets.bottom,k=this.width-this._edgeInsets.right,N=new i.P(S,m),R=new i.P(k,m),V=new i.P(k,A),G=new i.P(S,A);let X=this.pointCoordinate(N,o),W=this.pointCoordinate(R,o);const te=this.pointCoordinate(V,d),ie=this.pointCoordinate(G,d),se=(ve,ue)=>(ue.y-ve.y)/(ue.x-ve.x);return X.y>1&&W.y>=0?X=new i.ae((1-ie.y)/se(ie,X)+ie.x,1):X.y<0&&W.y<=1&&(X=new i.ae(-ie.y/se(ie,X)+ie.x,0)),W.y>1&&X.y>=0?W=new i.ae((1-te.y)/se(te,W)+te.x,1):W.y<0&&X.y<=1&&(W=new i.ae(-te.y/se(te,W)+te.x,0)),new i.aI().extend(this.coordinateLocation(X)).extend(this.coordinateLocation(W)).extend(this.coordinateLocation(ie)).extend(this.coordinateLocation(te))}_getBoundsRectangularTerrain(){const o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBoundsRectangular(0,0);const d=o.visibleDemTiles.reduce((m,S)=>{if(S.dem){const A=S.dem.tree;m.min=Math.min(m.min,A.minimums[0]),m.max=Math.max(m.max,A.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(d.min*o.exaggeration(),d.max*o.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(o=!0){const d=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,m=this.height/2-d*(1-this._horizonShift);return o?Math.max(0,m):m}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-i.cI,this.maxLat=i.cI,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.aF(this.minLng)*this.tileSize,this.worldMaxX=i.aF(this.maxLng)*this.tileSize,this.worldMinY=i.aJ(this.maxLat)*this.tileSize,this.worldMaxY=i.aJ(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,d){return this.projection.createTileMatrix(this,d,o)}calculateDistanceTileData(o){const d=o.key,m=this._distanceTileDataCache;if(m[d])return m[d];const S=o.canonical,A=1/this.height,k=this.cameraWorldSize,N=k/this.zoomScale(S.z),R=(S.x+Math.pow(2,S.z)*o.wrap)*N,V=S.y*N,G=this.point;G.x*=k/this.worldSize,G.y*=k/this.worldSize;const X=this.angle,W=Math.sin(-X),te=-Math.cos(-X);return m[d]={bearing:[W,te],center:[(G.x-R)*A,(G.y-V)*A],scale:N/i.al*A},m[d]}calculateFogTileMatrix(o){const d=o.key,m=this._fogTileMatrixCache;if(m[d])return m[d];const S=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,o);return i.aB(S,this.worldToFogMatrix,S),m[d]=new Float32Array(S),m[d]}calculateProjMatrix(o,d=!1,m=!1){const S=o.key;let A;if(A=m?this._expandedProjMatrixCache:d?this._alignedProjMatrixCache:this._projMatrixCache,A[S])return A[S];const k=this.calculatePosMatrix(o,this.worldSize);let N;return N=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.expandedFarZProjMatrix:d?this.alignedProjMatrix:this.projMatrix,i.aB(k,N,k),A[S]=new Float32Array(k),A[S]}calculatePixelsToTileUnitsMatrix(o){const d=o.tileID.key,m=this._pixelsToTileUnitsCache;if(m[d])return m[d];const S=i.cM(o,this);return m[d]=S,m[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const o=1/this.worldSize,d=i.bq([],[o,o,o]);return i.aB(d,d,this.globeMatrix),d}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const o=this._elevation;this._updateCameraState();const d=i.ce(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(d),S=this._camera.forward(),A=i.ce(1,this._center.lat);m[2]/=A,S[2]/=A,i.aw(S,S);const k=o.raycast(m,S,o.exaggeration());if(k){const N=i.bH([],m,S,k),R=new i.ae(N[0],N[1],i.ce(N[2],i.a$(N[1]))),V=(R.z+i.ag([R.x-m[0],R.y-m[1],R.z-m[2]*A]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(V),this._centerAltitude=R.toAltitude(),this._center=this.coordinateLocation(R),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(o=!1){if(!this._elevation)return;const d=this._elevation,m=i.ce(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(m),A=d.getAtPointOrZero(new i.ae(...S)),k=this.pixelsPerMeter/this.worldSize*A,N=this._minimumHeightOverTerrain(),R=S[2]-k;if(R<=N)if(R<0||o){const V=this.locationCoordinate(this._center,this._centerAltitude),G=[S[0],S[1],V.z-S[2]],X=i.ag(G);G[2]-=(N-R)/this._pixelsPerMercatorPixel;const W=i.ag(G);if(W===0)return;i.c4(G,G,X/W*this._pixelsPerMercatorPixel),this._camera.position=[S[0],S[1],V.z*this._pixelsPerMercatorPixel-G[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const W=this.center;return W.lat=i.aA(W.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(W.lng=i.aA(W.lng,this.minLng,this.maxLng)),this.center=W,void(this._constraining=!1)}const d=this._unmodified,{x:m,y:S}=this.point;let A=0,k=m,N=S;const R=this.width/2,V=this.height/2,G=this.worldMinY*this.scale,X=this.worldMaxY*this.scale;if(S-V<G&&(N=G+V),S+V>X&&(N=X-V),X-G<this.height&&(A=Math.max(A,this.height/(X-G)),N=(X+G)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const W=this.worldMinX*this.scale,te=this.worldMaxX*this.scale,ie=this.worldSize/2-(W+te)/2;k=(m+ie+this.worldSize)%this.worldSize-ie,k-R<W&&(k=W+R),k+R>te&&(k=te-R),te-W<this.width&&(A=Math.max(A,this.width/(te-W)),k=(te+W)/2)}k===m&&N===S||this._allowWorldUnderZoom||(this.center=this.unproject(new i.P(k,N))),A&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(A)),this._constrainCamera(),this._unmodified=d,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(Math.max(0,this.height)/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,d=this.projection.name==="globe",m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.ce(1,this.center.lat)/i.ce(1,i.d1));const S=i.cN(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,S),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const A=this.projection.zAxisUnit==="meters"?m:1,k=this._camera.getWorldToCamera(this.worldSize,A);let N;const R=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(R[8]=2*-o.x/this.width,R[9]=2*o.y/this.height,this.isOrthographic){let Oe=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Ge=Oe*this.aspect,Tt=-Ge,ut=-Oe;Ge-=o.x,Tt-=o.x,Oe+=o.y,ut+=o.y,N=this._camera.getCameraToClipOrthographic(Tt,Ge,ut,Oe,this._nearZ,this._farZ),((jt,bt,Dt,gn)=>{for(let St=0;St<16;St++)jt[St]=i.ak(bt[St],Dt[St],gn)})(N,N,R,i.c$(this.pitch>=Mc?1:this.pitch/Mc))}else N=R;const V=i.cO([],R,k);let G=i.cO([],N,k);if(this.projection.isReprojectedInTileSpace){const Oe=this.locationCoordinate(this.center),Ge=i.bA([]);i.br(Ge,Ge,[Oe.x*this.worldSize,Oe.y*this.worldSize,0]),i.aB(Ge,Ge,i.cP(this)),i.br(Ge,Ge,[-Oe.x*this.worldSize,-Oe.y*this.worldSize,0]),i.aB(G,G,Ge),i.aB(V,V,Ge),this.inverseAdjustmentMatrix=i.cQ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.cR([],G,[this.worldSize,this.worldSize,this.worldSize/A,1]),this.projMatrix=G,this.invProjMatrix=i.bl(new Float64Array(16),this.projMatrix),d){const Oe=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Oe[8]=2*-o.x/this.width,Oe[9]=2*o.y/this.height,this.expandedFarZProjMatrix=i.cO([],Oe,k)}else this.expandedFarZProjMatrix=this.projMatrix;const X=i.bl([],N);this.frustumCorners=i.cS.fromInvProjectionMatrix(X,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!d);const W=new Float32Array(16);i.bA(W),i.cR(W,W,[1,-1,1]),i.cT(W,W,this._pitch),i.bB(W,W,this.angle);const te=i.cc(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.bz(te);const ie=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;te[8]=2*-o.x/this.width,te[9]=2*(o.y+ie)/this.height,this.skyboxMatrix=i.aB(W,te,W);const se=this.point,ve=se.x,ue=se.y,be=this.width%2/2,Te=this.height%2/2,ke=Math.cos(this.angle),Ue=Math.sin(this.angle),Fe=ve-Math.round(ve)+ke*be+Ue*Te,Ve=ue-Math.round(ue)+ke*Te+Ue*be,ze=new Float64Array(G);if(i.br(ze,ze,[Fe>.5?Fe-1:Fe,Ve>.5?Ve-1:Ve,0]),this.alignedProjMatrix=ze,G=i.bC(),i.cR(G,G,[this.width/2,-this.height/2,1]),i.br(G,G,[1,-1,0]),this.labelPlaneMatrix=G,G=i.bC(),i.cR(G,G,[1,-1,1]),i.br(G,G,[-1,-1,0]),i.cR(G,G,[2/this.width,2/this.height,1]),this.glCoordMatrix=G,this.pixelMatrix=i.aB(new Float64Array(16),this.labelPlaneMatrix,V),this._calcFogMatrices(),this._distanceTileDataCache={},G=i.bl(new Float64Array(16),this.pixelMatrix),!G)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=G,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.cU(this);const Oe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.af(Oe,Oe,k),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=G;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSizeForFog,d=this.cameraPixelsPerMeter,m=this._camera.position,S=1/this.height/this._pixelsPerMercatorPixel,A=[o,o,d];i.c4(A,A,S),i.c4(m,m,-1),i.cV(m,m,A);const k=i.bC();i.br(k,k,m),i.cR(k,k,A),this.mercatorFogMatrix=k,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,d,S)}_computeCameraPosition(o){const d=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,m=this._camera.forward(),S=this.point,A=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*d-o/this.worldSize*this._centerAltitude;return[S.x/this.worldSize-m[0]*A,S.y/this.worldSize-m[1]*A,o/this.worldSize*this._centerAltitude-m[2]*A]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const d=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=this._camera.position[2],S=o[2];let A=1;this.projection.wrap&&(this.center=this.center.wrap()),S>0&&(A=Math.min((d-m)/S,1)),this._camera.position=i.bH([],this._camera.position,o,A),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,d=this._camera.forward(),{pitch:m,bearing:S}=this._camera.getPitchBearing(),A=i.ce(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,k=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.an(this._maxPitch)),N=Math.max((o[2]-A)/Math.cos(m),k),R=this._zoomFromMercatorZ(N);i.bH(o,o,d,N),this._pitch=i.aA(m,i.an(this.minPitch),i.an(this.maxPitch)),this.angle=i.bT(S,-Math.PI,Math.PI),this._setZoom(i.aA(R,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.ae(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(Math.max(0,o)*this.tileSize))}zoomFromMercatorZAdjusted(o){let d=0,m=i.cK,S=0,A=1/0;for(;m-d>1e-6&&m>d;){const k=d+.5*(m-d),N=this.tileSize*Math.pow(2,k),R=this.getCameraToCenterDistance(this.projection,k,N),V=this.scaleZoom(R/(Math.max(0,o)*this.tileSize)),G=Math.abs(k-V);G<A&&(A=G,S=k),k<V?d=k:m=k}return S}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,d){const m=Math.min(o.x,d.x),S=Math.max(o.x,d.x),A=Math.min(o.y,d.y),k=Math.max(o.y,d.y);if(A<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const N=[new i.P(m,A),new i.P(S,k),new i.P(m,k),new i.P(S,A)],R=this.renderWorldCopies?-3:0,V=this.renderWorldCopies?4:1;for(const G of N){const X=this.pointRayIntersection(G);if(X.t<0)return!0;const W=this.rayIntersectionCoordinate(X);if(W.x<R||W.y<0||W.x>V||W.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.cW(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(o,d){const m=i.ag(i.av([],this._camera.position,o)),S=this._zoomFromMercatorZ(m)+d;return m-this._mercatorZfromZoom(S)}getCameraPoint(){if(this.projection.name==="globe"){const o=function([d,m,S],A){const k=[d,m,S,1];i.aC(k,k,A);const N=k[3]=Math.max(k[3],1e-6);return k[0]/=N,k[1]/=N,k[2]/=N,k}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,o))}}getCameraToCenterDistance(o,d=this.zoom,m=this.worldSize){const S=i.cN(o,d,this.width,this.height,1024),A=o.pixelSpaceConversion(this.center.lat,m,S);let k=.5/Math.tan(.5*this._fov)*this.height*A;return this.isOrthographic&&(k=i.ak(1,k,i.c$(this.pitch>=Mc?1:this.pitch/Mc))),k}getWorldToCameraMatrix(){const o=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.aB(o,o,this.globeMatrix),o}getFrustum(o){return i.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,o,this.projection.zAxisUnit==="meters")}}const fa=(g,o)=>{if(o>0&&g.terrain&&i.w("Cutoff is currently disabled on terrain"),o<=0||g.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const d=g.transform,m=Math.max(Math.abs(d._zoom-(g.minCutoffZoom-1)),1),S=d.isLODDisabled(!1)?i.ah(60,45,d.pitch):i.ah(30,15,d.pitch),A=d._farZ-d._nearZ,k=o*d.height,N=((1-(R=S))*d.cameraToCenterDistance+R*(d._farZ+k))*m;var R;return{shouldRenderCutoff:S<1,uniformValues:{u_cutoff_params:[d._nearZ,d._farZ,(N-d._nearZ)/A,(N-k-d._nearZ)/A]}}},to={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Ou{constructor(o,d){this.aabb=o,this.lastCascade=d}}class fc{add(o,d){const m=this.receivers[o.key];m!==void 0?(m.aabb.min[0]=Math.min(m.aabb.min[0],d.min[0]),m.aabb.min[1]=Math.min(m.aabb.min[1],d.min[1]),m.aabb.min[2]=Math.min(m.aabb.min[2],d.min[2]),m.aabb.max[0]=Math.max(m.aabb.max[0],d.max[0]),m.aabb.max[1]=Math.max(m.aabb.max[1],d.max[1]),m.aabb.max[2]=Math.max(m.aabb.max[2],d.max[2])):this.receivers[o.key]=new Ou(d,null)}clear(){this.receivers={}}get(o){return this.receivers[o.key]}computeRequiredCascades(o,d,m){const S=i.d8.fromPoints(o.points);let A=0;for(const k in this.receivers){const N=this.receivers[k];if(!N||!S.intersectsAabb(N.aabb))continue;N.aabb.min=S.closestPoint(N.aabb.min),N.aabb.max=S.closestPoint(N.aabb.max);const R=N.aabb.getCorners();for(let V=0;V<m.length;V++){let G=!0;for(const X of R){const W=[X[0]*d,X[1]*d,X[2]];if(i.af(W,W,m[V].matrix),W[0]<-1||W[0]>1||W[1]<-1||W[1]>1){G=!1;break}}if(N.lastCascade=V,A=Math.max(A,V),G)break}}return A+1}}class rg{constructor(o){this.painter=o,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new fc,this._depthMode=new Ln(o.context.gl.LEQUAL,Ln.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,o.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),o.tp.registerParameter(to,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),o.tp.registerParameter(to,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),o.tp.registerParameter(to,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),o.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const o of this._cascades)o.texture.destroy(),o.framebuffer.destroy();this._cascades=[]}updateShadowParameters(o,d){const m=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!d||!d.properties)return;const S=d.properties.get("shadow-intensity");if(!d.shadowsEnabled()||S<=0||(this._shadowLayerCount=m.style.order.reduce((ie,se)=>{const ve=m.style._mergedLayers[se];return ie+(ve.hasShadowPass()&&!ve.isHidden(o.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const A=m.context,k=to.shadowMapResolution,N=to.shadowMapResolution;if(this._cascades.length===0||to.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ie=0;ie<to.cascadeCount;++ie){const se=m._shadowMapDebug,ve=A.gl,ue=A.createFramebuffer(k,N,se,"texture"),be=new i.T(A,{width:k,height:N,data:null},ve.DEPTH_COMPONENT16);if(ue.depthAttachment.set(be.texture),se){const Te=new i.T(A,{width:k,height:N,data:null},ve.RGBA8);ue.colorAttachment.set(Te.texture)}this._cascades.push({framebuffer:ue,texture:be,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.cA,scale:0})}}this.shadowDirection=wd(d);let R=0;if(o.elevation){const ie=o.elevation,se=[1e4,-1e4];ie.visibleDemTiles.filter(ve=>ve.dem).forEach(ve=>{const ue=ve.dem.tree;se[0]=Math.min(se[0],ue.minimums[0]),se[1]=Math.max(se[1],ue.maximums[0])}),se[0]!==1e4&&(R=(se[1]-se[0])*ie.exaggeration())}const V=1.5*o.cameraToCenterDistance,G=3*V,X=new Float64Array(16);for(let ie=0;ie<this._cascades.length;++ie){const se=this._cascades[ie];let ve=o.height/50,ue=1;to.cascadeCount===1?ue=G:ie===0?ue=V:(ve=V,ue=G);const[be,Te]=$h(o,this.shadowDirection,ve,ue,to.shadowMapResolution,R);se.scale=o.scale,se.matrix=be,se.boundingSphereRadius=Te,i.bl(X,se.matrix),se.frustum=i.cA.fromInvProjectionMatrix(X,1,0,!0),se.far=ue}const W=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[W].far,this._cascades[W].far],this._uniformValues.u_shadow_intensity=S,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/to.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=to.shadowMapResolution,this._uniformValues.u_shadowmap_0=Ms.ShadowMap0,this._uniformValues.u_shadowmap_1=Ms.ShadowMap0+1,this._groundShadowTiles=m.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const te=m.transform.elevation;for(const ie of this._groundShadowTiles){let se={min:0,max:0};if(te){const ve=te.getMinMaxForTile(ie);ve&&(se=ve)}this.addShadowReceiver(ie.toUnwrapped(),se.min,se.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(o){this._enabled=o}drawShadowPass(o,d){if(!this.enabled)return;const m=this.painter,S=m.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(m.transform.getFrustum(0),m.transform.worldSize,this._cascades),S.viewport.set([0,0,to.shadowMapResolution,to.shadowMapResolution]);for(let A=0;A<this._numCascadesToRender;++A){m.currentShadowCascade=A,S.bindFramebuffer.set(this._cascades[A].framebuffer.framebuffer),S.clear({color:i.ao.white,depth:1});for(const k of o.order){const N=o._mergedLayers[k];if(!N.hasShadowPass()||N.isHidden(m.transform.zoom))continue;const R=o.getLayerSourceCache(N),V=R?d[R.id]:void 0;(N.type==="model"||V&&V.length)&&m.renderLayer(m,R,N,V)}}m.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const o=this.painter,d=o.style,m=o.context,S=m.gl,A=d.directionalLight,k=d.ambientLight;if(!A||!k)return;const N=[],R=fa(o,o.longestCutoffRange);R.shouldRenderCutoff&&N.push("RENDER_CUTOFF"),N.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&N.push("NORMAL_OFFSET");const V=Gl(d,A,k),G=new Ln(S.LEQUAL,Ln.ReadOnly,o.depthRangeFor3D),X=new sr({func:S.EQUAL,mask:255},0,255,S.KEEP,S.KEEP,S.KEEP);for(const W of this._groundShadowTiles){const te=W.toUnwrapped(),ie=o.isTileAffectedByFog(W),se=o.getOrCreateProgram("groundShadow",{defines:N,overrideFog:ie});this.setupShadows(te,se),o.uploadCommonUniforms(m,se,te,null,R);const ve={u_matrix:o.transform.calculateProjMatrix(te),u_ground_shadow_factor:V};se.draw(o,S.TRIANGLES,G,X,kr.multiply,hr.disabled,ve,"ground_shadow",o.tileExtentBuffer,o.quadTriangleIndexBuffer,o.tileExtentSegments,null,o.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?kr.unblended:kr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(o){const d=this.painter.transform,m=d.calculatePosMatrix(o,d.worldSize);return i.aB(m,this._cascades[this.painter.currentShadowCascade].matrix,m),Float32Array.from(m)}calculateShadowPassMatrixFromMatrix(o){return i.aB(o,this._cascades[this.painter.currentShadowCascade].matrix,o),Float32Array.from(o)}setupShadows(o,d,m){if(!this.enabled)return;const S=this.painter.transform,A=this.painter.context,k=A.gl,N=this._uniformValues,R=new Float64Array(16),V=S.calculatePosMatrix(o,S.worldSize);for(let G=0;G<this._cascades.length;G++)i.aB(R,this._cascades[G].matrix,V),N[G===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(R),A.activeTexture.set(k.TEXTURE0+Ms.ShadowMap0+G),this._cascades[G].texture.bindExtraParam(k.LINEAR,k.LINEAR,k.CLAMP_TO_EDGE,k.CLAMP_TO_EDGE,k.GREATER);if(this.useNormalOffset=!!m,this.useNormalOffset){const G=i.d6(o.canonical),X=2/S.tileSize*i.al/to.shadowMapResolution,W=X*this._cascades[0].boundingSphereRadius,te=X*this._cascades[this._cascades.length-1].boundingSphereRadius,ie=(m==="vector-tile"?1:3)*function(se,ve,ue,be,Te){const ke=i.aA((se-22)/-22,0,1);return .125*(1-ke)+4*ke}(S.zoom);N.u_shadow_normal_offset=[G,W*ie,te*ie],N.u_shadow_bias=[1e-4,.0012,.012]}else N.u_shadow_bias=[36e-5,.0012,.012];d.setShadowUniformValues(A,N)}setupShadowsFromMatrix(o,d,m=!1){if(!this.enabled)return;const S=this.painter.context,A=S.gl,k=this._uniformValues,N=new Float64Array(16);for(let R=0;R<to.cascadeCount;R++)i.aB(N,this._cascades[R].matrix,o),k[R===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(N),S.activeTexture.set(A.TEXTURE0+Ms.ShadowMap0+R),this._cascades[R].texture.bindExtraParam(A.LINEAR,A.LINEAR,A.CLAMP_TO_EDGE,A.CLAMP_TO_EDGE,A.GREATER);if(this.useNormalOffset=m,m){const R=to.normalOffset;k.u_shadow_normal_offset=[1,R,R],k.u_shadow_bias=[6e-5,.0012,.012]}else k.u_shadow_bias=[36e-5,.0012,.012];d.setShadowUniformValues(S,k)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(o,d,m,S){if(S[2]>=0)return{};const A=function(R,V,G){const X=G/(1<<R.canonical.z);return new i.d8([R.canonical.x*X+R.wrap*G,R.canonical.y*X+R.wrap*G,0],[(R.canonical.x+1)*X+R.wrap*G,(R.canonical.y+1)*X+R.wrap*G,V])}(o,d,m).getCorners(),k=d/-S[2];S[0]<0?(i.d7(A[0],A[0],[S[0]*k,0,0]),i.d7(A[3],A[3],[S[0]*k,0,0])):S[0]>0&&(i.d7(A[1],A[1],[S[0]*k,0,0]),i.d7(A[2],A[2],[S[0]*k,0,0])),S[1]<0?(i.d7(A[0],A[0],[0,S[1]*k,0]),i.d7(A[1],A[1],[0,S[1]*k,0])):S[1]>0&&(i.d7(A[2],A[2],[0,S[1]*k,0]),i.d7(A[3],A[3],[0,S[1]*k,0]));const N={};return N.vertices=A,N.planes=[Vh(A[1],A[0],A[4]),Vh(A[2],A[1],A[5]),Vh(A[3],A[2],A[6]),Vh(A[0],A[3],A[7])],N}addShadowReceiver(o,d,m){this._receivers.add(o,i.d8.fromTileIdAndHeight(o,d,m))}getMaxCascadeForTile(o){const d=this._receivers.get(o);return d&&d.lastCascade?d.lastCascade:0}}function Vh(g,o,d){const m=i.av([],d,o),S=i.av([],g,o),A=i.bI([],m,S),k=i.ag(A);return k===0?[0,0,1,0]:(i.c4(A,A,1/k),[A[0],A[1],A[2],-i.bJ(A,o)])}function wd(g){const o=g.properties.get("direction"),d=i.d3(o.x,o.y,o.z);d[2]=i.aA(d[2],0,75);const m=i.d5([d[0],d[1],d[2]]);return i.d4(m.x,m.y,m.z)}function Gl(g,o,d){const m=o.properties.get("color-use-theme")==="none",S=o.properties.get("color"),A=o.properties.get("intensity"),k=o.properties.get("direction"),N=[k.x,k.y,k.z],R=d.properties.get("color-use-theme")==="none",V=d.properties.get("color"),G=d.properties.get("intensity"),X=Math.max(i.bJ([0,0,1],N),0),W=[0,0,0];i.c4(W,V.toPremultipliedRenderColor(R?null:g.getLut(o.scope)).toArray01Linear().slice(0,3),G);const te=[0,0,0];return i.c4(te,S.toPremultipliedRenderColor(m?null:g.getLut(d.scope)).toArray01Linear().slice(0,3),X*A),i.da([W[0]>0?W[0]/(W[0]+te[0]):0,W[1]>0?W[1]/(W[1]+te[1]):0,W[2]>0?W[2]/(W[2]+te[2]):0])}function $h(g,o,d,m,S,A){const k=g.zoom,N=g.scale,R=g.worldSize,V=1/R,G=g.aspect,X=Math.sqrt(1+G*G)*Math.tan(.5*g.fovX),W=X*X,te=m-d,ie=m+d;let se,ve;W>te/ie?(se=m,ve=m*X):(se=.5*ie*(1+W),ve=.5*Math.sqrt(te*te+2*(m*m+d*d)*W+ie*ie*W*W));const ue=g.projection.pixelsPerMeter(g.center.lat,R),be=g._camera.getCameraToWorldMercator(),Te=[0,0,-se*V];i.af(Te,Te,be);let ke=ve*V;const Ue=g._edgeInsets;if(!(Ue.left===0&&Ue.top===0&&Ue.right===0&&Ue.bottom===0||Ue.left===Ue.right&&Ue.top===Ue.bottom)){const Qt=g._camera.getWorldToCamera(g.worldSize,g.projection.zAxisUnit==="meters"?ue:1),mn=g._camera.getCameraToClipPerspective(g._fov,g.width/g.height,d,m);mn[8]=2*-g.centerOffset.x/g.width,mn[9]=2*g.centerOffset.y/g.height;const Nn=new Float64Array(16);i.cO(Nn,mn,Qt);const dn=new Float64Array(16);i.bl(dn,Nn);const rn=i.cA.fromInvProjectionMatrix(dn,R,k,!0);for(const Qn of rn.points){const Kn=((Fe=Qn)[0]/=N,Fe[1]/=N,Fe[2]=i.ce(Fe[2],g._center.lat),Fe);ke=Math.max(ke,i.c5(i.d9([],Te,Kn)))}}var Fe;ke*=S/(S-1);const Ve=Math.acos(o[2]),ze=Math.atan2(-o[0],-o[1]),Oe=new ju;Oe.position=Te,Oe.setPitchBearing(Ve,ze);const Ge=Oe.getWorldToCamera(R,ue),Tt=ke*R,ut=Math.min(g._mercatorZfromZoom(17)*R*-2,-2*Tt),jt=Oe.getCameraToClipOrthographic(-Tt,Tt,-Tt,Tt,ut,(Tt+A*ue)/o[2]),bt=new Float64Array(16);i.aB(bt,jt,Ge);const Dt=i.d4(Math.floor(1e6*Te[0])/1e6*R,Math.floor(1e6*Te[1])/1e6*R,0),gn=.5*S,St=[0,0,0];i.af(St,Dt,bt),i.c4(St,St,gn);const it=[Math.floor(St[0]),Math.floor(St[1]),Math.floor(St[2])],Ut=[0,0,0];i.av(Ut,St,it),i.c4(Ut,Ut,-1/gn);const Nt=new Float64Array(16);return i.bA(Nt),i.br(Nt,Nt,Ut),i.aB(bt,Nt,bt),[bt,Tt]}class Lc extends i.E{constructor(o){super(),this.requestManager=o,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(o,d){return i.aV(this.requestManager.transformRequest(d,i.R.Model).url).then(m=>{if(!m)return;const S=i.aW(m),A=new i.aX(o,void 0,void 0,S);return A.computeBoundsAndApplyParent(),A}).catch(m=>{if(m&&m.status===404)return null;this.fire(new i.y(new Error(`Could not load model ${o} from ${d}: ${m.message}`)))})}load(o,d,m={forceReload:!1}){this.models[d]||(this.models[d]={});const S=Object.keys(o),A=[],k=[];for(const N of S){const R=o[N];this.hasURLBeenRequested(R)&&!m.forceReload||(this.modelByURL[R]={modelId:N,scope:d},A.push(this.loadModel(N,R)),k.push(N)),this.models[d][N]||(this.models[d][N]={model:null,numReferences:1})}this.numModelsLoading[d]=(this.numModelsLoading[d]||0)+k.length,Promise.allSettled(A).then(N=>{for(let R=0;R<N.length;R++){const{status:V}=N[R];if(V==="rejected")continue;const{value:G}=N[R];this.models[d][k[R]]||(this.models[d][k[R]]={model:null,numReferences:1}),this.models[d][k[R]].model=G}this.numModelsLoading[d]-=k.length,this.fire(new i.z("data",{dataType:"style"}))}).catch(N=>{this.fire(new i.y(new Error(`Could not load models: ${N.message}`)))})}isLoaded(){for(const o in this.numModelsLoading)if(this.numModelsLoading[o]>0)return!1;return!0}hasModel(o,d,m={exactIdMatch:!1}){return!!(m.exactIdMatch?this.getModel(o,d):this.getModelByURL(this.modelUris[d][o]))}getModel(o,d){return this.models[d]||(this.models[d]={}),this.models[d][o]?this.models[d][o].model:void 0}getModelByURL(o){if(!o)return null;const d=this.modelByURL[o];return d?this.models[d.scope][d.modelId].model:null}hasModelBeenAdded(o,d){return this.models[d]&&this.models[d][o]!==void 0}getModelURIs(o){return this.modelUris[o]||{}}addModel(o,d,m){this.models[m]||(this.models[m]={}),this.modelUris[m]||(this.modelUris[m]={});const S=this.requestManager.normalizeModelURL(d);if((this.hasModel(o,m,{exactIdMatch:!0})||this.hasModelBeenAdded(o,m))&&this.modelUris[m][o]===S)this.models[m][o].numReferences++;else if(this.hasURLBeenRequested(S)){const{scope:A,modelId:k}=this.modelByURL[S];this.models[A][k].numReferences++}else this.modelUris[m][o]=S,this.load({[o]:this.modelUris[m][o]},m)}addModelURLs(o,d){this.models[d]||(this.models[d]={}),this.modelUris[d]||(this.modelUris[d]={});const m=this.modelUris[d];for(const S in o)m[S]=this.requestManager.normalizeModelURL(o[S])}reloadModels(o){this.load(this.modelUris[o],o,{forceReload:!0})}addModelsFromBucket(o,d){this.models[d]||(this.models[d]={}),this.modelUris[d]||(this.modelUris[d]={});const m={};for(const S of o)this.hasModel(S,d,{exactIdMatch:!0})||this.hasURLBeenRequested(S)?this.models[d][S].numReferences++:this.modelUris[d][S]&&!this.hasURLBeenRequested(S)?m[S]=this.modelUris[d][S]:!this.hasURLBeenRequested(S)&&i.db(S,!1)&&(this.modelUris[d][S]=this.requestManager.normalizeModelURL(S),m[S]=this.modelUris[d][S]);this.load(m,d)}hasURLBeenRequested(o){return this.modelByURL[o]!==void 0}removeModel(o,d,m=!1,S=!1){if(this.models[d]&&this.models[d][o]&&(this.models[d][o].numReferences--,this.models[d][o].numReferences===0||S)){const A=this.modelUris[d][o];m||delete this.modelUris[d][o],delete this.modelByURL[A];const k=this.models[d][o].model;if(!k)return;delete this.models[d][o],k.destroy()}}destroy(){for(const o of Object.keys(this.models))for(const d of Object.keys(this.models[o])){const m=this.models[o][d].model;delete this.models[o][d],m&&m.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(o){return this.models[o]||(this.models[o]={}),Object.keys(this.models[o])}upload(o,d){this.models[d]||(this.models[d]={});for(const m in this.models[d])this.models[d][m].model&&this.models[d][m].model.upload(o.context)}}const th=new i.a9({data:new i.aa(i.a6.colorTheme.data)});function Sd(g){if(!g.metadata||!g.metadata.content_area)return;const o=i.o.devicePixelRatio,{left:d,top:m,width:S,height:A}=g.metadata.content_area,k=d*o,N=m*o;return[k,N,k+S*o,N+A*o]}function Fu(g){if(g)return g.map(([o,d])=>[o*i.o.devicePixelRatio,d*i.o.devicePixelRatio])}class pc{constructor(o,d,m){this.id=o,this.scope=d,this.sourceCache=m,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(o){this.missingRequests.has(o.name)||this.pendingRequests.has(o.name)||this.pendingRequests.add(o.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const o=new Map;if(!this.sourceCache.loaded())return o;const d=this.sourceCache.getVisibleCoordinates();if(d.length===0)return o;const m=this.sourceCache.getSource();if(!(m instanceof ku))return o;const S=d.map(k=>this.sourceCache.getTile(k)),A=m.getImages(S,Array.from(this.pendingRequests));for(const[k,N]of A)o.set(i.I.from({name:k,iconsetId:this.id}),N),this.pendingRequests.delete(k);for(const k of this.pendingRequests)this.missingRequests.add(k);return this.pendingRequests.clear(),o}}const Jo=(g,o)=>We(g,o&&o.filter(d=>d.identifier!=="source.canvas")),Ad=i.aH(mi,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),ia=i.aH(mi,["setCenter","setZoom","setBearing","setPitch"]),sa=new Set(["background","sky","slot","custom"]),no={version:8,layers:[],sources:{}},ro={duration:300,delay:0};class ko extends i.E{constructor(o,d={}){super(),this.map=o,this.scope=d.scope||"",this.globalId=null,this.fragments=[],this.importDepth=d.importDepth||0,this.importsCache=d.importsCache||new Map,this.resolvedImports=d.resolvedImports||new Set,this.transition=Object.assign({},ro),this._buildingIndex=new jp(this),this.crossTileSymbolIndex=new Ca,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=d.styleChanges||new Un,this.dispatcher=d.dispatcher?d.dispatcher:new i.D(i.dd(),this),d.imageManager?this.imageManager=d.imageManager:(this.imageManager=new st(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=d.glyphManager?d.glyphManager:new i.de(o._requestManager,d.localFontFamily?i.df.all:d.localIdeographFontFamily?i.df.ideographs:i.df.none,d.localFontFamily||d.localIdeographFontFamily),d.modelManager?this.modelManager=d.modelManager:(this.modelManager=new Lc(o._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=d.configOptions?d.configOptions:new Map,this._configDependentLayers=d.configDependentLayers?d.configDependentLayers:new Set,this._config=d.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:d.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=d.initialConfig,this.dispatcher.broadcast("setReferrer",i.dg());const m=this;this._rtlTextPluginCallback=ko.registerForPluginStateChange(S=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},(A,k)=>{if(i.dh(A),k&&k.every(N=>N))for(const N in m._sourceCaches){const R=m._sourceCaches[N],V=R.getSource().type;V!=="vector"&&V!=="geojson"||R.reload()}})}),this.on("data",S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;const A=this.getOwnSource(S.sourceId);if(A&&A.vectorLayerIds)for(const k in this._layers){const N=this._layers[k];N.source===A.id&&this._validateLayer(N)}})}load(o){return o?(typeof o=="string"?this.loadURL(o):this.loadJSON(o),this):this}_getGlobalId(o){if(!o)return null;if(typeof o=="string"){if(i.h(o))return o;const d=i.di(o);if(!d.startsWith("http"))try{return new URL(d,location.href).toString()}catch{return d}return d}return`json://${i.dj(JSON.stringify(o))}`}_diffStyle(o,d,m){this.globalId=this._getGlobalId(o);const S=(A,k)=>{try{k(null,this.setState(A,m))}catch(N){k(N,!1)}};if(typeof o=="string"){const A=this.map._requestManager.normalizeStyleURL(o),k=this.map._requestManager.transformRequest(A,i.R.Style);i.m(k,(N,R)=>{N?this.fire(new i.y(N)):R&&S(R,d)})}else typeof o=="object"&&S(o,d)}loadURL(o,d={}){this.fire(new i.z("dataloading",{dataType:"style"}));const m=typeof d.validate=="boolean"?d.validate:!i.h(o);this.globalId=this._getGlobalId(o),o=this.map._requestManager.normalizeStyleURL(o,d.accessToken),this.resolvedImports.add(o);const S=this.importsCache.get(o);if(S)return this._load(S,m);const A=this.map._requestManager.transformRequest(o,i.R.Style);this._request=i.m(A,(k,N)=>{if(this._request=null,k)this.fire(new i.y(k));else if(N)return this.importsCache.set(o,N),this._load(N,m)})}loadJSON(o,d={}){this.fire(new i.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(o),this._request=i.o.frame(()=>{this._request=null,this._load(o,d.validate!==!1)})}loadEmpty(){this.fire(new i.z("dataloading",{dataType:"style"})),this._load(no,!1)}_loadImports(o,d,m){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const S=[];for(const A of o){const k=this._createFragmentStyle(A),N=new Promise(G=>{k.once("style.import.load",G),k.once("error",G)}).then(()=>this.mergeAll());if(S.push(N),this.resolvedImports.has(A.url)){k.loadEmpty();continue}const R=A.data||this.importsCache.get(A.url);R?(k.loadJSON(R,{validate:d}),this._isInternalStyle(R)&&(k.globalId=null)):A.url?k.loadURL(A.url,{validate:d}):k.loadEmpty();const V={style:k,id:A.id,config:A.config};if(m){const G=this.fragments.findIndex(({id:X})=>X===m);this.fragments=this.fragments.slice(0,G).concat(V).concat(this.fragments.slice(G))}else this.fragments.push(V)}return Promise.allSettled(S)}getImportGlobalIds(o=this,d=new Set){for(const m of o.fragments)m.style.globalId&&d.add(m.style.globalId),this.getImportGlobalIds(m.style,d);return[...d.values()]}_createFragmentStyle(o){const d=this.scope?i.B(o.id,this.scope):o.id;let m;const S=this._initialConfig&&this._initialConfig[d];(o.config||S)&&(m=Object.assign({},o.config,S));const A=new ko(this.map,{scope:d,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:m,configOptions:this.options,colorThemeOverride:o["color-theme"],configDependentLayers:this._configDependentLayers});return A.setEventedParent(this.map,{style:A}),A}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(o){return this.isRootStyle()&&(o.fragment||!!o.schema&&o.fragment!==!1)}_load(o,d){if(this._isInternalStyle(o)){const A=Object.assign({},no,{imports:[{id:"basemap",data:o,url:""}]});return void this._load(A,d)}if(this.updateConfig(this._config,o.schema),d&&Jo(this,ts(o)))return;this._loaded=!0,this.stylesheet=i.dk(o);const m=()=>{for(const R in o.sources)this.addSource(R,o.sources[R],{validate:!1,isInitialLoad:!0});if(o.iconsets)for(const R in o.iconsets)this.addIconset(R,o.iconsets[R]);o.sprite?this._loadIconset(o.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),!this.glyphManager.url&&o.glyphs&&this.glyphManager.setURL(o.glyphs);const A=Op(this.stylesheet.layers);if(this._order=A.map(R=>R.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const R=this.stylesheet.lights[0];this.light=new ot(R.properties,R.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new ot(this.stylesheet.light)),this._layers={};for(const R of A){const V=i.dq(R,this.scope,this._styleColorTheme.lut,this.options);V.configDependencies.size!==0&&this._configDependentLayers.add(V.fqid),V.setEventedParent(this,{layer:{id:V.id}}),this._layers[V.id]=V;const G=this.getOwnLayerSourceCache(V),X=!!this.directionalLight&&this.directionalLight.shadowsEnabled();G&&V.canCastShadows()&&X&&(G.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const k=this.stylesheet.terrain;k&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(k,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.z("data",{dataType:"style"}));const N=this.isRootStyle();o.imports?this._loadImports(o.imports,d).then(()=>{this._reloadImports(),this.fire(new i.z(N?"style.load":"style.import.load"))}).catch(R=>{this.fire(new i.y(new Error("Failed to load imports",R))),this.fire(new i.z(N?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.z(N?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const S=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(S){const A=this._evaluateColorThemeData(S);this._loadColorTheme(A).then(()=>{m()}).catch(k=>{i.w(`Couldn't load color theme from the stylesheet: ${k}`),m()})}else this._styleColorTheme.lut=null,m()}isRootStyle(){return this.importDepth===0}mergeAll(){let o,d,m,S,A,k,N,R,V,G;const X={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(W=>{if(W.stylesheet){if(W.light!=null&&(o=W.light),W.stylesheet.lights)for(const te of W.stylesheet.lights)te.type==="ambient"&&W.ambientLight!=null&&(d=W.ambientLight),te.type==="directional"&&W.directionalLight!=null&&(m=W.directionalLight);S=this._prioritizeTerrain(S,W.terrain,W.stylesheet.terrain),W.stylesheet.fog&&W.fog!=null&&(A=W.fog),W.stylesheet.snow&&W.snow!=null&&(k=W.snow),W.stylesheet.rain&&W.rain!=null&&(N=W.rain),W.stylesheet.camera!=null&&(G=W.stylesheet.camera),W.stylesheet.projection!=null&&(R=W.stylesheet.projection),W.stylesheet.transition!=null&&(V=W.stylesheet.transition),X[W.scope]=W._styleColorTheme}}),this.light=o,this.ambientLight=d,this.directionalLight=m,this.fog=A,this.snow=k,this.rain=N,this._styleColorThemeForScope=X,S===null?delete this.terrain:this.terrain=S,this.camera=G||{"camera-projection":"perspective"},this.projection=R||{name:"mercator"},this.transition=Object.assign({},ro,V),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(o){const d=m=>{for(const S of m.fragments)d(S.style);o(m)};d(this)}_prioritizeTerrain(o,d,m){const S=o&&o.drapeRenderMode===0;return m===null?d&&d.drapeRenderMode===0?d:S?o:null:d!=null&&(!o||S||d&&d.drapeRenderMode===1)?d:o}mergeTerrain(){let o;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(d=>{o=this._prioritizeTerrain(o,d.terrain,d.stylesheet.terrain)}),o===null?delete this.terrain:this.terrain=o}mergeProjection(){let o;this.forEachFragmentStyle(d=>{d.stylesheet.projection!=null&&(o=d.stylesheet.projection)}),this.projection=o||{name:"mercator"}}mergeSources(){const o={},d={},m={};this.forEachFragmentStyle(S=>{for(const A in S._sourceCaches){const k=i.B(A,S.scope);o[k]=S._sourceCaches[A]}for(const A in S._otherSourceCaches){const k=i.B(A,S.scope);d[k]=S._otherSourceCaches[A]}for(const A in S._symbolSourceCaches){const k=i.B(A,S.scope);m[k]=S._symbolSourceCaches[A]}}),this._mergedSourceCaches=o,this._mergedOtherSourceCaches=d,this._mergedSymbolSourceCaches=m}mergeLayers(){const o={},d=[],m={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(k=>{for(const N of k._order){const R=k._layers[N];if(R.type==="slot"){const V=i.dl(N);if(o[V])continue;o[V]=[]}R.slot&&o[R.slot]?o[R.slot].push(R):d.push(R)}}),this._mergedOrder=[];let S=-1;const A=(k=[])=>{for(const N of k)if(N.type==="slot"){const R=i.dl(N.id);o[R]&&A(o[R]),this._mergedSlots.push(R)}else{const R=i.B(N.id,N.scope);this._mergedOrder.push(R),m[R]=N,N.is3D(!!this.terrain)&&(this._has3DLayers=!0,S=this._mergedOrder.length-1),N.type==="circle"&&(this._hasCircleLayers=!0),N.type==="symbol"&&(this._hasSymbolLayers=!0),N.type==="clip"&&(this._clipLayerPresent=!0)}};if(A(d),this._has3DLayers){const k={};for(let N=0;N<this._mergedOrder.length;++N){const R=this._mergedOrder[N];k[R]=N===S?1:N<S?m[R].hasOcclusionOpacityProperties?2:0:4}this._mergedOrder.sort((N,R)=>k[N]-k[R])}this._mergedLayers=m,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(o){return this.stylesheet.camera=Object.assign({},this.stylesheet.camera,o),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(o){return o.data?function(d,m,S,A){const k=Object.assign({},m);for(const R of Object.keys(i.a6.colorTheme))k[R]===void 0&&(k[R]=i.a6.colorTheme[R].default);const N=new i.a8(th,d,new Map(S));return N.setTransitionOrValue(k,S),N.untransitioned().possiblyEvaluate(new i.ac(0,{worldview:void 0}))}(this.scope,o,this.options).get("data"):null}_loadColorTheme(o){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const d=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((m,S)=>{const A="data:image/png;base64,";if(!o||o.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void m();let k=o;k.startsWith(A)||(k=A+k);const N=i.I.from("mapbox-reserved-lut"),R=new Image;R.src=k,R.onerror=()=>{this._styleColorTheme.lutLoading=!1,S(new Error("Failed to load image data"))},R.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==d)return void m();this._styleColorTheme.lutLoading=!1;const{width:V,height:G,data:X}=i.o.getImageData(R);if(G>32)return void S(new Error("The height of the image must be less than or equal to 32 pixels."));if(V!==G*G)return void S(new Error("The width of the image must be equal to the height squared."));this.getImage(N)&&this.removeImage(N),this.addImage(N,{data:new i.q({width:V,height:G},X),pixelRatio:1,sdf:!1,usvg:!1,version:0});const W=this.imageManager.getImage(N,this.scope);W?(this._styleColorTheme.lut={image:W.data,data:o},m()):S(new Error("Missing LUT image."))}})}getLut(o){const d=this._styleColorThemeForScope[o];return d?d.lut:null}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(o){this._spriteRequest=function(d,m,S){let A,k,N;const R=i.o.devicePixelRatio>1?"@2x":"";let V=i.m(m.transformRequest(m.normalizeSpriteURL(d,R,".json"),i.R.SpriteJSON),(W,te)=>{V=null,N||(N=W,A=te,X())}),G=i.n(m.transformRequest(m.normalizeSpriteURL(d,R,".png"),i.R.SpriteImage),(W,te)=>{G=null,N||(N=W,k=te,X())});function X(){if(N)S(N);else if(A&&k){const W=i.o.getImageData(k),te={};for(const ie in A){const{width:se,height:ve,x:ue,y:be,sdf:Te,pixelRatio:ke,stretchX:Ue,stretchY:Fe,content:Ve}=A[ie],ze=new i.q({width:se,height:ve});i.q.copy(W,ze,{x:ue,y:be},{x:0,y:0},{width:se,height:ve},null),te[ie]={data:ze,pixelRatio:ke!==void 0?ke:1,sdf:Te!==void 0&&Te,stretchX:Ue,stretchY:Fe,content:Ve,usvg:!1,version:0}}S(null,te)}}return{cancel(){V&&(V.cancel(),V=null),G&&(G.cancel(),G=null)}}}(o,this.map._requestManager,(d,m)=>{if(this._spriteRequest=null,d)this.fire(new i.y(d));else if(m){const S=new Map;for(const A in m)S.set(i.I.from(A),m[A]);this.addImages(S)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))})}addIconset(o,d){if(d.type==="sprite")return void this._loadSprite(d.url);const m=this.getOwnSourceCache(d.source);if(!m)return void this.fire(new i.y(new Error(`Source "${d.source}" as specified by iconset "${o}" does not exist and cannot be used as an iconset source`)));const S=m.getSource();if(S.type!=="raster-array")return void this.fire(new i.y(new Error(`Source "${d.source}" as specified by iconset "${o}" is not a "raster-array" source and cannot be used as an iconset source`)));S.partial=!1;const A=new pc(o,this.scope,m);this.imageManager.addImageProvider(A,this.scope)}removeIconset(o){this.imageManager.removeImageProvider(o,this.scope)}_loadIconset(o){if(!i.h(o)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(o);const d=this.map._spriteFormat==="auto";var m,S;this._spriteRequest=(S=(A,k)=>{if(this._spriteRequest=null,A)d?this._loadSprite(o):this.fire(new i.y(A));else if(k){const N=new Map;for(const R in k)N.set(i.I.from(R),k[R]);this.addImages(N)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))},i.bu((m=this.map._requestManager).transformRequest(m.normalizeIconsetURL(o),i.R.Iconset),(A,k)=>{if(A)return void S(A);const N={},R=i.dc(new i.bt(k));for(const V of R.icons){const G={version:1,pixelRatio:i.o.devicePixelRatio,content:Sd(V),stretchX:V.metadata?Fu(V.metadata.stretch_x_areas):void 0,stretchY:V.metadata?Fu(V.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:V};N[V.name]=G}S(null,N)}))}_validateLayer(o){const d=this.getOwnSource(o.source);if(!d)return;const m=o.sourceLayer;m&&(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(m)===-1)&&this.fire(new i.y(new Error(`Source layer "${m}" does not exist on source "${d.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:o}of this.fragments)if(!o.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((o,d)=>{const m=this.fragments[d];return m&&m.style&&(o.data=m.style.serialize()),o})}_serializeSources(){const o={};for(const d in this._sourceCaches){const m=this._sourceCaches[d].getSource();o[m.id]||(o[m.id]=m.serialize())}return o}_serializeLayers(o){const d=[];for(const m of o){const S=this._layers[m];S&&S.type!=="custom"&&d.push(S.serialize())}return d}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(o){return o?this.order:this._mergedOrder}isLayerDraped(o){return!!this.terrain&&o.isDraped(this.getLayerSourceCache(o))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(o){const d=this.getOwnLayer(o);if(d)return d;this.fire(new i.y(new Error(`The layer '${o}' does not exist in the map's style.`)))}_checkSource(o){const d=this.getOwnSource(o);if(d)return d;this.fire(new i.y(new Error(`The source '${o}' does not exist in the map's style.`)))}precompilePrograms(o,d){const m=this.map.painter;if(m)for(let S=o.minzoom||0;S<(o.maxzoom||25.5);S++){const A=o.getProgramIds();if(A)for(const k of A){const N=o.getDefaultProgramParams(k,d.zoom,this._styleColorTheme.lut);N&&(m.style=this,this.fog&&(m._fogVisible=!0,N.overrideFog=!0,m.getOrCreateProgram(k,N)),m._fogVisible=!1,N.overrideFog=!1,m.getOrCreateProgram(k,N),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(N.overrideRtt=!0,m.getOrCreateProgram(k,N)))}}}update(o){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(o),this.directionalLight&&this.directionalLight.recalculate(o);const d=this.calculateLightsBrightness();o.brightness=d||0,d!==this._brightness&&(this._brightness=d,this.dispatcher.broadcast("setBrightness",d)),o.worldview!==this._worldview&&(this._worldview=o.worldview,this.dispatcher.broadcast("setWorldview",this._worldview));const m=this._changes.isDirty();let S=!1;if(this._changes.isDirty()){const N=this._changes.getLayerUpdatesByScope();for(const R in N){const{updatedIds:V,removedIds:G}=N[R];(V||G)&&(this._updateWorkerLayers(R,V,G),S=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(o),this.light&&this.light.updateTransitions(o),this.ambientLight&&this.ambientLight.updateTransitions(o),this.directionalLight&&this.directionalLight.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this.snow&&this.snow.updateTransitions(o),this.rain&&this.rain.updateTransitions(o),this._changes.reset()}const A={};for(const N in this._mergedSourceCaches){const R=this._mergedSourceCaches[N];A[N]=R.used,R.used=!1,R.tileCoverLift=0}for(const N of this._mergedOrder){const R=this._mergedLayers[N];if(R.recalculate(o,this._availableImages),!R.isHidden(o.zoom)){const V=this.getLayerSourceCache(R);V&&(V.used=!0,V.tileCoverLift=Math.max(V.tileCoverLift,R.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(R,o)}):this.precompilePrograms(R,o))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&S&&this.mergeLayers();const k=this.imageManager.getPendingImageProviders();for(const N of k)N.sourceCache.used=!0;for(const N in A){const R=this._mergedSourceCaches[N];A[N]!==R.used&&R.getSource().fire(new i.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:R.getSource().id}))}this.light&&this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.snow&&this.snow.recalculate(o),this.rain&&this.rain.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),m&&this.fire(new i.z("data",{dataType:"style"}))}updateImageProviders(){const o=this.imageManager.getPendingImageProviders();for(const d of o){const m=d.resolvePendingRequests(),S=this.getFragmentStyle(d.scope);S&&S.addImages(m)}}_updateTilesForChangedImages(){const o={};for(const d in this._mergedSourceCaches){const m=this._mergedSourceCaches[d].getSource().scope;o[m]=o[m]||this._changes.getUpdatedImages(m),o[m].length!==0&&this._mergedSourceCaches[d].reloadTilesForDependencies(["icons","patterns"],o[m])}for(const d in o)this._changes.resetUpdatedImages(d)}_updateWorkerLayers(o,d,m){const S=this.getFragmentStyle(o);S&&this.dispatcher.broadcast("updateLayers",{layers:d?S._serializeLayers(d):[],scope:o,removedIds:m||[],options:S.options})}setState(o,d){if(this._checkLoaded(),Jo(this,ts(o)))return!1;(o=i.dk(o)).layers=Op(o.layers);const m=function(k,N){if(!k)return[{command:mi.setStyle,args:[N]}];let R=[];try{if(!i.by(k.version,N.version))return[{command:mi.setStyle,args:[N]}];if(i.by(k.center,N.center)||R.push({command:mi.setCenter,args:[N.center]}),i.by(k.zoom,N.zoom)||R.push({command:mi.setZoom,args:[N.zoom]}),i.by(k.bearing,N.bearing)||R.push({command:mi.setBearing,args:[N.bearing]}),i.by(k.pitch,N.pitch)||R.push({command:mi.setPitch,args:[N.pitch]}),i.by(k.sprite,N.sprite)||R.push({command:mi.setSprite,args:[N.sprite]}),i.by(k.glyphs,N.glyphs)||R.push({command:mi.setGlyphs,args:[N.glyphs]}),i.by(k.imports,N.imports)||function(te=[],ie=[],se){ie=ie||[];const ve=(te=te||[]).map(tu),ue=ie.map(tu),be=te.reduce(pd,{}),Te=ie.reduce(pd,{}),ke=ve.slice();let Ue,Fe,Ve,ze;for(Ue=0,Fe=0;Ue<ve.length;Ue++)Ve=ve[Ue],Te.hasOwnProperty(Ve)?Fe++:(se.push({command:mi.removeImport,args:[Ve]}),ke.splice(ke.indexOf(Ve,Fe),1));for(Ue=0,Fe=0;Ue<ue.length;Ue++)Ve=ue[ue.length-1-Ue],ke[ke.length-1-Ue]!==Ve&&(be.hasOwnProperty(Ve)?(se.push({command:mi.removeImport,args:[Ve]}),ke.splice(ke.lastIndexOf(Ve,ke.length-Fe),1)):Fe++,ze=ke[ke.length-Ue],se.push({command:mi.addImport,args:[Te[Ve],ze]}),ke.splice(ke.length-Ue,0,Ve));for(const Oe of ie){const Ge=be[Oe.id];Ge&&(delete Ge.data,i.by(Ge,Oe)||se.push({command:mi.updateImport,args:[Oe.id,Oe]}))}}(k.imports,N.imports,R),i.by(k.transition,N.transition)||R.push({command:mi.setTransition,args:[N.transition]}),i.by(k.light,N.light)||R.push({command:mi.setLight,args:[N.light]}),i.by(k.fog,N.fog)||R.push({command:mi.setFog,args:[N.fog]}),i.by(k.snow,N.snow)||R.push({command:mi.setSnow,args:[N.snow]}),i.by(k.rain,N.rain)||R.push({command:mi.setRain,args:[N.rain]}),i.by(k.projection,N.projection)||R.push({command:mi.setProjection,args:[N.projection]}),i.by(k.lights,N.lights)||R.push({command:mi.setLights,args:[N.lights]}),i.by(k.camera,N.camera)||R.push({command:mi.setCamera,args:[N.camera]}),i.by(k.iconsets,N.iconsets)||function(te,ie,se){let ve;for(ve in ie=ie||{},te=te||{})te.hasOwnProperty(ve)&&(ie.hasOwnProperty(ve)||se.push({command:mi.removeIconset,args:[ve]}));for(ve in ie){if(!ie.hasOwnProperty(ve))continue;const ue=ie[ve];te.hasOwnProperty(ve)?i.by(te[ve],ue)||(se.push({command:mi.removeIconset,args:[ve]}),se.push({command:mi.addIconset,args:[ve,ue]})):se.push({command:mi.addIconset,args:[ve,ue]})}}(k.iconsets,N.iconsets,R),!i.by(k["color-theme"],N["color-theme"]))return[{command:mi.setStyle,args:[N]}];const V={},G=[];(function(te,ie,se,ve){let ue;for(ue in ie=ie||{},te=te||{})te.hasOwnProperty(ue)&&(ie.hasOwnProperty(ue)||Cy(ue,se,ve));for(ue in ie){if(!ie.hasOwnProperty(ue))continue;const be=ie[ue];te.hasOwnProperty(ue)?i.by(te[ue],be)||(te[ue].type==="geojson"&&be.type==="geojson"&&Xd(te,ie,ue)?se.push({command:mi.setGeoJSONSourceData,args:[ue,be.data]}):Ey(ue,ie,se,ve)):uc(ue,ie,se)}})(k.sources,N.sources,G,V);const X=[];k.layers&&k.layers.forEach(te=>{te.source&&V[te.source]?R.push({command:mi.removeLayer,args:[te.id]}):X.push(te)});let W=k.terrain;W&&V[W.source]&&(R.push({command:mi.setTerrain,args:[void 0]}),W=void 0),R=R.concat(G),i.by(W,N.terrain)||R.push({command:mi.setTerrain,args:[N.terrain]}),function(te,ie,se){ie=ie||[];const ve=(te=te||[]).map(tu),ue=ie.map(tu),be=te.reduce(pd,{}),Te=ie.reduce(pd,{}),ke=ve.slice(),Ue=Object.create(null);let Fe,Ve,ze,Oe,Ge,Tt,ut;for(Fe=0,Ve=0;Fe<ve.length;Fe++)ze=ve[Fe],Te.hasOwnProperty(ze)?Ve++:(se.push({command:mi.removeLayer,args:[ze]}),ke.splice(ke.indexOf(ze,Ve),1));for(Fe=0,Ve=0;Fe<ue.length;Fe++)ze=ue[ue.length-1-Fe],ke[ke.length-1-Fe]!==ze&&(be.hasOwnProperty(ze)?(se.push({command:mi.removeLayer,args:[ze]}),ke.splice(ke.lastIndexOf(ze,ke.length-Ve),1)):Ve++,Tt=ke[ke.length-Fe],se.push({command:mi.addLayer,args:[Te[ze],Tt]}),ke.splice(ke.length-Fe,0,ze),Ue[ze]=!0);for(Fe=0;Fe<ue.length;Fe++)if(ze=ue[Fe],Oe=be[ze],Ge=Te[ze],!Ue[ze]&&!i.by(Oe,Ge))if(i.by(Oe.source,Ge.source)&&i.by(Oe["source-layer"],Ge["source-layer"])&&i.by(Oe.type,Ge.type)){for(ut in eu(Oe.layout,Ge.layout,se,ze,null,mi.setLayoutProperty),eu(Oe.paint,Ge.paint,se,ze,null,mi.setPaintProperty),i.by(Oe.slot,Ge.slot)||se.push({command:mi.setSlot,args:[ze,Ge.slot]}),i.by(Oe.filter,Ge.filter)||se.push({command:mi.setFilter,args:[ze,Ge.filter]}),i.by(Oe.minzoom,Ge.minzoom)&&i.by(Oe.maxzoom,Ge.maxzoom)||se.push({command:mi.setLayerZoomRange,args:[ze,Ge.minzoom,Ge.maxzoom]}),Oe)Oe.hasOwnProperty(ut)&&ut!=="layout"&&ut!=="paint"&&ut!=="filter"&&ut!=="metadata"&&ut!=="minzoom"&&ut!=="maxzoom"&&ut!=="slot"&&(ut.indexOf("paint.")===0?eu(Oe[ut],Ge[ut],se,ze,ut.slice(6),mi.setPaintProperty):i.by(Oe[ut],Ge[ut])||se.push({command:mi.setLayerProperty,args:[ze,ut,Ge[ut]]}));for(ut in Ge)Ge.hasOwnProperty(ut)&&!Oe.hasOwnProperty(ut)&&ut!=="layout"&&ut!=="paint"&&ut!=="filter"&&ut!=="metadata"&&ut!=="minzoom"&&ut!=="maxzoom"&&ut!=="slot"&&(ut.indexOf("paint.")===0?eu(Oe[ut],Ge[ut],se,ze,ut.slice(6),mi.setPaintProperty):i.by(Oe[ut],Ge[ut])||se.push({command:mi.setLayerProperty,args:[ze,ut,Ge[ut]]}))}else se.push({command:mi.removeLayer,args:[ze]}),Tt=ke[ke.lastIndexOf(ze)+1],se.push({command:mi.addLayer,args:[Ge,Tt]})}(X,N.layers,R)}catch(V){console.warn("Unable to compute style diff:",V),R=[{command:mi.setStyle,args:[N]}]}return R}(this.serialize(),o).filter(k=>!(k.command in ia));if(m.length===0)return!1;const S=m.filter(k=>!(k.command in Ad));if(S.length>0)throw new Error(`Unimplemented: ${S.map(k=>k.command).join(", ")}.`);const A=[];return m.forEach(k=>{A.push(this[k.command](...k.args))}),d&&Promise.all(A).then(d).catch(d),this.stylesheet=o,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(o){if(o.size===0)return this;for(const[d,m]of o.entries()){if(this.getImage(d))return this.fire(new i.y(new Error(`An image with the name "${d.name}" already exists.`)));this.imageManager.addImage(d,this.scope,m),this._changes.updateImage(d,this.scope)}return this._updateWorkerImages(),this.fire(new i.z("data",{dataType:"style"})),this}addImage(o,d){return this.getImage(o)?this.fire(new i.y(new Error(`An image with the name "${o.name}" already exists.`))):(this.imageManager.addImage(o,this.scope,d),this._changes.updateImage(o,this.scope),this._updateWorkerImages(),this.fire(new i.z("data",{dataType:"style"})),this)}updateImage(o,d,m=!1){this.imageManager.updateImage(o,this.scope,d),m&&(this._changes.updateImage(o,this.scope),this._updateWorkerImages(),this.fire(new i.z("data",{dataType:"style"})))}getImage(o){return this.imageManager.getImage(o,this.scope)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o,this.scope),this._changes.updateImage(o,this.scope),this._updateWorkerImages(),this.fire(new i.z("data",{dataType:"style"})),this):this.fire(new i.y(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(o){return this.modelManager.addModelURLs(o,this.scope),this._updateWorkerModels(),this.fire(new i.z("data",{dataType:"style"})),this}addModel(o,d,m={}){return this._checkLoaded(),this._validate(Xe,`models.${o}`,d,null,m)||(this.modelManager.addModel(o,d,this.scope),this.fire(new i.z("data",{dataType:"style"}))),this}hasModel(o){return this.modelManager.hasModel(o,this.scope)}removeModel(o){return this.hasModel(o)?(this.modelManager.removeModel(o,this.scope,!1,!0),this.fire(new i.z("data",{dataType:"style"})),this):this.fire(new i.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(o,d,m={}){if(this._checkLoaded(),this.getOwnSource(o)!==void 0)throw new Error(`There is already a source with ID "${o}".`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(_i,`sources.${o}`,d,null,m))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const S=Iu(o,d,this.dispatcher,this);S.scope=this.scope,S.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(S.id),source:S.serialize(),sourceId:S.id}));const A=k=>{const N=(k?"symbol:":"other:")+S.id,R=i.B(N,this.scope),V=this._sourceCaches[N]=new qo(R,S,k);(k?this._symbolSourceCaches:this._otherSourceCaches)[S.id]=V,V.onAdd(this.map)};A(!1),d.type!=="vector"&&d.type!=="geojson"||A(!0),S.onAdd&&S.onAdd(this.map),m.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(o){this._checkLoaded();const d=this.getOwnSource(o);if(!d)throw new Error("There is no source with this ID");for(const S in this._layers)if(this._layers[S].source===o)return this.fire(new i.y(new Error(`Source "${o}" cannot be removed while layer "${S}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===o)return this.fire(new i.y(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const S=Object.entries(this.stylesheet.iconsets).find(([A,k])=>k.type==="source"&&k.source===o);if(S)return this.fire(new i.y(new Error(`Source "${o}" cannot be removed while iconset "${S[0]}" is using it.`)))}const m=this.getOwnSourceCaches(o);for(const S of m){const A=i.dl(S.id);delete this._sourceCaches[A],this._changes.discardSourceCacheUpdate(S.id),S.fire(new i.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:S.getSource().id})),S.setEventedParent(null),S.clearTiles()}return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],this.mergeSources(),d.setEventedParent(null),d.onRemove&&d.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(o,d){this._checkLoaded(),this.getOwnSource(o).setData(d),this._changes.setDirty()}getOwnSource(o){const d=this.getOwnSourceCache(o);return d&&d.getSource()}getOwnSources(){const o=[];for(const d in this._otherSourceCaches){const m=this.getOwnSourceCache(d);m&&o.push(m.getSource())}return o}areTilesLoaded(){const o=this._mergedSourceCaches;for(const d in o){const m=o[d]._tiles;for(const S in m){const A=m[S];if(A.state!=="loaded"&&A.state!=="errored")return!1}}return!0}setLights(o){if(this._checkLoaded(),!o)return delete this.ambientLight,void delete this.directionalLight;const d=this._getTransitionParameters();for(const A of o){if(this._validate(Pi,"lights",A))return;switch(A.type){case"ambient":if(this.ambientLight){const k=this.ambientLight;k.set(A),k.updateTransitions(d)}else this.ambientLight=new bi(A,Js||(Js=new i.a9({color:new i.aa(i.a6.properties_light_ambient.color),"color-use-theme":new i.aa({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.aa(i.a6.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const k=this.directionalLight;k.set(A),k.updateTransitions(d)}else this.directionalLight=new bi(A,ha||(ha=new i.a9({direction:new i.ap(i.a6.properties_light_directional.direction),color:new i.aa(i.a6.properties_light_directional.color),"color-use-theme":new i.aa({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.aa(i.a6.properties_light_directional.intensity),"cast-shadows":new i.aa(i.a6.properties_light_directional["cast-shadows"]),"shadow-quality":new i.aa(i.a6.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.aa(i.a6.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const m=Object.assign(d,{worldview:this.map.getWorldview()}),S=new i.ac(this.z||0,m);this.ambientLight&&this.ambientLight.recalculate(S),this.directionalLight&&this.directionalLight.recalculate(S),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const o=this.directionalLight,d=this.ambientLight;if(!o||!d)return;const m=W=>.2126*(W[0]<=.03928?W[0]/12.92:Math.pow((W[0]+.055)/1.055,2.4))+.7152*(W[1]<=.03928?W[1]/12.92:Math.pow((W[1]+.055)/1.055,2.4))+.0722*(W[2]<=.03928?W[2]/12.92:Math.pow((W[2]+.055)/1.055,2.4)),S=o.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),A=o.properties.get("intensity"),k=o.properties.get("direction"),N=1-i.d3(k.x,k.y,k.z)[2]/90,R=m(S)*A*N,V=d.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),G=d.properties.get("intensity"),X=m(V)*G;return Number(((R+X)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const o=[];return this.directionalLight&&o.push(this.directionalLight.get()),this.ambientLight&&o.push(this.ambientLight.get()),o}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(o){if(o==null||o===""&&this.isRootStyle())return this;if(i.dm(o)){const d=i.dn(o),m=this.fragments.find(({id:A})=>A===d);if(!m)return;const S=i.dl(o);return m.style.getFragmentStyle(S)}{const d=this.fragments.find(({id:m})=>m===o);return d?d.style:void 0}}setFeaturesetSelectors(o){if(!o)return;const d={},m=(S,A="")=>`${S}::${A}`;this._featuresetSelectors={};for(const S in o){const A=this._featuresetSelectors[S]=[];for(const k of o[S].selectors){if(k.featureNamespace){const R=this.getOwnLayer(k.layer);if(!R){i.w(`Layer is undefined for selector: ${k.layer}`);continue}const V=m(R.source,R.sourceLayer);if(V in d&&d[V]!==k.featureNamespace){i.w(`"featureNamespace ${k.featureNamespace} of featureset ${S}'s selector is not associated to the same source, skip this selector`);continue}d[V]=k.featureNamespace}let N;if(k.properties)for(const R in k.properties){const V=i.U(k.properties[R]);V.result==="success"&&(N=N||{},N[R]=V.value)}A.push({layerId:k.layer,namespace:k.featureNamespace,properties:N,uniqueFeatureID:k._uniqueFeatureID})}}}getFeaturesetDescriptors(o){const d=this.getFragmentStyle(o);if(!d||!d.stylesheet.featuresets)return[];const m=[];for(const S in d.stylesheet.featuresets)m.push({featuresetId:S,importId:d.scope?d.scope:void 0});return m}getFeaturesetLayers(o,d){const m=this.getFragmentStyle(d),S=m.stylesheet.featuresets;if(!S||!S[o])return this.fire(new i.y(new Error(`The featureset '${o}' does not exist in the map's style and cannot be queried.`))),[];const A=[];for(const k of S[o].selectors){const N=m.getOwnLayer(k.layer);N&&A.push(N)}return A}getConfigProperty(o,d){const m=this.getFragmentStyle(o);if(!m)return null;const S=i.B(d,m.scope),A=m.options.get(S),k=A?A.value||A.default:null;return k?k.serialize():null}setConfigProperty(o,d,m){const S=this.getFragmentStyle(o);if(!S)return;const A=S.stylesheet.schema;if(!A||!A[d])return;const k=i.U(m);if(k.result!=="success")return void Jo(this,k.value);const N=k.value.expression,R=i.B(d,S.scope),V=S.options.get(R);if(!V)return;let G;const{minValue:X,maxValue:W,stepValue:te,type:ie,values:se}=A[d],ve=i.U(A[d].default);ve.result==="success"&&(G=ve.value.expression),G?(this.options.set(R,Object.assign({},V,{value:N,default:G,minValue:X,maxValue:W,stepValue:te,type:ie,values:se})),this.updateConfigDependencies(d)):this.fire(new i.y(new Error(`No schema defined for the config option "${d}" in the "${o}" fragment.`)))}getConfig(o){const d=this.getFragmentStyle(o);if(!d)return null;const m=d.stylesheet.schema;if(!m)return null;const S={};for(const A in m){const k=i.B(A,d.scope),N=d.options.get(k),R=N?N.value||N.default:null;S[A]=R?R.serialize():null}return S}setConfig(o,d){const m=this.getFragmentStyle(o);m&&(m.updateConfig(d,m.stylesheet.schema),this.updateConfigDependencies())}getSchema(o){const d=this.getFragmentStyle(o);return d?d.stylesheet.schema:null}setSchema(o,d){const m=this.getFragmentStyle(o);m&&(m.stylesheet.schema=d,m.updateConfig(m._config,d),this.updateConfigDependencies())}updateConfig(o,d){if(this._config=o,o||d)if(d)for(const m in d){let S,A;const k=i.U(d[m].default);if(k.result==="success"&&(S=k.value.expression),o&&o[m]!==void 0){const W=i.U(o[m]);W.result==="success"&&(A=W.value.expression)}const{minValue:N,maxValue:R,stepValue:V,type:G,values:X}=d[m];if(S){const W=i.B(m,this.scope);this.options.set(W,{default:S,value:A,minValue:N,maxValue:R,stepValue:V,type:G,values:X})}else this.fire(new i.y(new Error(`No schema defined for config option "${m}".`)))}else this.fire(new i.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(o){for(const d of this._configDependentLayers){const m=this.getLayer(d);if(m){if(o&&!m.configDependencies.has(o))continue;m.possiblyEvaluateVisibility(),this._updateLayer(m)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(d=>{const m=d._styleColorTheme.colorThemeOverride?d._styleColorTheme.colorThemeOverride:d._styleColorTheme.colorTheme;if(m){const S=d._evaluateColorThemeData(m);(!d._styleColorTheme.lut&&S!==""||d._styleColorTheme.lut&&S!==d._styleColorTheme.lut.data)&&d.setColorTheme(m)}}),this._changes.setDirty()}addLayer(o,d,m={}){this._checkLoaded();const S=o.id;if(this._layers[S])return void this.fire(new i.y(new Error(`Layer with id "${S}" already exists on this map`)));let A;if(o.type==="custom"){if(Jo(this,i.dp(o)))return;A=i.dq(o,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof o.source=="object"&&(this.addSource(S,o.source),o=i.dk(o),o=Object.assign(o,{source:S})),this._validate(lt,`layers.${S}`,o,{arrayIndex:-1},m))return;A=i.dq(o,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(A),A.setEventedParent(this,{layer:{id:S}})}A.configDependencies.size!==0&&this._configDependentLayers.add(A.fqid);let k=this._order.length;if(d){const G=this._order.indexOf(d);if(G===-1)return void this.fire(new i.y(new Error(`Layer with id "${d}" does not exist on this map.`)));A.slot===this._layers[d].slot?k=G:i.w(`Layer with id "${d}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(k,0,S),this._layerOrderChanged=!0,this._layers[S]=A;const N=this.getOwnLayerSourceCache(A),R=!!this.directionalLight&&this.directionalLight.shadowsEnabled();N&&A.canCastShadows()&&R&&(N.castsShadows=!0);const V=this._changes.getRemovedLayer(A);if(V&&A.source&&N&&A.type!=="custom"){this._changes.discardLayerRemoval(A);const G=i.B(A.source,A.scope);V.type!==A.type?this._changes.updateSourceCache(G,"clear"):(this._changes.updateSourceCache(G,"reload"),N.pause())}this._updateLayer(A),A.onAdd&&A.onAdd(this.map),A.scope=this.scope,this.mergeLayers()}moveLayer(o,d){this._checkLoaded();const m=this._checkLayer(o);if(!m||o===d)return;const S=this._order.indexOf(o);this._order.splice(S,1);let A=this._order.length;if(d){const k=this._order.indexOf(d);if(k===-1)return void this.fire(new i.y(new Error(`Layer with id "${d}" does not exist on this map.`)));m.slot===this._layers[d].slot?A=k:i.w(`Layer with id "${d}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(A,0,o),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(o){this._checkLoaded();const d=this._checkLayer(o);if(!d)return;d.setEventedParent(null);const m=this._order.indexOf(o);this._order.splice(m,1),delete this._layers[o],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(d.fqid),this._changes.removeLayer(d);const S=this.getOwnLayerSourceCache(d);if(S&&S.castsShadows){let A=!1;for(const k in this._layers)if(this._layers[k].source===d.source&&this._layers[k].canCastShadows()){A=!0;break}S.castsShadows=A}d.onRemove&&d.onRemove(this.map),this.mergeLayers()}getOwnLayer(o){return this._layers[o]}hasLayer(o){return o in this._mergedLayers}hasLayerType(o){for(const d in this._layers)if(this._layers[d].type===o)return!0;return!1}setLayerZoomRange(o,d,m){this._checkLoaded();const S=this._checkLayer(o);S&&(S.minzoom===d&&S.maxzoom===m||(d!=null&&(S.minzoom=d),m!=null&&(S.maxzoom=m),this._updateLayer(S)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(o,d){this._checkLoaded();const m=this._checkLayer(o);m&&m.slot!==d&&(m.slot=d,this._updateLayer(m))}setFilter(o,d,m={}){this._checkLoaded();const S=this._checkLayer(o);if(S&&!i.by(S.filter,d))return d==null?(S.filter=void 0,void this._updateLayer(S)):void(this._validate(de,`layers.${S.id}.filter`,d,{layerType:S.type},m)||(S.filter=i.dk(d),this._updateLayer(S)))}getFilter(o){const d=this._checkLayer(o);if(d)return i.dk(d.filter)}setLayoutProperty(o,d,m,S={}){this._checkLoaded();const A=this._checkLayer(o);if(A&&!i.by(A.getLayoutProperty(d),m)){if(m!=null&&(!S||S.validate!==!1)&&Jo(A,Ie.call(ts,{key:`layers.${o}.layout.${d}`,layerType:A.type,objectKey:d,value:m,styleSpec:i.a6,style:{glyphs:!0,sprite:!0}})))return;A.setLayoutProperty(d,m),A.configDependencies.size!==0&&this._configDependentLayers.add(A.fqid),this._updateLayer(A)}}getLayoutProperty(o,d){const m=this._checkLayer(o);if(m)return m.getLayoutProperty(d)}setPaintProperty(o,d,m,S={}){this._checkLoaded();const A=this._checkLayer(o);if(!A||i.by(A.getPaintProperty(d),m)||m!=null&&(!S||S.validate!==!1)&&Jo(A,_e.call(ts,{key:`layers.${o}.paint.${d}`,layerType:A.type,objectKey:d,value:m,styleSpec:i.a6})))return;const k=A.setPaintProperty(d,m);A.configDependencies.size!==0&&this._configDependentLayers.add(A.fqid),k&&this._updateLayer(A),this._changes.updatePaintProperties(A)}getPaintProperty(o,d){const m=this._checkLayer(o);if(m)return m.getPaintProperty(d)}setFeatureState(o,d){if(this._checkLoaded(),"target"in o){if("featuresetId"in o.target){const{featuresetId:R,importId:V}=o.target,G=this.getFragmentStyle(V),X=G.getFeaturesetLayers(R);for(const{source:W,sourceLayer:te}of X)G.setFeatureState({id:o.id,source:W,sourceLayer:te},d)}else if("layerId"in o.target){const{layerId:R}=o.target,V=this.getLayer(R);this.setFeatureState({id:o.id,source:V.source,sourceLayer:V.sourceLayer},d)}return}const m=o.source,S=o.sourceLayer,A=this._checkSource(m);if(!A)return;const k=A.type;if(k==="geojson"&&S)return void this.fire(new i.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(k==="vector"&&!S)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided.")));const N=this.getOwnSourceCaches(m);for(const R of N)R.setFeatureState(S,o.id,d)}removeFeatureState(o,d){if(this._checkLoaded(),"target"in o){if("featuresetId"in o.target){const{featuresetId:R,importId:V}=o.target,G=this.getFragmentStyle(V),X=G.getFeaturesetLayers(R);for(const{source:W,sourceLayer:te}of X)G.removeFeatureState({id:o.id,source:W,sourceLayer:te},d)}else if("layerId"in o.target){const{layerId:R}=o.target,V=this.getLayer(R);this.removeFeatureState({id:o.id,source:V.source,sourceLayer:V.sourceLayer},d)}return}const m=o.source,S=this._checkSource(m);if(!S)return;const A=S.type,k=A==="vector"?o.sourceLayer:void 0;if(A==="vector"&&!k)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(d&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new i.y(new Error("A feature id is required to remove its specific state property.")));const N=this.getOwnSourceCaches(m);for(const R of N)R.removeFeatureState(k,o.id,d)}getFeatureState(o){if(this._checkLoaded(),"target"in o){let A;if("featuresetId"in o.target){const{featuresetId:k,importId:N}=o.target,R=this.getFragmentStyle(N),V=R.getFeaturesetLayers(k);for(const{source:G,sourceLayer:X}of V){const W=R.getFeatureState({id:o.id,source:G,sourceLayer:X});if(W&&!A)A=W;else if(!i.by(A,W))return void this.fire(new i.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in o.target){const{layerId:k}=o.target,N=this.getLayer(k);A=this.getFeatureState({id:o.id,source:N.source,sourceLayer:N.sourceLayer})}return A}const d=o.source,m=o.sourceLayer,S=this._checkSource(d);if(S){if(S.type!=="vector"||m)return o.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(d)[0].getFeatureState(m,o.id);this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(o){return this.stylesheet.transition=Object.assign({},this.stylesheet.transition,o),this.transition=this.stylesheet.transition,this}getTransition(){return Object.assign({},this.stylesheet.transition)}serialize(){this._checkLoaded();const o=this.getTerrain(),d=o&&this.terrain&&this.terrain.scope===this.scope?o:this.stylesheet.terrain;return i.dr({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:d,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateFilteredLayers(o){for(const d of Object.values(this._mergedLayers))o(d)&&this._updateLayer(d)}_updateLayer(o){this._changes.updateLayer(o);const d=this.getLayerSourceCache(o),m=i.B(o.source,o.scope),S=this._changes.getUpdatedSourceCaches();o.source&&!S[m]&&d&&d.getSource().type!=="raster"&&(this._changes.updateSourceCache(m,"reload"),d.pause()),o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const d=N=>this._mergedLayers[N].is3D(!!this.terrain),m=this.order,S={},A=[];for(let N=m.length-1;N>=0;N--){const R=m[N];if(d(R)){S[R]=N;for(const V of o){const G=V[R];if(G)for(const X of G)A.push(X)}}}A.sort((N,R)=>R.intersectionZ-N.intersectionZ);const k=[];for(let N=m.length-1;N>=0;N--){const R=m[N];if(d(R))for(let V=A.length-1;V>=0;V--){const G=A[V].feature;if(G.layer&&S[G.layer.id]<N)break;k.push(G),A.pop()}else for(const V of o){const G=V[R];if(G)for(const X of G)k.push(X.feature)}}return k}queryRasterValue(o,d,m){const S=this.getOwnSource(o);return S?S.type!=="raster-array"?(this.fire(new i.y(new Error('queryRasterValue support only "raster-array" sources.'))),Promise.resolve(null)):S.queryRasterArrayValue(d,m):(this.fire(new i.y(new Error(`Source with id "${o}" does not exist in the style.`))),Promise.resolve(null))}queryRenderedFeatures(o,d,m){let S;d&&!Array.isArray(d)&&d.filter&&(this._validate(de,"queryRenderedFeatures.filter",d.filter,null,d),S=i.b6(d.filter));const A={},k=G=>{if(sa.has(G.type))return;const X=this.getOwnLayerSourceCache(G),W=A[X.id]=A[X.id]||{sourceCache:X,layers:{},has3DLayers:!1};G.is3D(!!this.terrain)&&(W.has3DLayers=!0),W.layers[G.fqid]=W.layers[G.fqid]||{styleLayer:G,targets:[]},W.layers[G.fqid].targets.push({filter:S})};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new i.y(new Error("parameters.layers must be an Array."))),[];for(const G of d.layers){const X=this._layers[G];if(!X)return this.fire(new i.y(new Error(`The layer '${G}' does not exist in the map's style and cannot be queried for features.`))),[];k(X)}}else for(const G in this._layers)k(this._layers[G]);const N=this._queryRenderedFeatures(o,A,m),R=this._flattenAndSortRenderedFeatures(N),V=[];for(const G of R)i.ds(G.layer.id)===this.scope&&V.push(G);return V}queryRenderedFeatureset(o,d,m){let S;d&&!Array.isArray(d)&&d.filter&&(this._validate(de,"queryRenderedFeatures.filter",d.filter,null,d),S=i.b6(d.filter));const A="mock",k=[];if(d&&d.target)k.push(Object.assign({},d,{targetId:A,filter:S}));else{const G=this.getFeaturesetDescriptors();for(const X of G)k.push({targetId:A,filter:S,target:X});for(const{style:X}of this.fragments){const W=X.getFeaturesetDescriptors();for(const te of W)k.push({targetId:A,filter:S,target:te})}}const N=this.queryRenderedTargets(o,k,m),R=[],V=new Set;for(const G of N)for(const X of G.variants[A])lc(X,G,V)||R.push(new i.dt(G,X));return R}queryRenderedTargets(o,d,m){const S={},A=(N,R,V,G)=>{const X=S[R.id]=S[R.id]||{sourceCache:R,layers:{},has3DLayers:!1};if(X.layers[N.fqid]=X.layers[N.fqid]||{styleLayer:N,targets:[]},N.is3D(!!this.terrain)&&(X.has3DLayers=!0),!G)return V.uniqueFeatureID=!1,void X.layers[N.fqid].targets.push(V);X.layers[N.fqid].targets.push(Object.assign({},V,{namespace:G.namespace,properties:G.properties,uniqueFeatureID:G.uniqueFeatureID}))};for(const N of d)if("featuresetId"in N.target){const{featuresetId:R,importId:V}=N.target,G=this.getFragmentStyle(V);if(!G||!G._featuresetSelectors)continue;const X=G._featuresetSelectors[R];if(!X){this.fire(new i.y(new Error(`The featureset '${R}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const W of X){const te=G.getOwnLayer(W.layerId);te&&!sa.has(te.type)&&A(te,G.getOwnLayerSourceCache(te),N,W)}}else if("layerId"in N.target){const{layerId:R}=N.target,V=this.getLayer(R);if(!V||sa.has(V.type))continue;A(V,this.getLayerSourceCache(V),N)}const k=this._queryRenderedFeatures(o,S,m);return this._flattenAndSortRenderedFeatures(k)}_queryRenderedFeatures(o,d,m){const S=[],A=!!this.map._showQueryGeometry,k=Ns.createFromScreenPoints(o,m);for(const N in d){const R=ka(k,d[N],this._availableImages,m,A);Object.keys(R).length&&S.push(R)}if(this.placement)for(const N in d){if(!d[N].sourceCache._onlySymbols)continue;const R=Mf(k.screenGeometry,d[N],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData,this.map.getWorldview());Object.keys(R).length&&S.push(R)}return S}querySourceFeatures(o,d){const m=d&&d.filter;m&&this._validate(de,"querySourceFeatures.filter",m,null,d);let S=[];const A=this.getOwnSourceCaches(o);for(const k of A)S=S.concat(Yc(k,d));return S}addSourceType(o,d,m){return ko.getSourceType(o)?m(new Error(`A source type called "${o}" already exists.`)):(ko.setSourceType(o,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:d.workerSourceURL},m):m(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(o,d,m={}){this._checkLoaded();const S=this.light.getLight();let A=!1;for(const N in o)if(!i.by(o[N],S[N])){A=!0;break}if(!A)return;const k=this._getTransitionParameters();this.light.setLight(o,d,m),this.light.updateTransitions(k)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.o.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(o,d=1){if(this._checkLoaded(),!o)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),d===0&&delete this.terrain,o===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let m=o;const S=o.source==null;if(d===1){if(this.disableElevatedTerrain)return;if(typeof m.source=="object"){const N="terrain-dem-src";this.addSource(N,m.source),m=i.dk(m),m=Object.assign(m,{source:N})}const A=Object.assign({},m),k={};if(this.terrain&&S){A.source=this.terrain.get().source;const N=this.terrain?this.getFragmentStyle(this.terrain.scope):null;N&&(k.style=N.serialize())}if(this._validate(zt,"terrain",A,k))return}if(!this.terrain||this.terrain.scope!==this.scope&&!S||this.terrain&&d!==this.terrain.drapeRenderMode){if(!m)return;this._createTerrain(m,d),this.fire(new i.z("data",{dataType:"style"}))}else{const A=this.terrain,k=A.get();for(const N of Object.keys(i.a6.terrain))!m.hasOwnProperty(N)&&i.a6.terrain[N].default&&(m[N]=i.a6.terrain[N].default);for(const N in o)if(!i.by(o[N],k[N])){A.set(o,this.options),this.stylesheet.terrain=o;const R=this._getTransitionParameters({duration:0});A.updateTransitions(R),this.fire(new i.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const d=this.fog=new pi(o,this.map.transform,this.scope,this.options);this.stylesheet.fog=d.get();const m=this._getTransitionParameters({duration:0});d.updateTransitions(m)}_createSnow(o){const d=this.snow=new xa(o,this.map.transform,this.scope,this.options);this.stylesheet.snow=d.get();const m=this._getTransitionParameters({duration:0});d.updateTransitions(m)}_createRain(o){const d=this.rain=new Wi(o,this.map.transform,this.scope,this.options);this.stylesheet.rain=d.get();const m=this._getTransitionParameters({duration:0});d.updateTransitions(m)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const o of this.map._markers)o._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const d=this.fog;if(!i.by(d.get(),o)){d.set(o,this.options),this.stylesheet.fog=d.get();const m=this._getTransitionParameters({duration:0});d.updateTransitions(m)}}else this._createFog(o);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(o){if(this._checkLoaded(),!o)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const d=this.snow;if(!i.by(d.get(),o)){d.set(o,this.options),this.stylesheet.snow=d.get();const m=this._getTransitionParameters({duration:0});d.updateTransitions(m)}}else this._createSnow(o);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(o){if(this._checkLoaded(),!o)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const d=this.rain;if(!i.by(d.get(),o)){d.set(o,this.options),this.stylesheet.rain=d.get();const m=this._getTransitionParameters({duration:0});d.updateTransitions(m)}}else this._createRain(o);this._markersNeedUpdate=!0}_reloadColorTheme(){const o=()=>{for(const S in this._layers)this._layers[S].lut=this._styleColorTheme.lut;for(const S in this._sourceCaches)this._sourceCaches[S].clearTiles()},d=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!d)return this._styleColorTheme.lut=null,void o();const m=this._evaluateColorThemeData(d);this._loadColorTheme(m).then(()=>{this.fire(new i.z("colorthemeset")),o()}).catch(S=>{i.w(`Couldn't set color theme: ${S}`)})}setColorTheme(o){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=o,this._reloadColorTheme()}setImportColorTheme(o,d){const m=this.getFragmentStyle(o);m&&(m._styleColorTheme.colorThemeOverride=d,m._reloadColorTheme())}_getTransitionParameters(o){return{now:i.o.now(),transition:Object.assign(this.transition,o)}}updateDrapeFirstLayers(){if(!this.terrain)return;const o=[],d=[];for(const m of this._mergedOrder)this.isLayerDraped(this._mergedLayers[m])?o.push(m):d.push(m);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...d)}_createTerrain(o,d){const m=this.terrain=new Et(o,d,this.scope,this.options,this.map.getWorldview());d===1&&(this.stylesheet.terrain=o),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const S=this._getTransitionParameters({duration:0});m.updateTransitions(S)}_force3DLayerUpdate(){for(const o in this._layers){const d=this._layers[o];d.type==="fill-extrusion"&&this._updateLayer(d)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const d=this._layers[o];d.type==="symbol"&&this._updateLayer(d)}}_validate(o,d,m,S,A={}){if(A&&A.validate===!1)return!1;const k=Object.assign({},this.serialize());return Jo(this,o.call(ts,Object.assign({key:d,style:k,value:m,styleSpec:i.a6},S)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.du.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._mergedLayers)this._mergedLayers[o].setEventedParent(null);for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles(),this._mergedSourceCaches[o].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(o){const d=this.getSourceCaches(o);for(const m of d)m.clearTiles()}clearSources(){for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles()}clearLayers(){for(const o in this._mergedLayers){const d=this._mergedLayers[o];d._clear&&d._clear()}}reloadSource(o){const d=this.getSourceCaches(o);for(const m of d)m.resume(),m.reload()}reloadSources(){for(const o of this.getSources())o.reload&&o.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(o=>{o.modelManager.reloadModels(o.scope)})}updateSources(o){let d;this.directionalLight&&(d=wd(this.directionalLight));const m=new Set;for(const S in this._mergedLayers){const A=this._mergedLayers[S];A.hasElevation()&&!m.has(A.source)&&m.add(A.source)}for(const S in this._mergedSourceCaches){const A=this._mergedSourceCaches[S],k=m.has(A._source.id);A.update(o,void 0,void 0,d,k)}}_generateCollisionBoxes(){for(const o in this._sourceCaches){const d=this._sourceCaches[o];d.resume(),d.reload()}}_updatePlacement(o,d,m,S,A,k,N=!1){let R=!1,V=!1;const G={},X={};for(const W of this._mergedOrder){const te=this._mergedLayers[W];if(te.type!=="symbol")continue;const ie=i.B(te.source,te.scope);let se=G[ie];if(!se){const ue=this.getLayerSourceCache(te);if(!ue)continue;const be=ue.getRenderableIds(!0).map(Te=>ue.getTileByID(Te));X[ie]=be.slice(),se=G[ie]=be.sort((Te,ke)=>ke.tileID.overscaledZ-Te.tileID.overscaledZ||(Te.tileID.isLessThan(ke.tileID)?-1:1))}const ve=this.crossTileSymbolIndex.addLayer(te,se,d.center.lng,d.projection);R=R||ve}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),N=N||this._layerOrderChanged||S===0,this._layerOrderChanged&&this.fire(new i.z("neworder")),(N||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.o.now(),d.zoom))&&(this.pauseablePlacement=new eo(d,this._mergedOrder,N,m,S,A,this.placement,this.fog&&d.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,G,X,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.o.now()),V=!0),R&&this.pauseablePlacement.placement.setStale()),V||R){this._buildingIndex.onNewFrame(d.zoom);for(let W=0;W<this._mergedOrder.length;W++){const te=this._mergedLayers[this._mergedOrder[W]];if(te.type!=="symbol")continue;const ie=this.isLayerClipped(te);this.placement.updateLayerOpacities(te,G[i.B(te.source,te.scope)],W,ie?k:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.o.now())}}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}addImport(o,d){this._checkLoaded();const m=this.stylesheet.imports=this.stylesheet.imports||[];if(m.findIndex(({id:A})=>A===o.id)!==-1)return void this.fire(new i.y(new Error(`Import with id '${o.id}' already exists in the map's style.`)));if(!d)return m.push(o),this._loadImports([o],!0);const S=m.findIndex(({id:A})=>A===d);return S===-1&&this.fire(new i.y(new Error(`Import with id "${d}" does not exist on this map.`))),this.stylesheet.imports=m.slice(0,S).concat(o).concat(m.slice(S)),this._loadImports([o],!0,d)}updateImport(o,d){this._checkLoaded();const m=this.stylesheet.imports||[],S=this.getImportIndex(o);return S===-1?this:typeof d=="string"?(this.setImportUrl(o,d),this):(d.url&&d.url!==m[S].url&&this.setImportUrl(o,d.url),i.by(d.config,m[S].config)||this.setImportConfig(o,d.config,d.data.schema),i.by(d.data,m[S].data)||this.setImportData(o,d.data),this)}moveImport(o,d){this._checkLoaded();let m=this.stylesheet.imports||[];const S=this.getImportIndex(o);if(S===-1)return this;const A=this.getImportIndex(d);if(A===-1)return this;const k=m[S],N=this.fragments[S];return m=m.filter(({id:R})=>R!==o),this.fragments=this.fragments.filter(({id:R})=>R!==o),this.stylesheet.imports=m.slice(0,A).concat(k).concat(m.slice(A)),this.fragments=this.fragments.slice(0,A).concat(N).concat(this.fragments.slice(A)),this.mergeLayers(),this}setImportUrl(o,d){this._checkLoaded();const m=this.stylesheet.imports||[],S=this.getImportIndex(o);if(S===-1)return this;m[S].url=d;const A=this.fragments[S];return A.style=this._createFragmentStyle(m[S]),A.style.on("style.import.load",()=>this.mergeAll()),A.style.loadURL(d),this}setImportData(o,d){this._checkLoaded();const m=this.getImportIndex(o),S=this.stylesheet.imports||[];return m===-1?this:d?(this.fragments[m].style.setState(d),this._reloadImports(),this):(delete S[m].data,this.setImportUrl(o,S[m].url))}setImportConfig(o,d,m){this._checkLoaded();const S=this.getImportIndex(o),A=this.stylesheet.imports||[];if(S===-1)return this;d?A[S].config=d:delete A[S].config;const k=this.fragments[S];m&&k.style.stylesheet&&(k.style.stylesheet.schema=m);const N=k.style.stylesheet&&k.style.stylesheet.schema;return k.config=d,k.style.updateConfig(d,N),this.updateConfigDependencies(),this}removeImport(o){this._checkLoaded();const d=this.stylesheet.imports||[],m=this.getImportIndex(o);m!==-1&&(d.splice(m,1),this.fragments[m].style._remove(),this.fragments.splice(m,1),this._reloadImports())}getImportIndex(o){const d=(this.stylesheet.imports||[]).findIndex(m=>m.id===o);return d===-1&&this.fire(new i.y(new Error(`Import '${o}' does not exist in the map's style and cannot be updated.`))),d}getLayer(o){return this._mergedLayers[o]}getSources(){const o=[];for(const d in this._mergedOtherSourceCaches){const m=this._mergedOtherSourceCaches[d];m&&o.push(m.getSource())}return o}getSource(o,d){const m=this.getSourceCache(o,d);return m&&m.getSource()}getLayerSource(o){const d=this.getLayerSourceCache(o);return d&&d.getSource()}getSourceCache(o,d){const m=i.B(o,d);return this._mergedOtherSourceCaches[m]}getLayerSourceCache(o){const d=i.B(o.source,o.scope);return o.type==="symbol"?this._mergedSymbolSourceCaches[d]:this._mergedOtherSourceCaches[d]}getSourceCaches(o){if(o==null)return Object.values(this._mergedSourceCaches);const d=[];return this._mergedOtherSourceCaches[o]&&d.push(this._mergedOtherSourceCaches[o]),this._mergedSymbolSourceCaches[o]&&d.push(this._mergedSymbolSourceCaches[o]),d}updateSourceCaches(){const o=this._changes.getUpdatedSourceCaches();for(const d in o){const m=o[d];m==="reload"?this.reloadSource(d):m==="clear"&&this.clearSource(d)}}updateLayers(o){const d=this._changes.getUpdatedPaintProperties();for(const m of d){const S=this.getLayer(m);S&&S.updateTransitions(o)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(o){this.stylesheet.glyphs=o,this.glyphManager.setURL(o)}getImages(o,d,m){this.imageManager.getImages(d.images,d.scope,m),this._updateTilesForChangedImages();const S=k=>{if(k){const N=d.images.map(R=>i.I.toString(R));k.setDependencies(d.tileID.key,d.type,N)}},A=i.B(d.source,d.scope);S(this._mergedOtherSourceCaches[A]),S(this._mergedSymbolSourceCaches[A]),d.images.some(k=>k.iconsetId)&&this.fire(new i.z("data",{dataType:"style"}))}rasterizeImages(o,d,m){this.imageManager.rasterizeImages(d,m)}getGlyphs(o,d,m){this.glyphManager.getGlyphs(d.stacks,m)}getResource(o,d,m){return i.dv(d,m)}getOwnSourceCache(o){return this._otherSourceCaches[o]}getOwnLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}getOwnSourceCaches(o){const d=[];return this._otherSourceCaches[o]&&d.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&d.push(this._symbolSourceCaches[o]),d}_isSourceCacheLoaded(o){const d=this.getOwnSourceCaches(o);return d.length===0?(this.fire(new i.y(new Error(`There is no source with ID '${o}'`))),!1):d.every(m=>m.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(o,d){if(!this._clipLayerPresent&&o.type!=="fill-extrusion"&&o.type!=="building")return!1;const m=o.type==="fill-extrusion"&&(o.sourceLayer==="building"||o.sourceLayer==="procedural_buildings"),S=o.type==="building";if(o.is3D(!!this.terrain)){if(m||S||d&&d.type==="batched-model"||o.type==="model")return!0}else if(o.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(o=>{o.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ko.getSourceType=function(g){return oc[g]},ko.setSourceType=function(g,o){oc[g]=o},ko.registerForPluginStateChange=i.dw;class Up{execute(o){const d=this._makeBuildingsQueryArea(o),m=this._makeFloorsQueryArea(o),S=o.queryRenderedFeatures(d).reduce((V,G)=>{const X=G.properties.id;return G.properties.type!=="building"||V.some(W=>W.properties.id===X)||V.push(G),V},[]),A=o.queryRenderedFeatures(m).reduce((V,G)=>{const X=G.properties.id;return G.properties.type!=="floor"||V.some(W=>W.properties.id===X)||V.push(G),V},[]),k=[o.getCenter().lng,o.getCenter().lat],N=this._findBuildingAtCenter(k,S),R=S.length>0?S[0]:null;return{floors:A.map(V=>({id:V.properties.id,name:V.properties.name,isDefault:V.properties.is_default,zIndex:V.properties.z_index,connectedFloorIds:V.properties.connected_floor_ids,conflictedFloorIds:V.properties.conflicted_floor_ids,buildingIds:V.properties.building_ids})),building:N?{id:N.properties.id,name:N.properties.name}:{id:R.properties.id,name:R.properties.name}}}_makeBuildingsQueryArea(o){const d=o.transform.width,m=o.transform.height,S=Math.min(d,m)*(1/8),A=.5*(d-S),k=.5*(m-S);return[new i.P(A,k),new i.P(A+S,k+S)]}_makeFloorsQueryArea(o){const d=o.transform.width,m=o.transform.height;return[new i.P(0,0),new i.P(d,m)]}_findBuildingAtCenter(o,d){for(const m of d)if(m.geometry.type==="Polygon"&&this._pointInPolygon(o,m.geometry.coordinates[0]))return m;return null}_pointInPolygon(o,d){let m=!1;for(let S=0,A=d.length-1;S<d.length;A=S++){const k=d[S][0],N=d[S][1],R=d[A][1];N>o[1]!=R>o[1]&&o[0]<(d[A][0]-k)*(o[1]-N)/(R-N)+k&&(m=!m)}return m}}class jf{constructor(){this._floors=new Map,this._buildings=new Map}append(o){const d=o.building;let m=!1;if(d){const S=d.id;S&&(this._buildings.set(S,d),m||this._buildings.has(S)||(m=!0))}return o.floors.forEach(S=>{const A=S.id;m||this._floors.has(A)||(m=!0),this._floors.set(A,S)}),m}clear(){this._floors.clear(),this._buildings.clear()}getFloors(o=null){const d=Array.from(this._floors.values());return o?d.filter(m=>{const S=m.buildingIds;return!!S&&S.split(";").includes(o)}):d}}class ig{constructor(){this._selectedFloorId=null,this._selectedBuildingId=null,this._lastActiveFloors=[],this._featuresStorage=new jf}setIndoorData(o){const d=this._featuresStorage.append(o);return this._selectedBuildingId=o.building?o.building.id:null,d}setFloorId(o){const d=this._selectedFloorId!==o;return d&&(this._selectedFloorId=o),d}getCurrentBuildingSelection(){if(!this._selectedBuildingId)return{selectedFloorId:null,floors:[]};const o=this._featuresStorage.getFloors(this._selectedBuildingId),d=this.getActiveFloors().find(m=>{const S=m.buildingIds;if(!S)return!1;const A=S.split(";");return!!this._selectedBuildingId&&A.includes(this._selectedBuildingId)});return{selectedFloorId:d?d.id:null,floors:o}}getActiveFloors(o=!1){const d=this._featuresStorage.getFloors(),m=d.find(R=>R.id===this._selectedFloorId),S=d.filter(R=>R.isDefault===!0);let A=[];if(m)return A=this._calculateCurrentActiveFloors(d,m,S,o),A;if(S.length===0){const R=this._featuresStorage.getFloors(this._selectedBuildingId);A=R.length>0?[R[0]]:[]}else A=S;const k=this._getNonConflictingLastActiveFloors(A),N=[...A,...k];return this._lastActiveFloors=N,N}hasBuildingChanged(o){return this._selectedBuildingId!==(o.building?o.building.id:null)}hasActiveBuilding(){return this._selectedBuildingId!==null}isEmpty(){return this._selectedFloorId===null&&this._selectedBuildingId===null&&this._lastActiveFloors.length===0}_calculateCurrentActiveFloors(o,d,m,S){if(!d)return this._getNonConflictingDefaultFloors(this._lastActiveFloors,m);const A=this._getConnectedFloors(d,o);return S?this._buildExplicitSelectionFloors(d,A,m):this._buildImplicitSelectionFloors(A,m)}_getConnectedFloors(o,d){const m=o.connectedFloorIds;if(!m)return[];const S=new Set(m.split(";"));return d.filter(A=>S.has(A.id))}_buildExplicitSelectionFloors(o,d,m){const S=[o,...d],A=this._getNonConflictingLastActiveFloors(S),k=[...S,...A],N=this._deduplicateFloors(k),R=this._getConflictingFloorIdsFrom(N),V=m.filter(X=>!R.has(X.id)),G=[...N,...V];return this._lastActiveFloors=G,G}_buildImplicitSelectionFloors(o,d){const m=this._getConflictingFloorIdsFrom(this._lastActiveFloors),S=d.filter(k=>!m.has(k.id)),A=this._deduplicateFloors([...this._lastActiveFloors,...S]);return this._lastActiveFloors=A,A}_getNonConflictingDefaultFloors(o,d){const m=this._getConflictingFloorIdsFrom(o),S=d.filter(k=>!m.has(k.id)),A=this._deduplicateFloors([...o,...S]);return this._lastActiveFloors=A,A}_deduplicateFloors(o){const d=new Set;return o.filter(m=>{const S=m.id;return!d.has(S)&&(d.add(S),!0)})}_getConflictingFloorIdsFrom(o){const d=new Set;return o.forEach(m=>{const S=m.conflictedFloorIds;S&&S.split(";").forEach(A=>d.add(A))}),d}_getNonConflictingLastActiveFloors(o){if(!this._lastActiveFloors||this._lastActiveFloors.length===0)return[];const d=new Set(o.map(S=>S.id)),m=this._getConflictingFloorIdsFrom(o);return this._lastActiveFloors.filter(S=>{const A=S.id;return!d.has(A)&&!m.has(A)})}_isFloorConflicted(o,d){const m=o.id;return d.some(S=>{const A=S.conflictedFloorIds;return!!A&&A.split(";").includes(m)})}reset(){this._selectedFloorId=null,this._selectedBuildingId=null,this._lastActiveFloors=[],this._featuresStorage.clear()}}class qh extends i.E{constructor(o){super(),i.aY(["_onLoad","_onMove"],this),this._map=o,this._floorSelectionState=new ig,this._queryIndoor(),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.off("load",this._onLoad),this._map.off("move",this._onMove),this._map=null,this._floorSelectionState=null}selectFloor(o){this._floorSelectionState.setFloorId(o)&&this._updateIndoorConfig(!0)}_onLoad(){this._map.style.forEachFragmentStyle(o=>{o.stylesheet.indoor&&(this._indoorDataQuery?this.fire(new i.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._scope=o.scope,this._indoorDataQuery=new Up))}),this._map._addIndoorControl(),this._queryIndoor()}_onMove(){this._queryIndoor()}_queryIndoor(){if(!this._indoorDataQuery||!this._map.isStyleLoaded())return;if(this._map.transform.zoom<15)return void this._clearIndoorData();const o=this._indoorDataQuery.execute(this._map);if(!o||o.floors.length===0||this._map.transform.zoom<16)this._clearIndoorData();else if(this._floorSelectionState.hasBuildingChanged(o)){if(!o.building&&this._floorSelectionState.getActiveFloors().length<=0)return void this._clearIndoorData();this._setIndoorData(o),o.building&&this._updateIndoorSelector()}else this._setIndoorData(o)}_setIndoorData(o){this._floorSelectionState.setIndoorData(o)&&this._updateIndoorConfig()}_clearIndoorData(){this._floorSelectionState.isEmpty()||(this._floorSelectionState.reset(),this._updateIndoorSelector(),this._map.setConfigProperty(this._scope,"activeFloors",["literal",[]]))}_updateIndoorSelector(){const o=this._floorSelectionState.getCurrentBuildingSelection(),d=o.floors.map(m=>({id:m.id,name:m.name,shortName:m.zIndex.toString(),levelOrder:m.zIndex}));this.fire(new i.z("indoorupdate",{selectedFloorId:o.selectedFloorId,floors:d}))}_updateIndoorConfig(o=!1){const d=this._floorSelectionState.getActiveFloors(o).map(m=>m.id)||[];this._map.setConfigProperty(this._scope,"activeFloors",["literal",d])}}var Vp=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,ky=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb*col.a,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Iy=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Of="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Ff=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,zf=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,sg=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,mc=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,ag=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,yn=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Ny=`#ifdef RENDER_SHADOWS
precision highp sampler2DShadow;uniform sampler2DShadow u_shadowmap_0;uniform sampler2DShadow u_shadowmap_1;uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;float shadow_sample(sampler2DShadow shadowmap,highp vec3 pos,highp float bias) {
#ifdef CLIP_ZERO_TO_ONE
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z-bias);
#else
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z*0.5+0.5-bias);
#endif
return texture(shadowmap,coord);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {light_view_pos0.xyz/=light_view_pos0.w;
#ifdef SHADOWS_SINGLE_CASCADE
vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);
#else
light_view_pos1.xyz/=light_view_pos1.w;vec4 abs_bounds=abs(vec4(light_view_pos0.xy,light_view_pos1.xy));if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}float occlusion1=shadow_sample(u_shadowmap_1,light_view_pos1.xyz,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Bf=[];Ga(Vp,Bf),Ga(Iy,Bf),Ga(ky,Bf);const Uf={"_prelude_fog.vertex.glsl":zf,"_prelude_terrain.vertex.glsl":Ff,"_prelude_shadow.vertex.glsl":yn,"_prelude_fog.fragment.glsl":sg,"_prelude_shadow.fragment.glsl":Ny,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":mc,"_prelude_raster_particle.glsl":ag},$p={};gi("",Ff),gi(sg,zf),gi(Ny,yn),gi(mc,""),gi(ag,"");const Vf=gi(ky,Iy),Dc=Vp;var kl={background:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
const float window_depth=0.5;const float ao_radius=0.2;in vec4 v_color;in highp vec3 v_normal;in highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
in lowp float v_faux_facade;in highp float v_faux_facade_ed;in highp vec2 v_faux_facade_window;in highp vec2 v_faux_facade_floor;in highp vec2 v_faux_facade_range;in highp float v_aspect;in highp vec3 v_tbn_0;in highp vec3 v_tbn_1;in highp vec3 v_tbn_2;in highp vec4 v_faux_color_emissive;uniform float u_faux_facade_ao_intensity;
#endif
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
uniform lowp float u_opacity;uniform vec3 u_camera_pos;uniform highp float u_tile_to_meter;uniform float u_facade_emissive_chance;vec3 linearTosRGB(in vec3 color) {return pow(color,vec3(1./2.2));}
#ifdef BUILDING_FAUX_FACADE
float hash12(in vec2 p) {vec3 p3 =fract(vec3(p.xyx)*0.1031);p3+=dot(p3,p3.yzx+33.33);return fract((p3.x+p3.y)*p3.z);}float min3(in vec3 v) {return min(min(v.x,v.y),v.z);}vec2 get_uv_mask_id(in vec2 q,out float mask,out vec2 id) {vec2 p=q;mask=step(v_faux_facade_range.x,p.y)*step(p.y,v_faux_facade_range.y);p.y=p.y-v_faux_facade_range.x;vec2 uv=modf(p/v_faux_facade_floor,id);vec4 d=(v_faux_facade_floor.xyxy+vec4(-v_faux_facade_window,v_faux_facade_window))*0.5;vec4 edge=d/v_faux_facade_floor.xyxy;vec2 m=step(edge.xy,uv)*step(uv,edge.zw);mask*=m.x*m.y;uv-=vec2(0.5);uv*=vec2(0.5)/(vec2(0.5)-edge.xy);uv+=vec2(0.5);return uv;}float ray_unit_box(in vec3 ray_o,in vec3 ray_d,in vec3 bmin,in vec3 bmax) {vec3 planes=mix(bmin,bmax,step(0.0,ray_d));vec3 t=(planes-ray_o)/ray_d;return min3(t);}float get_emissive(in vec2 id) {if (u_facade_emissive_chance > 0.0) {return (step(hash12(id),u_facade_emissive_chance)+0.05)*v_faux_color_emissive.a;}return 0.0;}vec3 get_shade_info(in vec3 v,in vec3 v_normalized,in vec3 color,in vec2 id,in mat3 tbn,inout vec3 out_normal,inout float out_emissive) {vec3 out_color=color;vec3 abs_v=abs(v_normalized);bool x_major=abs_v.x >=abs_v.y && abs_v.x >=abs_v.z;bool y_major=abs_v.y >=abs_v.x && abs_v.y >=abs_v.z;bool z_major=abs_v.z >=abs_v.x && abs_v.z >=abs_v.y;
#if 0
if (x_major) {out_color=v.x > 0.0 ? vec3(1.0,0.0,0.0) : vec3(0.0,1.0,1.0);} else if (y_major) {out_color=v.y > 0.0 ? vec3(0.0,1.0,0.0) : vec3(1.0,0.0,1.0);} else if (z_major) {out_color=v.z > 0.0 ? vec3(0.0,0.0,1.0) : vec3(1.0,1.0,0.0);}out_emissive=1.0;
#else
if (x_major) {out_normal=sign(v.x)*tbn[0];} else if (y_major) {out_normal=vec3(0.0,0.0,-sign(v.y));} else if (z_major) {out_color=v_faux_color_emissive.rgb;out_emissive=v.z <=0.0 ? get_emissive(id) : out_emissive;}float ao=1.0;if (u_faux_facade_ao_intensity > 0.0) {vec4 ao_range=v_faux_facade_window.xxyy*0.5-vec4(0,ao_radius,0,ao_radius);vec2 ao_range_z=vec2(window_depth*0.5)-vec2(0.0,ao_radius);if (x_major || y_major) {ao*=smoothstep(-ao_range_z.x,-ao_range_z.y,v.z);} else if (z_major) {ao*=smoothstep(-ao_range.x,-ao_range.y,v.x)*(1.0-smoothstep(ao_range.y,ao_range.x,v.x));ao*=smoothstep(-ao_range.z,-ao_range.w,v.y)*(1.0-smoothstep(ao_range.w,ao_range.z,v.y));}ao=mix(1.0,min(1.0,ao+0.25),u_faux_facade_ao_intensity);}out_color*=ao;
#endif
return out_color;}
#endif
vec3 apply_lighting_linear(in vec3 color,in vec3 normal,in float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec3 normal=normalize(v_normal);vec3 base_color=v_color.rgb;float emissive=v_color.a;
#ifdef BUILDING_FAUX_FACADE
if (v_faux_facade > 0.0) {mat3 tbn=mat3(v_tbn_0,v_tbn_1,v_tbn_2);vec3 v=vec3(v_pos.xy,v_pos.z/u_tile_to_meter)-u_camera_pos;vec3 view_tangent=transpose(tbn)*v;vec2 q=vec2(v_faux_facade_ed,v_pos.z);float mask=0.0;vec2 id=vec2(0.0);vec2 uv=get_uv_mask_id(q,mask,id);uv*=v_faux_facade_window;vec3 bmin=vec3(0.0,0.0,-window_depth);vec3 bmax=bmin+vec3(v_faux_facade_window,window_depth);vec3 ray_o=vec3(uv,0.0);vec3 ray_d=normalize(view_tangent);float t_min=ray_unit_box(ray_o,ray_d,bmin,bmax);vec3 hit=ray_o+t_min*ray_d;vec3 r=vec3(v_faux_facade_window,-window_depth);hit-=r*0.5;vec3 normalized=hit/r;vec3 out_normal=normal;float out_emissive=emissive;vec3 room_color=get_shade_info(hit,normalized,base_color,id,tbn,out_normal,out_emissive);base_color=mix(base_color,room_color,mask);normal=mix(normal,out_normal,mask);emissive=mix(emissive,out_emissive,mask);}
#endif
vec4 color=vec4(base_color,1.0);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=mix(color.rgb,base_color.rgb,emissive);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_pos.z));
#endif
color.rgb=linearTosRGB(color.rgb);color*=u_opacity;
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_pos.z);
#endif
glFragColor=color; 
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3;in vec3 a_centroid_3;in vec4 a_faux_facade_data;in vec2 a_faux_facade_vertical_range;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;uniform highp float u_tile_to_meter;out vec4 v_color;out vec3 v_normal;out highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
out lowp float v_faux_facade;out highp float v_faux_facade_ed;out highp vec2 v_faux_facade_window;out highp vec2 v_faux_facade_floor;out highp vec2 v_faux_facade_range;out highp float v_aspect;out highp vec3 v_tbn_0;out highp vec3 v_tbn_1;out highp vec3 v_tbn_2;out highp vec4 v_faux_color_emissive;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
const float MAX_UINT_16=65535.0;const float MAX_INT_16=32767.0;const float MAX_UINT_8=255.0;const float TWO_POW_8=256.0;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#ifdef BUILDING_FAUX_FACADE
mat3 get_tbn(in vec3 normal) {const vec3 bitangent=vec3(0.0,0.0,1.0);vec3 tangent=normalize(vec3(normal.y,-normal.x,0.0));return mat3(tangent,bitangent,normal);}
#endif
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 faux_facade_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute-custom highp vec2 faux_facade_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);vec3 a_normal_3f=a_normal_3/MAX_INT_16;v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));float hidden=0.0;
#ifdef BUILDING_FAUX_FACADE
v_faux_facade=a_faux_facade_data.x;if (v_faux_facade > 0.0) {v_faux_facade_ed=a_faux_facade_data.x *u_tile_to_meter;float window_x_perc=floor(a_faux_facade_data.y/TWO_POW_8);float window_y_perc=a_faux_facade_data.y-TWO_POW_8*window_x_perc;vec2 window_perc=vec2(window_x_perc,window_y_perc)/MAX_UINT_8;v_faux_facade_floor=(a_faux_facade_data.zw/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_faux_facade_window=window_perc*v_faux_facade_floor;v_faux_facade_range=(a_faux_facade_vertical_range/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_aspect=v_faux_facade_window.x/v_faux_facade_window.y;mat3 tbn=get_tbn(normalize(v_normal));v_tbn_0=tbn[0];v_tbn_1=tbn[1];v_tbn_2=tbn[2];v_faux_color_emissive=decode_color(faux_facade_color_emissive);v_faux_color_emissive.rgb=sRGBToLinear(v_faux_color_emissive.rgb);}
#endif
v_pos=a_pos_3f;
#ifdef RENDER_CUTOFF
vec4 ground=u_matrix*vec4(a_centroid_3,1.0);v_cutoff_opacity=cutoff_opacity(u_cutoff_params,ground.z);hidden=float(v_cutoff_opacity==0.0);v_pos.z*=v_cutoff_opacity;
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=v_pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(v_pos);
#endif
gl_Position=mix(u_matrix*vec4(v_pos,1),AWAY,hidden);}`),buildingBloom:gi(`in vec4 v_color_emissive;
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
float saturate(float val) {return clamp(val,0.0,1.0);}void main() {float emission=v_color_emissive.a;float opacity=1.0;
#ifdef HAS_ATTRIBUTE_a_bloom_attenuation
float distance=length(vec2(1.3*max(0.0,abs(bloom_attenuation.x)-bloom_attenuation.z),bloom_attenuation.y));distance+= mix(0.5,0.0,clamp(emission-1.0,0.0,1.0));opacity*=saturate(1.0-distance*distance);
#endif
glFragColor=vec4(v_color_emissive.rgb,1.0)*opacity;}`,`in vec3 a_pos_3f;
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
out vec4 v_color_emissive;uniform mat4 u_matrix;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
#ifdef HAS_ATTRIBUTE_a_part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);float part_emissive=color_emissive.a*5.0;v_color_emissive=vec4(sRGBToLinear(color_emissive.rgb),part_emissive);
#else
v_color_emissive=vec4(1.0);
#endif
gl_Position=u_matrix*vec4(a_pos_3f,1.0);}`),buildingDepth:gi(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:gi("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:gi(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:gi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:gi("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform float u_zoom_transition;
#endif
out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec3 proj_pos=a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation);
#ifdef PROJECTION_GLOBE_VIEW
#ifndef PROJECTED_POS_ON_VIEWPORT
vec3 globe_pos=proj_pos;vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,a_anchor_pos,u_tile_id,u_merc_center);proj_pos=mix_globe_mercator(globe_pos,mercator_pos,u_zoom_transition);
#endif
#endif
vec4 projectedPoint=u_matrix*vec4(proj_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:gi("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:gi("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:gi(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:gi(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#else
#ifdef FEATURE_CUTOUT
apply_feature_cutout(vec4(0.0,0.0,0.0,1.0),gl_FragCoord);
#endif
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}vec3 compute_view_dependent_emissive_color(float ndotl,float emissive_strength,vec3 color)
{color=sRGBToLinear(color);color=color*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);color=linearTosRGB(color.rgb);return color;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
vec3 color=structure_color.xyz;
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);vec3 transformed_normal=vec3(-normal.xy,normal.z);float ndotl=calculate_NdotL(transformed_normal);float emissive_strength=u_emissive_strength;emissive_strength=0.0;vec3 emissive_color=compute_view_dependent_emissive_color(ndotl,emissive_strength,color.xyz);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,transformed_normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,transformed_normal);
#endif
color=mix(color,emissive_color,emissive_strength);if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(-v_normal.xy,v_normal.z));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef FLIP_Y
v_pos=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FLIP_Y
v_pos_world=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
#ifdef FEATURE_CUTOUT
color=apply_feature_cutout(color,gl_FragCoord);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);
#ifdef CLIP_ZERO_TO_ONE
cutoff=cutoff_opacity(u_cutoff_params,ground.z*2.0-ground.w);
#else
cutoff=cutoff_opacity(u_cutoff_params,ground.z);
#endif
if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:gi(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:gi(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:gi(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:gi(`precision highp float;uniform highp sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:gi("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:gi("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:gi(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:gi(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef TERRAIN
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#else
out_color.rgb*=mix(v_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
}`),terrainRaster:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:gi("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:gi(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Of),skyboxGradient:gi(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Of),skyboxCapture:gi(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:gi(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_atmosphere_fog_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_atmosphere_fog_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_atmosphere_fog_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;
#ifdef FLIP_Y
T=-T;B=-B;
#endif
highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));
#ifdef FLIP_Y
n=normalize(cross(fdx,fdy));
#else
n=normalize(cross(fdx,fdy))*-1.0;
#endif
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
#ifdef FEATURE_CUTOUT
finalColor=apply_feature_cutout(finalColor,gl_FragCoord);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:gi(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:gi(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:gi("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:gi("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:gi("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:gi("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Ga(g,o){const d=g.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let m of d)if(m=m.trim(),m[0]==="#"&&m.includes("if")&&!m.includes("endif")){m=m.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const S=m.split(" ");for(const A of S)o.includes(A)||o.push(A)}}function gi(g,o){const d=/#include\s+"([^"]+)"/g,m=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g,S={},A=[],k=[];if(g=g.replace(d,(R,V)=>(k.push(V),"")),(o=o.replace(d,(R,V)=>(A.push(V),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let N=[...Bf];Ga(g,N),Ga(o,N);for(const R of[...A,...k])Uf[R]||console.error(`Undefined include: ${R}`),$p[R]||($p[R]=[],Ga(Uf[R],$p[R])),N=[...N,...$p[R]];return{fragmentSource:g=g.replace(m,(R,V,G,X,W)=>(S[W]=!0,V==="define"?`
#ifndef HAS_UNIFORM_u_${W}
in ${G} ${X} ${W};
#else
uniform ${G} ${X} u_${W};
#endif
`:V==="initialize"?`
#ifdef HAS_UNIFORM_u_${W}
    ${G} ${X} ${W} = u_${W};
#endif
`:V==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    in ${G} ${X} ${W};
#endif
`:V==="initialize-attribute"?"":void 0)),vertexSource:o=o.replace(m,(R,V,G,X,W)=>{const te=X==="float"?"vec2":X,ie=W.match(/color/)?"color":te;return V==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${W}
in ${G} ${X} a_${W};
#endif
`:S[W]?V==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
in ${G} ${te} a_${W};
out ${G} ${X} ${W};
#else
uniform ${G} ${X} u_${W};
#endif
`:V==="initialize"?ie==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = a_${W};
#else
    ${G} ${X} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = unpack_mix_${ie}(a_${W}, u_${W}_t);
#else
    ${G} ${X} ${W} = u_${W};
#endif
`:V==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    in ${G} ${X} a_${W};
    out ${G} ${X} ${W};
#endif
`:V==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    ${W} = a_${W};
#endif
`:void 0:V==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
in ${G} ${te} a_${W};
#else
uniform ${G} ${X} u_${W};
#endif
`:V==="define-instanced"?ie==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${W}0;
in vec4 a_${W}1;
in vec4 a_${W}2;
in vec4 a_${W}3;
#else
uniform ${G} ${X} u_${W};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${G} ${te} a_${W};
#else
uniform ${G} ${X} u_${W};
#endif
`:V==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${W}
    ${G} ${X} ${W} = a_${W};
#endif
`:ie==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${G} ${X} ${W} = a_${W};
#else
    ${G} ${X} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${G} ${X} ${W} = unpack_mix_${ie}(a_${W}, u_${W}_t);
#else
    ${G} ${X} ${W} = u_${W};
#endif
`}),usedDefines:N,vertexIncludes:A,fragmentIncludes:k}}class nh{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,d,m,S,A,k,N,R){this.context=o;let V=this.boundPaintVertexBuffers.length!==S.length;for(let X=0;!V&&X<S.length;X++)this.boundPaintVertexBuffers[X]!==S[X]&&(V=!0);let G=this.boundDynamicVertexBuffers.length!==N.length;for(let X=0;!G&&X<N.length;X++)this.boundDynamicVertexBuffers[X]!==N[X]&&(G=!0);if(!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==m||V||G||this.boundIndexBuffer!==A||this.boundVertexOffset!==k)this.freshBind(d,m,S,A,k,N,R);else{o.bindVertexArrayOES.set(this.vao);for(const X of N)X&&(X.bind(),R&&X.instanceCount&&X.setVertexAttribDivisor(o.gl,d,R));A&&A.dynamicDraw&&A.bind()}}freshBind(o,d,m,S,A,k,N){const R=this.context,V=R.gl;this.vao&&this.destroy(),this.vao=R.gl.createVertexArray(),R.bindVertexArrayOES.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=S,this.boundVertexOffset=A,this.boundDynamicVertexBuffers=k,d.enableAttributes(V,o),d.bind(),d.setVertexAttribPointers(V,o,A);for(const G of m)G.enableAttributes(V,o),G.bind(),G.setVertexAttribPointers(V,o,A);for(const G of k)G&&(G.enableAttributes(V,o),G.bind(),G.setVertexAttribPointers(V,o,A),N&&G.instanceCount&&G.setVertexAttribDivisor(V,o,N));S&&S.bind()}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Fx(g,o){const d=Math.pow(2,o.canonical.z),m=o.canonical.y;return[new i.ae(0,m/d).toLngLat().lat,new i.ae(0,(m+1)/d).toLngLat().lat]}function My(g,o,d,m,S,A,k){const N=g.context,R=N.gl,V=d.hillshadeFBO;if(!V)return;g.prepareDrawTile();const G=g.isTileAffectedByFog(o),X=g.getOrCreateProgram("hillshade",{overrideFog:G});N.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,V.colorAttachment.get());const W=((ve,ue,be,Te)=>{const ke=be.paint.get("hillshade-shadow-color"),Ue=be.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Fe=be.paint.get("hillshade-highlight-color"),Ve=be.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",ze=be.paint.get("hillshade-accent-color"),Oe=be.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",Ge=be.paint.get("hillshade-emissive-strength");let Tt=i.an(be.paint.get("hillshade-illumination-direction"));if(be.paint.get("hillshade-illumination-anchor")==="viewport")Tt-=ve.transform.angle;else if(ve.style&&ve.style.enable3dLights()&&ve.style.directionalLight){const jt=ve.style.directionalLight.properties.get("direction"),bt=i.d3(jt.x,jt.y,jt.z);Tt=i.an(bt[1])}const ut=!ve.options.moving;return{u_matrix:Te||ve.transform.calculateProjMatrix(ue.tileID.toUnwrapped(),ut),u_image:0,u_latrange:Fx(0,ue.tileID),u_light:[be.paint.get("hillshade-exaggeration"),Tt],u_shadow:ke.toPremultipliedRenderColor(Ue?null:be.lut),u_highlight:Fe.toPremultipliedRenderColor(Ve?null:be.lut),u_emissive_strength:Ge,u_accent:ze.toPremultipliedRenderColor(Oe?null:be.lut)}})(g,d,m,g.terrain?o.projMatrix:null);g.uploadCommonUniforms(N,X,o.toUnwrapped());const{tileBoundsBuffer:te,tileBoundsIndexBuffer:ie,tileBoundsSegments:se}=g.getTileBoundsBuffers(d);X.draw(g,R.TRIANGLES,S,A,k,hr.disabled,W,m.id,te,ie,se)}function $f(g,o,d){if(!o.needsDEMTextureUpload)return;const m=g.context,S=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||g.getTileTexture(d.stride);const A=d.getPixels();o.demTexture?o.demTexture.update(A,{premultiply:!1}):o.demTexture=new i.T(m,A,S.R32F,{premultiply:!1}),o.needsDEMTextureUpload=!1}function Rv(g,o,d){const m=g.context,S=m.gl;if(!o.dem)return;const A=o.dem;if(m.activeTexture.set(S.TEXTURE1),$f(g,o,A),!o.demTexture)return;o.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);const k=A.dim;m.activeTexture.set(S.TEXTURE0);let N=o.hillshadeFBO;if(!N){const W=new i.T(m,{width:k,height:k,data:null},S.RGBA8);W.bind(S.LINEAR,S.CLAMP_TO_EDGE),N=o.hillshadeFBO=m.createFramebuffer(k,k,!0,"renderbuffer"),N.colorAttachment.set(W.texture)}m.bindFramebuffer.set(N.framebuffer),m.viewport.set([0,0,k,k]);const{tileBoundsBuffer:R,tileBoundsIndexBuffer:V,tileBoundsSegments:G}=g.getMercatorTileBoundsBuffers(),X=[];g.linearFloatFilteringSupported()&&X.push("TERRAIN_DEM_FLOAT_FORMAT"),g.getOrCreateProgram("hillshadePrepare",{defines:X}).draw(g,S.TRIANGLES,Ln.disabled,sr.disabled,kr.unblended,hr.disabled,((W,te)=>{const ie=te.stride,se=i.bC();return i.cd(se,0,i.al,-i.al,0,0,1),i.br(se,se,[0,-i.al,0]),{u_matrix:se,u_image:1,u_dimension:[ie,ie],u_zoom:W.overscaledZ}})(o.tileID,A),d.id,R,V,G),o.needsHillshadePrepare=!1}class Ls{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ly extends Ls{getDefault(){return i.ao.transparent.toNonPremultipliedRenderColor(null)}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class og extends Ls{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class Dy extends Ls{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class jv extends Ls{getDefault(){return[!0,!0,!0,!0]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Yw extends Ls{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Xw extends Ls{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Ov extends Ls{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const d=this.current;(o.func!==d.func||o.ref!==d.ref||o.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Jw extends Ls{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Ry extends Ls{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=o,this.dirty=!1}}class Qw extends Ls{getDefault(){return[0,1]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class zx extends Ls{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=o,this.dirty=!1}}class Fv extends Ls{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class qp extends Ls{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.BLEND):d.disable(d.BLEND),this.current=o,this.dirty=!1}}class lg extends Ls{getDefault(){const o=this.gl;return[o.ONE,o.ZERO,o.ONE,o.ZERO]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.blendFuncSeparate(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class zu extends Ls{getDefault(){return i.ao.transparent.toNonPremultipliedRenderColor(null)}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Gp extends Ls{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(o,o),this.current=o,this.dirty=!1)}}class jy extends Ls{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=o,this.dirty=!1}}class cg extends Ls{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Hp extends Ls{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}let Bx=class extends Ls{getDefault(){return null}set(g){(g!==this.current||this.dirty)&&(this.gl.useProgram(g),this.current=g,this.dirty=!1)}};class zv extends Ls{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Ux extends Ls{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Rc extends Ls{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class gc extends Ls{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class iu extends Ls{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Bv extends Ls{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class ug extends Ls{getDefault(){return null}set(o){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class su extends Ls{getDefault(){return null}set(o){this.gl&&(o!==this.current||this.dirty)&&(this.gl.bindVertexArray(o),this.current=o,this.dirty=!1)}}class jc extends Ls{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Vx extends Ls{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class $x extends Ls{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class rh extends Ls{constructor(o,d){super(o),this.context=o,this.parent=d}getDefault(){return null}}class Uv extends rh{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Vv extends rh{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,this.attachment(),d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class qx extends rh{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,this.attachment(),d.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class e2 extends Vv{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const Wp=(g,o,d)=>({u_matrix:g,u_image0:0,u_skirt_height:o,u_ground_shadow_factor:d}),qf=(g,o,d,m,S,A,k,N,R,V,G,X,W,te,ie,se)=>({u_proj_matrix:Float32Array.from(g),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(m),u_merc_matrix:d,u_zoom_transition:S,u_merc_center:A,u_image0:0,u_frustum_tl:k,u_frustum_tr:N,u_frustum_br:R,u_frustum_bl:V,u_globe_pos:G,u_globe_radius:X,u_viewport:W,u_grid_matrix:se?Float32Array.from(se):new Float32Array(9),u_skirt_height:te,u_far_z_cutoff:ie});function Gh(g,o){return g!=null&&o!=null&&!(!g.hasData()||!o.hasData())&&g.demTexture!=null&&o.demTexture!=null&&g.tileID.key!==o.tileID.key}const Td=new class{constructor(){this.operations={}}newMorphing(g,o,d,m,S){if(g in this.operations){const A=this.operations[g];A.to.tileID.key!==d.tileID.key&&(A.queued=d)}else this.operations[g]={startTime:m,phase:0,duration:S,from:o,to:d,queued:null}}getMorphValuesForProxy(g){if(!(g in this.operations))return null;const o=this.operations[g];return{from:o.from,to:o.to,phase:o.phase}}update(g){for(const o in this.operations){const d=this.operations[o];for(d.phase=(g-d.startTime)/d.duration;d.phase>=1||!this._validOp(d);)if(!this._nextOp(d,g)){delete this.operations[o];break}}}_nextOp(g,o){return!!g.queued&&(g.from=g.to,g.to=g.queued,g.queued=null,g.phase=0,g.startTime=o,!0)}_validOp(g){return g.from.hasData()&&g.to.hasData()}},Oy={0:null,1:"TERRAIN_VERTEX_MORPHING"};function $v(g,o,d){if(o===0)return 0;const m=o<1&&d===514?.25/o:1;return 6*Math.pow(1.5,22-g)*Math.max(o,1)*m}function Gx(g,o){const d=1<<g.z;return!o&&(g.x===0||g.x===d-1)||g.y===0||g.y===d-1}const Gf=g=>({u_matrix:g});function Hf(g,o,d,m,S){if(S>0){const A=i.o.now(),k=(A-g.timeAdded)/S,N=o?(A-o.timeAdded)/S:-1,R=d.getSource(),V=m.coveringZoomLevel({tileSize:R.tileSize,roundZoom:R.roundZoom}),G=!o||Math.abs(o.tileID.overscaledZ-V)>Math.abs(g.tileID.overscaledZ-V),X=G&&g.refreshedUponExpiration?1:i.aA(G?k:1-N,0,1);return o?{opacity:1,mix:1-X,isFading:k<1}:{opacity:X,mix:0,isFading:k<1}}return{opacity:1,mix:0,isFading:!1}}class Hx extends qo{constructor(o){const d=Iu("mock-dem",{type:"raster-dem",maxzoom:o.transform.maxZoom},o.style.dispatcher,o.style);super("mock-dem",d,!1),d.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,d){o.state="loaded",d(null)}}class Oc extends qo{constructor(o){const d=Iu("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},o.style.dispatcher,o.style);super("proxy",d,!1),d.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,d,m){if(o.freezeTileCoverage)return;this.transform=o;const S=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((A,k)=>{if(A[k.key]="",!this._tiles[k.key]){const N=new Jc(k,this._source.tileSize*k.overscaleFactor(),o.tileZoom,void 0,void 0,this._source.worldview);N.state="loaded",this._tiles[k.key]=N}return A},{});for(const A in this._tiles)A in S||(this.freeFBO(A),this._tiles[A].unloadVectorData(),delete this._tiles[A])}freeFBO(o){const d=this.proxyCachedFBO[o];if(d!==void 0){const m=Object.values(d);this.renderCachePool.push(...m),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach(o=>o.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Fy extends i.aO{constructor(o,d,m){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=d,this.projMatrix=m}}class dg extends i.dH{constructor(o,d){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},o.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),o.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),o.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,S,A]=function(R){const V=new i.bd,G=new i.b1,X=131;V.reserve(17161),G.reserve(33800);const W=i.al/128,te=i.al+W/2,ie=te+W;for(let ve=-W;ve<ie;ve+=W)for(let ue=-W;ue<ie;ue+=W){const be=ue<0||ue>te||ve<0||ve>te?24575:0,Te=i.aA(Math.round(ue),0,i.al),ke=i.aA(Math.round(ve),0,i.al);V.emplaceBack(Te+be,ke)}const se=(ve,ue)=>{const be=ue*X+ve;G.emplaceBack(be+1,be,be+X),G.emplaceBack(be+X,be+X+1,be+1)};for(let ve=1;ve<129;ve++)for(let ue=1;ue<129;ue++)se(ue,ve);return[0,129].forEach(ve=>{for(let ue=0;ue<130;ue++)se(ue,ve),se(ve,ue)}),[V,G,32768]}(),k=o.context;this.gridBuffer=k.createVertexBuffer(m,i.bf.members),this.gridIndexBuffer=k.createIndexBuffer(S),this.gridSegments=i.bg.simpleSegment(0,0,m.length,S.length),this.gridNoSkirtSegments=i.bg.simpleSegment(0,0,m.length,A),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Oc(d.map),this.orthoMatrix=i.bC(),i.cd(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.al,0,i.al,0,1);const N=k.gl;this._overlapStencilMode=new sr({func:N.GEQUAL,mask:255},0,255,N.KEEP,N.KEEP,N.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=d,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Hx(d.map),this._pendingGroundEffectLayers=[]}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),this._style=o,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(o,d,m){if(o&&o.terrain){this._style!==o&&(this.style=o,this._evaluationZoom=void 0);const S=o.terrain.properties,A=o.terrain.drapeRenderMode===0,k=o.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.o.now();const N=o.terrain&&o.terrain.scope,R=S.get("source"),V=A?this._mockSourceCache:o.getSourceCache(R,N);if(!V)return void i.w(`Couldn't find terrain source "${R}".`);if(this.sourceCache=V,this._attenuationRange=o.terrain.getAttenuationRange(),this._exaggeration=k?this.calculateExaggeration(d):S.get("exaggeration"),!d.projection.requiresDraping&&k&&this._exaggeration===0)return void this._disable();this.enabled=!0;const G=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const X=this.getScaledDemTileSize();this.sourceCache.update(d,X,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,G(),this._initializing=!0),G(),d.updateElevation(!0,m),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(d),this._emptyDEMTextureDirty=!0,this._previousZoom=d.zoom}else this._disable()}calculateExaggeration(o){if(this._attenuationRange&&o.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(o.zoom);const d=this._previousCameraAltitude,m=o.getFreeCameraOptions().position.z/o.pixelsPerMeter*o.worldSize;this._previousCameraAltitude=m;const S=d!=null?m-d:Number.MAX_VALUE;if(Math.abs(S)<2)return this._exaggeration;const A=o.zoom,k=this._style.terrain;if(!this._previousUpdateTimestamp)return k.getExaggeration(A);let N=A-this._previousZoom;const R=this._previousUpdateTimestamp;let V=A;this._evaluationZoom!=null&&(V=this._evaluationZoom,Math.abs(A-V)>.5&&(N=.5*(A-V+N)),N*S<0&&(V+=N)),this._evaluationZoom=V;const G=k.getExaggeration(V),X=G===k.getExaggeration(Math.max(0,V-.1));if(X&&Math.abs(G-this._exaggeration)<.01)return G;let W=Math.min(.1,.00375*(this._updateTimestamp-R));return(X||G<.1||Math.abs(N)<1e-4)&&(W=Math.min(.2,4*W)),i.ak(this._exaggeration,G,W)}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(o){o.dataType==="source"&&o.coord?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._mergedSourceCaches)this._style._mergedSourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(o=>o.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const d=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=m._centerAltitude===0&&this.getAtPointOrZero(i.ae.fromLngLat(m.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const S=this.proxyCoords=d.getIds().map(R=>{const V=d.getTileByID(R).tileID;return V.projMatrix=m.calculateProjMatrix(V.toUnwrapped()),V});(function(R,V){const G=V.transform.pointCoordinate(V.transform.getCameraPoint()),X=new i.P(G.x,G.y);R.sort((W,te)=>{if(te.overscaledZ-W.overscaledZ)return te.overscaledZ-W.overscaledZ;const ie=new i.P(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),se=new i.P(te.canonical.x+(1<<te.canonical.z)*te.wrap,te.canonical.y),ve=X.mult(1<<W.canonical.z);return ve.x-=.5,ve.y-=.5,ve.distSqr(ie)-ve.distSqr(se)})})(S,this.painter);const A=this.proxyToSource||{};this.proxyToSource={},S.forEach(R=>{this.proxyToSource[R.key]={}}),this.terrainTileForTile={};const k=this._style._mergedSourceCaches;for(const R in k){const V=k[R];if(!V.used||(V!==this.sourceCache&&this.resetTileLookupCache(V.id),this._setupProxiedCoordsForOrtho(V,o[R],A),V.usedForTerrain))continue;const G=o[R];V.getSource().reparseOverscaled&&this._assignTerrainTiles(G)}this.proxiedCoords[d.id]=S.map(R=>new Fy(R,R.key,this.orthoMatrix)),this._assignTerrainTiles(S),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(A),this.renderingToTexture=!1;const N={};this._visibleDemTiles=[];for(const R of this.proxyCoords){const V=this.terrainTileForTile[R.key];if(!V)continue;const G=V.tileID.key;G in N||(this._visibleDemTiles.push(V),N[G]=G)}}_assignTerrainTiles(o){this._initializing||o.forEach(d=>{if(this.terrainTileForTile[d.key])return;const m=this._findTileCoveringTileID(d,this.sourceCache);m&&(this.terrainTileForTile[d.key]=m)})}_prepareDEMTextures(){const o=this.painter.context,d=o.gl;for(const m in this.terrainTileForTile){const S=this.terrainTileForTile[m],A=S.dem;!A||S.demTexture&&!S.needsDEMTextureUpload||(o.activeTexture.set(d.TEXTURE1),$f(this.painter,S,A))}}_prepareDemTileUniforms(o,d,m,S){if(!d||d.demTexture==null)return!1;const A=o.tileID.canonical,k=Math.pow(2,d.tileID.canonical.z-A.z),N=S||"";return m[`u_dem_tl${N}`]=[A.x*k%1,A.y*k%1],m[`u_dem_scale${N}`]=k,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let o=0;const d=this._visibleDemTiles.reduce((m,S)=>{if(!S.dem)return m;const A=S.dem.tree.minimums[0];return A>0&&o++,m+A},0);return o?d/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,d=o.gl;o.activeTexture.set(d.TEXTURE2);const m=this._getLoadedAreaMinimum(),S=new i.dI({width:1,height:1},new Float32Array([m]));this._emptyDEMTextureDirty=!1;let A=this._emptyDEMTexture;return A?A.update(S,{premultiply:!1}):A=this._emptyDEMTexture=new i.T(o,S,d.R32F,{premultiply:!1}),A}setupElevationDraw(o,d,m){const S=this.painter.context,A=S.gl,k={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};k.u_exaggeration=this.exaggeration();let N=null,R=null,V=1;if(m&&m.morphing&&this._useVertexMorphing){const te=m.morphing.srcDemTile,ie=m.morphing.dstDemTile;V=m.morphing.phase,te&&ie&&(this._prepareDemTileUniforms(o,te,k,"_prev")&&(R=te),this._prepareDemTileUniforms(o,ie,k)&&(N=ie))}const G=te=>te&&te.demTexture&&this.painter.linearFloatFilteringSupported()?A.LINEAR:A.NEAREST;let X=null;var W;if(this.enabled?R&&N?(X=N.demTexture,S.activeTexture.set(A.TEXTURE4),R.demTexture.bind(G(R),A.CLAMP_TO_EDGE),k.u_dem_lerp=V):(N=this.terrainTileForTile[o.tileID.key],X=this._prepareDemTileUniforms(o,N,k)?N.demTexture:this.emptyDEMTexture):X=this.emptyDEMTexture,S.activeTexture.set(A.TEXTURE2),X&&(k.u_dem_size=(W=X).size[0]===1?1:W.size[0]-2,X.bind(G(N),A.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(m&&m.useDepthForOcclusion,d,k),m&&m.useMeterToDem&&N){const te=(1<<N.tileID.canonical.z)*i.ce(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;k.u_meter_to_dem=te}if(m&&m.labelPlaneMatrixInv&&(k.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),d.setTerrainUniformValues(S,k),this.painter.transform.projection.name==="globe"){const te=this.globeUniformValues(this.painter.transform,o.tileID.canonical,m&&m.useDenormalizedUpVectorScale);d.setGlobeUniformValues(S,te)}}globeUniformValues(o,d,m){const S=o.projection;return{u_tile_tl_up:S.upVector(d,0,0),u_tile_tr_up:S.upVector(d,i.al,0),u_tile_br_up:S.upVector(d,i.al,i.al),u_tile_bl_up:S.upVector(d,0,i.al),u_tile_up_scale:m?i.dJ(1):S.upVectorScale(d,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){const d=this.painter,m=this.painter.context;o.length!==0&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,d.width,d.height]),d.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(S,A,k,N,R){if(S.transform.projection.name==="globe")(function(V,G,X,W,te){const ie=V.context,se=ie.gl;let ve,ue;const be=V.transform,Te=i.dA(V,ie,be),ke=(jt,bt)=>{if(ue===bt)return;const Dt=[Oy[bt],"PROJECTION_GLOBE_VIEW"];Te&&Dt.push("CUSTOM_ANTIALIASING");const gn=V.isTileAffectedByFog(jt);ve=V.getOrCreateProgram("globeRaster",{defines:Dt,overrideFog:gn}),ue=bt},Ue=V.colorModeForRenderPass(),Fe=new Ln(se.LEQUAL,Ln.ReadWrite,V.depthRangeFor3D);Td.update(te);const Ve=i.dB(be),ze=[i.aF(be.center.lng),i.aJ(be.center.lat)],Oe=V.globeSharedBuffers,Ge=[be.width*i.o.devicePixelRatio,be.height*i.o.devicePixelRatio],Tt=Float32Array.from(be.globeMatrix),ut={useDenormalizedUpVectorScale:!0};{const jt=V.transform,bt=$v(jt.zoom,G.exaggeration(),G.sourceCache._source.tileSize);ue=-1;const Dt=se.TRIANGLES;for(const gn of W){const St=X.getTile(gn),it=sr.disabled,Ut=G.prevTerrainTileForTile[gn.key],Nt=G.terrainTileForTile[gn.key];Gh(Ut,Nt)&&Td.newMorphing(gn.key,Ut,Nt,te,250),ie.activeTexture.set(se.TEXTURE0),St.texture&&St.texture.bind(se.LINEAR,se.CLAMP_TO_EDGE);const Qt=Td.getMorphValuesForProxy(gn.key),mn=Qt?1:0;Qt&&Object.assign(ut,{morphing:{srcDemTile:Qt.from,dstDemTile:Qt.to,phase:i.dz(Qt.phase)}});const Nn=i.dC(gn.canonical),dn=i.dD(Nn.getCenter().lat),rn=i.dE(gn.canonical,Nn,dn,jt.worldSize/jt._pixelsPerMercatorPixel),Qn=i.bk(i.dF(gn.canonical)),Kn=qf(jt.expandedFarZProjMatrix,Tt,Ve,Qn,i.aj(jt.zoom),ze,jt.frustumCorners.TL,jt.frustumCorners.TR,jt.frustumCorners.BR,jt.frustumCorners.BL,jt.globeCenterInViewSpace,jt.globeRadius,Ge,bt,jt._farZ,rn);if(ke(gn,mn),ve&&(G.setupElevationDraw(St,ve,ut),V.uploadCommonUniforms(ie,ve,gn.toUnwrapped()),Oe)){const[Jn,Zn,Er]=Oe.getGridBuffers(dn,bt!==0);ve.draw(V,Dt,Fe,it,Ue,hr.backCCW,Kn,"globe_raster",Jn,Zn,Er)}}}if(Oe&&(V.renderDefaultNorthPole||V.renderDefaultSouthPole)){const jt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Te&&jt.push("CUSTOM_ANTIALIASING"),ve=V.getOrCreateProgram("globeRaster",{defines:jt});for(const bt of W){const{x:Dt,y:gn,z:St}=bt.canonical,it=gn===0,Ut=gn===(1<<St)-1,[Nt,Qt,mn,Nn]=Oe.getPoleBuffers(St,!1);if(Nn&&(it||Ut)){const dn=X.getTile(bt);ie.activeTexture.set(se.TEXTURE0),dn.texture&&dn.texture.bind(se.LINEAR,se.CLAMP_TO_EDGE);let rn=i.dG(St,Dt,be);const Qn=i.bk(i.dF(bt.canonical)),Kn=(Jn,Zn)=>Jn.draw(V,se.TRIANGLES,Fe,sr.disabled,Ue,hr.disabled,qf(be.expandedFarZProjMatrix,rn,rn,Qn,0,ze,be.frustumCorners.TL,be.frustumCorners.TR,be.frustumCorners.BR,be.frustumCorners.BL,be.globeCenterInViewSpace,be.globeRadius,Ge,0,be._farZ),"globe_pole_raster",Zn,mn,Nn);G.setupElevationDraw(dn,ve,ut),V.uploadCommonUniforms(ie,ve,bt.toUnwrapped()),it&&V.renderDefaultNorthPole&&Kn(ve,Nt),Ut&&V.renderDefaultSouthPole&&(rn=i.cR(i.bC(),rn,[1,-1,1]),Kn(ve,Qt))}}}})(S,A,k,N,R);else{const V=S.context,G=V.gl;let X,W;const te=S.shadowRenderer,ie=fa(S,S.longestCutoffRange),se=Ue=>{if(W===Ue)return;const Fe=[];Fe.push(Oy[Ue]),ie.shouldRenderCutoff&&Fe.push("RENDER_CUTOFF"),te&&(Fe.push("RENDER_SHADOWS","DEPTH_TEXTURE"),te.useNormalOffset&&Fe.push("NORMAL_OFFSET")),X=S.getOrCreateProgram("terrainRaster",{defines:Fe}),W=Ue},ve=S.colorModeForRenderPass(),ue=new Ln(G.LEQUAL,Ln.ReadWrite,S.depthRangeFor3D);Td.update(R);const be=S.transform,Te=$v(be.zoom,A.exaggeration(),A.sourceCache._source.tileSize);let ke=[0,0,0];if(te){const Ue=S.style.directionalLight,Fe=S.style.ambientLight;Ue&&Fe&&(ke=Gl(S.style,Ue,Fe))}{W=-1;const Ue=G.TRIANGLES,[Fe,Ve]=[A.gridIndexBuffer,A.gridSegments];for(const ze of N){const Oe=k.getTile(ze),Ge=sr.disabled,Tt=A.prevTerrainTileForTile[ze.key],ut=A.terrainTileForTile[ze.key];Gh(Tt,ut)&&Td.newMorphing(ze.key,Tt,ut,R,250),V.activeTexture.set(G.TEXTURE0),Oe.texture&&Oe.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE);const jt=Td.getMorphValuesForProxy(ze.key),bt=jt?1:0;let Dt;jt&&(Dt={morphing:{srcDemTile:jt.from,dstDemTile:jt.to,phase:i.dz(jt.phase)}});const gn=Wp(ze.projMatrix,Gx(ze.canonical,be.renderWorldCopies)?Te/10:Te,ke);if(se(bt),!X)continue;A.setupElevationDraw(Oe,X,Dt);const St=ze.toUnwrapped();te&&te.setupShadows(St,X),S.uploadCommonUniforms(V,X,St,null,ie),X.draw(S,Ue,ue,Ge,ve,hr.backCCW,gn,"terrain_raster",A.gridBuffer,Fe,Ve)}}}}(d,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,d.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const d=this.painter,m=this.painter.context,S=this.proxySourceCache,A=this.proxiedCoords[S.id],k=this._drapedRenderBatches.shift(),N=d.style.order,R=[];let V=0;for(const G of A){const X=S.getTileByID(G.proxyTileKey),W=S.proxyCachedFBO[G.key]?S.proxyCachedFBO[G.key][o]:void 0,te=W!==void 0?S.renderCache[W]:this.pool[V++],ie=W!==void 0;if(X.texture=te.tex,ie&&!te.dirty){R.push(X.tileID);continue}let se;m.bindFramebuffer.set(te.fb.framebuffer),this.renderedToTile=!1,te.dirty&&(m.clear({color:i.ao.transparent,stencil:0}),te.dirty=!1);for(let ve=k.start;ve<=k.end;++ve){const ue=d.style._mergedLayers[N[ve]];if(ue.isHidden(d.transform.zoom))continue;const be=d.style.getLayerSourceCache(ue),Te=be?this.proxyToSource[G.key][be.id]:[G];if(!Te)continue;const ke=Te;m.viewport.set([0,0,te.fb.width,te.fb.height]),se!==(be?be.id:null)&&(this._setupStencil(te,Te,ue,be),se=be?be.id:null),d.renderLayer(d,be,ue,ke)}if(this._drapedRenderBatches.length===0)for(const ve of this._pendingGroundEffectLayers){const ue=d.style._mergedLayers[N[ve]];if(ue.isHidden(d.transform.zoom))continue;const be=d.style.getLayerSourceCache(ue),Te=be?this.proxyToSource[G.key][be.id]:[G];if(!Te)continue;const ke=Te;m.viewport.set([0,0,te.fb.width,te.fb.height]),se!==(be?be.id:null)&&(this._setupStencil(te,Te,ue,be),se=be?be.id:null),d.renderLayer(d,be,ue,ke)}this.renderedToTile?(te.dirty=!0,R.push(X.tileID)):ie||--V,V===5&&(V=0,this.renderToBackBuffer(R))}return this.renderToBackBuffer(R),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,d.width,d.height]),k.end+1}postRender(){}isLayerOrderingCorrect(o){const d=o.order.length;let m=-1,S=d;for(let A=0;A<d;++A)this._style.isLayerDraped(o._mergedLayers[o.order[A]])?m=Math.max(m,A):S=Math.min(S,A);return S>m}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter(d=>d.dem).forEach(d=>{o=Math.min(o,d.dem.tree.minimums[0])}),o===0?o:(o-30)*this._exaggeration}raycast(o,d,m){if(!this._visibleDemTiles)return null;const S=this._visibleDemTiles.filter(A=>A.dem).map(A=>{const k=A.tileID,N=1<<k.overscaledZ,{x:R,y:V}=k.canonical,G=R/N,X=(R+1)/N,W=V/N,te=(V+1)/N;return{minx:G,miny:W,maxx:X,maxy:te,t:A.dem.tree.raycastRoot(G,W,X,te,o,d,m),tile:A}});S.sort((A,k)=>(A.t!==null?A.t:Number.MAX_VALUE)-(k.t!==null?k.t:Number.MAX_VALUE));for(const A of S){if(A.t==null)return null;const k=A.tile.dem.tree.raycast(A.minx,A.miny,A.maxx,A.maxy,o,d,m);if(k!=null)return k}return null}_createFBO(){const o=this.painter.context,d=o.gl,m=this.drapeBufferSize;o.activeTexture.set(d.TEXTURE0);const S=new i.T(o,{width:m[0],height:m[1],data:null},d.RGBA8);S.bind(d.LINEAR,d.CLAMP_TO_EDGE);const A=o.createFramebuffer(m[0],m[1],!0,null);return A.colorAttachment.set(S.texture),A.depthAttachment=new e2(o,A.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,A.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):A.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&d.texParameterf(d.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:A,tex:S,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const o in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[o].hasTransition())return!0;return this._style.order.some(o=>{const d=this._style._mergedLayers[o],m=d.isHidden(this.painter.transform.zoom);return d.type==="hillshade"||d.type==="custom"?!m&&d.shouldRedrape():!m&&d.hasTransition()})}_clearLineLayersFromRenderCache(){let o=!1;for(const m of this._style.getSources())if(m instanceof $o){o=!0;break}if(!o)return;const d={};for(let m=0;m<this._style.order.length;++m){const S=this._style._mergedLayers[this._style.order[m]],A=this._style.getLayerSourceCache(S);if(A&&!d[A.id]&&!S.isHidden(this.painter.transform.zoom)&&S.type==="line"&&S.widthExpression()instanceof i.ad){d[A.id]=!0;for(const k of this.proxyCoords){const N=this.proxyToSource[k.key][A.id];if(N)for(const R of N)this._clearRenderCacheForTile(A.id,R)}}}}_clearRasterLayersFromRenderCache(){let o=!1;for(const m in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[m]._source instanceof Pa){o=!0;break}if(!o)return;const d={};for(let m=0;m<this._style.order.length;++m){const S=this._style._mergedLayers[this._style.order[m]],A=this._style.getLayerSourceCache(S);if(!A||d[A.id]||S.isHidden(this.painter.transform.zoom)||S.type!=="raster")continue;const k=S.paint.get("raster-fade-duration");for(const N of this.proxyCoords){const R=this.proxyToSource[N.key][A.id];if(R)for(const V of R){const G=Hf(A.getTile(V),A.findLoadedParent(V,0),A,this.painter.transform,k);(G.opacity!==1||G.mix!==0)&&this._clearRenderCacheForTile(A.id,V)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const o=this._style.order,d=o.length;if(d===0)return;const m=[];this._pendingGroundEffectLayers=[];let S,A=0,k=this._style._mergedLayers[o[A]];for(;!this._style.isLayerDraped(k)&&k.isHidden(this.painter.transform.zoom)&&++A<d;)k=this._style._mergedLayers[o[A]];for(;A<d;++A){const N=this._style._mergedLayers[o[A]];N.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(N)?S===void 0&&(S=A):(N.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(A),S!==void 0&&(m.push({start:S,end:A-1}),S=void 0)))}if(S!==void 0&&m.push({start:S,end:A-1}),m.length!==0){const N=m[m.length-1];this._pendingGroundEffectLayers.every(R=>R>N.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=m}_setupRenderCache(o){const d=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,d.renderCache.length>d.renderCachePool.length){const k=Object.values(d.proxyCachedFBO);d.proxyCachedFBO={};for(let N=0;N<k.length;++N){const R=Object.values(k[N]);d.renderCachePool.push(...R)}}return}this._clearRasterLayersFromRenderCache();const m=this.proxyCoords,S=this._tilesDirty;for(let k=m.length-1;k>=0;k--){const N=m[k];if(d.getTileByID(N.key),d.proxyCachedFBO[N.key]!==void 0){const R=o[N.key],V=this.proxyToSource[N.key];let G=0;for(const X in V){const W=V[X],te=R[X];if(!te||te.length!==W.length||W.some((ie,se)=>ie!==te[se]||S[X]&&S[X].hasOwnProperty(ie.key))){G=-1;break}++G}for(const X in d.proxyCachedFBO[N.key])d.renderCache[d.proxyCachedFBO[N.key][X]].dirty=G<0||G!==Object.values(R).length}}const A=[...this._drapedRenderBatches];A.sort((k,N)=>N.end-N.start-(k.end-k.start));for(const k of A)for(const N of m){if(d.proxyCachedFBO[N.key])continue;let R=d.renderCachePool.pop();R===void 0&&d.renderCache.length<50&&(R=d.renderCache.length,d.renderCache.push(this._createFBO())),R!==void 0&&(d.proxyCachedFBO[N.key]={},d.proxyCachedFBO[N.key][k.start]=R,d.renderCache[R].dirty=!0)}this._tilesDirty={}}_setupStencil(o,d,m,S){if(!S||!this._sourceTilesOverlap[S.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const A=this.painter.context,k=A.gl;if(d.length<=1)return void(this._overlapStencilType=!1);let N;if(m.isTileClipped())N=d.length,this._overlapStencilMode.test={func:k.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(d[0].overscaledZ>d[d.length-1].overscaledZ))return void(this._overlapStencilType=!1);N=1,this._overlapStencilMode.test={func:k.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+N>255&&(A.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=N,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(d,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):sr.disabled}_renderTileClippingMasks(o,d){const m=this.painter,S=this.painter.context,A=S.gl;m._tileClippingMaskIDs={},S.setColorMode(kr.disabled),S.setDepthMode(Ln.disabled);const k=m.getOrCreateProgram("clippingMask");for(const N of o){const R=m._tileClippingMaskIDs[N.key]=--d;k.draw(m,A.TRIANGLES,Ln.disabled,new sr({func:A.ALWAYS,mask:0},R,255,A.KEEP,A.KEEP,A.REPLACE),kr.disabled,hr.disabled,Gf(N.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(o){const d=this.painter.transform;if(o.x<0||o.x>d.width||o.y<0||o.y>d.height)return null;const m=[o.x,o.y,1,1];i.aC(m,m,d.pixelMatrixInverse),i.cJ(m,m,1/m[3]),m[0]/=d.worldSize,m[1]/=d.worldSize;const S=d._camera.position,A=i.ce(1,d.center.lat),k=[S[0],S[1],S[2]/A,0],N=i.d9([],m.slice(0,3),k);i.aw(N,N);const R=this.raycast(k,N,this._exaggeration);return R!==null&&R?(i.bH(k,k,N,R),k[3]=k[2],k[2]*=A,k):null}_setupProxiedCoordsForOrtho(o,d,m){if(o.getSource()instanceof i.aS)return this._setupProxiedCoordsForImageSource(o,d,m);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const S=this.proxiedCoords[o.id]=[],A=this.proxyCoords;for(let R=0;R<A.length;R++){const V=A[R],G=this._findTileCoveringTileID(V,o);if(G){const X=this._createProxiedId(V,G,m[V.key]&&m[V.key][o.id]);S.push(X),this.proxyToSource[V.key][o.id]=[X]}}let k=!1;const N=new Set;for(let R=0;R<d.length;R++){const V=o.getTile(d[R]);if(!V||!V.hasData())continue;const G=this._findTileCoveringTileID(V.tileID,this.proxySourceCache);if(G&&G.tileID.canonical.z!==V.tileID.canonical.z){const X=this.proxyToSource[G.tileID.key][o.id],W=this._createProxiedId(G.tileID,V,m[G.tileID.key]&&m[G.tileID.key][o.id]);X?X.splice(X.length-1,0,W):this.proxyToSource[G.tileID.key][o.id]=[W];const te=this.proxyToSource[G.tileID.key][o.id];N.has(te)||N.add(te),S.push(W),k=!0}}if(this._sourceTilesOverlap[o.id]=k,k&&this._debugParams.sortTilesHiZFirst)for(const R of N)R.sort((V,G)=>G.overscaledZ-V.overscaledZ)}_setupProxiedCoordsForImageSource(o,d,m){if(!o.getSource().loaded())return;const S=this.proxiedCoords[o.id]=[],A=this.proxyCoords,k=o.getSource(),N=k.tileID;if(!N)return;const R=new i.P(N.x,N.y)._div(1<<N.z),V=k.coordinates.map(i.ae.fromLngLat).reduce((X,W)=>(X.min.x=Math.min(X.min.x,W.x-R.x),X.min.y=Math.min(X.min.y,W.y-R.y),X.max.x=Math.max(X.max.x,W.x-R.x),X.max.y=Math.max(X.max.y,W.y-R.y),X),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),G=(X,W)=>{const te=X.wrap+X.canonical.x/(1<<X.canonical.z),ie=X.canonical.y/(1<<X.canonical.z),se=i.al/(1<<X.canonical.z),ve=W.wrap+W.canonical.x/(1<<W.canonical.z),ue=W.canonical.y/(1<<W.canonical.z);return te+se<ve+V.min.x||te>ve+V.max.x||ie+se<ue+V.min.y||ie>ue+V.max.y};for(let X=0;X<A.length;X++){const W=A[X];for(let te=0;te<d.length;te++){const ie=o.getTile(d[te]);if(!ie||!ie.hasData()||G(W,ie.tileID))continue;const se=this._createProxiedId(W,ie,m[W.key]&&m[W.key][o.id]),ve=this.proxyToSource[W.key][o.id];ve?ve.push(se):this.proxyToSource[W.key][o.id]=[se],S.push(se)}}}_createProxiedId(o,d,m){let S=this.orthoMatrix;if(m){const A=m.find(k=>k.key===d.tileID.key);if(A)return A}if(d.tileID.key!==o.key){const A=o.canonical.z-d.tileID.canonical.z;let k,N,R;S=i.bC();const V=d.tileID.wrap-o.wrap<<o.overscaledZ;A>0?(k=i.al>>A,N=k*((d.tileID.canonical.x<<A)-o.canonical.x+V),R=k*((d.tileID.canonical.y<<A)-o.canonical.y)):(k=i.al<<-A,N=i.al*(d.tileID.canonical.x-(o.canonical.x+V<<-A)),R=i.al*(d.tileID.canonical.y-(o.canonical.y<<-A))),i.cd(S,0,k,0,k,0,1),i.br(S,S,[N,R,0])}return new Fy(d.tileID,o.key,S)}_findTileCoveringTileID(o,d){let m=d.getTile(o);if(m&&m.hasData())return m;const S=this._findCoveringTileCache[d.id],A=S[o.key];if(m=A?d.getTileByID(A):null,m&&m.hasData()||A===null)return m;let k=m?m.tileID:o,N=k.overscaledZ;const R=d.getSource().minzoom,V=[];if(!A){const X=d.getSource().maxzoom;if(o.canonical.z>=X){const W=o.canonical.z-X;d.getSource().reparseOverscaled?(N=Math.max(o.canonical.z+2,d.transform.tileZoom),k=new i.aO(N,o.wrap,X,o.canonical.x>>W,o.canonical.y>>W)):W!==0&&(N=X,k=new i.aO(N,o.wrap,X,o.canonical.x>>W,o.canonical.y>>W))}k.key!==o.key&&(V.push(k.key),m=d.getTile(k))}const G=X=>{V.forEach(W=>{S[W]=X}),V.length=0};for(N-=1;N>=R&&(!m||!m.hasData());N--){m&&G(m.tileID.key);const X=k.calculateScaledKey(N);if(m=d.getTileByID(X),m&&m.hasData())break;const W=S[X];if(W===null)break;W===void 0?V.push(X):m=d.getTileByID(W)}return G(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,d){let m=this._tilesDirty[o];m||(m=this._tilesDirty[o]={}),m[d.key]=!0}}function hg(g,o,d){const m=function(N,R,V){const G=i.bJ(R,N),X=i.bJ(V,[.2126,.7152,.0722]),W=(ie,se,ve)=>(1-ve)*ie+ve*se,te=W(1-.3*Math.min(X,1),1,Math.min(G+1,1));return W(.92,1,Math.asin(i.aA(R[2],-1,1))/Math.PI+.5)*te}(g,[0,0,1],o),S=[0,0,0];i.c4(S,d.slice(0,3),m);const A=[0,0,0];i.c4(A,o.slice(0,3),g[2]);const k=[0,0,0];return i.d7(k,S,A),i.da(k)}const Zp=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],qv=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class zy{static cacheKey(o,d,m,S){let A=`${d}${S?S.cacheKey:""}`;for(const k of m)o.usedDefines.includes(k)&&(A+=`/${k}`);return A}constructor(o,d,m,S,A,k){const N=o.gl;this.program=N.createProgram(),this.configuration=S,this.name=d,this.fixedDefines=[...k];let R=S?S.defines():[];R=R.concat(k.map(ie=>`#define ${ie}`));const V=`#version 300 es
`;let G=V+R.concat("precision mediump float;",Dc,Vf.fragmentSource).join(`
`);for(const ie of m.fragmentIncludes)G+=`
${Uf[ie]}`;G+=`
${m.fragmentSource}`;let X=V+R.concat("precision highp float;",Dc,Vf.vertexSource).join(`
`);for(const ie of m.vertexIncludes)X+=`
${Uf[ie]}`;this.forceManualRenderingForInstanceIDShaders=o.forceManualRenderingForInstanceIDShaders&&m.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(X+=`
uniform int u_instanceID;
`),X+=`
${m.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(X=X.replaceAll("gl_InstanceID","u_instanceID"));const W=N.createShader(N.FRAGMENT_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);N.shaderSource(W,G),N.compileShader(W),N.attachShader(this.program,W);const te=N.createShader(N.VERTEX_SHADER);N.isContextLost()?this.failedToCreate=!0:(N.shaderSource(te,X),N.compileShader(te),N.attachShader(this.program,te),this.attributes={},N.linkProgram(this.program),N.deleteShader(te),N.deleteShader(W),this.fixedUniforms=A(o),this.binderUniforms=S?S.getUniforms(o):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(ie=>({u_instanceID:new i.cg(ie)}))(o)),(k.includes("TERRAIN")||d.indexOf("symbol")!==-1||d.indexOf("circle")!==-1)&&(this.terrainUniforms=(ie=>({u_dem:new i.cg(ie),u_dem_prev:new i.cg(ie),u_dem_tl:new i.cj(ie),u_dem_scale:new i.ci(ie),u_dem_tl_prev:new i.cj(ie),u_dem_scale_prev:new i.ci(ie),u_dem_size:new i.ci(ie),u_dem_lerp:new i.ci(ie),u_exaggeration:new i.ci(ie),u_depth:new i.cg(ie),u_depth_size_inv:new i.cj(ie),u_depth_range_unpack:new i.cj(ie),u_occluder_half_size:new i.ci(ie),u_occlusion_depth_offset:new i.ci(ie),u_meter_to_dem:new i.ci(ie),u_label_plane_matrix_inv:new i.ck(ie)}))(o)),k.includes("GLOBE")&&(this.globeUniforms=(ie=>({u_tile_tl_up:new i.ch(ie),u_tile_tr_up:new i.ch(ie),u_tile_br_up:new i.ch(ie),u_tile_bl_up:new i.ch(ie),u_tile_up_scale:new i.ci(ie)}))(o)),k.includes("FOG")&&(this.fogUniforms=(ie=>({u_fog_matrix:new i.ck(ie),u_fog_range:new i.cj(ie),u_fog_color:new i.d2(ie),u_fog_horizon_blend:new i.ci(ie),u_fog_vertical_limit:new i.cj(ie),u_fog_temporal_offset:new i.ci(ie),u_frustum_tl:new i.ch(ie),u_frustum_tr:new i.ch(ie),u_frustum_br:new i.ch(ie),u_frustum_bl:new i.ch(ie),u_globe_pos:new i.ch(ie),u_globe_radius:new i.ci(ie),u_globe_transition:new i.ci(ie),u_is_globe:new i.cg(ie),u_viewport:new i.cj(ie)}))(o)),k.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(ie=>({u_cutoff_params:new i.d2(ie)}))(o)),k.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(ie=>({u_lighting_ambient_color:new i.ch(ie),u_lighting_directional_dir:new i.ch(ie),u_lighting_directional_color:new i.ch(ie),u_ground_radiance:new i.ch(ie)}))(o)),k.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(ie=>({u_light_matrix_0:new i.ck(ie),u_light_matrix_1:new i.ck(ie),u_fade_range:new i.cj(ie),u_shadow_normal_offset:new i.ch(ie),u_shadow_intensity:new i.ci(ie),u_shadow_texel_size:new i.ci(ie),u_shadow_map_resolution:new i.ci(ie),u_shadow_direction:new i.ch(ie),u_shadow_bias:new i.ch(ie),u_shadowmap_0:new i.cg(ie),u_shadowmap_1:new i.cg(ie)}))(o)))}getAttributeLocation(o,d){let m=this.attributes[d];return m===void 0&&(m=this.attributes[d]=o.getAttribLocation(this.program,d)),m}setTerrainUniformValues(o,d){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in d)m[S]&&m[S].set(this.program,S,d[S])}}setGlobeUniformValues(o,d){if(!this.globeUniforms)return;const m=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in d)m[S]&&m[S].set(this.program,S,d[S])}}setFogUniformValues(o,d){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in d)m[S].set(this.program,S,d[S])}}setCutoffUniformValues(o,d){if(!this.cutoffUniforms)return;const m=this.cutoffUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in d)m[S].set(this.program,S,d[S])}}setLightsUniformValues(o,d){if(!this.lightsUniforms)return;const m=this.lightsUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in d)m[S].set(this.program,S,d[S])}}setShadowUniformValues(o,d){if(this.failedToCreate||!this.shadowUniforms)return;const m=this.shadowUniforms;o.program.set(this.program);for(const S in d)m[S].set(this.program,S,d[S])}_drawDebugWireframe(o,d,m,S,A,k,N,R,V,G){const X=o.options.wireframe;if(X.terrain===!1&&X.layers2D===!1&&X.layers3D===!1)return;const W=o.context;if(!(!(!X.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!X.layers2D||o._terrain&&o._terrain.renderingToTexture||!Zp.includes(this.name))||!(!X.layers3D||!qv.includes(this.name))))return;const te=W.gl,ie=o.wireframeDebugCache.getLinesFromTrianglesBuffer(o.frameCounter,A,W);if(!ie)return;const se=[...this.fixedDefines];se.push("DEBUG_WIREFRAME");const ve=o.getOrCreateProgram(this.name,{config:this.configuration,defines:se});W.program.set(ve.program);const ue=(ke,Ue,Fe)=>{if(Ue[ke]&&Fe[ke])for(const Ve in Ue[ke])Fe[ke][Ve]&&Fe[ke][Ve].set(Fe.program,Ve,Ue[ke][Ve].current)};V&&V.setUniforms(ve.program,W,ve.binderUniforms,N,{zoom:R}),ue("fixedUniforms",this,ve),ue("terrainUniforms",this,ve),ue("globeUniforms",this,ve),ue("fogUniforms",this,ve),ue("lightsUniforms",this,ve),ue("shadowUniforms",this,ve),ie.bind(),W.setColorMode(new kr([te.ONE,te.ONE_MINUS_SRC_ALPHA,te.ZERO,te.ONE],i.ao.transparent,[!0,!0,!0,!1])),W.setDepthMode(new Ln(d.func===te.LESS?te.LEQUAL:d.func,Ln.ReadOnly,d.range)),W.setStencilMode(sr.disabled);const be=3*k.primitiveLength*2,Te=3*k.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const ke=G||1;for(let Ue=0;Ue<ke;++Ue)ve.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ue),te.drawElements(te.LINES,be,te.UNSIGNED_SHORT,Te)}else G&&G>1?te.drawElementsInstanced(te.LINES,be,te.UNSIGNED_SHORT,Te,G):te.drawElements(te.LINES,be,te.UNSIGNED_SHORT,Te);A.bind(),W.program.set(this.program),W.setDepthMode(d),W.setStencilMode(m),W.setColorMode(S)}checkUniforms(o,d,m){if(this.fixedDefines.includes(d)){for(const S of Object.keys(m))if(!m[S].initialized)throw new Error(`Program '${this.name}', from draw '${o}': uniform ${S} not set but required by ${d} being defined`)}}draw(o,d,m,S,A,k,N,R,V,G,X,W,te,ie,se,ve){const ue=o.context,be=ue.gl;if(this.failedToCreate)return;ue.program.set(this.program),ue.setDepthMode(m),ue.setStencilMode(S),ue.setColorMode(A),ue.setCullFace(k);for(const Ue of Object.keys(this.fixedUniforms))this.fixedUniforms[Ue].set(this.program,Ue,N[Ue]);ie&&ie.setUniforms(this.program,ue,this.binderUniforms,W,{zoom:te});const Te={[be.POINTS]:1,[be.LINES]:2,[be.TRIANGLES]:3,[be.LINE_STRIP]:1}[d];this.checkUniforms(R,"RENDER_SHADOWS",this.shadowUniforms);const ke=ve&&ve>0?1:void 0;for(const Ue of X.get()){const Fe=Ue.vaos||(Ue.vaos={});if((Fe[R]||(Fe[R]=new nh)).bind(ue,this,V,ie?ie.getPaintVertexBuffers():[],G,Ue.vertexOffset,se||[],ke),this.forceManualRenderingForInstanceIDShaders){const Ve=ve||1;for(let ze=0;ze<Ve;++ze)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",ze),G?be.drawElements(d,Ue.primitiveLength*Te,be.UNSIGNED_SHORT,Ue.primitiveOffset*Te*2):be.drawArrays(d,Ue.vertexOffset,Ue.vertexLength)}else ve&&ve>1?be.drawElementsInstanced(d,Ue.primitiveLength*Te,be.UNSIGNED_SHORT,Ue.primitiveOffset*Te*2,ve):G?be.drawElements(d,Ue.primitiveLength*Te,be.UNSIGNED_SHORT,Ue.primitiveOffset*Te*2):be.drawArrays(d,Ue.vertexOffset,Ue.vertexLength);d===be.TRIANGLES&&G&&this._drawDebugWireframe(o,m,S,A,G,Ue,W,te,ie,ve)}}}function Kp(g,o,d=0){const m=Math.pow(2,o.tileID.overscaledZ),S=o.tileSize*Math.pow(2,g.transform.tileZoom)/m,A=S*(o.tileID.canonical.x+o.tileID.wrap*m),k=S*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture?o.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.ay(o,1,g.transform.tileZoom),u_pixel_coord_upper:[A>>16,k>>16],u_pixel_coord_lower:[65535&A,65535&k],u_pattern_transition:d}}const U={terrain:0,flat:1},Z=i.bC(),oe=(g,o,d,m,S,A,k,N,R,V,G,X,W,te,ie,se,ve,ue)=>{const be=o.style.light,Te=be.properties.get("position"),ke=[Te.x,Te.y,Te.z],Ue=i.dL();be.properties.get("anchor")==="viewport"&&(i.dM(Ue,-o.transform.angle),i.dN(ke,ke,Ue));const Fe=be.properties.get("color").toPremultipliedRenderColor(null),Ve=o.transform,ze={u_matrix:g,u_lightpos:ke,u_lightintensity:be.properties.get("intensity"),u_lightcolor:[Fe.r,Fe.g,Fe.b],u_vertical_gradient:+d,u_opacity:m,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Z,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:U[V],u_base_type:U[G],u_ao:S,u_edge_radius:A,u_width_scale:k,u_flood_light_color:ie,u_vertical_scale:se,u_flood_light_intensity:ve,u_ground_shadow_factor:ue};return Ve.projection.name==="globe"&&(ze.u_tile_id=[N.canonical.x,N.canonical.y,1<<N.canonical.z],ze.u_zoom_transition=X,ze.u_inv_rot_matrix=te,ze.u_merc_center=W,ze.u_up_dir=Ve.projection.upVector(new i.cC(0,0,0),W[0]*i.al,W[1]*i.al),ze.u_height_lift=R),ze},ye=(g,o,d,m,S,A)=>({u_matrix:g,u_edge_radius:o,u_width_scale:d,u_vertical_scale:m,u_height_type:U[S],u_base_type:U[A]}),Ne=(g,o,d,m,S,A,k,N,R,V,G,X,W,te,ie,se,ve,ue)=>{const be=oe(g,o,d,m,S,A,k,N,V,G,X,W,te,ie,se,ve,1,[0,0,0]),Te={u_height_factor:-Math.pow(2,N.overscaledZ)/R.tileSize/8};return Object.assign(be,Kp(o,R,ue),Te)},Be=(g,o,d)=>({u_matrix:g,u_emissive_strength:o,u_ground_shadow_factor:d}),$e=(g,o,d,m,S,A=0)=>Object.assign(Be(g,o,S),Kp(d,m,A)),Je=(g,o,d,m)=>({u_matrix:g,u_world:d,u_emissive_strength:o,u_ground_shadow_factor:m}),rt=(g,o,d,m,S,A,k=0)=>Object.assign($e(g,o,d,m,A,k),{u_world:S}),ft=(g,o)=>({u_matrix:g,u_ground_shadow_factor:o}),Bt=(g,o,d,m,S)=>({u_matrix:g,u_camera_pos:[o[0],o[1],o[2]],u_depth_bias:d,u_height_scale:m,u_reset_depth:S}),pn=(g,o,d,m,S,A,k)=>({u_matrix:g,u_normal_matrix:o,u_opacity:d,u_faux_facade_ao_intensity:m,u_camera_pos:S,u_tile_to_meter:A,u_facade_emissive_chance:k}),pt=g=>({u_matrix:g}),Gt=g=>({u_matrix:g}),tn=(g,o,d,m,S,A,k,N)=>{const R=i.al/A.tileSize;return{u_matrix:g,u_inv_rot_matrix:o,u_camera_to_center_distance:d.getCameraToCenterDistance(N),u_extrude_scale:[d.pixelsToGLUnits[0]/R,d.pixelsToGLUnits[1]/R],u_zoom_transition:m,u_tile_id:k,u_merc_center:S}},In=(g,o,d=1)=>({u_matrix:g,u_color:o,u_overlay:0,u_overlay_scale:d}),sn=i.bC(),Dn=(g,o,d,m,S,A,k)=>{const N=g.transform,R=N.projection.name==="globe",V=R?i.dO(N.zoom,o.canonical)*N._pixelsPerMercatorPixel:i.ay(d,1,A),G={u_matrix:o.projMatrix,u_extrude_scale:V,u_intensity:k,u_inv_rot_matrix:sn,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(R){G.u_inv_rot_matrix=m,G.u_merc_center=S,G.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],G.u_zoom_transition=i.aj(N.zoom);const X=S[0]*i.al,W=S[1]*i.al;G.u_up_dir=N.projection.upVector(new i.cC(0,0,0),X,W)}return G};function jn(g,[o,d,m,S],[A,k]){if(A===k)return[0,0,0,0];const N=255*(g-1)/(g*(k-A));return[o*N,d*N,m*N,S*N]}function rr(g,o,[d,m]){return d===m?0:.5/g+(o-d)*(g-1)/(g*(m-d))}const Hn=(g,o,d,m,S,A,k,N,R,V,G,X,W,te,ie,se,ve,ue,be,Te,ke)=>({u_matrix:g,u_normalize_matrix:o,u_globe_matrix:d,u_merc_matrix:m,u_grid_matrix:S,u_tl_parent:A,u_scale_parent:V,u_fade_t:G.mix,u_opacity:G.opacity*X.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:X.paint.get("raster-brightness-min"),u_brightness_high:X.paint.get("raster-brightness-max"),u_saturation_factor:i.dQ(X.paint.get("raster-saturation")),u_contrast_factor:i.dP(X.paint.get("raster-contrast")),u_spin_weights:ei(X.paint.get("raster-hue-rotate")),u_perspective_transform:W,u_raster_elevation:te,u_zoom_transition:k,u_merc_center:N,u_cutoff_params:R,u_colorization_mix:jn(i.dR,se,ue),u_colorization_offset:rr(i.dR,ve,ue),u_color_ramp:ie,u_texture_offset:[Te/(be+2*Te),be/(be+2*Te)],u_texture_res:[be+2*Te,be+2*Te],u_emissive_strength:ke});function ei(g){g*=Math.PI/180;const o=Math.sin(g),d=Math.cos(g);return[(2*d+1)/3,(-Math.sqrt(3)*o-d+1)/3,(Math.sqrt(3)*o-d+1)/3]}const Rr=.05,Di=(g,o,d,m,S,A,k,N,R,V,G,X)=>({u_matrix:g,u_normalize_matrix:o,u_globe_matrix:d,u_merc_matrix:m,u_grid_matrix:S,u_tl_parent:A,u_scale_parent:V,u_fade_t:G.mix,u_opacity:G.opacity,u_image0:0,u_image1:1,u_raster_elevation:X,u_zoom_transition:k,u_merc_center:N,u_cutoff_params:R}),ri=(g,o,d,m,S,A,k,N,R,V)=>({u_particle_texture:g,u_particle_texture_side_len:o,u_tile_offset:d,u_velocity:m,u_color_ramp:A,u_velocity_res:S,u_max_speed:k,u_uv_offset:N,u_data_scale:[255*R[0],255*R[1]],u_data_offset:V,u_particle_pos_scale:1.1,u_particle_pos_offset:[Rr,Rr]}),ps=(g,o,d,m,S,A,k,N,R,V)=>({u_particle_texture:g,u_particle_texture_side_len:o,u_velocity:d,u_velocity_res:m,u_max_speed:S,u_speed_factor:A,u_reset_rate:k,u_rand_seed:Math.random(),u_uv_offset:N,u_data_scale:[255*R[0],255*R[1]],u_data_offset:V,u_particle_pos_scale:1.1,u_particle_pos_offset:[Rr,Rr]}),mo=i.bC(),Zi=(g,o,d,m,S,A,k,N,R,V,G,X,W,te,ie,se,ve,ue,be,Te,ke,Ue,Fe,Ve)=>{const ze=S.transform,Oe={u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:ze.getCameraToCenterDistance(be),u_rotate_symbol:+d,u_aspect_ratio:ze.width/ze.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:A,u_label_plane_matrix:k,u_coord_matrix:N,u_is_text:+V,u_elevation_from_sea:R?1:0,u_pitch_with_map:+m,u_texsize:G,u_texsize_icon:X,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:mo,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:mo,u_up_vector:[0,-1,0],u_color_adj_mat:Ue,u_icon_transition:Fe||0,u_gamma_scale:m?S.transform.getCameraToCenterDistance(be)*Math.cos(S.terrain?0:S.transform._pitch):1,u_device_pixel_ratio:i.o.devicePixelRatio,u_is_halo:1,u_scale_factor:Ve||1,u_ground_shadow_factor:Te,u_inv_matrix:i.bl(i.bC(),k),u_normal_scale:ke,u_lutTexture:Ms.LUT};return be.name==="globe"&&(Oe.u_tile_id=[te.canonical.x,te.canonical.y,1<<te.canonical.z],Oe.u_zoom_transition=ie,Oe.u_inv_rot_matrix=ve,Oe.u_merc_center=se,Oe.u_camera_forward=ze._camera.forward(),Oe.u_ecef_origin=i.dS(ze.globeMatrix,te.toUnwrapped()),Oe.u_tile_matrix=Float32Array.from(ze.globeMatrix),Oe.u_up_vector=ue),Oe},ti=(g,o,d,m)=>({u_matrix:g,u_emissive_strength:o,u_opacity:d,u_color:m}),_r=(g,o,d,m,S,A,k,N,R)=>Object.assign(function(V,G,X,W,te,ie){const{width:se,height:ve}=W.imageManager.getPixelSize(G),ue=Math.pow(2,ie.tileID.overscaledZ),be=ie.tileSize*Math.pow(2,W.transform.tileZoom)/ue,Te=be*(ie.tileID.canonical.x+ie.tileID.wrap*ue),ke=be*ie.tileID.canonical.y;return{u_image:0,u_pattern_tl:X.tl,u_pattern_br:X.br,u_texsize:[se,ve],u_pattern_size:X.displaySize,u_pattern_units_to_pixels:te?[W.transform.width,-1*W.transform.height]:[1/i.ay(ie,1,W.transform.tileZoom),1/i.ay(ie,1,W.transform.tileZoom)],u_pixel_coord_upper:[Te>>16,ke>>16],u_pixel_coord_lower:[65535&Te,65535&ke]}}(0,A,k,m,N,R),{u_matrix:g,u_emissive_strength:o,u_opacity:d}),Ha=new Float32Array(i.bA([])),Fi=(g,o,d,m,S,A,k,N,R,V,G,X,W,te=[0,0,0],ie)=>{const se=S.style.light,ve=se.properties.get("position"),ue=[-ve.x,-ve.y,ve.z],be=i.dL();se.properties.get("anchor")==="viewport"&&(i.dM(be,-S.transform.angle),i.dN(ue,ue,be));const Te=G.alphaMode==="MASK",ke=se.properties.get("color").toNonPremultipliedRenderColor(null),Ue=W.paint.get("model-ambient-occlusion-intensity"),Fe=W.paint.get("model-color").constantOr(i.ao.white).toNonPremultipliedRenderColor(null);return Fe.a=W.paint.get("model-color-mix-intensity").constantOr(0),{u_matrix:g,u_lighting_matrix:o,u_normal_matrix:d,u_node_matrix:m||Ha,u_lightpos:ue,u_lightintensity:se.properties.get("intensity"),u_lightcolor:[ke.r,ke.g,ke.b],u_camera_pos:te,u_opacity:A,u_baseTextureIsAlpha:0,u_alphaMask:+Te,u_alphaCutoff:G.alphaCutoff,u_baseColorFactor:k.toNonPremultipliedRenderColor(null).toArray01(),u_emissiveFactor:N.toNonPremultipliedRenderColor(null).toArray01(),u_metallicFactor:R,u_roughnessFactor:V,u_baseColorTexture:Ms.BaseColor,u_metallicRoughnessTexture:Ms.MetallicRoughness,u_normalTexture:Ms.Normal,u_occlusionTexture:Ms.Occlusion,u_emissionTexture:Ms.Emission,u_lutTexture:Ms.LUT,u_color_mix:Fe.toArray01(),u_aoIntensity:Ue,u_emissive_strength:X,u_occlusionTextureTransform:ie||[0,0,0,0]}},ds=(g,o=Ha,d=Ha)=>({u_matrix:g,u_instance:o,u_node_matrix:d}),Ia={fillExtrusion:g=>({u_matrix:new i.ck(g),u_lightpos:new i.ch(g),u_lightintensity:new i.ci(g),u_lightcolor:new i.ch(g),u_vertical_gradient:new i.ci(g),u_opacity:new i.ci(g),u_edge_radius:new i.ci(g),u_width_scale:new i.ci(g),u_ao:new i.cj(g),u_height_type:new i.cg(g),u_base_type:new i.cg(g),u_tile_id:new i.ch(g),u_zoom_transition:new i.ci(g),u_inv_rot_matrix:new i.ck(g),u_merc_center:new i.cj(g),u_up_dir:new i.ch(g),u_height_lift:new i.ci(g),u_flood_light_color:new i.ch(g),u_vertical_scale:new i.ci(g),u_flood_light_intensity:new i.ci(g),u_ground_shadow_factor:new i.ch(g)}),fillExtrusionDepth:g=>({u_matrix:new i.ck(g),u_edge_radius:new i.ci(g),u_width_scale:new i.ci(g),u_vertical_scale:new i.ci(g),u_height_type:new i.cg(g),u_base_type:new i.cg(g)}),fillExtrusionPattern:g=>({u_matrix:new i.ck(g),u_lightpos:new i.ch(g),u_lightintensity:new i.ci(g),u_lightcolor:new i.ch(g),u_vertical_gradient:new i.ci(g),u_height_factor:new i.ci(g),u_edge_radius:new i.ci(g),u_width_scale:new i.ci(g),u_ao:new i.cj(g),u_height_type:new i.cg(g),u_base_type:new i.cg(g),u_tile_id:new i.ch(g),u_zoom_transition:new i.ci(g),u_inv_rot_matrix:new i.ck(g),u_merc_center:new i.cj(g),u_up_dir:new i.ch(g),u_height_lift:new i.ci(g),u_image:new i.cg(g),u_texsize:new i.cj(g),u_pixel_coord_upper:new i.cj(g),u_pixel_coord_lower:new i.cj(g),u_tile_units_to_pixels:new i.ci(g),u_opacity:new i.ci(g),u_pattern_transition:new i.ci(g)}),fillExtrusionGroundEffect:g=>({u_matrix:new i.ck(g),u_opacity:new i.ci(g),u_ao_pass:new i.ci(g),u_meter_to_tile:new i.ci(g),u_ao:new i.cj(g),u_flood_light_intensity:new i.ci(g),u_flood_light_color:new i.ch(g),u_attenuation:new i.ci(g),u_edge_radius:new i.ci(g),u_fb:new i.cg(g),u_fb_size:new i.ci(g),u_dynamic_offset:new i.ci(g)}),fill:g=>({u_matrix:new i.ck(g),u_emissive_strength:new i.ci(g),u_ground_shadow_factor:new i.ch(g)}),fillPattern:g=>({u_matrix:new i.ck(g),u_emissive_strength:new i.ci(g),u_image:new i.cg(g),u_texsize:new i.cj(g),u_pixel_coord_upper:new i.cj(g),u_pixel_coord_lower:new i.cj(g),u_tile_units_to_pixels:new i.ci(g),u_ground_shadow_factor:new i.ch(g),u_pattern_transition:new i.ci(g)}),fillOutline:g=>({u_matrix:new i.ck(g),u_emissive_strength:new i.ci(g),u_world:new i.cj(g),u_ground_shadow_factor:new i.ch(g)}),fillOutlinePattern:g=>({u_matrix:new i.ck(g),u_emissive_strength:new i.ci(g),u_world:new i.cj(g),u_image:new i.cg(g),u_texsize:new i.cj(g),u_pixel_coord_upper:new i.cj(g),u_pixel_coord_lower:new i.cj(g),u_tile_units_to_pixels:new i.ci(g),u_ground_shadow_factor:new i.ch(g),u_pattern_transition:new i.ci(g)}),building:g=>({u_matrix:new i.ck(g),u_normal_matrix:new i.ck(g),u_opacity:new i.ci(g),u_faux_facade_ao_intensity:new i.ci(g),u_camera_pos:new i.ch(g),u_tile_to_meter:new i.ci(g),u_facade_emissive_chance:new i.ci(g)}),buildingBloom:g=>({u_matrix:new i.ck(g)}),buildingDepth:g=>({u_matrix:new i.ck(g)}),elevatedStructuresDepth:g=>({u_matrix:new i.ck(g),u_depth_bias:new i.ci(g)}),elevatedStructures:g=>({u_matrix:new i.ck(g),u_ground_shadow_factor:new i.ch(g)}),elevatedStructuresDepthReconstruct:g=>({u_matrix:new i.ck(g),u_camera_pos:new i.ch(g),u_depth_bias:new i.ci(g),u_height_scale:new i.ci(g),u_reset_depth:new i.ci(g)}),circle:i.dV,collisionBox:g=>({u_matrix:new i.ck(g),u_inv_rot_matrix:new i.ck(g),u_camera_to_center_distance:new i.ci(g),u_extrude_scale:new i.cj(g),u_zoom_transition:new i.ci(g),u_merc_center:new i.cj(g),u_tile_id:new i.ch(g)}),collisionCircle:g=>({u_matrix:new i.ck(g),u_inv_matrix:new i.ck(g),u_camera_to_center_distance:new i.ci(g),u_viewport_size:new i.cj(g)}),debug:g=>({u_color:new i.dx(g),u_matrix:new i.ck(g),u_overlay:new i.cg(g),u_overlay_scale:new i.ci(g)}),clippingMask:g=>({u_matrix:new i.ck(g)}),heatmap:g=>({u_extrude_scale:new i.ci(g),u_intensity:new i.ci(g),u_matrix:new i.ck(g),u_inv_rot_matrix:new i.ck(g),u_merc_center:new i.cj(g),u_tile_id:new i.ch(g),u_zoom_transition:new i.ci(g),u_up_dir:new i.ch(g)}),heatmapTexture:g=>({u_image:new i.cg(g),u_color_ramp:new i.cg(g),u_opacity:new i.ci(g)}),hillshade:g=>({u_matrix:new i.ck(g),u_image:new i.cg(g),u_latrange:new i.cj(g),u_light:new i.cj(g),u_shadow:new i.dx(g),u_highlight:new i.dx(g),u_emissive_strength:new i.ci(g),u_accent:new i.dx(g)}),hillshadePrepare:g=>({u_matrix:new i.ck(g),u_image:new i.cg(g),u_dimension:new i.cj(g),u_zoom:new i.ci(g)}),line:i.dU,linePattern:i.dT,raster:g=>({u_matrix:new i.ck(g),u_normalize_matrix:new i.ck(g),u_globe_matrix:new i.ck(g),u_merc_matrix:new i.ck(g),u_grid_matrix:new i.dy(g),u_tl_parent:new i.cj(g),u_scale_parent:new i.ci(g),u_fade_t:new i.ci(g),u_opacity:new i.ci(g),u_image0:new i.cg(g),u_image1:new i.cg(g),u_brightness_low:new i.ci(g),u_brightness_high:new i.ci(g),u_saturation_factor:new i.ci(g),u_contrast_factor:new i.ci(g),u_spin_weights:new i.ch(g),u_perspective_transform:new i.cj(g),u_raster_elevation:new i.ci(g),u_zoom_transition:new i.ci(g),u_merc_center:new i.cj(g),u_cutoff_params:new i.d2(g),u_colorization_mix:new i.d2(g),u_colorization_offset:new i.ci(g),u_color_ramp:new i.cg(g),u_texture_offset:new i.cj(g),u_texture_res:new i.cj(g),u_emissive_strength:new i.ci(g)}),rasterParticle:g=>({u_matrix:new i.ck(g),u_normalize_matrix:new i.ck(g),u_globe_matrix:new i.ck(g),u_merc_matrix:new i.ck(g),u_grid_matrix:new i.dy(g),u_tl_parent:new i.cj(g),u_scale_parent:new i.ci(g),u_fade_t:new i.ci(g),u_opacity:new i.ci(g),u_image0:new i.cg(g),u_image1:new i.cg(g),u_raster_elevation:new i.ci(g),u_zoom_transition:new i.ci(g),u_merc_center:new i.cj(g),u_cutoff_params:new i.d2(g)}),rasterParticleTexture:g=>({u_texture:new i.cg(g),u_opacity:new i.ci(g)}),rasterParticleDraw:g=>({u_particle_texture:new i.cg(g),u_particle_texture_side_len:new i.ci(g),u_tile_offset:new i.cj(g),u_velocity:new i.cg(g),u_color_ramp:new i.cg(g),u_velocity_res:new i.cj(g),u_max_speed:new i.ci(g),u_uv_offset:new i.cj(g),u_data_scale:new i.cj(g),u_data_offset:new i.ci(g),u_particle_pos_scale:new i.ci(g),u_particle_pos_offset:new i.cj(g)}),rasterParticleUpdate:g=>({u_particle_texture:new i.cg(g),u_particle_texture_side_len:new i.ci(g),u_velocity:new i.cg(g),u_velocity_res:new i.cj(g),u_max_speed:new i.ci(g),u_speed_factor:new i.ci(g),u_reset_rate:new i.ci(g),u_rand_seed:new i.ci(g),u_uv_offset:new i.cj(g),u_data_scale:new i.cj(g),u_data_offset:new i.ci(g),u_particle_pos_scale:new i.ci(g),u_particle_pos_offset:new i.cj(g)}),symbol:g=>({u_is_size_zoom_constant:new i.cg(g),u_is_size_feature_constant:new i.cg(g),u_size_t:new i.ci(g),u_size:new i.ci(g),u_camera_to_center_distance:new i.ci(g),u_rotate_symbol:new i.cg(g),u_aspect_ratio:new i.ci(g),u_fade_change:new i.ci(g),u_matrix:new i.ck(g),u_label_plane_matrix:new i.ck(g),u_coord_matrix:new i.ck(g),u_is_text:new i.cg(g),u_elevation_from_sea:new i.cg(g),u_pitch_with_map:new i.cg(g),u_texsize:new i.cj(g),u_texsize_icon:new i.cj(g),u_texture:new i.cg(g),u_texture_icon:new i.cg(g),u_gamma_scale:new i.ci(g),u_device_pixel_ratio:new i.ci(g),u_tile_id:new i.ch(g),u_zoom_transition:new i.ci(g),u_inv_rot_matrix:new i.ck(g),u_merc_center:new i.cj(g),u_camera_forward:new i.ch(g),u_tile_matrix:new i.ck(g),u_up_vector:new i.ch(g),u_ecef_origin:new i.ch(g),u_is_halo:new i.cg(g),u_icon_transition:new i.ci(g),u_color_adj_mat:new i.ck(g),u_scale_factor:new i.ci(g),u_ground_shadow_factor:new i.ch(g),u_inv_matrix:new i.ck(g),u_normal_scale:new i.ci(g),u_lutTexture:new i.cg(g)}),background:g=>({u_matrix:new i.ck(g),u_emissive_strength:new i.ci(g),u_opacity:new i.ci(g),u_color:new i.dx(g)}),backgroundPattern:g=>({u_matrix:new i.ck(g),u_emissive_strength:new i.ci(g),u_opacity:new i.ci(g),u_image:new i.cg(g),u_pattern_tl:new i.cj(g),u_pattern_br:new i.cj(g),u_texsize:new i.cj(g),u_pattern_size:new i.cj(g),u_pixel_coord_upper:new i.cj(g),u_pixel_coord_lower:new i.cj(g),u_pattern_units_to_pixels:new i.cj(g)}),terrainRaster:g=>({u_matrix:new i.ck(g),u_image0:new i.cg(g),u_skirt_height:new i.ci(g),u_ground_shadow_factor:new i.ch(g)}),skybox:g=>({u_matrix:new i.ck(g),u_sun_direction:new i.ch(g),u_cubemap:new i.cg(g),u_opacity:new i.ci(g),u_temporal_offset:new i.ci(g)}),skyboxGradient:g=>({u_matrix:new i.ck(g),u_color_ramp:new i.cg(g),u_center_direction:new i.ch(g),u_radius:new i.ci(g),u_opacity:new i.ci(g),u_temporal_offset:new i.ci(g)}),skyboxCapture:g=>({u_matrix_3f:new i.dy(g),u_sun_direction:new i.ch(g),u_sun_intensity:new i.ci(g),u_color_tint_r:new i.d2(g),u_color_tint_m:new i.d2(g),u_luminance:new i.ci(g)}),globeRaster:g=>({u_proj_matrix:new i.ck(g),u_globe_matrix:new i.ck(g),u_normalize_matrix:new i.ck(g),u_merc_matrix:new i.ck(g),u_zoom_transition:new i.ci(g),u_merc_center:new i.cj(g),u_image0:new i.cg(g),u_grid_matrix:new i.dy(g),u_skirt_height:new i.ci(g),u_far_z_cutoff:new i.ci(g),u_frustum_tl:new i.ch(g),u_frustum_tr:new i.ch(g),u_frustum_br:new i.ch(g),u_frustum_bl:new i.ch(g),u_globe_pos:new i.ch(g),u_globe_radius:new i.ci(g),u_viewport:new i.cj(g)}),globeAtmosphere:g=>({u_frustum_tl:new i.ch(g),u_frustum_tr:new i.ch(g),u_frustum_br:new i.ch(g),u_frustum_bl:new i.ch(g),u_horizon:new i.ci(g),u_transition:new i.ci(g),u_fadeout_range:new i.ci(g),u_atmosphere_fog_color:new i.d2(g),u_high_color:new i.d2(g),u_space_color:new i.d2(g),u_temporal_offset:new i.ci(g),u_horizon_angle:new i.ci(g)}),model:g=>({u_matrix:new i.ck(g),u_lighting_matrix:new i.ck(g),u_normal_matrix:new i.ck(g),u_node_matrix:new i.ck(g),u_lightpos:new i.ch(g),u_lightintensity:new i.ci(g),u_lightcolor:new i.ch(g),u_camera_pos:new i.ch(g),u_opacity:new i.ci(g),u_baseColorFactor:new i.d2(g),u_emissiveFactor:new i.d2(g),u_metallicFactor:new i.ci(g),u_roughnessFactor:new i.ci(g),u_baseTextureIsAlpha:new i.cg(g),u_alphaMask:new i.cg(g),u_alphaCutoff:new i.ci(g),u_baseColorTexture:new i.cg(g),u_metallicRoughnessTexture:new i.cg(g),u_normalTexture:new i.cg(g),u_occlusionTexture:new i.cg(g),u_emissionTexture:new i.cg(g),u_lutTexture:new i.cg(g),u_color_mix:new i.d2(g),u_aoIntensity:new i.ci(g),u_emissive_strength:new i.ci(g),u_occlusionTextureTransform:new i.d2(g)}),modelDepth:g=>({u_matrix:new i.ck(g),u_instance:new i.ck(g),u_node_matrix:new i.ck(g)}),groundShadow:g=>({u_matrix:new i.ck(g),u_ground_shadow_factor:new i.ch(g)}),stars:g=>({u_matrix:new i.ck(g),u_up:new i.ch(g),u_right:new i.ch(g),u_intensity_multiplier:new i.ci(g)}),snowParticle:g=>({u_modelview:new i.ck(g),u_projection:new i.ck(g),u_time:new i.ci(g),u_cam_pos:new i.ch(g),u_velocityConeAperture:new i.ci(g),u_velocity:new i.ci(g),u_horizontalOscillationRadius:new i.ci(g),u_horizontalOscillationRate:new i.ci(g),u_boxSize:new i.ci(g),u_billboardSize:new i.ci(g),u_simpleShapeParameters:new i.cj(g),u_screenSize:new i.cj(g),u_thinningCenterPos:new i.cj(g),u_thinningShape:new i.ch(g),u_thinningAffectedRatio:new i.ci(g),u_thinningParticleOffset:new i.ci(g),u_particleColor:new i.d2(g),u_direction:new i.ch(g)}),rainParticle:g=>({u_modelview:new i.ck(g),u_projection:new i.ck(g),u_time:new i.ci(g),u_cam_pos:new i.ch(g),u_texScreen:new i.cg(g),u_velocityConeAperture:new i.ci(g),u_velocity:new i.ci(g),u_boxSize:new i.ci(g),u_rainDropletSize:new i.cj(g),u_distortionStrength:new i.ci(g),u_rainDirection:new i.ch(g),u_color:new i.d2(g),u_screenSize:new i.cj(g),u_thinningCenterPos:new i.cj(g),u_thinningShape:new i.ch(g),u_thinningAffectedRatio:new i.ci(g),u_thinningParticleOffset:new i.ci(g),u_shapeDirectionalPower:new i.ci(g),u_shapeNormalPower:new i.ci(g),u_mode:new i.ci(g)}),vignette:g=>({u_vignetteShape:new i.ch(g),u_vignetteColor:new i.d2(g)}),occlusion:g=>({u_matrix:new i.ck(g),u_anchorPos:new i.ch(g),u_screenSizePx:new i.cj(g),u_occluderSizePx:new i.cj(g),u_color:new i.d2(g)})};class Fa{constructor(o,d,m,S){this.id=Fa.uniqueIdxCounter,Fa.uniqueIdxCounter++,this.context=o;const A=o.gl;this.buffer=A.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),A.bufferData(A.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||S||d.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){this.id=Fa.uniqueIdxCounter,Fa.uniqueIdxCounter++;const d=this.context.gl;this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Fa.uniqueIdxCounter=0;const Il={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class io{constructor(o,d,m,S,A,k){this.length=d.length,this.attributes=m,this.itemSize=d.bytesPerElement,this.dynamicDraw=S,this.instanceCount=k,this.context=o;const N=o.gl;this.buffer=N.createBuffer(),o.bindVertexBuffer.set(this.buffer),N.bufferData(N.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?N.DYNAMIC_DRAW:N.STATIC_DRAW),this.dynamicDraw||A||d.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,d){for(let m=0;m<this.attributes.length;m++){const S=d.getAttributeLocation(o,this.attributes[m].name);S!==-1&&o.enableVertexAttribArray(S)}}setVertexAttribPointers(o,d,m){for(let S=0;S<this.attributes.length;S++){const A=this.attributes[S],k=d.getAttributeLocation(o,A.name);k!==-1&&o.vertexAttribPointer(k,A.components,o[Il[A.type]],!1,this.itemSize,A.offset+this.itemSize*(m||0))}}setVertexAttribDivisor(o,d,m){for(let S=0;S<this.attributes.length;S++){const A=d.getAttributeLocation(o,this.attributes[S].name);A!==-1&&this.instanceCount&&this.instanceCount>0&&o.vertexAttribDivisor(A,m)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Go{constructor(o,d,m,S,A){this.context=o,this.width=d,this.height=m;const k=this.framebuffer=o.gl.createFramebuffer();S&&(this.colorAttachment=new Uv(o,k)),A&&(this.depthAttachmentType=A,this.depthAttachment=A==="renderbuffer"?new Vv(o,k):new qx(o,k))}destroy(){const o=this.context.gl;if(this.colorAttachment){const d=this.colorAttachment.get();d&&o.deleteTexture(d)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const d=this.depthAttachment.get();d&&o.deleteRenderbuffer(d)}else{const d=this.depthAttachment.get();d&&o.deleteTexture(d)}o.deleteFramebuffer(this.framebuffer)}}class hl{constructor(o,d){this.gl=o,this.clearColor=new Ly(this),this.clearDepth=new og(this),this.clearStencil=new Dy(this),this.colorMask=new jv(this),this.depthMask=new Yw(this),this.stencilMask=new Xw(this),this.stencilFunc=new Ov(this),this.stencilOp=new Jw(this),this.stencilTest=new Ry(this),this.depthRange=new Qw(this),this.depthTest=new zx(this),this.depthFunc=new Fv(this),this.blend=new qp(this),this.blendFunc=new lg(this),this.blendColor=new zu(this),this.blendEquation=new Gp(this),this.cullFace=new jy(this),this.cullFaceSide=new cg(this),this.frontFace=new Hp(this),this.program=new Bx(this),this.activeTexture=new zv(this),this.viewport=new Ux(this),this.bindFramebuffer=new Rc(this),this.bindRenderbuffer=new gc(this),this.bindTexture=new iu(this),this.bindVertexBuffer=new Bv(this),this.bindElementBuffer=new ug(this),this.bindVertexArrayOES=new su(this),this.pixelStoreUnpack=new jc(this),this.pixelStoreUnpackPremultiplyAlpha=new Vx(this),this.pixelStoreUnpackFlipY=new $x(this),this.options=d?Object.assign({},d):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=d&&!!d.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=o.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),this.maxPointSize=o.getParameter(o.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,d,m){return new Fa(this,o,d,m)}createVertexBuffer(o,d,m,S,A){return new io(this,o,d,m,S,A)}createRenderbuffer(o,d,m){const S=this.gl,A=S.createRenderbuffer();return this.bindRenderbuffer.set(A),S.renderbufferStorage(S.RENDERBUFFER,o,d,m),this.bindRenderbuffer.set(null),A}createFramebuffer(o,d,m,S){return new Go(this,o,d,m,S)}clear({color:o,depth:d,stencil:m,colorMask:S}){const A=this.gl;let k=0;o&&(k|=A.COLOR_BUFFER_BIT,this.clearColor.set(o.toNonPremultipliedRenderColor(null)),this.colorMask.set(S||[!0,!0,!0,!0])),d!==void 0&&(k|=A.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),m!==void 0&&(k|=A.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),A.clear(k)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){i.by(o.blendFunction,kr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor),o.blendEquation?this.blendEquation.set(o.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(o.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let pa;function ms(g,o,d,m,S,A,k){const N=g.context,R=N.gl,V=g.transform,G=[i.aF(V.center.lng),i.aJ(V.center.lat)],X=d.layout.get("symbol-placement"),W=d.layout.get("text-variable-anchor"),te=d.layout.get("icon-rotation-alignment")==="map",ie=d.layout.get("text-rotation-alignment")==="map",se=X!=="point",ve=[];let ue=0,be=0;for(let Oe=0;Oe<m.length;Oe++){const Ge=m[Oe],Tt=o.getTile(Ge),ut=Tt.getBucket(d);if(!ut)continue;const jt=ut.getProjection().createInversionMatrix(V,Ge.canonical),bt=[],Dt=Py(Ge,ut,V),gn=!k&&te&&se,St=k&&ie&&se,it=W&&ut.hasTextData(),Ut=ut.hasIconTextFit()&&it&&ut.hasIconData(),Nt=gn||St||k&&it||Ut,Qt=ut.projection.name==="globe",mn=Qt?i.aj(V.zoom):0;Qt&&(bt.push("PROJECTION_GLOBE_VIEW"),Nt&&bt.push("PROJECTED_POS_ON_VIEWPORT"));const Nn=g.getOrCreateProgram("collisionBox",{defines:bt});let dn=Dt;S[0]===0&&S[1]===0||(dn=g.translatePosMatrix(Dt,Tt,S,A));const rn=k?ut.textCollisionBox:ut.iconCollisionBox,Qn=ut.collisionCircleArray;if(Qn.length>0){const Jn=i.bC(),Zn=dn;i.cO(Jn,ut.placementInvProjMatrix,V.glCoordMatrix),i.cO(Jn,Jn,ut.placementViewportMatrix),ve.push({circleArray:Qn,circleOffset:be,transform:Zn,invTransform:Jn,projection:ut.getProjection()}),ue+=Qn.length/4,be=ue}if(!rn)continue;g.terrain&&g.terrain.setupElevationDraw(Tt,Nn);const Kn=Qt?[Ge.canonical.x,Ge.canonical.y,1<<Ge.canonical.z]:[0,0,0];Nn.draw(g,R.LINES,Ln.disabled,sr.disabled,g.colorModeForRenderPass(),hr.disabled,tn(dn,jt,V,mn,G,Tt,Kn,ut.getProjection()),d.id,rn.layoutVertexBuffer,rn.indexBuffer,rn.segments,null,V.zoom,null,[rn.collisionVertexBuffer,rn.collisionVertexBufferExt])}if(!k||!ve.length)return;const Te=g.getOrCreateProgram("collisionCircle"),ke=new i.dW;ke.resize(4*ue),ke._trim();let Ue=0;for(const Oe of ve)for(let Ge=0;Ge<Oe.circleArray.length/4;Ge++){const Tt=4*Ge,ut=Oe.circleArray[Tt+0],jt=Oe.circleArray[Tt+1],bt=Oe.circleArray[Tt+2],Dt=Oe.circleArray[Tt+3];ke.emplace(Ue++,ut,jt,bt,Dt,0),ke.emplace(Ue++,ut,jt,bt,Dt,1),ke.emplace(Ue++,ut,jt,bt,Dt,2),ke.emplace(Ue++,ut,jt,bt,Dt,3)}(!pa||pa.length<2*ue)&&(pa=function(Oe){const Ge=2*Oe,Tt=new i.b1;Tt.resize(Ge),Tt._trim();for(let ut=0;ut<Ge;ut++){const jt=6*ut;Tt.uint16[jt+0]=4*ut+0,Tt.uint16[jt+1]=4*ut+1,Tt.uint16[jt+2]=4*ut+2,Tt.uint16[jt+3]=4*ut+2,Tt.uint16[jt+4]=4*ut+3,Tt.uint16[jt+5]=4*ut+0}return Tt}(ue));const Fe=N.createIndexBuffer(pa,!0),Ve=N.createVertexBuffer(ke,i.dX.members,!0);for(const Oe of ve){const Ge={u_matrix:Oe.transform,u_inv_matrix:Oe.invTransform,u_camera_to_center_distance:(ze=V).getCameraToCenterDistance(Oe.projection),u_viewport_size:[ze.width,ze.height]};Te.draw(g,R.TRIANGLES,Ln.disabled,sr.disabled,g.colorModeForRenderPass(),hr.disabled,Ge,d.id,Ve,Fe,i.bg.simpleSegment(0,2*Oe.circleOffset,Oe.circleArray.length,Oe.circleArray.length/2),null,V.zoom)}var ze;Ve.destroy(),Fe.destroy()}const ws=i.bC();function za(g){const o=g._camera.getWorldToCamera(g.worldSize,1),d=i.aB([],o,g.globeMatrix);i.bl(d,d);const m=[0,0,0],S=[0,1,0,0];return i.aC(S,S,d),m[0]=S[0],m[1]=S[1],m[2]=S[2],i.aw(m,m),m}function Ws({width:g,height:o,anchor:d,textOffset:m,textScale:S},A){const{horizontalAlign:k,verticalAlign:N}=i.c0(d),R=-(k-.5)*g,V=-(N-.5)*o,G=i.c1(d,m);return new i.P((R/S+G[0])*A,(V/S+G[1])*A)}function Io(g,o,d,m,S,A,k,N,R,V){const G=g.text.placedSymbolArray,X=g.text.dynamicLayoutVertexArray,W=g.icon.dynamicLayoutVertexArray,te={},ie=g.getProjection(),se=Mu(k,ie,S),ve=S.elevation,ue=ie.upVectorScale(k.canonical,S.center.lat,S.worldSize).metersToTile;X.clear();for(let be=0;be<G.length;be++){const Te=G.get(be),{tileAnchorX:ke,tileAnchorY:Ue,numGlyphs:Fe}=Te,Ve=Te.hidden||!Te.crossTileID||g.allowVerticalPlacement&&!Te.placedOrientation?null:m[Te.crossTileID];if(Ve){let ze=0,Oe=0,Ge=0;if(ve){const Ut=ve?ve.getAtTileOffset(k,ke,Ue):0,[Nt,Qt,mn]=ie.upVector(k.canonical,ke,Ue);ze=Ut*Nt*ue,Oe=Ut*Qt*ue,Ge=Ut*mn*ue}let[Tt,ut,jt,bt]=Pl(Te.projectedAnchorX+ze,Te.projectedAnchorY+Oe,Te.projectedAnchorZ+Ge,d?se:A);const Dt=gd(S.getCameraToCenterDistance(ie),bt);let gn=i.bM(g.textSizeData,R,Te)*Dt/i.bX;d&&(gn*=g.tilePixelRatio/N);const St=Ws(Ve,gn);d?({x:Tt,y:ut,z:jt}=ie.projectTilePoint(ke+St.x,Ue+St.y,k.canonical),[Tt,ut,jt]=Pl(Tt+ze,ut+Oe,jt+Ge,A)):(o&&St._rotate(-S.angle),Tt+=St.x,ut+=St.y,jt=0);const it=g.allowVerticalPlacement&&Te.placedOrientation===i.bL.vertical?Math.PI/2:0;for(let Ut=0;Ut<Fe;Ut++)i.bO(X,Tt,ut,jt,it);V&&Te.associatedIconIndex>=0&&(te[Te.associatedIconIndex]={x:Tt,y:ut,z:jt,angle:it})}else qe(Fe,X)}if(V){W.clear();const be=g.icon.placedSymbolArray;for(let Te=0;Te<be.length;Te++){const ke=be.get(Te),{numGlyphs:Ue}=ke,Fe=te[Te];if(ke.hidden||!Fe)qe(Ue,W);else{const{x:Ve,y:ze,z:Oe,angle:Ge}=Fe;for(let Tt=0;Tt<Ue;Tt++)i.bO(W,Ve,ze,Oe,Ge)}}g.icon.dynamicLayoutVertexBuffer.updateData(W)}g.text.dynamicLayoutVertexBuffer.updateData(X)}function Hl(g,o,d,m,S,A,k={}){const N=d.paint.get("icon-translate"),R=d.paint.get("text-translate"),V=d.paint.get("icon-translate-anchor"),G=d.paint.get("text-translate-anchor"),X=d.layout.get("icon-rotation-alignment"),W=d.layout.get("text-rotation-alignment"),te=d.layout.get("icon-pitch-alignment"),ie=d.layout.get("text-pitch-alignment"),se=d.layout.get("icon-keep-upright"),ve=d.layout.get("text-keep-upright"),ue=d.paint.get("icon-color-saturation"),be=d.paint.get("icon-color-contrast"),Te=d.paint.get("icon-color-brightness-min"),ke=d.paint.get("icon-color-brightness-max"),Ue=d.layout.get("symbol-elevation-reference")==="sea",Fe=d.layout.get("icon-image-use-theme")==="none",Ve=g.context,ze=Ve.gl,Oe=g.transform,Ge=X==="map",Tt=W==="map",ut=te==="map",jt=ie==="map",bt=d.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Dt=!1;const gn=g.depthModeForSublayer(0,Ln.ReadOnly),St=new Ln(g.context.gl.LEQUAL,Ln.ReadOnly,g.depthRangeFor3D),it=[i.aF(Oe.center.lng),i.aJ(Oe.center.lat)],Ut=d.layout.get("text-variable-anchor"),Nt=Oe.projection.name==="globe",Qt=[],mn=[0,-1,0];for(const Nn of m){const dn=o.getTile(Nn),rn=dn.getBucket(d);if(!rn||rn.projection.name==="mercator"&&Nt||rn.fullyClipped)continue;const Qn=rn.projection.name==="globe",Kn=Qn?i.aj(Oe.zoom):0,Jn=Mu(Nn,rn.getProjection(),Oe),Zn=Oe.calculatePixelsToTileUnitsMatrix(dn),Er=Ut&&rn.hasTextData(),Vr=rn.hasIconTextFit()&&Er&&rn.hasIconData(),Wr=rn.getProjection().createInversionMatrix(Oe,Nn.canonical),Ki=(1<<dn.tileID.canonical.z)*i.al/g.transform.worldSize,Nr=$s=>{let Zr=[0,0,0];if($s){const gr=g.style.directionalLight,Yi=g.style.ambientLight;gr&&Yi&&(Zr=Gl(g.style,gr,Yi))}return Zr},Ri=$s=>{Oe.depthOcclusionForSymbolsAndCircles&&(d.hasOcclusionOpacityProperties||g.terrain)&&($s.push("DEPTH_D24"),$s.push("DEPTH_OCCLUSION"))},qi=$s=>{d.lut&&!Fe&&(d.lut.texture||(d.lut.texture=new i.dY(g.context,d.lut.image,[d.lut.image.height,d.lut.image.height,d.lut.image.height],Ve.gl.RGBA8)),Ve.activeTexture.set(Ve.gl.TEXTURE0+Ms.LUT),d.lut.texture&&d.lut.texture.bind(Ve.gl.LINEAR,Ve.gl.CLAMP_TO_EDGE),$s.push("APPLY_LUT_ON_GPU"))},Rs=()=>{const $s=Ge&&d.layout.get("symbol-placement")!=="point",Zr=[];Ri(Zr),qi(Zr);const gr=$s||Vr,Yi=rn.elevationType==="road",la=g.shadowRenderer,Ks=Yi&&ut&&!!la&&la.enabled,Va=Nr(Ks),el=Yi&&ut&&!g.terrain?St:gn,Uu=d.paint.get("icon-image-cross-fade");g.terrainRenderModeElevated()&&ut&&Zr.push("PITCH_WITH_MAP_TERRAIN"),Qn&&(Zr.push("PROJECTION_GLOBE_VIEW"),gr&&Zr.push("PROJECTED_POS_ON_VIEWPORT")),Uu>0&&rn.hasAnySecondaryIcon&&Zr.push("ICON_TRANSITION"),!rn.icon.zOffsetVertexBuffer||Yi&&g.terrain||Zr.push("Z_OFFSET"),ue===0&&be===0&&Te===0&&ke===1||Zr.push("COLOR_ADJUSTMENT"),rn.sdfIcons&&Zr.push("RENDER_SDF"),Ks&&Zr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Yi&&ut&&!g.terrain&&rn.icon.orientationVertexBuffer&&Zr.push("ELEVATED_ROADS");const Vu=rn.icon.programConfigurations.get(d.id),uu=g.getOrCreateProgram("symbol",{config:Vu,defines:Zr}),du=dn.imageAtlasTexture?dn.imageAtlasTexture.size:[0,0],_c=rn.iconSizeData,Id=i.bK(_c,Oe.zoom),lh=ut||!Oe.isOrthographic,ga=El(Jn,dn.tileID.canonical,ut,Ge,Oe,rn.getProjection(),Zn),wa=md(Jn,dn.tileID.canonical,ut,Ge,Oe,rn.getProjection(),Zn),Ys=g.translatePosMatrix(wa,dn,N,V,!0),ao=g.translatePosMatrix(Jn,dn,N,V),Lo=gr?ws:ga,Ma=Ge&&!ut&&!$s;let Ml=mn;!Nt&&!Oe.mercatorFromTransition||Ge||(Ml=za(Oe));const Xh=Qn?Ml:mn,Xf=d.getColorAdjustmentMatrix(ue,be,Te,ke),ch=Zi(_c.kind,Id,Ma,ut,g,ao,Lo,Ys,Ue,!1,du,[0,0],0,Nn,Kn,it,Wr,Xh,rn.getProjection(),Va,Ki,Xf,Uu,null),lm=dn.imageAtlasTexture?dn.imageAtlasTexture:null,cm=d.layout.get("icon-size").constantOr(0)!==1||rn.iconsNeedLinear,Jh=rn.sdfIcons||g.options.rotating||g.options.zooming||cm||lh?ze.LINEAR:ze.NEAREST,Qy=rn.sdfIcons&&d.paint.get("icon-halo-width").constantOr(1)!==0,Jf=g.terrain&&ut&&$s?i.bl(i.bC(),ga):ws;if($s&&rn.icon){const Qh=Oe.elevation,Qf=Qh?Qh.getAtTileOffsetFunc(Nn,Oe.center.lat,Oe.worldSize,rn.getProjection()):null,s1=eh(Jn,dn.tileID.canonical,ut,Ge,Oe,rn.getProjection(),Zn);Lu(rn,Jn,g,!1,s1,wa,ut,se,Qf,Nn)}return{program:uu,buffers:rn.icon,uniformValues:ch,atlasTexture:lm,atlasTextureIcon:null,atlasInterpolation:Jh,atlasInterpolationIcon:null,isSDF:rn.sdfIcons,hasHalo:Qy,depthMode:el,tile:dn,renderWithShadows:Ks,labelPlaneMatrixInv:Jf}},$r=()=>{const $s=Tt&&d.layout.get("symbol-placement")!=="point",Zr=[],gr=$s||Ut||Vr,Yi=rn.elevationType==="road",la=g.shadowRenderer,Ks=Yi&&jt&&!!la&&la.enabled,Va=Nr(Ks),el=Yi&&jt&&!g.terrain?St:gn;g.terrainRenderModeElevated()&&jt&&Zr.push("PITCH_WITH_MAP_TERRAIN"),Qn&&(Zr.push("PROJECTION_GLOBE_VIEW"),gr&&Zr.push("PROJECTED_POS_ON_VIEWPORT")),!rn.text.zOffsetVertexBuffer||Yi&&g.terrain||Zr.push("Z_OFFSET"),rn.iconsInText&&Zr.push("RENDER_TEXT_AND_SYMBOL"),Zr.push("RENDER_SDF"),Ks&&Zr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Yi&&jt&&!g.terrain&&rn.text.orientationVertexBuffer&&Zr.push("ELEVATED_ROADS"),Ri(Zr);const Uu=rn.text.programConfigurations.get(d.id),Vu=g.getOrCreateProgram("symbol",{config:Uu,defines:Zr});let uu,du=[0,0],_c=null;const Id=rn.textSizeData;rn.iconsInText&&(du=dn.imageAtlasTexture?dn.imageAtlasTexture.size:[0,0],_c=dn.imageAtlasTexture?dn.imageAtlasTexture:null,uu=jt||!Oe.isOrthographic||g.options.rotating||g.options.zooming||Id.kind==="composite"||Id.kind==="camera"?ze.LINEAR:ze.NEAREST);const lh=dn.glyphAtlasTexture?dn.glyphAtlasTexture.size:[0,0],ga=d.layout.get("text-size-scale-range"),wa=i.aA(g.scaleFactor,ga[0],ga[1]),Ys=i.bK(Id,Oe.zoom,wa),ao=El(Jn,dn.tileID.canonical,jt,Tt,Oe,rn.getProjection(),Zn),Lo=md(Jn,dn.tileID.canonical,jt,Tt,Oe,rn.getProjection(),Zn),Ma=g.translatePosMatrix(Lo,dn,R,G,!0),Ml=g.translatePosMatrix(Jn,dn,R,G),Xh=gr?ws:ao,Xf=Tt&&!jt&&!$s;let ch=mn;!Nt&&!Oe.mercatorFromTransition||Tt||(ch=za(Oe));const lm=Zi(Id.kind,Ys,Xf,jt,g,Ml,Xh,Ma,Ue,!0,lh,du,0,Nn,Kn,it,Wr,Qn?ch:mn,rn.getProjection(),Va,Ki,null,null,wa),cm=dn.glyphAtlasTexture?dn.glyphAtlasTexture:null,Jh=ze.LINEAR,Qy=d.paint.get("text-halo-width").constantOr(1)!==0,Jf=g.terrain&&jt&&$s?i.bl(i.bC(),ao):ws;if($s&&rn.text){const Qh=Oe.elevation,Qf=Qh?Qh.getAtTileOffsetFunc(Nn,Oe.center.lat,Oe.worldSize,rn.getProjection()):null,s1=eh(Jn,dn.tileID.canonical,jt,Tt,Oe,rn.getProjection(),Zn);Lu(rn,Jn,g,!0,s1,Lo,jt,ve,Qf,Nn)}return{program:Vu,buffers:rn.text,uniformValues:lm,atlasTexture:cm,atlasTextureIcon:_c,atlasInterpolation:Jh,atlasInterpolationIcon:uu,isSDF:!0,hasHalo:Qy,depthMode:el,tile:dn,renderWithShadows:Ks,labelPlaneMatrixInv:Jf}},zi=rn.icon.segments.get().length,ji=rn.text.segments.get().length,Ui=zi&&!k.onlyText?Rs():null,Vs=ji&&!k.onlyIcons?$r():null,ba=d.paint.get("icon-opacity").constantOr(1),Mo=d.paint.get("text-opacity").constantOr(1);if(bt&&rn.canOverlap){Dt=!0;const $s=ba&&!k.onlyText?rn.icon.segments.get():[],Zr=Mo&&!k.onlyIcons?rn.text.segments.get():[];for(const gr of $s)Qt.push({segments:new i.bg([gr]),sortKey:gr.sortKey,state:Ui});for(const gr of Zr)Qt.push({segments:new i.bg([gr]),sortKey:gr.sortKey,state:Vs})}else k.onlyText||Qt.push({segments:ba?rn.icon.segments:new i.bg([]),sortKey:0,state:Ui}),k.onlyIcons||Qt.push({segments:Mo?rn.text.segments:new i.bg([]),sortKey:0,state:Vs})}Dt&&Qt.sort((Nn,dn)=>Nn.sortKey-dn.sortKey);for(const Nn of Qt){const dn=Nn.state;if(dn)if(g.terrain?g.terrain.setupElevationDraw(dn.tile,dn.program,{useDepthForOcclusion:Oe.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:dn.labelPlaneMatrixInv}):g.setupDepthForOcclusion(Oe.depthOcclusionForSymbolsAndCircles,dn.program),Ve.activeTexture.set(ze.TEXTURE0),dn.atlasTexture&&dn.atlasTexture.bind(dn.atlasInterpolation,ze.CLAMP_TO_EDGE,!0),dn.atlasTextureIcon&&(Ve.activeTexture.set(ze.TEXTURE1),dn.atlasTextureIcon&&dn.atlasTextureIcon.bind(dn.atlasInterpolationIcon,ze.CLAMP_TO_EDGE,!0)),dn.renderWithShadows&&g.shadowRenderer.setupShadows(dn.tile.tileID.toUnwrapped(),dn.program,"vector-tile"),g.uploadCommonLightUniforms(g.context,dn.program),dn.hasHalo){const rn=dn.uniformValues;rn.u_is_halo=1,Ba(dn.buffers,Nn.segments,d,g,dn.program,dn.depthMode,S,A,rn,2),rn.u_is_halo=0}else{if(dn.isSDF){const rn=dn.uniformValues;dn.hasHalo&&(rn.u_is_halo=1,Ba(dn.buffers,Nn.segments,d,g,dn.program,dn.depthMode,S,A,rn,1)),rn.u_is_halo=0}Ba(dn.buffers,Nn.segments,d,g,dn.program,dn.depthMode,S,A,dn.uniformValues,1)}}}function Ba(g,o,d,m,S,A,k,N,R,V){const G=[g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer,g.iconTransitioningVertexBuffer,g.globeExtVertexBuffer,g.zOffsetVertexBuffer,g.orientationVertexBuffer];S.draw(m,m.context.gl.TRIANGLES,A,k,N,hr.disabled,R,d.id,g.layoutVertexBuffer,g.indexBuffer,o,d.paint,m.transform.zoom,g.programConfigurations.get(d.id),G,V)}function Wl(g,o){const d=1<<g.canonical.z,m=(o.x*d-g.canonical.x-g.wrap*d)*i.al,S=(o.y*d-g.canonical.y)*i.al,A=i.e5(o.z,o.y);return i.d4(m,S,A)}function Us(g,o,d,m,S){if(!d.layout||d.layout.get("fill-elevation-reference")==="none")return;const A=g.context.gl,k=new Ln(g.context.gl.LEQUAL,Ln.ReadWrite,g.depthRangeFor3D),N=new Ln(g.context.gl.GREATER,Ln.ReadWrite,g.depthRangeFor3D),R=function(te){let ie=.01;return te.isOrthographic&&(ie=i.ak(1e-4,ie,i.c$(te.pitch>=Mc?1:te.pitch/Mc))),2*ie}(g.transform),V=g.transform.getFreeCameraOptions().position,G="elevatedStructuresDepthReconstruct",X=g.getOrCreateProgram(G,{defines:["DEPTH_RECONSTRUCTION"]}),W=g.getOrCreateProgram(G);for(const te of m){const ie=o.getTile(te),se=ie.getBucket(d);if(!se)continue;const ve=se.elevatedStructures;if(!ve)continue;const ue=se.elevationBufferData.heightRange,be=Wl(te.toUnwrapped(),V),Te=g.translatePosMatrix(te.projMatrix,ie,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));let ke,Ue,Fe,Ve;if(S==="initialize"){if(!ue||ue.min>=1||ve.depthSegments.segments[0].primitiveLength===0)continue;ke=Bt(Te,be,R,1,0),Ue=k,Fe=ve.depthSegments,Ve=X}else if(S==="reset"){if(!ue||ue.min>=0||ve.maskSegments.segments[0].primitiveLength===0)continue;ke=Bt(Te,be,0,0,1),Ue=N,Fe=ve.maskSegments,Ve=X}else if(S==="geometry"){if(ve.depthSegments.segments[0].primitiveLength===0)continue;ke=Bt(Te,be,R,1,0),Ue=k,Fe=ve.depthSegments,Ve=W}Ve.draw(g,A.TRIANGLES,Ue,sr.disabled,kr.disabled,hr.disabled,ke,d.id,ve.vertexBuffer,ve.indexBuffer,Fe,d.paint,g.transform.zoom)}}function Ua(g,o,d){const{painter:m,sourceCache:S,layer:A,coords:k,colorMode:N,elevationType:R,terrainEnabled:V,pass:G}=g,X=m.context.gl,W=A.paint.get("fill-pattern"),te=A.paint.get("fill-pattern-cross-fade"),ie=W.constantOr(null);let se=R;R!=="road"||o&&!V||(se="none");const ve=se==="road",ue=g.painter.shadowRenderer,be=ve&&!!ue&&ue.enabled,Te=new Ln(m.context.gl.LEQUAL,Ln.ReadOnly,m.depthRangeFor3D);let ke=[0,0,0];if(be){const Ve=m.style.directionalLight,ze=m.style.ambientLight;Ve&&ze&&(ke=Gl(m.style,Ve,ze))}const Ue=W&&W.constantOr(1),Fe=(Ve,ze)=>{let Oe,Ge,Tt,ut,jt;ze?(Oe=Ue&&!A.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Tt=X.LINES):(Oe=Ue?"fillPattern":"fill",Tt=X.TRIANGLES);for(const bt of k){const Dt=S.getTile(bt);if(Ue&&!Dt.patternsLoaded())continue;const gn=Dt.getBucket(A);if(!gn)continue;const St=o?gn.elevationBufferData:gn.bufferData;if(St.isEmpty())continue;m.prepareDrawTile();const it=St.programConfigurations.get(A.id),Ut=m.isTileAffectedByFog(bt),Nt=[],Qt=[];ve&&(Nt.push("ELEVATED_ROADS"),Qt.push(St.elevatedLayoutVertexBuffer)),be&&Nt.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Ue&&(m.context.activeTexture.set(X.TEXTURE0),Dt.imageAtlasTexture&&Dt.imageAtlasTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),it.updatePaintBuffers());let mn=!1;if(ie&&Dt.imageAtlas){const Kn=Dt.imageAtlas,Jn=i.e0.from(ie),Zn=Jn.getPrimary().scaleSelf(i.o.devicePixelRatio).toString(),Er=Jn.getSecondary(),Vr=Kn.patternPositions.get(Zn),Wr=Er?Kn.patternPositions.get(Er.scaleSelf(i.o.devicePixelRatio).toString()):null;mn=!!Vr&&!!Wr,Vr&&it.setConstantPatternPositions(Vr,Wr)}te>0&&(mn||it.getPatternTransitionVertexBuffer("fill-pattern"))&&Nt.push("FILL_PATTERN_TRANSITION");const Nn=m.getOrCreateProgram(Oe,{config:it,overrideFog:Ut,defines:Nt}),dn=m.translatePosMatrix(bt.projMatrix,Dt,A.paint.get("fill-translate"),A.paint.get("fill-translate-anchor"));be&&ue.setupShadows(Dt.tileID.toUnwrapped(),Nn,"vector-tile");const rn=A.paint.get("fill-emissive-strength");if(ze){ut=St.lineIndexBuffer,jt=St.lineSegments;const Kn=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[X.drawingBufferWidth,X.drawingBufferHeight];Ge=Oe==="fillOutlinePattern"&&Ue?rt(dn,rn,m,Dt,Kn,ke,te):Je(dn,rn,Kn,ke)}else ut=St.indexBuffer,jt=St.triangleSegments,Ge=Ue?$e(dn,rn,m,Dt,ke,te):Be(dn,rn,ke);m.uploadCommonUniforms(m.context,Nn,bt.toUnwrapped());let Qn=Ve;(R==="road"&&!V||R==="offset")&&(Qn=Te),Nn.draw(m,Tt,Qn,d||m.stencilModeForClipping(bt),N,hr.disabled,Ge,A.id,St.layoutVertexBuffer,ut,jt,A.paint,m.transform.zoom,it,Qt)}};m.renderPass===G&&Fe(m.depthModeForSublayer(1,m.renderPass==="opaque"?Ln.ReadWrite:Ln.ReadOnly),!1),se==="none"&&m.renderPass==="translucent"&&A.paint.get("fill-antialias")&&Fe(m.depthModeForSublayer(A.getPaintProperty("fill-outline-color")?2:0,Ln.ReadOnly),!0)}function Pn(g,o,d,m,S,A,k,N){d.resetLayerRenderingStats(g);const R=g.context,V=R.gl,G=g.transform,X=d.paint.get("fill-extrusion-pattern"),W=d.paint.get("fill-extrusion-pattern-cross-fade"),te=X.constantOr(null),ie=X.constantOr(1),se=d.paint.get("fill-extrusion-opacity"),ve=g.style.enable3dLights(),ue=d.paint.get(ve&&!ie?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),be=[d.paint.get("fill-extrusion-ambient-occlusion-intensity"),ue],Te=d.layout.get("fill-extrusion-edge-radius"),ke=Te>0&&!d.paint.get("fill-extrusion-rounded-roof"),Ue=ke?0:Te,Fe=G.projection.name==="globe"?i.e8():0,Ve=G.projection.name==="globe",ze=Ve?i.aj(G.zoom):0,Oe=[i.aF(G.center.lng),i.aJ(G.center.lat)],Ge=d.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Tt=d.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(Ge?null:d.lut).toArray01().slice(0,3),ut=d.paint.get("fill-extrusion-flood-light-intensity"),jt=d.paint.get("fill-extrusion-vertical-scale"),bt=d.paint.get("fill-extrusion-line-width").constantOr(1)!==0,Dt=d.paint.get("fill-extrusion-height-alignment"),gn=d.paint.get("fill-extrusion-base-alignment"),St=fa(g,d.paint.get("fill-extrusion-cutoff-fade-range")),it=[];let Ut;Ve&&it.push("PROJECTION_GLOBE_VIEW"),be[0]>0&&it.push("FAUX_AO"),ke&&it.push("ZERO_ROOF_RADIUS"),N&&it.push("HAS_CENTROID"),ut>0&&it.push("FLOOD_LIGHT"),St.shouldRenderCutoff&&it.push("RENDER_CUTOFF"),bt&&it.push("RENDER_WALL_MODE");const Nt=g.renderPass==="shadow",Qt=g.shadowRenderer,mn=Nt&&!!Qt,Nn=Nt?hr.disabled:hr.backCCW;g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!0);let dn=[0,0,0];if(Qt){const Kn=g.style.directionalLight,Jn=g.style.ambientLight;Kn&&Jn&&(dn=Gl(g.style,Kn,Jn)),Nt||(it.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Qt.useNormalOffset&&it.push("NORMAL_OFFSET")),Ut=it.concat(["SHADOWS_SINGLE_CASCADE"])}const rn=mn?"fillExtrusionDepth":ie?"fillExtrusionPattern":"fillExtrusion",Qn=d.getLayerRenderingStats();for(const Kn of m){const Jn=o.getTile(Kn),Zn=Jn.getBucket(d);if(!Zn||Zn.projection.name!==G.projection.name)continue;let Er=!1;Qt&&(Er=Qt.getMaxCascadeForTile(Kn.toUnwrapped())===0);const Vr=g.isTileAffectedByFog(Kn),Wr=Zn.programConfigurations.get(d.id);let Ki=!1;if(te&&Jn.imageAtlas){const ji=Jn.imageAtlas,Ui=i.e0.from(te),Vs=Ui.getPrimary().scaleSelf(i.o.devicePixelRatio).toString(),ba=Ui.getSecondary(),Mo=ji.patternPositions.get(Vs),$s=ba?ji.patternPositions.get(ba.scaleSelf(i.o.devicePixelRatio).toString()):null;Ki=!!Mo&&!!$s,Mo&&Wr.setConstantPatternPositions(Mo,$s)}W>0&&(Ki||Wr.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&it.push("FILL_EXTRUSION_PATTERN_TRANSITION");const Nr=g.getOrCreateProgram(rn,{config:Wr,defines:Er?Ut:it,overrideFog:Vr});if(g.terrain&&g.terrain.setupElevationDraw(Jn,Nr,{useMeterToDem:!0}),!Zn.centroidVertexBuffer){const ji=Nr.getAttributeLocation(V,"a_centroid_pos");ji!==-1&&V.vertexAttrib2f(ji,0,0)}!Nt&&Qt&&Qt.setupShadows(Jn.tileID.toUnwrapped(),Nr,"vector-tile"),ie&&(g.context.activeTexture.set(V.TEXTURE0),Jn.imageAtlasTexture&&Jn.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),Wr.updatePaintBuffers());const Ri=d.paint.get("fill-extrusion-vertical-gradient"),qi=1/Zn.tileToMeter;let Rs;if(Nt&&Qt){if(yc(Jn.tileID,Zn.maxHeight,g))continue;const ji=Qt.calculateShadowPassMatrixFromTile(Jn.tileID.toUnwrapped());Rs=ye(ji,Ue,qi,jt,Dt,gn)}else{const ji=g.translatePosMatrix(Kn.expandedProjMatrix,Jn,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Ui=G.projection.createInversionMatrix(G,Kn.canonical);Rs=ie?Ne(ji,g,Ri,se,be,Ue,qi,Kn,Jn,Fe,Dt,gn,ze,Oe,Ui,Tt,jt,W):oe(ji,g,Ri,se,be,Ue,qi,Kn,Fe,Dt,gn,ze,Oe,Ui,Tt,jt,ut,dn)}g.uploadCommonUniforms(R,Nr,Kn.toUnwrapped(),null,St);let $r=Zn.segments;if(G.projection.name==="mercator"&&!Nt&&($r=Zn.getVisibleSegments(Jn.tileID,g.terrain,g.transform.getFrustum(0)),!$r.get().length))continue;if(Qn)if(Nt)for(const ji of $r.get())Qn.numRenderedVerticesInShadowPass+=ji.primitiveLength;else for(const ji of $r.get())Qn.numRenderedVerticesInTransparentPass+=ji.primitiveLength;const zi=[];(g.terrain||N)&&zi.push(Zn.centroidVertexBuffer),Ve&&zi.push(Zn.layoutVertexExtBuffer),bt&&zi.push(Zn.wallVertexBuffer),Nr.draw(g,R.gl.TRIANGLES,S,A,k,Nn,Rs,d.id,Zn.layoutVertexBuffer,Zn.indexBuffer,$r,d.paint,g.transform.zoom,Wr,zi)}g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!1)}class fl{constructor(){this.translate=[0,0],this.translateAnchor="map",this.edgeRadius=0,this.cutoffFadeRange=0}}function go(g,o,d,m,S,A,k,N,R,V,G,X,W,te,ie,se,ve,ue,be,Te){const ke=o.context,Ue=ke.gl,Fe=o.transform,Ve=o.transform.zoom,ze=[],Oe=g.translate,Ge=g.translateAnchor,Tt=g.edgeRadius,ut=fa(o,g.cutoffFadeRange);G==="clear"?(ze.push("CLEAR_SUBPASS"),Te&&(ze.push("CLEAR_FROM_TEXTURE"),ke.activeTexture.set(Ue.TEXTURE0),Te.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE))):G==="sdf"&&ze.push("SDF_SUBPASS"),ue&&ze.push("HAS_CENTROID"),ut.shouldRenderCutoff&&ze.push("RENDER_CUTOFF");const jt=(bt,Dt,gn,St,it)=>{const Ut=Dt.programConfigurations.get(m.id),Nt=o.isTileAffectedByFog(bt),Qt=o.getOrCreateProgram("fillExtrusionGroundEffect",{config:Ut,defines:ze,overrideFog:Nt}),mn=((dn,rn,Qn,Kn,Jn,Zn,Er,Vr,Wr,Ki,Nr)=>({u_matrix:rn,u_opacity:Qn,u_ao_pass:Kn?1:0,u_meter_to_tile:Jn,u_ao:Zn,u_flood_light_intensity:Er,u_flood_light_color:Vr,u_attenuation:Wr,u_edge_radius:Ki,u_fb:0,u_fb_size:Nr,u_dynamic_offset:1}))(0,St,X,V,it,[W,te*it],ie,se,ve,Ve>=17?0:Tt*it,Te?Te.size[0]:0),Nn=[];ue&&Nn.push(Dt.hiddenByLandmarkVertexBuffer),o.uploadCommonUniforms(ke,Qt,bt.toUnwrapped(),null,ut),Qt.draw(o,ke.gl.TRIANGLES,A,k,N,R,mn,m.id,Dt.vertexBuffer,Dt.indexBuffer,gn,m.paint,Ve,Ut,Nn)};for(const bt of S){const Dt=d.getTile(bt),gn=Dt.getBucket(m);if(!gn||gn.projection.name!==Fe.projection.name||!gn.groundEffect||gn.groundEffect&&!gn.groundEffect.hasData())continue;const St=gn.groundEffect,it=1/gn.tileToMeter;{const Ut=o.translatePosMatrix(bt.projMatrix,Dt,Oe,Ge),Nt=St.getDefaultSegment();jt(bt,St,Nt,Ut,it)}if(be)for(let Ut=0;Ut<4;Ut++){const Nt=i.e6[Ut](bt),Qt=d.getTile(Nt);if(!Qt)continue;const mn=Qt.getBucket(m);if(!mn||mn.projection.name!==Fe.projection.name||!mn.groundEffect||mn.groundEffect&&!mn.groundEffect.hasData())continue;const Nn=mn.groundEffect;let dn,rn;Ut===0?(dn=[-i.al,0,0],rn=1):Ut===1?(dn=[i.al,0,0],rn=0):Ut===2?(dn=[0,-i.al,0],rn=3):(dn=[0,i.al,0],rn=2);const Qn=Nn.regionSegments[rn];if(!Qn)continue;const Kn=new Float32Array(16);i.br(Kn,bt.projMatrix,dn),jt(bt,Nn,Qn,o.translatePosMatrix(Kn,Dt,Oe,Ge),it)}}}function No(g,o,d,m,S,A,k){m.centroidVertexArray.length===0&&m.createCentroidsBuffer();const N=A?A.findDEMTileFor(d):null;if(!(N&&N.dem||k))return;A&&N&&N.dem&&m.selfDEMTileTimestamp!==N.dem._timestamp&&(m.borderDoneWithNeighborZ=[-1,-1,-1,-1],m.selfDEMTileTimestamp=N.dem._timestamp);const R=ue=>new i.P(Math.ceil((ue+i.ea)*i.eb),0),V=ue=>{const be=o.getSource().minzoom,Te=Ue=>{const Fe=o.getTileByID(Ue);if(Fe&&Fe.hasData())return Fe.getBucket(S)},ke=[0,-1,1];for(const Ue of ke){if(ue.overscaledZ+Ue<be)continue;const Fe=Te(ue.calculateScaledKey(ue.overscaledZ+Ue));if(Fe)return Fe}},G=[0,0,0],X=(ue,be)=>(G[0]=Math.min(ue.min.y,be.min.y),G[1]=Math.max(ue.max.y,be.max.y),G[2]=i.al-be.min.x>ue.max.x?be.min.x-i.al:ue.max.x,G),W=(ue,be)=>(G[0]=Math.min(ue.min.x,be.min.x),G[1]=Math.max(ue.max.x,be.max.x),G[2]=i.al-be.min.y>ue.max.y?be.min.y-i.al:ue.max.y,G),te=[(ue,be)=>X(ue,be),(ue,be)=>X(be,ue),(ue,be)=>W(ue,be),(ue,be)=>W(be,ue)],ie=(ue,be,Te,ke,Ue,Fe,Ve)=>{if(!A)return 0;const ze=[[Fe?Te:ue,Fe?ue:Te,0],[Fe?Te:be,Fe?be:Te,0]],Oe=Ve<0?i.al+Ve:Ve,Ge=[Fe?Oe:(ue+be)/2,Fe?(ue+be)/2:Oe,0];return Te===0&&Ve<0||Te!==0&&Ve>0?A.getForTilePoints(Ue,[Ge],!0,ke):ze.push(Ge),A.getForTilePoints(d,ze,!0,N),Math.max(ze[0][2],ze[1][2],Ge[2])/A.exaggeration()};for(let ue=0;ue<4;ue++){const be=m.borderFeatureIndices[ue];if(be.length===0)continue;const Te=i.e6[ue](d),ke=V(Te);if(!(ke&&ke instanceof i.e7))continue;const Ue=A?A.findDEMTileFor(Te):null;if(!(Ue&&Ue.dem||k)||(A&&Ue&&Ue.dem&&m.borderDEMTileTimestamp[ue]!==Ue.dem._timestamp&&(m.borderDoneWithNeighborZ[ue]=-1,m.borderDEMTileTimestamp[ue]=Ue.dem._timestamp),m.borderDoneWithNeighborZ[ue]===ke.canonical.z))continue;ke.centroidVertexArray.length===0&&ke.createCentroidsBuffer();const Fe=(ue<2?1:5)-ue,Ve=ke.borderDoneWithNeighborZ[Fe]!==m.canonical.z,ze=ke.borderFeatureIndices[Fe];let Oe=0;if(m.canonical.z!==ke.canonical.z){for(const Ge of be)m.showCentroid(m.featuresOnBorder[Ge]);if(Ve)for(const Ge of ze)ke.showCentroid(ke.featuresOnBorder[Ge]);m.borderDoneWithNeighborZ[ue]=ke.canonical.z,ke.borderDoneWithNeighborZ[Fe]=m.canonical.z}for(const Ge of be){const Tt=m.featuresOnBorder[Ge],ut=m.centroidData[Tt.centroidDataIndex],jt=Tt.borders[ue];let bt;for(;Oe<ze.length;){bt=ke.featuresOnBorder[ze[Oe]];const Dt=bt.borders[Fe];if(Dt[1]>jt[0]+3||Dt[0]>jt[0]-3)break;ke.showCentroid(bt),Oe++}if(bt&&Oe<ze.length){const Dt=Oe;let gn=0;for(;!(bt.borders[Fe][0]>jt[1]-3)&&(gn++,++Oe!==ze.length);)bt=ke.featuresOnBorder[ze[Oe]];bt=ke.featuresOnBorder[ze[Dt]];let St=!1;if(gn>=1){const Nt=bt.borders[Fe];Math.abs(jt[0]-Nt[0])<3&&Math.abs(jt[1]-Nt[1])<3&&(gn=1,St=!0,Oe=Dt+1)}else if(gn===0){m.showCentroid(Tt);continue}const it=ke.centroidData[bt.centroidDataIndex];k&&St&&(((se=ut).flags|(ve=it).flags)&i.e9?(se.flags|=i.e9,ve.flags|=i.e9):(se.flags&=~i.e9,ve.flags&=~i.e9));const Ut=Tt.intersectsCount()>1||bt.intersectsCount()>1;if(gn>1)Oe=Dt,ut.centroidXY=it.centroidXY=new i.P(0,0);else if(Ue&&Ue.dem&&!Ut){const Nt=te[ue](ut,it),Qt=ue%2?i.al-1:0,mn=ie(Nt[0],Math.min(i.al-1,Nt[1]),Qt,Ue,Te,ue<2,Nt[2]);ut.centroidXY=it.centroidXY=R(mn)}else Ut?ut.centroidXY=it.centroidXY=new i.P(0,0):(ut.centroidXY=m.encodeBorderCentroid(Tt),it.centroidXY=ke.encodeBorderCentroid(bt));m.writeCentroidToBuffer(ut),ke.writeCentroidToBuffer(it)}else m.showCentroid(Tt)}m.borderDoneWithNeighborZ[ue]=ke.canonical.z,ke.borderDoneWithNeighborZ[Fe]=m.canonical.z}var se,ve;(m.needsCentroidUpdate||!m.centroidVertexBuffer&&m.centroidVertexArray.length!==0)&&m.uploadCentroid(g)}const yo=[1,0,0],nr=[0,1,0],ma=[0,0,1];function yc(g,o,d){const m=d.transform,S=d.shadowRenderer;if(!S)return!0;const A=g.toUnwrapped(),k=m.tileSize*S._cascades[d.currentShadowCascade].scale;let N=o;if(m.elevation){const se=m.elevation.getMinMaxForTile(g);se&&(N+=se.max)}const R=[...S.shadowDirection];R[2]=-R[2];const V=S.computeSimplifiedTileShadowVolume(A,N,k,R);if(!V)return!1;const G=[yo,nr,ma,R,[R[0],0,R[2]],[0,R[1],R[2]]],X=m.projection.name==="globe",W=m.scaleZoom(k),te=i.cA.fromInvProjectionMatrix(m.invProjMatrix,m.worldSize,W,!X),ie=S.getCurrentCascadeFrustum();return te.intersectsPrecise(V.vertices,V.planes,G)===0||ie.intersectsPrecise(V.vertices,V.planes,G)===0}function vc(g){const{painter:o,source:d,layer:m,coords:S}=g;let A=g.defines;const k=o.context,N=o.renderPass==="shadow",R=o.renderPass==="light-beam",V=o.shadowRenderer,G=i.ec(o.transform.center.lat,o.transform.zoom),X=fa(o,m.paint.get("building-cutoff-fade-range"));X.shouldRenderCutoff&&(A=A.concat("RENDER_CUTOFF"));for(const W of S){const te=d.getTile(W),ie=te.getBucket(m);if(!ie)continue;V&&V.getMaxCascadeForTile(W.toUnwrapped())===0&&(A=A.concat("SHADOWS_SINGLE_CASCADE"));const se=ie.programConfigurations.get(m.id);let ve,ue,be,Te=o.translatePosMatrix(W.expandedProjMatrix,te,[0,0],"map");if(Te=i.cR(i.bC(),Te,[1,1,g.verticalScale]),N&&V){if(yc(te.tileID,ie.maxHeight*G,o))continue;let Ue=V.calculateShadowPassMatrixFromTile(te.tileID.toUnwrapped());Ue=i.cR(i.bC(),Ue,[1,1,g.verticalScale]),be=Gt(Ue),ve=ue=o.getOrCreateProgram("buildingDepth",{config:se,defines:A,overrideFog:!1})}else if(R)ve=ue=o.getOrCreateProgram("buildingBloom",{config:se,defines:A,overrideFog:!1}),be=pt(Te);else{const Ue=o.transform.calculatePosMatrix(W.toUnwrapped(),o.transform.worldSize);i.cR(Ue,Ue,[1,1,g.verticalScale]);const Fe=i.bC();i.cR(Fe,Ue,[1,-1,1/G]),i.bl(Fe,Fe),i.ed(Fe,Fe);const Ve=o.transform.getFreeCameraOptions().position,ze=1<<W.canonical.z;be=pn(Te,Fe,g.opacity,g.facadeAOIntensity,[((Ve.x-W.wrap)*ze-W.canonical.x)*i.al,(Ve.y*ze-W.canonical.y)*i.al,Ve.z*ze*i.al],ie.tileToMeter,g.facadeEmissiveChance),ue=o.getOrCreateProgram("building",{config:se,defines:A,overrideFog:!1});const Oe=A.concat(["BUILDING_FAUX_FACADE","HAS_ATTRIBUTE_a_faux_facade_color_emissive"]);ve=o.getOrCreateProgram("building",{config:se,defines:Oe,overrideFog:!1}),V&&(V.setupShadowsFromMatrix(Ue,ue,!0),V.setupShadowsFromMatrix(Ue,ve,!0))}const ke=(Ue,Fe)=>{if(R){const Ve=Ue.entranceBloom;Fe.draw(o,k.gl.TRIANGLES,g.depthMode,sr.disabled,g.blendMode,hr.disabled,be,m.id,Ve.layoutVertexBuffer,Ve.indexBuffer,Ve.segmentsBucket,m.paint,o.transform.zoom,se,[Ve.layoutAttenuationBuffer,Ve.layoutColorBuffer])}else{const Ve=Ue.segmentsBucket;let ze=[Ue.layoutNormalBuffer,Ue.layoutCentroidBuffer,Ue.layoutColorBuffer];Ue.layoutFacadePaintBuffer&&(ze=ze.concat([Ue.layoutFacadeDataBuffer,Ue.layoutFacadeVerticalRangeBuffer,Ue.layoutFacadePaintBuffer])),Fe.draw(o,k.gl.TRIANGLES,g.depthMode,sr.disabled,g.blendMode,N?hr.disabled:hr.backCW,be,m.id,Ue.layoutVertexBuffer,Ue.indexBuffer,Ve,m.paint,o.transform.zoom,se,ze)}};o.uploadCommonUniforms(k,ue,W.toUnwrapped(),null,X),ie.buildingWithoutFacade&&ke(ie.buildingWithoutFacade,ue),ve!==ue&&o.uploadCommonUniforms(k,ve,W.toUnwrapped(),null,X),ie.buildingWithFacade&&ke(ie.buildingWithFacade,ve)}}function Cd(g){return[g[0]*i.ee,g[1]*i.ee,g[2]*i.ee,0]}function au(g,o,d,m,S,A,k,N,R){const V=m.getSource(),G=d.globeSharedBuffers;if(!G)return;let X,W,te;if(o&&(X=m.getTile(o)),V instanceof i.aS?(W=V.texture,te=i.dG(0,0,d.transform)):X&&o&&(W=X.texture,te=i.dG(o.canonical.z,o.canonical.x,d.transform)),!W||!te)return;g||(te=i.cR(i.bC(),te,[1,-1,1]));const ie=d.context,se=ie.gl,ve=S.paint.get("raster-resampling")==="nearest"?se.NEAREST:se.LINEAR,ue=d.colorModeForDrapableLayerRenderPass(A),be=k.defines;be.push("GLOBE_POLES");const Te=new Ln(se.LEQUAL,Ln.ReadWrite,d.depthRangeFor3D),ke=Float32Array.from(d.transform.expandedFarZProjMatrix),Ue=Float32Array.from(i.bk(i.dF(new i.cC(0,0,0))));d.terrain&&d.terrain.prepareDrawTile(),ie.activeTexture.set(se.TEXTURE0),W.bind(ve,se.CLAMP_TO_EDGE),ie.activeTexture.set(se.TEXTURE1),W.bind(ve,se.CLAMP_TO_EDGE),"useMipmap"in W&&ie.extTextureFilterAnisotropic&&d.transform.pitch>20&&se.texParameterf(se.TEXTURE_2D,ie.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ie.extTextureFilterAnisotropicMax);const[Fe,Ve,ze,Oe]=o?G.getPoleBuffers(o.canonical.z,!1):G.getPoleBuffers(0,!0),Ge=S.paint.get("raster-elevation");let Tt;g?(Tt=Fe,d.renderDefaultNorthPole=Ge!==0):(Tt=Ve,d.renderDefaultSouthPole=Ge!==0);const ut=Cd(k.mix),jt=((Dt,gn,St,it,Ut,Nt,Qt,mn,Nn,dn,rn,Qn,Kn)=>Hn(Dt,gn,St,new Float32Array(16),new Float32Array(9),[0,0],it,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Nt,[0,0],mn,2,dn,rn,Qn,1,0,Kn))(ke,Ue,te,i.aj(d.transform.zoom),0,S,0,Ge,0,ut,k.offset,k.range,A),bt=d.getOrCreateProgram("raster",{defines:be});d.uploadCommonUniforms(ie,bt,null),bt.draw(d,se.TRIANGLES,Te,R,ue,N,jt,S.id,Tt,ze,Oe)}function pl(g){const o=g._nearZ,d=g.projection.farthestPixelDistance(g),m=d-o,S=.2*g.height,A=o+S;return[o,d,(A-S-o)/m,(A-o)/m]}function fg(g,o,d,m){if(g)return o instanceof ku&&g instanceof Nu?o.getTextureDescriptor(g,d,!0):{texture:g.texture,mix:Cd(m.mix),offset:m.offset,buffer:0,tileSize:1}}var Gv=i.ef([{name:"a_index",type:"Int16",components:1}]);class By{constructor(o,d,m,S){const A={width:m[0],height:m[1],data:null},k=o.gl;this.targetColorTexture=new i.T(o,A,k.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(o,A,k.RGBA8,{useMipmap:!1}),this.context=o,this.updateParticleTexture(d,S),this.lastInvalidatedAt=0}updateParticleTexture(o,d){if(this.particleTextureDimension===d.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const m=this.context.gl,S=d.width*d.height;this.particleTexture0=new i.T(this.context,d,m.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,d,m.RGBA8,{premultiply:!1,useMipmap:!1});const A=new i.eg;A.reserve(S);for(let k=0;k<S;k++)A.emplaceBack(k);this.particleIndexBuffer=this.context.createVertexBuffer(A,Gv.members,!0),this.particleSegment=i.bg.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=d.width}update(o){return!(this.lastInvalidatedAt<o&&(this.lastInvalidatedAt=i.o.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Qo(g,o,d){if(!g)return null;const m=o.getTextureDescriptor(g,d,!0);if(!m)return null;let{texture:S,mix:A,offset:k,tileSize:N,buffer:R,format:V}=m;if(!S||!V)return null;let G=!1;return V==="uint32"&&(G=!0,A[3]=0,A=jn(i.eh,A,[0,d.paint.get("raster-particle-max-speed")]),k=rr(i.eh,k,[0,d.paint.get("raster-particle-max-speed")])),{texture:S,textureOffset:[R/(N+2*R),N/(N+2*R)],tileSize:N,scalarData:G,scale:A,offset:k,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[V]]}}function Hv(g){const o=g._nearZ,d=g.projection.farthestPixelDistance(g),m=d-o,S=.2*g.height,A=o+S;return[o,d,(A-S-o)/m,(A-o)/m]}const Nl=new i.ao(1,0,0,1),Ed=new i.ao(0,1,0,1),ih=new i.ao(0,0,1,1),Wv=new i.ao(1,0,1,1),Zv=new i.ao(0,1,1,1);function Uy(g,o,d,m,S,A){for(let k=0;k<d.length;k++)if(S){const V=new i.ao(m.r*.8,m.g*.8,m.b*.8,1);Hh(g,o,d[k],m,-1,-1,A),Hh(g,o,d[k],m,-1,1,A),Hh(g,o,d[k],m,1,1,A),Hh(g,o,d[k],m,1,-1,A),Hh(g,o,d[k],V,0,0,A)}else Hh(g,o,d[k],m,0,0,A)}function Hh(g,o,d,m,S,A,k){const N=g.context,R=g.transform,V=N.gl,G=R.projection.name==="globe",X=G?["PROJECTION_GLOBE_VIEW"]:[];let W=i.bz(d.projMatrix);if(G&&i.aj(R.zoom)>0){const ut=i.bj(d.canonical,R),jt=i.ei(ut);W=i.aB(new Float32Array(16),R.globeMatrix,jt),i.aB(W,R.projMatrix,W)}const te=i.bC();te[12]+=2*S/(i.o.devicePixelRatio*R.width),te[13]+=2*A/(i.o.devicePixelRatio*R.height),i.aB(W,te,W);const ie=g.getOrCreateProgram("debug",{defines:X}),se=o.getTileByID(d.key);g.terrain&&g.terrain.setupElevationDraw(se,ie);const ve=Ln.disabled,ue=sr.disabled,be=g.colorModeForRenderPass(),Te="$debug";N.activeTexture.set(V.TEXTURE0),g.emptyTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),G?se._makeGlobeTileDebugBuffers(g.context,R):se._makeDebugTileBoundsBuffers(g.context,R.projection);const ke=se._tileDebugBuffer||g.debugBuffer,Ue=se._tileDebugIndexBuffer||g.debugIndexBuffer,Fe=se._tileDebugSegments||g.debugSegments;if(ie.draw(g,V.LINE_STRIP,ve,ue,be,hr.disabled,In(W,m.toPremultipliedRenderColor(null)),Te,ke,Ue,Fe,null,null,null,[se._globeTileDebugBorderBuffer]),k){const ut=se.latestRawTileData,jt=Math.floor((ut&&ut.byteLength||0)/1024);let bt=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(bt+=` => ${d.overscaledZ}`),bt+=` ${se.state}`,bt+=` ${jt}kb`,function(Dt,gn){Dt.initDebugOverlayCanvas();const St=Dt.debugOverlayCanvas,it=Dt.context.gl,Ut=Dt.debugOverlayCanvas.getContext("2d");Ut.clearRect(0,0,St.width,St.height),Ut.shadowColor="white",Ut.shadowBlur=2,Ut.lineWidth=1.5,Ut.strokeStyle="white",Ut.textBaseline="top",Ut.font="bold 36px Open Sans, sans-serif",Ut.fillText(gn,5,5),Ut.strokeText(gn,5,5),Dt.debugOverlayTexture.update(St),Dt.debugOverlayTexture.bind(it.LINEAR,it.CLAMP_TO_EDGE)}(g,bt)}const Ve=o.getTile(d).tileSize,ze=512/Math.min(Ve,512)*(d.overscaledZ/R.zoom)*.5,Oe=se._tileDebugTextBuffer||g.debugBuffer,Ge=se._tileDebugTextIndexBuffer||g.quadTriangleIndexBuffer,Tt=se._tileDebugTextSegments||g.debugSegments;ie.draw(g,V.TRIANGLES,ve,ue,kr.alphaBlended,hr.disabled,In(W,i.ao.transparent.toPremultipliedRenderColor(null),ze),Te,Oe,Ge,Tt,null,null,null,[se._globeTileDebugTextBuffer])}function Fc(g,o,d,m){Wh(g,0,o+d/2,g.transform.width,d,m)}function hs(g,o,d,m){Wh(g,o-d/2,0,d,g.transform.height,m)}function Wh(g,o,d,m,S,A){const k=g.context,N=k.gl;N.enable(N.SCISSOR_TEST),N.scissor(o*i.o.devicePixelRatio,d*i.o.devicePixelRatio,m*i.o.devicePixelRatio,S*i.o.devicePixelRatio),k.clear({color:A}),N.disable(N.SCISSOR_TEST)}const Yp=i.ef([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Vy}=Yp;function zc(g,o,d,m){g.emplaceBack(o,d,m)}class $y{constructor(o){this.vertexArray=new i.ej,this.indices=new i.b1,zc(this.vertexArray,-1,-1,1),zc(this.vertexArray,1,-1,1),zc(this.vertexArray,-1,1,1),zc(this.vertexArray,1,1,1),zc(this.vertexArray,-1,-1,-1),zc(this.vertexArray,1,-1,-1),zc(this.vertexArray,-1,1,-1),zc(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,Vy),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=i.bg.simpleSegment(0,0,36,12)}}function Wf(g,o,d,m,S,A){const k=g.context.gl,N=o.paint.get("sky-atmosphere-color"),R=o.paint.get("sky-atmosphere-halo-color"),V=o.paint.get("sky-atmosphere-sun-intensity"),G=((X,W,te,ie,se)=>({u_matrix_3f:X,u_sun_direction:W,u_sun_intensity:te,u_color_tint_r:[ie.r,ie.g,ie.b,ie.a],u_color_tint_m:[se.r,se.g,se.b,se.a],u_luminance:5e-5}))(i.el(i.dL(),m),S,V,N.toPremultipliedRenderColor(null),R.toPremultipliedRenderColor(null));k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_CUBE_MAP_POSITIVE_X+A,o.skyboxTexture,0),d.draw(g,k.TRIANGLES,Ln.disabled,sr.disabled,kr.unblended,hr.frontCW,G,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const Pd=i.ef([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Zh{constructor(o){const d=new i.em;d.emplaceBack(-1,1,1,0,0),d.emplaceBack(1,1,1,1,0),d.emplaceBack(1,-1,1,1,1),d.emplaceBack(-1,-1,1,0,1);const m=new i.b1;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(d,Pd.members),this.indexBuffer=o.createIndexBuffer(m),this.segments=i.bg.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const un=i.ef([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class wn{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Zf{constructor(o){this.colorModeAlphaBlendedWriteRGB=new kr([1,bs,1,bs],i.ao.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new kr([1,0,1,0],i.ao.transparent,[!1,!1,!1,!0]),this.params=new wn,this.updateNeeded=!0,o.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),o.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),o.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),o.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(o){const d=o.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Zh(d);const m=this.params.sizeRange,S=this.params.intensityRange,A=function(G){const X=i.eo(30),W=[];for(let te=0;te<G;++te){const ie=2*Math.PI*X(),se=Math.acos(1-2*X())-.5*Math.PI;W.push(i.d4(Math.cos(se)*Math.cos(ie),Math.cos(se)*Math.sin(ie),Math.sin(se)))}return W}(this.params.starsCount),k=i.eo(300),N=new i.en,R=new i.b1;let V=0;for(let G=0;G<A.length;++G){const X=i.c4([],A[G],200),W=Math.max(0,1+.01*m*(1*k()-.5)),te=Math.max(0,1+.01*S*(1*k()-.5));N.emplaceBack(X[0],X[1],X[2],-1,-1,W,te),N.emplaceBack(X[0],X[1],X[2],1,-1,W,te),N.emplaceBack(X[0],X[1],X[2],1,1,W,te),N.emplaceBack(X[0],X[1],X[2],-1,1,W,te),R.emplaceBack(V+0,V+1,V+2),R.emplaceBack(V+0,V+2,V+3),V+=4}this.starsVx=d.createVertexBuffer(N,un.members),this.starsIdx=d.createIndexBuffer(R),this.starsSegments=i.bg.simpleSegment(0,0,N.length,R.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(o,d){const m=o.context,S=m.gl,A=o.transform,k=new Ln(S.LEQUAL,Ln.ReadOnly,[0,1]),N=i.aj(A.zoom),R=o.style.getLut(d.scope),V=d.properties.get("color-use-theme")==="none",G=d.properties.get("color").toNonPremultipliedRenderColor(V?null:R),X=d.properties.get("high-color-use-theme")==="none",W=d.properties.get("high-color").toNonPremultipliedRenderColor(X?null:R),te=d.properties.get("space-color-use-theme")==="none",ie=d.properties.get("space-color").toNonPremultipliedRenderColor(te?null:R),se=5e-4,ve=i.ep(d.properties.get("horizon-blend"),0,1,se,.25),ue=i.dA(o,m,A)&&ve===se?A.worldSize/(2*Math.PI*1.025)-1:A.globeRadius,be=o.frameCounter/1e3%1,Te=i.ag(A.globeCenterInViewSpace),ke=Math.sqrt(Math.pow(Te,2)-Math.pow(ue,2)),Ue=Math.acos(ke/Te),Fe=Ve=>{const ze=A.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ve&&ze.push("ALPHA_PASS");const Oe=o.getOrCreateProgram("globeAtmosphere",{defines:ze}),Ge=((ut,jt,bt,Dt,gn,St,it,Ut,Nt,Qt,mn,Nn)=>({u_frustum_tl:ut,u_frustum_tr:jt,u_frustum_br:bt,u_frustum_bl:Dt,u_horizon:gn,u_transition:St,u_fadeout_range:it,u_atmosphere_fog_color:Ut.toArray01(),u_high_color:Nt.toArray01(),u_space_color:Qt.toArray01(),u_temporal_offset:mn,u_horizon_angle:Nn}))(A.frustumCorners.TL,A.frustumCorners.TR,A.frustumCorners.BR,A.frustumCorners.BL,A.frustumCorners.horizon,N,ve,G,W,ie,be,Ue);o.uploadCommonUniforms(m,Oe);const Tt=this.atmosphereBuffer;Tt&&Oe.draw(o,S.TRIANGLES,k,sr.disabled,Ve?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,hr.backCW,Ge,Ve?"atmosphere_glow_alpha":"atmosphere_glow",Tt.vertexBuffer,Tt.indexBuffer,Tt.segments)};Fe(!1),Fe(!0)}drawStars(o,d){const m=i.aA(d.properties.get("star-intensity"),0,1);if(m===0)return;const S=o.context,A=S.gl,k=o.transform,N=o.getOrCreateProgram("stars"),R=i.c6([]);i.c8(R,R,-k._pitch),i.c7(R,R,-k.angle),i.c8(R,R,i.an(k._center.lat)),i.eq(R,R,-i.an(k._center.lng));const V=i.cb(new Float32Array(16),R),G=i.aB([],k.starsProjMatrix,V),X=i.el([],V),W=i.er([],X),te=[0,1,0];i.dN(te,te,W),i.c4(te,te,this.params.sizeMultiplier);const ie=[1,0,0];i.dN(ie,ie,W),i.c4(ie,ie,this.params.sizeMultiplier);const se=(ve=te,ue=ie,be=m,{u_matrix:Float32Array.from(G),u_up:ve,u_right:ue,u_intensity_multiplier:be});var ve,ue,be;o.uploadCommonUniforms(S,N),this.starsVx&&this.starsIdx&&N.draw(o,A.TRIANGLES,Ln.disabled,sr.disabled,this.colorModeAlphaBlendedWriteRGB,hr.disabled,se,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}class Zs{constructor(){this.visibleTiles=[]}updateBorders(o,d){const m=[],S=[],A=o._getRenderableCoordinates(!1,!0);for(const R of A){const V=o.getTile(R);if(!V.hasData())continue;const G=V.getBucket(d);G&&(G.isEmpty()||(m.push(R.key),S.push({bucket:G,tileID:R.canonical})))}let k=m.length!==this.visibleTiles.length;if(!k){m.sort();for(let R=0;R<m.length;R++)if(m[R]!==this.visibleTiles[R]){k=!0;break}}if(!k)return;const N=new Set;this.visibleTiles=m,S.sort((R,V)=>R.tileID.z-V.tileID.z||R.tileID.x-V.tileID.x||R.tileID.y-V.tileID.y);for(const R of S){const V=new Array,G=new Array,X=R.bucket;for(const W of X.featuresOnBorder)N.has(W.featureId)?G.push(W.footprintIndex):(N.add(W.featureId),V.push(W.footprintIndex));X.updateFootprintHiddenFlags(V,i.es,!1),X.updateFootprintHiddenFlags(G,i.es,!0)}}}function yt(g,o){const d=[...g],m=o.cameraWorldSizeForFog/o.worldSize,S=i.bA([]);return i.cR(S,S,[m,m,1]),i.aB(d,S,d),i.aB(d,o.worldToFogMatrix,d),d}function pg(g,o,d,m,S){const A=d.material,k=m.context,{baseColorTexture:N,metallicRoughnessTexture:R}=A.pbrMetallicRoughness,{normalTexture:V,occlusionTexture:G,emissionTexture:X}=A;function W(ie,se,ve){if(ie&&(g.push(se),k.activeTexture.set(k.gl.TEXTURE0+ve),ie.gfxTexture)){const{minFilter:ue,magFilter:be,wrapS:Te,wrapT:ke}=ie.sampler;ie.gfxTexture.bindExtraParam(ue,be,Te,ke)}}W(N,"HAS_TEXTURE_u_baseColorTexture",Ms.BaseColor),W(R,"HAS_TEXTURE_u_metallicRoughnessTexture",Ms.MetallicRoughness),W(V,"HAS_TEXTURE_u_normalTexture",Ms.Normal),W(G,"HAS_TEXTURE_u_occlusionTexture",Ms.Occlusion),W(X,"HAS_TEXTURE_u_emissionTexture",Ms.Emission),S&&(S.texture||(S.texture=new i.dY(m.context,S.image,[S.image.height,S.image.height,S.image.height],k.gl.RGBA8)),k.activeTexture.set(k.gl.TEXTURE0+Ms.LUT),S.texture&&S.texture.bind(k.gl.LINEAR,k.gl.CLAMP_TO_EDGE),g.push("APPLY_LUT_ON_GPU")),d.texcoordBuffer&&(g.push("HAS_ATTRIBUTE_a_uv_2f"),o.push(d.texcoordBuffer)),d.colorBuffer&&(g.push(d.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),o.push(d.colorBuffer)),d.normalBuffer&&(g.push("HAS_ATTRIBUTE_a_normal_3f"),o.push(d.normalBuffer)),d.pbrBuffer&&(g.push("HAS_ATTRIBUTE_a_pbr"),g.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),o.push(d.pbrBuffer)),A.alphaMode!=="OPAQUE"&&A.alphaMode!=="MASK"||g.push("UNPREMULT_TEXTURE_IN_SHADER"),A.defined||g.push("DIFFUSE_SHADED");const te=m.shadowRenderer;te&&(g.push("RENDER_SHADOWS","DEPTH_TEXTURE"),te.useNormalOffset&&g.push("NORMAL_OFFSET"))}function ou(g,o,d,m,S,A){const k=d.paint.get("model-opacity").constantOr(1),N=o.context,R=new Ln(o.context.gl.LEQUAL,Ln.ReadWrite,o.depthRangeFor3D),V=o.transform,G=g.mesh,X=G.material,W=X.pbrMetallicRoughness,te=o.style.fog;let ie;ie=o.transform.projection.zAxisUnit==="pixels"?[...g.nodeModelMatrix]:i.aB([],m.zScaleMatrix,g.nodeModelMatrix),i.aB(ie,m.negCameraPosMatrix,ie);const se=i.bl([],ie);i.ed(se,se);const ve=d.paint.get("model-color-use-theme").constantOr("default")==="none",ue=d.paint.get("model-emissive-strength").constantOr(0),be=Fi(new Float32Array(g.worldViewProjection),new Float32Array(ie),new Float32Array(se),null,o,k,W.baseColorFactor,X.emissiveFactor,W.metallicFactor,W.roughnessFactor,X,ue,d),Te={defines:[]},ke=[],Ue=o.shadowRenderer;Ue&&(Ue.useNormalOffset=!1),pg(Te.defines,ke,G,o,ve?null:d.lut);let Fe=null;if(te){const Oe=yt(g.nodeModelMatrix,o.transform);if(Fe=new Float32Array(Oe),V.projection.name!=="globe"){const Ge=G.aabb.min,Tt=G.aabb.max,[ut,jt]=te.getOpacityForBounds(Oe,Ge[0],Ge[1],Tt[0],Tt[1]);Te.overrideFog=ut>=Vn||jt>=Vn}}const Ve=fa(o,d.paint.get("model-cutoff-fade-range"));Ve.shouldRenderCutoff&&Te.defines.push("RENDER_CUTOFF");const ze=o.getOrCreateProgram("model",Te);o.uploadCommonUniforms(N,ze,null,Fe,Ve),o.renderPass!=="shadow"&&Ue&&Ue.setupShadowsFromMatrix(g.nodeModelMatrix,ze),ze.draw(o,N.gl.TRIANGLES,R,S,A,G.material.doubleSided?hr.disabled:hr.backCCW,be,d.id,G.vertexBuffer,G.indexBuffer,G.segments,d.paint,o.transform.zoom,void 0,ke)}function qy(g,o,d,m,S,A,k){let N;N=g.projection.name==="globe"?i.eu(d,g):[...d],i.aB(N,N,o.matrix);const R=i.aB([],m,N);if(o.meshes)for(const V of o.meshes){if(V.material.alphaMode!=="BLEND"){k.push({mesh:V,depth:0,modelIndex:S,worldViewProjection:R,nodeModelMatrix:N});continue}const G=i.af([],V.centroid,R);!g.isOrthographic&&G[2]<=0||A.push({mesh:V,depth:G[2],modelIndex:S,worldViewProjection:R,nodeModelMatrix:N})}if(o.children)for(const V of o.children)qy(g,V,d,m,S,A,k)}function Xp(g,o,d,m){const S=d.shadowRenderer;if(!S)return;const A=S.getShadowPassDepthMode(),k=S.getShadowPassColorMode(),N=S.calculateShadowPassMatrixFromMatrix(o),R=ds(N);d.getOrCreateProgram("modelDepth",{defines:d._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(d,d.context.gl.TRIANGLES,A,sr.disabled,k,hr.backCCW,R,m.id,g.vertexBuffer,g.indexBuffer,g.segments,m.paint,d.transform.zoom,void 0,void 0)}function Wx(g,o,d){const m=o.updateZoomBasedPaintProperties(),S=function(A,k,N){let R,V,G,X=A.terrain?A.terrain.exaggeration():0;if(A.terrain&&X>0){const W=A.terrain,te=W.findDEMTileFor(N);te&&te.dem?R=i.ew.create(W,N,te):X=0}if(X===0&&(k.terrainElevationMin=0,k.terrainElevationMax=0),X===k.validForExaggeration&&(X===0||R&&R._demTile&&R._demTile.tileID===k.validForDEMTile.id&&R._dem._timestamp===k.validForDEMTile.timestamp))return!1;for(const W in k.instancesPerModel){const te=k.instancesPerModel[W];for(let ie=0;ie<te.instancedDataArray.length;++ie){const se=(R?X*R.getElevationAt(0|te.instancedDataArray.float32[16*ie],0|te.instancedDataArray.float32[16*ie+1],!0,!0):0)+te.instancesEvaluatedElevation[ie];te.instancedDataArray.float32[16*ie+6]=se,V=V?Math.min(k.terrainElevationMin,se):se,G=G?Math.max(k.terrainElevationMax,se):se}}return k.terrainElevationMin=V||0,k.terrainElevationMax=G||0,k.validForExaggeration=X,k.validForDEMTile=R&&R._demTile?{id:R._demTile.tileID,timestamp:R._dem._timestamp}:{id:void 0,timestamp:0},!0}(g,o,d);(m||S)&&(o.uploaded=!1,o.upload(g.context))}const lu={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.d8([0,0,0],[i.al,i.al,0])};function Jp(g,o){const d=1<<g.canonical.z,m=o.getFreeCameraOptions().position,S=o.elevation,A=g.canonical.x/d,k=(g.canonical.x+1)/d,N=g.canonical.y/d,R=(g.canonical.y+1)/d;let V=o._centerAltitude;if(S){const te=S.getMinMaxForTile(g);te&&te.max>V&&(V=te.max)}const G=i.aA(m.x,A,k)-m.x,X=i.aA(m.y,N,R)-m.y,W=i.ce(V,o.center.lat)-m.z;return o._zoomFromMercatorZ(Math.sqrt(G*G+X*X+W*W))}function Qp(g,o,d,m,S,A,k){const N=g.context,R=g.renderPass==="shadow",V=g.shadowRenderer,G=R&&V?V.getShadowPassDepthMode():new Ln(N.gl.LEQUAL,Ln.ReadWrite,g.depthRangeFor3D),X=g.isTileAffectedByFog(A);if(d.meshes)for(const W of d.meshes){const te=["MODEL_POSITION_ON_GPU"],ie=[];let se,ve,ue;m.instancedDataArray.length>20&&te.push("INSTANCED_ARRAYS");const be=fa(g,o.paint.get("model-cutoff-fade-range"));if(be.shouldRenderCutoff&&te.push("RENDER_CUTOFF"),R&&V)se=g.getOrCreateProgram("modelDepth",{defines:te}),ve=ds(k.shadowTileMatrix,k.shadowTileMatrix,Float32Array.from(d.matrix)),ue=V.getShadowPassColorMode();else{pg(te,ie,W,g,o.paint.get("model-color-use-theme").constantOr("default")==="none"?null:o.lut),se=g.getOrCreateProgram("model",{defines:te,overrideFog:X});const ke=W.material,Ue=ke.pbrMetallicRoughness,Fe=o.paint.get("model-opacity").constantOr(1),Ve=o.paint.get("model-emissive-strength").constantOr(0);ve=Fi(A.expandedProjMatrix,Float32Array.from(d.matrix),new Float32Array(16),null,g,Fe,Ue.baseColorFactor,ke.emissiveFactor,Ue.metallicFactor,Ue.roughnessFactor,ke,Ve,o,S),V&&(k.shadowUniformsInitialized?se.setShadowUniformValues(N,V.getShadowUniformValues()):(V.setupShadows(A.toUnwrapped(),se,"model-tile"),k.shadowUniformsInitialized=!0)),ue=be.shouldRenderCutoff||Fe<1||ke.alphaMode!=="OPAQUE"?kr.alphaBlended:kr.unblended}g.uploadCommonUniforms(N,se,A.toUnwrapped(),null,be);const Te=W.material.doubleSided?hr.disabled:hr.backCCW;if(m.instancedDataArray.length>20)ie.push(m.instancedDataBuffer),se.draw(g,N.gl.TRIANGLES,G,sr.disabled,ue,Te,ve,o.id,W.vertexBuffer,W.indexBuffer,W.segments,o.paint,g.transform.zoom,void 0,ie,m.instancedDataArray.length);else{const ke=R?"u_instance":"u_normal_matrix";for(let Ue=0;Ue<m.instancedDataArray.length;++Ue)ve[ke]=new Float32Array(m.instancedDataArray.arrayBuffer,64*Ue,16),se.draw(g,N.gl.TRIANGLES,G,sr.disabled,ue,Te,ve,o.id,W.vertexBuffer,W.indexBuffer,W.segments,o.paint,g.transform.zoom,void 0,ie)}}if(d.children)for(const W of d.children)Qp(g,o,W,m,S,A,k)}const Kv=[1,-1,1];function mg(g,o,d,m){if(!d.modelManager)return!0;const S=d.modelManager;if(!d.shadowRenderer)return!0;const A=d.shadowRenderer,k=o.aabb;let N=!0,R=g.maxHeight;if(R===0){let G=0;for(const X in g.instancesPerModel){const W=S.getModel(X,m);W?G=Math.max(G,Math.max(Math.max(W.aabb.max[0],W.aabb.max[1]),W.aabb.max[2])):N=!1}R=g.maxScale*G*1.41+g.maxVerticalOffset,N&&(g.maxHeight=R)}k.max[2]=R,k.min[2]+=g.terrainElevationMin,k.max[2]+=g.terrainElevationMax,i.af(k.min,k.min,o.tileMatrix),i.af(k.max,k.max,o.tileMatrix);const V=k.intersects(A.getCurrentCascadeFrustum());return d.currentShadowCascade===0&&(g.isInsideFirstShadowMapFrustum=V===2),V===0}function cu(g,o){const d=g.uniformValues.u_cutoff_params[0],m=g.uniformValues.u_cutoff_params[1],S=g.uniformValues.u_cutoff_params[2],A=g.uniformValues.u_cutoff_params[3];return m===d||A===S?1:i.aA(((o-d)/(m-d)-S)/(A-S),0,1)}function kd(g,o,d,m){if(o.pitch<20)return 1;const S=o.getWorldToCameraMatrix();i.aB(S,S,g);const A=i.bU(d.min[0],d.min[1],d.min[2],1);let k=i.aC(i.ex(),A,S),N=k,R=k;A[1]=d.max[1],k=i.aC(i.ex(),A,S),N=k[1]<N[1]?k:N,R=k[1]>R[1]?k:R,A[0]=d.max[0],k=i.aC(i.ex(),A,S),N=k[1]<N[1]?k:N,R=k[1]>R[1]?k:R,A[1]=d.min[1],k=i.aC(i.ex(),A,S),N=k[1]<N[1]?k:N,R=k[1]>R[1]?k:R;const V=i.aA(m[0],0,1),G=100*o.pixelsPerMeter*i.aA(m[1],0,1),X=i.aA(m[2],0,1),W=i.ey(i.ex(),N,R,V),te=Math.tan(.5*o.fovX),ie=-W[2]*te;if(G===0)return W[1]<-Math.abs(ie)?X:1;const se=(-Math.abs(ie)-W[1])/G,ve=(be,Te,ke)=>(1-ke)*be+ke*Te,ue=i.aA(ve(1,X,se),X,1);return ve(1,ue,i.aA((o.pitch-20)/20,0,1))}class sh{}class gg{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(o,d,m){{const X=this._storage.get(d.id);if(X)return X.lastUsedFrameIdx=o,X.buf}const S=m.gl,A=S.getBufferParameter(S.ELEMENT_ARRAY_BUFFER,S.BUFFER_SIZE),k=new ArrayBuffer(A),N=new Int16Array(k);S.getBufferSubData(S.ELEMENT_ARRAY_BUFFER,0,new Int16Array(k));const R=new i.eA;for(let X=0;X<A/2;X+=3){const W=N[X],te=N[X+1],ie=N[X+2];R.emplaceBack(W,te),R.emplaceBack(te,ie),R.emplaceBack(ie,W)}const V=m.bindVertexArrayOES.current,G=new sh;return G.buf=new Fa(m,R),G.lastUsedFrameIdx=o,this._storage.set(d.id,G),m.bindVertexArrayOES.set(V),G.buf}update(o){for(const[d,m]of this._storage)o-m.lastUsedFrameIdx>30&&(m.buf.destroy(),this._storage.delete(d))}destroy(){for(const[o,d]of this._storage)d.buf.destroy(),this._storage.delete(o)}}class em{constructor(o){this.occluderSize=30,this.depthOffset=-1e-4,o.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),o.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const tm=i.ef([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class nm{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class yg{constructor(o,d){this.revealStart=11,this.revealRange=2,o.registerParameter(this,[...d,"Reveal"],"revealStart",{min:0,max:17,step:.05}),o.registerParameter(this,[...d,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const Gy=i.ef([{type:"Float32",name:"a_pos_2f",components:2}]);class xN{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(o,d){const m=o.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const k=new i.eB,N=new i.b1;k.emplaceBack(-1,-1),k.emplaceBack(1,-1),k.emplaceBack(1,1),k.emplaceBack(-1,1),N.emplaceBack(0,1,2),N.emplaceBack(0,2,3),this.vignetteVx=o.context.createVertexBuffer(k,Gy.members),this.vignetteIdx=o.context.createIndexBuffer(N)}const S=i.bg.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){o.uploadCommonUniforms(o.context,m);const k={u_vignetteShape:(A={vignetteShape:[d.start,d.range,Math.pow(10,d.fadePower)],vignetteColor:[d.color.r,d.color.g,d.color.b,d.color.a*d.strength]}).vignetteShape,u_vignetteColor:A.vignetteColor};m.draw(o,o.context.gl.TRIANGLES,Ln.disabled,sr.disabled,kr.alphaBlended,hr.disabled,k,"vignette",this.vignetteVx,this.vignetteIdx,S)}var A}}class pT{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(o,d){const m=o.getFreeCameraOptions().position,S=m.toAltitude(),A=m.toLngLat(),k=i.an(A.lng),N=i.an(A.lat),R=o.pixelsPerMeter/d,V=k*i.eD,G=i.eD*Math.log(Math.tan(Math.PI/4+N/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const X=-this._offsetYPrev+G,W=-this._elevationPrev+S;this._accumulatedOffsetX+=(-this._offsetXPrev+V)*R,this._accumulatedOffsetY+=X*R,this._accumulatedElevation+=W*R,this._offsetXPrev=V,this._offsetYPrev=G,this._elevationPrev=S}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function mT(g,o){return[-(g[0]-Math.floor(g[0]/o)*o),-(g[1]-Math.floor(g[1]/o)*o),-(g[2]-Math.floor(g[2]/o)*o)]}function Zl(g){const o=i.eo(1323123451230),d=[];for(let m=0;m<g;++m){const S=2*o()-1,A=2*o()-1,k=2*o()-1;d.push(i.d4(S,A,k))}return d}function rm(g,o,d,m,S){const A=i.aA((S-d)/(m-d),0,1);return(1-A)*g+A*o}class Hy{constructor(o){this._movement=new pT,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new xN,this._ppmScaleFactor=o}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(o,d){const m=o.transform;this._movement.update(m,this._ppmScaleFactor);const S=m.starsProjMatrix,A=i.c6([]);i.c8(A,A,i.an(90)-m._pitch),i.c7(A,A,-m.angle);const k=i.cb(new Float32Array(16),A),N=i.eC(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),R=i.ed([],N),V=i.aB([],R,k),G=Date.now()/1e3;return this._accumulatedTimeFromStart+=(G-this._prevTime)*d,this._prevTime=G,{projectionMatrix:S,modelviewMatrix:V}}}class Ds extends Hy{constructor(o){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new yg(o.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(o){const d=o.context;if(!this.particlesVx){const m=Zl(this.particlesCount),S=new i.eE,A=new i.b1;let k=0;const N=i.eo(1323123451230);for(let R=0;R<m.length;++R){const V=m[R],G=[2*N()-1,N(),N(),N()];S.emplaceBack(V[0],V[1],V[2],-1,-1,...G),S.emplaceBack(V[0],V[1],V[2],1,-1,...G),S.emplaceBack(V[0],V[1],V[2],1,1,...G),S.emplaceBack(V[0],V[1],V[2],-1,1,...G),A.emplaceBack(k+0,k+1,k+2),A.emplaceBack(k+0,k+2,k+3),k+=4}this.particlesVx=d.createVertexBuffer(S,tm.members),this.particlesIdx=d.createIndexBuffer(A)}}draw(o){if(!this._params.overrideStyleParameters&&!o.style.rain)return;const d=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},m=o.transform.zoom;if(d.revealStart>m)return;const S=rm(0,1,d.revealStart,d.revealStart+d.revealRange,m);if(!this.particlesVx||!this.particlesIdx)return;const A=structuredClone(this._params);let k=[-A.direction.x,A.direction.y,-100];i.aw(k,k);const N=structuredClone(this._vignetteParams);N.strength*=S,A.overrideStyleParameters||(A.intensity=o.style.rain.state.density,A.timeFactor=o.style.rain.state.intensity,A.color=structuredClone(o.style.rain.state.color),k=structuredClone(o.style.rain.state.direction),A.screenThinning.intensity=o.style.rain.state.centerThinning,A.dropletSizeX=o.style.rain.state.dropletSize[0],A.dropletSizeYScale=o.style.rain.state.dropletSize[1]/o.style.rain.state.dropletSize[0],A.distortionStrength=100*o.style.rain.state.distortionStrength,N.strength=1,N.color=structuredClone(o.style.rain.state.vignetteColor));const R=this.updateOnRender(o,A.timeFactor),V=o.context,G=V.gl,X=o.transform;this.screenTexture&&this.screenTexture.size[0]===o.width&&this.screenTexture.size[1]===o.height||(this.screenTexture=new i.T(V,{width:o.width,height:o.height,data:null},G.RGBA8)),A.distortionStrength>0&&(V.activeTexture.set(G.TEXTURE0),this.screenTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),G.copyTexSubImage2D(G.TEXTURE_2D,0,0,0,0,0,o.width,o.height));const W=o.getOrCreateProgram("rainParticle");o.uploadCommonUniforms(V,W),V.activeTexture.set(G.TEXTURE0),this.screenTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE);const te=[A.color.r,A.color.g,A.color.b,A.color.a],ie=(se,ve)=>{const ue=mT(this._movement.getPosition(),se),be=A.dropletSizeX,Te=A.dropletSizeX*A.dropletSizeYScale,ke=o.width/2,Ue=o.height/2,Fe=rm(0,A.screenThinning.start,0,1,A.screenThinning.intensity),Ve=rm(.001,A.screenThinning.range,0,1,A.screenThinning.intensity),ze=rm(0,A.screenThinning.particleOffset,0,1,A.screenThinning.intensity),Oe=(Ge={modelview:R.modelviewMatrix,projection:R.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ue,velocityConeAperture:A.velocityConeAperture,velocity:A.velocity,boxSize:se,rainDropletSize:[be,Te],distortionStrength:A.distortionStrength,rainDirection:k,color:te,screenSize:[X.width,X.height],thinningCenterPos:[ke,Ue],thinningShape:[Fe,Ve,Math.pow(10,A.screenThinning.fadePower)],thinningAffectedRatio:A.screenThinning.affectedRatio,thinningParticleOffset:ze,shapeDirectionalPower:A.shapeDirPower,shapeNormalPower:A.shapeNormalPower,mode:ve?0:1},{u_modelview:Float32Array.from(Ge.modelview),u_projection:Float32Array.from(Ge.projection),u_time:Ge.time,u_cam_pos:Ge.camPos,u_texScreen:0,u_velocityConeAperture:Ge.velocityConeAperture,u_velocity:Ge.velocity,u_boxSize:Ge.boxSize,u_rainDropletSize:Ge.rainDropletSize,u_distortionStrength:Ge.distortionStrength,u_rainDirection:Ge.rainDirection,u_color:Ge.color,u_screenSize:Ge.screenSize,u_thinningCenterPos:Ge.thinningCenterPos,u_thinningShape:Ge.thinningShape,u_thinningAffectedRatio:Ge.thinningAffectedRatio,u_thinningParticleOffset:Ge.thinningParticleOffset,u_shapeDirectionalPower:Ge.shapeDirectionalPower,u_shapeNormalPower:Ge.shapeNormalPower,u_mode:Ge.mode});var Ge;const Tt=Math.round(A.intensity*this.particlesCount),ut=i.bg.simpleSegment(0,0,4*Tt,2*Tt);W.draw(o,G.TRIANGLES,Ln.disabled,sr.disabled,kr.alphaBlended,hr.disabled,Oe,"rain_particles",this.particlesVx,this.particlesIdx,ut)};A.distortionStrength>0&&ie(A.boxSize,!0),ie(A.boxSize,!1),this._vignette.draw(o,N)}}const Ti=i.ef([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class gT extends Hy{constructor(o){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new yg(o.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(o){const d=o.context;if(!this.particlesVx){const m=Zl(this.particlesCount),S=new i.eF,A=new i.b1;let k=0;const N=i.eo(1323123451230);for(let R=0;R<m.length;++R){const V=m[R],G=N(),X=N(),W=N(),te=[R/m.length,G,X,W],ie=[N(),N()];S.emplaceBack(V[0],V[1],V[2],-1,-1,...te,...ie),S.emplaceBack(V[0],V[1],V[2],1,-1,...te,...ie),S.emplaceBack(V[0],V[1],V[2],1,1,...te,...ie),S.emplaceBack(V[0],V[1],V[2],-1,1,...te,...ie),A.emplaceBack(k+0,k+1,k+2),A.emplaceBack(k+0,k+2,k+3),k+=4}this.particlesVx=d.createVertexBuffer(S,Ti.members),this.particlesIdx=d.createIndexBuffer(A)}}draw(o){if(!this._params.overrideStyleParameters&&!o.style.snow)return;const d=structuredClone(this._params);let m=[-d.direction.x,d.direction.y,-100];i.aw(m,m);const S=structuredClone(this._vignetteParams),A=d.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},k=o.transform.zoom;if(A.revealStart>k)return;const N=rm(0,1,A.revealStart,A.revealStart+A.revealRange,k);S.strength*=N,d.overrideStyleParameters||(d.intensity=o.style.snow.state.density,d.timeFactor=o.style.snow.state.intensity,d.color=structuredClone(o.style.snow.state.color),m=structuredClone(o.style.snow.state.direction),d.screenThinning.intensity=o.style.snow.state.centerThinning,d.billboardSize=2.79*o.style.snow.state.flakeSize,S.strength=1,S.color=structuredClone(o.style.snow.state.vignetteColor));const R=this.updateOnRender(o,d.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const V=o.context,G=V.gl,X=o.transform,W=o.getOrCreateProgram("snowParticle");o.uploadCommonUniforms(V,W),((te,ie,se)=>{const ve=mT(this._movement.getPosition(),te),ue=X.width/2,be=X.height/2,Te=rm(0,se.screenThinning.start,0,1,se.screenThinning.intensity),ke=rm(.001,se.screenThinning.range,0,1,se.screenThinning.intensity),Ue=rm(0,se.screenThinning.particleOffset,0,1,se.screenThinning.intensity),Fe=(Ve={modelview:R.modelviewMatrix,projection:R.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ve,velocityConeAperture:se.velocityConeAperture,velocity:se.velocity,horizontalOscillationRadius:se.horizontalOscillationRadius,horizontalOscillationRate:se.horizontalOscillationRate,boxSize:te,billboardSize:1*se.billboardSize,simpleShapeParameters:[se.shapeFadeStart,se.shapeFadePower],screenSize:[X.width,X.height],thinningCenterPos:[ue,be],thinningShape:[Te,ke,Math.pow(10,se.screenThinning.fadePower)],thinningAffectedRatio:se.screenThinning.affectedRatio,thinningParticleOffset:Ue,color:[se.color.r,se.color.g,se.color.b,se.color.a],direction:m},{u_modelview:Float32Array.from(Ve.modelview),u_projection:Float32Array.from(Ve.projection),u_time:Ve.time,u_cam_pos:Ve.camPos,u_velocityConeAperture:Ve.velocityConeAperture,u_velocity:Ve.velocity,u_horizontalOscillationRadius:Ve.horizontalOscillationRadius,u_horizontalOscillationRate:Ve.horizontalOscillationRate,u_boxSize:Ve.boxSize,u_billboardSize:Ve.billboardSize,u_simpleShapeParameters:Ve.simpleShapeParameters,u_screenSize:Ve.screenSize,u_thinningCenterPos:Ve.thinningCenterPos,u_thinningShape:Ve.thinningShape,u_thinningAffectedRatio:Ve.thinningAffectedRatio,u_thinningParticleOffset:Ve.thinningParticleOffset,u_particleColor:Ve.color,u_direction:Ve.direction});var Ve;const ze=Math.round(se.intensity*this.particlesCount),Oe=i.bg.simpleSegment(0,0,4*ze,2*ze);this.particlesVx&&this.particlesIdx&&W.draw(o,G.TRIANGLES,Ln.disabled,sr.disabled,kr.alphaBlended,hr.disabled,Fe,"snow_particles",this.particlesVx,this.particlesIdx,Oe)})(d.boxSize,0,d),this._vignette.draw(o,S)}}const im={symbol:function(g,o,d,m,S){if(g.renderPass!=="translucent")return;const A=sr.disabled,k=g.colorModeForRenderPass(),N=d.layout.get("text-variable-anchor"),R=d.layout.get("text-size-scale-range"),V=i.aA(g.scaleFactor,R[0],R[1]);N&&function(W,te,ie,se,ve,ue,be,Te){const ke=te.transform,Ue=ve==="map",Fe=ue==="map";for(const Ve of W){const ze=se.getTile(Ve),Oe=ze.getBucket(ie);if(!Oe||!Oe.text||!Oe.text.segments.get().length)continue;const Ge=i.bK(Oe.textSizeData,ke.zoom,Te),Tt=Mu(Ve,Oe.getProjection(),ke),ut=ke.calculatePixelsToTileUnitsMatrix(ze),jt=El(Tt,ze.tileID.canonical,Fe,Ue,ke,Oe.getProjection(),ut),bt=Oe.hasIconTextFit()&&Oe.hasIconData();Ge&&Io(Oe,Ue,Fe,be,ke,jt,Ve,Math.pow(2,ke.zoom-ze.tileID.overscaledZ),Ge,bt)}}(m,g,d,o,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),S,V);const G=d.paint.get("icon-opacity").constantOr(1)!==0,X=d.paint.get("text-opacity").constantOr(1)!==0;d.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(G||X)?Hl(g,o,d,m,A,k):(G&&Hl(g,o,d,m,A,k,{onlyIcons:!0}),X&&Hl(g,o,d,m,A,k,{onlyText:!0})),o.map.showCollisionBoxes&&(ms(g,o,d,m,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),ms(g,o,d,m,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))},circle:function(g,o,d,m){if(g.renderPass!=="translucent")return;const S=d.paint.get("circle-opacity"),A=d.paint.get("circle-stroke-width"),k=d.paint.get("circle-stroke-opacity"),N=d.layout.get("circle-sort-key").constantOr(1)!==void 0,R=d.paint.get("circle-emissive-strength");if(S.constantOr(1)===0&&(A.constantOr(1)===0||k.constantOr(1)===0))return;const V=g.context,G=V.gl,X=g.transform,W=!(!g.terrain||!g.terrain.enabled),te=d.layout.get("circle-elevation-reference"),ie=g.depthModeForSublayer(0,Ln.ReadOnly),se=new Ln(g.context.gl.LEQUAL,Ln.ReadOnly,g.depthRangeFor3D),ve=te==="none"||W?ie:se,ue=sr.disabled,be=g.colorModeForDrapableLayerRenderPass(R),Te=X.projection.name==="globe",ke=[i.aF(X.center.lng),i.aJ(X.center.lat)],Ue=[];for(let Ve=0;Ve<m.length;Ve++){const ze=m[Ve],Oe=o.getTile(ze),Ge=Oe.getBucket(d);if(!Ge||Ge.projection.name!==X.projection.name)continue;const Tt=Ge.programConfigurations.get(d.id),ut=Ge.layoutVertexBuffer,jt=Ge.globeExtVertexBuffer,bt=Ge.indexBuffer,Dt=i.dZ(d),gn=[jt],St=g.isTileAffectedByFog(ze);Te&&Dt.push("PROJECTION_GLOBE_VIEW"),Dt.push("DEPTH_D24"),g.terrain&&X.depthOcclusionForSymbolsAndCircles&&Dt.push("DEPTH_OCCLUSION"),Ge.hasElevation&&!g.terrain&&(Dt.push("ELEVATED_ROADS"),gn.push(Ge.elevatedLayoutVertexBuffer));const it=g.getOrCreateProgram("circle",{config:Tt,defines:Dt,overrideFog:St}),Ut=X.projection.createInversionMatrix(X,ze.canonical),Nt={programConfiguration:Tt,program:it,layoutVertexBuffer:ut,dynamicBuffers:gn,indexBuffer:bt,uniformValues:i.d_(g,ze,Oe,Ut,ke,d),tile:Oe};if(N){const Qt=Ge.segments.get();for(const mn of Qt)Ue.push({segments:new i.bg([mn]),sortKey:mn.sortKey,state:Nt})}else Ue.push({segments:Ge.segments,sortKey:0,state:Nt})}N&&Ue.sort((Ve,ze)=>Ve.sortKey-ze.sortKey);const Fe={useDepthForOcclusion:X.depthOcclusionForSymbolsAndCircles};for(const Ve of Ue){const{programConfiguration:ze,program:Oe,layoutVertexBuffer:Ge,dynamicBuffers:Tt,indexBuffer:ut,uniformValues:jt,tile:bt}=Ve.state,Dt=Ve.segments;g.terrain&&g.terrain.setupElevationDraw(bt,Oe,Fe),g.uploadCommonUniforms(V,Oe,bt.tileID.toUnwrapped()),Oe.draw(g,G.TRIANGLES,ve,ue,be,hr.disabled,jt,d.id,Ge,ut,Dt,d.paint,X.zoom,ze,Tt)}},heatmap:function(g,o,d,m){if(d.paint.get("heatmap-opacity")!==0)if(g.renderPass==="offscreen"){const S=g.context,A=S.gl,k=sr.disabled,N=new kr([A.ONE,A.ONE,A.ONE,A.ONE],i.ao.transparent,[!0,!0,!0,!0]);(function(te,ie,se,ve){const ue=te.gl,be=ie.width*ve,Te=ie.height*ve;te.activeTexture.set(ue.TEXTURE1),te.viewport.set([0,0,be,Te]);let ke=se.heatmapFbo;if(!ke||ke&&(ke.width!==be||ke.height!==Te)){ke&&ke.destroy();const Ue=ue.createTexture();ue.bindTexture(ue.TEXTURE_2D,Ue),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_S,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_T,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MIN_FILTER,ue.LINEAR),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MAG_FILTER,ue.LINEAR),ke=se.heatmapFbo=te.createFramebuffer(be,Te,!0,null),function(Fe,Ve,ze,Oe,Ge,Tt){const ut=Fe.gl;ut.texImage2D(ut.TEXTURE_2D,0,Fe.extRenderToTextureHalfFloat?ut.RGBA16F:ut.RGBA,Ge,Tt,0,ut.RGBA,Fe.extRenderToTextureHalfFloat?ut.HALF_FLOAT:ut.UNSIGNED_BYTE,null),Oe.colorAttachment.set(ze)}(te,0,Ue,ke,be,Te)}else ue.bindTexture(ue.TEXTURE_2D,ke.colorAttachment.get()),te.bindFramebuffer.set(ke.framebuffer)})(S,g,d,g.transform.projection.name==="globe"?.5:.25),S.clear({color:i.ao.transparent});const R=g.transform,V=R.projection.name==="globe",G=V?["PROJECTION_GLOBE_VIEW"]:[],X=V?hr.frontCCW:hr.disabled,W=[i.aF(R.center.lng),i.aJ(R.center.lat)];for(let te=0;te<m.length;te++){const ie=m[te];if(o.hasRenderableParent(ie))continue;const se=o.getTile(ie),ve=se.getBucket(d);if(!ve||ve.projection.name!==R.projection.name)continue;const ue=g.isTileAffectedByFog(ie),be=ve.programConfigurations.get(d.id),Te=g.getOrCreateProgram("heatmap",{config:be,defines:G,overrideFog:ue}),{zoom:ke}=g.transform;g.terrain&&g.terrain.setupElevationDraw(se,Te),g.uploadCommonUniforms(S,Te,ie.toUnwrapped());const Ue=R.projection.createInversionMatrix(R,ie.canonical);Te.draw(g,A.TRIANGLES,Ln.disabled,k,N,X,Dn(g,ie,se,Ue,W,ke,d.paint.get("heatmap-intensity")),d.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,d.paint,g.transform.zoom,be,V?[ve.globeExtVertexBuffer]:null)}S.viewport.set([0,0,g.width,g.height])}else g.renderPass==="translucent"&&(g.context.setColorMode(g.colorModeForRenderPass()),function(S,A){const k=S.context,N=k.gl,R=A.heatmapFbo;if(!R)return;k.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,R.colorAttachment.get()),k.activeTexture.set(N.TEXTURE1);let V=A.colorRampTexture;V||(V=A.colorRampTexture=new i.T(k,A.colorRamp,N.RGBA8)),V.bind(N.LINEAR,N.CLAMP_TO_EDGE),S.getOrCreateProgram("heatmapTexture").draw(S,N.TRIANGLES,Ln.disabled,sr.disabled,S.colorModeForRenderPass(),hr.disabled,((G,X,W,te)=>({u_image:0,u_color_ramp:1,u_opacity:X.paint.get("heatmap-opacity")}))(0,A),A.id,S.viewportBuffer,S.quadTriangleIndexBuffer,S.viewportSegments,A.paint,S.transform.zoom)}(g,d))},line:function(g,o,d,m){if(g.renderPass!=="translucent")return;const S=d.paint.get("line-opacity"),A=d.paint.get("line-width");if(S.constantOr(1)===0||A.constantOr(1)===0)return;const k=d.paint.get("line-emissive-strength"),N=d.paint.get("line-occlusion-opacity"),R=d.layout.get("line-elevation-reference"),V=d.layout.get("line-width-unit")==="meters",G=R==="sea",X=!(!g.terrain||!g.terrain.enabled),W=g.context,te=W.gl;if(d.hasElevatedBuckets&&g.transform.projection.name==="globe")return;const ie=d.layout.get("line-cross-slope"),se=ie!==void 0,ve=ie<1,ue=g.colorModeForDrapableLayerRenderPass(k),be=g.terrain&&g.terrain.renderingToTexture,Te=be?1:i.o.devicePixelRatio,ke=d.paint.get("line-dasharray"),Ue=ke.constantOr(1),Fe=d.layout.get("line-cap"),Ve=ke.constantOr(null),ze=Fe.constantOr(null),Oe=d.paint.get("line-pattern"),Ge=Oe.constantOr(1),Tt=d.paint.get("line-pattern-cross-fade"),ut=Oe.constantOr(null),jt=d.paint.get("line-opacity").constantOr(1);let bt=!Ge&&jt!==1||g.depthOcclusion&&N>0&&N<1;const Dt=d.paint.get("line-gradient"),gn=Ge?"linePattern":"line",St=i.d$(d);let it;if(be&&g.terrain&&g.terrain.clipOrMaskOverlapStencilType()&&(bt=!1),N!==0&&g.depthOcclusion){const mn=d.paint._values["line-opacity"];mn&&mn.value&&mn.value.kind==="constant"?it=mn.value:i.w(`Occlusion opacity for layer ${d.id} is supported only when line-opacity isn't data-driven.`)}A.value.kind!=="constant"&&A.value.isLineProgressConstant===!1&&St.push("VARIABLE_LINE_WIDTH");const Ut=(mn,Nn,dn,rn,Qn,Kn)=>{for(const Jn of mn){const Zn=o.getTile(Jn);if(Ge&&!Zn.patternsLoaded())continue;const Er=Zn.getBucket(d);if(!Er||Er.elevationType!=="none"&&!Qn||Er.elevationType==="none"&&Qn)continue;g.prepareDrawTile();const Vr=[...Nn],Wr=g.shadowRenderer,Ki=Er.elevationType==="road"&&!!Wr&&Wr.enabled;let Nr=[0,0,0];if(Ki){const Zr=g.style.directionalLight,gr=g.style.ambientLight;Zr&&gr&&(Nr=Gl(g.style,Zr,gr)),Vr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const Ri=Er.programConfigurations.get(d.id);let qi=!1;if(ut&&Zn.imageAtlas){const Zr=i.e0.from(ut),gr=Zr.getPrimary().scaleSelf(Te).toString(),Yi=Zn.imageAtlas.patternPositions.get(gr),la=Zr.getSecondary(),Ks=la?Zn.imageAtlas.patternPositions.get(la.scaleSelf(Te).toString()):null;qi=!!Yi&&!!Ks,Yi&&Ri.setConstantPatternPositions(Yi,Ks)}Tt>0&&(qi||Ri.getPatternTransitionVertexBuffer("line-pattern"))&&Vr.push("LINE_PATTERN_TRANSITION");const Rs=g.isTileAffectedByFog(Jn),$r=g.getOrCreateProgram(gn,{config:Ri,defines:Vr,overrideFog:Rs});if(!Ge&&Ve&&ze&&Zn.lineAtlas){const Zr=Zn.lineAtlas.getDash(Ve,ze);Zr&&Ri.setConstantPatternPositions(Zr)}Ki&&Wr.setupShadows(Zn.tileID.toUnwrapped(),$r,"vector-tile");let[zi,ji]=d.paint.get("line-trim-offset");(ze==="round"||ze==="square")&&zi!==ji&&(zi===0&&(zi-=1),ji===1&&(ji+=1));const Ui=be?Jn.projMatrix:null,Vs=V?1/Er.tileToMeter/i.ay(Zn,1,g.transform.zoom):1,ba=V?1/Er.tileToMeter/i.ay(Zn,1,Math.floor(g.transform.zoom)):1,Mo=Ge?i.e1(g,Zn,d,Ui,Te,Vs,ba,[zi,ji],Nr,Tt):i.e2(g,Zn,d,Ui,Er.lineClipsArray.length,Te,Vs,ba,[zi,ji],Nr);if(Dt){const Zr=Er.gradients[d.id];let gr=Zr.texture;if(d.gradientVersion!==Zr.version){let Yi=256;if(d.stepInterpolant){const la=o.getSource().maxzoom,Ks=Jn.canonical.z===la?Math.ceil(1<<g.transform.maxZoom-Jn.canonical.z):1;Yi=i.aA(i.e3(Er.maxLineLength/i.al*1024*Ks),256,W.maxTextureSize)}Zr.gradient=i.e4({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:Yi,image:Zr.gradient||void 0,clips:Er.lineClipsArray}),Zr.texture?Zr.texture.update(Zr.gradient):Zr.texture=new i.T(W,Zr.gradient,te.RGBA8),Zr.version=d.gradientVersion,gr=Zr.texture}W.activeTexture.set(te.TEXTURE1),gr.bind(d.stepInterpolant?te.NEAREST:te.LINEAR,te.CLAMP_TO_EDGE)}Ue&&(W.activeTexture.set(te.TEXTURE0),Zn.lineAtlasTexture&&Zn.lineAtlasTexture.bind(te.LINEAR,te.REPEAT),Ri.updatePaintBuffers()),Ge&&(W.activeTexture.set(te.TEXTURE0),Zn.imageAtlasTexture&&Zn.imageAtlasTexture.bind(te.LINEAR,te.CLAMP_TO_EDGE),Ri.updatePaintBuffers()),Qn&&!G&&g.terrain.setupElevationDraw(Zn,$r),g.uploadCommonUniforms(W,$r,Jn.toUnwrapped());const $s=Zr=>{it!=null&&(it.value=jt*N),$r.draw(g,te.TRIANGLES,dn,Zr,ue,hr.disabled,Mo,d.id,Er.layoutVertexBuffer,Er.indexBuffer,Er.segments,d.paint,g.transform.zoom,Ri,[Er.layoutVertexBuffer2,Er.patternVertexBuffer,Er.zOffsetVertexBuffer]),it!=null&&(it.value=jt)};if(bt&&!Qn){const Zr=g.stencilModeForClipping(Jn).ref;Zr===0&&be&&W.clear({stencil:0});const gr={func:te.EQUAL,mask:255};Mo.u_alpha_discard_threshold=.8,$s(new sr(gr,Zr,255,te.KEEP,te.KEEP,te.INVERT)),Mo.u_alpha_discard_threshold=0,$s(new sr(gr,Zr,255,te.KEEP,te.KEEP,te.KEEP))}else Mo.u_alpha_discard_threshold=bt&&Qn&&Kn?.8:0,$s(Qn?rn:g.stencilModeForClipping(Jn))}};let Nt=g.depthModeForSublayer(0,Ln.ReadOnly);const Qt=new Ln(g.depthOcclusion?te.GREATER:te.LEQUAL,Ln.ReadOnly,g.depthRangeFor3D);if(d.hasNonElevatedBuckets){const mn=!be&&g.terrain;N!==0&&mn?i.w(`Occlusion opacity for layer ${d.id} is supported on terrain only if the layer has line-z-offset enabled.`):mn?i.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${d.id}.`):Ut(m,St,Nt,sr.disabled,!1,!0)}if(d.hasElevatedBuckets){R==="hd-road-markup"?X||(Nt=Qt,St.push("ELEVATED_ROADS")):(St.push("ELEVATED"),Nt=Qt,se&&St.push(ve?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),G&&St.push("ELEVATION_REFERENCE_SEA"));const mn=bt?g.stencilModeFor3D():sr.disabled;g.forceTerrainMode=!0,Ut(m,St,Nt,mn,!0,!0),bt&&Ut(m,St,Nt,mn,!0,!1),g.forceTerrainMode=!1}bt&&(g.resetStencilClippingMasks(),be&&W.clear({stencil:0})),N===0||g.depthOcclusion||be||g.layersWithOcclusionOpacity.push(g.currentLayer)},fill:function(g,o,d,m){const S=d.paint.get("fill-color"),A=d.paint.get("fill-opacity");if(A.constantOr(1)===0)return;const k=d.paint.get("fill-emissive-strength"),N=g.colorModeForDrapableLayerRenderPass(k),R=d.paint.get("fill-pattern"),V=g.opaquePassEnabledForLayer()&&!R.constantOr(1)&&S.constantOr(i.ao.transparent).a===1&&A.constantOr(0)===1?"opaque":"translucent";let G="none";d.layout.get("fill-elevation-reference")!=="none"?G="road":d.paint.get("fill-z-offset").constantOr(1)!==0&&(G="offset");const X=!(!g.terrain||!g.terrain.enabled),W={painter:g,sourceCache:o,layer:d,coords:m,colorMode:N,elevationType:G,terrainEnabled:X,pass:V};if(g.renderPass!=="shadow")if(G!=="offset"){if(Ua(W,!1),G==="road"){const te=!X&&g.renderPass==="translucent";te&&Us(g,o,d,m,"geometry"),Ua(W,!0,sr.disabled),te&&function(ie){const{painter:se,sourceCache:ve,layer:ue,coords:be,colorMode:Te}=ie,ke=se.context.gl,Ue=ie.painter.shadowRenderer,Fe=!!Ue&&Ue.enabled,Ve=new Ln(se.context.gl.LEQUAL,Ln.ReadOnly,se.depthRangeFor3D);let ze=[0,0,0];if(Fe){const Ge=se.style.directionalLight,Tt=se.style.ambientLight;Ge&&Tt&&(ze=Gl(se.style,Ge,Tt))}const Oe=Ge=>{for(const Tt of be){const ut=ve.getTile(Tt),jt=ut.getBucket(ue);if(!jt)continue;const bt=jt.elevatedStructures;if(!bt)continue;let Dt,gn;if(Ge?(Dt=bt.renderableBridgeSegments,gn=bt.bridgeProgramConfigurations.get(ue.id)):(Dt=bt.renderableTunnelSegments,gn=bt.tunnelProgramConfigurations.get(ue.id)),!Dt||Dt.segments[0].primitiveLength===0)continue;gn.updatePaintBuffers(),se.prepareDrawTile();const St=se.isTileAffectedByFog(Tt),it=[];Fe&&it.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const Ut=se.getOrCreateProgram("elevatedStructures",{config:gn,overrideFog:St,defines:it}),Nt=se.translatePosMatrix(Tt.projMatrix,ut,ue.paint.get("fill-translate"),ue.paint.get("fill-translate-anchor"));Fe&&Ue.setupShadows(ut.tileID.toUnwrapped(),Ut,"vector-tile");const Qt=ft(Nt,ze);se.uploadCommonUniforms(se.context,Ut,Tt.toUnwrapped()),Ut.draw(se,ke.TRIANGLES,Ve,sr.disabled,Te,hr.backCCW,Qt,ue.id,bt.vertexBuffer,bt.indexBuffer,Dt,ue.paint,se.transform.zoom,gn,[bt.vertexBufferNormal])}};Oe(!0),Oe(!1)}(W)}}else Ua(W,!1,g.stencilModeFor3D());else g.shadowRenderer&&G==="road"&&!X&&function(te){const{painter:ie,sourceCache:se,layer:ve,coords:ue}=te,be=ie.context.gl,Te=te.painter.shadowRenderer;for(const ke of ue){const Ue=se.getTile(ke),Fe=Ue.getBucket(ve);if(!Fe)continue;const Ve=Fe.elevatedStructures;if(!Ve||!Ve.shadowCasterSegments||Ve.shadowCasterSegments.segments[0].primitiveLength===0)continue;ie.prepareDrawTile();const ze=Fe.bufferData.programConfigurations.get(ve.id),Oe=ie.isTileAffectedByFog(ke),Ge=ie.getOrCreateProgram("elevatedStructuresDepth",{config:ze,overrideFog:Oe}),Tt=Te.calculateShadowPassMatrixFromTile(Ue.tileID.toUnwrapped());ie.uploadCommonUniforms(ie.context,Ge,ke.toUnwrapped());const ut={u_matrix:Tt,u_depth_bias:0};Ge.draw(ie,be.TRIANGLES,Te.getShadowPassDepthMode(),sr.disabled,Te.getShadowPassColorMode(),hr.disabled,ut,ve.id,Ve.vertexBuffer,Ve.indexBuffer,Ve.shadowCasterSegments,ve.paint,ie.transform.zoom,ze)}}(W)},"fill-extrusion":function(g,o,d,m){const S=d.paint.get("fill-extrusion-opacity"),A=g.context,k=A.gl,N=g.terrain,R=N&&N.renderingToTexture;if(S===0)return;const V=g.conflationActive&&g.style.isLayerClipped(d,o.getSource()),G=g.style.order.indexOf(d.fqid);if(V&&function(X,W,te,ie,se){for(const ve of ie){const ue=W.getTile(ve).getBucket(te);ue&&(ue.updateReplacement(ve,X.replacementSource,se),ue.uploadCentroid(X.context))}}(g,o,d,m,G),N||V)for(const X of m){const W=o.getTile(X).getBucket(d);W&&No(g.context,o,X,W,d,N,V)}if(g.renderPass==="shadow"&&g.shadowRenderer){const X=g.shadowRenderer;if(N&&S<.65&&d._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.ad)return;const W=X.getShadowPassDepthMode(),te=X.getShadowPassColorMode();Pn(g,o,d,m,W,sr.disabled,te,V)}else if(g.renderPass==="translucent"){const X=!d.paint.get("fill-extrusion-pattern").constantOr(1),W=d.paint.get("fill-extrusion-color").constantOr(i.ao.white);if(!R&&W.a!==0){const te=new Ln(g.context.gl.LEQUAL,Ln.ReadWrite,g.depthRangeFor3D);S===1&&X?Pn(g,o,d,m,te,sr.disabled,kr.unblended,V):(Pn(g,o,d,m,te,sr.disabled,kr.disabled,V),Pn(g,o,d,m,te,g.stencilModeFor3D(),g.colorModeForRenderPass(),V),g.resetStencilClippingMasks())}if(g.style.enable3dLights()&&X&&(!N&&g.transform.projection.name!=="globe"||R)){const te=d.paint.get("fill-extrusion-opacity"),ie=d.paint.get("fill-extrusion-ambient-occlusion-intensity"),se=d.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),ve=d.paint.get("fill-extrusion-flood-light-intensity"),ue=d.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",be=d.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(ue?null:d.lut).toArray01().slice(0,3),Te=ie>0&&se>0,ke=ve>0,Ue=(ze,Oe,Ge)=>(1-Ge)*ze+Ge*Oe,Fe=new fl;Fe.translate=d.paint.get("fill-extrusion-translate"),Fe.translateAnchor=d.paint.get("fill-extrusion-translate-anchor"),Fe.edgeRadius=d.layout.get("fill-extrusion-edge-radius"),Fe.cutoffFadeRange=d.paint.get("fill-extrusion-cutoff-fade-range");const Ve=ze=>{const Oe=g.depthModeForSublayer(1,Ln.ReadOnly,k.LEQUAL,!0),Ge=d.paint.get(ze?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Tt=Ue(.1,3,Ge),ut=g._showOverdrawInspector;if(!ut){const jt=new sr({func:k.ALWAYS,mask:255},255,255,k.KEEP,k.KEEP,k.REPLACE),bt=new kr([k.ONE,k.ONE,k.ONE,k.ONE],i.ao.transparent,[!1,!1,!1,!0],k.MIN);go(Fe,g,o,d,m,Oe,jt,bt,hr.disabled,ze,"sdf",te,ie,se,ve,be,Tt,V,!1)}{const jt=ut?sr.disabled:new sr({func:k.EQUAL,mask:255},255,255,k.KEEP,k.DECR,k.DECR),bt=ut?g.colorModeForRenderPass():new kr([k.ONE_MINUS_DST_ALPHA,k.DST_ALPHA,k.ONE,k.ONE],i.ao.transparent,[!0,!0,!0,!0]);go(Fe,g,o,d,m,Oe,jt,bt,hr.disabled,ze,"color",te,ie,se,ve,be,Tt,V,!1)}};if(R){const ze=(Oe,Ge,Tt)=>{const ut=g.depthModeForSublayer(1,Ln.ReadOnly,k.LEQUAL,!1),jt=d.paint.get(Oe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),bt=Ue(.1,3,jt);{const Dt=new kr([k.ONE,k.ONE,k.ONE,k.ONE],i.ao.transparent,[!1,!1,!1,!0]);go(Fe,g,o,d,m,ut,sr.disabled,Dt,hr.disabled,Oe,"clear",te,ie,se,ve,be,bt,V,Ge)}{const Dt=new sr({func:k.ALWAYS,mask:255},255,255,k.KEEP,k.KEEP,k.REPLACE),gn=new kr([k.ONE,k.ONE,k.ONE,k.ONE],i.ao.transparent,[!1,!1,!1,!0],k.MIN);go(Fe,g,o,d,m,ut,Dt,gn,hr.disabled,Oe,"sdf",te,ie,se,ve,be,bt,V,Ge)}{const Dt=Oe?k.ZERO:k.ONE_MINUS_DST_ALPHA,gn=new sr({func:k.EQUAL,mask:255},255,255,k.KEEP,k.DECR,k.DECR),St=new kr([Dt,k.DST_ALPHA,k.ONE_MINUS_DST_ALPHA,k.ZERO],i.ao.transparent,[!0,!0,!0,!0]);go(Fe,g,o,d,m,ut,gn,St,hr.disabled,Oe,"color",te,ie,se,ve,be,bt,V,Ge)}{const Dt=new kr([k.ONE,k.ONE,k.ONE,Oe?k.ZERO:k.ONE],i.ao.transparent,[!1,!1,!1,!0],Oe?k.FUNC_ADD:k.MAX);go(Fe,g,o,d,m,ut,sr.disabled,Dt,hr.disabled,Oe,"clear",te,ie,se,ve,be,bt,V,Ge,Tt)}};if(Te||ke){let Oe;if(g.prepareDrawTile(),N){const Ge=N.drapeBufferSize[0],Tt=N.drapeBufferSize[1];Oe=N.framebufferCopyTexture,Oe&&(!Oe||Oe.size[0]===Ge&&Oe.size[1]===Tt)||(Oe&&Oe.destroy(),Oe=N.framebufferCopyTexture=new i.T(A,new i.q({width:Ge,height:Tt}),k.RGBA8)),Oe.bind(k.LINEAR,k.CLAMP_TO_EDGE),k.copyTexSubImage2D(k.TEXTURE_2D,0,0,0,0,0,Ge,Tt)}Te&&ze(!0,!1,Oe),ke&&ze(!1,!0,Oe)}}else Te&&Ve(!0),ke&&Ve(!1),(Te||ke)&&g.resetStencilClippingMasks()}}},building:function(g,o,d,m){g.currentLayer<g.firstLightBeamLayer&&(g.firstLightBeamLayer=g.currentLayer);const S=d.paint.get("building-ambient-occlusion-ground-intensity"),A=d.paint.get("building-ambient-occlusion-ground-radius"),k=d.paint.get("building-ambient-occlusion-ground-attenuation"),N=d.paint.get("building-opacity");if(N<=0)return;let R=S>0&&A>0,V=!0;const G=d.paint.get("building-vertical-scale");(!g.shadowRenderer||G<1)&&(V=!1);const X=g.conflationActive&&g.style.isLayerClipped(d,o.getSource()),W=g.style.order.indexOf(d.fqid);if(function(te,ie,se,ve,ue,be){for(const Te of be){const ke=ie.getTile(Te).getBucket(se);ke&&(ue&&ke.updateReplacement(Te,te.replacementSource,ve),ke.uploadUpdatedIndexBuffer(te.context))}}(g,o,d,W,X,m),function(te,ie,se,ve){for(const ue of ve){const be=ie.getTile(ue).getBucket(se);be&&be.needsEvaluation()&&be.uploadUpdatedColorBuffer(te.context)}}(g,o,d,m),d.resetLayerRenderingStats(g),g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!0),g.renderPass==="shadow"&&g.shadowRenderer){const te=g.shadowRenderer,ie=[],se=te.getShadowPassDepthMode();vc({painter:g,source:o,layer:d,coords:m,defines:ie,blendMode:te.getShadowPassColorMode(),depthMode:se,opacity:N,verticalScale:G,facadeEmissiveChance:0,facadeAOIntensity:0})}else if(g.renderPass==="translucent"){let te=["HAS_ATTRIBUTE_a_part_color_emissive","LIGHTING_3D_MODE"];V&&(te=te.concat("RENDER_SHADOWS","DEPTH_TEXTURE")),g.shadowRenderer&&g.shadowRenderer.useNormalOffset&&(te=te.concat("NORMAL_OFFSET"));const ie=d.paint.get("building-facade-emissive-chance"),se=d.paint.get("building-ambient-occlusion-intensity"),ve=new Ln(g.context.gl.LEQUAL,Ln.ReadWrite,g.depthRangeFor3D);N<1&&vc({painter:g,source:o,layer:d,coords:m,defines:te,blendMode:kr.disabled,depthMode:ve,opacity:N,verticalScale:G,facadeEmissiveChance:ie,facadeAOIntensity:se});const ue=g.colorModeForRenderPass();vc({painter:g,source:o,layer:d,coords:m,defines:te,blendMode:ue,depthMode:ve,opacity:N,verticalScale:G,facadeEmissiveChance:ie,facadeAOIntensity:se}),R&&function(be,Te,ke,Ue,Fe,Ve,ze,Oe,Ge,Tt,ut,jt,bt){const Dt=be.context.gl,gn=be.depthModeForSublayer(1,Ln.ReadOnly,Dt.LEQUAL,!0),St=.1*(1-(it=ut))+3*it;var it;const Ut=be._showOverdrawInspector,Nt=jt,Qt=new fl;Ut||go(Qt,be,Te,ke,Ue,gn,new sr({func:Dt.ALWAYS,mask:255},255,255,Dt.KEEP,Dt.KEEP,Dt.REPLACE),new kr([Dt.ONE,Dt.ONE,Dt.ONE,Dt.ONE],i.ao.transparent,[!1,!1,!1,!0],Dt.MIN),hr.disabled,Fe,"sdf",Ve,ze,Oe,0,Tt,St,Nt,!1);{const mn=Ut?sr.disabled:new sr({func:Dt.EQUAL,mask:255},255,255,Dt.KEEP,Dt.DECR,Dt.DECR),Nn=Ut?be.colorModeForRenderPass():new kr([Dt.ONE_MINUS_DST_ALPHA,Dt.DST_ALPHA,Dt.ONE,Dt.ONE],i.ao.transparent,[!0,!0,!0,!0]);go(Qt,be,Te,ke,Ue,gn,mn,Nn,hr.disabled,Fe,"color",Ve,ze,Oe,0,Tt,St,Nt,!1)}}(g,o,d,m,!0,N,S,A,0,[0,0,0],k,X)}else if(g.renderPass==="light-beam"){const te=["HAS_ATTRIBUTE_a_part_color_emissive","HAS_ATTRIBUTE_a_bloom_attenuation"],ie=new Ln(g.context.gl.LEQUAL,Ln.ReadOnly,g.depthRangeFor3D);vc({painter:g,source:o,layer:d,coords:m,defines:te,blendMode:kr.alphaBlended,depthMode:ie,opacity:N,verticalScale:G,facadeEmissiveChance:0,facadeAOIntensity:0})}g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!1),g.resetStencilClippingMasks()},hillshade:function(g,o,d,m){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent"||g.style.disableElevatedTerrain)return;const S=g.context,A=g.terrain&&g.terrain.renderingToTexture,[k,N]=g.renderPass!=="translucent"||A?[{},m]:g.stencilConfigForOverlap(m);for(const R of N){const V=o.getTile(R);if(V.needsHillshadePrepare&&g.renderPass==="offscreen")Rv(g,V,d);else if(g.renderPass==="translucent"){const G=g.depthModeForSublayer(0,Ln.ReadOnly),X=d.paint.get("hillshade-emissive-strength"),W=g.colorModeForDrapableLayerRenderPass(X),te=A&&g.terrain?g.terrain.stencilModeForRTTOverlap(R):k[R.overscaledZ];My(g,R,V,d,G,te,W)}}S.viewport.set([0,0,g.width,g.height]),g.resetStencilClippingMasks()},raster:function(g,o,d,m,S,A){if(g.renderPass!=="translucent"||d.paint.get("raster-opacity")===0)return;const k=g.transform.projection.name==="globe",N=d.paint.get("raster-elevation")!==0,R=N&&k;if(g.renderElevatedRasterBackface&&!R)return;const V=g.context,G=V.gl,X=o.getSource(),W=function(Fe,Ve,ze,Oe){const Ge=Ve.paint.get("raster-color"),Tt=Fe.type==="raster-array",ut=[],jt=Ve.paint.get("raster-resampling"),bt=Ve.paint.get("raster-color-mix");let Dt=Ve.paint.get("raster-color-range");const gn=[bt[0],bt[1],bt[2],0],St=bt[3];let it=jt==="nearest"?Oe.NEAREST:Oe.LINEAR;if(Tt&&(ut.push("RASTER_ARRAY"),Ge||ut.push("RASTER_COLOR"),jt==="linear"&&ut.push("RASTER_ARRAY_LINEAR"),it=Oe.NEAREST,!Dt&&Fe.rasterLayers)){const Ut=Fe.rasterLayers.find(({id:Nt})=>Nt===Ve.sourceLayer);Ut&&Ut.fields&&Ut.fields.range&&(Dt=Ut.fields.range)}if(Dt=Dt||[0,1],Ge){ut.push("RASTER_COLOR"),ze.activeTexture.set(Oe.TEXTURE2),Ve.updateColorRamp(Dt);let Ut=Ve.colorRampTexture;Ut||(Ut=Ve.colorRampTexture=new i.T(ze,Ve.colorRamp,Oe.RGBA8)),Ut.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE)}return{mix:gn,range:Dt,offset:St,defines:ut,resampling:it}}(X,d,V,G);if(X instanceof i.aS&&!m.length&&!k)return;const te=d.paint.get("raster-emissive-strength"),ie=g.colorModeForDrapableLayerRenderPass(te),se=g.terrain&&g.terrain.renderingToTexture,ve=!g.options.moving,ue=d.paint.get("raster-resampling")==="nearest"?G.NEAREST:G.LINEAR;if(X instanceof i.aS&&!m.length&&(X.onNorthPole||X.onSouthPole)){const Fe=N?g.stencilModeFor3D():sr.disabled;return void au(!!X.onNorthPole,null,g,o,d,te,W,hr.disabled,Fe)}if(!m.length)return;const[be,Te]=X instanceof i.aS||se?[{},m]:g.stencilConfigForOverlap(m),ke=Te[Te.length-1].overscaledZ;R&&W.defines.push("PROJECTION_GLOBE_VIEW"),N&&W.defines.push("RENDER_CUTOFF");const Ue=(Fe,Ve,ze)=>{for(const Oe of Fe){const Ge=Oe.toUnwrapped(),Tt=o.getTile(Oe);if(se&&(!Tt||!Tt.hasData()))continue;V.activeTexture.set(G.TEXTURE0);const ut=fg(Tt,X,d,W);if(!ut||!ut.texture)continue;const{texture:jt,mix:bt,offset:Dt,tileSize:gn,buffer:St}=ut;let it,Ut;se?(it=Ln.disabled,Ut=Oe.projMatrix):N?(it=new Ln(G.LEQUAL,Ln.ReadWrite,g.depthRangeFor3D),Ut=k?Float32Array.from(g.transform.expandedFarZProjMatrix):g.transform.calculateProjMatrix(Ge,ve)):(it=g.depthModeForSublayer(Oe.overscaledZ-ke,d.paint.get("raster-opacity")===1?Ln.ReadWrite:Ln.ReadOnly,G.LESS),Ut=g.transform.calculateProjMatrix(Ge,ve));const Nt=g.terrain&&se?g.terrain.stencilModeForRTTOverlap(Oe):be[Oe.overscaledZ],Qt=A?0:d.paint.get("raster-fade-duration");Tt.registerFadeDuration(Qt);const mn=o.findLoadedParent(Oe,0),Nn=Hf(Tt,mn,o,g.transform,Qt);let dn,rn;!Nn.isFading&&Tt.refreshedUponExpiration&&(Tt.refreshedUponExpiration=!1),g.terrain&&g.terrain.prepareDrawTile(),V.activeTexture.set(G.TEXTURE0),jt.bind(ue,G.CLAMP_TO_EDGE),V.activeTexture.set(G.TEXTURE1),mn?(mn.texture&&mn.texture.bind(ue,G.CLAMP_TO_EDGE),dn=Math.pow(2,mn.tileID.overscaledZ-Tt.tileID.overscaledZ),rn=[Tt.tileID.canonical.x*dn%1,Tt.tileID.canonical.y*dn%1]):jt.bind(ue,G.CLAMP_TO_EDGE),"useMipmap"in jt&&V.extTextureFilterAnisotropic&&g.transform.pitch>20&&G.texParameterf(G.TEXTURE_2D,V.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,V.extTextureFilterAnisotropicMax);const Qn=g.transform;let Kn;const Jn=N?pl(Qn):[0,0,0,0];let Zn,Er,Vr,Wr,Ki,Nr=0;if(R&&X instanceof i.aS&&X.coordinates.length>3)Zn=Float32Array.from(i.bk(i.dF(new i.cC(0,0,0)))),Er=Float32Array.from(Qn.globeMatrix),Vr=Float32Array.from(i.dB(Qn)),Wr=[i.aF(Qn.center.lng),i.aJ(Qn.center.lat)],Kn=X.elevatedGlobePerspectiveTransform,Ki=X.elevatedGlobeGridMatrix||new Float32Array(9);else if(R){const $r=i.dC(Oe.canonical);Nr=i.dD($r.getCenter().lat),Zn=Float32Array.from(i.bk(i.dF(Oe.canonical))),Er=Float32Array.from(Qn.globeMatrix),Vr=Float32Array.from(i.dB(Qn)),Wr=[i.aF(Qn.center.lng),i.aJ(Qn.center.lat)],Kn=[0,0],Ki=Float32Array.from(i.dE(Oe.canonical,$r,Nr,Qn.worldSize/Qn._pixelsPerMercatorPixel))}else Kn=X instanceof i.aS?X.perspectiveTransform:[0,0],Zn=new Float32Array(16),Er=new Float32Array(9),Vr=new Float32Array(16),Wr=[0,0],Ki=new Float32Array(9);const Ri=Hn(Ut,Zn,Er,Vr,Ki,rn||[0,0],i.aj(g.transform.zoom),Wr,Jn,dn||1,Nn,d,Kn,N?d.paint.get("raster-elevation"):0,2,bt,Dt,W.range,gn,St,te),qi=g.isTileAffectedByFog(Oe),Rs=g.getOrCreateProgram("raster",{defines:W.defines,overrideFog:qi});if(g.uploadCommonUniforms(V,Rs,Ge),X instanceof i.aS){const $r=X.elevatedGlobeVertexBuffer,zi=X.elevatedGlobeIndexBuffer;if(se||!k)X.boundsBuffer&&X.boundsSegments&&Rs.draw(g,G.TRIANGLES,it,sr.disabled,ie,hr.disabled,Ri,d.id,X.boundsBuffer,g.quadTriangleIndexBuffer,X.boundsSegments);else if($r&&zi){const ji=Qn.zoom<=i.cZ?X.elevatedGlobeSegments:X.getSegmentsForLongitude(Qn.center.lng);ji&&Rs.draw(g,G.TRIANGLES,it,sr.disabled,ie,Ve,Ri,d.id,$r,zi,ji)}}else if(R){it=new Ln(G.LEQUAL,Ln.ReadOnly,g.depthRangeFor3D);const $r=g.globeSharedBuffers;if($r){const[zi,ji,Ui]=$r.getGridBuffers(Nr,!1);Rs.draw(g,G.TRIANGLES,it,ze||Nt,g.colorModeForRenderPass(),Ve,Ri,d.id,zi,ji,Ui)}}else{const{tileBoundsBuffer:$r,tileBoundsIndexBuffer:zi,tileBoundsSegments:ji}=g.getTileBoundsBuffers(Tt);Rs.draw(g,G.TRIANGLES,it,Nt,ie,hr.disabled,Ri,d.id,$r,zi,ji)}}if(!(X instanceof i.aS)&&R)for(const Oe of Fe){const Ge=Oe.canonical.y===(1<<Oe.canonical.z)-1;Oe.canonical.y===0&&au(!0,Oe,g,o,d,te,W,Ve,ze||sr.disabled),Ge&&au(!1,Oe,g,o,d,te,W,Ve===hr.frontCW?hr.backCW:hr.frontCW,ze||sr.disabled)}};R?Ue(Te,g.renderElevatedRasterBackface?hr.backCW:hr.frontCW,g.stencilModeFor3D()):Ue(Te,hr.disabled,void 0),g.resetStencilClippingMasks()},"raster-particle":function(g,o,d,m,S,A){g.renderPass==="offscreen"&&function(k,N,R,V){if(!V.length)return;const G=k.context,X=G.gl,W=N.getSource();if(!(W instanceof ku))return;const te=Math.ceil(Math.sqrt(R.paint.get("raster-particle-count")));let ie=R.particlePositionRGBAImage;if(!ie||ie.width!==te){const Te=function(ke){const Ue=ke*ke,Fe=new Uint8Array(4*Ue),Ve=function(Oe){return Oe|=0,Oe=Math.imul(2747636419^Oe,2654435769),Oe=Math.imul(Oe^Oe>>>16,2654435769),((Oe=Math.imul(Oe^Oe>>>16,2654435769))>>>0)/4294967296},ze=1/1.1;for(let Oe=0;Oe<Ue;Oe++){const Ge=ze*(Ve(2*Oe+0)+Rr),Tt=ze*(Ve(2*Oe+1)+Rr),ut=255*Ge%1,jt=255*Tt%1,bt=ut,Dt=Tt-jt/255,gn=jt;Fe[4*Oe+0]=255*(Ge-ut/255),Fe[4*Oe+1]=255*bt,Fe[4*Oe+2]=255*Dt,Fe[4*Oe+3]=255*gn}return Fe}(te);ie=R.particlePositionRGBAImage=new i.q({width:te,height:te},Te)}let se=R.particleFramebuffer;se?se.width!==te&&(se.destroy(),se=R.particleFramebuffer=G.createFramebuffer(te,te,!0,null)):se=R.particleFramebuffer=G.createFramebuffer(te,te,!0,null);const ve=[];for(const Te of V){const ke=N.getTile(Te);if(!(ke instanceof Nu))continue;const Ue=Qo(ke,W,R);if(!Ue)continue;const Fe=[ke.tileSize,ke.tileSize];let Ve=R.tileFramebuffer;Ve||(Ve=R.tileFramebuffer=G.createFramebuffer(Fe[0],Fe[1],!0,null));let ze=ke.rasterParticleState;ze||(ze=ke.rasterParticleState=new By(G,Te,Fe,ie));const Oe=ze.update(R.lastInvalidatedAt);ze.particleTextureDimension!==te&&ze.updateParticleTexture(Te,ie);const Ge=ze.targetColorTexture;ze.targetColorTexture=ze.backgroundColorTexture,ze.backgroundColorTexture=Ge;const Tt=ze.particleTexture0;ze.particleTexture0=ze.particleTexture1,ze.particleTexture1=Tt,ve.push([Te,Ue,ze,Oe])}if(ve.length===0)return;const ue=i.o.now(),be=R.previousDrawTimestamp?.001*(ue-R.previousDrawTimestamp):.0167;if(R.previousDrawTimestamp=ue,R.hasColorMap()){G.activeTexture.set(X.TEXTURE0+2);let Te=R.colorRampTexture;Te||(Te=R.colorRampTexture=new i.T(G,R.colorRamp,X.RGBA8)),Te.bind(X.LINEAR,X.CLAMP_TO_EDGE)}G.bindFramebuffer.set(R.tileFramebuffer.framebuffer),function(Te,ke,Ue){const Fe=Te.context,Ve=Fe.gl,ze=ke.tileFramebuffer;Fe.activeTexture.set(Ve.TEXTURE0);const Oe={u_texture:0,u_opacity:1.05*(Tt=ke.paint.get("raster-particle-fade-opacity-factor"))/(Tt+.05)},Ge=Te.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var Tt;for(const ut of Ue){const[,,jt,bt]=ut;ze.colorAttachment.set(jt.targetColorTexture.texture),Fe.viewport.set([0,0,ze.width,ze.height]),Fe.clear({color:i.ao.transparent}),bt&&(jt.backgroundColorTexture.bind(Ve.NEAREST,Ve.CLAMP_TO_EDGE),Ge.draw(Te,Ve.TRIANGLES,Ln.disabled,sr.disabled,kr.alphaBlended,hr.disabled,Oe,ke.id,Te.viewportBuffer,Te.quadTriangleIndexBuffer,Te.viewportSegments))}}(k,R,ve),function(Te,ke,Ue,Fe){const Ve=Te.context,ze=Ve.gl,Oe=Ue.tileFramebuffer,Ge=Te.transform.projection.name==="globe",Tt=Ue.paint.get("raster-particle-max-speed");for(const ut of Fe){const[jt,bt,Dt]=ut;Ve.activeTexture.set(ze.TEXTURE0+0),bt.texture.bind(ze.LINEAR,ze.CLAMP_TO_EDGE),Oe.colorAttachment.set(Dt.targetColorTexture.texture);const gn=Te.getOrCreateProgram("rasterParticleDraw",{defines:bt.defines,overrideFog:!1});Ve.activeTexture.set(ze.TEXTURE0+1);const St=bt.scalarData?[]:[0,1,2,3].map(Nt=>i.e6[Nt](jt));St.push(jt);const it=jt.canonical.x,Ut=jt.canonical.y;for(const Nt of St){const Qt=ke.getTile(Ge?Nt.wrapped():Nt);if(!Qt)continue;const mn=Qt.rasterParticleState;if(!mn)continue;const Nn=Nt.canonical.x+(1<<Nt.canonical.z)*(Nt.wrap-jt.wrap),dn=Nt.canonical.y;mn.particleTexture0.bind(ze.NEAREST,ze.CLAMP_TO_EDGE);const rn=ri(1,mn.particleTexture0.size[0],[Nn-it,dn-Ut],0,bt.texture.size,2,Tt,bt.textureOffset,bt.scale,bt.offset);gn.draw(Te,ze.POINTS,Ln.disabled,sr.disabled,kr.alphaBlended,hr.disabled,rn,Ue.id,mn.particleIndexBuffer,void 0,mn.particleSegment)}}}(k,N,R,ve),G.bindFramebuffer.set(R.particleFramebuffer.framebuffer),function(Te,ke,Ue,Fe){const Ve=Te.context,ze=Ve.gl,Oe=ke.paint.get("raster-particle-max-speed"),Ge=Fe*ke.paint.get("raster-particle-speed-factor")*.15,Tt=function(jt){return Math.pow(jt,6)}(.01+1*ke.paint.get("raster-particle-reset-rate-factor")),ut=ke.particleFramebuffer;Ve.viewport.set([0,0,ut.width,ut.height]);for(const jt of Ue){const[,bt,Dt]=jt;Ve.activeTexture.set(ze.TEXTURE0+0),bt.texture.bind(ze.LINEAR,ze.CLAMP_TO_EDGE),Ve.activeTexture.set(ze.TEXTURE0+1);const gn=Dt.particleTexture0;gn.bind(ze.NEAREST,ze.CLAMP_TO_EDGE);const St=ps(1,gn.size[0],0,bt.texture.size,Oe,Ge,Tt,bt.textureOffset,bt.scale,bt.offset);ut.colorAttachment.set(Dt.particleTexture1.texture),Ve.clear({color:i.ao.transparent}),Te.getOrCreateProgram("rasterParticleUpdate",{defines:bt.defines}).draw(Te,ze.TRIANGLES,Ln.disabled,sr.disabled,kr.unblended,hr.disabled,St,ke.id,Te.viewportBuffer,Te.quadTriangleIndexBuffer,Te.viewportSegments)}}(k,R,ve,be)}(g,o,d,m),g.renderPass==="translucent"&&(function(k,N,R,V,G){const X=k.context,W=X.gl,te=N.getSource().tileSize,ie=5*(1-i.ah(i.cK,i.cK+1,k.transform.zoom))*te+R.paint.get("raster-particle-elevation"),se=!k.options.moving,ve=k.transform.projection.name==="globe";if(!V.length)return;const[ue,be]=k.stencilConfigForOverlap(V),Te=[];ve&&Te.push("PROJECTION_GLOBE_VIEW");const ke=k.stencilModeFor3D();for(const Ue of be){const Fe=Ue.toUnwrapped(),Ve=N.getTile(Ue);if(!Ve.rasterParticleState)continue;const ze=Ve.rasterParticleState,Oe=100;Ve.registerFadeDuration(Oe);const Ge=N.findLoadedParent(Ue,0),Tt=Hf(Ve,Ge,N,k.transform,Oe);let ut,jt;k.terrain&&k.terrain.prepareDrawTile(),X.activeTexture.set(W.TEXTURE0),ze.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),X.activeTexture.set(W.TEXTURE1),Ge&&Ge.rasterParticleState?(Ge.rasterParticleState.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),ut=Math.pow(2,Ge.tileID.overscaledZ-Ve.tileID.overscaledZ),jt=[Ve.tileID.canonical.x*ut%1,Ve.tileID.canonical.y*ut%1]):ze.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE);const bt=ve?Float32Array.from(k.transform.expandedFarZProjMatrix):k.transform.calculateProjMatrix(Fe,se),Dt=k.transform,gn=Hv(Dt),St=i.dC(Ue.canonical),it=i.dD(St.getCenter().lat);let Ut,Nt,Qt,mn,Nn;ve?(Ut=Float32Array.from(i.bk(i.dF(Ue.canonical))),Nt=Float32Array.from(Dt.globeMatrix),Qt=Float32Array.from(i.dB(Dt)),mn=[i.aF(Dt.center.lng),i.aJ(Dt.center.lat)],Nn=Float32Array.from(i.dE(Ue.canonical,St,it,Dt.worldSize/Dt._pixelsPerMercatorPixel))):(Ut=new Float32Array(16),Nt=new Float32Array(9),Qt=new Float32Array(16),mn=[0,0],Nn=new Float32Array(9));const dn=Di(bt,Ut,Nt,Qt,Nn,jt||[0,0],i.aj(k.transform.zoom),mn,gn,ut||1,Tt,ie),rn=k.isTileAffectedByFog(Ue),Qn=k.getOrCreateProgram("rasterParticle",{defines:Te,overrideFog:rn});if(k.uploadCommonUniforms(X,Qn,Fe),ve){const Kn=new Ln(W.LEQUAL,Ln.ReadOnly,k.depthRangeFor3D),Jn=0,Zn=k.globeSharedBuffers;if(Zn){const[Er,Vr,Wr]=Zn.getGridBuffers(it,Jn!==0);Qn.draw(k,W.TRIANGLES,Kn,ke,kr.alphaBlended,k.renderElevatedRasterBackface?hr.frontCCW:hr.backCCW,dn,R.id,Er,Vr,Wr)}}else{const Kn=k.depthModeForSublayer(0,Ln.ReadOnly),Jn=ue[Ue.overscaledZ],{tileBoundsBuffer:Zn,tileBoundsIndexBuffer:Er,tileBoundsSegments:Vr}=k.getTileBoundsBuffers(Ve);Qn.draw(k,W.TRIANGLES,Kn,Jn,kr.alphaBlended,hr.disabled,dn,R.id,Zn,Er,Vr)}}k.resetStencilClippingMasks()}(g,o,d,m),g.style.map.triggerRepaint())},background:function(g,o,d,m){const S=d.paint.get("background-color"),A=d.paint.get("background-color-use-theme").constantOr("default")==="none",k=d.paint.get("background-opacity"),N=d.paint.get("background-emissive-strength"),R=d.paint.get("background-pitch-alignment")==="viewport";if(k===0)return;const V=g.context,G=V.gl,X=g.transform,W=X.tileSize,te=d.paint.get("background-pattern");let ie;if(te!==void 0&&(te===null||(ie=g.imageManager.getPattern(i.I.from(te.toString()),d.scope,g.style.getLut(d.scope)),!ie)))return;const se=!te&&S.a===1&&k===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==se)return;const ve=sr.disabled,ue=g.depthModeForSublayer(0,se==="opaque"?Ln.ReadWrite:Ln.ReadOnly),be=g.colorModeForDrapableLayerRenderPass(N),Te=te?"backgroundPattern":"background";let ke,Ue=m;if(Ue||(ke=g.getBackgroundTiles(),Ue=Object.values(ke).map(Fe=>Fe.tileID)),te&&(V.activeTexture.set(G.TEXTURE0),g.imageManager.bind(g.context,d.scope)),R){const Fe=g.getOrCreateProgram(Te,{overrideFog:!1,overrideRtt:!0}),Ve=new Float32Array(i.bA([])),ze=new i.aO(0,0,0,0,0),Oe=te?_r(Ve,N,k,g,0,d.scope,ie,R,{tileID:ze,tileSize:W}):ti(Ve,N,k,S.toPremultipliedRenderColor(A?null:d.lut));Fe.draw(g,G.TRIANGLES,ue,ve,be,hr.disabled,Oe,d.id,g.viewportBuffer,g.quadTriangleIndexBuffer,g.viewportSegments)}else for(const Fe of Ue){const Ve=g.isTileAffectedByFog(Fe),ze=g.getOrCreateProgram(Te,{overrideFog:Ve}),Oe=Fe.toUnwrapped(),Ge=m?Fe.projMatrix:g.transform.calculateProjMatrix(Oe);g.prepareDrawTile();const Tt=o?o.getTile(Fe):ke?ke[Fe.key]:new Jc(Fe,W,X.zoom,g),ut=te?_r(Ge,N,k,g,0,d.scope,ie,R,{tileID:Fe,tileSize:W}):ti(Ge,N,k,S.toPremultipliedRenderColor(A?null:d.lut));g.uploadCommonUniforms(V,ze,Oe);const{tileBoundsBuffer:jt,tileBoundsIndexBuffer:bt,tileBoundsSegments:Dt}=g.getTileBoundsBuffers(Tt);ze.draw(g,G.TRIANGLES,ue,ve,be,hr.disabled,ut,d.id,jt,bt,Dt)}},sky:function(g,o,d){const m=g._atmosphere?i.aj(g.transform.zoom):1,S=d.paint.get("sky-opacity")*m;if(S===0)return;const A=g.context,k=d.paint.get("sky-type"),N=new Ln(A.gl.LEQUAL,Ln.ReadOnly,[0,1]),R=g.frameCounter/1e3%1;k==="atmosphere"?g.renderPass==="offscreen"?d.needsSkyboxCapture(g)&&(function(V,G,X,W){const te=V.context,ie=te.gl;let se=G.skyboxFbo;if(!se){se=G.skyboxFbo=te.createFramebuffer(32,32,!0,null),G.skyboxGeometry=new $y(te),G.skyboxTexture=te.gl.createTexture(),ie.bindTexture(ie.TEXTURE_CUBE_MAP,G.skyboxTexture),ie.texParameteri(ie.TEXTURE_CUBE_MAP,ie.TEXTURE_WRAP_S,ie.CLAMP_TO_EDGE),ie.texParameteri(ie.TEXTURE_CUBE_MAP,ie.TEXTURE_WRAP_T,ie.CLAMP_TO_EDGE),ie.texParameteri(ie.TEXTURE_CUBE_MAP,ie.TEXTURE_MIN_FILTER,ie.LINEAR),ie.texParameteri(ie.TEXTURE_CUBE_MAP,ie.TEXTURE_MAG_FILTER,ie.LINEAR);for(let Te=0;Te<6;++Te)ie.texImage2D(ie.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,ie.RGBA,32,32,0,ie.RGBA,ie.UNSIGNED_BYTE,null)}te.bindFramebuffer.set(se.framebuffer),te.viewport.set([0,0,32,32]);const ve=G.getCenter(V,!0),ue=V.getOrCreateProgram("skyboxCapture"),be=new Float64Array(16);i.bA(be),i.ek(be,be,.5*-Math.PI),Wf(V,G,ue,be,ve,0),i.bA(be),i.ek(be,be,.5*Math.PI),Wf(V,G,ue,be,ve,1),i.bA(be),i.cT(be,be,.5*-Math.PI),Wf(V,G,ue,be,ve,2),i.bA(be),i.cT(be,be,.5*Math.PI),Wf(V,G,ue,be,ve,3),i.bA(be),Wf(V,G,ue,be,ve,4),i.bA(be),i.ek(be,be,Math.PI),Wf(V,G,ue,be,ve,5),te.viewport.set([0,0,V.width,V.height])}(g,d),d.markSkyboxValid(g)):g.renderPass==="sky"&&function(V,G,X,W,te){const ie=V.context,se=ie.gl,ve=V.transform,ue=V.getOrCreateProgram("skybox");ie.activeTexture.set(se.TEXTURE0),se.bindTexture(se.TEXTURE_CUBE_MAP,G.skyboxTexture);const be=((Te,ke,Ue,Fe,Ve)=>({u_matrix:Te,u_sun_direction:ke,u_cubemap:0,u_opacity:Fe,u_temporal_offset:Ve}))(ve.skyboxMatrix,G.getCenter(V,!1),0,W,te);V.uploadCommonUniforms(ie,ue),ue.draw(V,se.TRIANGLES,X,sr.disabled,V.colorModeForRenderPass(),hr.backCW,be,"skybox",G.skyboxGeometry.vertexBuffer,G.skyboxGeometry.indexBuffer,G.skyboxGeometry.segment)}(g,d,N,S,R):k==="gradient"&&g.renderPass==="sky"&&function(V,G,X,W,te){const ie=V.context,se=ie.gl,ve=V.transform,ue=V.getOrCreateProgram("skyboxGradient");G.skyboxGeometry||(G.skyboxGeometry=new $y(ie)),ie.activeTexture.set(se.TEXTURE0);let be=G.colorRampTexture;be||(be=G.colorRampTexture=new i.T(ie,G.colorRamp,se.RGBA8)),be.bind(se.LINEAR,se.CLAMP_TO_EDGE);const Te=((ke,Ue,Fe,Ve,ze)=>({u_matrix:ke,u_color_ramp:0,u_center_direction:Ue,u_radius:i.an(Fe),u_opacity:Ve,u_temporal_offset:ze}))(ve.skyboxMatrix,G.getCenter(V,!1),G.paint.get("sky-gradient-radius"),W,te);V.uploadCommonUniforms(ie,ue),ue.draw(V,se.TRIANGLES,X,sr.disabled,V.colorModeForRenderPass(),hr.backCW,Te,"skyboxGradient",G.skyboxGeometry.vertexBuffer,G.skyboxGeometry.indexBuffer,G.skyboxGeometry.segment)}(g,d,N,S,R)},custom:function(g,o,d,m){const S=g.context,A=d.implementation;if(!g.transform.projection.unsupportedLayers||!g.transform.projection.unsupportedLayers.includes("custom")||g.terrain&&(g.terrain.renderingToTexture||g.renderPass==="offscreen")&&d.isDraped(o)){if(g.renderPass==="offscreen"){const k=A.prerender;if(k){if(g.setCustomLayerDefaults(),S.setColorMode(g.colorModeForRenderPass()),g.transform.projection.name==="globe"){const N=g.transform.pointMerc;k.call(A,S.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),i.aj(g.transform.zoom),[N.x,N.y],g.transform.pixelsPerMeterRatio)}else k.call(A,S.gl,g.transform.customLayerMatrix());S.setDirty(),g.setBaseState()}}else if(g.renderPass==="translucent"){if(g.terrain&&g.terrain.renderingToTexture){const N=A.renderToTile;if(N){const R=m[0].canonical,V={x:R.x+m[0].wrap*(A.wrapTileId?0:1<<R.z),y:R.y,z:R.z};S.setDepthMode(Ln.disabled),S.setStencilMode(sr.disabled),S.setColorMode(g.colorModeForRenderPass()),g.setCustomLayerDefaults(),N.call(A,S.gl,V),S.setDirty(),g.setBaseState()}return}g.setCustomLayerDefaults(),S.setColorMode(g.colorModeForRenderPass()),S.setStencilMode(sr.disabled);const k=A.renderingMode==="3d"?new Ln(g.context.gl.LEQUAL,Ln.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,Ln.ReadOnly);if(S.setDepthMode(k),g.transform.projection.name==="globe"){const N=g.transform.pointMerc;A.render(S.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),i.aj(g.transform.zoom),[N.x,N.y],g.transform.pixelsPerMeterRatio)}else A.render(S.gl,g.transform.customLayerMatrix());S.setDirty(),g.setBaseState(),S.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(g,o,d,m){if(g.renderPass==="opaque")return;const S=d.paint.get("model-opacity").constantOr(1);if(S===0)return;const A=d.paint.get("model-cast-shadows");if(g.renderPass==="shadow"&&(!A||g.terrain&&S<.65&&d._transitionablePaint._values["model-opacity"].value.expression instanceof i.ad))return;const k=g.shadowRenderer,N=d.paint.get("model-receive-shadows");k&&(k.useNormalOffset=!0,N||(k.enabled=!1));const R=()=>{k&&(k.useNormalOffset=!0,N||(k.enabled=!0))},V=o.getSource();if(g.renderPass==="light-beam"&&V.type!=="batched-model")return;if(V.type==="vector"||V.type==="geojson")return function(ue,be,Te,ke,Ue){const Fe=ue.transform;if(Fe.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${Fe.projection.name} projection is not yet implemented`);const Ve=Fe.getFreeCameraOptions().position;if(!ue.modelManager)return;const ze=ue.modelManager;Te.modelManager=ze;const Oe=ue.shadowRenderer;if(!Te._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Ge=Te._unevaluatedLayout._values["model-id"],Tt=Object.assign({},Te.layout.get("model-id").parameters),ut=ue.style.order.indexOf(Te.fqid);for(const jt of ke){const bt=be.getTile(jt).getBucket(Te);if(!bt||bt.projection.name!==Fe.projection.name)continue;const Dt=bt.getModelUris();Dt&&!bt.modelsRequested&&(ze.addModelsFromBucket(Dt,Ue),bt.modelsRequested=!0);const gn=Jp(jt,Fe);Tt.zoom=gn;const St=Ge.possiblyEvaluate(Tt);if(Wx(ue,bt,jt),lu.shadowUniformsInitialized=!1,lu.useSingleShadowCascade=!!Oe&&Oe.getMaxCascadeForTile(jt.toUnwrapped())===0,ue.renderPass==="shadow"&&Oe){if(ue.currentShadowCascade===1&&bt.isInsideFirstShadowMapFrustum)continue;const Nt=Fe.calculatePosMatrix(jt.toUnwrapped(),Fe.worldSize);if(lu.tileMatrix.set(Nt),lu.shadowTileMatrix=Float32Array.from(Oe.calculateShadowPassMatrixFromMatrix(Nt)),lu.aabb.min=[0,0,0],lu.aabb.max[0]=lu.aabb.max[1]=i.al,lu.aabb.max[2]=0,mg(bt,lu,ue,Te.scope))continue}const it=1<<jt.canonical.z,Ut=[((Ve.x-jt.wrap)*it-jt.canonical.x)*i.al,(Ve.y*it-jt.canonical.y)*i.al,Ve.z*it*i.al];ue.conflationActive&&Object.keys(bt.instancesPerModel).length>0&&ue.style.isLayerClipped(Te,be.getSource())&&bt.updateReplacement(jt,ue.replacementSource,ut,Ue)&&(bt.uploaded=!1,bt.upload(ue.context));for(let Nt in bt.instancesPerModel){const Qt=bt.instancesPerModel[Nt];Qt.features.length>0&&(Nt=St.evaluate(Qt.features[0].feature,{}));const mn=ze.getModel(Nt,Ue);if(mn||ze.hasURLBeenRequested(Nt)||bt.modelUris.includes(Nt)||(bt.modelUris.push(Nt),bt.modelsRequested=!1),mn&&mn.uploaded)for(const Nn of mn.nodes)Qp(ue,Te,Nn,Qt,Ut,jt,lu)}}}(g,o,d,m,V.type==="vector"?d.scope:""),void R();if(!V.loaded())return;if(V.type==="batched-model")return function(ue,be,Te,ke){Te.resetLayerRenderingStats(ue);const Ue=ue.context,Fe=ue.transform,Ve=ue.style.fog,ze=ue.shadowRenderer;if(Fe.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${Fe.projection.name} projection is not yet implemented`);const Oe=ue.transform.getFreeCameraOptions().position,Ge=i.c4([],[Oe.x,Oe.y,Oe.z],ue.transform.worldSize),Tt=i.et([],Ge),ut=i.bA([]),jt=i.ec(Fe.center.lat,Fe.zoom),bt=i.bq([],[1,1,1/jt]);i.br(ut,ut,Tt);const Dt=Te.paint.get("model-opacity").constantOr(1),gn=new Ln(Ue.gl.LEQUAL,Ln.ReadWrite,ue.depthRangeFor3D),St=new Ln(Ue.gl.LEQUAL,Ln.ReadOnly,ue.depthRangeFor3D),it=new i.d8([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Ut=ue.renderPass==="shadow",Nt=Ut&&ze?ze.getCurrentCascadeFrustum():Fe.getFrustum(Fe.scaleZoom(Fe.worldSize)),Qt=Te.paint.get("model-front-cutoff"),mn=Qt[2]<1,Nn=fa(ue,Te.paint.get("model-cutoff-fade-range")),dn=Te.getLayerRenderingStats();(function(rn,Qn,Kn,Jn){const Zn=rn.terrain?rn.terrain.exaggeration():0,Er=rn.transform.zoom;for(const Vr of Jn){const Wr=Qn.getTile(Vr).getBucket(Kn);Wr&&(Wr.setFilter(Kn.filter),rn.conflationActive&&Wr.updateReplacement(Vr,rn.replacementSource),Wr.evaluateTransform(rn,Kn),rn.terrain&&Zn>0&&Wr.elevationUpdate(rn.terrain,Zn,Vr,Kn.source),Wr.needsReEvaluation(rn,Er,Kn)&&Wr.evaluate(Kn))}})(ue,be,Te,ke),function(){let rn,Qn,Kn;mn?(rn=ke.length-1,Qn=-1,Kn=-1):(rn=0,Qn=ke.length,Kn=1);const Jn=new Float64Array(16),Zn=i.cz(),Er=new i.P(0,0);for(let Vr=rn;Vr!==Qn;Vr+=Kn){const Wr=ke[Vr],Ki=be.getTile(Wr).getBucket(Te);if(!Ki||!Ki.uploaded)continue;let Nr=!1;ze&&(Nr=ze.getMaxCascadeForTile(Wr.toUnwrapped())===0);const Ri=Fe.calculatePosMatrix(Wr.toUnwrapped(),Fe.worldSize),qi=Ki.modelTraits;!Ut&&mn&&(i.bl(Jn,Ri),i.af(Zn,Ge,Jn),Er.x=Zn[0],Er.y=Zn[1]);const Rs=[];Ki.setFilter(Te.filter);for(const $r of Ki.getNodesInfo()){if($r.hiddenByReplacement||!$r.node.meshes)continue;const zi=$r.node;let ji=0;ue.terrain&&zi.elevation&&(ji=zi.elevation*ue.terrain.exaggeration());const Ui=(()=>{const el=$r.aabb;return it.min=[...el.min],it.max=[...el.max],it.min[2]+=ji,it.max[2]+=ji,i.af(it.min,it.min,Ri),i.af(it.max,it.max,Ri),it})(),Vs=$r.evaluatedScale;if(Vs[0]<=1&&Vs[1]<=1&&Vs[2]<=1&&Ui.intersects(Nt)===0)continue;if(!Ut&&mn){const el=.16666666666666666;$r.cameraCollisionOpacity=Ge[0]>Ui.min[0]&&Ge[0]<Ui.max[0]&&Ge[1]>Ui.min[1]&&Ge[1]<Ui.max[1]&&Ge[2]*jt<Ui.max[2]&&zi.footprint&&i.b$(Er,zi.footprint)?Math.max($r.cameraCollisionOpacity-el,0):Math.min(1,$r.cameraCollisionOpacity+el)}const ba=[...Ri],Mo=1/i.d6(Wr.canonical),$s=zi.anchor?zi.anchor[0]:0,Zr=zi.anchor?zi.anchor[1]:0;i.br(ba,ba,[$s*(Vs[0]-1)+$r.evaluatedTranslation[0]*Mo,Zr*(Vs[1]-1)+$r.evaluatedTranslation[1]*Mo,ji+$r.evaluatedTranslation[2]]),i.cp(Vs,i.ev)||i.cR(ba,ba,Vs);const gr=i.aB([],ba,zi.matrix),Yi=i.aB([],Fe.expandedFarZProjMatrix,gr),la=i.aB([],Fe.expandedFarZProjMatrix,ba),Ks=i.aC([],[$s,Zr,ji,1],Yi)[2];zi.hidden=!1;let Va=Dt;Ut||(mn&&(Va*=$r.cameraCollisionOpacity,Va*=kd(ba,Fe,$r.aabb,Qt)),Va*=cu(Nn,Ks)),Va!==0?Rs.push({nodeInfo:$r,depth:Ks,opacity:Va,wvpForNode:Yi,wvpForTile:la,nodeModelMatrix:gr,tileModelMatrix:ba}):zi.hidden=!0}Ut||Rs.sort(($r,zi)=>!mn||$r.opacity===1&&zi.opacity===1?$r.depth<zi.depth?-1:1:$r.opacity===1?-1:zi.opacity===1?1:$r.depth>zi.depth?-1:1);for(const $r of Rs){const zi=$r.nodeInfo,ji=zi.node;let Ui=i.aB([],bt,$r.tileModelMatrix);i.aB(Ui,ut,Ui);const Vs=i.bl([],Ui);i.ed(Vs,Vs),i.cR(Vs,Vs,Kv),Ui=i.aB(Ui,Ui,ji.matrix);const ba=ue.renderPass==="light-beam",Mo=Te.paint.get("model-color-use-theme").constantOr("default")==="none",$s=qi&i.ez.HasMapboxMeshFeatures,Zr=$s?0:zi.evaluatedRMEA[0][2];for(let gr=0;gr<ji.meshes.length;++gr){const Yi=ji.meshes[gr],la=gr===ji.lightMeshIndex;let Ks=$r.wvpForNode;if(la){if(!ba&&!ue.terrain&&ue.shadowRenderer){ue.currentLayer<ue.firstLightBeamLayer&&(ue.firstLightBeamLayer=ue.currentLayer);continue}Ks=$r.wvpForTile}else if(ba)continue;const Va={defines:[]},el=[];if(!Ut&&ze&&(ze.useNormalOffset=!!Yi.normalBuffer),pg(Va.defines,el,Yi,ue,Mo?null:Te.lut),$s||Va.defines.push("DIFFUSE_SHADED"),Nr&&Va.defines.push("SHADOWS_SINGLE_CASCADE"),dn&&(Ut?dn.numRenderedVerticesInShadowPass+=Yi.vertexArray.length:dn.numRenderedVerticesInTransparentPass+=Yi.vertexArray.length),Ut){Xp(Yi,$r.nodeModelMatrix,ue,Te);continue}let Uu=null;if(Ve){const lh=yt($r.nodeModelMatrix,ue.transform);if(Uu=new Float32Array(lh),Fe.projection.name!=="globe"){const ga=Yi.aabb.min,wa=Yi.aabb.max,[Ys,ao]=Ve.getOpacityForBounds(lh,ga[0],ga[1],wa[0],wa[1]);Va.overrideFog=Ys>=Vn||ao>=Vn}}const Vu=Yi.material;let uu;Vu.occlusionTexture&&Vu.occlusionTexture.offsetScale&&(uu=Vu.occlusionTexture.offsetScale,Va.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const du=ue.getOrCreateProgram("model",Va);!Ut&&ze&&ze.setupShadowsFromMatrix($r.tileModelMatrix,du,ze.useNormalOffset),ue.uploadCommonUniforms(Ue,du,null,Uu);const _c=Vu.pbrMetallicRoughness;_c.metallicFactor=.9,_c.roughnessFactor=.5;const Id=Fi(new Float32Array(Ks),new Float32Array(Ui),new Float32Array(Vs),new Float32Array(ji.matrix),ue,$r.opacity,_c.baseColorFactor,Vu.emissiveFactor,_c.metallicFactor,_c.roughnessFactor,Vu,Zr,Te,[0,0,0],uu);!la&&(zi.hasTranslucentParts||$r.opacity<1)&&du.draw(ue,Ue.gl.TRIANGLES,gn,sr.disabled,kr.disabled,hr.backCCW,Id,Te.id,Yi.vertexBuffer,Yi.indexBuffer,Yi.segments,Te.paint,ue.transform.zoom,void 0,el),du.draw(ue,Ue.gl.TRIANGLES,la?St:gn,sr.disabled,la||$r.opacity<1||zi.hasTranslucentParts?kr.alphaBlended:kr.unblended,hr.backCCW,Id,Te.id,Yi.vertexBuffer,Yi.indexBuffer,Yi.segments,Te.paint,ue.transform.zoom,void 0,el)}}}}()}(g,o,d,m),void R();if(V.type!=="model")return;const G=V.getModels(),X=[],W=g.transform.getFreeCameraOptions().position,te=i.c4([],[W.x,W.y,W.z],g.transform.worldSize);i.et(te,te);const ie=[],se=[];let ve=0;for(const ue of G){const be=d.paint.get("model-rotation").constantOr(null),Te=d.paint.get("model-scale").constantOr(null),ke=d.paint.get("model-translation").constantOr(null);ue.computeModelMatrix(g,be,Te,ke,!0,!0,!1);const Ue=i.bA([]),Fe=i.ec(ue.position.lat,g.transform.zoom),Ve=i.bq([],[1,1,1/Fe]);i.br(Ue,Ue,te),X.push({zScaleMatrix:Ve,negCameraPosMatrix:Ue});for(const ze of ue.nodes)qy(g.transform,ze,ue.matrix,g.transform.expandedFarZProjMatrix,ve,ie,se);ve++}if(ie.sort((ue,be)=>be.depth-ue.depth),g.renderPass!=="shadow"){if(S===1)for(const ue of se)ou(ue,g,d,X[ue.modelIndex],sr.disabled,g.colorModeForRenderPass());else{for(const ue of se)ou(ue,g,d,X[ue.modelIndex],sr.disabled,kr.disabled);for(const ue of se)ou(ue,g,d,X[ue.modelIndex],g.stencilModeFor3D(),g.colorModeForRenderPass());g.resetStencilClippingMasks()}for(const ue of ie)ou(ue,g,d,X[ue.modelIndex],sr.disabled,g.colorModeForRenderPass());R()}else{for(const ue of se)Xp(ue.mesh,ue.nodeModelMatrix,g,d);for(const ue of ie)Xp(ue.mesh,ue.nodeModelMatrix,g,d);R()}}},vg={line:function(g,o,d){if(g.hasElevatedBuckets=!1,g.hasNonElevatedBuckets=!1,g._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||g._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(o){const m=o.getVisibleCoordinates();for(const S of m){const A=o.getTile(S).getBucket(g);if(A&&(A.elevationType!=="none"?g.hasElevatedBuckets=!0:g.hasNonElevatedBuckets=!0,g.hasElevatedBuckets&&g.hasNonElevatedBuckets))break}}}else g.hasNonElevatedBuckets=!0},model:function(g,o,d){const m=o.getSource();if(!m.loaded())return;if(m.type==="vector"||m.type==="geojson")return void(d.modelManager&&d.modelManager.upload(d,m.type==="vector"?g.scope:""));if(m.type==="batched-model"||m.type!=="model")return;const S=m.getModels();for(const A of S)A.upload(d.context)},raster:function(g,o,d){const m=o.getSource();if(!(m instanceof ku&&m.loaded()))return;const S=g.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!S)return;const A=g.paint.get("raster-array-band")||m.getInitialBand(S);if(A==null)return;const k=o.getIds().map(N=>o.getTileByID(N));for(const N of k)N.updateNeeded(g.id,A)&&m.prepareTile(N,S,g.id,A)},"raster-particle":function(g,o,d){const m=o.getSource();if(!(m instanceof ku&&m.loaded()))return;const S=g.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!S)return;const A=g.paint.get("raster-particle-array-band")||m.getInitialBand(S);if(A==null)return;const k=o.getIds().map(N=>o.getTileByID(N));for(const N of k)N.updateNeeded(g.id,A)&&m.prepareTile(N,S,g.id,A)}},_g={fill:Us},sm={fill:function(g,o,d,m){if(!d.layout||d.layout.get("fill-elevation-reference")==="none")return;const S=g.context.gl,A=new Ln(S.LEQUAL,Ln.ReadOnly,g.depthRangeFor3D),k=new sr({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),N=g.transform.getFreeCameraOptions().position,R=g.getOrCreateProgram("elevatedStructuresDepthReconstruct");for(const V of m){const G=o.getTile(V),X=G.getBucket(d);if(!X)continue;const W=X.elevatedStructures;if(!W||W.depthSegments.segments[0].primitiveLength===0)continue;const te=Wl(V.toUnwrapped(),N),ie=g.translatePosMatrix(V.projMatrix,G,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor")),se=Bt(ie,te,0,1,0);R.draw(g,S.TRIANGLES,A,k,kr.disabled,hr.disabled,se,d.id,W.vertexBuffer,W.indexBuffer,W.depthSegments,d.paint,g.transform.zoom)}}};class t2{constructor(o,d,m,S,A,k){this.context=new hl(o,d),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=A,this._timeStamp=i.o.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const N=["fill","line","symbol","circle","heatmap","fill-extrusion","building","raster","raster-particle","hillshade","model","background","sky"];for(const V of N)this._debugParams.enabledLayers[V]=!0;A.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),A.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),A.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),A.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),A.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),A.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const V of N)A.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],V);this.occlusionParams=new em(A),this.setup(),this.numSublayers=qo.maxUnderzooming+qo.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.eG,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new rg(this),this._wireframeDebugCache=new gg,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const R=new i.q({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,R,o.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=S,this.worldview=k}updateTerrain(o,d){const m=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new dg(this,o));const S=this._terrain;this.transform.elevation=m?S:null,S.update(o,this.transform,d),this.transform.elevation&&!S.enabled&&(this.transform.elevation=null)}_updateFog(o){const d=o.fog;if(!d||this.transform.projection.name==="globe"||d.getOpacity(this.transform.pitch)<1||d.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,S]=d.getFovAdjustedRange(this.transform._fov);if(m>S)return void(this.transform.fogCullDistSq=null);const A=m+.78*(S-m);this.transform.fogCullDistSq=A*A}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(o){o&&!this._terrain&&(this._terrain=new dg(this,this.style)),this._forceTerrainMode=o}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(o,d){if(this.width=o*i.o.devicePixelRatio,this.height=d*i.o.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._mergedLayers[m].resize()}setup(){const o=this.context,d=new i.bd;d.emplaceBack(0,0),d.emplaceBack(i.al,0),d.emplaceBack(0,i.al),d.emplaceBack(i.al,i.al),this.tileExtentBuffer=o.createVertexBuffer(d,i.bf.members),this.tileExtentSegments=i.bg.simpleSegment(0,0,4,2);const m=new i.bd;m.emplaceBack(0,0),m.emplaceBack(i.al,0),m.emplaceBack(0,i.al),m.emplaceBack(i.al,i.al),this.debugBuffer=o.createVertexBuffer(m,i.bf.members),this.debugSegments=i.bg.simpleSegment(0,0,4,5);const S=new i.bd;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(-1,1),S.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(S,i.bf.members),this.viewportSegments=i.bg.simpleSegment(0,0,4,2);const A=new i.b0;A.emplaceBack(0,0,0,0),A.emplaceBack(i.al,0,i.al,0),A.emplaceBack(0,i.al,0,i.al),A.emplaceBack(i.al,i.al,i.al,i.al),this.mercatorBoundsBuffer=o.createVertexBuffer(A,i.bi.members),this.mercatorBoundsSegments=i.bg.simpleSegment(0,0,4,2);const k=new i.b1;k.emplaceBack(0,1,2),k.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(k);const N=new i.be;for(const V of[0,1,3,2,0])N.emplaceBack(V);this.debugIndexBuffer=o.createIndexBuffer(N),this.emptyTexture=new i.T(o,new i.q({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA8),this.identityMat=i.bC();const R=this.context.gl;this.stencilClearMode=new sr({func:R.ALWAYS,mask:0},0,255,R.ZERO,R.ZERO,R.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,o.TRIANGLES,Ln.disabled,this.stencilClearMode,kr.disabled,hr.disabled,Gf(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,d,m){if(!d||this.currentStencilSource===d.id||!o.isTileClipped()||!m||m.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let N=!1;for(const R of m)if(this._tileClippingMaskIDs[R.key]===void 0){N=!0;break}if(!N)return}this.currentStencilSource=d.id;const S=this.context,A=S.gl;this.nextStencilID+m.length>256&&this.clearStencil(),S.setColorMode(kr.disabled),S.setDepthMode(Ln.disabled);const k=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const N of m){const R=d.getTile(N),V=this._tileClippingMaskIDs[N.key]=this.nextStencilID++,{tileBoundsBuffer:G,tileBoundsIndexBuffer:X,tileBoundsSegments:W}=this.getTileBoundsBuffers(R);k.draw(this,A.TRIANGLES,Ln.disabled,new sr({func:A.ALWAYS,mask:0},V,255,A.KEEP,A.KEEP,A.REPLACE),kr.disabled,hr.disabled,Gf(N.projMatrix),"$clipping",G,X,W)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,d=this.context.gl;return new sr({func:d.NOTEQUAL,mask:255},o,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const d=this.context.gl;return new sr({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(o){const d=this.context.gl,m=o.sort((k,N)=>N.overscaledZ-k.overscaledZ),S=m[m.length-1].overscaledZ,A=m[0].overscaledZ-S+1;if(A>1){this.currentStencilSource=void 0,this.nextStencilID+A>256&&this.clearStencil();const k={};for(let N=0;N<A;N++)k[N+S]=new sr({func:d.GEQUAL,mask:255},N+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=A,[k,m]}return[{[S]:sr.disabled},m]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new kr([o.CONSTANT_COLOR,o.ONE,o.CONSTANT_COLOR,o.ONE],new i.ao(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?kr.unblended:kr.alphaBlended}colorModeForDrapableLayerRenderPass(o){const d=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new kr([d.ONE,d.ONE_MINUS_SRC_ALPHA,d.CONSTANT_ALPHA,d.ONE_MINUS_SRC_ALPHA],new i.ao(0,0,0,o===void 0?0:o),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(o,d,m,S=!1){if(this.depthOcclusion)return new Ln(this.context.gl.GREATER,Ln.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!S)return Ln.disabled;const A=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new Ln(m||this.context.gl.LEQUAL,d,[A,A])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const o=this.context.gl,d=Math.ceil(this.width),m=Math.ceil(this.height),S=this.context.bindFramebuffer.get(),A=o.getParameter(o.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===d&&this.depthFBO.height===m||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),d!==0&&m!==0&&(this.depthFBO=new Go(this.context,d,m,!1,"texture"),this.depthTexture=new i.T(this.context,{width:d,height:m,data:null},o.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(S),o.bindTexture(o.TEXTURE_2D,A),this.depthFBO&&(o.bindFramebuffer(o.READ_FRAMEBUFFER,null),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),o.blitFramebuffer(0,0,d,m,0,0,d,m,o.DEPTH_BUFFER_BIT,o.NEAREST),o.bindFramebuffer(o.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((o,d)=>o+d/this._fpsHistory.length,0))}render(o,d){const m=i.o.now();this._dt=m-this._timeStamp,this._timeStamp=m,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=o.map.repaint,this.style=o,this.options=d;const S=this.style._mergedLayers,A=!(!this.terrain||!this.terrain.enabled),k=()=>this.style._getOrder(A).filter(St=>{const it=S[St];return!(it.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[it.type]});let N=k(),R=!1,V=!1,G=null;for(const St of N){const it=S[St];it.type==="circle"?R=!0:it.type==="building"?G=it:it.type==="symbol"&&(it.hasOcclusionOpacityProperties?V=!0:R=!0)}let X=N.map(St=>S[St]);const W=this.style._mergedSourceCaches;this.imageManager=o.imageManager,this.modelManager=o.modelManager,this.symbolFadeChange=o.placement.symbolFadeChange(i.o.now()),this.imageManager.beginFrame();let te=0,ie=!1;for(const St in W){const it=W[St];it.used&&(it.prepare(this.context),it.getSource().usedInConflation&&++te)}let se=!1;for(const St of X)St.isHidden(this.transform.zoom)||(St.type==="clip"&&(se=!0),this.prepareLayer(St));const ve={},ue={},be={},Te={},ke={};for(const St in W){const it=W[St];ve[St]=it.getVisibleCoordinates(),ue[St]=ve[St].slice().reverse(),be[St]=it.getVisibleCoordinates(!0).reverse(),Te[St]=it.getShadowCasterCoordinates(),ke[St]=it.sortCoordinatesByDistance(ve[St])}const Ue=St=>{const it=this.style.getLayerSourceCache(St);return it&&it.used?it.getSource():null};if(te||se||this._clippingActiveLastFrame){const St=[],it=[];let Ut=0;for(const Nt of X)this.isSourceForClippingOrConflation(Nt,Ue(Nt))&&(St.push(Nt),it.push(Ut)),Ut++;if(St&&(se||St.length>1)||this._clippingActiveLastFrame){se=!1;const Nt=[];for(let Qt=0;Qt<St.length;Qt++){const mn=St[Qt],Nn=it[Qt],dn=this.style.getLayerSourceCache(mn);if(!dn||!dn.used||!dn.getSource().usedInConflation&&mn.type!=="clip"&&mn.type!=="building")continue;let rn=i.eH,Qn=i.bZ.None;const Kn=[];let Jn=!0;if(mn.type==="building")rn=i.eJ;else if(mn.type==="clip"){rn=Nn;for(const Zn of mn.layout.get("clip-layer-types"))Qn|=Zn==="model"?i.bZ.Model:Zn==="symbol"?i.bZ.Symbol:i.bZ.FillExtrusion;for(const Zn of mn.layout.get("clip-layer-scope"))Kn.push(Zn);mn.isHidden(this.transform.zoom)?Jn=!1:se=!0}Jn&&Nt.push({layer:mn.fqid,cache:dn,order:rn,clipMask:Qn,clipScope:Kn})}this.replacementSource.setSources(Nt),ie=!0}}this._clippingActiveLastFrame=se,ie||this.replacementSource.clear(),this.conflationActive=ie,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let St=0;St<X.length;St++){const it=X[St],Ut=it.cutoffRange();if(this.longestCutoffRange=Math.max(Ut,this.longestCutoffRange),Ut>0){const Nt=Ue(it);Nt&&(this.minCutoffZoom=Math.max(Nt.minzoom,this.minCutoffZoom)),it.minzoom&&(this.minCutoffZoom=Math.max(it.minzoom,this.minCutoffZoom))}it.is3D(A)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=St),this._lastOcclusionLayer=St)}const Fe=this.style&&this.style.fog;Fe?(this._fogVisible=Fe.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Fe.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(be),this.opaquePassCutoff=0,N=k(),X=N.map(St=>S[St]));const Ve=this._shadowRenderer;if(Ve){Ve.updateShadowParameters(this.transform,this.style.directionalLight);for(const St in W)for(const it of ve[St]){let Ut={min:0,max:0};this.terrain&&(Ut=this.terrain.getMinMaxForTile(it)||Ut),Ve.addShadowReceiver(it.toUnwrapped(),Ut.min,Ut.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.eI(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Zf(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const ze=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Oe=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(ze&&!this._snow&&(this._snow=new gT(this)),!ze&&this._snow&&(this._snow.destroy(),delete this._snow),Oe&&!this._rain&&(this._rain=new Ds(this)),!Oe&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),G){this.buildingTileBorderManager||(this.buildingTileBorderManager=new Zs);const St=this.style.getLayerSourceCache(G);this.buildingTileBorderManager.updateBorders(St,G)}if(!Ht.has(this.context.gl))return;this.renderPass="offscreen";for(const St of X){const it=o.getLayerSourceCache(St);if(!St.hasOffscreenPass()||St.isHidden(this.transform.zoom))continue;const Ut=it?ue[it.id]:void 0;(St.type==="custom"||St.type==="raster"||St.type==="raster-particle"||St.isSky()||Ut&&Ut.length)&&this.renderLayer(this,it,St,Ut)}this.depthRangeFor3D=[0,1-(X.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Te)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Ge=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Tt=(()=>{if(d.showOverdrawInspector)return i.ao.black;const St=this.style.fog;if(St&&this.transform.projection.supportsFog){const it=this.style.getLut(St.scope);if(!Ge){const Ut=St.properties.get("color-use-theme")==="none",Nt=St.properties.get("color").toNonPremultipliedRenderColor(Ut?null:it).toArray01();return new i.ao(...Nt)}if(Ge){const Ut=St.properties.get("space-color-use-theme")==="none",Nt=St.properties.get("space-color").toNonPremultipliedRenderColor(Ut?null:it).toArray01();return new i.ao(...Nt)}}return i.ao.transparent})();if(this.context.clear({color:Tt,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ge&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=N.length-1;this.currentLayer>=0;this.currentLayer--){const St=X[this.currentLayer],it=o.getLayerSourceCache(St);if(St.isSky())continue;const Ut=it?(St.is3D(A)?ke:ue)[it.id]:void 0;this._renderTileClippingMasks(St,it,Ut),this.renderLayer(this,it,St,Ut)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ge&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.aj(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<N.length;this.currentLayer++){const St=X[this.currentLayer],it=o.getLayerSourceCache(St);St.isSky()&&this.renderLayer(this,it,St,it?ue[it.id]:void 0)}function ut(St,it){let Ut;return it&&(Ut=(St.type==="symbol"?be:St.is3D(A)?ke:ue)[it.id]),Ut}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<N.length;){const St=X[this.currentLayer];if(St.type==="raster"||St.type==="raster-particle"){const it=o.getLayerSourceCache(St);this.renderLayer(this,it,St,ut(St,it))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let jt=0;Ve&&(jt=Ve.getShadowCastingLayerCount());let bt=!1,Dt=-1;for(let St=0;St<N.length;++St){const it=X[St];it.isHidden(this.transform.zoom)||it.is3D(A)&&(Dt=St)}V&&Dt===-1&&(R=!0);let gn=!1;for(;this.currentLayer<N.length;){const St=X[this.currentLayer],it=o.getLayerSourceCache(St);if(St.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(St)){if(St.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!gn&&St.is3D(A)&&!A){const Ut=this.currentLayer,Nt=Qt=>{for(this.currentLayer=0;this.currentLayer<X.length;this.currentLayer++){const mn=X[this.currentLayer];if(_g[mn.type]){const Nn=this.style.getLayerSourceCache(mn);_g[mn.type](this,Nn,mn,ut(mn,Nn),Qt)}}};Nt("initialize"),Nt("reset"),this.currentLayer=Ut,gn=!0}if(R&&!bt&&this.terrain&&!this.transform.isOrthographic&&(bt=!0,this.blitDepth()),V&&Dt!==-1&&this.currentLayer===Dt+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(St,it,it?ve[it.id]:void 0),this.renderLayer(this,it,St,ut(St,it)),!this.terrain&&Ve&&jt>0&&St.hasShadowPass()&&--jt==0){{this.clearStencil(),this.resetStencilClippingMasks();const Ut=this.currentLayer;for(this.currentLayer=0;this.currentLayer<X.length;this.currentLayer++){const Nt=X[this.currentLayer];if(sm[Nt.type]){const Qt=this.style.getLayerSourceCache(Nt);sm[Nt.type](this,Qt,Nt,ut(Nt,Qt))}}this.currentLayer=Ut}if(Ve.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer){const Ut=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Ut;this.currentLayer++){const Nt=X[this.currentLayer];if(!Nt.hasLightBeamPass())continue;const Qt=o.getLayerSourceCache(Nt);this.renderLayer(this,Qt,Nt,Qt?ue[Qt.id]:void 0)}this.currentLayer=Ut,this.renderPass="translucent"}}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Ut=this.currentLayer;this.depthOcclusion=!0;for(const Nt of this.layersWithOcclusionOpacity){this.currentLayer=Nt;const Qt=X[this.currentLayer],mn=o.getLayerSourceCache(Qt),Nn=mn?ue[mn.id]:void 0;this.terrain||this._renderTileClippingMasks(Qt,mn,mn?ve[mn.id]:void 0),this.renderLayer(this,mn,Qt,Nn)}this.depthOcclusion=!1,this.currentLayer=Ut,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let St=null;X.forEach(it=>{const Ut=o.getLayerSourceCache(it);Ut&&!it.isHidden(this.transform.zoom)&&Ut.getVisibleCoordinates().length&&(!St||St.getSource().maxzoom<Ut.getSource().maxzoom)&&(St=Ut)}),St&&this.options.showTileBoundaries&&Uy(this,St,St.getVisibleCoordinates(),i.ao.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Uy(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.ao(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(St){const it=St.transform.padding;Fc(St,St.transform.height-(it.top||0),3,Nl),Fc(St,it.bottom||0,3,Ed),hs(St,it.left||0,3,ih),hs(St,St.transform.width-(it.right||0),3,Wv);const Ut=St.transform.centerPoint;(function(Nt,Qt,mn,Nn){Wh(Nt,Qt-1,mn-10,2,20,Nn),Wh(Nt,Qt-10,mn-1,20,2,Nn)})(St,Ut.x,St.transform.height-Ut.y,Zv)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),ie||(this.conflationActive=!1)}prepareLayer(o){this.gpuTimingStart(o);const{unsupportedLayers:d}=this.transform.projection,m=!d||!d.includes(o.type);if(vg[o.type]&&(m||this.terrain&&o.type==="custom")){const S=this.style.getLayerSourceCache(o);vg[o.type](o,S,this)}this.gpuTimingEnd()}renderLayer(o,d,m,S){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="sky"||m.type==="custom"||m.type==="model"||m.type==="raster"||m.type==="raster-particle"||S&&S.length)&&(this.id=m.id,this.gpuTimingStart(m),o.transform.projection.unsupportedLayers&&o.transform.projection.unsupportedLayers.includes(m.type)&&(!o.terrain||m.type!=="custom")||m.type==="clip"||im[m.type](o,d,m,S,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery,m=this.context.gl;let S=this.gpuTimers[o.id];S||(S=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:m.createQuery()}),S.calls++,m.beginQuery(d.TIME_ELAPSED_EXT,S.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,d=this.context.gl,m=d.createQuery();this.deferredRenderGpuTimeQueries.push(m),d.beginQuery(o.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const d={};for(const m in o){const S=o[m],A=this.context.extTimerQuery,k=A.getQueryParameter(S.query,this.context.gl.QUERY_RESULT)/1e6;A.deleteQueryEXT(S.query),d[m]=k}return d}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const d=this.context.gl;let m=0;for(const S of o)m+=d.getQueryParameter(S,d.QUERY_RESULT)/1e6,d.deleteQuery(S);return m}translatePosMatrix(o,d,m,S,A){if(!m[0]&&!m[1])return o;const k=A?S==="map"?this.transform.angle:0:S==="viewport"?-this.transform.angle:0;if(k){const V=Math.sin(k),G=Math.cos(k);m=[m[0]*G-m[1]*V,m[0]*V+m[1]*G]}const N=[A?m[0]:i.ay(d,m[0],this.transform.zoom),A?m[1]:i.ay(d,m[1],this.transform.zoom),0],R=new Float32Array(16);return i.br(R,o,N),R}saveTileTexture(o){if(o.context!==this.context)return;const d=o.size[0],m=this._tileTextures[d];m?m.push(o):this._tileTextures[d]=[o]}getTileTexture(o){const d=this._tileTextures[o];return d&&d.length>0?d.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(o,d,m){const S=m===void 0?this.terrain&&this.terrain.renderingToTexture:m,A=[];return this.style&&this.style.enable3dLights()&&(o==="globeRaster"||o==="terrainRaster"?(A.push("LIGHTING_3D_MODE"),A.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):S||A.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||A.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(A.push("TERRAIN"),this.linearFloatFilteringSupported()&&A.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&A.push("GLOBE"),!this._fogVisible||S||d!==void 0&&!d||A.push("FOG","FOG_DITHERING"),S&&A.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&A.push("OVERDRAW_INSPECTOR"),A}getOrCreateProgram(o,d){this.cache=this.cache||{};const m=d&&d.defines||[],S=d&&d.config,A=this.currentGlobalDefines(o,d&&d.overrideFog,d&&d.overrideRtt).concat(m),k=zy.cacheKey(kl[o],o,A,S);return this.cache[k]||(this.cache[k]=new zy(this.context,o,kl[o],S,Ia[o],A)),this.cache[k]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(o,d){if(this.style.enable3dLights()){const m=this.style.directionalLight,S=this.style.ambientLight;if(m&&S){const A=((k,N,R)=>{const V=k.properties.get("direction"),G=k.properties.get("color-use-theme")==="none",X=k.properties.get("color").toNonPremultipliedRenderColor(G?null:R.getLut(k.scope)).toArray01(),W=k.properties.get("intensity"),te=N.properties.get("color-use-theme")==="none",ie=N.properties.get("color").toNonPremultipliedRenderColor(te?null:R.getLut(N.scope)).toArray01(),se=N.properties.get("intensity"),ve=[V.x,V.y,V.z],ue=i.dK(ie,se),be=i.dK(X,W);return{u_lighting_ambient_color:ue,u_lighting_directional_dir:ve,u_lighting_directional_color:be,u_ground_radiance:hg(ve,be,ue)}})(m,S,this.style);d.setLightsUniformValues(o,A)}}}uploadCommonUniforms(o,d,m,S,A){if(this.uploadCommonLightUniforms(o,d),this.terrain&&this.terrain.renderingToTexture)return;const k=this.style.fog;if(k){const N=k.getOpacity(this.transform.pitch),R=((V,G,X,W,te,ie,se,ve,ue,be,Te,ke)=>{const Ue=V.transform,Fe=G.properties.get("color-use-theme")==="none",Ve=G.properties.get("color").toNonPremultipliedRenderColor(Fe?null:V.style.getLut(G.scope)).toArray01();Ve[3]=W;const ze=V.frameCounter/1e3%1,[Oe,Ge]=G.properties.get("vertical-range");return{u_fog_matrix:X?Ue.calculateFogTileMatrix(X):ke||V.identityMat,u_fog_range:G.getFovAdjustedRange(Ue._fov),u_fog_color:Ve,u_fog_horizon_blend:G.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Oe,Ge),Ge],u_fog_temporal_offset:ze,u_frustum_tl:te,u_frustum_tr:ie,u_frustum_br:se,u_frustum_bl:ve,u_globe_pos:ue,u_globe_radius:be,u_viewport:Te,u_globe_transition:i.aj(Ue.zoom),u_is_globe:+(Ue.projection.name==="globe")}})(this,k,m,N,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.o.devicePixelRatio,this.transform.height*i.o.devicePixelRatio],S);d.setFogUniformValues(o,R)}A&&d.setCutoffUniformValues(o,A.uniformValues)}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){const o=this.canvasCopy();o&&(this.frameCopies.push(o),this.tileLoaded=!1)}canvasCopy(){const o=this.context.gl,d=o.createTexture();return o.bindTexture(o.TEXTURE_2D,d),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),d}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,d=this._backgroundTiles={},m=this.transform.coveringTiles({tileSize:512});for(const S of m)d[S.key]=o[S.key]||new Jc(S,512,this.transform.tileZoom,this,void 0,this.worldview);return d}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(o,d){return!(!o.is3D(!(!this.terrain||!this.terrain.enabled))||o.type!=="clip"&&o.type!=="building"&&(o.minzoom&&o.minzoom>this.transform.zoom||(this.style._clipLayerPresent||o.sourceLayer!=="building"&&o.sourceLayer!=="procedural_buildings")&&(!d||d.type!=="batched-model")))}isTileAffectedByFog(o){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let d=this._cachedTileFogOpacities[o.key];return d||(this._cachedTileFogOpacities[o.key]=d=this.style.fog.getOpacityForTile(o)),d[0]>=Vn||d[1]>=Vn}setupDepthForOcclusion(o,d,m){const S=this.context,A=S.gl,k=!!m;var N;m||(m={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),S.activeTexture.set(A.TEXTURE3),o&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),m.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],m.u_depth_range_unpack=[2/((N=this.depthRangeFor3D)[1]-N[0]),-1-2*N[0]/(N[1]-N[0])],m.u_occluder_half_size=.5*this.occlusionParams.occluderSize,m.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),S.activeTexture.set(A.TEXTURE0),k||d.setTerrainUniformValues(S,m)}}function Zx(g,o){let d=!1,m=null;const S=()=>{m=null,d&&(g(),m=setTimeout(S,o),d=!1)};return()=>(d=!0,m||S(),m)}class n2{constructor(o){this._hashName=o&&encodeURIComponent(o),i.aY(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Zx(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const d=Kx(o);if(this._hashName){const m=this._hashName;let S=!1;const A=location.hash.slice(1).split("&").map(k=>{const N=k.split("=")[0];return N===m?(S=!0,`${N}=${d}`):k}).filter(k=>k);return S||A.push(`${m}=${d}`),`#${A.join("&")}`}return`#${d}`}_getCurrentHash(){const o=location.hash.replace("#","");if(this._hashName){let d;return o.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(d=m)}),(d&&d[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const d=this._getCurrentHash();if(d.length>=3&&!d.some(m=>isNaN(Number(m)))){const m=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(d[3]||0):o.getBearing();return o.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:m,pitch:+(d[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Kx(g,o){const d=g.getCenter(),m=Math.round(100*g.getZoom())/100,S=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),A=Math.pow(10,S),k=Math.round(d.lng*A)/A,N=Math.round(d.lat*A)/A,R=g.getBearing(),V=g.getPitch();let G=o?`/${k}/${N}/${m}`:`${m}/${N}/${k}`;return(R||V)&&(G+="/"+Math.round(10*R)/10),V&&(G+=`/${Math.round(V)}`),G}const Bc={linearity:.3,easing:i.eK(0,0,.3,1)},am=Object.assign({deceleration:2500,maxSpeed:1400},Bc),Wy=Object.assign({deceleration:20,maxSpeed:1400},Bc),Yx=Object.assign({deceleration:1e3,maxSpeed:360},Bc),r2=Object.assign({deceleration:1e3,maxSpeed:90},Bc);class i2{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.o.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,d=i.o.now();for(;o.length>0&&d-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const d={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:A}of this._inertiaBuffer)d.zoom+=A.zoomDelta||0,d.bearing+=A.bearingDelta||0,d.pitch+=A.pitchDelta||0,A.panDelta&&d.pan._add(A.panDelta),A.around&&(d.around=A.around),A.pinchAround&&(d.pinchAround=A.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(d.pan.mag()){const A=Zy(d.pan.mag(),m,Object.assign({},am,o||{}));S.offset=d.pan.mult(A.amount/d.pan.mag()),S.center=this._map.transform.center,ah(S,A)}if(d.zoom){const A=Zy(d.zoom,m,Wy);S.zoom=this._map.transform.zoom+A.amount,ah(S,A)}if(d.bearing){const A=Zy(d.bearing,m,Yx);S.bearing=this._map.transform.bearing+i.aA(A.amount,-179,179),ah(S,A)}if(d.pitch){const A=Zy(d.pitch,m,r2);S.pitch=this._map.transform.pitch+A.amount,ah(S,A)}if(S.zoom||S.bearing){const A=d.pinchAround===void 0?d.around:d.pinchAround;S.around=A?this._map.unproject(A):this._map.getCenter()}return this.clear(),S.noMoveStart=!0,S}}function ah(g,o){(!g.duration||g.duration<o.duration)&&(g.duration=o.duration,g.easing=o.easing)}function Zy(g,o,d){const{maxSpeed:m,linearity:S,deceleration:A}=d,k=i.aA(g*S/(o/1e3),-m,m),N=Math.abs(k)/(A*S);return{easing:d.easing,duration:1e3*N,amount:k*(N/2)}}class so extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,m,S={}){const A=pe(d.getCanvasContainer(),m),k=d.unproject(A);super(o,Object.assign({point:A,lngLat:k,originalEvent:m},S)),this._defaultPrevented=!1,this.target=d}}class Ky extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,m){const S=o==="touchend"?m.changedTouches:m.touches,A=he(d.getCanvasContainer(),S),k=A.map(R=>d.unproject(R)),N=A.reduce((R,V,G,X)=>R.add(V.div(X.length)),new i.P(0,0));super(o,{points:A,point:N,lngLats:k,lngLat:d.unproject(N),originalEvent:m}),this._defaultPrevented=!1}}class Xx extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d){super("wheel",{originalEvent:d}),this._defaultPrevented=!1}}class s2{constructor(o,d){this._map=o,this._clickTolerance=d.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new Xx(this._map,o))}mousedown(o,d){return this._mousedownPos=d,this._firePreventable(new so(o.type,this._map,o))}mouseup(o){this._map.fire(new so(o.type,this._map,o))}preclick(o){const d=new MouseEvent("preclick",o);this._map.fire(new so(d.type,this._map,d))}click(o,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||(this.preclick(o),this._map.fire(new so(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new so(o.type,this._map,o))}mouseover(o){this._map.fire(new so(o.type,this._map,o))}mouseout(o){this._map.fire(new so(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Ky(o.type,this._map,o))}touchmove(o){this._map.fire(new Ky(o.type,this._map,o))}touchend(o){this._map.fire(new Ky(o.type,this._map,o))}touchcancel(o){this._map.fire(new Ky(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class a2{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new so(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new so("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new so(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class vo{constructor(o,d){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,d){this.isEnabled()&&o.shiftKey&&o.button===0&&(J(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(o,d){if(!this._active)return;const m=d,S=this._startPos,A=this._lastPos;if(!S||!A||A.equals(m)||!this._box&&m.dist(S)<this._clickTolerance)return;this._lastPos=m,this._box||(this._box=D("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const k=Math.min(S.x,m.x),N=Math.max(S.x,m.x),R=Math.min(S.y,m.y),V=Math.max(S.y,m.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${k}px,${R}px)`,this._box.style.width=N-k+"px",this._box.style.height=V-R+"px")})}mouseupWindow(o,d){if(!this._active)return;const m=this._startPos,S=d;if(m&&o.button===0){if(this.reset(),ne(),m.x!==S.x||m.y!==S.y)return this._map.fire(new i.z("boxzoomend",{originalEvent:o})),{cameraAnimation:A=>A.fitScreenCoordinates(m,S,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ee(),delete this._startPos,delete this._lastPos}_fireEvent(o,d){return this._map.fire(new i.z(o,{originalEvent:d}))}}function Yv(g,o){const d={};for(let m=0;m<g.length;m++)d[g[m].identifier]=o[m];return d}class o2{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,d,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),m.length===this.numTouches&&(this.centroid=function(S){const A=new i.P(0,0);for(const k of S)A._add(k);return A.div(S.length)}(d),this.touches=Yv(m,d)))}touchmove(o,d,m){if(this.aborted||!this.centroid)return;const S=Yv(m,d);for(const A in this.touches){const k=S[A];(!k||k.dist(this.touches[A])>30)&&(this.aborted=!0)}}touchend(o,d,m){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class Xv{constructor(o){this.singleTap=new o2(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,d,m){this.singleTap.touchstart(o,d,m)}touchmove(o,d,m){this.singleTap.touchmove(o,d,m)}touchend(o,d,m){const S=this.singleTap.touchend(o,d,m);if(S){const A=o.timeStamp-this.lastTime<500,k=!this.lastTap||this.lastTap.dist(S)<30;if(A&&k||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class xg{constructor(){this._zoomIn=new Xv({numTouches:1,numTaps:2}),this._zoomOut=new Xv({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,d,m){this._zoomIn.touchstart(o,d,m),this._zoomOut.touchstart(o,d,m)}touchmove(o,d,m){this._zoomIn.touchmove(o,d,m),this._zoomOut.touchmove(o,d,m)}touchend(o,d,m){const S=this._zoomIn.touchend(o,d,m),A=this._zoomOut.touchend(o,d,m);return S?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:k.getZoom()+1,around:k.unproject(S)},{originalEvent:o})}):A?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:k.getZoom()-1,around:k.unproject(A)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const l2={0:1,2:2},Jx={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class Jv{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,d){return!1}_move(o,d){return{}}mousedown(o,d){if(this._lastPoint)return;const m=we(o);this._correctButton(o,m)&&(this._lastPoint=d,this._eventButton=m)}mousemoveWindow(o,d){const m=this._lastPoint;if(m){if(o.preventDefault(),this._eventButton!=null&&function(S,A){const k=l2[A];return S.buttons===void 0||(S.buttons&k)!==k}(o,this._eventButton))this.reset();else if(this._moved||!(d.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=d,this._move(m,d)}}mouseupWindow(o){this._lastPoint&&we(o)===this._eventButton&&(this._moved&&ne(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yy extends Jv{mousedown(o,d){super.mousedown(o,d),this._lastPoint&&(this._active=!0)}_correctButton(o,d){return d===0&&!o.ctrlKey}_move(o,d){return{around:d,panDelta:d.sub(o)}}}class Qx extends Jv{constructor(o){super(o),this._pitchRotateKey=o.pitchRotateKey?Jx[o.pitchRotateKey]:void 0}_correctButton(o,d){return this._pitchRotateKey?d===0&&o[this._pitchRotateKey]:d===0&&o.ctrlKey||d===2}_move(o,d){const m=.8*(d.x-o.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(o){this._pitchRotateKey||o.preventDefault()}}class e1 extends Jv{constructor(o){super(o),this._pitchRotateKey=o.pitchRotateKey?Jx[o.pitchRotateKey]:void 0}_correctButton(o,d){return this._pitchRotateKey?d===0&&o[this._pitchRotateKey]:d===0&&o.ctrlKey||d===2}_move(o,d){const m=-.5*(d.y-o.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(o){this._pitchRotateKey||o.preventDefault()}}class c2{constructor(o,d){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset(),i.aY(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(o,d,m){return this._calculateTransform(o,d,m)}touchmove(o,d,m){if(this._active&&!(m.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(m.length===1&&!i.eL())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,d,m)}}touchend(o,d,m){this._calculateTransform(o,d,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,d,m){m.length>0&&(this._active=!0);const S=Yv(m,d),A=new i.P(0,0),k=new i.P(0,0);let N=0;for(const V in S){const G=S[V],X=this._touches[V];X&&(A._add(G),k._add(G.sub(X)),N++,S[V]=G)}if(this._touches=S,N<this._minTouches||!k.mag())return;const R=k.div(N);return this._sum._add(R),this._sum.mag()<this._clickTolerance?void 0:{around:A.div(N),panDelta:R}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=D("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Xy{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,d,m){return{}}touchstart(o,d,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([d[0],d[1]]))}touchmove(o,d,m){const S=this._firstTwoTouches;if(!S)return;o.preventDefault();const[A,k]=S,N=Jy(m,d,A),R=Jy(m,d,k);if(!N||!R)return;const V=this._aroundCenter?null:N.add(R).div(2);return this._move([N,R],V,o)}touchend(o,d,m){if(!this._firstTwoTouches)return;const[S,A]=this._firstTwoTouches,k=Jy(m,d,S),N=Jy(m,d,A);k&&N||(this._active&&ne(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Jy(g,o,d){for(let m=0;m<g.length;m++)if(g[m].identifier===d)return o[m]}function t1(g,o){return Math.log2(g/o)}class yT extends Xy{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,d){const m=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(t1(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:t1(this._distance,m),pinchAround:d}}}function u2(g,o){return 180*g.angleWith(o)/Math.PI}class vT extends Xy{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,d){const m=this._vector;if(this._vector=o[0].sub(o[1]),m&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:u2(this._vector,m),pinchAround:d}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const d=25/(Math.PI*this._minDiameter)*360,m=this._startVector;if(!m)return!1;const S=u2(o,m);return Math.abs(S)<d}}function n1(g){return Math.abs(g.y)>Math.abs(g.x)}class _T extends Xy{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,n1(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,d,m){const S=this._lastPoints;if(!S)return;const A=o[0].sub(S[0]),k=o[1].sub(S[1]);return this._map._cooperativeGestures&&!i.eL()&&m.touches.length<3||(this._valid=this.gestureBeginsVertically(A,k,m.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(A.y+k.y)/2*-.5})}gestureBeginsVertically(o,d,m){if(this._valid!==void 0)return this._valid;const S=o.mag()>=2,A=d.mag()>=2;if(!S&&!A)return;if(!S||!A)return this._firstMove==null&&(this._firstMove=m),m-this._firstMove<100&&void 0;const k=o.y>0==d.y>0;return n1(o)&&n1(d)&&k}}const xT={panStep:100,bearingStep:15,pitchStep:10};class bT{constructor(){const o=xT;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let d=0,m=0,S=0,A=0,k=0;switch(o.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:o.shiftKey?m=-1:(o.preventDefault(),A=-1);break;case 39:o.shiftKey?m=1:(o.preventDefault(),A=1);break;case 38:o.shiftKey?S=1:(o.preventDefault(),k=-1);break;case 40:o.shiftKey?S=-1:(o.preventDefault(),k=1);break;default:return}return this._rotationDisabled&&(m=0,S=0),{cameraAnimation:N=>{const R=N.getZoom();N.easeTo({duration:300,easeId:"keyboardHandler",easing:wT,zoom:d?Math.round(R)+d*(o.shiftKey?2:1):R,bearing:N.getBearing()+m*this._bearingStep,pitch:N.getPitch()+S*this._pitchStep,offset:[-A*this._panStep,-k*this._panStep],center:N.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function wT(g){return g*(2-g)}const d2=4.000244140625,ST=1/450;class AT{constructor(o,d){this._map=o,this._el=o.getCanvasContainer(),this._handler=d,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=ST,i.aY(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||i.eL()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let d=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const m=i.o.now(),S=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,d!==0&&d%d2==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=d,this._timeout=window.setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(S*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),o.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=o,this._delta-=d,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=pe(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:d,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;this._type==="wheel"&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const d=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const V=this._type==="wheel"&&Math.abs(this._delta)>d2?this._wheelZoomRate:this._defaultZoomRate;let G=2/(1+Math.exp(-Math.abs(this._delta*V)));this._delta<0&&G!==0&&(G=1/G);const X=d(),W=Math.pow(2,X),te=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):W;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(te*G))),this._type==="wheel"&&(this._startZoom=X,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const m=typeof this._targetZoom=="number"?this._targetZoom:d(),S=this._startZoom,A=this._easing;let k,N=!1;if(this._type==="wheel"&&S&&A){const V=Math.min((i.o.now()-this._lastWheelEventTime)/200,1),G=A(V);k=i.ak(S,m,G),V<1?this._frameId||(this._frameId=!0):N=!0}else k=m,N=!0;this._active=!0,N&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let R=k-d();return R*this._lastDelta<0&&(R=0),{noInertia:!0,needsRenderFrame:!N,zoomDelta:R,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let d=i.eM;if(this._prevEase){const m=this._prevEase,S=(i.o.now()-m.start)/m.duration,A=m.easing(S+.01)-m.easing(S),k=.27/Math.sqrt(A*A+1e-4)*.01,N=Math.sqrt(.0729-k*k);d=i.eK(k,N,.25,1)}return this._prevEase={start:i.o.now(),duration:o,easing:d},d}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=D("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class TT{constructor(o,d){this._clickZoom=o,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class CT{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,d){return o.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(o.shiftKey?-1:1),around:m.unproject(d)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class bN{constructor(){this._tap=new Xv({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,d,m){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=d[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(o,d,m))}touchmove(o,d,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const S=d[0],A=S.y-this._swipePoint.y;return this._swipePoint=S,o.preventDefault(),this._active=!0,{zoomDelta:A/128}}}else this._tap.touchmove(o,d,m)}touchend(o,d,m){this._tapTime?this._swipePoint&&m.length===0&&this.reset():this._tap.touchend(o,d,m)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wN{constructor(o,d,m){this._el=o,this._mousePan=d,this._touchPan=m}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class SN{constructor(o,d,m){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=d,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Qs{constructor(o,d,m,S){this._el=o,this._touchZoom=d,this._touchRotate=m,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Qv=g=>g.zoom||g.drag||g.pitch||g.rotate;class AN extends i.z{}class TN{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,d){const m=i.av([],d,o);this.radius=i.ag(m[2]<0?i.eO([],m,this.constants):[m[0],m[1],0])}projectRay(o){i.eO(o,o,this.constants),i.aw(o,o),i.eP(o,o,this.constants);const d=i.c4([],o,this.radius);if(d[2]>0){const m=i.c4([],[0,0,1],i.bJ(d,[0,0,1])),S=i.c4([],i.aw([],[d[0],d[1],0]),this.radius),A=i.d7([],d,i.c4([],i.av([],i.d7([],S,m),d),2));d[0]=A[0],d[1]=A[1]}return d}}function r1(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class e_{constructor(o,d){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new i2(o),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new TN,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(d),i.aY(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[S,A,k]of this._listeners){const N=S===document?this.handleWindowEvent:this.handleEvent;S.addEventListener(A,N,k)}}destroy(){for(const[o,d,m]of this._listeners){const S=o===document?this.handleWindowEvent:this.handleEvent;o.removeEventListener(d,S,m)}}_addDefaultHandlers(o){const d=this._map,m=d.getCanvasContainer();this._add("mapEvent",new s2(d,o));const S=d.boxZoom=new vo(d,o);this._add("boxZoom",S);const A=new xg,k=new CT;d.doubleClickZoom=new TT(k,A),this._add("tapZoom",A),this._add("clickZoom",k);const N=new bN;this._add("tapDragZoom",N);const R=d.touchPitch=new _T(d);this._add("touchPitch",R);const V=new Qx(o),G=new e1(o);d.dragRotate=new SN(o,V,G),this._add("mouseRotate",V,["mousePitch"]),this._add("mousePitch",G,["mouseRotate"]);const X=new Yy(o),W=new c2(d,o);d.dragPan=new wN(m,X,W),this._add("mousePan",X),this._add("touchPan",W,["touchZoom","touchRotate"]);const te=new vT,ie=new yT;d.touchZoomRotate=new Qs(m,ie,te,N),this._add("touchRotate",te,["touchPan","touchZoom"]),this._add("touchZoom",ie,["touchPan","touchRotate"]),this._add("blockableMapEvent",new a2(d));const se=d.scrollZoom=new AT(d,this);this._add("scrollZoom",se,["mousePan"]);const ve=d.keyboard=new bT;this._add("keyboard",ve);for(const ue of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[ue]&&d[ue].enable(o[ue])}_add(o,d,m){this._handlers.push({handlerName:o,handler:d,allowed:m}),this._handlersById[o]=d}stop(o){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Qv(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(o,d,m){for(const S in o)if(S!==m&&(!d||d.indexOf(S)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const d=[];for(const m of o)this._el.contains(m.target)&&d.push(m);return d}handleEvent(o,d){this._updatingCamera=!0;const m=o.type==="renderFrame",S=m?void 0:o,A={needsRenderFrame:!1},k={},N={},R=o.touches?this._getMapTouches(o.touches):void 0,V=R?he(this._el,R):m?void 0:pe(this._el,o);for(const{handlerName:W,handler:te,allowed:ie}of this._handlers){if(!te.isEnabled())continue;let se;this._blockedByActive(N,ie,W)?te.reset():te[d||o.type]&&(se=te[d||o.type](o,V,R),this.mergeHandlerResult(A,k,se,W,S),se&&se.needsRenderFrame&&this._triggerRenderFrame()),(se||te.isActive())&&(N[W]=te)}const G={};for(const W in this._previousActiveHandlers)N[W]||(G[W]=S);this._previousActiveHandlers=N,(Object.keys(G).length||r1(A))&&(this._changes.push([A,k,G]),this._triggerRenderFrame()),(Object.keys(N).length||r1(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:X}=A;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))}mergeHandlerResult(o,d,m,S,A){if(!m)return;Object.assign(o,m);const k={handlerName:S,originalEvent:m.originalEvent||A};m.zoomDelta!==void 0&&(d.zoom=k),m.panDelta!==void 0&&(d.drag=k),m.pitchDelta!==void 0&&(d.pitch=k),m.bearingDelta!==void 0&&(d.rotate=k)}_applyChanges(){const o={},d={},m={};for(const[S,A,k]of this._changes)S.panDelta&&(o.panDelta=(o.panDelta||new i.P(0,0))._add(S.panDelta)),S.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(o.around=S.around),S.aroundCoord!==void 0&&(o.aroundCoord=S.aroundCoord),S.pinchAround!==void 0&&(o.pinchAround=S.pinchAround),S.noInertia&&(o.noInertia=S.noInertia),Object.assign(d,A),Object.assign(m,k);this._updateMapTransform(o,d,m),this._changes=[]}_updateMapTransform(o,d,m){const S=this._map,A=S.transform,k=be=>[be.x,be.y,be.z];if((be=>{const Te=this._eventsInProgress.drag;return Te&&!this._handlersById[Te.handlerName].isActive()})()&&!r1(o)){const be=A.zoom;A.cameraElevationReference="sea",this._originalZoom!=null&&A._orthographicProjectionAtLowPitch&&A.projection.name!=="globe"&&A.pitch===0?(A.cameraElevationReference="ground",A.zoom=this._originalZoom):(A.recenterOnTerrain(),A.cameraElevationReference="ground"),be!==A.zoom&&this._map._update(!0)}if(A._isCameraConstrained&&S._stop(!0),!r1(o))return void this._fireEvents(d,m,!0);let{panDelta:N,zoomDelta:R,bearingDelta:V,pitchDelta:G,around:X,aroundCoord:W,pinchAround:te}=o;A._isCameraConstrained&&(R>0&&(R=0),A._isCameraConstrained=!1),te!==void 0&&(X=te),(R||(be=>d[be]&&!this._eventsInProgress[be])("drag"))&&X&&(this._dragOrigin=k(A.pointCoordinate3D(X)),this._originalZoom=A.zoom,this._trackingEllipsoid.setup(A._camera.position,this._dragOrigin)),A.cameraElevationReference="sea",S._stop(!0),X=X||S.transform.centerPoint,V&&(A.bearing+=V),G&&(A.pitch+=G),A._updateCameraState();const ie=[0,0,0];if(N)if(A.projection.name==="mercator"){const be=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(X).dir),Te=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(X.sub(N)).dir);ie[0]=Te[0]-be[0],ie[1]=Te[1]-be[1]}else{const be=A.pointCoordinate(X);if(A.projection.name==="globe"){N=N.rotate(-A.angle);const Te=A._pixelsPerMercatorPixel/A.worldSize;ie[0]=-N.x*i.eN(i.a$(be.y))*Te,ie[1]=-N.y*i.eN(A.center.lat)*Te}else{const Te=A.pointCoordinate(X.sub(N));be&&Te&&(ie[0]=Te.x-be.x,ie[1]=Te.y-be.y)}}const se=A.zoom,ve=[0,0,0];if(R){const be=k(W||A.pointCoordinate3D(X)),Te={dir:i.aw([],i.av([],be,A._camera.position))};if(Te.dir[2]<0){const ke=A.zoomDeltaToMovement(be,R);i.c4(ve,Te.dir,ke)}}const ue=i.d7(ie,ie,ve);A._translateCameraConstrained(ue),R&&Math.abs(A.zoom-se)>1e-4&&A.recenterOnTerrain(),A.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(d,m,!0)}_fireEvents(o,d,m){const S=Qv(this._eventsInProgress),A=Qv(o),k={};for(const G in o){const{originalEvent:X}=o[G];this._eventsInProgress[G]||(k[`${G}start`]=X),this._eventsInProgress[G]=o[G]}!S&&A&&this._fireEvent("movestart",A.originalEvent);for(const G in k)this._fireEvent(G,k[G]);A&&this._fireEvent("move",A.originalEvent);for(const G in o){const{originalEvent:X}=o[G];this._fireEvent(G,X)}const N={};let R;for(const G in this._eventsInProgress){const{handlerName:X,originalEvent:W}=this._eventsInProgress[G];this._handlersById[X].isActive()||(delete this._eventsInProgress[G],R=d[X]||W,N[`${G}end`]=R)}for(const G in N)this._fireEvent(G,N[G]);const V=Qv(this._eventsInProgress);if(m&&(S||A)&&!V){this._updatingCamera=!0;const G=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=W=>W!==0&&-this._bearingSnap<W&&W<this._bearingSnap;G?(X(G.bearing||this._map.getBearing())&&(G.bearing=0),this._map.easeTo(G,{originalEvent:R})):(this._map.fire(new i.z("moveend",{originalEvent:R})),X(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,d){this._map.fire(new i.z(o,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{this._frameId=void 0,this.handleEvent(new AN("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const h2="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class f2 extends i.E{constructor(o,d){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=d.bearingSnap,this._respectPrefersReducedMotion=d.respectPrefersReducedMotion!==!1,i.aY(["_renderFrameCallback"],this)}getCenter(){return new i.aR(this.transform.center.lng,this.transform.center.lat)}setCenter(o,d){return this.jumpTo({center:o},d)}panBy(o,d,m){return o=i.P.convert(o).mult(-1),this.panTo(this.transform.center,Object.assign({offset:o},d),m)}panTo(o,d,m){return this.easeTo(Object.assign({center:o},d),m)}getZoom(){return this.transform.zoom}setZoom(o,d){return this.jumpTo({zoom:o},d),this}zoomTo(o,d,m){return this.easeTo(Object.assign({zoom:o},d),m)}zoomIn(o,d){return this.zoomTo(this.getZoom()+1,o,d),this}zoomOut(o,d){return this.zoomTo(this.getZoom()-1,o,d),this}getBearing(){return this.transform.bearing}setBearing(o,d){return this.jumpTo({bearing:o},d),this}getPadding(){return this.transform.padding}setPadding(o,d){return this.jumpTo({padding:o},d),this}rotateTo(o,d,m){return this.easeTo(Object.assign({bearing:o},d),m)}resetNorth(o,d){return this.rotateTo(0,Object.assign({duration:1e3},o),d),this}resetNorthPitch(o,d){return this.easeTo(Object.assign({bearing:0,pitch:0,duration:1e3},o),d),this}snapToNorth(o,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,d):this}getPitch(){return this.transform.pitch}setPitch(o,d){return this.jumpTo({pitch:o},d),this}cameraForBounds(o,d){o=i.aI.convert(o);const m=d&&d.bearing||0,S=d&&d.pitch||0,A=o.getNorthWest(),k=o.getSouthEast();return this._cameraForBounds(this.transform,A,k,m,S,d)}_extendPadding(o){const d={top:0,right:0,bottom:0,left:0};return o==null?Object.assign({},d,this.transform.padding):typeof o=="number"?{top:o,bottom:o,right:o,left:o}:Object.assign({},d,o)}_extendCameraOptions(o){return(o=Object.assign({offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=this._extendPadding(o.padding),o}_minimumAABBFrustumDistance(o,d){const m=d.max[0]-d.min[0],S=d.max[1]-d.min[1];return m/S>o.aspect?m/(2*Math.tan(.5*o.fovX)*o.aspect):S/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,d,m,S,A,k){const N=o.clone(),R=this._extendCameraOptions(k);N.bearing=S,N.pitch=A;const V=i.aR.convert(d),G=i.aR.convert(m),X=.5*(V.lat+G.lat),W=.5*(V.lng+G.lng),te=i.eQ(X,W),ie=i.aw([],te),se=i.aw([],i.bI([],ie,[0,1,0])),ve=i.bI([],se,ie),ue=[se[0],se[1],se[2],0,ve[0],ve[1],ve[2],0,ie[0],ie[1],ie[2],0,0,0,0,1],be=[te,i.eQ(V.lat,V.lng),i.eQ(G.lat,V.lng),i.eQ(G.lat,G.lng),i.eQ(V.lat,G.lng),i.eQ(X,V.lng),i.eQ(X,G.lng),i.eQ(V.lat,W),i.eQ(G.lat,W)];let Te=i.d8.fromPoints(be.map(Nt=>[i.bJ(se,Nt),i.bJ(ve,Nt),i.bJ(ie,Nt)]));const ke=i.af([],Te.center,ue);i.eR(ke)===0&&i.eS(ke,0,0,1),i.aw(ke,ke),i.c4(ke,ke,i.aD),N.center=i.eT(ke);const Ue=N.getWorldToCameraMatrix(),Fe=i.bl(new Float64Array(16),Ue);Te=i.d8.applyTransform(Te,i.aB([],Ue,ue));const Ve=this._extendAABB(Te,N,R,S);if(!Ve)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Te=Ve,i.af(ke,ke,Ue);const ze=.5*(Te.max[2]-Te.min[2]),Oe=this._minimumAABBFrustumDistance(N,Te),Ge=i.c4([],[0,0,1],ze),Tt=i.d7(Ge,ke,Ge),ut=Oe+(N.pitch===0?0:i.bG(ke,Tt)),jt=N.globeCenterInViewSpace,bt=i.av([],ke,[jt[0],jt[1],jt[2]]);i.aw(bt,bt),i.c4(bt,bt,ut);const Dt=i.d7([],ke,bt);i.af(Dt,Dt,Fe);const gn=i.eD/i.aD,St=i.ag(Dt),it=i.ce(Math.max(St*gn-i.eD,Number.EPSILON),0),Ut=Math.min(N.zoomFromMercatorZAdjusted(it),R.maxZoom);return Ut>.5*(i.cZ+i.cK)?(N.setProjection({name:"mercator"}),N.zoom=Ut,this._cameraForBounds(N,d,m,S,A,k)):{center:N.center,zoom:Ut,bearing:S,pitch:A}}_extendAABB(o,d,m,S){const A=.5*((m.padding.left||0)+(m.padding.right||0)),k=.5*((m.padding.top||0)+(m.padding.bottom||0)),N=k,R=A,V=A,G=k,X=d.width-(R+V),W=d.height-(N+G),te=i.av([],o.max,o.min),ie=Math.min(X/te[0],W/te[1]),se=Math.min(d.scaleZoom(d.scale*ie),m.maxZoom);if(isNaN(se))return null;const ve=d.scale/d.zoomScale(se),ue=new i.d8([o.min[0]-R*ve,o.min[1]-G*ve,o.min[2]],[o.max[0]+V*ve,o.max[1]+N*ve,o.max[2]]),be=(typeof m.offset.x=="number"&&typeof m.offset.y=="number"?new i.P(m.offset.x,m.offset.y):i.P.convert(m.offset)).rotate(-i.an(S));return ue.center[0]-=be.x*ve,ue.center[1]+=be.y*ve,ue}queryTerrainElevation(o,d){const m=this.transform.elevation;return m?(d=Object.assign({},{exaggerated:!0},d),m.getAtPoint(i.ae.fromLngLat(o),null,d.exaggerated)):null}_cameraForBounds(o,d,m,S,A,k){if(o.projection.name==="globe")return this._cameraForBoundsOnGlobe(o,d,m,S,A,k);const N=o.clone(),R=this._extendCameraOptions(k);N.bearing=S,N.pitch=A;const V=i.aR.convert(d),G=i.aR.convert(m),X=new i.aR(V.lng,G.lat),W=new i.aR(G.lng,V.lat),te=N.project(V),ie=N.project(G),se=this.queryTerrainElevation(V),ve=this.queryTerrainElevation(G),ue=this.queryTerrainElevation(X),be=this.queryTerrainElevation(W),Te=[[te.x,te.y,Math.min(se||0,ve||0,ue||0,be||0)],[ie.x,ie.y,Math.max(se||0,ve||0,ue||0,be||0)]];let ke=i.d8.fromPoints(Te);const Ue=N.getWorldToCameraMatrix(),Fe=i.bl(new Float64Array(16),Ue);ke=i.d8.applyTransform(ke,Ue);const Ve=this._extendAABB(ke,N,R,S);if(!Ve)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");ke=Ve;const ze=.5*i.av([],ke.max,ke.min)[2],Oe=this._minimumAABBFrustumDistance(N,ke),Ge=[0,0,1,0];i.aC(Ge,Ge,Ue),i.eU(Ge,Ge);const Tt=i.c4([],Ge,Oe+ze),ut=i.d7([],ke.center,Tt);i.af(ke.center,ke.center,Fe),i.af(ut,ut,Fe);const jt=N.unproject(new i.P(ke.center[0],ke.center[1])),bt=i.eV(N.projection,jt),Dt=Math.pow(2,bt),gn=Math.min(N._zoomFromMercatorZ(ut[2]*N.pixelsPerMeter*Dt/N.worldSize),R.maxZoom);return N.mercatorFromTransition&&gn<.5*(i.cZ+i.cK)?(N.setProjection({name:"globe"}),N.zoom=gn,this._cameraForBounds(N,d,m,S,A,k)):{center:jt,zoom:gn,bearing:S,pitch:A}}fitBounds(o,d,m){const S=this.cameraForBounds(o,d);return this._fitInternal(S,d,m)}fitScreenCoordinates(o,d,m,S,A){const k=i.P.convert(o),N=i.P.convert(d),R=new i.P(Math.min(k.x,N.x),Math.min(k.y,N.y)),V=new i.P(Math.max(k.x,N.x),Math.max(k.y,N.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(k,N))return this;const G=this.transform.pointLocation3D(R),X=this.transform.pointLocation3D(V),W=this.transform.pointLocation3D(new i.P(R.x,V.y)),te=this.transform.pointLocation3D(new i.P(V.x,R.y)),ie=[Math.min(G.lng,X.lng,W.lng,te.lng),Math.min(G.lat,X.lat,W.lat,te.lat)],se=[Math.max(G.lng,X.lng,W.lng,te.lng),Math.max(G.lat,X.lat,W.lat,te.lat)],ve=S&&S.pitch?S.pitch:this.getPitch(),ue=this._cameraForBounds(this.transform,ie,se,m,ve,S);return this._fitInternal(ue,S,A)}_fitInternal(o,d,m){return o?(d=Object.assign(o,d)).linear?this.easeTo(d,m):this.flyTo(d,m):this}jumpTo(o,d){this.stop();const m=o.preloadOnly?this.transform.clone():this.transform;let S=!1,A=!1,k=!1;"zoom"in o&&m.zoom!==+o.zoom&&(S=!0,m.zoom=+o.zoom),o.center!==void 0&&(m.center=i.aR.convert(o.center)),"bearing"in o&&m.bearing!==+o.bearing&&(A=!0,m.bearing=+o.bearing),"pitch"in o&&m.pitch!==+o.pitch&&(k=!0,m.pitch=+o.pitch);const N=typeof o.padding=="number"?this._extendPadding(o.padding):o.padding;if(o.padding!=null&&!m.isPaddingEqual(N))if(o.retainPadding===!1){const R=m.clone();R.padding=N,m.setLocationAtPoint(m.center,R.centerPoint)}else m.padding=N;return o.preloadOnly?(this._preloadTiles(m),this):(this.fire(new i.z("movestart",d)).fire(new i.z("move",d)),S&&this.fire(new i.z("zoomstart",d)).fire(new i.z("zoom",d)).fire(new i.z("zoomend",d)),A&&this.fire(new i.z("rotatestart",d)).fire(new i.z("rotate",d)).fire(new i.z("rotateend",d)),k&&this.fire(new i.z("pitchstart",d)).fire(new i.z("pitch",d)).fire(new i.z("pitchend",d)),this.fire(new i.z("moveend",d)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(h2),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,d){const m=this.transform;if(!m.projection.supportsFreeCamera)return i.w(h2),this;this.stop();const S=m.zoom,A=m.pitch,k=m.bearing;m.setFreeCameraOptions(o);const N=S!==m.zoom,R=A!==m.pitch,V=k!==m.bearing;return this.fire(new i.z("movestart",d)).fire(new i.z("move",d)),N&&this.fire(new i.z("zoomstart",d)).fire(new i.z("zoom",d)).fire(new i.z("zoomend",d)),V&&this.fire(new i.z("rotatestart",d)).fire(new i.z("rotate",d)).fire(new i.z("rotateend",d)),R&&this.fire(new i.z("pitchstart",d)).fire(new i.z("pitch",d)).fire(new i.z("pitchend",d)),this.fire(new i.z("moveend",d)),this}easeTo(o,d){this._stop(!1,o.easeId),((o=Object.assign({offset:[0,0],duration:500,easing:i.eM},o)).animate===!1||this._prefersReducedMotion(o))&&(o.duration=0);const m=this.transform,S=this.getZoom(),A=this.getBearing(),k=this.getPitch(),N=this.getPadding(),R="zoom"in o?+o.zoom:S,V="bearing"in o?this._normalizeBearing(o.bearing,A):A,G="pitch"in o?+o.pitch:k,X=this._extendPadding(o.padding),W=i.P.convert(o.offset);let te,ie,se;if(m.projection.name==="globe"){const Ge=i.ae.fromLngLat(m.center),Tt=W.rotate(-m.angle);Ge.x+=Tt.x/m.worldSize,Ge.y+=Tt.y/m.worldSize;const ut=Ge.toLngLat(),jt=i.aR.convert(o.center||ut);this._normalizeCenter(jt),te=m.centerPoint.add(Tt),ie=new i.P(Ge.x,Ge.y).mult(m.worldSize),se=new i.P(i.aF(jt.lng),i.aJ(jt.lat)).mult(m.worldSize).sub(ie)}else{te=m.centerPoint.add(W);const Ge=m.pointLocation(te),Tt=i.aR.convert(o.center||Ge);this._normalizeCenter(Tt),ie=m.project(Ge),se=m.project(Tt).sub(ie)}const ve=m.zoomScale(R-S);let ue,be;o.around&&(ue=i.aR.convert(o.around),be=m.locationPoint(ue));const Te=this._zooming||R!==S,ke=this._rotating||A!==V,Ue=this._pitching||G!==k,Fe=!m.isPaddingEqual(X),Ve=o.retainPadding===!1?m.clone():m,ze=Ge=>Tt=>{if(Te&&(Ge.zoom=i.ak(S,R,Tt)),ke&&(Ge.bearing=i.ak(A,V,Tt)),Ue&&(Ge.pitch=i.ak(k,G,Tt)),Fe&&(Ve.interpolatePadding(N,X,Tt),te=Ve.centerPoint.add(W)),ue)Ge.setLocationAtPoint(ue,be);else{const ut=Ge.zoomScale(Ge.zoom-S),jt=R>S?Math.min(2,ve):Math.max(.5,ve),bt=Math.pow(jt,1-Tt),Dt=Ge.unproject(ie.add(se.mult(Tt*bt)).mult(ut));Ge.setLocationAtPoint(Ge.renderWorldCopies?Dt.wrap():Dt,te)}return o.preloadOnly||this._fireMoveEvents(d),Ge};if(o.preloadOnly){const Ge=this._emulate(ze,o.duration,m);return this._preloadTiles(Ge),this}const Oe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Te,this._rotating=ke,this._pitching=Ue,this._padding=Fe,this._easeId=o.easeId,this._prepareEase(d,o.noMoveStart,Oe),this._ease(ze(m),Ge=>{m.cameraElevationReference==="sea"&&m.recenterOnTerrain(),this._afterEase(d,Ge)},o),this}_prepareEase(o,d,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),d||m.moving||this.fire(new i.z("movestart",o)),this._zooming&&!m.zooming&&this.fire(new i.z("zoomstart",o)),this._rotating&&!m.rotating&&this.fire(new i.z("rotatestart",o)),this._pitching&&!m.pitching&&this.fire(new i.z("pitchstart",o))}_fireMoveEvents(o){this.fire(new i.z("move",o)),this._zooming&&this.fire(new i.z("zoom",o)),this._rotating&&this.fire(new i.z("rotate",o)),this._pitching&&this.fire(new i.z("pitch",o))}_afterEase(o,d){if(this._easeId&&d&&this._easeId===d)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const m=this._zooming,S=this._rotating,A=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new i.z("zoomend",o)),S&&this.fire(new i.z("rotateend",o)),A&&this.fire(new i.z("pitchend",o)),this.fire(new i.z("moveend",o))}flyTo(o,d){if(this._prefersReducedMotion(o)){const Nt=i.aH(o,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(Nt,d)}this.stop(),o=Object.assign({offset:[0,0],speed:1.2,curve:1.42,easing:i.eM},o);const m=this.transform,S=this.getZoom(),A=this.getBearing(),k=this.getPitch(),N=this.getPadding(),R="zoom"in o?i.aA(+o.zoom,m.minZoom,m.maxZoom):S,V="bearing"in o?this._normalizeBearing(o.bearing,A):A,G="pitch"in o?+o.pitch:k,X=this._extendPadding(o.padding),W=m.zoomScale(R-S),te=i.P.convert(o.offset);let ie=m.centerPoint.add(te);const se=m.pointLocation(ie),ve=i.aR.convert(o.center||se);this._normalizeCenter(ve);const ue=m.project(se),be=m.project(ve).sub(ue);let Te=o.curve;const ke=Math.max(m.width,m.height),Ue=ke/W,Fe=be.mag();if("minZoom"in o){const Nt=i.aA(Math.min(o.minZoom,S,R),m.minZoom,m.maxZoom),Qt=ke/m.zoomScale(Nt-S);Te=Math.sqrt(Qt/Fe*2)}const Ve=Te*Te;function ze(Nt){const Qt=(Ue*Ue-ke*ke+(Nt?-1:1)*Ve*Ve*Fe*Fe)/(2*(Nt?Ue:ke)*Ve*Fe);return Math.log(Math.sqrt(Qt*Qt+1)-Qt)}function Oe(Nt){return(Math.exp(Nt)-Math.exp(-Nt))/2}function Ge(Nt){return(Math.exp(Nt)+Math.exp(-Nt))/2}const Tt=ze(0);let ut=function(Nt){return Ge(Tt)/Ge(Tt+Te*Nt)},jt=function(Nt){return ke*((Ge(Tt)*(Oe(Qt=Tt+Te*Nt)/Ge(Qt))-Oe(Tt))/Ve)/Fe;var Qt},bt=(ze(1)-Tt)/Te;if(Math.abs(Fe)<1e-6||!isFinite(bt)){if(Math.abs(ke-Ue)<1e-6)return this.easeTo(o,d);const Nt=Ue<ke?-1:1;bt=Math.abs(Math.log(Ue/ke))/Te,jt=function(){return 0},ut=function(Qt){return Math.exp(Nt*Te*Qt)}}o.duration="duration"in o?+o.duration:1e3*bt/("screenSpeed"in o?+o.screenSpeed/Te:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const Dt=A!==V,gn=G!==k,St=!m.isPaddingEqual(X),it=o.retainPadding===!1?m.clone():m,Ut=Nt=>Qt=>{const mn=Qt*bt,Nn=1/ut(mn);Nt.zoom=Qt===1?R:S+Nt.scaleZoom(Nn),Dt&&(Nt.bearing=i.ak(A,V,Qt)),gn&&(Nt.pitch=i.ak(k,G,Qt)),St&&(it.interpolatePadding(N,X,Qt),ie=it.centerPoint.add(te));const dn=Qt===1?ve:Nt.unproject(ue.add(be.mult(jt(mn))).mult(Nn));return Nt.setLocationAtPoint(Nt.renderWorldCopies?dn.wrap():dn,ie),Nt._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(d),Nt};if(o.preloadOnly){const Nt=this._emulate(Ut,o.duration,m);return this._preloadTiles(Nt),this}return this._zooming=!0,this._rotating=Dt,this._pitching=gn,this._padding=St,this._prepareEase(d,!1),this._ease(Ut(m),()=>this._afterEase(d),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(o){}_cancelRenderFrame(o){}_stop(o,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const m=this._onEaseEnd;this._onEaseEnd=void 0,m.call(this,d)}if(!o){const m=this.handlers;m&&m.stop(!1)}return this}_ease(o,d,m){m.animate===!1||m.duration===0?(o(1),d()):(this._easeStart=i.o.now(),this._easeOptions=m,this._onEaseFrame=o,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((i.o.now()-this._easeStart)/this._easeOptions.duration,1),d=this._onEaseFrame;d&&d(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,d){o=i.bT(o,-180,180);const m=Math.abs(o-d);return Math.abs(o-360-d)<m&&(o-=360),Math.abs(o+360-d)<m&&(o+=360),o}_normalizeCenter(o){const d=this.transform;if(d.maxBounds||d.projection.name!=="globe"&&!d.renderWorldCopies)return;const m=o.lng-d.center.lng;o.lng+=m>180?-360:m<-180?360:0}_prefersReducedMotion(o){return this._respectPrefersReducedMotion&&i.o.prefersReducedMotion&&!(o&&o.essential)}_emulate(o,d,m){const S=Math.ceil(15*d/1e3),A=[],k=o(m.clone());for(let N=0;N<=S;N++){const R=k(N/S);A.push(R.clone())}return A}_preloadTiles(o,d){}}class t_{constructor(o={}){this.options=o,i.aY(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const d=this.options&&this.options.compact,m=o._getUIString("AttributionControl.ToggleAttribution");this._map=o,this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=D("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",m);const S=D("span","mapboxgl-ctrl-icon",this._compactButton);return S.setAttribute("aria-hidden","true"),S.setAttribute("title",m),this._innerContainer=D("div","mapboxgl-ctrl-attrib-inner",this._container),d&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),d===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const d=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(o){const m=d.reduce((S,A,k)=>(A.value&&(S+=`${A.key}=${A.value}${k<d.length-1?"&":""}`),S),"?");o.href=`${i.e.FEEDBACK_URL}/${m}#${Kx(this._map,!0)}`,o.rel="noopener nofollow"}}_updateData(o){!o||(o.dataType!=="source"||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility")&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}const d=this._map.style._mergedSourceCaches;for(const S in d){const A=d[S];if(A.used){const k=A.getSource();k.attribution&&o.indexOf(k.attribution)<0&&o.push(k.attribution)}}o.sort((S,A)=>S.length-A.length),o=o.filter((S,A)=>{for(let k=A+1;k<o.length;k++)if(o[k].indexOf(S)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const m=o.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,o.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Kh{constructor(){i.aY(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=D("div","mapboxgl-ctrl");const d=D("a","mapboxgl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://www.mapbox.com/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const d in o){const m=o[d].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const d=o[0];this._map.getCanvasContainer().offsetWidth<250?d.classList.add("mapboxgl-compact"):d.classList.remove("mapboxgl-compact")}}}class n_{constructor(){i.aY(["_onIndoorUpdate"],this)}onAdd(o){return this._map=o,this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._map.indoor.on("indoorupdate",d=>this._onIndoorUpdate({selectedFloorId:d.selectedFloorId,floors:d.floors})),this._container}_createButton(o,d){const m=D("button",o,this._container);return m.type="button",m.addEventListener("click",d),m}_createSeparator(){return D("div","mapboxgl-ctrl-separator",this._container)}_setButtonTitle(o,d){this._map&&(o.setAttribute("aria-label",d),o.textContent=d)}onRemove(){this._container&&this._container.remove(),this._map&&this._map.indoor&&(this._map.indoor.off("indoorupdate",this._onIndoorUpdate),this._map=null)}getDefaultPosition(){return"right"}_onIndoorUpdate(o){if(!o||!o.floors)return void(this._container.style.display="none");const d=this._model;this._model=o,this._container.style.display="inline-block",this._container.style.borderRadius="8px";const m=o.floors.sort((S,A)=>A.levelOrder-S.levelOrder);d?(Array.from(this._container.children).forEach(S=>S.remove()),this.addCurrentFloors(m)):this.addCurrentFloors(m)}addCurrentFloors(o){for(let d=0;d<o.length;d++){const m=o[d],S=this._createButton("mapboxgl-ctrl-level-button",()=>{this._map._selectIndoorFloor(m.id),this._model&&(this._model.selectedFloorId=m.id),Array.from(this._container.children).forEach(A=>{A.classList.contains("mapboxgl-ctrl-level-button")&&A.classList.remove("mapboxgl-ctrl-level-button-selected")}),S.classList.add("mapboxgl-ctrl-level-button-selected")});this._setButtonTitle(S,m.shortName),this._model&&m.id===this._model.selectedFloorId&&S.classList.add("mapboxgl-ctrl-level-button-selected"),this._container.append(S),d<o.length-1&&this._createSeparator()}}}class Na{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const d=++this._id;return this._queue.push({callback:o,id:d,cancelled:!1}),d}remove(o){const d=this._currentlyRunning,m=d?this._queue.concat(d):this._queue;for(const S of m)if(S.id===o)return void(S.cancelled=!0)}run(o=0){const d=this._currentlyRunning=this._queue;this._queue=[];for(const m of d)if(!m.cancelled&&(m.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Yh{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const d=i.dz((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-d)+this._end*d}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,d,m){this._start=this.getValue(d),this._end=o,this._startTime=d,this._endTime=d+m}}const r_={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class i_ extends i.z{constructor(o,d,m,S){const{point:A,lngLat:k,originalEvent:N,target:R}=o;super(o.type,{point:A,lngLat:k,originalEvent:N,target:R}),this.preventDefault=()=>{o.preventDefault()},this.id=d,this.interaction=m,this.feature=S}}class ET{constructor(o){this.map=o,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(o,d){if(this.typeById.has(o))throw new Error(`Interaction id "${o}" already exists.`);const m=d.filter;let S=d.type;m&&this.filters.set(o,i.b6(m)),S==="mouseover"&&(S="mouseenter"),S==="mouseout"&&(S="mouseleave");const A=this.interactionsByType.get(S)||new Map;S==="mouseenter"||S==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(o,d)):A.size===0&&this.map.on(S,this.handleType),A.size===0&&this.interactionsByType.set(S,A),A.set(o,d),this.typeById.set(o,S)}get(o){const d=this.typeById.get(o);if(!d)return;const m=this.interactionsByType.get(d);return m?m.get(o):void 0}remove(o){const d=this.typeById.get(o);if(!d)return;this.typeById.delete(o),this.filters.delete(o);const m=this.interactionsByType.get(d);m&&(m.delete(o),d==="mouseenter"||d==="mouseleave"?(this.delegatedInteractions.delete(o),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):m.size===0&&this.map.off(d,this.handleType))}queryTargets(o,d){const m=[];for(const[S,A]of d)A.target&&m.push({targetId:S,target:A.target,filter:this.filters.get(S)});return this.map.style.queryRenderedTargets(o,m,this.map.transform)}handleMove(o){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const d=this.queryTargets(o.point,Array.from(this.delegatedInteractions).reverse());d.length&&(o.type="mouseenter",this.handleType(o,d));const m=new Map;for(const[S,{feature:A}]of this.prevHoveredFeatures)this.hoveredFeatures.has(S)||m.set(A.id,A);m.size&&(o.type="mouseleave",this.handleType(o,Array.from(m.values())))}handleOut(o){const d=Array.from(this.hoveredFeatures.values()).map(({feature:m})=>m);d.length&&(o.type="mouseleave",this.handleType(o,d)),this.hoveredFeatures.clear()}handleType(o,d){const m=o.type==="mouseenter";if(m&&!this.interactionsByType.has(o.type))return void i.w("mouseenter interaction required for mouseleave to work.");const S=Array.from(this.interactionsByType.get(o.type)).reverse(),A=!!d;d=d||this.queryTargets(o.point,S);let k=!1;const N=new Set;for(const R of d){for(const[V,G]of S){if(!G.target)continue;const X=R.variants?R.variants[V]:null;if(X){for(const W of X){if(lc(W,R,N,V))continue;const te=new i.dt(R,W),ie=$l(W,R,V);A&&(te.state=this.map.getFeatureState(te));const se=m?this.prevHoveredFeatures.get(ie):null,ve=new i_(o,V,G,te),ue=se?se.stop:G.handler(ve);if(m&&this.hoveredFeatures.set(ie,{feature:R,stop:ue}),ue!==!1){k=!0;break}}if(k)break}}if(k)break}if(!k)for(const[R,V]of S){const{handler:G,target:X}=V;if(!X&&G(new i_(o,R,V,null))!==!1)break}}}function CN(g,o){if(Array.isArray(g)&&Array.isArray(o)){const d=new Set(g),m=new Set(o);return d.size===m.size&&g.every(S=>m.has(S))}return i.by(g,o)}const s_={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},EN={showCompass:!0,showZoom:!0,visualizePitch:!1};class PN{constructor(o,d,m=!1){this._clickTolerance=10,this.element=d,this.mouseRotate=new Qx({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,m&&(this.mousePitch=new e1({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),i.aY(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),d.addEventListener("mousedown",this.mousedown),d.addEventListener("touchstart",this.touchstart,{passive:!1}),d.addEventListener("touchmove",this.touchmove),d.addEventListener("touchend",this.touchend),d.addEventListener("touchcancel",this.reset)}down(o,d){this.mouseRotate.mousedown(o,d),this.mousePitch&&this.mousePitch.mousedown(o,d),J()}move(o,d){const m=this.map,S=this.mouseRotate.mousemoveWindow(o,d),A=S&&S.bearingDelta;if(A&&m.setBearing(m.getBearing()+A),this.mousePitch){const k=this.mousePitch.mousemoveWindow(o,d),N=k&&k.pitchDelta;N&&m.setPitch(m.getPitch()+N)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ee(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(Object.assign({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),pe(this.element,o)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,pe(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=he(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=he(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function i1(g,o,d){if(g=new i.aR(g.lng,g.lat),o){const m=new i.aR(g.lng-360,g.lat),S=new i.aR(g.lng+360,g.lat),A=360*Math.ceil(Math.abs(g.lng-d.center.lng)/360),k=d.locationPoint3D(g).distSqr(o),N=o.x<0||o.y<0||o.x>d.width||o.y>d.height;d.locationPoint3D(m).distSqr(o)<k&&(N||Math.abs(m.lng-d.center.lng)<A)?g=m:d.locationPoint3D(S).distSqr(o)<k&&(N||Math.abs(S.lng-d.center.lng)<A)&&(g=S)}for(;Math.abs(g.lng-d.center.lng)>180;){const m=d.locationPoint3D(g);if(m.x>=0&&m.y>=0&&m.x<=d.width&&m.y<=d.height)break;g.lng>d.center.lng?g.lng-=360:g.lng+=360}return g}const a_={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},Bu={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class bg extends i.E{constructor(o,d){super(),(o instanceof HTMLElement||d)&&(o=Object.assign({element:o},d)),i.aY(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:m="center",color:S="#3FB1CE",scale:A=1,draggable:k=!1,clickTolerance:N=0,rotation:R=Bu.rotation,rotationAlignment:V=Bu.rotationAlignment,pitchAlignment:G=Bu.pitchAlignment,occludedOpacity:X=Bu.occludedOpacity,altitude:W=Bu.altitude}=o||{};this._anchor=m,this._color=S,this._scale=A,this._draggable=k,this._clickTolerance=N,this._rotation=R,this._rotationAlignment=V,this._pitchAlignment=G,this._occludedOpacity=X,this._altitude=W,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),o&&o.element?(this._element=o.element,this._offset=i.P.convert(o&&o.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=i.P.convert(o&&o.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",se=>{se.preventDefault()}),this._element.addEventListener("mousedown",se=>{se.preventDefault()});const te=this._element.classList;for(const se in a_)te.remove(`mapboxgl-marker-anchor-${se}`);te.add(`mapboxgl-marker-anchor-${this._anchor}`);const ie=o&&o.className?o.className.trim().split(/\s+/):[];te.add(...ie),this._popup=null}_createDefaultMarker(){const o=D("div"),d=B("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},o);if(this._altitude===0){const m=B("radialGradient",{id:"shadowGradient"},B("defs",{},d));B("stop",{offset:"10%","stop-opacity":.4},m),B("stop",{offset:"100%","stop-opacity":.05},m),B("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},d)}return B("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},d),B("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},d),B("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},d),o}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=i.aR.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(o){return o===this._altitude||(this._defaultMarker&&(this._altitude===0&&o!==0||this._altitude!==0&&o===0)&&(this._element=this._createDefaultMarker()),this._altitude=o||Bu.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const S=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(38.1-13.5+S)],"bottom-right":[-S,-1*(38.1-13.5+S)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,o._marker=this,o._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const d=o.code,m=o.charCode||o.keyCode;d!=="Space"&&d!=="Enter"&&m!==32&&m!==13||this.togglePopup()}_onMapClick(o){const d=o.originalEvent.target,m=this._element;this._popup&&(d===m||m.contains(d))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map,d=this._pos;if(!o||!d)return!1;const m=o.unproject(d,this._altitude),S=o.getFreeCameraOptions();if(!S.position)return!1;const A=S.position.toLngLat();return A.distanceTo(m)<.9*A.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const d=this._pos;if(!d||d.x<0||d.x>o.transform.width||d.y<0||d.y>o.transform.height)return void this._clearFadeTimer();const m=o.unproject(d,this._altitude);let S;o._showingGlobe()&&i.eY(o.transform,this._lngLat)?S=0:(S=1-o._queryFogOpacity(m),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(S*=this._occludedOpacity)),this._element.style.opacity=`${S}`,this._element.style.pointerEvents=S>0?"auto":"none",this._popup&&this._popup._setOpacity(S),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const d=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${o.x}px,${o.y}px)
            ${a_[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${d.x}px,${d.y}px)
        `}_calculateXYTransform(){const o=this._pos,d=this._map,m=this.getPitchAlignment();if(!d||!o||m!=="map")return"";if(!d._showingGlobe()){const R=d.getPitch();return R?`rotateX(${R}deg)`:""}const S=i.cW(i.eZ(d.transform,this._lngLat)),A=o.sub(i.e_(d.transform)),k=Math.abs(A.x)+Math.abs(A.y);if(k===0)return"";const N=S/k;return`rotateX(${-A.y*N}deg) rotateY(${A.x*N}deg)`}_calculateZTransform(){const o=this._pos,d=this._map;if(!d||!o)return"";let m=0;const S=this.getRotationAlignment();if(S==="map")if(d._showingGlobe()){const A=d.project(new i.aR(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),k=d.project(new i.aR(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(A);m=i.cW(Math.atan2(k.y,k.x))-90}else m=-d.getBearing();else if(S==="horizon"){const A=i.ah(4,6,d.getZoom()),k=i.e_(d.transform);k.y+=A*d.transform.height;const N=o.sub(k),R=i.cW(Math.atan2(N.y,N.x));m=(R>90?R-270:R+90)*(1-A)}return m+=this._rotation,m?`rotateZ(${m}deg)`:""}_update(o){cancelAnimationFrame(this._updateFrameId);const d=this._map;d&&(d.transform.renderWorldCopies&&(this._lngLat=i1(this._lngLat,this._pos,d.transform)),this._pos=d.project(this._lngLat,this._altitude),o===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),d._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(d._showingGlobe()||d.getTerrain()||d.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(o){return this._offset=i.P.convert(o),this._update(),this}addClassName(o){return this._element.classList.add(o),this}removeClassName(o){return this._element.classList.remove(o),this}toggleClassName(o){return this._element.classList.toggle(o)}_onMove(o){const d=this._map;if(!d)return;const m=this._pointerdownPos,S=this._positionDelta;if(m&&S){if(!this._isDragging){const A=this._clickTolerance||d._clickTolerance;if(o.point.dist(m)<A)return;this._isDragging=!0}this._pos=o.point.sub(S),this._lngLat=d.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.z("dragstart"))),this.fire(new i.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.z("dragend")),this._state="inactive"}_addDragHandler(o){const d=this._map,m=this._pos;d&&m&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(m),this._pointerdownPos=o.point,this._state="pending",d.on("mousemove",this._onMove),d.on("touchmove",this._onMove),d.once("mouseup",this._onUp),d.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const d=this._map;return d&&(o?(d.on("mousedown",this._addDragHandler),d.on("touchstart",this._addDragHandler)):(d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||Bu.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||Bu.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||Bu.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||Bu.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const om={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Kf={maxWidth:100,unit:"metric"},Yf={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},wg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},oh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function PT(g=new i.P(0,0),o="bottom"){if(typeof g=="number"){const d=Math.round(Math.sqrt(.5*Math.pow(g,2)));switch(o){case"top":return new i.P(0,g);case"top-left":return new i.P(d,d);case"top-right":return new i.P(-d,d);case"bottom":return new i.P(0,-g);case"bottom-left":return new i.P(d,-d);case"bottom-right":return new i.P(-d,-d);case"left":return new i.P(g,0);case"right":return new i.P(-g,0)}return new i.P(0,0)}return g instanceof i.P||Array.isArray(g)?i.P.convert(g):i.P.convert(g[o]||[0,0])}return{version:y,supported:j.supported,setRTLTextPlugin:i.f2,getRTLTextPluginStatus:i.f1,Map:class extends f2{constructor(g){w.mark(x.create);const o=g;if((g=Object.assign({},s_,g)).minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(g.antialias&&i.eW(window)&&(g.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new po(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies,null,null),g),this._repaint=!!g.repaint,this._interactive=g.interactive,this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=g.crossSourceCollisions,this._collectResourceTiming=g.collectResourceTiming,this._language=this._parseLanguage(g.language),this._worldview=g.worldview,this._renderTaskQueue=new Na,this._domRenderTaskQueue=new Na,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.b2(),this._locale=Object.assign({},r_,g.locale),this._clickTolerance=g.clickTolerance,this._cooperativeGestures=g.cooperativeGestures,this._performanceMetricsCollection=g.performanceMetricsCollection,this._tessellationStep=g.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=g.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Yh(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=g.scaleFactor,this._requestManager=new xe(g.transformRequest,g.accessToken,g.testMode),this._silenceAuthErrors=!!g.testMode,this._contextCreateOptions=g.contextCreateOptions?Object.assign({},g.contextCreateOptions):{},typeof g.container=="string"){const d=document.getElementById(g.container);if(!d)throw new Error(`Container '${g.container.toString()}' not found.`);this._container=d}else{if(!(g.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),g.maxBounds&&this.setMaxBounds(g.maxBounds),this._spriteFormat=g.spriteFormat,i.aY(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new nm),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new e_(this,g),this._localFontFamily=g.localFontFamily,this._localIdeographFontFamily=g.localIdeographFontFamily,(g.style||!g.testMode)&&this.setStyle(g.style||i.e.DEFAULT_STYLE,{config:g.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),g.projection&&this.setProjection(g.projection),this.indoor=new qh(this),g.hash&&(this._hash=new n2(typeof g.hash=="string"&&g.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){o.center==null&&o.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch});const d=g.bounds;d&&(this.resize(),this.fitBounds(d,Object.assign({},g.fitBoundsOptions,{duration:0})))}this.resize(),g.attributionControl&&this.addControl(new t_({customAttribution:g.customAttribution})),this._logoControl=new Kh,this.addControl(this._logoControl,g.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",d=>{this._update(d.dataType==="style"),this.fire(new i.z(`${d.dataType}data`,d))}),this.on("dataloading",d=>{this.fire(new i.z(`${d.dataType}dataloading`,d))}),this._interactions=new ET(this)}_getMapId(){return this._mapId}addControl(g,o){if(o===void 0&&(o=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new i.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=g.onAdd(this);this._controls.push(g);const m=this._controlPositions[o];return o.indexOf("bottom")!==-1?m.insertBefore(d,m.firstChild):m.appendChild(d),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new i.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(g);return o>-1&&this._controls.splice(o,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(g){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new i.z("movestart",g)).fire(new i.z("move",g)),this.fire(new i.z("resize",g)),o&&this.fire(new i.z("moveend",g)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(g){return this.transform.setMaxBounds(i.aI.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g?this.setZoom(g):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g?this.setZoom(g):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g?this.setPitch(g):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g?this.setPitch(g):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(g){return this._scaleFactor=g,this.painter.scaleFactor=g,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(o=>o.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(g){return g==="auto"?navigator.language:Array.isArray(g)?g.length===0?void 0:g.map(o=>o==="auto"?navigator.language:o):g}setLanguage(g){const o=this._parseLanguage(g);if(!this.style||o===this._language)return this;this._language=o,this.style.reloadSources();for(const d of this._controls)d._setLanguage&&d._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(g){return this.style&&g!==this._worldview?(this._worldview=g,this._styleDirty=!0,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(g){return this._lazyInitEmptyStyle(),g?typeof g=="string"&&(g={name:g}):g=null,this._useExplicitProjection=!!g,this._prioritizeAndUpdateProjection(g,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const g=this.transform,o=g.projection.name;let d;o==="globe"&&g.zoom>=i.cK?(g.setMercatorFromTransition(),d=!0):o==="mercator"&&g.zoom<i.cK&&(g.setProjection({name:"globe"}),d=!0),d&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate(),this._update(!0))}_prioritizeAndUpdateProjection(g,o){return this._updateProjection(g||o||{name:"mercator"})}_updateProjection(g){let o;return o=g.name==="globe"&&this.transform.zoom>=i.cK?this.transform.setMercatorFromTransition():this.transform.setProjection(g),this.style.applyProjectionUpdate(),o&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(g,o){return this.transform.locationPoint3D(i.aR.convert(g),o)}unproject(g,o){return this.transform.pointLocation3D(i.P.convert(g),o)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(g,o,d){const m=S=>{let A=[];if(Array.isArray(o)){const k=o.filter(N=>this.getLayer(N));A=k.length?this.queryRenderedFeatures(S,{layers:k}):[]}else A=this.queryRenderedFeatures(S,{target:o});return A};if(g==="mouseenter"||g==="mouseover"){let S=!1;return{listener:d,targets:o,delegates:{mousemove:k=>{const N=m(k.point);N.length?S||(S=!0,d.call(this,new so(g,this,k.originalEvent,{features:N}))):S=!1},mouseout:()=>{S=!1}}}}if(g==="mouseleave"||g==="mouseout"){let S=!1;return{listener:d,targets:o,delegates:{mousemove:N=>{m(N.point).length?S=!0:S&&(S=!1,d.call(this,new so(g,this,N.originalEvent)))},mouseout:N=>{S&&(S=!1,d.call(this,new so(g,this,N.originalEvent)))}}}}{const S=A=>{const k=m(A.point);k.length&&(A.features=k,d.call(this,A),delete A.features)};return{listener:d,targets:o,delegates:{[g]:S}}}}on(g,o,d){if(typeof o=="function"||d===void 0)return super.on(g,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const m=this._createDelegatedListener(g,o,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(m);for(const S in m.delegates)this.on(S,m.delegates[S]);return this}once(g,o,d){if(typeof o=="function"||d===void 0)return super.once(g,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const m=this._createDelegatedListener(g,o,d);for(const S in m.delegates)this.once(S,m.delegates[S]);return this}off(g,o,d){if(typeof o=="function"||d===void 0)return super.off(g,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const m=this._delegatedListeners?this._delegatedListeners[g]:void 0;return m&&(S=>{for(let A=0;A<S.length;A++){const k=S[A];if(k.listener===d&&CN(k.targets,o)){for(const N in k.delegates)this.off(N,k.delegates[N]);return S.splice(A,1),this}}})(m),this}queryRenderedFeatures(g,o){if(!this.style)return[];if(g===void 0||g instanceof i.P||Array.isArray(g)||o!==void 0||(o=g,g=void 0),g=g||[[0,0],[this.transform.width,this.transform.height]],!o){const A=this.style.queryRenderedFeatures(g,void 0,this.transform),k=this.style.queryRenderedFeatureset(g,void 0,this.transform);return A.concat(k)}let d=!0;if(o.target&&(d=this._isTargetValid(o.target),d&&!o.layers))return this.style.queryRenderedFeatureset(g,o,this.transform);let m=!0;if(o.layers&&Array.isArray(o.layers)){for(const A of o.layers)if(!this._isValidId(A)){m=!1;break}if(m&&!o.target)return this.style.queryRenderedFeatures(g,o,this.transform)}let S=[];return m&&(S=S.concat(this.style.queryRenderedFeatures(g,o,this.transform))),d&&(S=S.concat(this.style.queryRenderedFeatureset(g,o,this.transform))),S}querySourceFeatures(g,o){return!g||typeof g=="string"&&!this._isValidId(g)?[]:this.style.querySourceFeatures(g,o)}queryRasterValue(g,o,d){return this._isValidId(g)?this.style.queryRasterValue(g,o,d):Promise.resolve(null)}isPointOnSurface(g){const{name:o}=this.transform.projection;return o!=="globe"&&o!=="mercator"&&i.w(`${o} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(g))}addInteraction(g,o){return this._interactions.add(g,o),this}removeInteraction(g){return this._interactions.remove(g),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(g){return this._cooperativeGestures=g,this}setStyle(g,o){return o=Object.assign({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o),this.style&&g&&o.diff!==!1&&o.localFontFamily===this._localFontFamily&&o.localIdeographFontFamily===this._localIdeographFontFamily&&!o.config?(this.style._diffStyle(g,(d,m)=>{if(d){const S=typeof d=="string"?d:d instanceof Error?d.message:d.error;i.w(`Unable to perform style diff: ${S}. Rebuilding the style from scratch.`),this._updateStyle(g,o)}else m&&this._update(!0)},()=>this._postStyleLoadEvent()),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(g,o))}_getUIString(g){const o=this._locale[g];if(o==null)throw new Error(`Missing UI string '${g}'`);return o}_updateStyle(g,o){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),g){const d=Object.assign({},o);o&&o.config&&(d.initialConfig=o.config,delete d.config),this.style=new ko(this,d).load(g),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ko(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(g){return g==null?(this.fire(new i.y(new Error("IDs can't be empty."))),!1):!i.dm(g)||(this.fire(new i.y(new Error(`IDs can't contain special symbols: "${g}".`))),!1)}_isTargetValid(g){return"featuresetId"in g?this._isValidId("importId"in g?g.importId:g.featuresetId):"layerId"in g&&this._isValidId(g.layerId)}_areTargetsValid(g){if(Array.isArray(g)){for(const o of g)if(!this._isValidId(o))return!1;return!0}return this._isTargetValid(g)}addSource(g,o){return this._isValidId(g)?(this._lazyInitEmptyStyle(),this.style.addSource(g,o),this._update(!0)):this}isSourceLoaded(g){return!!this._isValidId(g)&&!!this.style&&this.style._isSourceCacheLoaded(g)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(g,o,d){this._lazyInitEmptyStyle(),this.style.addSourceType(g,o,d)}removeSource(g){return this._isValidId(g)?(this.style.removeSource(g),this._updateTerrain(),this._update(!0)):this}getSource(g){return this._isValidId(g)?this.style.getOwnSource(g):null}addImage(g,o,{pixelRatio:d=1,sdf:m=!1,stretchX:S,stretchY:A,content:k}={}){this._lazyInitEmptyStyle();const N=i.I.from(g);if(o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap){const{width:R,height:V,data:G}=i.o.getImageData(o);this.style.addImage(N,{data:new i.q({width:R,height:V},G),pixelRatio:d,stretchX:S,stretchY:A,content:k,sdf:m,version:0,usvg:!1})}else if(o.width===void 0||o.height===void 0)this.fire(new i.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:R,height:V}=o,G=o;this.style.addImage(N,{data:new i.q({width:R,height:V},new Uint8Array(G.data)),pixelRatio:d,stretchX:S,stretchY:A,content:k,sdf:m,usvg:!1,version:0,userImage:G}),G.onAdd&&G.onAdd(this,g)}}updateImage(g,o){this._lazyInitEmptyStyle();const d=i.I.from(g),m=this.style.getImage(d);if(!m)return void this.fire(new i.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const S=o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap?i.o.getImageData(o):o,{width:A,height:k,data:N}=S;if(A===void 0||k===void 0)return void this.fire(new i.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(A!==(m.usvg?m.icon.usvg_tree.width:m.data.width)||k!==(m.usvg?m.icon.usvg_tree.height:m.data.height))return void this.fire(new i.y(new Error(`The width and height of the updated image (${A}, ${k})
                must be that same as the previous version of the image
                (${m.data.width}, ${m.data.height})`)));const R=!(o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap);let V=!1;m.usvg?(m.data=new i.q({width:A,height:k},new Uint8Array(N)),m.usvg=!1,m.icon=void 0,V=!0):m.data.replace(N,R),this.style.updateImage(d,m,V)}hasImage(g){return g?!!this.style&&!!this.style.getImage(i.I.from(g)):(this.fire(new i.y(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(i.I.from(g))}loadImage(g,o){i.n(this._requestManager.transformRequest(g,i.R.Image),(d,m)=>{o(d,m instanceof HTMLImageElement?i.o.getImageData(m):m)})}listImages(){return this.style.listImages().map(g=>g.name)}addModel(g,o){this._lazyInitEmptyStyle(),this.style.addModel(g,o)}hasModel(g){return g?this.style.hasModel(g):(this.fire(new i.y(new Error("Missing required model id"))),!1)}removeModel(g){this.style.removeModel(g)}listModels(){return this.style.listModels()}addLayer(g,o){return this._isValidId(g.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(g,o),this._update(!0)):this}getSlot(g){const o=this.getLayer(g);return o&&o.slot||null}setSlot(g,o){return this.style.setSlot(g,o),this.style.mergeLayers(),this._update(!0)}addImport(g,o){return this.style.addImport(g,o).catch(d=>this.fire(new i.y(new Error("Failed to add import",d)))),this}updateImport(g,o){return typeof o!="string"&&o.id!==g?(this.removeImport(g),this.addImport(o)):(this.style.updateImport(g,o),this._update(!0))}removeImport(g){return this.style.removeImport(g),this}moveImport(g,o){return this.style.moveImport(g,o),this._update(!0)}moveLayer(g,o){return this._isValidId(g)?(this.style.moveLayer(g,o),this._update(!0)):this}removeLayer(g){return this._isValidId(g)?(this.style.removeLayer(g),this._update(!0)):this}getLayer(g){if(!this._isValidId(g))return null;const o=this.style.getOwnLayer(g);return o?o.type==="custom"?o.implementation:o.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(g,o,d){return this._isValidId(g)?(this.style.setLayerZoomRange(g,o,d),this._update(!0)):this}setFilter(g,o,d={}){return this._isValidId(g)?(this.style.setFilter(g,o,d),this._update(!0)):this}getFilter(g){return this._isValidId(g)?this.style.getFilter(g):null}setPaintProperty(g,o,d,m={}){return this._isValidId(g)?(this.style.setPaintProperty(g,o,d,m),this._update(!0)):this}getPaintProperty(g,o){return this._isValidId(g)?this.style.getPaintProperty(g,o):null}setLayoutProperty(g,o,d,m={}){return this._isValidId(g)?(this.style.setLayoutProperty(g,o,d,m),this._update(!0)):this}getLayoutProperty(g,o){return this._isValidId(g)?this.style.getLayoutProperty(g,o):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(g){return this.style.setGlyphsUrl(g),this._update(!0)}getSchema(g){return this.style.getSchema(g)}setSchema(g,o){return this.style.setSchema(g,o),this._update(!0)}getConfig(g){return this.style.getConfig(g)}setConfig(g,o){return this.style.setConfig(g,o),this._update(!0)}getConfigProperty(g,o){return this.style.getConfigProperty(g,o)}setConfigProperty(g,o,d){return this.style.setConfigProperty(g,o,d),this._update(!0)}getFeaturesetDescriptors(g){return this.style.getFeaturesetDescriptors(g)}setLights(g){if(this._lazyInitEmptyStyle(),g&&g.length===1&&g[0].type==="flat"){const o=g[0];o.properties?this.style.setFlatLight(o.properties,o.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(g),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const g=this.style.getLights()||[];return g.length===0&&g.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),g}setLight(g,o={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:g}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(g){return this._lazyInitEmptyStyle(),!g&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(g),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(g){return this._lazyInitEmptyStyle(),this.style.setFog(g),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(g){return this._lazyInitEmptyStyle(),this.style.setSnow(g),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(g){return this._lazyInitEmptyStyle(),this.style.setRain(g),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(g){return this._lazyInitEmptyStyle(),this.style.setColorTheme(g),this._update(!0)}setImportColorTheme(g,o){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(g,o),this._update(!0)}setCamera(g){return this.style.setCamera(g),this._triggerCameraUpdate(g)}_triggerCameraUpdate(g){return this._update(this.transform.setOrthographicProjectionAtLowPitch(g["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(g){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.aR.convert(g),this.transform):0}setFeatureState(g,o){return g.source&&!this._isValidId(g.source)?this:(this.style.setFeatureState(g,o),this._update())}removeFeatureState(g,o){return g.source&&!this._isValidId(g.source)?this:(this.style.removeFeatureState(g,o),this._update())}getFeatureState(g){return g.source&&!this._isValidId(g.source)?null:this.style.getFeatureState(g)}_selectIndoorFloor(g){this.indoor.selectFloor(g)}_addIndoorControl(){this._indoorControl||(this._indoorControl=new n_),this.addControl(this._indoorControl,"right")}_removeIndoorControl(){this._indoorControl&&this.removeControl(this._indoorControl)}_updateContainerDimensions(){if(!this._container)return;const g=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let d,m,S,A=this._container;for(;A&&(!m||!S);){const k=window.getComputedStyle(A).transform;k&&k!=="none"&&(d=k.match(/matrix.*\((.+)\)/)[1].split(", "),d[0]&&d[0]!=="0"&&d[0]!=="1"&&(m=d[0]),d[3]&&d[3]!=="0"&&d[3]!=="1"&&(S=d[3])),A=A.parentElement}this._containerWidth=m?Math.abs(g/m):g,this._containerHeight=S?Math.abs(o/S):o}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=D("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=D("div","mapboxgl-canvas-container",g);this._canvas=D("canvas","mapboxgl-canvas",o),this._interactive&&(o.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const d=this._controlContainer=D("div","mapboxgl-control-container",g),m=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(S=>{m[S]=D("div",`mapboxgl-ctrl-${S}`,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,o){const d=i.o.devicePixelRatio||1;this._canvas.width=d*Math.ceil(g),this._canvas.height=d*Math.ceil(o),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${o}px`}_addMarker(g){this._markers.push(g)}_removeMarker(g){const o=this._markers.indexOf(g);o!==-1&&this._markers.splice(o,1)}_addPopup(g){this._popups.push(g)}_removePopup(g){const o=this._popups.indexOf(g);o!==-1&&this._popups.splice(o,1)}_setupPainter(){const g=Object.assign({},j.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl2",g);o?(Ot(o,!0),this.painter=new t2(o,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp,this._worldview),this.on("data",d=>{d.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.k.testSupport(o)):this.fire(new i.y(new Error("Failed to initialize WebGL")))}_contextLost(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.z("webglcontextlost",{originalEvent:g}))}_contextRestored(g){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.clearLayers(),this.style.imageManager.destroyAtlasTextures(),this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new i.z("webglcontextrestored",{originalEvent:g}))}_onMapScroll(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_requestDomTask(g){!this.loaded()||this.loaded()&&!this.isMoving()?g():this._domRenderTaskQueue.add(g)}_render(g){let o;this.fire(new i.z("renderstart")),++this._frameId;const d=this.painter.context.extTimerQuery,m=i.o.now(),S=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(o=S.createQuery(),S.beginQuery(d.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(g),this._domRenderTaskQueue.run(g),this._removed)return;this._updateProjectionTransition();const A=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const V=this.transform.zoom,G=this.transform.pitch,X=i.o.now(),W=new i.ac(V,{now:X,fadeDuration:A,pitch:G,transition:this.style.transition,worldview:this._worldview});this.style.update(W)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let k=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),k=this._updateAverageElevation(m),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):k=this._updateAverageElevation(m);const N=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,A,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),N&&(this._placementDirty=N.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:A,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,w.mark(x.load),this.fire(new i.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const V=i.o.now()-m;S.endQuery(d.TIME_ELAPSED_EXT),setTimeout(()=>{const G=S.getQueryParameter(o,S.QUERY_RESULT)/1e6;S.deleteQuery(o),this.fire(new i.z("gpu-timing-frame",{cpuTime:V,gpuTime:G}))},50)}if(this.listens("gpu-timing-layer")){const V=this.painter.collectGpuTimers();setTimeout(()=>{const G=this.painter.queryGpuTimers(V);this.fire(new i.z("gpu-timing-layer",{layerTimes:G}))},50)}if(this.listens("gpu-timing-deferred-render")){const V=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const G=this.painter.queryGpuTimeDeferredRender(V);this.fire(new i.z("gpu-timing-deferred-render",{gpuTime:G}))},50)}const R=this._sourcesDirty||this._styleDirty||this._placementDirty||k;if(R||this._repaint)this.triggerRepaint();else{const V=this.idle();if(V&&(k=this._updateAverageElevation(m,!0)),k)this.triggerRepaint();else if(this._triggerFrame(!1),V&&(this.fire(new i.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const G=this._calculateSpeedIndex();this.fire(new i.z("speedindexcompleted",{speedIndex:G})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||R||(this._fullyLoaded=!0,w.mark(x.fullLoad),this._performanceMetricsCollection&&At(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(g){for(const o of this._markers)g&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(const o of this._popups)!g||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(g,o=!1){const d=S=>(this.transform.averageElevation=S,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&d(0);const m=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(m||(o||g-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(g)){const S=this.transform.averageElevation;let A=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(A)?A=0:this._averageElevationLastSampledAt=g;const k=Math.abs(S-A);if(k>1){if(this._isInitialLoad||m)return this._averageElevation.jumpTo(A),d(A);this._averageElevation.easeTo(A,g,300)}else if(k>1e-4)return this._averageElevation.jumpTo(A),d(A)}return!!this._averageElevation.isEasing(g)&&d(this._averageElevation.getValue(g))}_authenticate(){Pt(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,g=>{if(g&&(g.message===Ce||g.status===401)){const o=this.painter.context.gl;Ot(o,!1),this._logoControl instanceof Kh&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),nt(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&gt(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const g=this._isDragging();this.painter.updateTerrain(this.style,g)}_calculateSpeedIndex(){const g=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const d=this.painter.context.gl,m=d.createFramebuffer();function S(A){d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,A,0);const k=new Uint8Array(d.drawingBufferWidth*d.drawingBufferHeight*4);return d.readPixels(0,0,d.drawingBufferWidth,d.drawingBufferHeight,d.RGBA,d.UNSIGNED_BYTE,k),k}return d.bindFramebuffer(d.FRAMEBUFFER,m),this._canvasPixelComparison(S(g),o.canvasCopies.map(S),o.timeStamps)}_canvasPixelComparison(g,o,d){let m=d[1]-d[0];const S=g.length/4;for(let A=0;A<o.length;A++){const k=o[A];let N=0;for(let R=0;R<k.length;R+=4)k[R]===g[R]&&k[R+1]===g[R+1]&&k[R+2]===g[R+2]&&k[R+3]===g[R+3]&&(N+=1);m+=(d[A+2]-d[A+1])*(1-N/S)}return m}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const g=this.painter.context.gl.getExtension("WEBGL_lose_context");g&&g.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Ht.delete(this.painter.context.gl),mt.remove(),Ye.remove(),this._removed=!0,this.fire(new i.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(g){this._renderNextFrame=this._renderNextFrame||g,this.style&&!this._frame&&(this._frame=i.o.frame(o=>{const d=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,d&&this._render(o)}))}_preloadTiles(g){const o=this.style?this.style.getSourceCaches():[];return i.bw(o,(d,m)=>d._preloadTiles(g,m),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(g){this._trackResize&&this.resize({originalEvent:g})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(g){this._showParseStatus!==g&&(this._showParseStatus=g,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(g){this._showTerrainWireframe!==g&&(this._showTerrainWireframe=g,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(g){this._showLayers2DWireframe!==g&&(this._showLayers2DWireframe=g,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(g){this._showLayers3DWireframe!==g&&(this._showLayers3DWireframe=g,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(g){this._speedIndexTiming!==g&&(this._speedIndexTiming=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,this._tp.refreshUI(),g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(g){this._showTileAABBs!==g&&(this._showTileAABBs=g,this._tp.refreshUI(),g&&this._update())}_setCacheLimits(g,o){i.eX(g,o)}get version(){return y}},NavigationControl:class{constructor(g={}){this.options=Object.assign({},EN,g),this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(i.aY(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",o=>{this._map&&this._map.zoomIn({},{originalEvent:o})}),D("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",o=>{this._map&&this._map.zoomOut({},{originalEvent:o})}),D("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aY(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",o=>{const d=this._map;d&&(this.options.visualizePitch?d.resetNorthPitch({},{originalEvent:o}):d.resetNorth({},{originalEvent:o}))}),this._compassIcon=D("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const g=this._map;if(!g)return;const o=g.getZoom(),d=o===g.getMaxZoom(),m=o===g.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const g=this._map;if(!g)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(g.transform.pitch*(Math.PI/180)),.5)}) rotateX(${g.transform.pitch}deg) rotateZ(${g.transform.angle*(180/Math.PI)}deg)`:`rotate(${g.transform.angle*(180/Math.PI)}deg)`;g._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=o)})}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),g.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&g.on("pitch",this._rotateCompassArrow),g.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new PN(g,this._compass,this.options.visualizePitch)),this._container}onRemove(){const g=this._map;g&&(this._container.remove(),this.options.showZoom&&g.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&g.off("pitch",this._rotateCompassArrow),g.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(g,o){const d=D("button",g,this._container);return d.type="button",d.addEventListener("click",o),d}_setButtonTitle(g,o){if(!this._map)return;const d=this._map._getUIString(`NavigationControl.${o}`);g.setAttribute("aria-label",d),g.firstElementChild&&g.firstElementChild.setAttribute("title",d)}},GeolocateControl:class extends i.E{constructor(g={}){super();const o=navigator.geolocation;this.options=Object.assign({geolocation:o},om,g),i.aY(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Zx(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(g){return this._map=g,this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(g){const o=(d=!!this.options.geolocation)=>{this._supportsGeolocation=d,g(d)};this._supportsGeolocation!==void 0?g(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(d=>o(d.state!=="denied")).catch(()=>o()):o()}_isOutOfMapMaxBounds(g){const o=this._map.getMaxBounds(),d=g.coords;return!!o&&(d.longitude<o.getWest()||d.longitude>o.getEast()||d.latitude<o.getSouth()||d.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(g){if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),this.fire(new i.z("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(g),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(g),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("geolocate",g)),this._finish()}}_updateCamera(g){const o=new i.aR(g.coords.longitude,g.coords.latitude),d=g.coords.accuracy,m=this._map.getBearing(),S=Object.assign({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(d),S,{geolocateSource:!0})}_updateMarker(g){if(g){const o=new i.aR(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=g.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const g=this._map.transform,o=i.ce(1,g._center.lat)*g.worldSize,d=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(g){if(this._map){if(this.options.trackUserLocation)if(g.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(g.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("error",g)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(g){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=D("button","mapboxgl-ctrl-geolocate",this._container),D("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",g===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D("div","mapboxgl-user-location"),this._dotElement.appendChild(D("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(D("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new bg({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=D("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new bg({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.z("trackuserlocationend")))})}}_onDeviceOrientation(g){this._userLocationDotMarker&&(g.webkitCompassHeading?this._heading=g.webkitCompassHeading:g.absolute===!0&&(this._heading=-1*g.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(g={maximumAge:6e5,timeout:0},this._noTimeout=!0):(g=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,g),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const g=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(o=>{o==="granted"&&g()}).catch(console.error):g()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:t_,ScaleControl:class{constructor(g={}){this.options=Object.assign({},Kf,g),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aY(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const g=this.options.maxWidth||100,o=this._map,d=o._containerHeight/2,m=o._containerWidth/2-g/2,S=o.unproject([m,d]),A=o.unproject([m+g,d]),k=S.distanceTo(A);if(this.options.unit==="imperial"){const N=3.2808*k;N>5280?this._setScale(g,N/5280,"mile"):this._setScale(g,N,"foot")}else this.options.unit==="nautical"?this._setScale(g,k/1852,"nautical-mile"):k>=1e3?this._setScale(g,k/1e3,"kilometer"):this._setScale(g,k,"meter")}_setScale(g,o,d){this._map._requestDomTask(()=>{const m=function(A){const k=Math.pow(10,`${Math.floor(A)}`.length-1);let N=A/k;return N=N>=10?10:N>=5?5:N>=3?3:N>=2?2:N>=1?1:function(R){const V=Math.pow(10,Math.ceil(-Math.log(R)/Math.LN10));return Math.round(R*V)/V}(N),k*N}(o),S=m/o;this._container.innerHTML=this._isNumberFormatSupported&&d!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:d}).format(m):`${m}&nbsp;${Yf[d]}`,this._container.style.width=g*S+"px"})}onAdd(g){return this._map=g,this._language=g.getLanguage(),this._container=D("div","mapboxgl-ctrl mapboxgl-ctrl-scale",g.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(g){this._language=g,this._update()}setUnit(g){this.options.unit=g,this._update()}},FullscreenControl:class{constructor(g={}){this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:i.w("Full screen control 'container' must be a DOM element.")),i.aY(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=D("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const g=this._fullscreenButton=D("button","mapboxgl-ctrl-fullscreen",this._controlContainer);D("span","mapboxgl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",g)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},IndoorControl:n_,Popup:class extends i.E{constructor(g){super(),this.options=Object.assign(Object.create(wg),g),this._altitude=this.options.altitude,i.aY(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(g&&g.className?g.className.trim().split(/\s+/):[])}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&g.on("preclick",this._onClose),this.options.closeOnMove&&g.on("move",this._onClose),g.on("remove",this.remove),this._update(),g._addPopup(this),this._focusFirstElement(),this._trackPointer?(g.on("mousemove",this._onMouseEvent),g.on("mouseup",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")):g.on("move",this._update),this.fire(new i.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const g=this._map;return g&&(g.off("move",this._update),g.off("move",this._onClose),g.off("preclick",this._onClose),g.off("click",this._onClose),g.off("remove",this.remove),g.off("mousemove",this._onMouseEvent),g.off("mouseup",this._onMouseEvent),g.off("drag",this._onMouseEvent),g._canvasContainer&&g._canvasContainer.classList.remove("mapboxgl-track-pointer"),g._removePopup(this),this._map=void 0),this.fire(new i.z("close")),this}getLngLat(){return this._lngLat}setLngLat(g){this._lngLat=i.aR.convert(g),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(g){return this._altitude=g,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const g=this._map;return g&&(g.off("move",this._update),g.on("mousemove",this._onMouseEvent),g.on("drag",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const o=document.createDocumentFragment(),d=document.createElement("body");let m;for(d.innerHTML=g;m=d.firstChild,m;)o.appendChild(m);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=D("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(g),this.options.closeButton){const d=this._closeButton=D("button","mapboxgl-popup-close-button",o);d.type="button",d.setAttribute("aria-label","Close popup"),d.innerHTML='<span aria-hidden="true">&#215;</span>',d.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(g){return this._classList.add(g),this._updateClassList(),this}removeClassName(g){return this._classList.delete(g),this._updateClassList(),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){let o;return this._classList.delete(g)?o=!1:(this._classList.add(g),o=!0),this._updateClassList(),o}_onMouseEvent(g){this._update(g.point)}_getAnchor(g){if(this.options.anchor)return this.options.anchor;const o=this._map,d=this._container,m=this._pos;if(!o||!d||!m)return"bottom";const S=d.offsetWidth,A=d.offsetHeight,k=m.x<S/2,N=m.x>o.transform.width-S/2;if(m.y+g<A)return k?"top-left":N?"top-right":"top";if(m.y>o.transform.height-A){if(k)return"bottom-left";if(N)return"bottom-right"}return k?"left":N?"right":"bottom"}_updateClassList(){const g=this._container;if(!g)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),g.className=o.join(" ")}_update(g){const o=this._map,d=this._content;if(!o||!this._lngLat&&!this._trackPointer||!d)return;let m=this._container;if(m||(m=this._container=D("div","mapboxgl-popup",o.getContainer()),this._tip=D("div","mapboxgl-popup-tip",m),m.appendChild(d)),this.options.maxWidth&&m.style.maxWidth!==this.options.maxWidth&&(m.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=i1(this._lngLat,this._pos,o.transform)),!this._trackPointer||g){const S=this._pos=this._trackPointer&&g instanceof i.P?g:o.project(this._lngLat,this._altitude),A=PT(this.options.offset),k=this._anchor=this._getAnchor(A.y),N=PT(this.options.offset,k),R=S.add(N).round();o._requestDomTask(()=>{this._container&&k&&(this._container.style.transform=`${a_[k]} translate(${R.x}px,${R.y}px)`)})}if(!this._marker&&o._showingGlobe()){const S=i.eY(o.transform,this._lngLat)?0:1;this._setOpacity(S)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(oh);g&&g.focus()}_onClose(){this.remove()}_setOpacity(g){this._container&&(this._container.style.opacity=`${g}`),this._content&&(this._content.style.pointerEvents=g?"auto":"none")}},Marker:bg,Style:ko,LngLat:i.aR,LngLatBounds:i.aI,Point:i.P,MercatorCoordinate:i.ae,FreeCameraOptions:ql,Evented:i.E,config:i.e,prewarm:i.f0,clearPrewarmedResources:i.e$,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(g){i.e.ACCESS_TOKEN=g},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(g){i.e.API_URL=g},get workerCount(){return i.f9.workerCount},set workerCount(g){i.f9.workerCount=g},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(g){i.e.MAX_PARALLEL_IMAGE_REQUESTS=g},clearStorage(g){i.f8(g)},get workerUrl(){return i.f7.workerUrl},set workerUrl(g){i.f7.workerUrl=g},get workerClass(){return i.f7.workerClass},set workerClass(g){i.f7.workerClass=g},get workerParams(){return i.f7.workerParams},set workerParams(g){i.f7.workerParams=g},get dracoUrl(){return i.f6()},set dracoUrl(g){i.f5(g)},get meshoptUrl(){return i.f4()},set meshoptUrl(g){i.f3(g)},setNow:i.o.setNow,restoreNow:i.o.restoreNow}});var h=a;return h})})(Cde);var DGe=Cde.exports;const I1=Ip(DGe),RGe={"Food & Dining":vF,Shopping:S5,Transportation:gF,Grocery:Tu,Other:Tu,Entertainment:Tu,Healthcare:od},_E={low:{background:"linear-gradient(135deg, #10b981, #059669)",glow:"0 0 20px rgba(16, 185, 129, 0.6), 0 0 40px rgba(16, 185, 129, 0.4), 0 0 60px rgba(16, 185, 129, 0.2)",border:"#10b981"},medium:{background:"linear-gradient(135deg, #f59e0b, #d97706)",glow:"0 0 20px rgba(245, 158, 11, 0.6), 0 0 40px rgba(245, 158, 11, 0.4), 0 0 60px rgba(245, 158, 11, 0.2)",border:"#f59e0b"},high:{background:"linear-gradient(135deg, #ef4444, #dc2626)",glow:"0 0 20px rgba(239, 68, 68, 0.6), 0 0 40px rgba(239, 68, 68, 0.4), 0 0 60px rgba(239, 68, 68, 0.2)",border:"#ef4444"}};function jGe(){const{mapboxToken:e,isMapboxConfigured:t,isLoading:n}=dAe(),[r,a]=L.useState([]),[l,h]=L.useState(null),[i,y]=L.useState(""),[x,w]=L.useState("30"),[C,P]=L.useState(!0),[E,j]=L.useState(null),[D,B]=L.useState([]);L.useState(!1);const[F,$]=L.useState(null),[H,J]=L.useState(!1),[ee,Q]=L.useState(null),ne=L.useRef(null),pe=L.useRef(null);L.useEffect(()=>(pe.current=new LGe({minConfidenceThreshold:70,verificationInterval:24*60*60*1e3,geocodingRetryAttempts:3,coordinateTolerance:1e-4}),pe.current.startPeriodicVerification(),()=>{pe.current&&pe.current.stopPeriodicVerification()}),[]),L.useEffect(()=>{fe()},[x]),L.useEffect(()=>{t&&e&&ne.current&&!E&&he()},[t,e]),L.useEffect(()=>{E&&r.length>0&&we()},[E,r]);const he=()=>{if(!ne.current||!e)return;I1.accessToken=e;const De=new I1.Map({container:ne.current,style:"mapbox://styles/mapbox/streets-v12",center:[-80.4139,37.2296],zoom:12,attributionControl:!1});De.addControl(new I1.NavigationControl,"top-right"),De.addControl(new I1.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0}),"top-right"),De.on("load",()=>{j(De),console.log("Map initialized successfully"),console.log("Map center:",De.getCenter()),console.log("Map zoom:",De.getZoom())}),De.on("error",Ct=>{console.error("Map error:",Ct),Gn.error("Map failed to load",{description:"Please check your Mapbox token",duration:5e3})})},we=async()=>{if(!E||!pe.current)return;D.forEach(me=>me.remove()),B([]);const De=[],Ct=r.filter(me=>me.address!=="Address to be geocoded"&&me.address!=="Address not available");if((await Promise.all(Ct.map(async me=>{if(me.id.includes("-")&&!me.id.includes("-similar-")&&!me.id.includes("-mock"))return console.log(`Using backend coordinates for known merchant: ${me.name}`,me.coordinates),me;try{const nt=await pe.current.resolveMerchantLocation(me.id,me.name,me.address,me.coordinates);return{...me,coordinates:nt}}catch(nt){return console.warn(`Failed to resolve location for ${me.name}:`,nt),me}}))).forEach(me=>{if(me.coordinates.lat&&me.coordinates.lng){console.log(`Creating marker for ${me.name} at:`,me.coordinates,`Pricing: ${me.pricingLevel}`);const Ye=document.createElement("div");Ye.className="merchant-marker";const nt=_E[me.pricingLevel];Ye.style.cssText=`
          width: 32px;
          height: 32px;
          border-radius: 50%;
          background: ${nt.background};
          border: 3px solid white;
          box-shadow: ${nt.glow}, 0 4px 12px rgba(0,0,0,0.15);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: box-shadow 0.3s ease, border 0.3s ease;
          position: relative;
          transform: translate(-50%, -50%);
          transform-origin: center;
        `,je(me.category);const vt=document.createElement("div");vt.style.cssText=`
          color: white;
          font-size: 12px;
          display: flex;
          align-items: center;
          justify-content: center;
        `;const gt=document.createElementNS("http://www.w3.org/2000/svg","svg");gt.setAttribute("width","12"),gt.setAttribute("height","12"),gt.setAttribute("viewBox","0 0 24 24"),gt.setAttribute("fill","none"),gt.setAttribute("stroke","currentColor"),gt.setAttribute("stroke-width","2"),gt.setAttribute("stroke-linecap","round"),gt.setAttribute("stroke-linejoin","round");const dt=document.createElementNS("http://www.w3.org/2000/svg","path");me.category==="Food & Dining"?dt.setAttribute("d","M3 2v7c0 1.1.9 2 2 2h4v2H5c-1.1 0-2 .9-2 2v3h18v-3c0-1.1-.9-2-2-2h-4v-2h4c1.1 0 2-.9 2-2V2H3z"):me.category==="Shopping"?dt.setAttribute("d","M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5M7 13l2.5 5m6-5v6a2 2 0 01-2 2H9a2 2 0 01-2-2v-6m8 0V9a2 2 0 00-2-2H9a2 2 0 00-2 2v4.01"):me.category==="Transportation"?dt.setAttribute("d","M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16.5 10 14 10s-4.7.6-6.5 1.1C6.7 11.3 6 12.1 6 13v3c0 .6.4 1 1 1h2m-3-4h.01M9 17h.01M15 17h.01M21 17h.01"):dt.setAttribute("d","M12 1v22M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"),gt.appendChild(dt),vt.appendChild(gt),Ye.appendChild(vt),Ye.addEventListener("mouseenter",()=>{Ye.style.zIndex="1000";const mt=nt.glow.replace(/0\.6/g,"0.8").replace(/0\.4/g,"0.6").replace(/0\.2/g,"0.4");Ye.style.boxShadow=`${mt}, 0 6px 20px rgba(0,0,0,0.25)`,Ye.style.border=`4px solid ${nt.border}`,Ye.style.borderWidth="4px"}),Ye.addEventListener("mouseleave",()=>{Ye.style.zIndex="1",Ye.style.boxShadow=`${nt.glow}, 0 4px 12px rgba(0,0,0,0.15)`,Ye.style.border="3px solid white",Ye.style.borderWidth="3px"});const At=new I1.Marker(Ye).setLngLat([me.coordinates.lng,me.coordinates.lat]).addTo(E);console.log(`Marker added for ${me.name} at [${me.coordinates.lng}, ${me.coordinates.lat}]`),Ye.addEventListener("click",()=>{Qe(me),document.querySelectorAll(".mapboxgl-popup").forEach(Un=>{Un.remove()}),ee&&(ee.remove(),Q(null));const Pt=nt.border,Ht=me.pricingLevel.charAt(0).toUpperCase()+me.pricingLevel.slice(1),Ot=new I1.Popup({offset:25,closeButton:!0,closeOnClick:!1,className:"merchant-popup"}).setHTML(`
            <div class="p-3">
              <h3 class="font-semibold text-lg">${me.name}</h3>
              <p class="text-sm text-gray-600 mb-2">${me.address}</p>
              <div class="flex items-center gap-2 mb-2">
                <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">${me.category}</span>
                <span class="px-2 py-1 text-xs rounded-full" style="background-color: ${Pt}20; color: ${Pt}; border: 1px solid ${Pt}40;">
                  ${Ht} Pricing
                </span>
              </div>
              <div class="text-sm space-y-1">
                <div class="flex justify-between">
                  <span>Total Spent:</span>
                  <span class="font-medium">$${me.totalSpent.toFixed(2)}</span>
                </div>
                <div class="flex justify-between">
                  <span>Average per Visit:</span>
                  <span class="font-medium">$${me.averageSpent.toFixed(2)}</span>
                </div>
                <div class="flex justify-between">
                  <span>Visits:</span>
                  <span class="font-medium">${me.visits}</span>
                </div>
              </div>
            </div>
          `);At.setPopup(Ot),Q(Ot)}),De.push(At)}}),B(De),pe.current){const me=pe.current.getLocationIntelligence();$(me)}},fe=async()=>{try{P(!0);const De=await vs.getMapMerchants(x);if(De.success){const Ct=De.data;console.log("Loaded merchants from backend:",Ct),a(Ct),Ct.length>0&&!l&&h(Ct[0])}}catch(De){console.error("Failed to load map data:",De),Gn.error("Failed to load map data",{description:"Please try again later",duration:5e3})}finally{P(!1)}},ge=async()=>{await fe(),Gn.success("Map data refreshed!",{description:"Updated with latest spending information",duration:3e3})},Ce=()=>{E&&E.zoomIn()},xe=()=>{E&&E.zoomOut()},Re=()=>{E&&E.easeTo({bearing:0,pitch:0})},Qe=De=>{h(De),J(!0),E&&De.coordinates.lat&&De.coordinates.lng?(E.easeTo({center:[De.coordinates.lng,De.coordinates.lat],zoom:15,duration:1e3}),setTimeout(()=>{J(!1)},1100)):J(!1),setTimeout(()=>{const Ct=document.querySelector(`[data-merchant-id="${De.id}"]`);Ct&&Ct.scrollIntoView({behavior:"smooth",block:"center"})},100)},et=r.filter(De=>De.address!=="Address to be geocoded"&&De.address!=="Address not available"&&(De.name.toLowerCase().includes(i.toLowerCase())||De.address.toLowerCase().includes(i.toLowerCase()))),je=De=>RGe[De]||Tu;return v.jsxs("div",{className:"h-full min-h-screen space-y-6 p-6",children:[v.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-6",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("h1",{className:"text-2xl lg:text-3xl font-bold bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:"Geographic Spending"}),v.jsx("p",{className:"text-muted-foreground text-sm",children:"Visualize your spending patterns across locations and discover insights"})]}),v.jsxs("div",{className:"flex flex-wrap items-center gap-2 lg:gap-3",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(EA,{className:"w-4 h-4 text-muted-foreground"}),v.jsxs(Ep,{value:x,onValueChange:w,children:[v.jsx(Af,{className:"w-32 h-9",children:v.jsx(Pp,{})}),v.jsxs(Tf,{children:[v.jsx(So,{value:"7",children:"Last 7 days"}),v.jsx(So,{value:"30",children:"Last 30 days"}),v.jsx(So,{value:"90",children:"Last 90 days"}),v.jsx(So,{value:"365",children:"Last year"})]})]})]}),v.jsxs("div",{className:"relative",children:[v.jsx(gb,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),v.jsx(ss,{placeholder:"Search merchants...",value:i,onChange:De=>y(De.target.value),className:"pl-10 w-48 lg:w-64 h-9"})]}),v.jsxs($n,{variant:"outline",size:"sm",onClick:ge,disabled:C,className:"h-9",children:[v.jsx(J1,{className:`w-4 h-4 mr-2 ${C?"animate-spin":""}`}),v.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]})]})]}),v.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4 lg:gap-6 h-[calc(100vh-200px)]",children:[v.jsx("div",{className:"lg:col-span-3 order-1 lg:order-1",children:v.jsx(xr,{className:"h-full border-0 shadow-lg bg-gradient-to-br from-background to-muted/20",children:v.jsxs(br,{className:"p-0 h-full relative",children:[v.jsxs("div",{className:"absolute top-4 left-4 z-10 flex flex-col gap-2",children:[v.jsx($n,{variant:"outline",size:"sm",onClick:Ce,className:"h-8 w-8 p-0 bg-white/90 hover:bg-white",children:v.jsx(mxe,{className:"w-4 h-4"})}),v.jsx($n,{variant:"outline",size:"sm",onClick:xe,className:"h-8 w-8 p-0 bg-white/90 hover:bg-white",children:v.jsx(gxe,{className:"w-4 h-4"})}),v.jsx($n,{variant:"outline",size:"sm",onClick:Re,className:"h-8 w-8 p-0 bg-white/90 hover:bg-white",children:v.jsx(zQ,{className:"w-4 h-4"})})]}),t?n?v.jsx("div",{className:"h-full w-full rounded-xl bg-muted/20 flex items-center justify-center",children:v.jsxs("div",{className:"text-center space-y-4",children:[v.jsx(J1,{className:"w-8 h-8 text-muted-foreground mx-auto animate-spin"}),v.jsx("h3",{className:"text-lg font-semibold",children:"Loading Map..."}),v.jsx("p",{className:"text-muted-foreground text-sm",children:"Initializing Mapbox integration"})]})}):v.jsx("div",{ref:ne,className:"h-full w-full rounded-xl",style:{minHeight:"400px"}}):v.jsx("div",{className:"h-full w-full rounded-xl bg-muted/20 flex items-center justify-center",children:v.jsxs("div",{className:"text-center space-y-4",children:[v.jsx(od,{className:"w-16 h-16 text-muted-foreground mx-auto"}),v.jsx("h3",{className:"text-lg font-semibold",children:"Mapbox Not Configured"}),v.jsx("p",{className:"text-muted-foreground text-sm",children:"Please configure your Mapbox token in Settings to view the map"}),v.jsx($n,{asChild:!0,children:v.jsx("a",{href:"/settings",children:"Go to Settings"})})]})}),F&&v.jsx("div",{className:"absolute bottom-4 left-4 z-10",children:v.jsx(xr,{className:"border-l-4 border-l-purple-500 bg-purple-50/90 backdrop-blur-sm",children:v.jsx(br,{className:"p-3",children:v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx(pb,{className:"w-4 h-4 text-purple-600"}),v.jsxs("div",{className:"text-sm",children:[v.jsx("div",{className:"font-medium",children:"Location Intelligence Active"}),v.jsxs("div",{className:"text-xs text-muted-foreground",children:[F.verifiedLocations,"/",F.totalLocations," verified"]})]})]})})})}),H&&v.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-20",children:v.jsx(xr,{className:"bg-blue-50/90 backdrop-blur-sm border-blue-200",children:v.jsx(br,{className:"p-4",children:v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx(J1,{className:"w-4 h-4 text-blue-600 animate-spin"}),v.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Navigating to location..."})]})})})})]})})}),v.jsx("div",{className:"overflow-y-auto h-full order-2 lg:order-2",children:l?v.jsxs(xr,{className:"h-full border-0 shadow-lg bg-gradient-to-br from-background to-muted/20",children:[v.jsx(ui,{className:"pb-4",children:v.jsxs(di,{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:ir.createElement(je(l.category),{className:"w-5 h-5 text-primary"})}),v.jsxs("div",{children:[v.jsx("div",{className:"text-lg font-semibold",children:"Merchant Details"}),v.jsx("div",{className:"text-sm text-muted-foreground",children:"Selected location"})]})]}),v.jsx($n,{variant:"ghost",size:"sm",onClick:()=>{h(null),document.querySelectorAll(".mapboxgl-popup").forEach(Ct=>{Ct.remove()}),ee&&(ee.remove(),Q(null))},className:"text-muted-foreground hover:text-foreground",children:""})]})}),v.jsxs(br,{className:"space-y-6 pb-6",children:[v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-semibold text-lg",children:l.name}),v.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[v.jsx(od,{className:"w-4 h-4"}),l.address]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs(Is,{variant:"secondary",className:"flex items-center gap-1",children:[ir.createElement(je(l.category),{className:"w-3 h-3"}),l.category]}),v.jsxs(Is,{variant:"outline",className:"flex items-center gap-1",style:{backgroundColor:`${_E[l.pricingLevel].border}20`,color:_E[l.pricingLevel].border,borderColor:_E[l.pricingLevel].border},children:[l.pricingLevel.charAt(0).toUpperCase()+l.pricingLevel.slice(1)," Pricing"]})]})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(Tu,{className:"w-4 h-4 text-muted-foreground"}),v.jsx("span",{className:"text-muted-foreground",children:"Total Spent:"})]}),v.jsxs("span",{className:"font-medium text-right",children:["$",l.totalSpent.toFixed(2)]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(Tu,{className:"w-4 h-4 text-muted-foreground"}),v.jsx("span",{className:"text-muted-foreground",children:"Avg per Visit:"})]}),v.jsxs("span",{className:"font-medium text-right",children:["$",l.averageSpent.toFixed(2)]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(EA,{className:"w-4 h-4 text-muted-foreground"}),v.jsx("span",{className:"text-muted-foreground",children:"Visits:"})]}),v.jsx("span",{className:"font-medium text-right",children:l.visits})]}),v.jsxs("div",{className:"space-y-2 pt-4 border-t",children:[v.jsxs($n,{variant:"outline",className:"w-full",onClick:()=>Qe(l),children:[v.jsx(od,{className:"w-4 h-4 mr-2"}),"Center on Map"]}),v.jsx($n,{variant:"outline",className:"w-full",children:"View Transactions"})]})]})]}):v.jsxs(xr,{className:"h-full border-0 shadow-lg bg-gradient-to-br from-background to-muted/20",children:[v.jsx(ui,{className:"pb-4",children:v.jsxs(di,{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:v.jsx(S5,{className:"w-5 h-5 text-primary"})}),v.jsxs("div",{children:[v.jsx("div",{className:"text-lg font-semibold",children:"All Merchants"}),v.jsx("div",{className:"text-sm text-muted-foreground",children:"Browse all spending locations"})]})]})}),v.jsx(br,{className:"h-[calc(100%-120px)] overflow-y-auto pr-2",children:C?v.jsx("div",{className:"flex items-center justify-center p-4",children:v.jsx(J1,{className:"h-6 w-6 animate-spin text-primary"})}):et.length>0?v.jsx("div",{className:"space-y-3",children:et.map(De=>v.jsx("div",{"data-merchant-id":De.id,className:"p-3 lg:p-4 rounded-xl cursor-pointer transition-all duration-200 hover:shadow-md bg-muted/20 hover:bg-muted/50 border border-transparent",onClick:()=>Qe(De),children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[ir.createElement(je(De.category),{className:"w-5 h-5 text-muted-foreground"}),v.jsxs("div",{children:[v.jsx("h4",{className:"font-semibold text-base",children:De.name}),v.jsx("p",{className:"text-xs text-muted-foreground",children:De.address})]})]}),v.jsxs("span",{className:"font-medium text-sm",children:["$",De.totalSpent.toFixed(2)]})]})},De.id))}):v.jsx("p",{className:"text-muted-foreground text-sm text-center p-4",children:"No merchants found for the selected period or search query."})})]})})]})]})}const Gg=F6,iA=aie,OGe=z6,Pde=L.forwardRef(({className:e,...t},n)=>v.jsx(j5,{ref:n,className:Xn("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));Pde.displayName=j5.displayName;const km=L.forwardRef(({className:e,children:t,...n},r)=>v.jsxs(OGe,{children:[v.jsx(Pde,{}),v.jsxs(O5,{ref:r,className:Xn("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,v.jsxs(aI,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[v.jsx(cv,{className:"h-4 w-4"}),v.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));km.displayName=O5.displayName;const Im=({className:e,...t})=>v.jsx("div",{className:Xn("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Im.displayName="DialogHeader";const i8=({className:e,...t})=>v.jsx("div",{className:Xn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});i8.displayName="DialogFooter";const Nm=L.forwardRef(({className:e,...t},n)=>v.jsx(F5,{ref:n,className:Xn("text-lg font-semibold leading-none tracking-tight",e),...t}));Nm.displayName=F5.displayName;const kde=L.forwardRef(({className:e,...t},n)=>v.jsx(z5,{ref:n,className:Xn("text-sm text-muted-foreground",e),...t}));kde.displayName=z5.displayName;var pN="Switch",[FGe,ZXe]=dd(pN),[zGe,BGe]=FGe(pN),Ide=L.forwardRef((e,t)=>{const{__scopeSwitch:n,name:r,checked:a,defaultChecked:l,required:h,disabled:i,value:y="on",onCheckedChange:x,form:w,...C}=e,[P,E]=L.useState(null),j=_s(t,H=>E(H)),D=L.useRef(!1),B=P?w||!!P.closest("form"):!0,[F,$]=ny({prop:a,defaultProp:l??!1,onChange:x,caller:pN});return v.jsxs(zGe,{scope:n,checked:F,disabled:i,children:[v.jsx(Ei.button,{type:"button",role:"switch","aria-checked":F,"aria-required":h,"data-state":Dde(F),"data-disabled":i?"":void 0,disabled:i,value:y,...C,ref:j,onClick:Sr(e.onClick,H=>{$(J=>!J),B&&(D.current=H.isPropagationStopped(),D.current||H.stopPropagation())})}),B&&v.jsx(Lde,{control:P,bubbles:!D.current,name:r,value:y,checked:F,required:h,disabled:i,form:w,style:{transform:"translateX(-100%)"}})]})});Ide.displayName=pN;var Nde="SwitchThumb",Mde=L.forwardRef((e,t)=>{const{__scopeSwitch:n,...r}=e,a=BGe(Nde,n);return v.jsx(Ei.span,{"data-state":Dde(a.checked),"data-disabled":a.disabled?"":void 0,...r,ref:t})});Mde.displayName=Nde;var UGe="SwitchBubbleInput",Lde=L.forwardRef(({__scopeSwitch:e,control:t,checked:n,bubbles:r=!0,...a},l)=>{const h=L.useRef(null),i=_s(h,l),y=Vue(n),x=dee(t);return L.useEffect(()=>{const w=h.current;if(!w)return;const C=window.HTMLInputElement.prototype,E=Object.getOwnPropertyDescriptor(C,"checked").set;if(y!==n&&E){const j=new Event("click",{bubbles:r});E.call(w,n),w.dispatchEvent(j)}},[y,n,r]),v.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...a,tabIndex:-1,ref:i,style:{...a.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Lde.displayName=UGe;function Dde(e){return e?"checked":"unchecked"}var Rde=Ide,VGe=Mde;const wm=L.forwardRef(({className:e,...t},n)=>v.jsx(Rde,{className:Xn("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",e),...t,ref:n,children:v.jsx(VGe,{className:Xn("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));wm.displayName=Rde.displayName;const rK=[{value:"MERCHANT",label:"Merchant",icon:bF,description:"Limit spending at a specific merchant"},{value:"CATEGORY",label:"Category",icon:Wd,description:"Limit spending in a specific category"},{value:"GLOBAL",label:"Global",icon:Tu,description:"Overall spending limit"}],$Ge=[{value:"DAILY",label:"Daily"},{value:"WEEKLY",label:"Weekly"},{value:"MONTHLY",label:"Monthly"},{value:"YEARLY",label:"Yearly"}],qGe=["Food & Dining","Shopping","Transportation","Entertainment","Healthcare","Education","Utilities","Other"];function jde({isOpen:e,onClose:t,cap:n,onSuccess:r}){const[a,l]=L.useState({type:"MERCHANT",name:"",limit:"",period:"MONTHLY",category:"",merchant:"",enabled:!0}),[h,i]=L.useState({}),[y,x]=L.useState(!1),w=YSe(),C=XSe(),{data:P=[],isLoading:E}=eAe("90"),j=!!n;L.useEffect(()=>{var ee;l(n?{type:n.type||"MERCHANT",name:n.name||"",limit:((ee=n.limit)==null?void 0:ee.toString())||"",period:n.period||"MONTHLY",category:n.category||"",merchant:n.merchant||"",enabled:n.enabled!==void 0?n.enabled:!0}:{type:"MERCHANT",name:"",limit:"",period:"MONTHLY",category:"",merchant:"",enabled:!0}),i({}),x(!1)},[n,e]),L.useEffect(()=>{const ee=Q=>{Q.target.closest(".merchant-suggestions")||x(!1)};if(y)return document.addEventListener("mousedown",ee),()=>document.removeEventListener("mousedown",ee)},[y]);const D=()=>{const ee={};return a.name.trim()||(ee.name="Name is required"),(!a.limit||parseFloat(a.limit)<=0)&&(ee.limit="Limit must be greater than 0"),a.type==="CATEGORY"&&!a.category&&(ee.category="Category is required"),a.type==="MERCHANT"&&!a.merchant.trim()&&(ee.merchant="Merchant name is required"),i(ee),Object.keys(ee).length===0},B=async ee=>{if(ee.preventDefault(),!!D())try{const Q={type:a.type,name:a.name.trim(),limit:parseFloat(a.limit),period:a.period,...a.type==="CATEGORY"&&{category:a.category},...a.type==="MERCHANT"&&{merchant:a.merchant.trim()}};j?await C.mutateAsync({id:n.id,data:Q}):await w.mutateAsync(Q),r==null||r(),t()}catch(Q){console.error("Error saving cap:",Q)}},F=(ee,Q)=>{l(ne=>({...ne,[ee]:Q})),h[ee]&&i(ne=>({...ne,[ee]:""}))},$=ee=>{l(Q=>({...Q,merchant:ee})),x(!1),h.merchant&&i(Q=>({...Q,merchant:""}))},H=rK.find(ee=>ee.value===a.type),J=(H==null?void 0:H.icon)||bF;return v.jsx(Gg,{open:e,onOpenChange:t,children:v.jsxs(km,{className:"sm:max-w-[500px]",children:[v.jsx(Im,{children:v.jsxs(Nm,{className:"flex items-center gap-2",children:[v.jsx(J,{className:"w-5 h-5"}),j?"Edit Spending Cap":"Add New Spending Cap"]})}),v.jsxs("form",{onSubmit:B,className:"space-y-6",children:[v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"space-y-3",children:[v.jsx(Qi,{children:"Cap Type"}),v.jsx("div",{className:"grid grid-cols-1 gap-3",children:rK.map(ee=>{const Q=ee.icon;return v.jsx(xr,{className:`cursor-pointer transition-all ${a.type===ee.value?"ring-2 ring-primary bg-primary/5":"hover:bg-muted/50"}`,onClick:()=>F("type",ee.value),children:v.jsx(br,{className:"p-4",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(Q,{className:"w-5 h-5 text-primary"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium",children:ee.label}),v.jsx("p",{className:"text-sm text-muted-foreground",children:ee.description})]})]})})},ee.value)})})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{htmlFor:"name",children:"Name *"}),v.jsx(ss,{id:"name",value:a.name,onChange:ee=>F("name",ee.target.value),placeholder:"Enter cap name",className:h.name?"border-destructive":""}),h.name&&v.jsx("p",{className:"text-sm text-destructive",children:h.name})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{htmlFor:"limit",children:"Limit ($) *"}),v.jsx(ss,{id:"limit",type:"number",step:"0.01",min:"0",value:a.limit,onChange:ee=>F("limit",ee.target.value),placeholder:"0.00",className:h.limit?"border-destructive":""}),h.limit&&v.jsx("p",{className:"text-sm text-destructive",children:h.limit})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{htmlFor:"period",children:"Period"}),v.jsxs(Ep,{value:a.period,onValueChange:ee=>F("period",ee),children:[v.jsx(Af,{children:v.jsx(Pp,{})}),v.jsx(Tf,{children:$Ge.map(ee=>v.jsx(So,{value:ee.value,children:v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(EA,{className:"w-4 h-4"}),ee.label]})},ee.value))})]})]}),a.type==="CATEGORY"&&v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{htmlFor:"category",children:"Category *"}),v.jsxs(Ep,{value:a.category,onValueChange:ee=>F("category",ee),children:[v.jsx(Af,{className:h.category?"border-destructive":"",children:v.jsx(Pp,{placeholder:"Select a category"})}),v.jsx(Tf,{children:qGe.map(ee=>v.jsx(So,{value:ee,children:ee},ee))})]}),h.category&&v.jsx("p",{className:"text-sm text-destructive",children:h.category})]}),a.type==="MERCHANT"&&v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{htmlFor:"merchant",children:"Merchant Name *"}),v.jsxs("div",{className:"relative",children:[v.jsx(ss,{id:"merchant",value:a.merchant,onChange:ee=>F("merchant",ee.target.value),onFocus:()=>x(!0),placeholder:"Enter merchant name",className:h.merchant?"border-destructive":""}),y&&P.length>0&&v.jsxs("div",{className:"merchant-suggestions absolute z-50 w-full mt-1 bg-background border border-border rounded-md shadow-lg max-h-60 overflow-y-auto",children:[v.jsx("div",{className:"p-2 text-xs text-muted-foreground border-b",children:"Suggested merchants from your transaction history:"}),P.slice(0,10).map(ee=>v.jsxs("button",{type:"button",className:"w-full px-3 py-2 text-left hover:bg-muted/50 flex items-center justify-between",onClick:()=>$(ee.name),children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(S5,{className:"w-4 h-4 text-muted-foreground"}),v.jsx("span",{className:"font-medium",children:ee.name})]}),v.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[v.jsxs(Is,{variant:"secondary",className:"text-xs",children:["$",ee.totalSpent.toFixed(0)]}),v.jsxs("span",{children:[ee.transactionCount," visits"]})]})]},ee.name))]})]}),h.merchant&&v.jsx("p",{className:"text-sm text-destructive",children:h.merchant}),a.merchant&&P.find(ee=>ee.name===a.merchant)&&v.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[v.jsx(Ju,{className:"w-4 h-4 text-primary"}),v.jsx("span",{className:"text-sm font-medium",children:"Spending Insights"})]}),(()=>{const ee=P.find(Q=>Q.name===a.merchant);return v.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[v.jsxs("div",{children:[v.jsx("span",{className:"text-muted-foreground",children:"Total Spent:"}),v.jsxs("span",{className:"ml-1 font-medium",children:["$",ee.totalSpent.toFixed(0)]})]}),v.jsxs("div",{children:[v.jsx("span",{className:"text-muted-foreground",children:"Visits:"}),v.jsx("span",{className:"ml-1 font-medium",children:ee.transactionCount})]}),v.jsxs("div",{children:[v.jsx("span",{className:"text-muted-foreground",children:"Avg per Visit:"}),v.jsxs("span",{className:"ml-1 font-medium",children:["$",ee.averageSpent.toFixed(0)]})]}),v.jsxs("div",{children:[v.jsx("span",{className:"text-muted-foreground",children:"Period:"}),v.jsx("span",{className:"ml-1 font-medium",children:"Last 90 days"})]}),v.jsxs("div",{className:"col-span-2 mt-2 p-2 bg-primary/10 rounded border border-primary/20",children:[v.jsxs("div",{className:"flex items-center gap-2 text-primary",children:[v.jsx(Wd,{className:"w-4 h-4"}),v.jsx("span",{className:"text-sm font-medium",children:"Suggested Limit"})]}),v.jsxs("p",{className:"text-sm text-primary mt-1",children:["Based on your spending pattern, consider setting a limit of"," ",v.jsxs("span",{className:"font-semibold",children:["$",(()=>{const Q=P.find(pe=>pe.name===a.merchant);return Math.ceil(Q.totalSpent*1.2)})()]})," ","for this merchant."]}),v.jsx($n,{type:"button",variant:"outline",size:"sm",className:"mt-2 text-primary border-primary hover:bg-primary hover:text-primary-foreground",onClick:()=>{const Q=P.find(pe=>pe.name===a.merchant),ne=Math.ceil(Q.totalSpent*1.2);F("limit",ne.toString())},children:"Use Suggested Limit"})]})]})})()]})]}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"space-y-0.5",children:[v.jsx(Qi,{htmlFor:"enabled",children:"Enabled"}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"Cap will be active and monitor spending"})]}),v.jsx(wm,{id:"enabled",checked:a.enabled,onCheckedChange:ee=>F("enabled",ee)})]})]}),v.jsxs(i8,{children:[v.jsx($n,{type:"button",variant:"outline",onClick:t,children:"Cancel"}),v.jsx($n,{type:"submit",disabled:w.isPending||C.isPending,children:w.isPending||C.isPending?"Saving...":j?"Update Cap":"Create Cap"})]})]})]})})}var s8="Progress",a8=100,[GGe,KXe]=dd(s8),[HGe,WGe]=GGe(s8),Ode=L.forwardRef((e,t)=>{const{__scopeProgress:n,value:r=null,max:a,getValueLabel:l=ZGe,...h}=e;(a||a===0)&&!iK(a)&&console.error(KGe(`${a}`,"Progress"));const i=iK(a)?a:a8;r!==null&&!sK(r,i)&&console.error(YGe(`${r}`,"Progress"));const y=sK(r,i)?r:null,x=i3(y)?l(y,i):void 0;return v.jsx(HGe,{scope:n,value:y,max:i,children:v.jsx(Ei.div,{"aria-valuemax":i,"aria-valuemin":0,"aria-valuenow":i3(y)?y:void 0,"aria-valuetext":x,role:"progressbar","data-state":Bde(y,i),"data-value":y??void 0,"data-max":i,...h,ref:t})})});Ode.displayName=s8;var Fde="ProgressIndicator",zde=L.forwardRef((e,t)=>{const{__scopeProgress:n,...r}=e,a=WGe(Fde,n);return v.jsx(Ei.div,{"data-state":Bde(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...r,ref:t})});zde.displayName=Fde;function ZGe(e,t){return`${Math.round(e/t*100)}%`}function Bde(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function i3(e){return typeof e=="number"}function iK(e){return i3(e)&&!isNaN(e)&&e>0}function sK(e,t){return i3(e)&&!isNaN(e)&&e<=t&&e>=0}function KGe(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${a8}\`.`}function YGe(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${a8} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Ude=Ode,XGe=zde;const s3=L.forwardRef(({className:e,value:t,...n},r)=>v.jsx(Ude,{ref:r,className:Xn("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...n,children:v.jsx(XGe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));s3.displayName=Ude.displayName;function JGe({isOpen:e,onClose:t,cap:n,onSuccess:r}){const a=QSe(),l=async()=>{try{await a.mutateAsync(n.id),r==null||r(),t()}catch(h){console.error("Error deleting cap:",h)}};return v.jsx(Gg,{open:e,onOpenChange:t,children:v.jsxs(km,{className:"sm:max-w-[400px]",children:[v.jsx(Im,{children:v.jsxs(Nm,{className:"flex items-center gap-2 text-destructive",children:[v.jsx(Os,{className:"w-5 h-5"}),"Delete Spending Cap"]})}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"flex items-start gap-3 p-4 bg-destructive/10 rounded-lg",children:[v.jsx(wF,{className:"w-5 h-5 text-destructive mt-0.5"}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium",children:"Are you sure you want to delete this spending cap?"}),v.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[v.jsxs("strong",{children:['"',n==null?void 0:n.name,'"']})," will be permanently removed and cannot be recovered."]})]})]}),v.jsxs("div",{className:"text-sm text-muted-foreground",children:[v.jsx("p",{children:"This action will:"}),v.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[v.jsx("li",{children:"Remove the spending cap from your account"}),v.jsx("li",{children:"Stop monitoring spending against this limit"}),v.jsx("li",{children:"Delete all associated analytics data"})]})]})]}),v.jsxs(i8,{children:[v.jsx($n,{type:"button",variant:"outline",onClick:t,children:"Cancel"}),v.jsx($n,{variant:"destructive",onClick:l,disabled:a.isPending,children:a.isPending?"Deleting...":"Delete Cap"})]})]})})}function QGe({cap:e,onUpdate:t}){const[n,r]=L.useState(!1),[a,l]=L.useState(!1),h=JSe(),i=(Q,ne)=>{const pe=Q/ne*100;return pe>=100?{status:"exceeded",color:"danger"}:pe>=80?{status:"warning",color:"warning"}:{status:"safe",color:"success"}},y=Q=>{const ne=Q.toLowerCase();return ne.includes("taco bell")||ne.includes("tacobell")?{icon:"",bgColor:"bg-purple-600",textColor:"text-white"}:ne.includes("starbucks")||ne.includes("starbucks coffee")?{icon:"",bgColor:"bg-green-600",textColor:"text-white"}:ne.includes("mcdonald")||ne.includes("mcdonalds")?{icon:"",bgColor:"bg-yellow-500",textColor:"text-white"}:ne.includes("subway")?{icon:"",bgColor:"bg-green-600",textColor:"text-white"}:ne.includes("chipotle")?{icon:"",bgColor:"bg-orange-600",textColor:"text-white"}:ne.includes("uber")||ne.includes("lyft")?{icon:"",bgColor:"bg-black",textColor:"text-white"}:ne.includes("amazon")?{icon:"",bgColor:"bg-orange-500",textColor:"text-white"}:ne.includes("regal")||ne.includes("regal cinemas")?{icon:"",bgColor:"bg-blue-700",textColor:"text-white"}:ne.includes("amc")||ne.includes("amc theaters")?{icon:"",bgColor:"bg-red-700",textColor:"text-white"}:ne.includes("virginia tech")||ne.includes("vt")||ne.includes("vtech")?{icon:"",bgColor:"bg-orange-700",textColor:"text-white"}:ne.includes("university")||ne.includes("college")||ne.includes("school")?{icon:"",bgColor:"bg-blue-800",textColor:"text-white"}:ne.includes("library")?{icon:"",bgColor:"bg-yellow-700",textColor:"text-white"}:ne.includes("electric")||ne.includes("power")||ne.includes("energy")||ne.includes("duke energy")||ne.includes("dominion")?{icon:"",bgColor:"bg-yellow-500",textColor:"text-black"}:ne.includes("water")||ne.includes("sewer")?{icon:"",bgColor:"bg-blue-500",textColor:"text-white"}:ne.includes("gas")||ne.includes("natural gas")?{icon:"",bgColor:"bg-orange-500",textColor:"text-white"}:ne.includes("internet")||ne.includes("wifi")||ne.includes("comcast")||ne.includes("verizon")?{icon:"",bgColor:"bg-blue-600",textColor:"text-white"}:ne.includes("phone")||ne.includes("cellular")||ne.includes("at&t")||ne.includes("t-mobile")?{icon:"",bgColor:"bg-purple-600",textColor:"text-white"}:null},x=Q=>{const ne=Q.toLowerCase();return ne.includes("entertainment")||ne.includes("movies")||ne.includes("streaming")?{icon:"",bgColor:"bg-purple-600",textColor:"text-white"}:ne.includes("grocery")||ne.includes("food")||ne.includes("dining")?{icon:"",bgColor:"bg-green-600",textColor:"text-white"}:ne.includes("transportation")||ne.includes("travel")?{icon:"",bgColor:"bg-blue-600",textColor:"text-white"}:ne.includes("utilities")||ne.includes("bills")?{icon:"",bgColor:"bg-yellow-500",textColor:"text-black"}:ne.includes("shopping")||ne.includes("retail")?{icon:"",bgColor:"bg-pink-600",textColor:"text-white"}:ne.includes("healthcare")||ne.includes("medical")?{icon:"",bgColor:"bg-red-600",textColor:"text-white"}:ne.includes("education")||ne.includes("school")?{icon:"",bgColor:"bg-blue-700",textColor:"text-white"}:ne.includes("gas")||ne.includes("fuel")?{icon:"",bgColor:"bg-yellow-500",textColor:"text-black"}:null},w=Q=>{switch(Q){case"MERCHANT":return bF;case"CATEGORY":return Wd;case"GLOBAL":return Tu;default:return Wd}},C=async()=>{try{await h.mutateAsync(e.id),t==null||t()}catch(Q){console.error("Error toggling cap:",Q)}},P=()=>{r(!1),t==null||t()},E=()=>{l(!1),t==null||t()},j=w(e.type),{status:D,color:B}=i(e.spent||0,e.limit),F=Math.min((e.spent||0)/e.limit*100,100),$=e.limit-(e.spent||0),H=e.type==="MERCHANT"&&e.merchant?y(e.merchant):null,J=e.type==="CATEGORY"&&e.category?x(e.category):null,ee=H||J;return v.jsxs(v.Fragment,{children:[v.jsx(ol.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:v.jsx(xr,{className:`${e.enabled?"card-gradient":"opacity-60"}`,children:v.jsxs(br,{className:"p-6",children:[v.jsxs("div",{className:"flex items-center justify-between mb-4",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[ee?v.jsx("div",{className:`p-2 rounded-lg ${ee.bgColor} ${ee.textColor} flex items-center justify-center w-8 h-8`,children:v.jsx("span",{className:"text-lg",children:ee.icon})}):v.jsx("div",{className:`p-2 rounded-lg ${B==="danger"?"bg-danger/10":B==="warning"?"bg-warning/10":"bg-success/10"}`,children:v.jsx(j,{className:`w-5 h-5 ${B==="danger"?"text-danger":B==="warning"?"text-warning":"text-success"}`})}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-semibold",children:e.name}),v.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[v.jsx(Is,{variant:"outline",className:"text-xs",children:e.type.charAt(0).toUpperCase()+e.type.slice(1).toLowerCase()}),v.jsx("span",{children:""}),v.jsx(EA,{className:"w-3 h-3"}),v.jsx("span",{children:e.period.charAt(0).toUpperCase()+e.period.slice(1).toLowerCase()}),e.category&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsx("span",{children:e.category})]}),e.merchant&&v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""}),v.jsx("span",{children:e.merchant})]})]})]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("div",{className:"text-right mr-4",children:[v.jsxs("p",{className:"text-sm text-muted-foreground",children:["$",(e.spent||0).toFixed(2)," / $",e.limit.toFixed(2)]}),v.jsxs("p",{className:`text-sm font-medium ${B==="danger"?"text-danger":B==="warning"?"text-warning":"text-success"}`,children:[F.toFixed(0),"% used"]})]}),v.jsx($n,{variant:"ghost",size:"sm",onClick:C,disabled:h.isPending,children:e.enabled?v.jsx(uxe,{className:"w-5 h-5 text-primary"}):v.jsx(cxe,{className:"w-5 h-5 text-muted-foreground"})}),v.jsx($n,{variant:"ghost",size:"sm",onClick:()=>r(!0),children:v.jsx(lxe,{className:"w-4 h-4"})}),v.jsx($n,{variant:"ghost",size:"sm",onClick:()=>l(!0),children:v.jsx(wF,{className:"w-4 h-4"})})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(s3,{value:F,className:`h-2 ${B==="danger"?"[&>div]:bg-danger":B==="warning"?"[&>div]:bg-warning":"[&>div]:bg-success"}`}),D==="exceeded"&&v.jsxs("div",{className:"flex items-center gap-2 text-sm text-danger",children:[v.jsx(Os,{className:"w-4 h-4"}),"Cap exceeded by $",Math.abs($).toFixed(2)]}),D==="warning"&&v.jsxs("div",{className:"flex items-center gap-2 text-sm text-warning",children:[v.jsx(Os,{className:"w-4 h-4"}),"Approaching limit - $",$.toFixed(2)," remaining"]}),D==="safe"&&v.jsxs("div",{className:"flex items-center gap-2 text-sm text-success",children:[v.jsx(wl,{className:"w-4 h-4"}),"$",$.toFixed(2)," remaining"]})]})]})})}),v.jsx(jde,{isOpen:n,onClose:()=>r(!1),cap:e,onSuccess:P}),v.jsx(JGe,{isOpen:a,onClose:()=>l(!1),cap:e,onSuccess:E})]})}function eHe(){const[e,t]=L.useState(!1),{data:n=[],isLoading:r,refetch:a}=KSe(),{checkSpendingAlerts:l}=E5(),h=()=>{t(!1),a()},i=()=>{a()};L.useEffect(()=>{if(n.length>0){const j={"Food & Dining":450,Shopping:320,Transportation:180,Entertainment:120,Utilities:150};n.forEach(D=>{const B=j[D.category]||0;l(B,[D])})}},[n,l]);const y=n.filter(j=>j.enabled),x=n.filter(j=>{const D=(j.spent||0)/j.limit*100;return j.enabled&&D>=80&&D<100}),w=n.filter(j=>{const D=(j.spent||0)/j.limit*100;return j.enabled&&D>=100}),C=n.filter(j=>{const D=(j.spent||0)/j.limit*100;return j.enabled&&D<80}),P=n.reduce((j,D)=>{const B=D.limit-(D.spent||0);return j+Math.max(0,B)},0),E=n.length>0?n.reduce((j,D)=>{const B=(D.spent||0)/D.limit*100;return j+Math.min(B,100)},0)/n.length:0;return v.jsxs(ol.div,{className:"h-full min-h-screen space-y-6 p-6",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("h1",{className:"text-3xl font-bold",children:"Spending Caps"}),v.jsx("p",{className:"text-muted-foreground",children:"Manage your spending limits and financial rules"})]}),v.jsxs($n,{className:"flex items-center gap-2",onClick:()=>t(!0),children:[v.jsx(Yb,{className:"w-4 h-4"}),"Add New Cap"]})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[v.jsx(xr,{className:"card-gradient",children:v.jsx(br,{className:"p-6",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:v.jsx("span",{className:"text-2xl",children:""})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Caps"}),v.jsx("p",{className:"text-2xl font-bold",children:y.length})]})]})})}),v.jsx(xr,{className:"card-gradient",children:v.jsx(br,{className:"p-6",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"p-2 bg-warning/10 rounded-lg",children:v.jsx("span",{className:"text-2xl",children:""})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-sm text-muted-foreground",children:"At Risk"}),v.jsx("p",{className:"text-2xl font-bold",children:x.length})]})]})})}),v.jsx(xr,{className:"card-gradient",children:v.jsx(br,{className:"p-6",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"p-2 bg-success/10 rounded-lg",children:v.jsx("span",{className:"text-2xl",children:""})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-sm text-muted-foreground",children:"On Track"}),v.jsx("p",{className:"text-2xl font-bold",children:C.length})]})]})})}),v.jsx(xr,{className:"card-gradient",children:v.jsx(br,{className:"p-6",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:v.jsx("span",{className:"text-2xl",children:""})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Saved"}),v.jsxs("p",{className:"text-2xl font-bold",children:["$",P.toFixed(0)]})]})]})})})]}),r?v.jsx("div",{className:"flex items-center justify-center py-12",children:v.jsx(J0,{className:"w-8 h-8 animate-spin"})}):n.length===0?v.jsx(xr,{className:"card-gradient",children:v.jsxs(br,{className:"p-12 text-center",children:[v.jsx(Wd,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),v.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Spending Caps Yet"}),v.jsx("p",{className:"text-muted-foreground mb-4",children:"Create your first spending cap to start managing your finances better."}),v.jsxs($n,{onClick:()=>t(!0),children:[v.jsx(Yb,{className:"w-4 h-4 mr-2"}),"Add Your First Cap"]})]})}):v.jsx("div",{className:"grid gap-4",children:n.map(j=>v.jsx(QGe,{cap:j,onUpdate:i},j.id))}),n.length>0&&v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsx(di,{children:"Cap Analytics"})}),v.jsx(br,{children:v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[v.jsxs("div",{className:"text-center",children:[v.jsxs("h3",{className:"text-2xl font-bold text-success",children:["$",P.toFixed(0)]}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Savings This Period"})]}),v.jsxs("div",{className:"text-center",children:[v.jsxs("h3",{className:"text-2xl font-bold text-primary",children:[E.toFixed(0),"%"]}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"Average Cap Adherence"})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("h3",{className:"text-2xl font-bold text-warning",children:w.length}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"Caps Exceeded This Period"})]})]})})]}),v.jsx(jde,{isOpen:e,onClose:()=>t(!1),onSuccess:h})]})}const tHe=kx("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),wp=L.forwardRef(({className:e,variant:t,...n},r)=>v.jsx("div",{ref:r,role:"alert",className:Xn(tHe({variant:t}),e),...n}));wp.displayName="Alert";const nHe=L.forwardRef(({className:e,...t},n)=>v.jsx("h5",{ref:n,className:Xn("mb-1 font-medium leading-none tracking-tight",e),...t}));nHe.displayName="AlertTitle";const Sp=L.forwardRef(({className:e,...t},n)=>v.jsx("div",{ref:n,className:Xn("text-sm [&_p]:leading-relaxed",e),...t}));Sp.displayName="AlertDescription";const rHe="modulepreload",iHe=function(e){return"/vthacksproject/"+e},aK={},A4=function(t,n,r){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),i=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));a=Promise.allSettled(n.map(y=>{if(y=iHe(y),y in aK)return;aK[y]=!0;const x=y.endsWith(".css"),w=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${w}`))return;const C=document.createElement("link");if(C.rel=x?"stylesheet":rHe,x||(C.as="script"),C.crossOrigin="",C.href=y,i&&C.setAttribute("nonce",i),document.head.appendChild(C),x)return new Promise((P,E)=>{C.addEventListener("load",P),C.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${y}`)))})}))}function l(h){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=h,window.dispatchEvent(i),!i.defaultPrevented)throw h}return a.then(h=>{for(const i of h||[])i.status==="rejected"&&l(i.reason);return t().catch(l)})};function Da(e){"@babel/helpers - typeof";return Da=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Da(e)}var kp=Uint8Array,Sh=Uint16Array,o8=Int32Array,l8=new kp([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),c8=new kp([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),oK=new kp([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Vde=function(e,t){for(var n=new Sh(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var a=new o8(n[30]),r=1;r<30;++r)for(var l=n[r];l<n[r+1];++l)a[l]=l-n[r]<<5|r;return{b:n,r:a}},$de=Vde(l8,2),sHe=$de.b,Qj=$de.r;sHe[28]=258,Qj[258]=28;var aHe=Vde(c8,0),lK=aHe.r,eO=new Sh(32768);for(var Ao=0;Ao<32768;++Ao){var h0=(Ao&43690)>>1|(Ao&21845)<<1;h0=(h0&52428)>>2|(h0&13107)<<2,h0=(h0&61680)>>4|(h0&3855)<<4,eO[Ao]=((h0&65280)>>8|(h0&255)<<8)>>1}var sA=function(e,t,n){for(var r=e.length,a=0,l=new Sh(t);a<r;++a)e[a]&&++l[e[a]-1];var h=new Sh(t);for(a=1;a<t;++a)h[a]=h[a-1]+l[a-1]<<1;var i;if(n){i=new Sh(1<<t);var y=15-t;for(a=0;a<r;++a)if(e[a])for(var x=a<<4|e[a],w=t-e[a],C=h[e[a]-1]++<<w,P=C|(1<<w)-1;C<=P;++C)i[eO[C]>>y]=x}else for(i=new Sh(r),a=0;a<r;++a)e[a]&&(i[a]=eO[h[e[a]-1]++]>>15-e[a]);return i},Ax=new kp(288);for(var Ao=0;Ao<144;++Ao)Ax[Ao]=8;for(var Ao=144;Ao<256;++Ao)Ax[Ao]=9;for(var Ao=256;Ao<280;++Ao)Ax[Ao]=7;for(var Ao=280;Ao<288;++Ao)Ax[Ao]=8;var a3=new kp(32);for(var Ao=0;Ao<32;++Ao)a3[Ao]=5;var oHe=sA(Ax,9,0),lHe=sA(a3,5,0),qde=function(e){return(e+7)/8|0},cHe=function(e,t,n){return(n==null||n>e.length)&&(n=e.length),new kp(e.subarray(t,n))},kg=function(e,t,n){n<<=t&7;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8},xS=function(e,t,n){n<<=t&7;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8,e[r+2]|=n>>16},T4=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var a=n.length,l=n.slice();if(!a)return{t:Hde,l:0};if(a==1){var h=new kp(n[0].s+1);return h[n[0].s]=1,{t:h,l:1}}n.sort(function(ee,Q){return ee.f-Q.f}),n.push({s:-1,f:25001});var i=n[0],y=n[1],x=0,w=1,C=2;for(n[0]={s:-1,f:i.f+y.f,l:i,r:y};w!=a-1;)i=n[n[x].f<n[C].f?x++:C++],y=n[x!=w&&n[x].f<n[C].f?x++:C++],n[w++]={s:-1,f:i.f+y.f,l:i,r:y};for(var P=l[0].s,r=1;r<a;++r)l[r].s>P&&(P=l[r].s);var E=new Sh(P+1),j=tO(n[w-1],E,0);if(j>t){var r=0,D=0,B=j-t,F=1<<B;for(l.sort(function(Q,ne){return E[ne.s]-E[Q.s]||Q.f-ne.f});r<a;++r){var $=l[r].s;if(E[$]>t)D+=F-(1<<j-E[$]),E[$]=t;else break}for(D>>=B;D>0;){var H=l[r].s;E[H]<t?D-=1<<t-E[H]++-1:++r}for(;r>=0&&D;--r){var J=l[r].s;E[J]==t&&(--E[J],++D)}j=t}return{t:new kp(E),l:j}},tO=function(e,t,n){return e.s==-1?Math.max(tO(e.l,t,n+1),tO(e.r,t,n+1)):t[e.s]=n},cK=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new Sh(++t),r=0,a=e[0],l=1,h=function(y){n[r++]=y},i=1;i<=t;++i)if(e[i]==a&&i!=t)++l;else{if(!a&&l>2){for(;l>138;l-=138)h(32754);l>2&&(h(l>10?l-11<<5|28690:l-3<<5|12305),l=0)}else if(l>3){for(h(a),--l;l>6;l-=6)h(8304);l>2&&(h(l-3<<5|8208),l=0)}for(;l--;)h(a);l=1,a=e[i]}return{c:n.subarray(0,r),n:t}},bS=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},Gde=function(e,t,n){var r=n.length,a=qde(t+2);e[a]=r&255,e[a+1]=r>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var l=0;l<r;++l)e[a+l+4]=n[l];return(a+4+r)*8},uK=function(e,t,n,r,a,l,h,i,y,x,w){kg(t,w++,n),++a[256];for(var C=T4(a,15),P=C.t,E=C.l,j=T4(l,15),D=j.t,B=j.l,F=cK(P),$=F.c,H=F.n,J=cK(D),ee=J.c,Q=J.n,ne=new Sh(19),pe=0;pe<$.length;++pe)++ne[$[pe]&31];for(var pe=0;pe<ee.length;++pe)++ne[ee[pe]&31];for(var he=T4(ne,7),we=he.t,fe=he.l,ge=19;ge>4&&!we[oK[ge-1]];--ge);var Ce=x+5<<3,xe=bS(a,Ax)+bS(l,a3)+h,Re=bS(a,P)+bS(l,D)+h+14+3*ge+bS(ne,we)+2*ne[16]+3*ne[17]+7*ne[18];if(y>=0&&Ce<=xe&&Ce<=Re)return Gde(t,w,e.subarray(y,y+x));var Qe,et,je,De;if(kg(t,w,1+(Re<xe)),w+=2,Re<xe){Qe=sA(P,E,0),et=P,je=sA(D,B,0),De=D;var Ct=sA(we,fe,0);kg(t,w,H-257),kg(t,w+5,Q-1),kg(t,w+10,ge-4),w+=14;for(var pe=0;pe<ge;++pe)kg(t,w+3*pe,we[oK[pe]]);w+=3*ge;for(var xt=[$,ee],me=0;me<2;++me)for(var Ye=xt[me],pe=0;pe<Ye.length;++pe){var nt=Ye[pe]&31;kg(t,w,Ct[nt]),w+=we[nt],nt>15&&(kg(t,w,Ye[pe]>>5&127),w+=Ye[pe]>>12)}}else Qe=oHe,et=Ax,je=lHe,De=a3;for(var pe=0;pe<i;++pe){var vt=r[pe];if(vt>255){var nt=vt>>18&31;xS(t,w,Qe[nt+257]),w+=et[nt+257],nt>7&&(kg(t,w,vt>>23&31),w+=l8[nt]);var gt=vt&31;xS(t,w,je[gt]),w+=De[gt],gt>3&&(xS(t,w,vt>>5&8191),w+=c8[gt])}else xS(t,w,Qe[vt]),w+=et[vt]}return xS(t,w,Qe[256]),w+et[256]},uHe=new o8([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Hde=new kp(0),dHe=function(e,t,n,r,a,l){var h=l.z||e.length,i=new kp(r+h+5*(1+Math.ceil(h/7e3))+a),y=i.subarray(r,i.length-a),x=l.l,w=(l.r||0)&7;if(t){w&&(y[0]=l.r>>3);for(var C=uHe[t-1],P=C>>13,E=C&8191,j=(1<<n)-1,D=l.p||new Sh(32768),B=l.h||new Sh(j+1),F=Math.ceil(n/3),$=2*F,H=function(Kt){return(e[Kt]^e[Kt+1]<<F^e[Kt+2]<<$)&j},J=new o8(25e3),ee=new Sh(288),Q=new Sh(32),ne=0,pe=0,he=l.i||0,we=0,fe=l.w||0,ge=0;he+2<h;++he){var Ce=H(he),xe=he&32767,Re=B[Ce];if(D[xe]=Re,B[Ce]=xe,fe<=he){var Qe=h-he;if((ne>7e3||we>24576)&&(Qe>423||!x)){w=uK(e,y,0,J,ee,Q,pe,we,ge,he-ge,w),we=ne=pe=0,ge=he;for(var et=0;et<286;++et)ee[et]=0;for(var et=0;et<30;++et)Q[et]=0}var je=2,De=0,Ct=E,xt=xe-Re&32767;if(Qe>2&&Ce==H(he-xt))for(var me=Math.min(P,Qe)-1,Ye=Math.min(32767,he),nt=Math.min(258,Qe);xt<=Ye&&--Ct&&xe!=Re;){if(e[he+je]==e[he+je-xt]){for(var vt=0;vt<nt&&e[he+vt]==e[he+vt-xt];++vt);if(vt>je){if(je=vt,De=xt,vt>me)break;for(var gt=Math.min(xt,vt-2),dt=0,et=0;et<gt;++et){var At=he-xt+et&32767,mt=D[At],Pt=At-mt&32767;Pt>dt&&(dt=Pt,Re=At)}}}xe=Re,Re=D[xe],xt+=xe-Re&32767}if(De){J[we++]=268435456|Qj[je]<<18|lK[De];var Ht=Qj[je]&31,Ot=lK[De]&31;pe+=l8[Ht]+c8[Ot],++ee[257+Ht],++Q[Ot],fe=he+je,++ne}else J[we++]=e[he],++ee[e[he]]}}for(he=Math.max(he,fe);he<h;++he)J[we++]=e[he],++ee[e[he]];w=uK(e,y,x,J,ee,Q,pe,we,ge,he-ge,w),x||(l.r=w&7|y[w/8|0]<<3,w-=7,l.h=B,l.p=D,l.i=he,l.w=fe)}else{for(var he=l.w||0;he<h+x;he+=65535){var Un=he+65535;Un>=h&&(y[w/8|0]=x,Un=h),w=Gde(y,w+1,e.subarray(he,Un))}l.i=h}return cHe(i,0,r+qde(w)+a)},Wde=function(){var e=1,t=0;return{p:function(n){for(var r=e,a=t,l=n.length|0,h=0;h!=l;){for(var i=Math.min(h+2655,l);h<i;++h)a+=r+=n[h];r=(r&65535)+15*(r>>16),a=(a&65535)+15*(a>>16)}e=r,t=a},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},hHe=function(e,t,n,r,a){if(!a&&(a={l:1},t.dictionary)){var l=t.dictionary.subarray(-32768),h=new kp(l.length+e.length);h.set(l),h.set(e,l.length),e=h,a.w=l.length}return dHe(e,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,n,r,a)},Zde=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},fHe=function(e,t){var n=t.level,r=n==0?0:n<6?1:n==9?3:2;if(e[0]=120,e[1]=r<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=Wde();a.p(t.dictionary),Zde(e,2,a.d())}};function nO(e,t){t||(t={});var n=Wde();n.p(e);var r=hHe(e,t,t.dictionary?6:2,4);return fHe(r,t),Zde(r,r.length-4,n.d()),r}var pHe=typeof TextDecoder<"u"&&new TextDecoder,mHe=0;try{pHe.decode(Hde,{stream:!0}),mHe=1}catch{}function gHe(e){if(Array.isArray(e))return e}function yHe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,a,l,h,i=[],y=!0,x=!1;try{if(l=(n=n.call(e)).next,t!==0)for(;!(y=(r=l.call(n)).done)&&(i.push(r.value),i.length!==t);y=!0);}catch(w){x=!0,a=w}finally{try{if(!y&&n.return!=null&&(h=n.return(),Object(h)!==h))return}finally{if(x)throw a}}return i}}function dK(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function vHe(e,t){if(e){if(typeof e=="string")return dK(e,t);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dK(e,t):void 0}}function _He(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hK(e,t){return gHe(e)||yHe(e,t)||vHe(e,t)||_He()}function fK(e,t="utf8"){return new TextDecoder(t).decode(e)}const xHe=new TextEncoder;function bHe(e){return xHe.encode(e)}const wHe=1024*8,SHe=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),C4={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class u8{constructor(t=wHe,n={}){ni(this,"buffer");ni(this,"byteLength");ni(this,"byteOffset");ni(this,"length");ni(this,"offset");ni(this,"lastWrittenByte");ni(this,"littleEndian");ni(this,"_data");ni(this,"_mark");ni(this,"_marks");let r=!1;typeof t=="number"?t=new ArrayBuffer(t):(r=!0,this.lastWrittenByte=t.byteLength);const a=n.offset?n.offset>>>0:0,l=t.byteLength-a;let h=a;(ArrayBuffer.isView(t)||t instanceof u8)&&(t.byteLength!==t.buffer.byteLength&&(h=t.byteOffset+a),t=t.buffer),r?this.lastWrittenByte=l:this.lastWrittenByte=0,this.buffer=t,this.length=l,this.byteLength=l,this.byteOffset=h,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,h,l),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const r=(this.offset+t)*2,a=new Uint8Array(r);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=r,this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,n){const r=C4[n].BYTES_PER_ELEMENT*t,a=this.byteOffset+this.offset,l=this.buffer.slice(a,a+r);if(this.littleEndian===SHe&&n!=="uint8"&&n!=="int8"){const i=new Uint8Array(this.buffer.slice(a,a+r));i.reverse();const y=new C4[n](i.buffer);return this.offset+=r,y.reverse(),y}const h=new C4[n](l);return this.offset+=r,h}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let n="";for(let r=0;r<t;r++)n+=this.readChar();return n}readUtf8(t=1){return fK(this.readBytes(t))}decodeText(t=1,n="utf8"){return fK(this.readBytes(t),n)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let n=0;n<t.length;n++)this._data.setUint8(this.offset++,t[n]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let n=0;n<t.length;n++)this.writeUint8(t.charCodeAt(n));return this}writeUtf8(t){return this.writeBytes(bHe(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const AHe=4,pK=0,mK=1,THe=2;function Hw(e){let t=e.length;for(;--t>=0;)e[t]=0}const CHe=0,Kde=1,EHe=2,PHe=3,kHe=258,d8=29,uT=256,r5=uT+1+d8,Ab=30,h8=19,Yde=2*r5+1,j_=15,E4=16,IHe=7,f8=256,Xde=16,Jde=17,Qde=18,rO=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),aP=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),NHe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),ehe=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),MHe=512,Dg=new Array((r5+2)*2);Hw(Dg);const aA=new Array(Ab*2);Hw(aA);const i5=new Array(MHe);Hw(i5);const s5=new Array(kHe-PHe+1);Hw(s5);const p8=new Array(d8);Hw(p8);const o3=new Array(Ab);Hw(o3);function P4(e,t,n,r,a){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=a,this.has_stree=e&&e.length}let the,nhe,rhe;function k4(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const ihe=e=>e<256?i5[e]:i5[256+(e>>>7)],a5=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},$d=(e,t,n)=>{e.bi_valid>E4-n?(e.bi_buf|=t<<e.bi_valid&65535,a5(e,e.bi_buf),e.bi_buf=t>>E4-e.bi_valid,e.bi_valid+=n-E4):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},Tm=(e,t,n)=>{$d(e,n[t*2],n[t*2+1])},she=(e,t)=>{let n=0;do n|=e&1,e>>>=1,n<<=1;while(--t>0);return n>>>1},LHe=e=>{e.bi_valid===16?(a5(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},DHe=(e,t)=>{const n=t.dyn_tree,r=t.max_code,a=t.stat_desc.static_tree,l=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,i=t.stat_desc.extra_base,y=t.stat_desc.max_length;let x,w,C,P,E,j,D=0;for(P=0;P<=j_;P++)e.bl_count[P]=0;for(n[e.heap[e.heap_max]*2+1]=0,x=e.heap_max+1;x<Yde;x++)w=e.heap[x],P=n[n[w*2+1]*2+1]+1,P>y&&(P=y,D++),n[w*2+1]=P,!(w>r)&&(e.bl_count[P]++,E=0,w>=i&&(E=h[w-i]),j=n[w*2],e.opt_len+=j*(P+E),l&&(e.static_len+=j*(a[w*2+1]+E)));if(D!==0){do{for(P=y-1;e.bl_count[P]===0;)P--;e.bl_count[P]--,e.bl_count[P+1]+=2,e.bl_count[y]--,D-=2}while(D>0);for(P=y;P!==0;P--)for(w=e.bl_count[P];w!==0;)C=e.heap[--x],!(C>r)&&(n[C*2+1]!==P&&(e.opt_len+=(P-n[C*2+1])*n[C*2],n[C*2+1]=P),w--)}},ahe=(e,t,n)=>{const r=new Array(j_+1);let a=0,l,h;for(l=1;l<=j_;l++)a=a+n[l-1]<<1,r[l]=a;for(h=0;h<=t;h++){let i=e[h*2+1];i!==0&&(e[h*2]=she(r[i]++,i))}},RHe=()=>{let e,t,n,r,a;const l=new Array(j_+1);for(n=0,r=0;r<d8-1;r++)for(p8[r]=n,e=0;e<1<<rO[r];e++)s5[n++]=r;for(s5[n-1]=r,a=0,r=0;r<16;r++)for(o3[r]=a,e=0;e<1<<aP[r];e++)i5[a++]=r;for(a>>=7;r<Ab;r++)for(o3[r]=a<<7,e=0;e<1<<aP[r]-7;e++)i5[256+a++]=r;for(t=0;t<=j_;t++)l[t]=0;for(e=0;e<=143;)Dg[e*2+1]=8,e++,l[8]++;for(;e<=255;)Dg[e*2+1]=9,e++,l[9]++;for(;e<=279;)Dg[e*2+1]=7,e++,l[7]++;for(;e<=287;)Dg[e*2+1]=8,e++,l[8]++;for(ahe(Dg,r5+1,l),e=0;e<Ab;e++)aA[e*2+1]=5,aA[e*2]=she(e,5);the=new P4(Dg,rO,uT+1,r5,j_),nhe=new P4(aA,aP,0,Ab,j_),rhe=new P4(new Array(0),NHe,0,h8,IHe)},ohe=e=>{let t;for(t=0;t<r5;t++)e.dyn_ltree[t*2]=0;for(t=0;t<Ab;t++)e.dyn_dtree[t*2]=0;for(t=0;t<h8;t++)e.bl_tree[t*2]=0;e.dyn_ltree[f8*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},lhe=e=>{e.bi_valid>8?a5(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},gK=(e,t,n,r)=>{const a=t*2,l=n*2;return e[a]<e[l]||e[a]===e[l]&&r[t]<=r[n]},I4=(e,t,n)=>{const r=e.heap[n];let a=n<<1;for(;a<=e.heap_len&&(a<e.heap_len&&gK(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!gK(t,r,e.heap[a],e.depth));)e.heap[n]=e.heap[a],n=a,a<<=1;e.heap[n]=r},yK=(e,t,n)=>{let r,a,l=0,h,i;if(e.sym_next!==0)do r=e.pending_buf[e.sym_buf+l++]&255,r+=(e.pending_buf[e.sym_buf+l++]&255)<<8,a=e.pending_buf[e.sym_buf+l++],r===0?Tm(e,a,t):(h=s5[a],Tm(e,h+uT+1,t),i=rO[h],i!==0&&(a-=p8[h],$d(e,a,i)),r--,h=ihe(r),Tm(e,h,n),i=aP[h],i!==0&&(r-=o3[h],$d(e,r,i)));while(l<e.sym_next);Tm(e,f8,t)},iO=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,a=t.stat_desc.has_stree,l=t.stat_desc.elems;let h,i,y=-1,x;for(e.heap_len=0,e.heap_max=Yde,h=0;h<l;h++)n[h*2]!==0?(e.heap[++e.heap_len]=y=h,e.depth[h]=0):n[h*2+1]=0;for(;e.heap_len<2;)x=e.heap[++e.heap_len]=y<2?++y:0,n[x*2]=1,e.depth[x]=0,e.opt_len--,a&&(e.static_len-=r[x*2+1]);for(t.max_code=y,h=e.heap_len>>1;h>=1;h--)I4(e,n,h);x=l;do h=e.heap[1],e.heap[1]=e.heap[e.heap_len--],I4(e,n,1),i=e.heap[1],e.heap[--e.heap_max]=h,e.heap[--e.heap_max]=i,n[x*2]=n[h*2]+n[i*2],e.depth[x]=(e.depth[h]>=e.depth[i]?e.depth[h]:e.depth[i])+1,n[h*2+1]=n[i*2+1]=x,e.heap[1]=x++,I4(e,n,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],DHe(e,t),ahe(n,y,e.bl_count)},vK=(e,t,n)=>{let r,a=-1,l,h=t[0*2+1],i=0,y=7,x=4;for(h===0&&(y=138,x=3),t[(n+1)*2+1]=65535,r=0;r<=n;r++)l=h,h=t[(r+1)*2+1],!(++i<y&&l===h)&&(i<x?e.bl_tree[l*2]+=i:l!==0?(l!==a&&e.bl_tree[l*2]++,e.bl_tree[Xde*2]++):i<=10?e.bl_tree[Jde*2]++:e.bl_tree[Qde*2]++,i=0,a=l,h===0?(y=138,x=3):l===h?(y=6,x=3):(y=7,x=4))},_K=(e,t,n)=>{let r,a=-1,l,h=t[0*2+1],i=0,y=7,x=4;for(h===0&&(y=138,x=3),r=0;r<=n;r++)if(l=h,h=t[(r+1)*2+1],!(++i<y&&l===h)){if(i<x)do Tm(e,l,e.bl_tree);while(--i!==0);else l!==0?(l!==a&&(Tm(e,l,e.bl_tree),i--),Tm(e,Xde,e.bl_tree),$d(e,i-3,2)):i<=10?(Tm(e,Jde,e.bl_tree),$d(e,i-3,3)):(Tm(e,Qde,e.bl_tree),$d(e,i-11,7));i=0,a=l,h===0?(y=138,x=3):l===h?(y=6,x=3):(y=7,x=4)}},jHe=e=>{let t;for(vK(e,e.dyn_ltree,e.l_desc.max_code),vK(e,e.dyn_dtree,e.d_desc.max_code),iO(e,e.bl_desc),t=h8-1;t>=3&&e.bl_tree[ehe[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},OHe=(e,t,n,r)=>{let a;for($d(e,t-257,5),$d(e,n-1,5),$d(e,r-4,4),a=0;a<r;a++)$d(e,e.bl_tree[ehe[a]*2+1],3);_K(e,e.dyn_ltree,t-1),_K(e,e.dyn_dtree,n-1)},FHe=e=>{let t=4093624447,n;for(n=0;n<=31;n++,t>>>=1)if(t&1&&e.dyn_ltree[n*2]!==0)return pK;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return mK;for(n=32;n<uT;n++)if(e.dyn_ltree[n*2]!==0)return mK;return pK};let xK=!1;const zHe=e=>{xK||(RHe(),xK=!0),e.l_desc=new k4(e.dyn_ltree,the),e.d_desc=new k4(e.dyn_dtree,nhe),e.bl_desc=new k4(e.bl_tree,rhe),e.bi_buf=0,e.bi_valid=0,ohe(e)},che=(e,t,n,r)=>{$d(e,(CHe<<1)+(r?1:0),3),lhe(e),a5(e,n),a5(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n},BHe=e=>{$d(e,Kde<<1,3),Tm(e,f8,Dg),LHe(e)},UHe=(e,t,n,r)=>{let a,l,h=0;e.level>0?(e.strm.data_type===THe&&(e.strm.data_type=FHe(e)),iO(e,e.l_desc),iO(e,e.d_desc),h=jHe(e),a=e.opt_len+3+7>>>3,l=e.static_len+3+7>>>3,l<=a&&(a=l)):a=l=n+5,n+4<=a&&t!==-1?che(e,t,n,r):e.strategy===AHe||l===a?($d(e,(Kde<<1)+(r?1:0),3),yK(e,Dg,aA)):($d(e,(EHe<<1)+(r?1:0),3),OHe(e,e.l_desc.max_code+1,e.d_desc.max_code+1,h+1),yK(e,e.dyn_ltree,e.dyn_dtree)),ohe(e),r&&lhe(e)},VHe=(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,t===0?e.dyn_ltree[n*2]++:(e.matches++,t--,e.dyn_ltree[(s5[n]+uT+1)*2]++,e.dyn_dtree[ihe(t)*2]++),e.sym_next===e.sym_end);var $He=zHe,qHe=che,GHe=UHe,HHe=VHe,WHe=BHe,ZHe={_tr_init:$He,_tr_stored_block:qHe,_tr_flush_block:GHe,_tr_tally:HHe,_tr_align:WHe};const KHe=(e,t,n,r)=>{let a=e&65535|0,l=e>>>16&65535|0,h=0;for(;n!==0;){h=n>2e3?2e3:n,n-=h;do a=a+t[r++]|0,l=l+a|0;while(--h);a%=65521,l%=65521}return a|l<<16|0};var o5=KHe;const YHe=()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},XHe=new Uint32Array(YHe()),JHe=(e,t,n,r)=>{const a=XHe,l=r+n;e^=-1;for(let h=r;h<l;h++)e=e>>>8^a[(e^t[h])&255];return e^-1};var Sc=JHe,yw={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},dT={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:QHe,_tr_stored_block:sO,_tr_flush_block:eWe,_tr_tally:rv,_tr_align:tWe}=ZHe,{Z_NO_FLUSH:iv,Z_PARTIAL_FLUSH:nWe,Z_FULL_FLUSH:rWe,Z_FINISH:ff,Z_BLOCK:bK,Z_OK:$c,Z_STREAM_END:wK,Z_STREAM_ERROR:Um,Z_DATA_ERROR:iWe,Z_BUF_ERROR:N4,Z_DEFAULT_COMPRESSION:sWe,Z_FILTERED:aWe,Z_HUFFMAN_ONLY:xE,Z_RLE:oWe,Z_FIXED:lWe,Z_DEFAULT_STRATEGY:cWe,Z_UNKNOWN:uWe,Z_DEFLATED:mN}=dT,dWe=9,hWe=15,fWe=8,pWe=29,mWe=256,aO=mWe+1+pWe,gWe=30,yWe=19,vWe=2*aO+1,_We=15,na=3,V0=258,Vm=V0+na+1,xWe=32,vw=42,m8=57,oO=69,lO=73,cO=91,uO=103,O_=113,OS=666,sd=1,Ww=2,Tx=3,Zw=4,bWe=3,F_=(e,t)=>(e.msg=yw[t],t),SK=e=>e*2-(e>4?9:0),E0=e=>{let t=e.length;for(;--t>=0;)e[t]=0},wWe=e=>{let t,n,r,a=e.w_size;t=e.hash_size,r=t;do n=e.head[--r],e.head[r]=n>=a?n-a:0;while(--t);t=a,r=t;do n=e.prev[--r],e.prev[r]=n>=a?n-a:0;while(--t)};let SWe=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask,sv=SWe;const ph=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),n!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,t.pending===0&&(t.pending_out=0))},Ah=(e,t)=>{eWe(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ph(e.strm)},Sa=(e,t)=>{e.pending_buf[e.pending++]=t},wS=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},dO=(e,t,n,r)=>{let a=e.avail_in;return a>r&&(a=r),a===0?0:(e.avail_in-=a,t.set(e.input.subarray(e.next_in,e.next_in+a),n),e.state.wrap===1?e.adler=o5(e.adler,t,a,n):e.state.wrap===2&&(e.adler=Sc(e.adler,t,a,n)),e.next_in+=a,e.total_in+=a,a)},uhe=(e,t)=>{let n=e.max_chain_length,r=e.strstart,a,l,h=e.prev_length,i=e.nice_match;const y=e.strstart>e.w_size-Vm?e.strstart-(e.w_size-Vm):0,x=e.window,w=e.w_mask,C=e.prev,P=e.strstart+V0;let E=x[r+h-1],j=x[r+h];e.prev_length>=e.good_match&&(n>>=2),i>e.lookahead&&(i=e.lookahead);do if(a=t,!(x[a+h]!==j||x[a+h-1]!==E||x[a]!==x[r]||x[++a]!==x[r+1])){r+=2,a++;do;while(x[++r]===x[++a]&&x[++r]===x[++a]&&x[++r]===x[++a]&&x[++r]===x[++a]&&x[++r]===x[++a]&&x[++r]===x[++a]&&x[++r]===x[++a]&&x[++r]===x[++a]&&r<P);if(l=V0-(P-r),r=P-V0,l>h){if(e.match_start=t,h=l,l>=i)break;E=x[r+h-1],j=x[r+h]}}while((t=C[t&w])>y&&--n!==0);return h<=e.lookahead?h:e.lookahead},_w=e=>{const t=e.w_size;let n,r,a;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Vm)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),wWe(e),r+=t),e.strm.avail_in===0)break;if(n=dO(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=na)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=sv(e,e.ins_h,e.window[a+1]);e.insert&&(e.ins_h=sv(e,e.ins_h,e.window[a+na-1]),e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<na)););}while(e.lookahead<Vm&&e.strm.avail_in!==0)},dhe=(e,t)=>{let n=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,r,a,l,h=0,i=e.strm.avail_in;do{if(r=65535,l=e.bi_valid+42>>3,e.strm.avail_out<l||(l=e.strm.avail_out-l,a=e.strstart-e.block_start,r>a+e.strm.avail_in&&(r=a+e.strm.avail_in),r>l&&(r=l),r<n&&(r===0&&t!==ff||t===iv||r!==a+e.strm.avail_in)))break;h=t===ff&&r===a+e.strm.avail_in?1:0,sO(e,0,0,h),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,ph(e.strm),a&&(a>r&&(a=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+a),e.strm.next_out),e.strm.next_out+=a,e.strm.avail_out-=a,e.strm.total_out+=a,e.block_start+=a,r-=a),r&&(dO(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(h===0);return i-=e.strm.avail_in,i&&(i>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=i&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-i,e.strm.next_in),e.strstart),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),h?Zw:t!==iv&&t!==ff&&e.strm.avail_in===0&&e.strstart===e.block_start?Ww:(l=e.window_size-e.strstart,e.strm.avail_in>l&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,l+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),l>e.strm.avail_in&&(l=e.strm.avail_in),l&&(dO(e.strm,e.window,e.strstart,l),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.high_water<e.strstart&&(e.high_water=e.strstart),l=e.bi_valid+42>>3,l=e.pending_buf_size-l>65535?65535:e.pending_buf_size-l,n=l>e.w_size?e.w_size:l,a=e.strstart-e.block_start,(a>=n||(a||t===ff)&&t!==iv&&e.strm.avail_in===0&&a<=l)&&(r=a>l?l:a,h=t===ff&&e.strm.avail_in===0&&r===a?1:0,sO(e,e.block_start,r,h),e.block_start+=r,ph(e.strm)),h?Tx:sd)},M4=(e,t)=>{let n,r;for(;;){if(e.lookahead<Vm){if(_w(e),e.lookahead<Vm&&t===iv)return sd;if(e.lookahead===0)break}if(n=0,e.lookahead>=na&&(e.ins_h=sv(e,e.ins_h,e.window[e.strstart+na-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),n!==0&&e.strstart-n<=e.w_size-Vm&&(e.match_length=uhe(e,n)),e.match_length>=na)if(r=rv(e,e.strstart-e.match_start,e.match_length-na),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=na){e.match_length--;do e.strstart++,e.ins_h=sv(e,e.ins_h,e.window[e.strstart+na-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=sv(e,e.ins_h,e.window[e.strstart+1]);else r=rv(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(Ah(e,!1),e.strm.avail_out===0))return sd}return e.insert=e.strstart<na-1?e.strstart:na-1,t===ff?(Ah(e,!0),e.strm.avail_out===0?Tx:Zw):e.sym_next&&(Ah(e,!1),e.strm.avail_out===0)?sd:Ww},N1=(e,t)=>{let n,r,a;for(;;){if(e.lookahead<Vm){if(_w(e),e.lookahead<Vm&&t===iv)return sd;if(e.lookahead===0)break}if(n=0,e.lookahead>=na&&(e.ins_h=sv(e,e.ins_h,e.window[e.strstart+na-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=na-1,n!==0&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-Vm&&(e.match_length=uhe(e,n),e.match_length<=5&&(e.strategy===aWe||e.match_length===na&&e.strstart-e.match_start>4096)&&(e.match_length=na-1)),e.prev_length>=na&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-na,r=rv(e,e.strstart-1-e.prev_match,e.prev_length-na),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=a&&(e.ins_h=sv(e,e.ins_h,e.window[e.strstart+na-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=na-1,e.strstart++,r&&(Ah(e,!1),e.strm.avail_out===0))return sd}else if(e.match_available){if(r=rv(e,0,e.window[e.strstart-1]),r&&Ah(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return sd}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=rv(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<na-1?e.strstart:na-1,t===ff?(Ah(e,!0),e.strm.avail_out===0?Tx:Zw):e.sym_next&&(Ah(e,!1),e.strm.avail_out===0)?sd:Ww},AWe=(e,t)=>{let n,r,a,l;const h=e.window;for(;;){if(e.lookahead<=V0){if(_w(e),e.lookahead<=V0&&t===iv)return sd;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=na&&e.strstart>0&&(a=e.strstart-1,r=h[a],r===h[++a]&&r===h[++a]&&r===h[++a])){l=e.strstart+V0;do;while(r===h[++a]&&r===h[++a]&&r===h[++a]&&r===h[++a]&&r===h[++a]&&r===h[++a]&&r===h[++a]&&r===h[++a]&&a<l);e.match_length=V0-(l-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=na?(n=rv(e,1,e.match_length-na),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=rv(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(Ah(e,!1),e.strm.avail_out===0))return sd}return e.insert=0,t===ff?(Ah(e,!0),e.strm.avail_out===0?Tx:Zw):e.sym_next&&(Ah(e,!1),e.strm.avail_out===0)?sd:Ww},TWe=(e,t)=>{let n;for(;;){if(e.lookahead===0&&(_w(e),e.lookahead===0)){if(t===iv)return sd;break}if(e.match_length=0,n=rv(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(Ah(e,!1),e.strm.avail_out===0))return sd}return e.insert=0,t===ff?(Ah(e,!0),e.strm.avail_out===0?Tx:Zw):e.sym_next&&(Ah(e,!1),e.strm.avail_out===0)?sd:Ww};function mm(e,t,n,r,a){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=a}const FS=[new mm(0,0,0,0,dhe),new mm(4,4,8,4,M4),new mm(4,5,16,8,M4),new mm(4,6,32,32,M4),new mm(4,4,16,16,N1),new mm(8,16,32,32,N1),new mm(8,16,128,128,N1),new mm(8,32,128,256,N1),new mm(32,128,258,1024,N1),new mm(32,258,258,4096,N1)],CWe=e=>{e.window_size=2*e.w_size,E0(e.head),e.max_lazy_match=FS[e.level].max_lazy,e.good_match=FS[e.level].good_length,e.nice_match=FS[e.level].nice_length,e.max_chain_length=FS[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=na-1,e.match_available=0,e.ins_h=0};function EWe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=mN,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(vWe*2),this.dyn_dtree=new Uint16Array((2*gWe+1)*2),this.bl_tree=new Uint16Array((2*yWe+1)*2),E0(this.dyn_ltree),E0(this.dyn_dtree),E0(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(_We+1),this.heap=new Uint16Array(2*aO+1),E0(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*aO+1),E0(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const hT=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==vw&&t.status!==m8&&t.status!==oO&&t.status!==lO&&t.status!==cO&&t.status!==uO&&t.status!==O_&&t.status!==OS?1:0},hhe=e=>{if(hT(e))return F_(e,Um);e.total_in=e.total_out=0,e.data_type=uWe;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?m8:t.wrap?vw:O_,e.adler=t.wrap===2?0:1,t.last_flush=-2,QHe(t),$c},fhe=e=>{const t=hhe(e);return t===$c&&CWe(e.state),t},PWe=(e,t)=>hT(e)||e.state.wrap!==2?Um:(e.state.gzhead=t,$c),phe=(e,t,n,r,a,l)=>{if(!e)return Um;let h=1;if(t===sWe&&(t=6),r<0?(h=0,r=-r):r>15&&(h=2,r-=16),a<1||a>dWe||n!==mN||r<8||r>15||t<0||t>9||l<0||l>lWe||r===8&&h!==1)return F_(e,Um);r===8&&(r=9);const i=new EWe;return e.state=i,i.strm=e,i.status=vw,i.wrap=h,i.gzhead=null,i.w_bits=r,i.w_size=1<<i.w_bits,i.w_mask=i.w_size-1,i.hash_bits=a+7,i.hash_size=1<<i.hash_bits,i.hash_mask=i.hash_size-1,i.hash_shift=~~((i.hash_bits+na-1)/na),i.window=new Uint8Array(i.w_size*2),i.head=new Uint16Array(i.hash_size),i.prev=new Uint16Array(i.w_size),i.lit_bufsize=1<<a+6,i.pending_buf_size=i.lit_bufsize*4,i.pending_buf=new Uint8Array(i.pending_buf_size),i.sym_buf=i.lit_bufsize,i.sym_end=(i.lit_bufsize-1)*3,i.level=t,i.strategy=l,i.method=n,fhe(e)},kWe=(e,t)=>phe(e,t,mN,hWe,fWe,cWe),IWe=(e,t)=>{if(hT(e)||t>bK||t<0)return e?F_(e,Um):Um;const n=e.state;if(!e.output||e.avail_in!==0&&!e.input||n.status===OS&&t!==ff)return F_(e,e.avail_out===0?N4:Um);const r=n.last_flush;if(n.last_flush=t,n.pending!==0){if(ph(e),e.avail_out===0)return n.last_flush=-1,$c}else if(e.avail_in===0&&SK(t)<=SK(r)&&t!==ff)return F_(e,N4);if(n.status===OS&&e.avail_in!==0)return F_(e,N4);if(n.status===vw&&n.wrap===0&&(n.status=O_),n.status===vw){let a=mN+(n.w_bits-8<<4)<<8,l=-1;if(n.strategy>=xE||n.level<2?l=0:n.level<6?l=1:n.level===6?l=2:l=3,a|=l<<6,n.strstart!==0&&(a|=xWe),a+=31-a%31,wS(n,a),n.strstart!==0&&(wS(n,e.adler>>>16),wS(n,e.adler&65535)),e.adler=1,n.status=O_,ph(e),n.pending!==0)return n.last_flush=-1,$c}if(n.status===m8){if(e.adler=0,Sa(n,31),Sa(n,139),Sa(n,8),n.gzhead)Sa(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Sa(n,n.gzhead.time&255),Sa(n,n.gzhead.time>>8&255),Sa(n,n.gzhead.time>>16&255),Sa(n,n.gzhead.time>>24&255),Sa(n,n.level===9?2:n.strategy>=xE||n.level<2?4:0),Sa(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(Sa(n,n.gzhead.extra.length&255),Sa(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=Sc(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=oO;else if(Sa(n,0),Sa(n,0),Sa(n,0),Sa(n,0),Sa(n,0),Sa(n,n.level===9?2:n.strategy>=xE||n.level<2?4:0),Sa(n,bWe),n.status=O_,ph(e),n.pending!==0)return n.last_flush=-1,$c}if(n.status===oO){if(n.gzhead.extra){let a=n.pending,l=(n.gzhead.extra.length&65535)-n.gzindex;for(;n.pending+l>n.pending_buf_size;){let i=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>a&&(e.adler=Sc(e.adler,n.pending_buf,n.pending-a,a)),n.gzindex+=i,ph(e),n.pending!==0)return n.last_flush=-1,$c;a=0,l-=i}let h=new Uint8Array(n.gzhead.extra);n.pending_buf.set(h.subarray(n.gzindex,n.gzindex+l),n.pending),n.pending+=l,n.gzhead.hcrc&&n.pending>a&&(e.adler=Sc(e.adler,n.pending_buf,n.pending-a,a)),n.gzindex=0}n.status=lO}if(n.status===lO){if(n.gzhead.name){let a=n.pending,l;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>a&&(e.adler=Sc(e.adler,n.pending_buf,n.pending-a,a)),ph(e),n.pending!==0)return n.last_flush=-1,$c;a=0}n.gzindex<n.gzhead.name.length?l=n.gzhead.name.charCodeAt(n.gzindex++)&255:l=0,Sa(n,l)}while(l!==0);n.gzhead.hcrc&&n.pending>a&&(e.adler=Sc(e.adler,n.pending_buf,n.pending-a,a)),n.gzindex=0}n.status=cO}if(n.status===cO){if(n.gzhead.comment){let a=n.pending,l;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>a&&(e.adler=Sc(e.adler,n.pending_buf,n.pending-a,a)),ph(e),n.pending!==0)return n.last_flush=-1,$c;a=0}n.gzindex<n.gzhead.comment.length?l=n.gzhead.comment.charCodeAt(n.gzindex++)&255:l=0,Sa(n,l)}while(l!==0);n.gzhead.hcrc&&n.pending>a&&(e.adler=Sc(e.adler,n.pending_buf,n.pending-a,a))}n.status=uO}if(n.status===uO){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(ph(e),n.pending!==0))return n.last_flush=-1,$c;Sa(n,e.adler&255),Sa(n,e.adler>>8&255),e.adler=0}if(n.status=O_,ph(e),n.pending!==0)return n.last_flush=-1,$c}if(e.avail_in!==0||n.lookahead!==0||t!==iv&&n.status!==OS){let a=n.level===0?dhe(n,t):n.strategy===xE?TWe(n,t):n.strategy===oWe?AWe(n,t):FS[n.level].func(n,t);if((a===Tx||a===Zw)&&(n.status=OS),a===sd||a===Tx)return e.avail_out===0&&(n.last_flush=-1),$c;if(a===Ww&&(t===nWe?tWe(n):t!==bK&&(sO(n,0,0,!1),t===rWe&&(E0(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),ph(e),e.avail_out===0))return n.last_flush=-1,$c}return t!==ff?$c:n.wrap<=0?wK:(n.wrap===2?(Sa(n,e.adler&255),Sa(n,e.adler>>8&255),Sa(n,e.adler>>16&255),Sa(n,e.adler>>24&255),Sa(n,e.total_in&255),Sa(n,e.total_in>>8&255),Sa(n,e.total_in>>16&255),Sa(n,e.total_in>>24&255)):(wS(n,e.adler>>>16),wS(n,e.adler&65535)),ph(e),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?$c:wK)},NWe=e=>{if(hT(e))return Um;const t=e.state.status;return e.state=null,t===O_?F_(e,iWe):$c},MWe=(e,t)=>{let n=t.length;if(hT(e))return Um;const r=e.state,a=r.wrap;if(a===2||a===1&&r.status!==vw||r.lookahead)return Um;if(a===1&&(e.adler=o5(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){a===0&&(E0(r.head),r.strstart=0,r.block_start=0,r.insert=0);let y=new Uint8Array(r.w_size);y.set(t.subarray(n-r.w_size,n),0),t=y,n=r.w_size}const l=e.avail_in,h=e.next_in,i=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,_w(r);r.lookahead>=na;){let y=r.strstart,x=r.lookahead-(na-1);do r.ins_h=sv(r,r.ins_h,r.window[y+na-1]),r.prev[y&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=y,y++;while(--x);r.strstart=y,r.lookahead=na-1,_w(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=na-1,r.match_available=0,e.next_in=h,e.input=i,e.avail_in=l,r.wrap=a,$c};var LWe=kWe,DWe=phe,RWe=fhe,jWe=hhe,OWe=PWe,FWe=IWe,zWe=NWe,BWe=MWe,UWe="pako deflate (from Nodeca project)",oA={deflateInit:LWe,deflateInit2:DWe,deflateReset:RWe,deflateResetKeep:jWe,deflateSetHeader:OWe,deflate:FWe,deflateEnd:zWe,deflateSetDictionary:BWe,deflateInfo:UWe};const VWe=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var $We=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)VWe(n,r)&&(e[r]=n[r])}}return e},qWe=e=>{let t=0;for(let r=0,a=e.length;r<a;r++)t+=e[r].length;const n=new Uint8Array(t);for(let r=0,a=0,l=e.length;r<l;r++){let h=e[r];n.set(h,a),a+=h.length}return n},gN={assign:$We,flattenChunks:qWe};let mhe=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{mhe=!1}const l5=new Uint8Array(256);for(let e=0;e<256;e++)l5[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;l5[254]=l5[254]=1;var GWe=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,n,r,a,l,h=e.length,i=0;for(a=0;a<h;a++)n=e.charCodeAt(a),(n&64512)===55296&&a+1<h&&(r=e.charCodeAt(a+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),a++)),i+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(i),l=0,a=0;l<i;a++)n=e.charCodeAt(a),(n&64512)===55296&&a+1<h&&(r=e.charCodeAt(a+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),a++)),n<128?t[l++]=n:n<2048?(t[l++]=192|n>>>6,t[l++]=128|n&63):n<65536?(t[l++]=224|n>>>12,t[l++]=128|n>>>6&63,t[l++]=128|n&63):(t[l++]=240|n>>>18,t[l++]=128|n>>>12&63,t[l++]=128|n>>>6&63,t[l++]=128|n&63);return t};const HWe=(e,t)=>{if(t<65534&&e.subarray&&mhe)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n};var WWe=(e,t)=>{const n=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let r,a;const l=new Array(n*2);for(a=0,r=0;r<n;){let h=e[r++];if(h<128){l[a++]=h;continue}let i=l5[h];if(i>4){l[a++]=65533,r+=i-1;continue}for(h&=i===2?31:i===3?15:7;i>1&&r<n;)h=h<<6|e[r++]&63,i--;if(i>1){l[a++]=65533;continue}h<65536?l[a++]=h:(h-=65536,l[a++]=55296|h>>10&1023,l[a++]=56320|h&1023)}return HWe(l,a)},ZWe=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(e[n]&192)===128;)n--;return n<0||n===0?t:n+l5[e[n]]>t?n:t},c5={string2buf:GWe,buf2string:WWe,utf8border:ZWe};function KWe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var ghe=KWe;const yhe=Object.prototype.toString,{Z_NO_FLUSH:YWe,Z_SYNC_FLUSH:XWe,Z_FULL_FLUSH:JWe,Z_FINISH:QWe,Z_OK:l3,Z_STREAM_END:eZe,Z_DEFAULT_COMPRESSION:tZe,Z_DEFAULT_STRATEGY:nZe,Z_DEFLATED:rZe}=dT;function g8(e){this.options=gN.assign({level:tZe,method:rZe,chunkSize:16384,windowBits:15,memLevel:8,strategy:nZe},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ghe,this.strm.avail_out=0;let n=oA.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==l3)throw new Error(yw[n]);if(t.header&&oA.deflateSetHeader(this.strm,t.header),t.dictionary){let r;if(typeof t.dictionary=="string"?r=c5.string2buf(t.dictionary):yhe.call(t.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(t.dictionary):r=t.dictionary,n=oA.deflateSetDictionary(this.strm,r),n!==l3)throw new Error(yw[n]);this._dict_set=!0}}g8.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let a,l;if(this.ended)return!1;for(t===~~t?l=t:l=t===!0?QWe:YWe,typeof e=="string"?n.input=c5.string2buf(e):yhe.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){if(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(l===XWe||l===JWe)&&n.avail_out<=6){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(a=oA.deflate(n,l),a===eZe)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),a=oA.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===l3;if(n.avail_out===0){this.onData(n.output);continue}if(l>0&&n.next_out>0){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(n.avail_in===0)break}return!0};g8.prototype.onData=function(e){this.chunks.push(e)};g8.prototype.onEnd=function(e){e===l3&&(this.result=gN.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};const bE=16209,iZe=16191;var sZe=function(t,n){let r,a,l,h,i,y,x,w,C,P,E,j,D,B,F,$,H,J,ee,Q,ne,pe,he,we;const fe=t.state;r=t.next_in,he=t.input,a=r+(t.avail_in-5),l=t.next_out,we=t.output,h=l-(n-t.avail_out),i=l+(t.avail_out-257),y=fe.dmax,x=fe.wsize,w=fe.whave,C=fe.wnext,P=fe.window,E=fe.hold,j=fe.bits,D=fe.lencode,B=fe.distcode,F=(1<<fe.lenbits)-1,$=(1<<fe.distbits)-1;e:do{j<15&&(E+=he[r++]<<j,j+=8,E+=he[r++]<<j,j+=8),H=D[E&F];t:for(;;){if(J=H>>>24,E>>>=J,j-=J,J=H>>>16&255,J===0)we[l++]=H&65535;else if(J&16){ee=H&65535,J&=15,J&&(j<J&&(E+=he[r++]<<j,j+=8),ee+=E&(1<<J)-1,E>>>=J,j-=J),j<15&&(E+=he[r++]<<j,j+=8,E+=he[r++]<<j,j+=8),H=B[E&$];n:for(;;){if(J=H>>>24,E>>>=J,j-=J,J=H>>>16&255,J&16){if(Q=H&65535,J&=15,j<J&&(E+=he[r++]<<j,j+=8,j<J&&(E+=he[r++]<<j,j+=8)),Q+=E&(1<<J)-1,Q>y){t.msg="invalid distance too far back",fe.mode=bE;break e}if(E>>>=J,j-=J,J=l-h,Q>J){if(J=Q-J,J>w&&fe.sane){t.msg="invalid distance too far back",fe.mode=bE;break e}if(ne=0,pe=P,C===0){if(ne+=x-J,J<ee){ee-=J;do we[l++]=P[ne++];while(--J);ne=l-Q,pe=we}}else if(C<J){if(ne+=x+C-J,J-=C,J<ee){ee-=J;do we[l++]=P[ne++];while(--J);if(ne=0,C<ee){J=C,ee-=J;do we[l++]=P[ne++];while(--J);ne=l-Q,pe=we}}}else if(ne+=C-J,J<ee){ee-=J;do we[l++]=P[ne++];while(--J);ne=l-Q,pe=we}for(;ee>2;)we[l++]=pe[ne++],we[l++]=pe[ne++],we[l++]=pe[ne++],ee-=3;ee&&(we[l++]=pe[ne++],ee>1&&(we[l++]=pe[ne++]))}else{ne=l-Q;do we[l++]=we[ne++],we[l++]=we[ne++],we[l++]=we[ne++],ee-=3;while(ee>2);ee&&(we[l++]=we[ne++],ee>1&&(we[l++]=we[ne++]))}}else if(J&64){t.msg="invalid distance code",fe.mode=bE;break e}else{H=B[(H&65535)+(E&(1<<J)-1)];continue n}break}}else if(J&64)if(J&32){fe.mode=iZe;break e}else{t.msg="invalid literal/length code",fe.mode=bE;break e}else{H=D[(H&65535)+(E&(1<<J)-1)];continue t}break}}while(r<a&&l<i);ee=j>>3,r-=ee,j-=ee<<3,E&=(1<<j)-1,t.next_in=r,t.next_out=l,t.avail_in=r<a?5+(a-r):5-(r-a),t.avail_out=l<i?257+(i-l):257-(l-i),fe.hold=E,fe.bits=j};const M1=15,AK=852,TK=592,CK=0,L4=1,EK=2,aZe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),oZe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),lZe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),cZe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),uZe=(e,t,n,r,a,l,h,i)=>{const y=i.bits;let x=0,w=0,C=0,P=0,E=0,j=0,D=0,B=0,F=0,$=0,H,J,ee,Q,ne,pe=null,he;const we=new Uint16Array(M1+1),fe=new Uint16Array(M1+1);let ge=null,Ce,xe,Re;for(x=0;x<=M1;x++)we[x]=0;for(w=0;w<r;w++)we[t[n+w]]++;for(E=y,P=M1;P>=1&&we[P]===0;P--);if(E>P&&(E=P),P===0)return a[l++]=1<<24|64<<16|0,a[l++]=1<<24|64<<16|0,i.bits=1,0;for(C=1;C<P&&we[C]===0;C++);for(E<C&&(E=C),B=1,x=1;x<=M1;x++)if(B<<=1,B-=we[x],B<0)return-1;if(B>0&&(e===CK||P!==1))return-1;for(fe[1]=0,x=1;x<M1;x++)fe[x+1]=fe[x]+we[x];for(w=0;w<r;w++)t[n+w]!==0&&(h[fe[t[n+w]]++]=w);if(e===CK?(pe=ge=h,he=20):e===L4?(pe=aZe,ge=oZe,he=257):(pe=lZe,ge=cZe,he=0),$=0,w=0,x=C,ne=l,j=E,D=0,ee=-1,F=1<<E,Q=F-1,e===L4&&F>AK||e===EK&&F>TK)return 1;for(;;){Ce=x-D,h[w]+1<he?(xe=0,Re=h[w]):h[w]>=he?(xe=ge[h[w]-he],Re=pe[h[w]-he]):(xe=96,Re=0),H=1<<x-D,J=1<<j,C=J;do J-=H,a[ne+($>>D)+J]=Ce<<24|xe<<16|Re|0;while(J!==0);for(H=1<<x-1;$&H;)H>>=1;if(H!==0?($&=H-1,$+=H):$=0,w++,--we[x]===0){if(x===P)break;x=t[n+h[w]]}if(x>E&&($&Q)!==ee){for(D===0&&(D=E),ne+=C,j=x-D,B=1<<j;j+D<P&&(B-=we[j+D],!(B<=0));)j++,B<<=1;if(F+=1<<j,e===L4&&F>AK||e===EK&&F>TK)return 1;ee=$&Q,a[ee]=E<<24|j<<16|ne-l|0}}return $!==0&&(a[ne+$]=x-D<<24|64<<16|0),i.bits=E,0};var lA=uZe;const dZe=0,vhe=1,_he=2,{Z_FINISH:PK,Z_BLOCK:hZe,Z_TREES:wE,Z_OK:Cx,Z_STREAM_END:fZe,Z_NEED_DICT:pZe,Z_STREAM_ERROR:Cf,Z_DATA_ERROR:xhe,Z_MEM_ERROR:bhe,Z_BUF_ERROR:mZe,Z_DEFLATED:kK}=dT,yN=16180,IK=16181,NK=16182,MK=16183,LK=16184,DK=16185,RK=16186,jK=16187,OK=16188,FK=16189,c3=16190,Ig=16191,D4=16192,zK=16193,R4=16194,BK=16195,UK=16196,VK=16197,$K=16198,SE=16199,AE=16200,qK=16201,GK=16202,HK=16203,WK=16204,ZK=16205,j4=16206,KK=16207,YK=16208,Ro=16209,whe=16210,She=16211,gZe=852,yZe=592,vZe=15,_Ze=vZe,XK=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function xZe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const jx=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<yN||t.mode>She?1:0},Ahe=e=>{if(jx(e))return Cf;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=yN,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(gZe),t.distcode=t.distdyn=new Int32Array(yZe),t.sane=1,t.back=-1,Cx},The=e=>{if(jx(e))return Cf;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Ahe(e)},Che=(e,t)=>{let n;if(jx(e))return Cf;const r=e.state;return t<0?(n=0,t=-t):(n=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Cf:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,The(e))},Ehe=(e,t)=>{if(!e)return Cf;const n=new xZe;e.state=n,n.strm=e,n.window=null,n.mode=yN;const r=Che(e,t);return r!==Cx&&(e.state=null),r},bZe=e=>Ehe(e,_Ze);let JK=!0,O4,F4;const wZe=e=>{if(JK){O4=new Int32Array(512),F4=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(lA(vhe,e.lens,0,288,O4,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;lA(_he,e.lens,0,32,F4,0,e.work,{bits:5}),JK=!1}e.lencode=O4,e.lenbits=9,e.distcode=F4,e.distbits=5},Phe=(e,t,n,r)=>{let a;const l=e.state;return l.window===null&&(l.wsize=1<<l.wbits,l.wnext=0,l.whave=0,l.window=new Uint8Array(l.wsize)),r>=l.wsize?(l.window.set(t.subarray(n-l.wsize,n),0),l.wnext=0,l.whave=l.wsize):(a=l.wsize-l.wnext,a>r&&(a=r),l.window.set(t.subarray(n-r,n-r+a),l.wnext),r-=a,r?(l.window.set(t.subarray(n-r,n),0),l.wnext=r,l.whave=l.wsize):(l.wnext+=a,l.wnext===l.wsize&&(l.wnext=0),l.whave<l.wsize&&(l.whave+=a))),0},SZe=(e,t)=>{let n,r,a,l,h,i,y,x,w,C,P,E,j,D,B=0,F,$,H,J,ee,Q,ne,pe;const he=new Uint8Array(4);let we,fe;const ge=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(jx(e)||!e.output||!e.input&&e.avail_in!==0)return Cf;n=e.state,n.mode===Ig&&(n.mode=D4),h=e.next_out,a=e.output,y=e.avail_out,l=e.next_in,r=e.input,i=e.avail_in,x=n.hold,w=n.bits,C=i,P=y,pe=Cx;e:for(;;)switch(n.mode){case yN:if(n.wrap===0){n.mode=D4;break}for(;w<16;){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}if(n.wrap&2&&x===35615){n.wbits===0&&(n.wbits=15),n.check=0,he[0]=x&255,he[1]=x>>>8&255,n.check=Sc(n.check,he,2,0),x=0,w=0,n.mode=IK;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((x&255)<<8)+(x>>8))%31){e.msg="incorrect header check",n.mode=Ro;break}if((x&15)!==kK){e.msg="unknown compression method",n.mode=Ro;break}if(x>>>=4,w-=4,ne=(x&15)+8,n.wbits===0&&(n.wbits=ne),ne>15||ne>n.wbits){e.msg="invalid window size",n.mode=Ro;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=x&512?FK:Ig,x=0,w=0;break;case IK:for(;w<16;){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}if(n.flags=x,(n.flags&255)!==kK){e.msg="unknown compression method",n.mode=Ro;break}if(n.flags&57344){e.msg="unknown header flags set",n.mode=Ro;break}n.head&&(n.head.text=x>>8&1),n.flags&512&&n.wrap&4&&(he[0]=x&255,he[1]=x>>>8&255,n.check=Sc(n.check,he,2,0)),x=0,w=0,n.mode=NK;case NK:for(;w<32;){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}n.head&&(n.head.time=x),n.flags&512&&n.wrap&4&&(he[0]=x&255,he[1]=x>>>8&255,he[2]=x>>>16&255,he[3]=x>>>24&255,n.check=Sc(n.check,he,4,0)),x=0,w=0,n.mode=MK;case MK:for(;w<16;){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}n.head&&(n.head.xflags=x&255,n.head.os=x>>8),n.flags&512&&n.wrap&4&&(he[0]=x&255,he[1]=x>>>8&255,n.check=Sc(n.check,he,2,0)),x=0,w=0,n.mode=LK;case LK:if(n.flags&1024){for(;w<16;){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}n.length=x,n.head&&(n.head.extra_len=x),n.flags&512&&n.wrap&4&&(he[0]=x&255,he[1]=x>>>8&255,n.check=Sc(n.check,he,2,0)),x=0,w=0}else n.head&&(n.head.extra=null);n.mode=DK;case DK:if(n.flags&1024&&(E=n.length,E>i&&(E=i),E&&(n.head&&(ne=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(l,l+E),ne)),n.flags&512&&n.wrap&4&&(n.check=Sc(n.check,r,E,l)),i-=E,l+=E,n.length-=E),n.length))break e;n.length=0,n.mode=RK;case RK:if(n.flags&2048){if(i===0)break e;E=0;do ne=r[l+E++],n.head&&ne&&n.length<65536&&(n.head.name+=String.fromCharCode(ne));while(ne&&E<i);if(n.flags&512&&n.wrap&4&&(n.check=Sc(n.check,r,E,l)),i-=E,l+=E,ne)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=jK;case jK:if(n.flags&4096){if(i===0)break e;E=0;do ne=r[l+E++],n.head&&ne&&n.length<65536&&(n.head.comment+=String.fromCharCode(ne));while(ne&&E<i);if(n.flags&512&&n.wrap&4&&(n.check=Sc(n.check,r,E,l)),i-=E,l+=E,ne)break e}else n.head&&(n.head.comment=null);n.mode=OK;case OK:if(n.flags&512){for(;w<16;){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}if(n.wrap&4&&x!==(n.check&65535)){e.msg="header crc mismatch",n.mode=Ro;break}x=0,w=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Ig;break;case FK:for(;w<32;){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}e.adler=n.check=XK(x),x=0,w=0,n.mode=c3;case c3:if(n.havedict===0)return e.next_out=h,e.avail_out=y,e.next_in=l,e.avail_in=i,n.hold=x,n.bits=w,pZe;e.adler=n.check=1,n.mode=Ig;case Ig:if(t===hZe||t===wE)break e;case D4:if(n.last){x>>>=w&7,w-=w&7,n.mode=j4;break}for(;w<3;){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}switch(n.last=x&1,x>>>=1,w-=1,x&3){case 0:n.mode=zK;break;case 1:if(wZe(n),n.mode=SE,t===wE){x>>>=2,w-=2;break e}break;case 2:n.mode=UK;break;case 3:e.msg="invalid block type",n.mode=Ro}x>>>=2,w-=2;break;case zK:for(x>>>=w&7,w-=w&7;w<32;){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}if((x&65535)!==(x>>>16^65535)){e.msg="invalid stored block lengths",n.mode=Ro;break}if(n.length=x&65535,x=0,w=0,n.mode=R4,t===wE)break e;case R4:n.mode=BK;case BK:if(E=n.length,E){if(E>i&&(E=i),E>y&&(E=y),E===0)break e;a.set(r.subarray(l,l+E),h),i-=E,l+=E,y-=E,h+=E,n.length-=E;break}n.mode=Ig;break;case UK:for(;w<14;){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}if(n.nlen=(x&31)+257,x>>>=5,w-=5,n.ndist=(x&31)+1,x>>>=5,w-=5,n.ncode=(x&15)+4,x>>>=4,w-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=Ro;break}n.have=0,n.mode=VK;case VK:for(;n.have<n.ncode;){for(;w<3;){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}n.lens[ge[n.have++]]=x&7,x>>>=3,w-=3}for(;n.have<19;)n.lens[ge[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,we={bits:n.lenbits},pe=lA(dZe,n.lens,0,19,n.lencode,0,n.work,we),n.lenbits=we.bits,pe){e.msg="invalid code lengths set",n.mode=Ro;break}n.have=0,n.mode=$K;case $K:for(;n.have<n.nlen+n.ndist;){for(;B=n.lencode[x&(1<<n.lenbits)-1],F=B>>>24,$=B>>>16&255,H=B&65535,!(F<=w);){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}if(H<16)x>>>=F,w-=F,n.lens[n.have++]=H;else{if(H===16){for(fe=F+2;w<fe;){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}if(x>>>=F,w-=F,n.have===0){e.msg="invalid bit length repeat",n.mode=Ro;break}ne=n.lens[n.have-1],E=3+(x&3),x>>>=2,w-=2}else if(H===17){for(fe=F+3;w<fe;){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}x>>>=F,w-=F,ne=0,E=3+(x&7),x>>>=3,w-=3}else{for(fe=F+7;w<fe;){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}x>>>=F,w-=F,ne=0,E=11+(x&127),x>>>=7,w-=7}if(n.have+E>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=Ro;break}for(;E--;)n.lens[n.have++]=ne}}if(n.mode===Ro)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=Ro;break}if(n.lenbits=9,we={bits:n.lenbits},pe=lA(vhe,n.lens,0,n.nlen,n.lencode,0,n.work,we),n.lenbits=we.bits,pe){e.msg="invalid literal/lengths set",n.mode=Ro;break}if(n.distbits=6,n.distcode=n.distdyn,we={bits:n.distbits},pe=lA(_he,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,we),n.distbits=we.bits,pe){e.msg="invalid distances set",n.mode=Ro;break}if(n.mode=SE,t===wE)break e;case SE:n.mode=AE;case AE:if(i>=6&&y>=258){e.next_out=h,e.avail_out=y,e.next_in=l,e.avail_in=i,n.hold=x,n.bits=w,sZe(e,P),h=e.next_out,a=e.output,y=e.avail_out,l=e.next_in,r=e.input,i=e.avail_in,x=n.hold,w=n.bits,n.mode===Ig&&(n.back=-1);break}for(n.back=0;B=n.lencode[x&(1<<n.lenbits)-1],F=B>>>24,$=B>>>16&255,H=B&65535,!(F<=w);){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}if($&&!($&240)){for(J=F,ee=$,Q=H;B=n.lencode[Q+((x&(1<<J+ee)-1)>>J)],F=B>>>24,$=B>>>16&255,H=B&65535,!(J+F<=w);){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}x>>>=J,w-=J,n.back+=J}if(x>>>=F,w-=F,n.back+=F,n.length=H,$===0){n.mode=ZK;break}if($&32){n.back=-1,n.mode=Ig;break}if($&64){e.msg="invalid literal/length code",n.mode=Ro;break}n.extra=$&15,n.mode=qK;case qK:if(n.extra){for(fe=n.extra;w<fe;){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}n.length+=x&(1<<n.extra)-1,x>>>=n.extra,w-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=GK;case GK:for(;B=n.distcode[x&(1<<n.distbits)-1],F=B>>>24,$=B>>>16&255,H=B&65535,!(F<=w);){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}if(!($&240)){for(J=F,ee=$,Q=H;B=n.distcode[Q+((x&(1<<J+ee)-1)>>J)],F=B>>>24,$=B>>>16&255,H=B&65535,!(J+F<=w);){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}x>>>=J,w-=J,n.back+=J}if(x>>>=F,w-=F,n.back+=F,$&64){e.msg="invalid distance code",n.mode=Ro;break}n.offset=H,n.extra=$&15,n.mode=HK;case HK:if(n.extra){for(fe=n.extra;w<fe;){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}n.offset+=x&(1<<n.extra)-1,x>>>=n.extra,w-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=Ro;break}n.mode=WK;case WK:if(y===0)break e;if(E=P-y,n.offset>E){if(E=n.offset-E,E>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=Ro;break}E>n.wnext?(E-=n.wnext,j=n.wsize-E):j=n.wnext-E,E>n.length&&(E=n.length),D=n.window}else D=a,j=h-n.offset,E=n.length;E>y&&(E=y),y-=E,n.length-=E;do a[h++]=D[j++];while(--E);n.length===0&&(n.mode=AE);break;case ZK:if(y===0)break e;a[h++]=n.length,y--,n.mode=AE;break;case j4:if(n.wrap){for(;w<32;){if(i===0)break e;i--,x|=r[l++]<<w,w+=8}if(P-=y,e.total_out+=P,n.total+=P,n.wrap&4&&P&&(e.adler=n.check=n.flags?Sc(n.check,a,P,h-P):o5(n.check,a,P,h-P)),P=y,n.wrap&4&&(n.flags?x:XK(x))!==n.check){e.msg="incorrect data check",n.mode=Ro;break}x=0,w=0}n.mode=KK;case KK:if(n.wrap&&n.flags){for(;w<32;){if(i===0)break e;i--,x+=r[l++]<<w,w+=8}if(n.wrap&4&&x!==(n.total&4294967295)){e.msg="incorrect length check",n.mode=Ro;break}x=0,w=0}n.mode=YK;case YK:pe=fZe;break e;case Ro:pe=xhe;break e;case whe:return bhe;case She:default:return Cf}return e.next_out=h,e.avail_out=y,e.next_in=l,e.avail_in=i,n.hold=x,n.bits=w,(n.wsize||P!==e.avail_out&&n.mode<Ro&&(n.mode<j4||t!==PK))&&Phe(e,e.output,e.next_out,P-e.avail_out),C-=e.avail_in,P-=e.avail_out,e.total_in+=C,e.total_out+=P,n.total+=P,n.wrap&4&&P&&(e.adler=n.check=n.flags?Sc(n.check,a,P,e.next_out-P):o5(n.check,a,P,e.next_out-P)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Ig?128:0)+(n.mode===SE||n.mode===R4?256:0),(C===0&&P===0||t===PK)&&pe===Cx&&(pe=mZe),pe},AZe=e=>{if(jx(e))return Cf;let t=e.state;return t.window&&(t.window=null),e.state=null,Cx},TZe=(e,t)=>{if(jx(e))return Cf;const n=e.state;return n.wrap&2?(n.head=t,t.done=!1,Cx):Cf},CZe=(e,t)=>{const n=t.length;let r,a,l;return jx(e)||(r=e.state,r.wrap!==0&&r.mode!==c3)?Cf:r.mode===c3&&(a=1,a=o5(a,t,n,0),a!==r.check)?xhe:(l=Phe(e,t,n,n),l?(r.mode=whe,bhe):(r.havedict=1,Cx))};var EZe=The,PZe=Che,kZe=Ahe,IZe=bZe,NZe=Ehe,MZe=SZe,LZe=AZe,DZe=TZe,RZe=CZe,jZe="pako inflate (from Nodeca project)",Rg={inflateReset:EZe,inflateReset2:PZe,inflateResetKeep:kZe,inflateInit:IZe,inflateInit2:NZe,inflate:MZe,inflateEnd:LZe,inflateGetHeader:DZe,inflateSetDictionary:RZe,inflateInfo:jZe};function OZe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var FZe=OZe;const khe=Object.prototype.toString,{Z_NO_FLUSH:zZe,Z_FINISH:BZe,Z_OK:u5,Z_STREAM_END:z4,Z_NEED_DICT:B4,Z_STREAM_ERROR:UZe,Z_DATA_ERROR:QK,Z_MEM_ERROR:VZe}=dT;function fT(e){this.options=gN.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ghe,this.strm.avail_out=0;let n=Rg.inflateInit2(this.strm,t.windowBits);if(n!==u5)throw new Error(yw[n]);if(this.header=new FZe,Rg.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=c5.string2buf(t.dictionary):khe.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Rg.inflateSetDictionary(this.strm,t.dictionary),n!==u5)))throw new Error(yw[n])}fT.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,a=this.options.dictionary;let l,h,i;if(this.ended)return!1;for(t===~~t?h=t:h=t===!0?BZe:zZe,khe.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),l=Rg.inflate(n,h),l===B4&&a&&(l=Rg.inflateSetDictionary(n,a),l===u5?l=Rg.inflate(n,h):l===QK&&(l=B4));n.avail_in>0&&l===z4&&n.state.wrap>0&&e[n.next_in]!==0;)Rg.inflateReset(n),l=Rg.inflate(n,h);switch(l){case UZe:case QK:case B4:case VZe:return this.onEnd(l),this.ended=!0,!1}if(i=n.avail_out,n.next_out&&(n.avail_out===0||l===z4))if(this.options.to==="string"){let y=c5.utf8border(n.output,n.next_out),x=n.next_out-y,w=c5.buf2string(n.output,y);n.next_out=x,n.avail_out=r-x,x&&n.output.set(n.output.subarray(y,y+x),0),this.onData(w)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(l===u5&&i===0)){if(l===z4)return l=Rg.inflateEnd(this.strm),this.onEnd(l),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};fT.prototype.onData=function(e){this.chunks.push(e)};fT.prototype.onEnd=function(e){e===u5&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=gN.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function y8(e,t){const n=new fT(t);if(n.push(e),n.err)throw n.msg||yw[n.err];return n.result}function $Ze(e,t){return t=t||{},t.raw=!0,y8(e,t)}var qZe=fT,GZe=y8,HZe=$Ze,WZe=y8,ZZe=dT,KZe={Inflate:qZe,inflate:GZe,inflateRaw:HZe,ungzip:WZe,constants:ZZe};const{Inflate:YZe,inflate:XZe,inflateRaw:YXe,ungzip:XXe}=KZe;var eY=YZe,JZe=XZe;const Ihe=[];for(let e=0;e<256;e++){let t=e;for(let n=0;n<8;n++)t&1?t=3988292384^t>>>1:t=t>>>1;Ihe[e]=t}const tY=4294967295;function QZe(e,t,n){let r=e;for(let a=0;a<n;a++)r=Ihe[(r^t[a])&255]^r>>>8;return r}function eKe(e,t){return(QZe(tY,e,t)^tY)>>>0}function nY(e,t,n){const r=e.readUint32(),a=eKe(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(a!==r)throw new Error(`CRC mismatch for chunk ${n}. Expected ${r}, found ${a}`)}function Nhe(e,t,n){for(let r=0;r<n;r++)t[r]=e[r]}function Mhe(e,t,n,r){let a=0;for(;a<r;a++)t[a]=e[a];for(;a<n;a++)t[a]=e[a]+t[a-r]&255}function Lhe(e,t,n,r){let a=0;if(n.length===0)for(;a<r;a++)t[a]=e[a];else for(;a<r;a++)t[a]=e[a]+n[a]&255}function Dhe(e,t,n,r,a){let l=0;if(n.length===0){for(;l<a;l++)t[l]=e[l];for(;l<r;l++)t[l]=e[l]+(t[l-a]>>1)&255}else{for(;l<a;l++)t[l]=e[l]+(n[l]>>1)&255;for(;l<r;l++)t[l]=e[l]+(t[l-a]+n[l]>>1)&255}}function Rhe(e,t,n,r,a){let l=0;if(n.length===0){for(;l<a;l++)t[l]=e[l];for(;l<r;l++)t[l]=e[l]+t[l-a]&255}else{for(;l<a;l++)t[l]=e[l]+n[l]&255;for(;l<r;l++)t[l]=e[l]+tKe(t[l-a],n[l],n[l-a])&255}}function tKe(e,t,n){const r=e+t-n,a=Math.abs(r-e),l=Math.abs(r-t),h=Math.abs(r-n);return a<=l&&a<=h?e:l<=h?t:n}function nKe(e,t,n,r,a,l){switch(e){case 0:Nhe(t,n,a);break;case 1:Mhe(t,n,a,l);break;case 2:Lhe(t,n,r,a);break;case 3:Dhe(t,n,r,a,l);break;case 4:Rhe(t,n,r,a,l);break;default:throw new Error(`Unsupported filter: ${e}`)}}const rKe=new Uint16Array([255]),iKe=new Uint8Array(rKe.buffer),sKe=iKe[0]===255;function aKe(e){const{data:t,width:n,height:r,channels:a,depth:l}=e,h=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],i=Math.ceil(l/8)*a,y=new Uint8Array(r*n*i);let x=0;for(let w=0;w<7;w++){const C=h[w],P=Math.ceil((n-C.x)/C.xStep),E=Math.ceil((r-C.y)/C.yStep);if(P<=0||E<=0)continue;const j=P*i,D=new Uint8Array(j);for(let B=0;B<E;B++){const F=t[x++],$=t.subarray(x,x+j);x+=j;const H=new Uint8Array(j);nKe(F,$,H,D,j,i),D.set(H);for(let J=0;J<P;J++){const ee=C.x+J*C.xStep,Q=C.y+B*C.yStep;if(!(ee>=n||Q>=r))for(let ne=0;ne<i;ne++)y[(Q*n+ee)*i+ne]=H[J*i+ne]}}}if(l===16){const w=new Uint16Array(y.buffer);if(sKe)for(let C=0;C<w.length;C++)w[C]=oKe(w[C]);return w}else return y}function oKe(e){return(e&255)<<8|e>>8&255}const lKe=new Uint16Array([255]),cKe=new Uint8Array(lKe.buffer),uKe=cKe[0]===255,dKe=new Uint8Array(0);function rY(e){const{data:t,width:n,height:r,channels:a,depth:l}=e,h=Math.ceil(l/8)*a,i=Math.ceil(l/8*a*n),y=new Uint8Array(r*i);let x=dKe,w=0,C,P;for(let E=0;E<r;E++){switch(C=t.subarray(w+1,w+1+i),P=y.subarray(E*i,(E+1)*i),t[w]){case 0:Nhe(C,P,i);break;case 1:Mhe(C,P,i,h);break;case 2:Lhe(C,P,x,i);break;case 3:Dhe(C,P,x,i,h);break;case 4:Rhe(C,P,x,i,h);break;default:throw new Error(`Unsupported filter: ${t[w]}`)}x=P,w+=i+1}if(l===16){const E=new Uint16Array(y.buffer);if(uKe)for(let j=0;j<E.length;j++)E[j]=hKe(E[j]);return E}else return y}function hKe(e){return(e&255)<<8|e>>8&255}const oP=Uint8Array.of(137,80,78,71,13,10,26,10);function iY(e){if(!fKe(e.readBytes(oP.length)))throw new Error("wrong PNG signature")}function fKe(e){if(e.length<oP.length)return!1;for(let t=0;t<oP.length;t++)if(e[t]!==oP[t])return!1;return!0}const pKe="tEXt",mKe=0,jhe=new TextDecoder("latin1");function gKe(e){if(vKe(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const yKe=/^[\u0000-\u00FF]*$/;function vKe(e){if(!yKe.test(e))throw new Error("invalid latin1 text")}function _Ke(e,t,n){const r=Ohe(t);e[r]=xKe(t,n-r.length-1)}function Ohe(e){for(e.mark();e.readByte()!==mKe;);const t=e.offset;e.reset();const n=jhe.decode(e.readBytes(t-e.offset-1));return e.skip(1),gKe(n),n}function xKe(e,t){return jhe.decode(e.readBytes(t))}const dh={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},U4={UNKNOWN:-1,DEFLATE:0},sY={UNKNOWN:-1,ADAPTIVE:0},V4={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},TE={NONE:0,BACKGROUND:1,PREVIOUS:2},$4={SOURCE:0,OVER:1};class bKe extends u8{constructor(n,r={}){super(n);ni(this,"_checkCrc");ni(this,"_inflator");ni(this,"_png");ni(this,"_apng");ni(this,"_end");ni(this,"_hasPalette");ni(this,"_palette");ni(this,"_hasTransparency");ni(this,"_transparency");ni(this,"_compressionMethod");ni(this,"_filterMethod");ni(this,"_interlaceMethod");ni(this,"_colorType");ni(this,"_isAnimated");ni(this,"_numberOfFrames");ni(this,"_numberOfPlays");ni(this,"_frames");ni(this,"_writingDataChunks");const{checkCrc:a=!1}=r;this._checkCrc=a,this._inflator=new eY,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=U4.UNKNOWN,this._filterMethod=sY.UNKNOWN,this._interlaceMethod=V4.UNKNOWN,this._colorType=dh.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(iY(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeChunk(n,r)}return this.decodeImage(),this._png}decodeApng(){for(iY(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(n,r)}return this.decodeApngImage(),this._apng}decodeChunk(n,r){const a=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(n);break;case"IDAT":this.decodeIDAT(n);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(n);break;case"iCCP":this.decodeiCCP(n);break;case pKe:_Ke(this._png.text,this,n);break;case"pHYs":this.decodepHYs();break;default:this.skip(n);break}if(this.offset-a!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?nY(this,n+4,r):this.skip(4)}decodeApngChunk(n,r){const a=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(n);break;default:this.decodeChunk(n,r),this.offset=a+n;break}if(this.offset-a!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?nY(this,n+4,r):this.skip(4)}decodeIHDR(){const n=this._png;n.width=this.readUint32(),n.height=this.readUint32(),n.depth=wKe(this.readUint8());const r=this.readUint8();this._colorType=r;let a;switch(r){case dh.GREYSCALE:a=1;break;case dh.TRUECOLOUR:a=3;break;case dh.INDEXED_COLOUR:a=1;break;case dh.GREYSCALE_ALPHA:a=2;break;case dh.TRUECOLOUR_ALPHA:a=4;break;case dh.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==U4.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const n={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(n)}decodePLTE(n){if(n%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${n}`);const r=n/3;this._hasPalette=!0;const a=[];this._palette=a;for(let l=0;l<r;l++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(n){this._writingDataChunks=!0;const r=n,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodeFDAT(n){this._writingDataChunks=!0;let r=n,a=this.offset+this.byteOffset;if(a+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,a,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodetRNS(n){switch(this._colorType){case dh.GREYSCALE:case dh.TRUECOLOUR:{if(n%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${n}`);if(n/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${n/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(n/2);for(let r=0;r<n/2;r++)this._transparency[r]=this.readUint16();break}case dh.INDEXED_COLOUR:{if(n>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${n} vs ${this._palette.length})`);let r=0;for(;r<n;r++){const a=this.readByte();this._palette[r].push(a)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case dh.UNKNOWN:case dh.GREYSCALE_ALPHA:case dh.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(n){const r=Ohe(this),a=this.readUint8();if(a!==U4.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const l=this.readBytes(n-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:JZe(l)}}decodepHYs(){const n=this.readUint32(),r=this.readUint32(),a=this.readByte();this._png.resolution={x:n,y:r,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let n=0;n<this._numberOfFrames;n++){const r={sequenceNumber:this._frames[n].sequenceNumber,delayNumber:this._frames[n].delayNumber,delayDenominator:this._frames[n].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(n);if(a){if(a.data=rY({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),n===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)r.data=a.data;else{const l=this._apng.frames.at(n-1);this.disposeFrame(a,l,r),this.addFrameDataToCanvas(r,a)}this._apng.frames.push(r)}}return this._apng}disposeFrame(n,r,a){switch(n.disposeOp){case TE.NONE:break;case TE.BACKGROUND:for(let l=0;l<this._png.height;l++)for(let h=0;h<this._png.width;h++){const i=(l*n.width+h)*this._png.channels;for(let y=0;y<this._png.channels;y++)a.data[i+y]=0}break;case TE.PREVIOUS:a.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(n,r){const a=1<<this._png.depth,l=(h,i)=>{const y=((h+r.yOffset)*this._png.width+r.xOffset+i)*this._png.channels,x=(h*r.width+i)*this._png.channels;return{index:y,frameIndex:x}};switch(r.blendOp){case $4.SOURCE:for(let h=0;h<r.height;h++)for(let i=0;i<r.width;i++){const{index:y,frameIndex:x}=l(h,i);for(let w=0;w<this._png.channels;w++)n.data[y+w]=r.data[x+w]}break;case $4.OVER:for(let h=0;h<r.height;h++)for(let i=0;i<r.width;i++){const{index:y,frameIndex:x}=l(h,i);for(let w=0;w<this._png.channels;w++){const C=r.data[x+this._png.channels-1]/a,P=w%(this._png.channels-1)===0?1:r.data[x+w],E=Math.floor(C*P+(1-C)*n.data[y+w]);n.data[y+w]+=E}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var r;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const n=this._isAnimated?((r=this._frames)==null?void 0:r.at(0)).data:this._inflator.result;if(this._filterMethod!==sY.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===V4.NO_INTERLACE)this._png.data=rY({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===V4.ADAM7)this._png.data=aKe({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const n=this._inflator.result,r=this._frames.at(-1);r?r.data=n:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:TE.NONE,blendOp:$4.SOURCE,data:n}),this._inflator=new eY,this._writingDataChunks=!1}}function wKe(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var aY;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(aY||(aY={}));function SKe(e,t){return new bKe(e,t).decode()}var Ji=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function q4(){Ji.console&&typeof Ji.console.log=="function"&&Ji.console.log.apply(Ji.console,arguments)}var Ka={log:q4,warn:function(e){Ji.console&&(typeof Ji.console.warn=="function"?Ji.console.warn.apply(Ji.console,arguments):q4.call(null,arguments))},error:function(e){Ji.console&&(typeof Ji.console.error=="function"?Ji.console.error.apply(Ji.console,arguments):q4(e))}};function G4(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){S_(r.response,t,n)},r.onerror=function(){Ka.error("could not download file")},r.send()}function oY(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function CE(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var S_=Ji.saveAs||((typeof window>"u"?"undefined":Da(window))!=="object"||window!==Ji?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,n){var r=Ji.URL||Ji.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?oY(a.href)?G4(e,t,n):CE(a,a.target="_blank"):CE(a)):(a.href=r.createObjectURL(e),setTimeout(function(){r.revokeObjectURL(a.href)},4e4),setTimeout(function(){CE(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download",typeof e=="string")if(oY(e))G4(e,t,n);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout(function(){CE(r)})}else navigator.msSaveOrOpenBlob(function(a,l){return l===void 0?l={autoBom:!1}:Da(l)!=="object"&&(Ka.warn("Deprecated: Expected third argument to be a object"),l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(e,n),t)}:function(e,t,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof e=="string")return G4(e,t,n);var a=e.type==="application/octet-stream",l=/constructor/i.test(Ji.HTMLElement)||Ji.safari,h=/CriOS\/[\d]+/.test(navigator.userAgent);if((h||a&&l)&&(typeof FileReader>"u"?"undefined":Da(FileReader))==="object"){var i=new FileReader;i.onloadend=function(){var w=i.result;w=h?w:w.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=w:location=w,r=null},i.readAsDataURL(e)}else{var y=Ji.URL||Ji.webkitURL,x=y.createObjectURL(e);r?r.location=x:location.href=x,r=null,setTimeout(function(){y.revokeObjectURL(x)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Fhe(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(i){return[parseInt(i[1]),parseInt(i[2]),parseInt(i[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(i){return[parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(i){return[parseInt(i[1]+i[1],16),parseInt(i[2]+i[2],16),parseInt(i[3]+i[3],16)]}}],r=0;r<n.length;r++){var a=n[r].re,l=n[r].process,h=a.exec(e);h&&(t=l(h),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var i=this.r.toString(16),y=this.g.toString(16),x=this.b.toString(16);return i.length==1&&(i="0"+i),y.length==1&&(y="0"+y),x.length==1&&(x="0"+x),"#"+i+y+x}}var lP=Ji.atob.bind(Ji),lY=Ji.btoa.bind(Ji);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function H4(e,t){var n=e[0],r=e[1],a=e[2],l=e[3];n=gu(n,r,a,l,t[0],7,-680876936),l=gu(l,n,r,a,t[1],12,-389564586),a=gu(a,l,n,r,t[2],17,606105819),r=gu(r,a,l,n,t[3],22,-1044525330),n=gu(n,r,a,l,t[4],7,-176418897),l=gu(l,n,r,a,t[5],12,1200080426),a=gu(a,l,n,r,t[6],17,-1473231341),r=gu(r,a,l,n,t[7],22,-45705983),n=gu(n,r,a,l,t[8],7,1770035416),l=gu(l,n,r,a,t[9],12,-1958414417),a=gu(a,l,n,r,t[10],17,-42063),r=gu(r,a,l,n,t[11],22,-1990404162),n=gu(n,r,a,l,t[12],7,1804603682),l=gu(l,n,r,a,t[13],12,-40341101),a=gu(a,l,n,r,t[14],17,-1502002290),n=yu(n,r=gu(r,a,l,n,t[15],22,1236535329),a,l,t[1],5,-165796510),l=yu(l,n,r,a,t[6],9,-1069501632),a=yu(a,l,n,r,t[11],14,643717713),r=yu(r,a,l,n,t[0],20,-373897302),n=yu(n,r,a,l,t[5],5,-701558691),l=yu(l,n,r,a,t[10],9,38016083),a=yu(a,l,n,r,t[15],14,-660478335),r=yu(r,a,l,n,t[4],20,-405537848),n=yu(n,r,a,l,t[9],5,568446438),l=yu(l,n,r,a,t[14],9,-1019803690),a=yu(a,l,n,r,t[3],14,-187363961),r=yu(r,a,l,n,t[8],20,1163531501),n=yu(n,r,a,l,t[13],5,-1444681467),l=yu(l,n,r,a,t[2],9,-51403784),a=yu(a,l,n,r,t[7],14,1735328473),n=vu(n,r=yu(r,a,l,n,t[12],20,-1926607734),a,l,t[5],4,-378558),l=vu(l,n,r,a,t[8],11,-2022574463),a=vu(a,l,n,r,t[11],16,1839030562),r=vu(r,a,l,n,t[14],23,-35309556),n=vu(n,r,a,l,t[1],4,-1530992060),l=vu(l,n,r,a,t[4],11,1272893353),a=vu(a,l,n,r,t[7],16,-155497632),r=vu(r,a,l,n,t[10],23,-1094730640),n=vu(n,r,a,l,t[13],4,681279174),l=vu(l,n,r,a,t[0],11,-358537222),a=vu(a,l,n,r,t[3],16,-722521979),r=vu(r,a,l,n,t[6],23,76029189),n=vu(n,r,a,l,t[9],4,-640364487),l=vu(l,n,r,a,t[12],11,-421815835),a=vu(a,l,n,r,t[15],16,530742520),n=_u(n,r=vu(r,a,l,n,t[2],23,-995338651),a,l,t[0],6,-198630844),l=_u(l,n,r,a,t[7],10,1126891415),a=_u(a,l,n,r,t[14],15,-1416354905),r=_u(r,a,l,n,t[5],21,-57434055),n=_u(n,r,a,l,t[12],6,1700485571),l=_u(l,n,r,a,t[3],10,-1894986606),a=_u(a,l,n,r,t[10],15,-1051523),r=_u(r,a,l,n,t[1],21,-2054922799),n=_u(n,r,a,l,t[8],6,1873313359),l=_u(l,n,r,a,t[15],10,-30611744),a=_u(a,l,n,r,t[6],15,-1560198380),r=_u(r,a,l,n,t[13],21,1309151649),n=_u(n,r,a,l,t[4],6,-145523070),l=_u(l,n,r,a,t[11],10,-1120210379),a=_u(a,l,n,r,t[2],15,718787259),r=_u(r,a,l,n,t[9],21,-343485551),e[0]=$0(n,e[0]),e[1]=$0(r,e[1]),e[2]=$0(a,e[2]),e[3]=$0(l,e[3])}function vN(e,t,n,r,a,l){return t=$0($0(t,e),$0(r,l)),$0(t<<a|t>>>32-a,n)}function gu(e,t,n,r,a,l,h){return vN(t&n|~t&r,e,t,a,l,h)}function yu(e,t,n,r,a,l,h){return vN(t&r|n&~r,e,t,a,l,h)}function vu(e,t,n,r,a,l,h){return vN(t^n^r,e,t,a,l,h)}function _u(e,t,n,r,a,l,h){return vN(n^(t|~r),e,t,a,l,h)}function zhe(e){var t,n=e.length,r=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)H4(r,AKe(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(H4(r,a),t=0;t<16;t++)a[t]=0;return a[14]=8*n,H4(r,a),r}function AKe(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}var cY="0123456789abcdef".split("");function TKe(e){for(var t="",n=0;n<4;n++)t+=cY[e>>8*n+4&15]+cY[e>>8*n&15];return t}function CKe(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function hO(e){return zhe(e).map(CKe).join("")}var EKe=function(e){for(var t=0;t<e.length;t++)e[t]=TKe(e[t]);return e.join("")}(zhe("hello"))!="5d41402abc4b2a76b9719d911017c592";function $0(e,t){if(EKe){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function fO(e,t){var n,r,a,l;if(e!==n){for(var h=(a=e,l=1+(256/e.length|0),new Array(l+1).join(a)),i=[],y=0;y<256;y++)i[y]=y;var x=0;for(y=0;y<256;y++){var w=i[y];x=(x+w+h.charCodeAt(y))%256,i[y]=i[x],i[x]=w}n=e,r=i}else i=r;var C=t.length,P=0,E=0,j="";for(y=0;y<C;y++)E=(E+(w=i[P=(P+1)%256]))%256,i[P]=i[E],i[E]=w,h=i[(i[P]+i[E])%256],j+=String.fromCharCode(t.charCodeAt(y)^h);return j}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var uY={print:4,modify:8,copy:16,"annot-forms":32};function O1(e,t,n,r){this.v=1,this.r=2;var a=192;e.forEach(function(i){if(uY.perm!==void 0)throw new Error("Invalid permission: "+i);a+=uY[i]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var l=(t+this.padding).substr(0,32),h=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(l,h),this.P=-(1+(255^a)),this.encryptionKey=hO(l+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=fO(this.encryptionKey,this.padding)}function F1(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",n=e.length,r=0;r<n;r++){var a=e.charCodeAt(r);t+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):e[r]}return t}function dY(e){if(Da(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(n,r,a){if(a=a||!1,typeof n!="string"||typeof r!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(n)||(t[n]={});var l=Math.random().toString(35);return t[n][l]=[r,!!a],l},this.unsubscribe=function(n){for(var r in t)if(t[r][n])return delete t[r][n],Object.keys(t[r]).length===0&&delete t[r],!0;return!1},this.publish=function(n){if(t.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),a=[];for(var l in t[n]){var h=t[n][l];try{h[0].apply(e,r)}catch(i){Ji.console&&Ka.error("jsPDF PubSub Error",i.message,i)}h[1]&&a.push(l)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function u3(e){if(!(this instanceof u3))return new u3(e);var t="opacity,stroke-opacity".split(",");for(var n in e)e.hasOwnProperty(n)&&t.indexOf(n)>=0&&(this[n]=e[n]);this.id="",this.objectNumber=-1}function Bhe(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function T_(e,t,n,r,a){if(!(this instanceof T_))return new T_(e,t,n,r,a);this.type=e==="axial"?2:3,this.coords=t,this.colors=n,Bhe.call(this,r,a)}function ab(e,t,n,r,a){if(!(this instanceof ab))return new ab(e,t,n,r,a);this.boundingBox=e,this.xStep=t,this.yStep=n,this.stream="",this.cloneIndex=0,Bhe.call(this,r,a)}function Ci(e){var t,n=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],a=arguments[2],l=arguments[3],h=[],i=1,y=16,x="S",w=null;Da(e=e||{})==="object"&&(n=e.orientation,r=e.unit||r,a=e.format||a,l=e.compress||e.compressPdf||l,(w=e.encryption||null)!==null&&(w.userPassword=w.userPassword||"",w.ownerPassword=w.ownerPassword||"",w.userPermissions=w.userPermissions||[]),i=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(y=e.floatPrecision),x=e.defaultPathOperation||"S"),h=e.filters||(l===!0?["FlateEncode"]:h),r=r||"mm",n=(""+(n||"P")).toLowerCase();var C=e.putOnlyUsedFonts||!1,P={},E={internal:{},__private__:{}};E.__private__.PubSub=dY;var j="1.3",D=E.__private__.getPdfVersion=function(){return j};E.__private__.setPdfVersion=function(re){j=re};var B={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};E.__private__.getPageFormats=function(){return B};var F=E.__private__.getPageFormat=function(re){return B[re]};a=a||"a4";var $="compat",H="advanced",J=$;function ee(){this.saveGraphicsState(),st(new qr(Qr,0,0,-Qr,0,Ii()*Qr).toString()+" cm"),this.setFontSize(this.getFontSize()/Qr),x="n",J=H}function Q(){this.restoreGraphicsState(),x="S",J=$}var ne=E.__private__.combineFontStyleAndFontWeight=function(re,Pe){if(re=="bold"&&Pe=="normal"||re=="bold"&&Pe==400||re=="normal"&&Pe=="italic"||re=="bold"&&Pe=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Pe&&(re=Pe==400||Pe==="normal"?re==="italic"?"italic":"normal":Pe!=700&&Pe!=="bold"||re!=="normal"?(Pe==700?"bold":Pe)+""+re:"bold"),re};E.advancedAPI=function(re){var Pe=J===$;return Pe&&ee.call(this),typeof re!="function"||(re(this),Pe&&Q.call(this)),this},E.compatAPI=function(re){var Pe=J===H;return Pe&&Q.call(this),typeof re!="function"||(re(this),Pe&&ee.call(this)),this},E.isAdvancedAPI=function(){return J===H};var pe,he=function(re){if(J!==H)throw new Error(re+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},we=E.roundToPrecision=E.__private__.roundToPrecision=function(re,Pe){var qe=t||Pe;if(isNaN(re)||isNaN(qe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return re.toFixed(qe).replace(/0+$/,"")};pe=E.hpf=E.__private__.hpf=typeof y=="number"?function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.hpf");return we(re,y)}:y==="smart"?function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.hpf");return we(re,re>-1&&re<1?16:5)}:function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.hpf");return we(re,16)};var fe=E.f2=E.__private__.f2=function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.f2");return we(re,2)},ge=E.__private__.f3=function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.f3");return we(re,3)},Ce=E.scale=E.__private__.scale=function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.scale");return J===$?re*Qr:J===H?re:void 0},xe=function(re){return Ce(function(Pe){return J===$?Ii()-Pe:J===H?Pe:void 0}(re))};E.__private__.setPrecision=E.setPrecision=function(re){typeof parseInt(re,10)=="number"&&(t=parseInt(re,10))};var Re,Qe="00000000000000000000000000000000",et=E.__private__.getFileId=function(){return Qe},je=E.__private__.setFileId=function(re){return Qe=re!==void 0&&/^[a-fA-F0-9]{32}$/.test(re)?re.toUpperCase():Qe.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),w!==null&&(ka=new O1(w.userPermissions,w.userPassword,w.ownerPassword,Qe)),Qe};E.setFileId=function(re){return je(re),this},E.getFileId=function(){return et()};var De=E.__private__.convertDateToPDFDate=function(re){var Pe=re.getTimezoneOffset(),qe=Pe<0?"+":"-",Rt=Math.floor(Math.abs(Pe/60)),Zt=Math.abs(Pe%60),kn=[qe,nt(Rt),"'",nt(Zt),"'"].join("");return["D:",re.getFullYear(),nt(re.getMonth()+1),nt(re.getDate()),nt(re.getHours()),nt(re.getMinutes()),nt(re.getSeconds()),kn].join("")},Ct=E.__private__.convertPDFDateToDate=function(re){var Pe=parseInt(re.substr(2,4),10),qe=parseInt(re.substr(6,2),10)-1,Rt=parseInt(re.substr(8,2),10),Zt=parseInt(re.substr(10,2),10),kn=parseInt(re.substr(12,2),10),Wn=parseInt(re.substr(14,2),10);return new Date(Pe,qe,Rt,Zt,kn,Wn,0)},xt=E.__private__.setCreationDate=function(re){var Pe;if(re===void 0&&(re=new Date),re instanceof Date)Pe=De(re);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(re))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Pe=re}return Re=Pe},me=E.__private__.getCreationDate=function(re){var Pe=Re;return re==="jsDate"&&(Pe=Ct(Re)),Pe};E.setCreationDate=function(re){return xt(re),this},E.getCreationDate=function(re){return me(re)};var Ye,nt=E.__private__.padd2=function(re){return("0"+parseInt(re)).slice(-2)},vt=E.__private__.padd2Hex=function(re){return("00"+(re=re.toString())).substr(re.length)},gt=0,dt=[],At=[],mt=0,Pt=[],Ht=[],Ot=!1,Un=At;E.__private__.setCustomOutputDestination=function(re){Ot=!0,Un=re};var Kt=function(re){Ot||(Un=re)};E.__private__.resetCustomOutputDestination=function(){Ot=!1,Un=At};var st=E.__private__.out=function(re){return re=re.toString(),mt+=re.length+1,Un.push(re),Un},Dr=E.__private__.write=function(re){return st(arguments.length===1?re.toString():Array.prototype.join.call(arguments," "))},Or=E.__private__.getArrayBuffer=function(re){for(var Pe=re.length,qe=new ArrayBuffer(Pe),Rt=new Uint8Array(qe);Pe--;)Rt[Pe]=re.charCodeAt(Pe);return qe},Br=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];E.__private__.getStandardFonts=function(){return Br};var On=e.fontSize||16;E.__private__.setFontSize=E.setFontSize=function(re){return On=J===H?re/Qr:re,this};var ht,wt=E.__private__.getFontSize=E.getFontSize=function(){return J===$?On:On*Qr},Wt=e.R2L||!1;E.__private__.setR2L=E.setR2L=function(re){return Wt=re,this},E.__private__.getR2L=E.getR2L=function(){return Wt};var xn,Rn=E.__private__.setZoomMode=function(re){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(re))ht=re;else if(isNaN(re)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(re)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+re+'" is not recognized.');ht=re}else ht=parseInt(re,10)};E.__private__.getZoomMode=function(){return ht};var Sn,Mn=E.__private__.setPageMode=function(re){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(re)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+re+'" is not recognized.');xn=re};E.__private__.getPageMode=function(){return xn};var Ar=E.__private__.setLayoutMode=function(re){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(re)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+re+'" is not recognized.');Sn=re};E.__private__.getLayoutMode=function(){return Sn},E.__private__.setDisplayMode=E.setDisplayMode=function(re,Pe,qe){return Rn(re),Ar(Pe),Mn(qe),this};var Pr={title:"",subject:"",author:"",keywords:"",creator:""};E.__private__.getDocumentProperty=function(re){if(Object.keys(Pr).indexOf(re)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Pr[re]},E.__private__.getDocumentProperties=function(){return Pr},E.__private__.setDocumentProperties=E.setProperties=E.setDocumentProperties=function(re){for(var Pe in Pr)Pr.hasOwnProperty(Pe)&&re[Pe]&&(Pr[Pe]=re[Pe]);return this},E.__private__.setDocumentProperty=function(re,Pe){if(Object.keys(Pr).indexOf(re)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Pr[re]=Pe};var wr,Qr,dr,Hi,Bi,Cr={},fi={},Cn=[],bn={},fr={},Ur={},Xs={},_a=null,ts=0,_i=[],xs=new dY(E),Pi=e.hotfixes||[],zt={},es={},ja=[],qr=function re(Pe,qe,Rt,Zt,kn,Wn){if(!(this instanceof re))return new re(Pe,qe,Rt,Zt,kn,Wn);isNaN(Pe)&&(Pe=1),isNaN(qe)&&(qe=0),isNaN(Rt)&&(Rt=0),isNaN(Zt)&&(Zt=1),isNaN(kn)&&(kn=0),isNaN(Wn)&&(Wn=0),this._matrix=[Pe,qe,Rt,Zt,kn,Wn]};Object.defineProperty(qr.prototype,"sx",{get:function(){return this._matrix[0]},set:function(re){this._matrix[0]=re}}),Object.defineProperty(qr.prototype,"shy",{get:function(){return this._matrix[1]},set:function(re){this._matrix[1]=re}}),Object.defineProperty(qr.prototype,"shx",{get:function(){return this._matrix[2]},set:function(re){this._matrix[2]=re}}),Object.defineProperty(qr.prototype,"sy",{get:function(){return this._matrix[3]},set:function(re){this._matrix[3]=re}}),Object.defineProperty(qr.prototype,"tx",{get:function(){return this._matrix[4]},set:function(re){this._matrix[4]=re}}),Object.defineProperty(qr.prototype,"ty",{get:function(){return this._matrix[5]},set:function(re){this._matrix[5]=re}}),Object.defineProperty(qr.prototype,"a",{get:function(){return this._matrix[0]},set:function(re){this._matrix[0]=re}}),Object.defineProperty(qr.prototype,"b",{get:function(){return this._matrix[1]},set:function(re){this._matrix[1]=re}}),Object.defineProperty(qr.prototype,"c",{get:function(){return this._matrix[2]},set:function(re){this._matrix[2]=re}}),Object.defineProperty(qr.prototype,"d",{get:function(){return this._matrix[3]},set:function(re){this._matrix[3]=re}}),Object.defineProperty(qr.prototype,"e",{get:function(){return this._matrix[4]},set:function(re){this._matrix[4]=re}}),Object.defineProperty(qr.prototype,"f",{get:function(){return this._matrix[5]},set:function(re){this._matrix[5]=re}}),Object.defineProperty(qr.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(qr.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(qr.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(qr.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),qr.prototype.join=function(re){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(pe).join(re)},qr.prototype.multiply=function(re){var Pe=re.sx*this.sx+re.shy*this.shx,qe=re.sx*this.shy+re.shy*this.sy,Rt=re.shx*this.sx+re.sy*this.shx,Zt=re.shx*this.shy+re.sy*this.sy,kn=re.tx*this.sx+re.ty*this.shx+this.tx,Wn=re.tx*this.shy+re.ty*this.sy+this.ty;return new qr(Pe,qe,Rt,Zt,kn,Wn)},qr.prototype.decompose=function(){var re=this.sx,Pe=this.shy,qe=this.shx,Rt=this.sy,Zt=this.tx,kn=this.ty,Wn=Math.sqrt(re*re+Pe*Pe),Mr=(re/=Wn)*qe+(Pe/=Wn)*Rt;qe-=re*Mr,Rt-=Pe*Mr;var ln=Math.sqrt(qe*qe+Rt*Rt);return Mr/=ln,re*(Rt/=ln)<Pe*(qe/=ln)&&(re=-re,Pe=-Pe,Mr=-Mr,Wn=-Wn),{scale:new qr(Wn,0,0,ln,0,0),translate:new qr(1,0,0,1,Zt,kn),rotate:new qr(re,Pe,-Pe,re,0,0),skew:new qr(1,0,Mr,1,0,0)}},qr.prototype.toString=function(re){return this.join(" ")},qr.prototype.inversed=function(){var re=this.sx,Pe=this.shy,qe=this.shx,Rt=this.sy,Zt=this.tx,kn=this.ty,Wn=1/(re*Rt-Pe*qe),Mr=Rt*Wn,ln=-Pe*Wn,lr=-qe*Wn,ur=re*Wn;return new qr(Mr,ln,lr,ur,-Mr*Zt-lr*kn,-ln*Zt-ur*kn)},qr.prototype.applyToPoint=function(re){var Pe=re.x*this.sx+re.y*this.shx+this.tx,qe=re.x*this.shy+re.y*this.sy+this.ty;return new nu(Pe,qe)},qr.prototype.applyToRectangle=function(re){var Pe=this.applyToPoint(re),qe=this.applyToPoint(new nu(re.x+re.w,re.y+re.h));return new Oh(Pe.x,Pe.y,qe.x-Pe.x,qe.y-Pe.y)},qr.prototype.clone=function(){var re=this.sx,Pe=this.shy,qe=this.shx,Rt=this.sy,Zt=this.tx,kn=this.ty;return new qr(re,Pe,qe,Rt,Zt,kn)},E.Matrix=qr;var lt=E.matrixMult=function(re,Pe){return Pe.multiply(re)},de=new qr(1,0,0,1,0,0);E.unitMatrix=E.identityMatrix=de;var _e=function(re,Pe){if(!fr[re]){var qe=(Pe instanceof T_?"Sh":"P")+(Object.keys(bn).length+1).toString(10);Pe.id=qe,fr[re]=qe,bn[qe]=Pe,xs.publish("addPattern",Pe)}};E.ShadingPattern=T_,E.TilingPattern=ab,E.addShadingPattern=function(re,Pe){return he("addShadingPattern()"),_e(re,Pe),this},E.beginTilingPattern=function(re){he("beginTilingPattern()"),eh(re.boundingBox[0],re.boundingBox[1],re.boundingBox[2]-re.boundingBox[0],re.boundingBox[3]-re.boundingBox[1],re.matrix)},E.endTilingPattern=function(re,Pe){he("endTilingPattern()"),Pe.stream=Ht[Ye].join(`
`),_e(re,Pe),xs.publish("endTilingPattern",Pe),ja.pop().restore()};var Ie,Xe=E.__private__.newObject=function(){var re=He();return We(re,!0),re},He=E.__private__.newObjectDeferred=function(){return gt++,dt[gt]=function(){return mt},gt},We=function(re,Pe){return Pe=typeof Pe=="boolean"&&Pe,dt[re]=mt,Pe&&st(re+" 0 obj"),re},kt=E.__private__.newAdditionalObject=function(){var re={objId:He(),content:""};return Pt.push(re),re},ot=He(),Et=He(),on=E.__private__.decodeColorString=function(re){var Pe=re.split(" ");if(Pe.length!==2||Pe[1]!=="g"&&Pe[1]!=="G")Pe.length!==5||Pe[4]!=="k"&&Pe[4]!=="K"||(Pe=[(1-Pe[0])*(1-Pe[3]),(1-Pe[1])*(1-Pe[3]),(1-Pe[2])*(1-Pe[3]),"r"]);else{var qe=parseFloat(Pe[0]);Pe=[qe,qe,qe,"r"]}for(var Rt="#",Zt=0;Zt<3;Zt++)Rt+=("0"+Math.floor(255*parseFloat(Pe[Zt])).toString(16)).slice(-2);return Rt},Yt=E.__private__.encodeColorString=function(re){var Pe;typeof re=="string"&&(re={ch1:re});var qe=re.ch1,Rt=re.ch2,Zt=re.ch3,kn=re.ch4,Wn=re.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof qe=="string"&&qe.charAt(0)!=="#"){var Mr=new Fhe(qe);if(Mr.ok)qe=Mr.toHex();else if(!/^\d*\.?\d*$/.test(qe))throw new Error('Invalid color "'+qe+'" passed to jsPDF.encodeColorString.')}if(typeof qe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(qe)&&(qe="#"+qe[1]+qe[1]+qe[2]+qe[2]+qe[3]+qe[3]),typeof qe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(qe)){var ln=parseInt(qe.substr(1),16);qe=ln>>16&255,Rt=ln>>8&255,Zt=255&ln}if(Rt===void 0||kn===void 0&&qe===Rt&&Rt===Zt)Pe=typeof qe=="string"?qe+" "+Wn[0]:re.precision===2?fe(qe/255)+" "+Wn[0]:ge(qe/255)+" "+Wn[0];else if(kn===void 0||Da(kn)==="object"){if(kn&&!isNaN(kn.a)&&kn.a===0)return["1.","1.","1.",Wn[1]].join(" ");Pe=typeof qe=="string"?[qe,Rt,Zt,Wn[1]].join(" "):re.precision===2?[fe(qe/255),fe(Rt/255),fe(Zt/255),Wn[1]].join(" "):[ge(qe/255),ge(Rt/255),ge(Zt/255),Wn[1]].join(" ")}else Pe=typeof qe=="string"?[qe,Rt,Zt,kn,Wn[2]].join(" "):re.precision===2?[fe(qe),fe(Rt),fe(Zt),fe(kn),Wn[2]].join(" "):[ge(qe),ge(Rt),ge(Zt),ge(kn),Wn[2]].join(" ");return Pe},Vn=E.__private__.getFilters=function(){return h},ar=E.__private__.putStream=function(re){var Pe=(re=re||{}).data||"",qe=re.filters||Vn(),Rt=re.alreadyAppliedFilters||[],Zt=re.addLength1||!1,kn=Pe.length,Wn=re.objectId,Mr=function(Aa){return Aa};if(w!==null&&Wn===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");w!==null&&(Mr=ka.encryptor(Wn,0));var ln={};qe===!0&&(qe=["FlateEncode"]);var lr=re.additionalKeyValues||[],ur=(ln=Ci.API.processDataByFilters!==void 0?Ci.API.processDataByFilters(Pe,qe):{data:Pe,reverseChain:[]}).reverseChain+(Array.isArray(Rt)?Rt.join(" "):Rt.toString());if(ln.data.length!==0&&(lr.push({key:"Length",value:ln.data.length}),Zt===!0&&lr.push({key:"Length1",value:kn})),ur.length!=0)if(ur.split("/").length-1==1)lr.push({key:"Filter",value:ur});else{lr.push({key:"Filter",value:"["+ur+"]"});for(var $i=0;$i<lr.length;$i+=1)if(lr[$i].key==="DecodeParms"){for(var aa=[],Hr=0;Hr<ln.reverseChain.split("/").length-1;Hr+=1)aa.push("null");aa.push(lr[$i].value),lr[$i].value="["+aa.join(" ")+"]"}}st("<<");for(var oa=0;oa<lr.length;oa++)st("/"+lr[oa].key+" "+lr[oa].value);st(">>"),ln.data.length!==0&&(st("stream"),st(Mr(ln.data)),st("endstream"))},vr=E.__private__.putPage=function(re){var Pe=re.number,qe=re.data,Rt=re.objId,Zt=re.contentsObjId;We(Rt,!0),st("<</Type /Page"),st("/Parent "+re.rootDictionaryObjId+" 0 R"),st("/Resources "+re.resourceDictionaryObjId+" 0 R"),st("/MediaBox ["+parseFloat(pe(re.mediaBox.bottomLeftX))+" "+parseFloat(pe(re.mediaBox.bottomLeftY))+" "+pe(re.mediaBox.topRightX)+" "+pe(re.mediaBox.topRightY)+"]"),re.cropBox!==null&&st("/CropBox ["+pe(re.cropBox.bottomLeftX)+" "+pe(re.cropBox.bottomLeftY)+" "+pe(re.cropBox.topRightX)+" "+pe(re.cropBox.topRightY)+"]"),re.bleedBox!==null&&st("/BleedBox ["+pe(re.bleedBox.bottomLeftX)+" "+pe(re.bleedBox.bottomLeftY)+" "+pe(re.bleedBox.topRightX)+" "+pe(re.bleedBox.topRightY)+"]"),re.trimBox!==null&&st("/TrimBox ["+pe(re.trimBox.bottomLeftX)+" "+pe(re.trimBox.bottomLeftY)+" "+pe(re.trimBox.topRightX)+" "+pe(re.trimBox.topRightY)+"]"),re.artBox!==null&&st("/ArtBox ["+pe(re.artBox.bottomLeftX)+" "+pe(re.artBox.bottomLeftY)+" "+pe(re.artBox.topRightX)+" "+pe(re.artBox.topRightY)+"]"),typeof re.userUnit=="number"&&re.userUnit!==1&&st("/UserUnit "+re.userUnit),xs.publish("putPage",{objId:Rt,pageContext:_i[Pe],pageNumber:Pe,page:qe}),st("/Contents "+Zt+" 0 R"),st(">>"),st("endobj");var kn=qe.join(`
`);return J===H&&(kn+=`
Q`),We(Zt,!0),ar({data:kn,filters:Vn(),objectId:Zt}),st("endobj"),Rt},Gr=E.__private__.putPages=function(){var re,Pe,qe=[];for(re=1;re<=ts;re++)_i[re].objId=He(),_i[re].contentsObjId=He();for(re=1;re<=ts;re++)qe.push(vr({number:re,data:Ht[re],objId:_i[re].objId,contentsObjId:_i[re].contentsObjId,mediaBox:_i[re].mediaBox,cropBox:_i[re].cropBox,bleedBox:_i[re].bleedBox,trimBox:_i[re].trimBox,artBox:_i[re].artBox,userUnit:_i[re].userUnit,rootDictionaryObjId:ot,resourceDictionaryObjId:Et}));We(ot,!0),st("<</Type /Pages");var Rt="/Kids [";for(Pe=0;Pe<ts;Pe++)Rt+=qe[Pe]+" 0 R ";st(Rt+"]"),st("/Count "+ts),st(">>"),st("endobj"),xs.publish("postPutPages")},Fr=function(re){xs.publish("putFont",{font:re,out:st,newObject:Xe,putStream:ar}),re.isAlreadyPutted!==!0&&(re.objectNumber=Xe(),st("<<"),st("/Type /Font"),st("/BaseFont /"+F1(re.postScriptName)),st("/Subtype /Type1"),typeof re.encoding=="string"&&st("/Encoding /"+re.encoding),st("/FirstChar 32"),st("/LastChar 255"),st(">>"),st("endobj"))},pi=function(re){re.objectNumber=Xe();var Pe=[];Pe.push({key:"Type",value:"/XObject"}),Pe.push({key:"Subtype",value:"/Form"}),Pe.push({key:"BBox",value:"["+[pe(re.x),pe(re.y),pe(re.x+re.width),pe(re.y+re.height)].join(" ")+"]"}),Pe.push({key:"Matrix",value:"["+re.matrix.toString()+"]"});var qe=re.pages[1].join(`
`);ar({data:qe,additionalKeyValues:Pe,objectId:re.objectNumber}),st("endobj")},Vi=function(re,Pe){Pe||(Pe=21);var qe=Xe(),Rt=function(Wn,Mr){var ln,lr=[],ur=1/(Mr-1);for(ln=0;ln<1;ln+=ur)lr.push(ln);if(lr.push(1),Wn[0].offset!=0){var $i={offset:0,color:Wn[0].color};Wn.unshift($i)}if(Wn[Wn.length-1].offset!=1){var aa={offset:1,color:Wn[Wn.length-1].color};Wn.push(aa)}for(var Hr="",oa=0,Aa=0;Aa<lr.length;Aa++){for(ln=lr[Aa];ln>Wn[oa+1].offset;)oa++;var Oa=Wn[oa].offset,Bs=(ln-Oa)/(Wn[oa+1].offset-Oa),Cs=Wn[oa].color,dc=Wn[oa+1].color;Hr+=vt(Math.round((1-Bs)*Cs[0]+Bs*dc[0]).toString(16))+vt(Math.round((1-Bs)*Cs[1]+Bs*dc[1]).toString(16))+vt(Math.round((1-Bs)*Cs[2]+Bs*dc[2]).toString(16))}return Hr.trim()}(re.colors,Pe),Zt=[];Zt.push({key:"FunctionType",value:"0"}),Zt.push({key:"Domain",value:"[0.0 1.0]"}),Zt.push({key:"Size",value:"["+Pe+"]"}),Zt.push({key:"BitsPerSample",value:"8"}),Zt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Zt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ar({data:Rt,additionalKeyValues:Zt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:qe}),st("endobj"),re.objectNumber=Xe(),st("<< /ShadingType "+re.type),st("/ColorSpace /DeviceRGB");var kn="/Coords ["+pe(parseFloat(re.coords[0]))+" "+pe(parseFloat(re.coords[1]))+" ";re.type===2?kn+=pe(parseFloat(re.coords[2]))+" "+pe(parseFloat(re.coords[3])):kn+=pe(parseFloat(re.coords[2]))+" "+pe(parseFloat(re.coords[3]))+" "+pe(parseFloat(re.coords[4]))+" "+pe(parseFloat(re.coords[5])),st(kn+="]"),re.matrix&&st("/Matrix ["+re.matrix.toString()+"]"),st("/Function "+qe+" 0 R"),st("/Extend [true true]"),st(">>"),st("endobj")},ai=function(re,Pe){var qe=He(),Rt=Xe();Pe.push({resourcesOid:qe,objectOid:Rt}),re.objectNumber=Rt;var Zt=[];Zt.push({key:"Type",value:"/Pattern"}),Zt.push({key:"PatternType",value:"1"}),Zt.push({key:"PaintType",value:"1"}),Zt.push({key:"TilingType",value:"1"}),Zt.push({key:"BBox",value:"["+re.boundingBox.map(pe).join(" ")+"]"}),Zt.push({key:"XStep",value:pe(re.xStep)}),Zt.push({key:"YStep",value:pe(re.yStep)}),Zt.push({key:"Resources",value:qe+" 0 R"}),re.matrix&&Zt.push({key:"Matrix",value:"["+re.matrix.toString()+"]"}),ar({data:re.stream,additionalKeyValues:Zt,objectId:re.objectNumber}),st("endobj")},Js=function(re){for(var Pe in re.objectNumber=Xe(),st("<<"),re)switch(Pe){case"opacity":st("/ca "+fe(re[Pe]));break;case"stroke-opacity":st("/CA "+fe(re[Pe]))}st(">>"),st("endobj")},ha=function(re){We(re.resourcesOid,!0),st("<<"),st("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var Pe in st("/Font <<"),Cr)Cr.hasOwnProperty(Pe)&&(C===!1||C===!0&&P.hasOwnProperty(Pe))&&st("/"+Pe+" "+Cr[Pe].objectNumber+" 0 R");st(">>")}(),function(){if(Object.keys(bn).length>0){for(var Pe in st("/Shading <<"),bn)bn.hasOwnProperty(Pe)&&bn[Pe]instanceof T_&&bn[Pe].objectNumber>=0&&st("/"+Pe+" "+bn[Pe].objectNumber+" 0 R");xs.publish("putShadingPatternDict"),st(">>")}}(),function(Pe){if(Object.keys(bn).length>0){for(var qe in st("/Pattern <<"),bn)bn.hasOwnProperty(qe)&&bn[qe]instanceof E.TilingPattern&&bn[qe].objectNumber>=0&&bn[qe].objectNumber<Pe&&st("/"+qe+" "+bn[qe].objectNumber+" 0 R");xs.publish("putTilingPatternDict"),st(">>")}}(re.objectOid),function(){if(Object.keys(Ur).length>0){var Pe;for(Pe in st("/ExtGState <<"),Ur)Ur.hasOwnProperty(Pe)&&Ur[Pe].objectNumber>=0&&st("/"+Pe+" "+Ur[Pe].objectNumber+" 0 R");xs.publish("putGStateDict"),st(">>")}}(),function(){for(var Pe in st("/XObject <<"),zt)zt.hasOwnProperty(Pe)&&zt[Pe].objectNumber>=0&&st("/"+Pe+" "+zt[Pe].objectNumber+" 0 R");xs.publish("putXobjectDict"),st(">>")}(),st(">>"),st("endobj")},xa=function(re){fi[re.fontName]=fi[re.fontName]||{},fi[re.fontName][re.fontStyle]=re.id},Wi=function(re,Pe,qe,Rt,Zt){var kn={id:"F"+(Object.keys(Cr).length+1).toString(10),postScriptName:re,fontName:Pe,fontStyle:qe,encoding:Rt,isStandardFont:Zt||!1,metadata:{}};return xs.publish("addFont",{font:kn,instance:this}),Cr[kn.id]=kn,xa(kn),kn.id},bi=E.__private__.pdfEscape=E.pdfEscape=function(re,Pe){return function(qe,Rt){var Zt,kn,Wn,Mr,ln,lr,ur,$i,aa;if(Wn=(Rt=Rt||{}).sourceEncoding||"Unicode",ln=Rt.outputEncoding,(Rt.autoencode||ln)&&Cr[wr].metadata&&Cr[wr].metadata[Wn]&&Cr[wr].metadata[Wn].encoding&&(Mr=Cr[wr].metadata[Wn].encoding,!ln&&Cr[wr].encoding&&(ln=Cr[wr].encoding),!ln&&Mr.codePages&&(ln=Mr.codePages[0]),typeof ln=="string"&&(ln=Mr[ln]),ln)){for(ur=!1,lr=[],Zt=0,kn=qe.length;Zt<kn;Zt++)($i=ln[qe.charCodeAt(Zt)])?lr.push(String.fromCharCode($i)):lr.push(qe[Zt]),lr[Zt].charCodeAt(0)>>8&&(ur=!0);qe=lr.join("")}for(Zt=qe.length;ur===void 0&&Zt!==0;)qe.charCodeAt(Zt-1)>>8&&(ur=!0),Zt--;if(!ur)return qe;for(lr=Rt.noBOM?[]:[254,255],Zt=0,kn=qe.length;Zt<kn;Zt++){if((aa=($i=qe.charCodeAt(Zt))>>8)>>8)throw new Error("Character at position "+Zt+" of string '"+qe+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");lr.push(aa),lr.push($i-(aa<<8))}return String.fromCharCode.apply(void 0,lr)}(re,Pe).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ns=E.__private__.beginPage=function(re){Ht[++ts]=[],_i[ts]={objId:0,contentsObjId:0,userUnit:Number(i),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(re[0]),topRightY:Number(re[1])}},Ja(ts),Kt(Ht[Ye])},zs=function(re,Pe){var qe,Rt,Zt;switch(n=Pe||n,typeof re=="string"&&(qe=F(re.toLowerCase()),Array.isArray(qe)&&(Rt=qe[0],Zt=qe[1])),Array.isArray(re)&&(Rt=re[0]*Qr,Zt=re[1]*Qr),isNaN(Rt)&&(Rt=a[0],Zt=a[1]),(Rt>14400||Zt>14400)&&(Ka.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Rt=Math.min(14400,Rt),Zt=Math.min(14400,Zt)),a=[Rt,Zt],n.substr(0,1)){case"l":Zt>Rt&&(a=[Zt,Rt]);break;case"p":Rt>Zt&&(a=[Zt,Rt])}Ns(a),jh(Df),st(Xd),Mu!==0&&st(Mu+" J"),Fp!==0&&st(Fp+" j"),xs.publish("addPage",{pageNumber:ts})},as=function(re){re>0&&re<=ts&&(Ht.splice(re,1),_i.splice(re,1),ts--,Ye>ts&&(Ye=ts),this.setPage(Ye))},Ja=function(re){re>0&&re<=ts&&(Ye=re)},Vo=E.__private__.getNumberOfPages=E.getNumberOfPages=function(){return Ht.length-1},Cl=function(re,Pe,qe){var Rt,Zt=void 0;return qe=qe||{},re=re!==void 0?re:Cr[wr].fontName,Pe=Pe!==void 0?Pe:Cr[wr].fontStyle,Rt=re.toLowerCase(),fi[Rt]!==void 0&&fi[Rt][Pe]!==void 0?Zt=fi[Rt][Pe]:fi[re]!==void 0&&fi[re][Pe]!==void 0?Zt=fi[re][Pe]:qe.disableWarning===!1&&Ka.warn("Unable to look up font label for font '"+re+"', '"+Pe+"'. Refer to getFontList() for available fonts."),Zt||qe.noFallback||(Zt=fi.times[Pe])==null&&(Zt=fi.times.normal),Zt},ac=E.__private__.putInfo=function(){var re=Xe(),Pe=function(Rt){return Rt};for(var qe in w!==null&&(Pe=ka.encryptor(re,0)),st("<<"),st("/Producer ("+bi(Pe("jsPDF "+Ci.version))+")"),Pr)Pr.hasOwnProperty(qe)&&Pr[qe]&&st("/"+qe.substr(0,1).toUpperCase()+qe.substr(1)+" ("+bi(Pe(Pr[qe]))+")");st("/CreationDate ("+bi(Pe(Re))+")"),st(">>"),st("endobj")},$o=E.__private__.putCatalog=function(re){var Pe=(re=re||{}).rootDictionaryObjId||ot;switch(Xe(),st("<<"),st("/Type /Catalog"),st("/Pages "+Pe+" 0 R"),ht||(ht="fullwidth"),ht){case"fullwidth":st("/OpenAction [3 0 R /FitH null]");break;case"fullheight":st("/OpenAction [3 0 R /FitV null]");break;case"fullpage":st("/OpenAction [3 0 R /Fit]");break;case"original":st("/OpenAction [3 0 R /XYZ null null 1]");break;default:var qe=""+ht;qe.substr(qe.length-1)==="%"&&(ht=parseInt(ht)/100),typeof ht=="number"&&st("/OpenAction [3 0 R /XYZ null null "+fe(ht)+"]")}switch(Sn||(Sn="continuous"),Sn){case"continuous":st("/PageLayout /OneColumn");break;case"single":st("/PageLayout /SinglePage");break;case"two":case"twoleft":st("/PageLayout /TwoColumnLeft");break;case"tworight":st("/PageLayout /TwoColumnRight")}xn&&st("/PageMode /"+xn),xs.publish("putCatalog"),st(">>"),st("endobj")},Pa=E.__private__.putTrailer=function(){st("trailer"),st("<<"),st("/Size "+(gt+1)),st("/Root "+gt+" 0 R"),st("/Info "+(gt-1)+" 0 R"),w!==null&&st("/Encrypt "+ka.oid+" 0 R"),st("/ID [ <"+Qe+"> <"+Qe+"> ]"),st(">>")},Qm=E.__private__.putHeader=function(){st("%PDF-"+j),st("%")},ku=E.__private__.putXRef=function(){var re="0000000000";st("xref"),st("0 "+(gt+1)),st("0000000000 65535 f ");for(var Pe=1;Pe<=gt;Pe++)typeof dt[Pe]=="function"?st((re+dt[Pe]()).slice(-10)+" 00000 n "):dt[Pe]!==void 0?st((re+dt[Pe]).slice(-10)+" 00000 n "):st("0000000000 00000 n ")},oc=E.__private__.buildDocument=function(){var re;gt=0,mt=0,At=[],dt=[],Pt=[],ot=He(),Et=He(),Kt(At),xs.publish("buildDocument"),Qm(),Gr(),function(){xs.publish("putAdditionalObjects");for(var qe=0;qe<Pt.length;qe++){var Rt=Pt[qe];We(Rt.objId,!0),st(Rt.content),st("endobj")}xs.publish("postPutAdditionalObjects")}(),re=[],function(){for(var qe in Cr)Cr.hasOwnProperty(qe)&&(C===!1||C===!0&&P.hasOwnProperty(qe))&&Fr(Cr[qe])}(),function(){var qe;for(qe in Ur)Ur.hasOwnProperty(qe)&&Js(Ur[qe])}(),function(){for(var qe in zt)zt.hasOwnProperty(qe)&&pi(zt[qe])}(),function(qe){var Rt;for(Rt in bn)bn.hasOwnProperty(Rt)&&(bn[Rt]instanceof T_?Vi(bn[Rt]):bn[Rt]instanceof ab&&ai(bn[Rt],qe))}(re),xs.publish("putResources"),re.forEach(ha),ha({resourcesOid:Et,objectOid:Number.MAX_SAFE_INTEGER}),xs.publish("postPutResources"),w!==null&&(ka.oid=Xe(),st("<<"),st("/Filter /Standard"),st("/V "+ka.v),st("/R "+ka.r),st("/U <"+ka.toHexString(ka.U)+">"),st("/O <"+ka.toHexString(ka.O)+">"),st("/P "+ka.P),st(">>"),st("endobj")),ac(),$o();var Pe=mt;return ku(),Pa(),st("startxref"),st(""+Pe),st("%%EOF"),Kt(Ht[Ye]),At.join(`
`)},Iu=E.__private__.getBlob=function(re){return new Blob([Or(re)],{type:"application/pdf"})},$l=E.output=E.__private__.output=(Ie=function(re,Pe){switch(typeof(Pe=Pe||{})=="string"?Pe={filename:Pe}:Pe.filename=Pe.filename||"generated.pdf",re){case void 0:return oc();case"save":E.save(Pe.filename);break;case"arraybuffer":return Or(oc());case"blob":return Iu(oc());case"bloburi":case"bloburl":if(Ji.URL!==void 0&&typeof Ji.URL.createObjectURL=="function")return Ji.URL&&Ji.URL.createObjectURL(Iu(oc()))||void 0;Ka.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var qe="",Rt=oc();try{qe=lY(Rt)}catch{qe=lY(unescape(encodeURIComponent(Rt)))}return"data:application/pdf;filename="+Pe.filename+";base64,"+qe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ji)==="[object Window]"){var Zt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",kn=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Pe.pdfObjectUrl&&(Zt=Pe.pdfObjectUrl,kn="");var Wn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Zt+'"'+kn+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Pe)+");<\/script></body></html>",Mr=Ji.open();return Mr!==null&&Mr.document.write(Wn),Mr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ji)==="[object Window]"){var ln='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Pe.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Pe.filename+'" width="500px" height="400px" /></body></html>',lr=Ji.open();if(lr!==null){lr.document.write(ln);var ur=this;lr.document.documentElement.querySelector("#pdfViewer").onload=function(){lr.document.title=Pe.filename,lr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ur.output("bloburl"))}}return lr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ji)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var $i='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Pe)+'"></iframe></body></html>',aa=Ji.open();if(aa!==null&&(aa.document.write($i),aa.document.title=Pe.filename),aa||typeof safari>"u")return aa;break;case"datauri":case"dataurl":return Ji.document.location.href=this.output("datauristring",Pe);default:return null}},Ie.foo=function(){try{return Ie.apply(this,arguments)}catch(qe){var re=qe.stack||"";~re.indexOf(" at ")&&(re=re.split(" at ")[1]);var Pe="Error in function "+re.split(`
`)[0].split("<")[0]+": "+qe.message;if(!Ji.console)throw new Error(Pe);Ji.console.error(Pe,qe),Ji.alert&&alert(Pe)}},Ie.foo.bar=Ie,Ie.foo),lc=function(re){return Array.isArray(Pi)===!0&&Pi.indexOf(re)>-1};switch(r){case"pt":Qr=1;break;case"mm":Qr=72/25.4;break;case"cm":Qr=72/2.54;break;case"in":Qr=72;break;case"px":Qr=lc("px_scaling")==1?.75:96/72;break;case"pc":case"em":Qr=12;break;case"ex":Qr=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);Qr=r}var ka=null;xt(),je();var Mf=E.__private__.getPageInfo=E.getPageInfo=function(re){if(isNaN(re)||re%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:_i[re].objId,pageNumber:re,pageContext:_i[re]}},Yc=E.__private__.getPageInfoByObjId=function(re){if(isNaN(re)||re%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Pe in _i)if(_i[Pe].objId===re)break;return Mf(Pe)},eg=E.__private__.getCurrentPageInfo=E.getCurrentPageInfo=function(){return{objId:_i[Ye].objId,pageNumber:Ye,pageContext:_i[Ye]}};E.addPage=function(){return zs.apply(this,arguments),this},E.setPage=function(){return Ja.apply(this,arguments),Kt.call(this,Ht[Ye]),this},E.insertPage=function(re){return this.addPage(),this.movePage(Ye,re),this},E.movePage=function(re,Pe){var qe,Rt;if(re>Pe){qe=Ht[re],Rt=_i[re];for(var Zt=re;Zt>Pe;Zt--)Ht[Zt]=Ht[Zt-1],_i[Zt]=_i[Zt-1];Ht[Pe]=qe,_i[Pe]=Rt,this.setPage(Pe)}else if(re<Pe){qe=Ht[re],Rt=_i[re];for(var kn=re;kn<Pe;kn++)Ht[kn]=Ht[kn+1],_i[kn]=_i[kn+1];Ht[Pe]=qe,_i[Pe]=Rt,this.setPage(Pe)}return this},E.deletePage=function(){return as.apply(this,arguments),this},E.__private__.text=E.text=function(re,Pe,qe,Rt,Zt){var kn,Wn,Mr,ln,lr,ur,$i,aa,Hr,oa=(Rt=Rt||{}).scope||this;if(typeof re=="number"&&typeof Pe=="number"&&(typeof qe=="string"||Array.isArray(qe))){var Aa=qe;qe=Pe,Pe=re,re=Aa}if(arguments[3]instanceof qr==0?(Mr=arguments[4],ln=arguments[5],Da($i=arguments[3])==="object"&&$i!==null||(typeof Mr=="string"&&(ln=Mr,Mr=null),typeof $i=="string"&&(ln=$i,$i=null),typeof $i=="number"&&(Mr=$i,$i=null),Rt={flags:$i,angle:Mr,align:ln})):(he("The transform parameter of text() with a Matrix value"),Hr=Zt),isNaN(Pe)||isNaN(qe)||re==null)throw new Error("Invalid arguments passed to jsPDF.text");if(re.length===0)return oa;var Oa,Bs="",Cs=typeof Rt.lineHeightFactor=="number"?Rt.lineHeightFactor:qo,dc=oa.internal.scaleFactor;function Fh(ia){return ia=ia.split("	").join(Array(Rt.TabLen||9).join(" ")),bi(ia,$i)}function zh(ia){for(var sa,no=ia.concat(),ro=[],ko=no.length;ko--;)typeof(sa=no.shift())=="string"?ro.push(sa):Array.isArray(ia)&&(sa.length===1||sa[1]===void 0&&sa[2]===void 0)?ro.push(sa[0]):ro.push([sa[0],sa[1],sa[2]]);return ro}function Du(ia,sa){var no;if(typeof ia=="string")no=sa(ia)[0];else if(Array.isArray(ia)){for(var ro,ko,Up=ia.concat(),jf=[],ig=Up.length;ig--;)typeof(ro=Up.shift())=="string"?jf.push(sa(ro)[0]):Array.isArray(ro)&&typeof ro[0]=="string"&&(ko=sa(ro[0],ro[1],ro[2]),jf.push([ko[0],ko[1],ko[2]]));no=jf}return no}var ru=!1,hc=!0;if(typeof re=="string")ru=!0;else if(Array.isArray(re)){var yd=re.concat();Wn=[];for(var eo,Ta=yd.length;Ta--;)(typeof(eo=yd.shift())!="string"||Array.isArray(eo)&&typeof eo[0]!="string")&&(hc=!1);ru=hc}if(ru===!1)throw new Error('Type of text must be string or Array. "'+re+'" is not recognized.');typeof re=="string"&&(re=re.match(/[\r?\n]/)?re.split(/\r\n|\r|\n/g):[re]);var fo=On/oa.internal.scaleFactor,Bh=fo*(Cs-1);switch(Rt.baseline){case"bottom":qe-=Bh;break;case"top":qe+=fo-Bh;break;case"hanging":qe+=fo-2*Bh;break;case"middle":qe+=fo/2-Bh}if((ur=Rt.maxWidth||0)>0&&(typeof re=="string"?re=oa.splitTextToSize(re,ur):Object.prototype.toString.call(re)==="[object Array]"&&(re=re.reduce(function(ia,sa){return ia.concat(oa.splitTextToSize(sa,ur))},[]))),kn={text:re,x:Pe,y:qe,options:Rt,mutex:{pdfEscape:bi,activeFontKey:wr,fonts:Cr,activeFontSize:On}},xs.publish("preProcessText",kn),re=kn.text,Mr=(Rt=kn.options).angle,Hr instanceof qr==0&&Mr&&typeof Mr=="number"){Mr*=Math.PI/180,Rt.rotationDirection===0&&(Mr=-Mr),J===H&&(Mr=-Mr);var vd=Math.cos(Mr),Ca=Math.sin(Mr);Hr=new qr(vd,Ca,-Ca,vd,0,0)}else Mr&&Mr instanceof qr&&(Hr=Mr);J!==H||Hr||(Hr=de),(lr=Rt.charSpace||Jd)!==void 0&&(Bs+=pe(Ce(lr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(aa=Rt.horizontalScale)!==void 0&&(Bs+=pe(100*aa)+` Tz
`),Rt.lang;var bs=-1,kr=Rt.renderingMode!==void 0?Rt.renderingMode:Rt.stroke,Ln=oa.internal.getCurrentPageInfo().pageContext;switch(kr){case 0:case!1:case"fill":bs=0;break;case 1:case!0:case"stroke":bs=1;break;case 2:case"fillThenStroke":bs=2;break;case 3:case"invisible":bs=3;break;case 4:case"fillAndAddForClipping":bs=4;break;case 5:case"strokeAndAddPathForClipping":bs=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":bs=6;break;case 7:case"addToPathForClipping":bs=7}var Uh=Ln.usedRenderingMode!==void 0?Ln.usedRenderingMode:-1;bs!==-1?Bs+=bs+` Tr
`:Uh!==-1&&(Bs+=`0 Tr
`),bs!==-1&&(Ln.usedRenderingMode=bs),ln=Rt.align||"left";var sr,Nc=On*Cs,_d=oa.internal.pageSize.getWidth(),hr=Cr[wr];lr=Rt.charSpace||Jd,ur=Rt.maxWidth||0,$i=Object.assign({autoencode:!0,noBOM:!0},Rt.flags);var xd=[],Ru=function(ia){return oa.getStringUnitWidth(ia,{font:hr,charSpace:lr,fontSize:On,doKerning:!1})*On/dc};if(Object.prototype.toString.call(re)==="[object Array]"){var dl;Wn=zh(re),ln!=="left"&&(sr=Wn.map(Ru));var ql,ju=0;if(ln==="right"){Pe-=sr[0],re=[],Ta=Wn.length;for(var Ms=0;Ms<Ta;Ms++)Ms===0?(ql=mi(Pe),dl=uc(qe)):(ql=Ce(ju-sr[Ms]),dl=-Nc),re.push([Wn[Ms],ql,dl]),ju=sr[Ms]}else if(ln==="center"){Pe-=sr[0]/2,re=[],Ta=Wn.length;for(var bd=0;bd<Ta;bd++)bd===0?(ql=mi(Pe),dl=uc(qe)):(ql=Ce((ju-sr[bd])/2),dl=-Nc),re.push([Wn[bd],ql,dl]),ju=sr[bd]}else if(ln==="left"){re=[],Ta=Wn.length;for(var Mc=0;Mc<Ta;Mc++)re.push(Wn[Mc])}else if(ln==="justify"&&hr.encoding==="Identity-H"){re=[],Ta=Wn.length,ur=ur!==0?ur:_d;for(var po=0,fa=0;fa<Ta;fa++)if(dl=fa===0?uc(qe):-Nc,ql=fa===0?mi(Pe):po,fa<Ta-1){var to=Ce((ur-sr[fa])/(Wn[fa].split(" ").length-1)),Ou=Wn[fa].split(" ");re.push([Ou[0]+" ",ql,dl]),po=0;for(var fc=1;fc<Ou.length;fc++){var rg=(Ru(Ou[fc-1]+" "+Ou[fc])-Ru(Ou[fc]))*dc+to;fc==Ou.length-1?re.push([Ou[fc],rg,0]):re.push([Ou[fc]+" ",rg,0]),po-=rg}}else re.push([Wn[fa],ql,dl]);re.push(["",po,0])}else{if(ln!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(re=[],Ta=Wn.length,ur=ur!==0?ur:_d,fa=0;fa<Ta;fa++){dl=fa===0?uc(qe):-Nc,ql=fa===0?mi(Pe):0;var Vh=Wn[fa].split(" ").length-1,wd=Vh>0?(ur-sr[fa])/Vh:0;fa<Ta-1?xd.push(pe(Ce(wd))):xd.push(0),re.push([Wn[fa],ql,dl])}}}(typeof Rt.R2L=="boolean"?Rt.R2L:Wt)===!0&&(re=Du(re,function(ia,sa,no){return[ia.split("").reverse().join(""),sa,no]})),kn={text:re,x:Pe,y:qe,options:Rt,mutex:{pdfEscape:bi,activeFontKey:wr,fonts:Cr,activeFontSize:On}},xs.publish("postProcessText",kn),re=kn.text,Oa=kn.mutex.isHex||!1;var Gl=Cr[wr].encoding;Gl!=="WinAnsiEncoding"&&Gl!=="StandardEncoding"||(re=Du(re,function(ia,sa,no){return[Fh(ia),sa,no]})),Wn=zh(re),re=[];for(var $h,Lc,th,Sd=Array.isArray(Wn[0])?1:0,Fu="",pc=function(ia,sa,no){var ro="";return no instanceof qr?(no=typeof Rt.angle=="number"?lt(no,new qr(1,0,0,1,ia,sa)):lt(new qr(1,0,0,1,ia,sa),no),J===H&&(no=lt(new qr(1,0,0,-1,0,0),no)),ro=no.join(" ")+` Tm
`):ro=pe(ia)+" "+pe(sa)+` Td
`,ro},Jo=0;Jo<Wn.length;Jo++){switch(Fu="",Sd){case 1:th=(Oa?"<":"(")+Wn[Jo][0]+(Oa?">":")"),$h=parseFloat(Wn[Jo][1]),Lc=parseFloat(Wn[Jo][2]);break;case 0:th=(Oa?"<":"(")+Wn[Jo]+(Oa?">":")"),$h=mi(Pe),Lc=uc(qe)}xd!==void 0&&xd[Jo]!==void 0&&(Fu=xd[Jo]+` Tw
`),Jo===0?re.push(Fu+pc($h,Lc,Hr)+th):Sd===0?re.push(Fu+th):Sd===1&&re.push(Fu+pc($h,Lc,Hr)+th)}re=Sd===0?re.join(` Tj
T* `):re.join(` Tj
`),re+=` Tj
`;var Ad=`BT
/`;return Ad+=wr+" "+On+` Tf
`,Ad+=pe(On*Cs)+` TL
`,Ad+=tu+`
`,Ad+=Bs,Ad+=re,st(Ad+="ET"),P[wr]=!0,oa};var Rp=E.__private__.clip=E.clip=function(re){return st(re==="evenodd"?"W*":"W"),this};E.clipEvenOdd=function(){return Rp("evenodd")},E.__private__.discardPath=E.discardPath=function(){return st("n"),this};var Qa=E.__private__.isValidStyle=function(re){var Pe=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(re)!==-1&&(Pe=!0),Pe};E.__private__.setDefaultPathOperation=E.setDefaultPathOperation=function(re){return Qa(re)&&(x=re),this};var cc=E.__private__.getStyle=E.getStyle=function(re){var Pe=x;switch(re){case"D":case"S":Pe="S";break;case"F":Pe="f";break;case"FD":case"DF":Pe="B";break;case"f":case"f*":case"B":case"B*":Pe=re}return Pe},Xc=E.close=function(){return st("h"),this};E.stroke=function(){return st("S"),this},E.fill=function(re){return Xo("f",re),this},E.fillEvenOdd=function(re){return Xo("f*",re),this},E.fillStroke=function(re){return Xo("B",re),this},E.fillStrokeEvenOdd=function(re){return Xo("B*",re),this};var Xo=function(re,Pe){Da(Pe)==="object"?tg(Pe,re):st(re)},Po=function(re){re===null||J===H&&re===void 0||(re=cc(re),st(re))};function Yd(re,Pe,qe,Rt,Zt){var kn=new ab(Pe||this.boundingBox,qe||this.xStep,Rt||this.yStep,this.gState,Zt||this.matrix);kn.stream=this.stream;var Wn=re+"$$"+this.cloneIndex+++"$$";return _e(Wn,kn),kn}var tg=function(re,Pe){var qe=fr[re.key],Rt=bn[qe];if(Rt instanceof T_)st("q"),st(Lf(Pe)),Rt.gState&&E.setGState(Rt.gState),st(re.matrix.toString()+" cm"),st("/"+qe+" sh"),st("Q");else if(Rt instanceof ab){var Zt=new qr(1,0,0,-1,0,Ii());re.matrix&&(Zt=Zt.multiply(re.matrix||de),qe=Yd.call(Rt,re.key,re.boundingBox,re.xStep,re.yStep,Zt).id),st("q"),st("/Pattern cs"),st("/"+qe+" scn"),Rt.gState&&E.setGState(Rt.gState),st(Pe),st("Q")}},Lf=function(re){switch(re){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Jc=E.moveTo=function(re,Pe){return st(pe(Ce(re))+" "+pe(xe(Pe))+" m"),this},Nu=E.lineTo=function(re,Pe){return st(pe(Ce(re))+" "+pe(xe(Pe))+" l"),this},Qc=E.curveTo=function(re,Pe,qe,Rt,Zt,kn){return st([pe(Ce(re)),pe(xe(Pe)),pe(Ce(qe)),pe(xe(Rt)),pe(Ce(Zt)),pe(xe(kn)),"c"].join(" ")),this};E.__private__.line=E.line=function(re,Pe,qe,Rt,Zt){if(isNaN(re)||isNaN(Pe)||isNaN(qe)||isNaN(Rt)||!Qa(Zt))throw new Error("Invalid arguments passed to jsPDF.line");return J===$?this.lines([[qe-re,Rt-Pe]],re,Pe,[1,1],Zt||"S"):this.lines([[qe-re,Rt-Pe]],re,Pe,[1,1]).stroke()},E.__private__.lines=E.lines=function(re,Pe,qe,Rt,Zt,kn){var Wn,Mr,ln,lr,ur,$i,aa,Hr,oa,Aa,Oa,Bs;if(typeof re=="number"&&(Bs=qe,qe=Pe,Pe=re,re=Bs),Rt=Rt||[1,1],kn=kn||!1,isNaN(Pe)||isNaN(qe)||!Array.isArray(re)||!Array.isArray(Rt)||!Qa(Zt)||typeof kn!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Jc(Pe,qe),Wn=Rt[0],Mr=Rt[1],lr=re.length,Aa=Pe,Oa=qe,ln=0;ln<lr;ln++)(ur=re[ln]).length===2?(Aa=ur[0]*Wn+Aa,Oa=ur[1]*Mr+Oa,Nu(Aa,Oa)):($i=ur[0]*Wn+Aa,aa=ur[1]*Mr+Oa,Hr=ur[2]*Wn+Aa,oa=ur[3]*Mr+Oa,Aa=ur[4]*Wn+Aa,Oa=ur[5]*Mr+Oa,Qc($i,aa,Hr,oa,Aa,Oa));return kn&&Xc(),Po(Zt),this},E.path=function(re){for(var Pe=0;Pe<re.length;Pe++){var qe=re[Pe],Rt=qe.c;switch(qe.op){case"m":Jc(Rt[0],Rt[1]);break;case"l":Nu(Rt[0],Rt[1]);break;case"c":Qc.apply(this,Rt);break;case"h":Xc()}}return this},E.__private__.rect=E.rect=function(re,Pe,qe,Rt,Zt){if(isNaN(re)||isNaN(Pe)||isNaN(qe)||isNaN(Rt)||!Qa(Zt))throw new Error("Invalid arguments passed to jsPDF.rect");return J===$&&(Rt=-Rt),st([pe(Ce(re)),pe(xe(Pe)),pe(Ce(qe)),pe(Ce(Rt)),"re"].join(" ")),Po(Zt),this},E.__private__.triangle=E.triangle=function(re,Pe,qe,Rt,Zt,kn,Wn){if(isNaN(re)||isNaN(Pe)||isNaN(qe)||isNaN(Rt)||isNaN(Zt)||isNaN(kn)||!Qa(Wn))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[qe-re,Rt-Pe],[Zt-qe,kn-Rt],[re-Zt,Pe-kn]],re,Pe,[1,1],Wn,!0),this},E.__private__.roundedRect=E.roundedRect=function(re,Pe,qe,Rt,Zt,kn,Wn){if(isNaN(re)||isNaN(Pe)||isNaN(qe)||isNaN(Rt)||isNaN(Zt)||isNaN(kn)||!Qa(Wn))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Mr=4/3*(Math.SQRT2-1);return Zt=Math.min(Zt,.5*qe),kn=Math.min(kn,.5*Rt),this.lines([[qe-2*Zt,0],[Zt*Mr,0,Zt,kn-kn*Mr,Zt,kn],[0,Rt-2*kn],[0,kn*Mr,-Zt*Mr,kn,-Zt,kn],[2*Zt-qe,0],[-Zt*Mr,0,-Zt,-kn*Mr,-Zt,-kn],[0,2*kn-Rt],[0,-kn*Mr,Zt*Mr,-kn,Zt,-kn]],re+Zt,Pe,[1,1],Wn,!0),this},E.__private__.ellipse=E.ellipse=function(re,Pe,qe,Rt,Zt){if(isNaN(re)||isNaN(Pe)||isNaN(qe)||isNaN(Rt)||!Qa(Zt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var kn=4/3*(Math.SQRT2-1)*qe,Wn=4/3*(Math.SQRT2-1)*Rt;return Jc(re+qe,Pe),Qc(re+qe,Pe-Wn,re+kn,Pe-Rt,re,Pe-Rt),Qc(re-kn,Pe-Rt,re-qe,Pe-Wn,re-qe,Pe),Qc(re-qe,Pe+Wn,re-kn,Pe+Rt,re,Pe+Rt),Qc(re+kn,Pe+Rt,re+qe,Pe+Wn,re+qe,Pe),Po(Zt),this},E.__private__.circle=E.circle=function(re,Pe,qe,Rt){if(isNaN(re)||isNaN(Pe)||isNaN(qe)||!Qa(Rt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(re,Pe,qe,qe,Rt)},E.setFont=function(re,Pe,qe){return qe&&(Pe=ne(Pe,qe)),wr=Cl(re,Pe,{disableWarning:!1}),this};var Rh=E.__private__.getFont=E.getFont=function(){return Cr[Cl.apply(E,arguments)]};E.__private__.getFontList=E.getFontList=function(){var re,Pe,qe={};for(re in fi)if(fi.hasOwnProperty(re))for(Pe in qe[re]=[],fi[re])fi[re].hasOwnProperty(Pe)&&qe[re].push(Pe);return qe},E.addFont=function(re,Pe,qe,Rt,Zt){var kn=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&kn.indexOf(arguments[3])!==-1?Zt=arguments[3]:arguments[3]&&kn.indexOf(arguments[3])==-1&&(qe=ne(qe,Rt)),Wi.call(this,re,Pe,qe,Zt=Zt||"Identity-H")};var qo,Df=e.lineWidth||.200025,Li=E.__private__.getLineWidth=E.getLineWidth=function(){return Df},jh=E.__private__.setLineWidth=E.setLineWidth=function(re){return Df=re,st(pe(Ce(re))+" w"),this};E.__private__.setLineDash=Ci.API.setLineDash=Ci.API.setLineDashPattern=function(re,Pe){if(re=re||[],Pe=Pe||0,isNaN(Pe)||!Array.isArray(re))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return re=re.map(function(qe){return pe(Ce(qe))}).join(" "),Pe=pe(Ce(Pe)),st("["+re+"] "+Pe+" d"),this};var jp=E.__private__.getLineHeight=E.getLineHeight=function(){return On*qo};E.__private__.getLineHeight=E.getLineHeight=function(){return On*qo};var ng=E.__private__.setLineHeightFactor=E.setLineHeightFactor=function(re){return typeof(re=re||1.15)=="number"&&(qo=re),this},Op=E.__private__.getLineHeightFactor=E.getLineHeightFactor=function(){return qo};ng(e.lineHeight);var mi=E.__private__.getHorizontalCoordinate=function(re){return Ce(re)},uc=E.__private__.getVerticalCoordinate=function(re){return J===H?re:_i[Ye].mediaBox.topRightY-_i[Ye].mediaBox.bottomLeftY-Ce(re)},Cy=E.__private__.getHorizontalCoordinateString=E.getHorizontalCoordinateString=function(re){return pe(mi(re))},Ey=E.__private__.getVerticalCoordinateString=E.getVerticalCoordinateString=function(re){return pe(uc(re))},Xd=e.strokeColor||"0 G";E.__private__.getStrokeColor=E.getDrawColor=function(){return on(Xd)},E.__private__.setStrokeColor=E.setDrawColor=function(re,Pe,qe,Rt){return Xd=Yt({ch1:re,ch2:Pe,ch3:qe,ch4:Rt,pdfColorType:"draw",precision:2}),st(Xd),this};var eu=e.fillColor||"0 g";E.__private__.getFillColor=E.getFillColor=function(){return on(eu)},E.__private__.setFillColor=E.setFillColor=function(re,Pe,qe,Rt){return eu=Yt({ch1:re,ch2:Pe,ch3:qe,ch4:Rt,pdfColorType:"fill",precision:2}),st(eu),this};var tu=e.textColor||"0 g",pd=E.__private__.getTextColor=E.getTextColor=function(){return on(tu)};E.__private__.setTextColor=E.setTextColor=function(re,Pe,qe,Rt){return tu=Yt({ch1:re,ch2:Pe,ch3:qe,ch4:Rt,pdfColorType:"text",precision:3}),this};var Jd=e.charSpace,Py=E.__private__.getCharSpace=E.getCharSpace=function(){return parseFloat(Jd||0)};E.__private__.setCharSpace=E.setCharSpace=function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Jd=re,this};var Mu=0;E.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},E.__private__.setLineCap=E.setLineCap=function(re){var Pe=E.CapJoinStyles[re];if(Pe===void 0)throw new Error("Line cap style of '"+re+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Mu=Pe,st(Pe+" J"),this};var Fp=0;E.__private__.setLineJoin=E.setLineJoin=function(re){var Pe=E.CapJoinStyles[re];if(Pe===void 0)throw new Error("Line join style of '"+re+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Fp=Pe,st(Pe+" j"),this},E.__private__.setLineMiterLimit=E.__private__.setMiterLimit=E.setLineMiterLimit=E.setMiterLimit=function(re){if(re=re||0,isNaN(re))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return st(pe(Ce(re))+" M"),this},E.GState=u3,E.setGState=function(re){(re=typeof re=="string"?Ur[Xs[re]]:Qd(null,re)).equals(_a)||(st("/"+re.id+" gs"),_a=re)};var Qd=function(re,Pe){if(!re||!Xs[re]){var qe=!1;for(var Rt in Ur)if(Ur.hasOwnProperty(Rt)&&Ur[Rt].equals(Pe)){qe=!0;break}if(qe)Pe=Ur[Rt];else{var Zt="GS"+(Object.keys(Ur).length+1).toString(10);Ur[Zt]=Pe,Pe.id=Zt}return re&&(Xs[re]=Pe.id),xs.publish("addGState",Pe),Pe}};E.addGState=function(re,Pe){return Qd(re,Pe),this},E.saveGraphicsState=function(){return st("q"),Cn.push({key:wr,size:On,color:tu}),this},E.restoreGraphicsState=function(){st("Q");var re=Cn.pop();return wr=re.key,On=re.size,tu=re.color,_a=null,this},E.setCurrentTransformationMatrix=function(re){return st(re.toString()+" cm"),this},E.comment=function(re){return st("#"+re),this};var nu=function(re,Pe){var qe=re||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return qe},set:function(kn){isNaN(kn)||(qe=parseFloat(kn))}});var Rt=Pe||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Rt},set:function(kn){isNaN(kn)||(Rt=parseFloat(kn))}});var Zt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Zt},set:function(kn){Zt=kn.toString()}}),this},Oh=function(re,Pe,qe,Rt){nu.call(this,re,Pe),this.type="rect";var Zt=qe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Zt},set:function(Wn){isNaN(Wn)||(Zt=parseFloat(Wn))}});var kn=Rt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return kn},set:function(Wn){isNaN(Wn)||(kn=parseFloat(Wn))}}),this},El=function(){this.page=ts,this.currentPage=Ye,this.pages=Ht.slice(0),this.pagesContext=_i.slice(0),this.x=dr,this.y=Hi,this.matrix=Bi,this.width=Pl(Ye),this.height=ho(Ye),this.outputDestination=Un,this.id="",this.objectNumber=-1};El.prototype.restore=function(){ts=this.page,Ye=this.currentPage,_i=this.pagesContext,Ht=this.pages,dr=this.x,Hi=this.y,Bi=this.matrix,gd(Ye,this.width),Lu(Ye,this.height),Un=this.outputDestination};var eh=function(re,Pe,qe,Rt,Zt){ja.push(new El),ts=Ye=0,Ht=[],dr=re,Hi=Pe,Bi=Zt,Ns([qe,Rt])};for(var md in E.beginFormObject=function(re,Pe,qe,Rt,Zt){return eh(re,Pe,qe,Rt,Zt),this},E.endFormObject=function(re){return function(Pe){if(es[Pe])ja.pop().restore();else{var qe=new El,Rt="Xo"+(Object.keys(zt).length+1).toString(10);qe.id=Rt,es[Pe]=Rt,zt[Rt]=qe,xs.publish("addFormObject",qe),ja.pop().restore()}}(re),this},E.doFormObject=function(re,Pe){var qe=zt[es[re]];return st("q"),st(Pe.toString()+" cm"),st("/"+qe.id+" Do"),st("Q"),this},E.getFormObject=function(re){var Pe=zt[es[re]];return{x:Pe.x,y:Pe.y,width:Pe.width,height:Pe.height,matrix:Pe.matrix}},E.save=function(re,Pe){return re=re||"generated.pdf",(Pe=Pe||{}).returnPromise=Pe.returnPromise||!1,Pe.returnPromise===!1?(S_(Iu(oc()),re),typeof S_.unload=="function"&&Ji.setTimeout&&setTimeout(S_.unload,911),this):new Promise(function(qe,Rt){try{var Zt=S_(Iu(oc()),re);typeof S_.unload=="function"&&Ji.setTimeout&&setTimeout(S_.unload,911),qe(Zt)}catch(kn){Rt(kn.message)}})},Ci.API)Ci.API.hasOwnProperty(md)&&(md==="events"&&Ci.API.events.length?function(re,Pe){var qe,Rt,Zt;for(Zt=Pe.length-1;Zt!==-1;Zt--)qe=Pe[Zt][0],Rt=Pe[Zt][1],re.subscribe.apply(re,[qe].concat(typeof Rt=="function"?[Rt]:Rt))}(xs,Ci.API.events):E[md]=Ci.API[md]);function Pl(re){return _i[re].mediaBox.topRightX-_i[re].mediaBox.bottomLeftX}function gd(re,Pe){_i[re].mediaBox.topRightX=Pe+_i[re].mediaBox.bottomLeftX}function ho(re){return _i[re].mediaBox.topRightY-_i[re].mediaBox.bottomLeftY}function Lu(re,Pe){_i[re].mediaBox.topRightY=Pe+_i[re].mediaBox.bottomLeftY}var Rf=E.getPageWidth=function(re){return Pl(re=re||Ye)/Qr},zp=E.setPageWidth=function(re,Pe){gd(re,Pe*Qr)},Ii=E.getPageHeight=function(re){return ho(re=re||Ye)/Qr},Bp=E.setPageHeight=function(re,Pe){Lu(re,Pe*Qr)};return E.internal={pdfEscape:bi,getStyle:cc,getFont:Rh,getFontSize:wt,getCharSpace:Py,getTextColor:pd,getLineHeight:jp,getLineHeightFactor:Op,getLineWidth:Li,write:Dr,getHorizontalCoordinate:mi,getVerticalCoordinate:uc,getCoordinateString:Cy,getVerticalCoordinateString:Ey,collections:{},newObject:Xe,newAdditionalObject:kt,newObjectDeferred:He,newObjectDeferredBegin:We,getFilters:Vn,putStream:ar,events:xs,scaleFactor:Qr,pageSize:{getWidth:function(){return Rf(Ye)},setWidth:function(re){zp(Ye,re)},getHeight:function(){return Ii(Ye)},setHeight:function(re){Bp(Ye,re)}},encryptionOptions:w,encryption:ka,getEncryptor:function(re){return w!==null?ka.encryptor(re,0):function(Pe){return Pe}},output:$l,getNumberOfPages:Vo,pages:Ht,out:st,f2:fe,f3:ge,getPageInfo:Mf,getPageInfoByObjId:Yc,getCurrentPageInfo:eg,getPDFVersion:D,Point:nu,Rectangle:Oh,Matrix:qr,hasHotfix:lc},Object.defineProperty(E.internal.pageSize,"width",{get:function(){return Rf(Ye)},set:function(re){zp(Ye,re)},enumerable:!0,configurable:!0}),Object.defineProperty(E.internal.pageSize,"height",{get:function(){return Ii(Ye)},set:function(re){Bp(Ye,re)},enumerable:!0,configurable:!0}),(function(re){for(var Pe=0,qe=Br.length;Pe<qe;Pe++){var Rt=Wi.call(this,re[Pe][0],re[Pe][1],re[Pe][2],Br[Pe][3],!0);C===!1&&(P[Rt]=!0);var Zt=re[Pe][0].split("-");xa({id:Rt,fontName:Zt[0],fontStyle:Zt[1]||""})}xs.publish("addFonts",{fonts:Cr,dictionary:fi})}).call(E,Br),wr="F1",zs(a,n),xs.publish("initialized"),E}O1.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},O1.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},O1.prototype.hexToBytes=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(String.fromCharCode(parseInt(e.substr(n,2),16)));return t.join("")},O1.prototype.processOwnerPassword=function(e,t){return fO(hO(t).substr(0,5),e)},O1.prototype.encryptor=function(e,t){var n=hO(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(r){return fO(n,r)}},u3.prototype.equals=function(e){var t,n="id,objectNumber,equals";if(!e||Da(e)!==Da(this))return!1;var r=0;for(t in this)if(!(n.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;r++}for(t in e)e.hasOwnProperty(t)&&n.indexOf(t)<0&&r--;return r===0},Ci.API={events:[]},Ci.version="3.0.3";var rl=Ci.API,v8=1,Ox=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},L1=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ls=function(e){return e.toFixed(2)},f0=function(e){return e.toFixed(5)};rl.__acroform__={};var Kd=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},hY=function(e){return e*v8},gm=function(e){var t=new Vhe,n=vi.internal.getHeight(e)||0,r=vi.internal.getWidth(e)||0;return t.BBox=[0,0,Number(ls(r)),Number(ls(n))],t},PKe=rl.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},kKe=rl.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},IKe=rl.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},_l=rl.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return IKe(e,t-1)},xl=rl.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return PKe(e,t-1)},bl=rl.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return kKe(e,t-1)},NKe=rl.__acroform__.calculateCoordinates=function(e,t){var n=t.internal.getHorizontalCoordinate,r=t.internal.getVerticalCoordinate,a=e[0],l=e[1],h=e[2],i=e[3],y={};return y.lowerLeft_X=n(a)||0,y.lowerLeft_Y=r(l+i)||0,y.upperRight_X=n(a+h)||0,y.upperRight_Y=r(l)||0,[Number(ls(y.lowerLeft_X)),Number(ls(y.lowerLeft_Y)),Number(ls(y.upperRight_X)),Number(ls(y.upperRight_Y))]},MKe=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],n=e._V||e.DV,r=pO(e,n),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+ls(r.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(r.text),t.push("ET"),t.push("Q"),t.push("EMC");var l=gm(e);return l.scope=e.scope,l.stream=t.join(`
`),l}},pO=function(e,t){var n=e.fontSize===0?e.maxFontSize:e.fontSize,r={text:"",fontSize:""},a=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map(function(fe){return fe.split(`
`)}):a.map(function(fe){return[fe]});var l=n,h=vi.internal.getHeight(e)||0;h=h<0?-h:h;var i=vi.internal.getWidth(e)||0;i=i<0?-i:i;var y=function(fe,ge,Ce){if(fe+1<a.length){var xe=ge+" "+a[fe+1][0];return EE(xe,e,Ce).width<=i-4}return!1};l++;e:for(;l>0;){t="",l--;var x,w,C=EE("3",e,l).height,P=e.multiline?h-l:(h-C)/2,E=P+=2,j=0,D=0,B=0;if(l<=0){t=`(...) Tj
`,t+="% Width of Text: "+EE(t,e,l=12).width+", FieldWidth:"+i+`
`;break}for(var F="",$=0,H=0;H<a.length;H++)if(a.hasOwnProperty(H)){var J=!1;if(a[H].length!==1&&B!==a[H].length-1){if((C+2)*($+2)+2>h)continue e;F+=a[H][B],J=!0,D=H,H--}else{F=(F+=a[H][B]+" ").substr(F.length-1)==" "?F.substr(0,F.length-1):F;var ee=parseInt(H),Q=y(ee,F,l),ne=H>=a.length-1;if(Q&&!ne){F+=" ",B=0;continue}if(Q||ne){if(ne)D=ee;else if(e.multiline&&(C+2)*($+2)+2>h)continue e}else{if(!e.multiline||(C+2)*($+2)+2>h)continue e;D=ee}}for(var pe="",he=j;he<=D;he++){var we=a[he];if(e.multiline){if(he===D){pe+=we[B]+" ",B=(B+1)%we.length;continue}if(he===j){pe+=we[we.length-1]+" ";continue}}pe+=we[0]+" "}switch(pe=pe.substr(pe.length-1)==" "?pe.substr(0,pe.length-1):pe,w=EE(pe,e,l).width,e.textAlign){case"right":x=i-w-2;break;case"center":x=(i-w)/2;break;default:x=2}t+=ls(x)+" "+ls(E)+` Td
`,t+="("+Ox(pe)+`) Tj
`,t+=-ls(x)+` 0 Td
`,E=-(l+2),w=0,j=J?D:D+1,$++,F=""}break}return r.text=t,r.fontSize=l,r},EE=function(e,t,n){var r=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:t.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:a}},LKe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},DKe=function(e,t){var n={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(r){return r.type===n.type&&r.object===n.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(n)},RKe=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Lp.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(LKe)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");v8=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new $he,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in r)if(r.hasOwnProperty(a)){var l=r[a];l.objId=void 0,l.hasAnnotation&&DKe(l,n)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(n){(function(r,a){var l=!r;for(var h in r||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(h)){var i=r[h],y=[],x=i.Rect;if(i.Rect&&(i.Rect=NKe(i.Rect,a)),a.internal.newObjectDeferredBegin(i.objId,!0),i.DA=vi.createDefaultAppearanceStream(i),Da(i)==="object"&&typeof i.getKeyValueListForStream=="function"&&(y=i.getKeyValueListForStream()),i.Rect=x,i.hasAppearanceStream&&!i.appearanceStreamContent){var w=MKe(i);y.push({key:"AP",value:"<</N "+w+">>"}),a.internal.acroformPlugin.xForms.push(w)}if(i.appearanceStreamContent){var C="";for(var P in i.appearanceStreamContent)if(i.appearanceStreamContent.hasOwnProperty(P)){var E=i.appearanceStreamContent[P];if(C+="/"+P+" ",C+="<<",Object.keys(E).length>=1||Array.isArray(E)){for(var h in E)if(E.hasOwnProperty(h)){var j=E[h];typeof j=="function"&&(j=j.call(a,i)),C+="/"+h+" "+j+" ",a.internal.acroformPlugin.xForms.indexOf(j)>=0||a.internal.acroformPlugin.xForms.push(j)}}else typeof(j=E)=="function"&&(j=j.call(a,i)),C+="/"+h+" "+j,a.internal.acroformPlugin.xForms.indexOf(j)>=0||a.internal.acroformPlugin.xForms.push(j);C+=">>"}y.push({key:"AP",value:`<<
`+C+">>"})}a.internal.putStream({additionalKeyValues:y,objectId:i.objId}),a.internal.out("endobj")}l&&function(D,B){for(var F in D)if(D.hasOwnProperty(F)){var $=F,H=D[F];B.internal.newObjectDeferredBegin(H.objId,!0),Da(H)==="object"&&typeof H.putStream=="function"&&H.putStream(),delete D[$]}}(a.internal.acroformPlugin.xForms,a)})(n,e)}),e.internal.acroformPlugin.isInitialized=!0}},Uhe=rl.__acroform__.arrayToPdfArray=function(e,t,n){var r=function(h){return h};if(Array.isArray(e)){for(var a="[",l=0;l<e.length;l++)switch(l!==0&&(a+=" "),Da(e[l])){case"boolean":case"number":case"object":a+=e[l].toString();break;case"string":e[l].substr(0,1)!=="/"?(t!==void 0&&n&&(r=n.internal.getEncryptor(t)),a+="("+Ox(r(e[l].toString()))+")"):a+=e[l].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},W4=function(e,t,n){var r=function(a){return a};return t!==void 0&&n&&(r=n.internal.getEncryptor(t)),(e=e||"").toString(),"("+Ox(r(e))+")"},Mm=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Mm.prototype.toString=function(){return this.objId+" 0 R"},Mm.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Mm.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(l){return l!="content"&&l!="appearanceStreamContent"&&l!="scope"&&l!="objId"&&l.substring(0,1)!="_"});for(var n in t)if(Object.getOwnPropertyDescriptor(this,t[n]).configurable===!1){var r=t[n],a=this[r];a&&(Array.isArray(a)?e.push({key:r,value:Uhe(a,this.objId,this.scope)}):a instanceof Mm?(a.scope=this.scope,e.push({key:r,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:r,value:a}))}return e};var Vhe=function(){Mm.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){e=n.trim()},get:function(){return e||null}})};Kd(Vhe,Mm);var $he=function(){Mm.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var n=function(r){return r};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+Ox(n(e))+")"}},set:function(n){e=n}})};Kd($he,Mm);var Lp=function e(){Mm.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(F){if(isNaN(F))throw new Error('Invalid value "'+F+'" for attribute F supplied.');t=F}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!_l(t,3)},set:function(F){F?this.F=xl(t,3):this.F=bl(t,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(F){if(isNaN(F))throw new Error('Invalid value "'+F+'" for attribute Ff supplied.');n=F}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(F){r=F!==void 0?F:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(F){r[0]=F}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(F){r[1]=F}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(F){r[2]=F}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(F){r[3]=F}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(F){switch(F){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=F;break;default:throw new Error('Invalid value "'+F+'" for attribute FT supplied.')}}});var l=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!l||l.length<1){if(this instanceof d3)return;l="FieldObject"+e.FieldNum++}var F=function($){return $};return this.scope&&(F=this.scope.internal.getEncryptor(this.objId)),"("+Ox(F(l))+")"},set:function(F){l=F.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return l},set:function(F){l=F}});var h="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return h},set:function(F){h=F}});var i="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return i},set:function(F){i=F}});var y=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return y},set:function(F){y=F}});var x=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return x===void 0?50/v8:x},set:function(F){x=F}});var w="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return w},set:function(F){w=F}});var C="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!C||this instanceof d3||this instanceof nx))return W4(C,this.objId,this.scope)},set:function(F){F=F.toString(),C=F}});var P=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(P)return this instanceof Cc==0?W4(P,this.objId,this.scope):P},set:function(F){F=F.toString(),P=this instanceof Cc==0?F.substr(0,1)==="("?L1(F.substr(1,F.length-2)):L1(F):F}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Cc==1?L1(P.substr(1,P.length-1)):P},set:function(F){F=F.toString(),P=this instanceof Cc==1?"/"+F:F}});var E=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(E)return E},set:function(F){this.V=F}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(E)return this instanceof Cc==0?W4(E,this.objId,this.scope):E},set:function(F){F=F.toString(),E=this instanceof Cc==0?F.substr(0,1)==="("?L1(F.substr(1,F.length-2)):L1(F):F}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Cc==1?L1(E.substr(1,E.length-1)):E},set:function(F){F=F.toString(),E=this instanceof Cc==1?"/"+F:F}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var j,D=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return D},set:function(F){F=!!F,D=F}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(j)return j},set:function(F){j=F}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,1)},set:function(F){F?this.Ff=xl(this.Ff,1):this.Ff=bl(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,2)},set:function(F){F?this.Ff=xl(this.Ff,2):this.Ff=bl(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,3)},set:function(F){F?this.Ff=xl(this.Ff,3):this.Ff=bl(this.Ff,3)}});var B=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(B!==null)return B},set:function(F){if([0,1,2].indexOf(F)===-1)throw new Error('Invalid value "'+F+'" for attribute Q supplied.');B=F}}),Object.defineProperty(this,"textAlign",{get:function(){var F;switch(B){case 0:default:F="left";break;case 1:F="center";break;case 2:F="right"}return F},configurable:!0,enumerable:!0,set:function(F){switch(F){case"right":case 2:B=2;break;case"center":case 1:B=1;break;default:B=0}}})};Kd(Lp,Mm);var Tb=function(){Lp.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(n){e=n}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Uhe(t,this.objId,this.scope)},set:function(n){var r,a;a=[],typeof(r=n)=="string"&&(a=function(l,h,i){i||(i=1);for(var y,x=[];y=h.exec(l);)x.push(y[i]);return x}(r,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(n){t=n,this.sort&&t.sort()},this.addOption=function(n){n=(n=n||"").toString(),t.push(n),this.sort&&t.sort()},this.removeOption=function(n,r){for(r=r||!1,n=(n=n||"").toString();t.indexOf(n)!==-1&&(t.splice(t.indexOf(n),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,18)},set:function(n){n?this.Ff=xl(this.Ff,18):this.Ff=bl(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=xl(this.Ff,19):this.Ff=bl(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,20)},set:function(n){n?(this.Ff=xl(this.Ff,20),t.sort()):this.Ff=bl(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,22)},set:function(n){n?this.Ff=xl(this.Ff,22):this.Ff=bl(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,23)},set:function(n){n?this.Ff=xl(this.Ff,23):this.Ff=bl(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,27)},set:function(n){n?this.Ff=xl(this.Ff,27):this.Ff=bl(this.Ff,27)}}),this.hasAppearanceStream=!1};Kd(Tb,Lp);var Cb=function(){Tb.call(this),this.fontName="helvetica",this.combo=!1};Kd(Cb,Tb);var Eb=function(){Cb.call(this),this.combo=!0};Kd(Eb,Cb);var cP=function(){Eb.call(this),this.edit=!0};Kd(cP,Eb);var Cc=function(){Lp.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,15)},set:function(n){n?this.Ff=xl(this.Ff,15):this.Ff=bl(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,16)},set:function(n){n?this.Ff=xl(this.Ff,16):this.Ff=bl(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,17)},set:function(n){n?this.Ff=xl(this.Ff,17):this.Ff=bl(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,26)},set:function(n){n?this.Ff=xl(this.Ff,26):this.Ff=bl(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(l){return l};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var r,a=[];for(r in a.push("<<"),t)a.push("/"+r+" ("+Ox(n(t[r]))+")");return a.push(">>"),a.join(`
`)}},set:function(n){Da(n)==="object"&&(t=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(n){typeof n=="string"&&(t.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(n){e="/"+n}})};Kd(Cc,Lp);var uP=function(){Cc.call(this),this.pushButton=!0};Kd(uP,Cc);var Pb=function(){Cc.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Kd(Pb,Cc);var d3=function(){var e,t;Lp.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(a){t=a}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(i){return i};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var l,h=[];for(l in h.push("<<"),r)h.push("/"+l+" ("+Ox(a(r[l]))+")");return h.push(">>"),h.join(`
`)},set:function(a){Da(a)==="object"&&(r=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(a){typeof a=="string"&&(r.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(a){n=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(a){n="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=vi.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Kd(d3,Lp),Pb.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var n=this.Kids[t];n.appearanceStreamContent=e.createAppearanceStream(n.optionName),n.caption=e.getCA()}},Pb.prototype.createOption=function(e){var t=new d3;return t.Parent=this,t.optionName=e,this.Kids.push(t),jKe.call(this.scope,t),t};var dP=function(){Cc.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=vi.CheckBox.createAppearanceStream()};Kd(dP,Cc);var nx=function(){Lp.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,13)},set:function(t){t?this.Ff=xl(this.Ff,13):this.Ff=bl(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,21)},set:function(t){t?this.Ff=xl(this.Ff,21):this.Ff=bl(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,23)},set:function(t){t?this.Ff=xl(this.Ff,23):this.Ff=bl(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,24)},set:function(t){t?this.Ff=xl(this.Ff,24):this.Ff=bl(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,25)},set:function(t){t?this.Ff=xl(this.Ff,25):this.Ff=bl(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,26)},set:function(t){t?this.Ff=xl(this.Ff,26):this.Ff=bl(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Kd(nx,Lp);var hP=function(){nx.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!_l(this.Ff,14)},set:function(e){e?this.Ff=xl(this.Ff,14):this.Ff=bl(this.Ff,14)}}),this.password=!0};Kd(hP,nx);var vi={CheckBox:{createAppearanceStream:function(){return{N:{On:vi.CheckBox.YesNormal},D:{On:vi.CheckBox.YesPushDown,Off:vi.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=gm(e);t.scope=e.scope;var n=[],r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),l=pO(e,e.caption);return n.push("0.749023 g"),n.push("0 0 "+ls(vi.internal.getWidth(e))+" "+ls(vi.internal.getHeight(e))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+ls(l.fontSize)+" Tf "+a),n.push("BT"),n.push(l.text),n.push("ET"),n.push("Q"),n.push("EMC"),t.stream=n.join(`
`),t},YesNormal:function(e){var t=gm(e);t.scope=e.scope;var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color),a=[],l=vi.internal.getHeight(e),h=vi.internal.getWidth(e),i=pO(e,e.caption);return a.push("1 g"),a.push("0 0 "+ls(h)+" "+ls(l)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+ls(h-1)+" "+ls(l-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+n+" "+ls(i.fontSize)+" Tf "+r),a.push(i.text),a.push("ET"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=gm(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+ls(vi.internal.getWidth(e))+" "+ls(vi.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:vi.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=vi.RadioButton.Circle.YesNormal,t.D[e]=vi.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=gm(e);t.scope=e.scope;var n=[],r=vi.internal.getWidth(e)<=vi.internal.getHeight(e)?vi.internal.getWidth(e)/4:vi.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var a=vi.internal.Bezier_C,l=Number((r*a).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+f0(vi.internal.getWidth(e)/2)+" "+f0(vi.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+l+" "+l+" "+r+" 0 "+r+" c"),n.push("-"+l+" "+r+" -"+r+" "+l+" -"+r+" 0 c"),n.push("-"+r+" -"+l+" -"+l+" -"+r+" 0 -"+r+" c"),n.push(l+" -"+r+" "+r+" -"+l+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=gm(e);t.scope=e.scope;var n=[],r=vi.internal.getWidth(e)<=vi.internal.getHeight(e)?vi.internal.getWidth(e)/4:vi.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var a=Number((2*r).toFixed(5)),l=Number((a*vi.internal.Bezier_C).toFixed(5)),h=Number((r*vi.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+f0(vi.internal.getWidth(e)/2)+" "+f0(vi.internal.getHeight(e)/2)+" cm"),n.push(a+" 0 m"),n.push(a+" "+l+" "+l+" "+a+" 0 "+a+" c"),n.push("-"+l+" "+a+" -"+a+" "+l+" -"+a+" 0 c"),n.push("-"+a+" -"+l+" -"+l+" -"+a+" 0 -"+a+" c"),n.push(l+" -"+a+" "+a+" -"+l+" "+a+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+f0(vi.internal.getWidth(e)/2)+" "+f0(vi.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+h+" "+h+" "+r+" 0 "+r+" c"),n.push("-"+h+" "+r+" -"+r+" "+h+" -"+r+" 0 c"),n.push("-"+r+" -"+h+" -"+h+" -"+r+" 0 -"+r+" c"),n.push(h+" -"+r+" "+r+" -"+h+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=gm(e);t.scope=e.scope;var n=[],r=vi.internal.getWidth(e)<=vi.internal.getHeight(e)?vi.internal.getWidth(e)/4:vi.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var a=Number((2*r).toFixed(5)),l=Number((a*vi.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+f0(vi.internal.getWidth(e)/2)+" "+f0(vi.internal.getHeight(e)/2)+" cm"),n.push(a+" 0 m"),n.push(a+" "+l+" "+l+" "+a+" 0 "+a+" c"),n.push("-"+l+" "+a+" -"+a+" "+l+" -"+a+" 0 c"),n.push("-"+a+" -"+l+" -"+l+" -"+a+" 0 -"+a+" c"),n.push(l+" -"+a+" "+a+" -"+l+" "+a+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:vi.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=vi.RadioButton.Cross.YesNormal,t.D[e]=vi.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=gm(e);t.scope=e.scope;var n=[],r=vi.internal.calculateCross(e);return n.push("q"),n.push("1 1 "+ls(vi.internal.getWidth(e)-2)+" "+ls(vi.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(ls(r.x1.x)+" "+ls(r.x1.y)+" m"),n.push(ls(r.x2.x)+" "+ls(r.x2.y)+" l"),n.push(ls(r.x4.x)+" "+ls(r.x4.y)+" m"),n.push(ls(r.x3.x)+" "+ls(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=gm(e);t.scope=e.scope;var n=vi.internal.calculateCross(e),r=[];return r.push("0.749023 g"),r.push("0 0 "+ls(vi.internal.getWidth(e))+" "+ls(vi.internal.getHeight(e))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+ls(vi.internal.getWidth(e)-2)+" "+ls(vi.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(ls(n.x1.x)+" "+ls(n.x1.y)+" m"),r.push(ls(n.x2.x)+" "+ls(n.x2.y)+" l"),r.push(ls(n.x4.x)+" "+ls(n.x4.y)+" m"),r.push(ls(n.x3.x)+" "+ls(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=gm(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+ls(vi.internal.getWidth(e))+" "+ls(vi.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+n}};vi.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=vi.internal.getWidth(e),n=vi.internal.getHeight(e),r=Math.min(t,n);return{x1:{x:(t-r)/2,y:(n-r)/2+r},x2:{x:(t-r)/2+r,y:(n-r)/2},x3:{x:(t-r)/2,y:(n-r)/2},x4:{x:(t-r)/2+r,y:(n-r)/2+r}}}},vi.internal.getWidth=function(e){var t=0;return Da(e)==="object"&&(t=hY(e.Rect[2])),t},vi.internal.getHeight=function(e){var t=0;return Da(e)==="object"&&(t=hY(e.Rect[3])),t};var jKe=rl.addField=function(e){if(RKe(this,e),!(e instanceof Lp))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};rl.AcroFormChoiceField=Tb,rl.AcroFormListBox=Cb,rl.AcroFormComboBox=Eb,rl.AcroFormEditBox=cP,rl.AcroFormButton=Cc,rl.AcroFormPushButton=uP,rl.AcroFormRadioButton=Pb,rl.AcroFormCheckBox=dP,rl.AcroFormTextField=nx,rl.AcroFormPasswordField=hP,rl.AcroFormAppearance=vi,rl.AcroForm={ChoiceField:Tb,ListBox:Cb,ComboBox:Eb,EditBox:cP,Button:Cc,PushButton:uP,RadioButton:Pb,CheckBox:dP,TextField:nx,PasswordField:hP,Appearance:vi},Ci.AcroForm={ChoiceField:Tb,ListBox:Cb,ComboBox:Eb,EditBox:cP,Button:Cc,PushButton:uP,RadioButton:Pb,CheckBox:dP,TextField:nx,PasswordField:hP,Appearance:vi};function qhe(e){return e.reduce(function(t,n,r){return t[n]=r,t},{})}(function(e){var t="addImage_";e.__addimage__={};var n="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(fe,ge){var Ce,xe,Re,Qe,et,je=n;if((ge=ge||n)==="RGBA"||fe.data!==void 0&&fe.data instanceof Uint8ClampedArray&&"height"in fe&&"width"in fe)return"RGBA";if(Q(fe))for(et in r)for(Re=r[et],Ce=0;Ce<Re.length;Ce+=1){for(Qe=!0,xe=0;xe<Re[Ce].length;xe+=1)if(Re[Ce][xe]!==void 0&&Re[Ce][xe]!==fe[xe]){Qe=!1;break}if(Qe===!0){je=et;break}}else for(et in r)for(Re=r[et],Ce=0;Ce<Re.length;Ce+=1){for(Qe=!0,xe=0;xe<Re[Ce].length;xe+=1)if(Re[Ce][xe]!==void 0&&Re[Ce][xe]!==fe.charCodeAt(xe)){Qe=!1;break}if(Qe===!0){je=et;break}}return je===n&&ge!==n&&(je=ge),je},l=function fe(ge){for(var Ce=this.internal.write,xe=this.internal.putStream,Re=(0,this.internal.getFilters)();Re.indexOf("FlateEncode")!==-1;)Re.splice(Re.indexOf("FlateEncode"),1);ge.objectId=this.internal.newObject();var Qe=[];if(Qe.push({key:"Type",value:"/XObject"}),Qe.push({key:"Subtype",value:"/Image"}),Qe.push({key:"Width",value:ge.width}),Qe.push({key:"Height",value:ge.height}),ge.colorSpace===F.INDEXED?Qe.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(ge.palette.length/3-1)+" "+("sMask"in ge&&ge.sMask!==void 0?ge.objectId+2:ge.objectId+1)+" 0 R]"}):(Qe.push({key:"ColorSpace",value:"/"+ge.colorSpace}),ge.colorSpace===F.DEVICE_CMYK&&Qe.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Qe.push({key:"BitsPerComponent",value:ge.bitsPerComponent}),"decodeParameters"in ge&&ge.decodeParameters!==void 0&&Qe.push({key:"DecodeParms",value:"<<"+ge.decodeParameters+">>"}),"transparency"in ge&&Array.isArray(ge.transparency)&&ge.transparency.length>0){for(var et="",je=0,De=ge.transparency.length;je<De;je++)et+=ge.transparency[je]+" "+ge.transparency[je]+" ";Qe.push({key:"Mask",value:"["+et+"]"})}ge.sMask!==void 0&&Qe.push({key:"SMask",value:ge.objectId+1+" 0 R"});var Ct=ge.filter!==void 0?["/"+ge.filter]:void 0;if(xe({data:ge.data,additionalKeyValues:Qe,alreadyAppliedFilters:Ct,objectId:ge.objectId}),Ce("endobj"),"sMask"in ge&&ge.sMask!==void 0){var xt,me=(xt=ge.sMaskBitsPerComponent)!==null&&xt!==void 0?xt:ge.bitsPerComponent,Ye={width:ge.width,height:ge.height,colorSpace:"DeviceGray",bitsPerComponent:me,data:ge.sMask};"filter"in ge&&(Ye.decodeParameters="/Predictor ".concat(ge.predictor," /Colors 1 /BitsPerComponent ").concat(me," /Columns ").concat(ge.width),Ye.filter=ge.filter),fe.call(this,Ye)}if(ge.colorSpace===F.INDEXED){var nt=this.internal.newObject();xe({data:pe(new Uint8Array(ge.palette)),objectId:nt}),Ce("endobj")}},h=function(){var fe=this.internal.collections[t+"images"];for(var ge in fe)l.call(this,fe[ge])},i=function(){var fe,ge=this.internal.collections[t+"images"],Ce=this.internal.write;for(var xe in ge)Ce("/I"+(fe=ge[xe]).index,fe.objectId,"0","R")},y=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",h),this.internal.events.subscribe("putXobjectDict",i))},x=function(){var fe=this.internal.collections[t+"images"];return y.call(this),fe},w=function(){return Object.keys(this.internal.collections[t+"images"]).length},C=function(fe){return typeof e["process"+fe.toUpperCase()]=="function"},P=function(fe){return Da(fe)==="object"&&fe.nodeType===1},E=function(fe,ge){if(fe.nodeName==="IMG"&&fe.hasAttribute("src")){var Ce=""+fe.getAttribute("src");if(Ce.indexOf("data:image/")===0)return lP(unescape(Ce).split("base64,").pop());var xe=e.loadFile(Ce,!0);if(xe!==void 0)return xe}if(fe.nodeName==="CANVAS"){if(fe.width===0||fe.height===0)throw new Error("Given canvas must have data. Canvas width: "+fe.width+", height: "+fe.height);var Re;switch(ge){case"PNG":Re="image/png";break;case"WEBP":Re="image/webp";break;default:Re="image/jpeg"}return lP(fe.toDataURL(Re,1).split("base64,").pop())}},j=function(fe){var ge=this.internal.collections[t+"images"];if(ge){for(var Ce in ge)if(fe===ge[Ce].alias)return ge[Ce]}},D=function(fe,ge,Ce){return fe||ge||(fe=-96,ge=-96),fe<0&&(fe=-1*Ce.width*72/fe/this.internal.scaleFactor),ge<0&&(ge=-1*Ce.height*72/ge/this.internal.scaleFactor),fe===0&&(fe=ge*Ce.width/Ce.height),ge===0&&(ge=fe*Ce.height/Ce.width),[fe,ge]},B=function(fe,ge,Ce,xe,Re,Qe){var et=D.call(this,Ce,xe,Re),je=this.internal.getCoordinateString,De=this.internal.getVerticalCoordinateString,Ct=x.call(this);if(Ce=et[0],xe=et[1],Ct[Re.index]=Re,Qe){Qe*=Math.PI/180;var xt=Math.cos(Qe),me=Math.sin(Qe),Ye=function(vt){return vt.toFixed(4)},nt=[Ye(xt),Ye(me),Ye(-1*me),Ye(xt),0,0,"cm"]}this.internal.write("q"),Qe?(this.internal.write([1,"0","0",1,je(fe),De(ge+xe),"cm"].join(" ")),this.internal.write(nt.join(" ")),this.internal.write([je(Ce),"0","0",je(xe),"0","0","cm"].join(" "))):this.internal.write([je(Ce),"0","0",je(xe),je(fe),De(ge+xe),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Re.index+" Do"),this.internal.write("Q")},F=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var $=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},H=e.__addimage__.sHashCode=function(fe){var ge,Ce,xe=0;if(typeof fe=="string")for(Ce=fe.length,ge=0;ge<Ce;ge++)xe=(xe<<5)-xe+fe.charCodeAt(ge),xe|=0;else if(Q(fe))for(Ce=fe.byteLength/2,ge=0;ge<Ce;ge++)xe=(xe<<5)-xe+fe[ge],xe|=0;return xe},J=e.__addimage__.validateStringAsBase64=function(fe){(fe=fe||"").toString().trim();var ge=!0;return fe.length===0&&(ge=!1),fe.length%4!=0&&(ge=!1),/^[A-Za-z0-9+/]+$/.test(fe.substr(0,fe.length-2))===!1&&(ge=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(fe.substr(-2))===!1&&(ge=!1),ge},ee=e.__addimage__.extractImageFromDataUrl=function(fe){if(fe==null||!(fe=fe.trim()).startsWith("data:"))return null;var ge=fe.indexOf(",");return ge<0?null:fe.substring(0,ge).trim().endsWith("base64")?fe.substring(ge+1):null};e.__addimage__.isArrayBuffer=function(fe){return fe instanceof ArrayBuffer};var Q=e.__addimage__.isArrayBufferView=function(fe){return fe instanceof Int8Array||fe instanceof Uint8Array||fe instanceof Uint8ClampedArray||fe instanceof Int16Array||fe instanceof Uint16Array||fe instanceof Int32Array||fe instanceof Uint32Array||fe instanceof Float32Array||fe instanceof Float64Array},ne=e.__addimage__.binaryStringToUint8Array=function(fe){for(var ge=fe.length,Ce=new Uint8Array(ge),xe=0;xe<ge;xe++)Ce[xe]=fe.charCodeAt(xe);return Ce},pe=e.__addimage__.arrayBufferToBinaryString=function(fe){for(var ge="",Ce=Q(fe)?fe:new Uint8Array(fe),xe=0;xe<Ce.length;xe+=8192)ge+=String.fromCharCode.apply(null,Ce.subarray(xe,xe+8192));return ge};e.addImage=function(){var fe,ge,Ce,xe,Re,Qe,et,je,De;if(typeof arguments[1]=="number"?(ge=n,Ce=arguments[1],xe=arguments[2],Re=arguments[3],Qe=arguments[4],et=arguments[5],je=arguments[6],De=arguments[7]):(ge=arguments[1],Ce=arguments[2],xe=arguments[3],Re=arguments[4],Qe=arguments[5],et=arguments[6],je=arguments[7],De=arguments[8]),Da(fe=arguments[0])==="object"&&!P(fe)&&"imageData"in fe){var Ct=fe;fe=Ct.imageData,ge=Ct.format||ge||n,Ce=Ct.x||Ce||0,xe=Ct.y||xe||0,Re=Ct.w||Ct.width||Re,Qe=Ct.h||Ct.height||Qe,et=Ct.alias||et,je=Ct.compression||je,De=Ct.rotation||Ct.angle||De}var xt=this.internal.getFilters();if(je===void 0&&xt.indexOf("FlateEncode")!==-1&&(je="SLOW"),isNaN(Ce)||isNaN(xe))throw new Error("Invalid coordinates passed to jsPDF.addImage");y.call(this);var me=he.call(this,fe,ge,et,je);return B.call(this,Ce,xe,Re,Qe,me,De),this};var he=function(fe,ge,Ce,xe){var Re,Qe,et;if(typeof fe=="string"&&a(fe)===n){fe=unescape(fe);var je=we(fe,!1);(je!==""||(je=e.loadFile(fe,!0))!==void 0)&&(fe=je)}if(P(fe)&&(fe=E(fe,ge)),ge=a(fe,ge),!C(ge))throw new Error("addImage does not support files of type '"+ge+"', please ensure that a plugin for '"+ge+"' support is added.");if(((et=Ce)==null||et.length===0)&&(Ce=function(De){return typeof De=="string"||Q(De)?H(De):Q(De.data)?H(De.data):null}(fe)),(Re=j.call(this,Ce))||(fe instanceof Uint8Array||ge==="RGBA"||(Qe=fe,fe=ne(fe)),Re=this["process"+ge.toUpperCase()](fe,w.call(this),Ce,function(De){return De&&typeof De=="string"&&(De=De.toUpperCase()),De in e.image_compression?De:$.NONE}(xe),Qe)),!Re)throw new Error("An unknown error occurred whilst processing the image.");return Re},we=e.__addimage__.convertBase64ToBinaryString=function(fe,ge){ge=typeof ge!="boolean"||ge;var Ce,xe="";if(typeof fe=="string"){var Re;Ce=(Re=ee(fe))!==null&&Re!==void 0?Re:fe;try{xe=lP(Ce)}catch(Qe){if(ge)throw J(Ce)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Qe.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return xe};e.getImageProperties=function(fe){var ge,Ce,xe="";if(P(fe)&&(fe=E(fe)),typeof fe=="string"&&a(fe)===n&&((xe=we(fe,!1))===""&&(xe=e.loadFile(fe)||""),fe=xe),Ce=a(fe),!C(Ce))throw new Error("addImage does not support files of type '"+Ce+"', please ensure that a plugin for '"+Ce+"' support is added.");if(fe instanceof Uint8Array||(fe=ne(fe)),!(ge=this["process"+Ce.toUpperCase()](fe)))throw new Error("An unknown error occurred whilst processing the image");return ge.fileType=Ce,ge}})(Ci.API),function(e){var t=function(n){if(n!==void 0&&n!="")return!0};Ci.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(n){for(var r,a,l,h=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,y=this.internal.getPageInfoByObjId(n.objId),x=n.pageContext.annotations,w=!1,C=0;C<x.length&&!w;C++)switch((r=x[C]).type){case"link":(t(r.options.url)||t(r.options.pageNumber))&&(w=!0);break;case"reference":case"text":case"freetext":w=!0}if(w!=0){this.internal.write("/Annots [");for(var P=0;P<x.length;P++){r=x[P];var E=this.internal.pdfEscape,j=this.internal.getEncryptor(n.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var D=this.internal.newAdditionalObject(),B=this.internal.newAdditionalObject(),F=this.internal.getEncryptor(D.objId),$=r.title||"Note";l="<</Type /Annot /Subtype /Text "+(a="/Rect ["+h(r.bounds.x)+" "+i(r.bounds.y+r.bounds.h)+" "+h(r.bounds.x+r.bounds.w)+" "+i(r.bounds.y)+"] ")+"/Contents ("+E(F(r.contents))+")",l+=" /Popup "+B.objId+" 0 R",l+=" /P "+y.objId+" 0 R",l+=" /T ("+E(F($))+") >>",D.content=l;var H=D.objId+" 0 R";l="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+h(r.bounds.x+30)+" "+i(r.bounds.y+r.bounds.h)+" "+h(r.bounds.x+r.bounds.w+30)+" "+i(r.bounds.y)+"] ")+" /Parent "+H,r.open&&(l+=" /Open true"),l+=" >>",B.content=l,this.internal.write(D.objId,"0 R",B.objId,"0 R");break;case"freetext":a="/Rect ["+h(r.bounds.x)+" "+i(r.bounds.y)+" "+h(r.bounds.x+r.bounds.w)+" "+i(r.bounds.y+r.bounds.h)+"] ";var J=r.color||"#000000";l="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+E(j(r.contents))+")",l+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+J+")",l+=" /Border [0 0 0]",l+=" >>",this.internal.write(l);break;case"link":if(r.options.name){var ee=this.annotations._nameMap[r.options.name];r.options.pageNumber=ee.page,r.options.top=ee.y}else r.options.top||(r.options.top=0);if(a="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",l="",r.options.url)l="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+E(j(r.options.url))+") >>";else if(r.options.pageNumber)switch(l="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":l+=" /Fit]";break;case"FitH":l+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,l+=" /FitV "+r.options.left+"]";break;default:var Q=i(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),l+=" /XYZ "+r.options.left+" "+Q+" "+r.options.zoom+"]"}l!=""&&(l+=" >>",this.internal.write(l))}}this.internal.write("]")}}]),e.createAnnotation=function(n){var r=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":r.pageContext.annotations.push(n)}},e.link=function(n,r,a,l,h){var i=this.internal.getCurrentPageInfo(),y=this.internal.getCoordinateString,x=this.internal.getVerticalCoordinateString;i.pageContext.annotations.push({finalBounds:{x:y(n),y:x(r),w:y(n+a),h:x(r+l)},options:h,type:"link"})},e.textWithLink=function(n,r,a,l){var h,i,y=this.getTextWidth(n),x=this.internal.getLineHeight()/this.internal.scaleFactor;if(l.maxWidth!==void 0){i=l.maxWidth;var w=this.splitTextToSize(n,i).length;h=Math.ceil(x*w)}else i=y,h=x;return this.text(n,r,a,l),a+=.2*x,l.align==="center"&&(r-=y/2),l.align==="right"&&(r-=y),this.link(r,a-x,i,h,l),y},e.getTextWidth=function(n){var r=this.internal.getFontSize();return this.getStringUnitWidth(n)*r/this.internal.scaleFactor}}(Ci.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var l=e.__arabicParser__.isInArabicSubstitutionA=function(D){return t[D.charCodeAt(0)]!==void 0},h=e.__arabicParser__.isArabicLetter=function(D){return typeof D=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(D)},i=e.__arabicParser__.isArabicEndLetter=function(D){return h(D)&&l(D)&&t[D.charCodeAt(0)].length<=2},y=e.__arabicParser__.isArabicAlfLetter=function(D){return h(D)&&a.indexOf(D.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(D){return h(D)&&l(D)&&t[D.charCodeAt(0)].length>=1};var x=e.__arabicParser__.arabicLetterHasFinalForm=function(D){return h(D)&&l(D)&&t[D.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(D){return h(D)&&l(D)&&t[D.charCodeAt(0)].length>=3};var w=e.__arabicParser__.arabicLetterHasMedialForm=function(D){return h(D)&&l(D)&&t[D.charCodeAt(0)].length==4},C=e.__arabicParser__.resolveLigatures=function(D){var B=0,F=n,$="",H=0;for(B=0;B<D.length;B+=1)F[D.charCodeAt(B)]!==void 0?(H++,typeof(F=F[D.charCodeAt(B)])=="number"&&($+=String.fromCharCode(F),F=n,H=0),B===D.length-1&&(F=n,$+=D.charAt(B-(H-1)),B-=H-1,H=0)):(F=n,$+=D.charAt(B-H),B-=H,H=0);return $};e.__arabicParser__.isArabicDiacritic=function(D){return D!==void 0&&r[D.charCodeAt(0)]!==void 0};var P=e.__arabicParser__.getCorrectForm=function(D,B,F){return h(D)?l(D)===!1?-1:!x(D)||!h(B)&&!h(F)||!h(F)&&i(B)||i(D)&&!h(B)||i(D)&&y(B)||i(D)&&i(B)?0:w(D)&&h(B)&&!i(B)&&h(F)&&x(F)?3:i(D)||!h(F)?1:2:-1},E=function(D){var B=0,F=0,$=0,H="",J="",ee="",Q=(D=D||"").split("\\s+"),ne=[];for(B=0;B<Q.length;B+=1){for(ne.push(""),F=0;F<Q[B].length;F+=1)H=Q[B][F],J=Q[B][F-1],ee=Q[B][F+1],h(H)?($=P(H,J,ee),ne[B]+=$!==-1?String.fromCharCode(t[H.charCodeAt(0)][$]):H):ne[B]+=H;ne[B]=C(ne[B])}return ne.join(" ")},j=e.__arabicParser__.processArabic=e.processArabic=function(){var D,B=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,F=[];if(Array.isArray(B)){var $=0;for(F=[],$=0;$<B.length;$+=1)Array.isArray(B[$])?F.push([E(B[$][0]),B[$][1],B[$][2]]):F.push([E(B[$])]);D=F}else D=E(B);return typeof arguments[0]=="string"?D:(arguments[0].text=D,arguments[0])};e.events.push(["preProcessText",j])}(Ci.API),Ci.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(i){n=i}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(i){r=isNaN(i)||Number.isInteger(i)===!1||i<0?150:i,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(i){a=isNaN(i)||Number.isInteger(i)===!1||i<0?300:i,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var l=[];Object.defineProperty(this,"childNodes",{get:function(){return l},set:function(i){l=i}});var h={};Object.defineProperty(this,"style",{get:function(){return h},set:function(i){h=i}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(n,r){var a;if((n=n||"2d")!=="2d")return null;for(a in r)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=r[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Ci.API),function(e){var t={left:0,top:0,bottom:0,right:0},n=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new l,this.internal.__cell__.pages=1},l=function(){var y=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return y},set:function(D){y=D}});var x=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return x},set:function(D){x=D}});var w=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return w},set:function(D){w=D}});var C=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return C},set:function(D){C=D}});var P=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return P},set:function(D){P=D}});var E=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return E},set:function(D){E=D}});var j=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return j},set:function(D){j=D}}),this};l.prototype.clone=function(){return new l(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},l.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(y){return r.call(this),this.internal.__cell__.headerFunction=typeof y=="function"?y:void 0,this},e.getTextDimensions=function(y,x){r.call(this);var w=(x=x||{}).fontSize||this.getFontSize(),C=x.font||this.getFont(),P=x.scaleFactor||this.internal.scaleFactor,E=0,j=0,D=0,B=this;if(!Array.isArray(y)&&typeof y!="string"){if(typeof y!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");y=String(y)}var F=x.maxWidth;F>0?typeof y=="string"?y=this.splitTextToSize(y,F):Object.prototype.toString.call(y)==="[object Array]"&&(y=y.reduce(function(H,J){return H.concat(B.splitTextToSize(J,F))},[])):y=Array.isArray(y)?y:[y];for(var $=0;$<y.length;$++)E<(D=this.getStringUnitWidth(y[$],{font:C})*w)&&(E=D);return E!==0&&(j=y.length),{w:E/=P,h:Math.max((j*w*this.getLineHeightFactor()-w*(this.getLineHeightFactor()-1))/P,0)}},e.cellAddPage=function(){r.call(this),this.addPage();var y=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new l(y.left,y.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var h=e.cell=function(){var y;y=arguments[0]instanceof l?arguments[0]:new l(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var x=this.internal.__cell__.lastCell,w=this.internal.__cell__.padding,C=this.internal.__cell__.margins||t,P=this.internal.__cell__.tableHeaderRow,E=this.internal.__cell__.printHeaders;return x.lineNumber!==void 0&&(x.lineNumber===y.lineNumber?(y.x=(x.x||0)+(x.width||0),y.y=x.y||0):x.y+x.height+y.height+C.bottom>this.getPageHeight()?(this.cellAddPage(),y.y=C.top,E&&P&&(this.printHeaderRow(y.lineNumber,!0),y.y+=P[0].height)):y.y=x.y+x.height||y.y),y.text[0]!==void 0&&(this.rect(y.x,y.y,y.width,y.height,n===!0?"FD":void 0),y.align==="right"?this.text(y.text,y.x+y.width-w,y.y+w,{align:"right",baseline:"top"}):y.align==="center"?this.text(y.text,y.x+y.width/2,y.y+w,{align:"center",baseline:"top",maxWidth:y.width-w-w}):this.text(y.text,y.x+w,y.y+w,{align:"left",baseline:"top",maxWidth:y.width-w-w})),this.internal.__cell__.lastCell=y,this};e.table=function(y,x,w,C,P){if(r.call(this),!w)throw new Error("No data for PDF table.");var E,j,D,B,F=[],$=[],H=[],J={},ee={},Q=[],ne=[],pe=(P=P||{}).autoSize||!1,he=P.printHeaders!==!1,we=P.css&&P.css["font-size"]!==void 0?16*P.css["font-size"]:P.fontSize||12,fe=P.margins||Object.assign({width:this.getPageWidth()},t),ge=typeof P.padding=="number"?P.padding:3,Ce=P.headerBackgroundColor||"#c8c8c8",xe=P.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=he,this.internal.__cell__.margins=fe,this.internal.__cell__.table_font_size=we,this.internal.__cell__.padding=ge,this.internal.__cell__.headerBackgroundColor=Ce,this.internal.__cell__.headerTextColor=xe,this.setFontSize(we),C==null)$=F=Object.keys(w[0]),H=F.map(function(){return"left"});else if(Array.isArray(C)&&Da(C[0])==="object")for(F=C.map(function(Ct){return Ct.name}),$=C.map(function(Ct){return Ct.prompt||Ct.name||""}),H=C.map(function(Ct){return Ct.align||"left"}),E=0;E<C.length;E+=1)ee[C[E].name]=.7499990551181103*C[E].width;else Array.isArray(C)&&typeof C[0]=="string"&&($=F=C,H=F.map(function(){return"left"}));if(pe||Array.isArray(C)&&typeof C[0]=="string")for(E=0;E<F.length;E+=1){for(J[B=F[E]]=w.map(function(Ct){return Ct[B]}),this.setFont(void 0,"bold"),Q.push(this.getTextDimensions($[E],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),j=J[B],this.setFont(void 0,"normal"),D=0;D<j.length;D+=1)Q.push(this.getTextDimensions(j[D],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);ee[B]=Math.max.apply(null,Q)+ge+ge,Q=[]}if(he){var Re={};for(E=0;E<F.length;E+=1)Re[F[E]]={},Re[F[E]].text=$[E],Re[F[E]].align=H[E];var Qe=i.call(this,Re,ee);ne=F.map(function(Ct){return new l(y,x,ee[Ct],Qe,Re[Ct].text,void 0,Re[Ct].align)}),this.setTableHeaderRow(ne),this.printHeaderRow(1,!1)}var et=C.reduce(function(Ct,xt){return Ct[xt.name]=xt.align,Ct},{});for(E=0;E<w.length;E+=1){"rowStart"in P&&P.rowStart instanceof Function&&P.rowStart({row:E,data:w[E]},this);var je=i.call(this,w[E],ee);for(D=0;D<F.length;D+=1){var De=w[E][F[D]];"cellStart"in P&&P.cellStart instanceof Function&&P.cellStart({row:E,col:D,data:De},this),h.call(this,new l(y,x,ee[F[D]],je,De,E+2,et[F[D]]))}}return this.internal.__cell__.table_x=y,this.internal.__cell__.table_y=x,this};var i=function(y,x){var w=this.internal.__cell__.padding,C=this.internal.__cell__.table_font_size,P=this.internal.scaleFactor;return Object.keys(y).map(function(E){var j=y[E];return this.splitTextToSize(j.hasOwnProperty("text")?j.text:j,x[E]-w-w)},this).map(function(E){return this.getLineHeightFactor()*E.length*C/P+w+w},this).reduce(function(E,j){return Math.max(E,j)},0)};e.setTableHeaderRow=function(y){r.call(this),this.internal.__cell__.tableHeaderRow=y},e.printHeaderRow=function(y,x){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var w;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var C=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new l(C[0],C[1],C[2],C[3],void 0,-1)}this.setFont(void 0,"bold");for(var P=[],E=0;E<this.internal.__cell__.tableHeaderRow.length;E+=1){w=this.internal.__cell__.tableHeaderRow[E].clone(),x&&(w.y=this.internal.__cell__.margins.top||0,P.push(w)),w.lineNumber=y;var j=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),h.call(this,w),this.setTextColor(j)}P.length>0&&this.setTableHeaderRow(P),this.setFont(void 0,"normal"),n=!1}}(Ci.API);var Ghe={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Hhe=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],mO=qhe(Hhe),Whe=[100,200,300,400,500,600,700,800,900],OKe=qhe(Whe);function Z4(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),n=function(l){return Ghe[l=l||"normal"]?l:"normal"}(e.style),r=function(l){return l?typeof l=="number"?l>=100&&l<=900&&l%100==0?l:400:/^\d00$/.test(l)?parseInt(l):l==="bold"?700:400:400}(e.weight),a=function(l){return typeof mO[l=l||"normal"]=="number"?l:"normal"}(e.stretch);return{family:t,style:n,weight:r,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,n,r].join(" ")}}}function fY(e,t,n,r){var a;for(a=n;a>=0&&a<t.length;a+=r)if(e[t[a]])return e[t[a]];for(a=n;a>=0&&a<t.length;a-=r)if(e[t[a]])return e[t[a]]}var FKe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},pY={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function mY(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function gY(e){return e.trimLeft()}function zKe(e,t){for(var n=0;n<e.length;){if(e.charAt(n)===t)return[e.substring(0,n),e.substring(n+1)];n+=1}return null}function BKe(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var PE,yY,vY,D1,kE,_Y,xY,bY,K4=["times"];function wY(e,t,n,r,a){var l=4,h=AY;switch(a){case Ci.API.image_compression.FAST:l=1,h=SY;break;case Ci.API.image_compression.MEDIUM:l=6,h=TY;break;case Ci.API.image_compression.SLOW:l=9,h=CY}e=function(y,x,w,C){for(var P,E=y.length/x,j=new Uint8Array(y.length+E),D=[UKe,SY,AY,TY,CY],B=0;B<E;B+=1){var F=B*x,$=y.subarray(F,F+x);if(C)j.set(C($,w,P),F+B);else{for(var H=D.length,J=[],ee=0;ee<H;ee+=1)J[ee]=D[ee]($,w,P);var Q=$Ke(J.concat());j.set(J[Q],F+B)}P=$}return j}(e,t,Math.ceil(n*r/8),h);var i=nO(e,{level:l});return Ci.API.__addimage__.arrayBufferToBinaryString(i)}function UKe(e){var t=Array.apply([],e);return t.unshift(0),t}function SY(e,t){var n=e.length,r=[];r[0]=1;for(var a=0;a<n;a+=1){var l=e[a-t]||0;r[a+1]=e[a]-l+256&255}return r}function AY(e,t,n){var r=e.length,a=[];a[0]=2;for(var l=0;l<r;l+=1){var h=n&&n[l]||0;a[l+1]=e[l]-h+256&255}return a}function TY(e,t,n){var r=e.length,a=[];a[0]=3;for(var l=0;l<r;l+=1){var h=e[l-t]||0,i=n&&n[l]||0;a[l+1]=e[l]+256-(h+i>>>1)&255}return a}function CY(e,t,n){var r=e.length,a=[];a[0]=4;for(var l=0;l<r;l+=1){var h=VKe(e[l-t]||0,n&&n[l]||0,n&&n[l-t]||0);a[l+1]=e[l]-h+256&255}return a}function VKe(e,t,n){if(e===t&&t===n)return e;var r=Math.abs(t-n),a=Math.abs(e-n),l=Math.abs(e+t-n-n);return r<=a&&r<=l?e:a<=l?t:n}function $Ke(e){var t=e.map(function(n){return n.reduce(function(r,a){return r+Math.abs(a)},0)});return t.indexOf(Math.min.apply(null,t))}function Y4(e,t,n){var r=t*n,a=Math.floor(r/8),l=16-(r-8*a+n),h=(1<<n)-1;return Zhe(e,a)>>l&h}function EY(e,t,n,r){var a=n*r,l=Math.floor(a/8),h=16-(a-8*l+r),i=(1<<r)-1,y=(t&i)<<h;(function(x,w,C){if(w+1<x.byteLength)x.setUint16(w,C,!1);else{var P=C>>8&255;x.setUint8(w,P)}})(e,l,Zhe(e,l)&~(i<<h)&65535|y)}function Zhe(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function qKe(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=e[t++]|e[t++]<<8,r=e[t++]|e[t++]<<8,a=e[t++],l=a>>7,h=1<<1+(7&a);e[t++],e[t++];var i=null,y=null;l&&(i=t,y=h,t+=3*h);var x=!0,w=[],C=0,P=null,E=0,j=null;for(this.width=n,this.height=r;x&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,j=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((fe=e[t++])>=0))throw Error("Invalid block size");if(fe===0)break;t+=fe}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var D=e[t++];C=e[t++]|e[t++]<<8,P=e[t++],1&D||(P=null),E=D>>2&7,t++;break;case 254:for(;;){if(!((fe=e[t++])>=0))throw Error("Invalid block size");if(fe===0)break;t+=fe}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var B=e[t++]|e[t++]<<8,F=e[t++]|e[t++]<<8,$=e[t++]|e[t++]<<8,H=e[t++]|e[t++]<<8,J=e[t++],ee=J>>6&1,Q=1<<1+(7&J),ne=i,pe=y,he=!1;J>>7&&(he=!0,ne=t,pe=Q,t+=3*Q);var we=t;for(t++;;){var fe;if(!((fe=e[t++])>=0))throw Error("Invalid block size");if(fe===0)break;t+=fe}w.push({x:B,y:F,width:$,height:H,has_local_palette:he,palette_offset:ne,palette_size:pe,data_offset:we,data_length:t-we,transparent_index:P,interlaced:!!ee,delay:C,disposal:E});break;case 59:x=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return w.length},this.loopCount=function(){return j},this.frameInfo=function(ge){if(ge<0||ge>=w.length)throw new Error("Frame index out of range.");return w[ge]},this.decodeAndBlitFrameBGRA=function(ge,Ce){var xe=this.frameInfo(ge),Re=xe.width*xe.height,Qe=new Uint8Array(Re);PY(e,xe.data_offset,Qe,Re);var et=xe.palette_offset,je=xe.transparent_index;je===null&&(je=256);var De=xe.width,Ct=n-De,xt=De,me=4*(xe.y*n+xe.x),Ye=4*((xe.y+xe.height)*n+xe.x),nt=me,vt=4*Ct;xe.interlaced===!0&&(vt+=4*n*7);for(var gt=8,dt=0,At=Qe.length;dt<At;++dt){var mt=Qe[dt];if(xt===0&&(xt=De,(nt+=vt)>=Ye&&(vt=4*Ct+4*n*(gt-1),nt=me+(De+Ct)*(gt<<1),gt>>=1)),mt===je)nt+=4;else{var Pt=e[et+3*mt],Ht=e[et+3*mt+1],Ot=e[et+3*mt+2];Ce[nt++]=Ot,Ce[nt++]=Ht,Ce[nt++]=Pt,Ce[nt++]=255}--xt}},this.decodeAndBlitFrameRGBA=function(ge,Ce){var xe=this.frameInfo(ge),Re=xe.width*xe.height,Qe=new Uint8Array(Re);PY(e,xe.data_offset,Qe,Re);var et=xe.palette_offset,je=xe.transparent_index;je===null&&(je=256);var De=xe.width,Ct=n-De,xt=De,me=4*(xe.y*n+xe.x),Ye=4*((xe.y+xe.height)*n+xe.x),nt=me,vt=4*Ct;xe.interlaced===!0&&(vt+=4*n*7);for(var gt=8,dt=0,At=Qe.length;dt<At;++dt){var mt=Qe[dt];if(xt===0&&(xt=De,(nt+=vt)>=Ye&&(vt=4*Ct+4*n*(gt-1),nt=me+(De+Ct)*(gt<<1),gt>>=1)),mt===je)nt+=4;else{var Pt=e[et+3*mt],Ht=e[et+3*mt+1],Ot=e[et+3*mt+2];Ce[nt++]=Pt,Ce[nt++]=Ht,Ce[nt++]=Ot,Ce[nt++]=255}--xt}}}function PY(e,t,n,r){for(var a=e[t++],l=1<<a,h=l+1,i=h+1,y=a+1,x=(1<<y)-1,w=0,C=0,P=0,E=e[t++],j=new Int32Array(4096),D=null;;){for(;w<16&&E!==0;)C|=e[t++]<<w,w+=8,E===1?E=e[t++]:--E;if(w<y)break;var B=C&x;if(C>>=y,w-=y,B!==l){if(B===h)break;for(var F=B<i?B:D,$=0,H=F;H>l;)H=j[H]>>8,++$;var J=H;if(P+$+(F!==B?1:0)>r)return void Ka.log("Warning, gif stream longer than expected.");n[P++]=J;var ee=P+=$;for(F!==B&&(n[P++]=J),H=F;$--;)H=j[H],n[--ee]=255&H,H>>=8;D!==null&&i<4096&&(j[i++]=D<<8|J,i>=x+1&&y<12&&(++y,x=x<<1|1)),D=B}else i=h+1,x=(1<<(y=a+1))-1,D=null}return P!==r&&Ka.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function X4(e){var t,n,r,a,l,h=Math.floor,i=new Array(64),y=new Array(64),x=new Array(64),w=new Array(64),C=new Array(65535),P=new Array(65535),E=new Array(64),j=new Array(64),D=[],B=0,F=7,$=new Array(64),H=new Array(64),J=new Array(64),ee=new Array(256),Q=new Array(2048),ne=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],pe=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],he=[0,1,2,3,4,5,6,7,8,9,10,11],we=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],fe=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],ge=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Ce=[0,1,2,3,4,5,6,7,8,9,10,11],xe=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Re=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Qe(me,Ye){for(var nt=0,vt=0,gt=new Array,dt=1;dt<=16;dt++){for(var At=1;At<=me[dt];At++)gt[Ye[vt]]=[],gt[Ye[vt]][0]=nt,gt[Ye[vt]][1]=dt,vt++,nt++;nt*=2}return gt}function et(me){for(var Ye=me[0],nt=me[1]-1;nt>=0;)Ye&1<<nt&&(B|=1<<F),nt--,--F<0&&(B==255?(je(255),je(0)):je(B),F=7,B=0)}function je(me){D.push(me)}function De(me){je(me>>8&255),je(255&me)}function Ct(me,Ye,nt,vt,gt){for(var dt,At=gt[0],mt=gt[240],Pt=function(On,ht){var wt,Wt,xn,Rn,Sn,Mn,Ar,Pr,wr,Qr,dr=0;for(wr=0;wr<8;++wr){wt=On[dr],Wt=On[dr+1],xn=On[dr+2],Rn=On[dr+3],Sn=On[dr+4],Mn=On[dr+5],Ar=On[dr+6];var Hi=wt+(Pr=On[dr+7]),Bi=wt-Pr,Cr=Wt+Ar,fi=Wt-Ar,Cn=xn+Mn,bn=xn-Mn,fr=Rn+Sn,Ur=Rn-Sn,Xs=Hi+fr,_a=Hi-fr,ts=Cr+Cn,_i=Cr-Cn;On[dr]=Xs+ts,On[dr+4]=Xs-ts;var xs=.707106781*(_i+_a);On[dr+2]=_a+xs,On[dr+6]=_a-xs;var Pi=.382683433*((Xs=Ur+bn)-(_i=fi+Bi)),zt=.5411961*Xs+Pi,es=1.306562965*_i+Pi,ja=.707106781*(ts=bn+fi),qr=Bi+ja,lt=Bi-ja;On[dr+5]=lt+zt,On[dr+3]=lt-zt,On[dr+1]=qr+es,On[dr+7]=qr-es,dr+=8}for(dr=0,wr=0;wr<8;++wr){wt=On[dr],Wt=On[dr+8],xn=On[dr+16],Rn=On[dr+24],Sn=On[dr+32],Mn=On[dr+40],Ar=On[dr+48];var de=wt+(Pr=On[dr+56]),_e=wt-Pr,Ie=Wt+Ar,Xe=Wt-Ar,He=xn+Mn,We=xn-Mn,kt=Rn+Sn,ot=Rn-Sn,Et=de+kt,on=de-kt,Yt=Ie+He,Vn=Ie-He;On[dr]=Et+Yt,On[dr+32]=Et-Yt;var ar=.707106781*(Vn+on);On[dr+16]=on+ar,On[dr+48]=on-ar;var vr=.382683433*((Et=ot+We)-(Vn=Xe+_e)),Gr=.5411961*Et+vr,Fr=1.306562965*Vn+vr,pi=.707106781*(Yt=We+Xe),Vi=_e+pi,ai=_e-pi;On[dr+40]=ai+Gr,On[dr+24]=ai-Gr,On[dr+8]=Vi+Fr,On[dr+56]=Vi-Fr,dr++}for(wr=0;wr<64;++wr)Qr=On[wr]*ht[wr],E[wr]=Qr>0?Qr+.5|0:Qr-.5|0;return E}(me,Ye),Ht=0;Ht<64;++Ht)j[ne[Ht]]=Pt[Ht];var Ot=j[0]-nt;nt=j[0],Ot==0?et(vt[0]):(et(vt[P[dt=32767+Ot]]),et(C[dt]));for(var Un=63;Un>0&&j[Un]==0;)Un--;if(Un==0)return et(At),nt;for(var Kt,st=1;st<=Un;){for(var Dr=st;j[st]==0&&st<=Un;)++st;var Or=st-Dr;if(Or>=16){Kt=Or>>4;for(var Br=1;Br<=Kt;++Br)et(mt);Or&=15}dt=32767+j[st],et(gt[(Or<<4)+P[dt]]),et(C[dt]),st++}return Un!=63&&et(At),nt}function xt(me){me=Math.min(Math.max(me,1),100),l!=me&&(function(Ye){for(var nt=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],vt=0;vt<64;vt++){var gt=h((nt[vt]*Ye+50)/100);gt=Math.min(Math.max(gt,1),255),i[ne[vt]]=gt}for(var dt=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],At=0;At<64;At++){var mt=h((dt[At]*Ye+50)/100);mt=Math.min(Math.max(mt,1),255),y[ne[At]]=mt}for(var Pt=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ht=0,Ot=0;Ot<8;Ot++)for(var Un=0;Un<8;Un++)x[Ht]=1/(i[ne[Ht]]*Pt[Ot]*Pt[Un]*8),w[Ht]=1/(y[ne[Ht]]*Pt[Ot]*Pt[Un]*8),Ht++}(me<50?Math.floor(5e3/me):Math.floor(200-2*me)),l=me)}this.encode=function(me,Ye){Ye&&xt(Ye),D=new Array,B=0,F=7,De(65496),De(65504),De(16),je(74),je(70),je(73),je(70),je(0),je(1),je(1),je(0),De(1),De(1),je(0),je(0),function(){De(65499),De(132),je(0);for(var Wt=0;Wt<64;Wt++)je(i[Wt]);je(1);for(var xn=0;xn<64;xn++)je(y[xn])}(),function(Wt,xn){De(65472),De(17),je(8),De(xn),De(Wt),je(3),je(1),je(17),je(0),je(2),je(17),je(1),je(3),je(17),je(1)}(me.width,me.height),function(){De(65476),De(418),je(0);for(var Wt=0;Wt<16;Wt++)je(pe[Wt+1]);for(var xn=0;xn<=11;xn++)je(he[xn]);je(16);for(var Rn=0;Rn<16;Rn++)je(we[Rn+1]);for(var Sn=0;Sn<=161;Sn++)je(fe[Sn]);je(1);for(var Mn=0;Mn<16;Mn++)je(ge[Mn+1]);for(var Ar=0;Ar<=11;Ar++)je(Ce[Ar]);je(17);for(var Pr=0;Pr<16;Pr++)je(xe[Pr+1]);for(var wr=0;wr<=161;wr++)je(Re[wr])}(),De(65498),De(12),je(3),je(1),je(0),je(2),je(17),je(3),je(17),je(0),je(63),je(0);var nt=0,vt=0,gt=0;B=0,F=7,this.encode.displayName="_encode_";for(var dt,At,mt,Pt,Ht,Ot,Un,Kt,st,Dr=me.data,Or=me.width,Br=me.height,On=4*Or,ht=0;ht<Br;){for(dt=0;dt<On;){for(Ht=On*ht+dt,Un=-1,Kt=0,st=0;st<64;st++)Ot=Ht+(Kt=st>>3)*On+(Un=4*(7&st)),ht+Kt>=Br&&(Ot-=On*(ht+1+Kt-Br)),dt+Un>=On&&(Ot-=dt+Un-On+4),At=Dr[Ot++],mt=Dr[Ot++],Pt=Dr[Ot++],$[st]=(Q[At]+Q[mt+256|0]+Q[Pt+512|0]>>16)-128,H[st]=(Q[At+768|0]+Q[mt+1024|0]+Q[Pt+1280|0]>>16)-128,J[st]=(Q[At+1280|0]+Q[mt+1536|0]+Q[Pt+1792|0]>>16)-128;nt=Ct($,x,nt,t,r),vt=Ct(H,w,vt,n,a),gt=Ct(J,w,gt,n,a),dt+=32}ht+=8}if(F>=0){var wt=[];wt[1]=F+1,wt[0]=(1<<F+1)-1,et(wt)}return De(65497),new Uint8Array(D)},e=e||50,function(){for(var me=String.fromCharCode,Ye=0;Ye<256;Ye++)ee[Ye]=me(Ye)}(),t=Qe(pe,he),n=Qe(ge,Ce),r=Qe(we,fe),a=Qe(xe,Re),function(){for(var me=1,Ye=2,nt=1;nt<=15;nt++){for(var vt=me;vt<Ye;vt++)P[32767+vt]=nt,C[32767+vt]=[],C[32767+vt][1]=nt,C[32767+vt][0]=vt;for(var gt=-(Ye-1);gt<=-me;gt++)P[32767+gt]=nt,C[32767+gt]=[],C[32767+gt][1]=nt,C[32767+gt][0]=Ye-1+gt;me<<=1,Ye<<=1}}(),function(){for(var me=0;me<256;me++)Q[me]=19595*me,Q[me+256|0]=38470*me,Q[me+512|0]=7471*me+32768,Q[me+768|0]=-11059*me,Q[me+1024|0]=-21709*me,Q[me+1280|0]=32768*me+8421375,Q[me+1536|0]=-27439*me,Q[me+1792|0]=-5329*me}(),xt(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ap(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function kY(e){function t(he){if(!he)throw Error("assert :P")}function n(he,we,fe){for(var ge=0;4>ge;ge++)if(he[we+ge]!=fe.charCodeAt(ge))return!0;return!1}function r(he,we,fe,ge,Ce){for(var xe=0;xe<Ce;xe++)he[we+xe]=fe[ge+xe]}function a(he,we,fe,ge){for(var Ce=0;Ce<ge;Ce++)he[we+Ce]=fe}function l(he){return new Int32Array(he)}function h(he,we){for(var fe=[],ge=0;ge<he;ge++)fe.push(new we);return fe}function i(he,we){var fe=[];return function ge(Ce,xe,Re){for(var Qe=Re[xe],et=0;et<Qe&&(Ce.push(Re.length>xe+1?[]:new we),!(Re.length<xe+1));et++)ge(Ce[et],xe+1,Re)}(fe,0,he),fe}var y=function(){var he=this;function we(U,Z){for(var oe=1<<Z-1>>>0;U&oe;)oe>>>=1;return oe?(U&oe-1)+oe:U}function fe(U,Z,oe,ye,Ne){t(!(ye%oe));do U[Z+(ye-=oe)]=Ne;while(0<ye)}function ge(U,Z,oe,ye,Ne){if(t(2328>=Ne),512>=Ne)var Be=l(512);else if((Be=l(Ne))==null)return 0;return function($e,Je,rt,ft,Bt,pn){var pt,Gt,tn=Je,In=1<<rt,sn=l(16),Dn=l(16);for(t(Bt!=0),t(ft!=null),t($e!=null),t(0<rt),Gt=0;Gt<Bt;++Gt){if(15<ft[Gt])return 0;++sn[ft[Gt]]}if(sn[0]==Bt)return 0;for(Dn[1]=0,pt=1;15>pt;++pt){if(sn[pt]>1<<pt)return 0;Dn[pt+1]=Dn[pt]+sn[pt]}for(Gt=0;Gt<Bt;++Gt)pt=ft[Gt],0<ft[Gt]&&(pn[Dn[pt]++]=Gt);if(Dn[15]==1)return(ft=new Ce).g=0,ft.value=pn[0],fe($e,tn,1,In,ft),In;var jn,rr=-1,Hn=In-1,ei=0,Rr=1,Di=1,ri=1<<rt;for(Gt=0,pt=1,Bt=2;pt<=rt;++pt,Bt<<=1){if(Rr+=Di<<=1,0>(Di-=sn[pt]))return 0;for(;0<sn[pt];--sn[pt])(ft=new Ce).g=pt,ft.value=pn[Gt++],fe($e,tn+ei,Bt,ri,ft),ei=we(ei,pt)}for(pt=rt+1,Bt=2;15>=pt;++pt,Bt<<=1){if(Rr+=Di<<=1,0>(Di-=sn[pt]))return 0;for(;0<sn[pt];--sn[pt]){if(ft=new Ce,(ei&Hn)!=rr){for(tn+=ri,jn=1<<(rr=pt)-rt;15>rr&&!(0>=(jn-=sn[rr]));)++rr,jn<<=1;In+=ri=1<<(jn=rr-rt),$e[Je+(rr=ei&Hn)].g=jn+rt,$e[Je+rr].value=tn-Je-rr}ft.g=pt-rt,ft.value=pn[Gt++],fe($e,tn+(ei>>rt),Bt,ri,ft),ei=we(ei,pt)}}return Rr!=2*Dn[15]-1?0:In}(U,Z,oe,ye,Ne,Be)}function Ce(){this.value=this.g=0}function xe(){this.value=this.g=0}function Re(){this.G=h(5,Ce),this.H=l(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=h(Ru,xe)}function Qe(U,Z,oe,ye){t(U!=null),t(Z!=null),t(2147483648>ye),U.Ca=254,U.I=0,U.b=-8,U.Ka=0,U.oa=Z,U.pa=oe,U.Jd=Z,U.Yc=oe+ye,U.Zc=4<=ye?oe+ye-4+1:oe,At(U)}function et(U,Z){for(var oe=0;0<Z--;)oe|=Pt(U,128)<<Z;return oe}function je(U,Z){var oe=et(U,Z);return mt(U)?-oe:oe}function De(U,Z,oe,ye){var Ne,Be=0;for(t(U!=null),t(Z!=null),t(4294967288>ye),U.Sb=ye,U.Ra=0,U.u=0,U.h=0,4<ye&&(ye=4),Ne=0;Ne<ye;++Ne)Be+=Z[oe+Ne]<<8*Ne;U.Ra=Be,U.bb=ye,U.oa=Z,U.pa=oe}function Ct(U){for(;8<=U.u&&U.bb<U.Sb;)U.Ra>>>=8,U.Ra+=U.oa[U.pa+U.bb]<<ju-8>>>0,++U.bb,U.u-=8;vt(U)&&(U.h=1,U.u=0)}function xt(U,Z){if(t(0<=Z),!U.h&&Z<=ql){var oe=nt(U)&dl[Z];return U.u+=Z,Ct(U),oe}return U.h=1,U.u=0}function me(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Ye(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function nt(U){return U.Ra>>>(U.u&ju-1)>>>0}function vt(U){return t(U.bb<=U.Sb),U.h||U.bb==U.Sb&&U.u>ju}function gt(U,Z){U.u=Z,U.h=vt(U)}function dt(U){U.u>=Ms&&(t(U.u>=Ms),Ct(U))}function At(U){t(U!=null&&U.oa!=null),U.pa<U.Zc?(U.I=(U.oa[U.pa++]|U.I<<8)>>>0,U.b+=8):(t(U!=null&&U.oa!=null),U.pa<U.Yc?(U.b+=8,U.I=U.oa[U.pa++]|U.I<<8):U.Ka?U.b=0:(U.I<<=8,U.b+=8,U.Ka=1))}function mt(U){return et(U,1)}function Pt(U,Z){var oe=U.Ca;0>U.b&&At(U);var ye=U.b,Ne=oe*Z>>>8,Be=(U.I>>>ye>Ne)+0;for(Be?(oe-=Ne,U.I-=Ne+1<<ye>>>0):oe=Ne+1,ye=oe,Ne=0;256<=ye;)Ne+=8,ye>>=8;return ye=7^Ne+bd[ye],U.b-=ye,U.Ca=(oe<<ye)-1,Be}function Ht(U,Z,oe){U[Z+0]=oe>>24&255,U[Z+1]=oe>>16&255,U[Z+2]=oe>>8&255,U[Z+3]=255&oe}function Ot(U,Z){return U[Z+0]|U[Z+1]<<8}function Un(U,Z){return Ot(U,Z)|U[Z+2]<<16}function Kt(U,Z){return Ot(U,Z)|Ot(U,Z+2)<<16}function st(U,Z){var oe=1<<Z;return t(U!=null),t(0<Z),U.X=l(oe),U.X==null?0:(U.Mb=32-Z,U.Xa=Z,1)}function Dr(U,Z){t(U!=null),t(Z!=null),t(U.Xa==Z.Xa),r(Z.X,0,U.X,0,1<<Z.Xa)}function Or(){this.X=[],this.Xa=this.Mb=0}function Br(U,Z,oe,ye){t(oe!=null),t(ye!=null);var Ne=oe[0],Be=ye[0];return Ne==0&&(Ne=(U*Be+Z/2)/Z),Be==0&&(Be=(Z*Ne+U/2)/U),0>=Ne||0>=Be?0:(oe[0]=Ne,ye[0]=Be,1)}function On(U,Z){return U+(1<<Z)-1>>>Z}function ht(U,Z){return((4278255360&U)+(4278255360&Z)>>>0&4278255360)+((16711935&U)+(16711935&Z)>>>0&16711935)>>>0}function wt(U,Z){he[Z]=function(oe,ye,Ne,Be,$e,Je,rt){var ft;for(ft=0;ft<$e;++ft){var Bt=he[U](Je[rt+ft-1],Ne,Be+ft);Je[rt+ft]=ht(oe[ye+ft],Bt)}}}function Wt(){this.ud=this.hd=this.jd=0}function xn(U,Z){return((4278124286&(U^Z))>>>1)+(U&Z)>>>0}function Rn(U){return 0<=U&&256>U?U:0>U?0:255<U?255:void 0}function Sn(U,Z){return Rn(U+(U-Z+.5>>1))}function Mn(U,Z,oe){return Math.abs(Z-oe)-Math.abs(U-oe)}function Ar(U,Z,oe,ye,Ne,Be,$e){for(ye=Be[$e-1],oe=0;oe<Ne;++oe)Be[$e+oe]=ye=ht(U[Z+oe],ye)}function Pr(U,Z,oe,ye,Ne){var Be;for(Be=0;Be<oe;++Be){var $e=U[Z+Be],Je=$e>>8&255,rt=16711935&(rt=(rt=16711935&$e)+((Je<<16)+Je));ye[Ne+Be]=(4278255360&$e)+rt>>>0}}function wr(U,Z){Z.jd=255&U,Z.hd=U>>8&255,Z.ud=U>>16&255}function Qr(U,Z,oe,ye,Ne,Be){var $e;for($e=0;$e<ye;++$e){var Je=Z[oe+$e],rt=Je>>>8,ft=Je,Bt=255&(Bt=(Bt=Je>>>16)+((U.jd<<24>>24)*(rt<<24>>24)>>>5));ft=255&(ft=(ft+=(U.hd<<24>>24)*(rt<<24>>24)>>>5)+((U.ud<<24>>24)*(Bt<<24>>24)>>>5)),Ne[Be+$e]=(4278255360&Je)+(Bt<<16)+ft}}function dr(U,Z,oe,ye,Ne){he[Z]=function(Be,$e,Je,rt,ft,Bt,pn,pt,Gt){for(rt=pn;rt<pt;++rt)for(pn=0;pn<Gt;++pn)ft[Bt++]=Ne(Je[ye(Be[$e++])])},he[U]=function(Be,$e,Je,rt,ft,Bt,pn){var pt=8>>Be.b,Gt=Be.Ea,tn=Be.K[0],In=Be.w;if(8>pt)for(Be=(1<<Be.b)-1,In=(1<<pt)-1;$e<Je;++$e){var sn,Dn=0;for(sn=0;sn<Gt;++sn)sn&Be||(Dn=ye(rt[ft++])),Bt[pn++]=Ne(tn[Dn&In]),Dn>>=pt}else he["VP8LMapColor"+oe](rt,ft,tn,In,Bt,pn,$e,Je,Gt)}}function Hi(U,Z,oe,ye,Ne){for(oe=Z+oe;Z<oe;){var Be=U[Z++];ye[Ne++]=Be>>16&255,ye[Ne++]=Be>>8&255,ye[Ne++]=255&Be}}function Bi(U,Z,oe,ye,Ne){for(oe=Z+oe;Z<oe;){var Be=U[Z++];ye[Ne++]=Be>>16&255,ye[Ne++]=Be>>8&255,ye[Ne++]=255&Be,ye[Ne++]=Be>>24&255}}function Cr(U,Z,oe,ye,Ne){for(oe=Z+oe;Z<oe;){var Be=($e=U[Z++])>>16&240|$e>>12&15,$e=240&$e|$e>>28&15;ye[Ne++]=Be,ye[Ne++]=$e}}function fi(U,Z,oe,ye,Ne){for(oe=Z+oe;Z<oe;){var Be=($e=U[Z++])>>16&248|$e>>13&7,$e=$e>>5&224|$e>>3&31;ye[Ne++]=Be,ye[Ne++]=$e}}function Cn(U,Z,oe,ye,Ne){for(oe=Z+oe;Z<oe;){var Be=U[Z++];ye[Ne++]=255&Be,ye[Ne++]=Be>>8&255,ye[Ne++]=Be>>16&255}}function bn(U,Z,oe,ye,Ne,Be){if(Be==0)for(oe=Z+oe;Z<oe;)Ht(ye,((Be=U[Z++])[0]>>24|Be[1]>>8&65280|Be[2]<<8&16711680|Be[3]<<24)>>>0),Ne+=32;else r(ye,Ne,U,Z,oe)}function fr(U,Z){he[Z][0]=he[U+"0"],he[Z][1]=he[U+"1"],he[Z][2]=he[U+"2"],he[Z][3]=he[U+"3"],he[Z][4]=he[U+"4"],he[Z][5]=he[U+"5"],he[Z][6]=he[U+"6"],he[Z][7]=he[U+"7"],he[Z][8]=he[U+"8"],he[Z][9]=he[U+"9"],he[Z][10]=he[U+"10"],he[Z][11]=he[U+"11"],he[Z][12]=he[U+"12"],he[Z][13]=he[U+"13"],he[Z][14]=he[U+"0"],he[Z][15]=he[U+"0"]}function Ur(U){return U==Ly||U==og||U==Dy||U==jv}function Xs(){this.eb=[],this.size=this.A=this.fb=0}function _a(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ts(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Xs,this.f.kb=new _a,this.sd=null}function _i(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function xs(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Pi(U){return alert("todo:WebPSamplerProcessPlane"),U.T}function zt(U,Z){var oe=U.T,ye=Z.ba.f.RGBA,Ne=ye.eb,Be=ye.fb+U.ka*ye.A,$e=jc[Z.ba.S],Je=U.y,rt=U.O,ft=U.f,Bt=U.N,pn=U.ea,pt=U.W,Gt=Z.cc,tn=Z.dc,In=Z.Mc,sn=Z.Nc,Dn=U.ka,jn=U.ka+U.T,rr=U.U,Hn=rr+1>>1;for(Dn==0?$e(Je,rt,null,null,ft,Bt,pn,pt,ft,Bt,pn,pt,Ne,Be,null,null,rr):($e(Z.ec,Z.fc,Je,rt,Gt,tn,In,sn,ft,Bt,pn,pt,Ne,Be-ye.A,Ne,Be,rr),++oe);Dn+2<jn;Dn+=2)Gt=ft,tn=Bt,In=pn,sn=pt,Bt+=U.Rc,pt+=U.Rc,Be+=2*ye.A,$e(Je,(rt+=2*U.fa)-U.fa,Je,rt,Gt,tn,In,sn,ft,Bt,pn,pt,Ne,Be-ye.A,Ne,Be,rr);return rt+=U.fa,U.j+jn<U.o?(r(Z.ec,Z.fc,Je,rt,rr),r(Z.cc,Z.dc,ft,Bt,Hn),r(Z.Mc,Z.Nc,pn,pt,Hn),oe--):1&jn||$e(Je,rt,null,null,ft,Bt,pn,pt,ft,Bt,pn,pt,Ne,Be+ye.A,null,null,rr),oe}function es(U,Z,oe){var ye=U.F,Ne=[U.J];if(ye!=null){var Be=U.U,$e=Z.ba.S,Je=$e==$f||$e==Dy;Z=Z.ba.f.RGBA;var rt=[0],ft=U.ka;rt[0]=U.T,U.Kb&&(ft==0?--rt[0]:(--ft,Ne[0]-=U.width),U.j+U.ka+U.T==U.o&&(rt[0]=U.o-U.j-ft));var Bt=Z.eb;ft=Z.fb+ft*Z.A,U=mc(ye,Ne[0],U.width,Be,rt,Bt,ft+(Je?0:3),Z.A),t(oe==rt),U&&Ur($e)&&zf(Bt,ft,Je,Be,rt,Z.A)}return 0}function ja(U){var Z=U.ma,oe=Z.ba.S,ye=11>oe,Ne=oe==nh||oe==My||oe==$f||oe==Rv||oe==12||Ur(oe);if(Z.memory=null,Z.Ib=null,Z.Jb=null,Z.Nd=null,!_d(Z.Oa,U,Ne?11:12))return 0;if(Ne&&Ur(oe)&&Fh(),U.da)alert("todo:use_scaling");else{if(ye){if(Z.Ib=Pi,U.Kb){if(oe=U.U+1>>1,Z.memory=l(U.U+2*oe),Z.memory==null)return 0;Z.ec=Z.memory,Z.fc=0,Z.cc=Z.ec,Z.dc=Z.fc+U.U,Z.Mc=Z.cc,Z.Nc=Z.dc+oe,Z.Ib=zt,Fh()}}else alert("todo:EmitYUV");Ne&&(Z.Jb=es,ye&&Cs())}if(ye&&!Gx){for(U=0;256>U;++U)Gf[U]=89858*(U-128)+qf>>Wp,Oc[U]=-22014*(U-128)+qf,Hx[U]=-45773*(U-128),Hf[U]=113618*(U-128)+qf>>Wp;for(U=Gh;U<Td;++U)Z=76283*(U-16)+qf>>Wp,Fy[U-Gh]=bs(Z,255),dg[U-Gh]=bs(Z+8>>4,15);Gx=1}return 1}function qr(U){var Z=U.ma,oe=U.U,ye=U.T;return t(!(1&U.ka)),0>=oe||0>=ye?0:(oe=Z.Ib(U,Z),Z.Jb!=null&&Z.Jb(U,Z,oe),Z.Dc+=oe,1)}function lt(U){U.ma.memory=null}function de(U,Z,oe,ye){return xt(U,8)!=47?0:(Z[0]=xt(U,14)+1,oe[0]=xt(U,14)+1,ye[0]=xt(U,1),xt(U,3)!=0?0:!U.h)}function _e(U,Z){if(4>U)return U+1;var oe=U-2>>1;return(2+(1&U)<<oe)+xt(Z,oe)+1}function Ie(U,Z){return 120<Z?Z-120:1<=(oe=((oe=Qw[Z-1])>>4)*U+(8-(15&oe)))?oe:1;var oe}function Xe(U,Z,oe){var ye=nt(oe),Ne=U[Z+=255&ye].g-8;return 0<Ne&&(gt(oe,oe.u+8),ye=nt(oe),Z+=U[Z].value,Z+=ye&(1<<Ne)-1),gt(oe,oe.u+U[Z].g),U[Z].value}function He(U,Z,oe){return oe.g+=U.g,oe.value+=U.value<<Z>>>0,t(8>=oe.g),U.g}function We(U,Z,oe){var ye=U.xc;return t((Z=ye==0?0:U.vc[U.md*(oe>>ye)+(Z>>ye)])<U.Wb),U.Ya[Z]}function kt(U,Z,oe,ye){var Ne=U.ab,Be=U.c*Z,$e=U.C;Z=$e+Z;var Je=oe,rt=ye;for(ye=U.Ta,oe=U.Ua;0<Ne--;){var ft=U.gc[Ne],Bt=$e,pn=Z,pt=Je,Gt=rt,tn=(rt=ye,Je=oe,ft.Ea);switch(t(Bt<pn),t(pn<=ft.nc),ft.hc){case 2:fa(pt,Gt,(pn-Bt)*tn,rt,Je);break;case 0:var In=Bt,sn=pn,Dn=rt,jn=Je,rr=(ri=ft).Ea;In==0&&(Mc(pt,Gt,null,null,1,Dn,jn),Ar(pt,Gt+1,0,0,rr-1,Dn,jn+1),Gt+=rr,jn+=rr,++In);for(var Hn=1<<ri.b,ei=Hn-1,Rr=On(rr,ri.b),Di=ri.K,ri=ri.w+(In>>ri.b)*Rr;In<sn;){var ps=Di,mo=ri,Zi=1;for(po(pt,Gt,Dn,jn-rr,1,Dn,jn);Zi<rr;){var ti=(Zi&~ei)+Hn;ti>rr&&(ti=rr),(0,Vh[ps[mo++]>>8&15])(pt,Gt+ +Zi,Dn,jn+Zi-rr,ti-Zi,Dn,jn+Zi),Zi=ti}Gt+=rr,jn+=rr,++In&ei||(ri+=Rr)}pn!=ft.nc&&r(rt,Je-tn,rt,Je+(pn-Bt-1)*tn,tn);break;case 1:for(tn=pt,sn=Gt,rr=(pt=ft.Ea)-(jn=pt&~(Dn=(Gt=1<<ft.b)-1)),In=On(pt,ft.b),Hn=ft.K,ft=ft.w+(Bt>>ft.b)*In;Bt<pn;){for(ei=Hn,Rr=ft,Di=new Wt,ri=sn+jn,ps=sn+pt;sn<ri;)wr(ei[Rr++],Di),wd(Di,tn,sn,Gt,rt,Je),sn+=Gt,Je+=Gt;sn<ps&&(wr(ei[Rr++],Di),wd(Di,tn,sn,rr,rt,Je),sn+=rr,Je+=rr),++Bt&Dn||(ft+=In)}break;case 3:if(pt==rt&&Gt==Je&&0<ft.b){for(sn=rt,pt=tn=Je+(pn-Bt)*tn-(jn=(pn-Bt)*On(ft.Ea,ft.b)),Gt=rt,Dn=Je,In=[],jn=(rr=jn)-1;0<=jn;--jn)In[jn]=Gt[Dn+jn];for(jn=rr-1;0<=jn;--jn)sn[pt+jn]=In[jn];to(ft,Bt,pn,rt,tn,rt,Je)}else to(ft,Bt,pn,pt,Gt,rt,Je)}Je=ye,rt=oe}rt!=oe&&r(ye,oe,Je,rt,Be)}function ot(U,Z){var oe=U.V,ye=U.Ba+U.c*U.C,Ne=Z-U.C;if(t(Z<=U.l.o),t(16>=Ne),0<Ne){var Be=U.l,$e=U.Ta,Je=U.Ua,rt=Be.width;if(kt(U,Ne,oe,ye),Ne=Je=[Je],t((oe=U.C)<(ye=Z)),t(Be.v<Be.va),ye>Be.o&&(ye=Be.o),oe<Be.j){var ft=Be.j-oe;oe=Be.j,Ne[0]+=ft*rt}if(oe>=ye?oe=0:(Ne[0]+=4*Be.v,Be.ka=oe-Be.j,Be.U=Be.va-Be.v,Be.T=ye-oe,oe=1),oe){if(Je=Je[0],11>(oe=U.ca).S){var Bt=oe.f.RGBA,pn=(ye=oe.S,Ne=Be.U,Be=Be.T,ft=Bt.eb,Bt.A),pt=Be;for(Bt=Bt.fb+U.Ma*Bt.A;0<pt--;){var Gt=$e,tn=Je,In=Ne,sn=ft,Dn=Bt;switch(ye){case gi:Gl(Gt,tn,In,sn,Dn);break;case nh:$h(Gt,tn,In,sn,Dn);break;case Ly:$h(Gt,tn,In,sn,Dn),zf(sn,Dn,0,In,1,0);break;case Fx:Sd(Gt,tn,In,sn,Dn);break;case My:bn(Gt,tn,In,sn,Dn,1);break;case og:bn(Gt,tn,In,sn,Dn,1),zf(sn,Dn,0,In,1,0);break;case $f:bn(Gt,tn,In,sn,Dn,0);break;case Dy:bn(Gt,tn,In,sn,Dn,0),zf(sn,Dn,1,In,1,0);break;case Rv:Lc(Gt,tn,In,sn,Dn);break;case jv:Lc(Gt,tn,In,sn,Dn),sg(sn,Dn,In,1,0);break;case Ls:th(Gt,tn,In,sn,Dn);break;default:t(0)}Je+=rt,Bt+=pn}U.Ma+=Be}else alert("todo:EmitRescaledRowsYUVA");t(U.Ma<=oe.height)}}U.C=Z,t(U.C<=U.i)}function Et(U){var Z;if(0<U.ua)return 0;for(Z=0;Z<U.Wb;++Z){var oe=U.Ya[Z].G,ye=U.Ya[Z].H;if(0<oe[1][ye[1]+0].g||0<oe[2][ye[2]+0].g||0<oe[3][ye[3]+0].g)return 0}return 1}function on(U,Z,oe,ye,Ne,Be){if(U.Z!=0){var $e=U.qd,Je=U.rd;for(t(su[U.Z]!=null);Z<oe;++Z)su[U.Z]($e,Je,ye,Ne,ye,Ne,Be),$e=ye,Je=Ne,Ne+=Be;U.qd=$e,U.rd=Je}}function Yt(U,Z){var oe=U.l.ma,ye=oe.Z==0||oe.Z==1?U.l.j:U.C;if(ye=U.C<ye?ye:U.C,t(Z<=U.l.o),Z>ye){var Ne=U.l.width,Be=oe.ca,$e=oe.tb+Ne*ye,Je=U.V,rt=U.Ba+U.c*ye,ft=U.gc;t(U.ab==1),t(ft[0].hc==3),fc(ft[0],ye,Z,Je,rt,Be,$e),on(oe,ye,Z,Be,$e,Ne)}U.C=U.Ma=Z}function Vn(U,Z,oe,ye,Ne,Be,$e){var Je=U.$/ye,rt=U.$%ye,ft=U.m,Bt=U.s,pn=oe+U.$,pt=pn;Ne=oe+ye*Ne;var Gt=oe+ye*Be,tn=280+Bt.ua,In=U.Pb?Je:16777216,sn=0<Bt.ua?Bt.Wa:null,Dn=Bt.wc,jn=pn<Gt?We(Bt,rt,Je):null;t(U.C<Be),t(Gt<=Ne);var rr=!1;e:for(;;){for(;rr||pn<Gt;){var Hn=0;if(Je>=In){var ei=pn-oe;t((In=U).Pb),In.wd=In.m,In.xd=ei,0<In.s.ua&&Dr(In.s.Wa,In.s.vb),In=Je+Fv}if(rt&Dn||(jn=We(Bt,rt,Je)),t(jn!=null),jn.Qb&&(Z[pn]=jn.qb,rr=!0),!rr)if(dt(ft),jn.jc){Hn=ft,ei=Z;var Rr=pn,Di=jn.pd[nt(Hn)&Ru-1];t(jn.jc),256>Di.g?(gt(Hn,Hn.u+Di.g),ei[Rr]=Di.value,Hn=0):(gt(Hn,Hn.u+Di.g-256),t(256<=Di.value),Hn=Di.value),Hn==0&&(rr=!0)}else Hn=Xe(jn.G[0],jn.H[0],ft);if(ft.h)break;if(rr||256>Hn){if(!rr)if(jn.nd)Z[pn]=(jn.qb|Hn<<8)>>>0;else{if(dt(ft),rr=Xe(jn.G[1],jn.H[1],ft),dt(ft),ei=Xe(jn.G[2],jn.H[2],ft),Rr=Xe(jn.G[3],jn.H[3],ft),ft.h)break;Z[pn]=(Rr<<24|rr<<16|Hn<<8|ei)>>>0}if(rr=!1,++pn,++rt>=ye&&(rt=0,++Je,$e!=null&&Je<=Be&&!(Je%16)&&$e(U,Je),sn!=null))for(;pt<pn;)Hn=Z[pt++],sn.X[(506832829*Hn&4294967295)>>>sn.Mb]=Hn}else if(280>Hn){if(Hn=_e(Hn-256,ft),ei=Xe(jn.G[4],jn.H[4],ft),dt(ft),ei=Ie(ye,ei=_e(ei,ft)),ft.h)break;if(pn-oe<ei||Ne-pn<Hn)break e;for(Rr=0;Rr<Hn;++Rr)Z[pn+Rr]=Z[pn+Rr-ei];for(pn+=Hn,rt+=Hn;rt>=ye;)rt-=ye,++Je,$e!=null&&Je<=Be&&!(Je%16)&&$e(U,Je);if(t(pn<=Ne),rt&Dn&&(jn=We(Bt,rt,Je)),sn!=null)for(;pt<pn;)Hn=Z[pt++],sn.X[(506832829*Hn&4294967295)>>>sn.Mb]=Hn}else{if(!(Hn<tn))break e;for(rr=Hn-280,t(sn!=null);pt<pn;)Hn=Z[pt++],sn.X[(506832829*Hn&4294967295)>>>sn.Mb]=Hn;Hn=pn,t(!(rr>>>(ei=sn).Xa)),Z[Hn]=ei.X[rr],rr=!0}rr||t(ft.h==vt(ft))}if(U.Pb&&ft.h&&pn<Ne)t(U.m.h),U.a=5,U.m=U.wd,U.$=U.xd,0<U.s.ua&&Dr(U.s.vb,U.s.Wa);else{if(ft.h)break e;$e!=null&&$e(U,Je>Be?Be:Je),U.a=0,U.$=pn-oe}return 1}return U.a=3,0}function ar(U){t(U!=null),U.vc=null,U.yc=null,U.Ya=null;var Z=U.Wa;Z!=null&&(Z.X=null),U.vb=null,t(U!=null)}function vr(){var U=new ln;return U==null?null:(U.a=0,U.xb=ug,fr("Predictor","VP8LPredictors"),fr("Predictor","VP8LPredictors_C"),fr("PredictorAdd","VP8LPredictorsAdd"),fr("PredictorAdd","VP8LPredictorsAdd_C"),fa=Pr,wd=Qr,Gl=Hi,$h=Bi,Lc=Cr,th=fi,Sd=Cn,he.VP8LMapColor32b=Ou,he.VP8LMapColor8b=rg,U)}function Gr(U,Z,oe,ye,Ne){var Be=1,$e=[U],Je=[Z],rt=ye.m,ft=ye.s,Bt=null,pn=0;e:for(;;){if(oe)for(;Be&&xt(rt,1);){var pt=$e,Gt=Je,tn=ye,In=1,sn=tn.m,Dn=tn.gc[tn.ab],jn=xt(sn,2);if(tn.Oc&1<<jn)Be=0;else{switch(tn.Oc|=1<<jn,Dn.hc=jn,Dn.Ea=pt[0],Dn.nc=Gt[0],Dn.K=[null],++tn.ab,t(4>=tn.ab),jn){case 0:case 1:Dn.b=xt(sn,3)+2,In=Gr(On(Dn.Ea,Dn.b),On(Dn.nc,Dn.b),0,tn,Dn.K),Dn.K=Dn.K[0];break;case 3:var rr,Hn=xt(sn,8)+1,ei=16<Hn?0:4<Hn?1:2<Hn?2:3;if(pt[0]=On(Dn.Ea,ei),Dn.b=ei,rr=In=Gr(Hn,1,0,tn,Dn.K)){var Rr,Di=Hn,ri=Dn,ps=1<<(8>>ri.b),mo=l(ps);if(mo==null)rr=0;else{var Zi=ri.K[0],ti=ri.w;for(mo[0]=ri.K[0][0],Rr=1;Rr<1*Di;++Rr)mo[Rr]=ht(Zi[ti+Rr],mo[Rr-1]);for(;Rr<4*ps;++Rr)mo[Rr]=0;ri.K[0]=null,ri.K[0]=mo,rr=1}}In=rr;break;case 2:break;default:t(0)}Be=In}}if($e=$e[0],Je=Je[0],Be&&xt(rt,1)&&!(Be=1<=(pn=xt(rt,4))&&11>=pn)){ye.a=3;break e}var _r;if(_r=Be)t:{var Ha,Fi,ds,Ia=ye,Fa=$e,Il=Je,io=pn,Go=oe,hl=Ia.m,pa=Ia.s,ms=[null],ws=1,za=0,Ws=zx[io];n:for(;;){if(Go&&xt(hl,1)){var Io=xt(hl,3)+2,Hl=On(Fa,Io),Ba=On(Il,Io),Wl=Hl*Ba;if(!Gr(Hl,Ba,0,Ia,ms))break n;for(ms=ms[0],pa.xc=Io,Ha=0;Ha<Wl;++Ha){var Us=ms[Ha]>>8&65535;ms[Ha]=Us,Us>=ws&&(ws=Us+1)}}if(hl.h)break n;for(Fi=0;5>Fi;++Fi){var Ua=Ov[Fi];!Fi&&0<io&&(Ua+=1<<io),za<Ua&&(za=Ua)}var Pn=h(ws*Ws,Ce),fl=ws,go=h(fl,Re);if(go==null)var No=null;else t(65536>=fl),No=go;var yo=l(za);if(No==null||yo==null||Pn==null){Ia.a=1;break n}var nr=Pn;for(Ha=ds=0;Ha<ws;++Ha){var ma=No[Ha],yc=ma.G,vc=ma.H,Cd=0,au=1,pl=0;for(Fi=0;5>Fi;++Fi){Ua=Ov[Fi],yc[Fi]=nr,vc[Fi]=ds,!Fi&&0<io&&(Ua+=1<<io);i:{var fg,Gv=Ua,By=Ia,Qo=yo,Hv=nr,Nl=ds,Ed=0,ih=By.m,Wv=xt(ih,1);if(a(Qo,0,0,Gv),Wv){var Zv=xt(ih,1)+1,Uy=xt(ih,1),Hh=xt(ih,Uy==0?1:8);Qo[Hh]=1,Zv==2&&(Qo[Hh=xt(ih,8)]=1);var Fc=1}else{var hs=l(19),Wh=xt(ih,4)+4;if(19<Wh){By.a=3;var Yp=0;break i}for(fg=0;fg<Wh;++fg)hs[Ry[fg]]=xt(ih,3);var Vy=void 0,zc=void 0,$y=By,Wf=hs,Pd=Gv,Zh=Qo,un=0,wn=$y.m,Zf=8,Zs=h(128,Ce);r:for(;ge(Zs,0,7,Wf,19);){if(xt(wn,1)){var yt=2+2*xt(wn,3);if((Vy=2+xt(wn,yt))>Pd)break r}else Vy=Pd;for(zc=0;zc<Pd&&Vy--;){dt(wn);var pg=Zs[0+(127&nt(wn))];gt(wn,wn.u+pg.g);var ou=pg.value;if(16>ou)Zh[zc++]=ou,ou!=0&&(Zf=ou);else{var qy=ou==16,Xp=ou-16,Wx=Xw[Xp],lu=xt(wn,Yw[Xp])+Wx;if(zc+lu>Pd)break r;for(var Jp=qy?Zf:0;0<lu--;)Zh[zc++]=Jp}}un=1;break r}un||($y.a=3),Fc=un}(Fc=Fc&&!ih.h)&&(Ed=ge(Hv,Nl,8,Qo,Gv)),Fc&&Ed!=0?Yp=Ed:(By.a=3,Yp=0)}if(Yp==0)break n;if(au&&Jw[Fi]==1&&(au=nr[ds].g==0),Cd+=nr[ds].g,ds+=Yp,3>=Fi){var Qp,Kv=yo[0];for(Qp=1;Qp<Ua;++Qp)yo[Qp]>Kv&&(Kv=yo[Qp]);pl+=Kv}}if(ma.nd=au,ma.Qb=0,au&&(ma.qb=(yc[3][vc[3]+0].value<<24|yc[1][vc[1]+0].value<<16|yc[2][vc[2]+0].value)>>>0,Cd==0&&256>yc[0][vc[0]+0].value&&(ma.Qb=1,ma.qb+=yc[0][vc[0]+0].value<<8)),ma.jc=!ma.Qb&&6>pl,ma.jc){var mg,cu=ma;for(mg=0;mg<Ru;++mg){var kd=mg,sh=cu.pd[kd],gg=cu.G[0][cu.H[0]+kd];256<=gg.value?(sh.g=gg.g+256,sh.value=gg.value):(sh.g=0,sh.value=0,kd>>=He(gg,8,sh),kd>>=He(cu.G[1][cu.H[1]+kd],16,sh),kd>>=He(cu.G[2][cu.H[2]+kd],0,sh),He(cu.G[3][cu.H[3]+kd],24,sh))}}}pa.vc=ms,pa.Wb=ws,pa.Ya=No,pa.yc=Pn,_r=1;break t}_r=0}if(!(Be=_r)){ye.a=3;break e}if(0<pn){if(ft.ua=1<<pn,!st(ft.Wa,pn)){ye.a=1,Be=0;break e}}else ft.ua=0;var em=ye,tm=$e,nm=Je,yg=em.s,Gy=yg.xc;if(em.c=tm,em.i=nm,yg.md=On(tm,Gy),yg.wc=Gy==0?-1:(1<<Gy)-1,oe){ye.xb=Bv;break e}if((Bt=l($e*Je))==null){ye.a=1,Be=0;break e}Be=(Be=Vn(ye,Bt,0,$e,Je,Je,null))&&!rt.h;break e}return Be?(Ne!=null?Ne[0]=Bt:(t(Bt==null),t(oe)),ye.$=0,oe||ar(ft)):ar(ft),Be}function Fr(U,Z){var oe=U.c*U.i,ye=oe+Z+16*Z;return t(U.c<=Z),U.V=l(ye),U.V==null?(U.Ta=null,U.Ua=0,U.a=1,0):(U.Ta=U.V,U.Ua=U.Ba+oe+Z,1)}function pi(U,Z){var oe=U.C,ye=Z-oe,Ne=U.V,Be=U.Ba+U.c*oe;for(t(Z<=U.l.o);0<ye;){var $e=16<ye?16:ye,Je=U.l.ma,rt=U.l.width,ft=rt*$e,Bt=Je.ca,pn=Je.tb+rt*oe,pt=U.Ta,Gt=U.Ua;kt(U,$e,Ne,Be),ag(pt,Gt,Bt,pn,ft),on(Je,oe,oe+$e,Bt,pn,rt),ye-=$e,Ne+=$e*U.c,oe+=$e}t(oe==Z),U.C=U.Ma=Z}function Vi(){this.ub=this.yd=this.td=this.Rb=0}function ai(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Js(){this.Fb=this.Bb=this.Cb=0,this.Zb=l(4),this.Lb=l(4)}function ha(){this.Yb=function(){var U=[];return function Z(oe,ye,Ne){for(var Be=Ne[ye],$e=0;$e<Be&&(oe.push(Ne.length>ye+1?[]:0),!(Ne.length<ye+1));$e++)Z(oe[$e],ye+1,Ne)}(U,0,[3,11]),U}()}function xa(){this.jb=l(3),this.Wc=i([4,8],ha),this.Xc=i([4,17],ha)}function Wi(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new l(4),this.od=new l(4)}function bi(){this.ld=this.La=this.dd=this.tc=0}function Ns(){this.Na=this.la=0}function zs(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function as(){this.ad=l(384),this.Za=0,this.Ob=l(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ja(){this.uc=this.M=this.Nb=0,this.wa=Array(new bi),this.Y=0,this.ya=Array(new as),this.aa=0,this.l=new ac}function Vo(){this.y=l(16),this.f=l(8),this.ea=l(8)}function Cl(){this.cb=this.a=0,this.sc="",this.m=new me,this.Od=new Vi,this.Kc=new ai,this.ed=new Wi,this.Qa=new Js,this.Ic=this.$c=this.Aa=0,this.D=new Ja,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=h(8,me),this.ia=0,this.pb=h(4,zs),this.Pa=new xa,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Vo),this.Hd=0,this.rb=Array(new Ns),this.sb=0,this.wa=Array(new bi),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new as),this.L=this.aa=0,this.gd=i([4,2],bi),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ac(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function $o(){var U=new Cl;return U!=null&&(U.a=0,U.sc="OK",U.cb=0,U.Xb=0,zu||(zu=oc)),U}function Pa(U,Z,oe){return U.a==0&&(U.a=Z,U.sc=oe,U.cb=0),0}function Qm(U,Z,oe){return 3<=oe&&U[Z+0]==157&&U[Z+1]==1&&U[Z+2]==42}function ku(U,Z){if(U==null)return 0;if(U.a=0,U.sc="OK",Z==null)return Pa(U,2,"null VP8Io passed to VP8GetHeaders()");var oe=Z.data,ye=Z.w,Ne=Z.ha;if(4>Ne)return Pa(U,7,"Truncated header.");var Be=oe[ye+0]|oe[ye+1]<<8|oe[ye+2]<<16,$e=U.Od;if($e.Rb=!(1&Be),$e.td=Be>>1&7,$e.yd=Be>>4&1,$e.ub=Be>>5,3<$e.td)return Pa(U,3,"Incorrect keyframe parameters.");if(!$e.yd)return Pa(U,4,"Frame not displayable.");ye+=3,Ne-=3;var Je=U.Kc;if($e.Rb){if(7>Ne)return Pa(U,7,"cannot parse picture header");if(!Qm(oe,ye,Ne))return Pa(U,3,"Bad code word");Je.c=16383&(oe[ye+4]<<8|oe[ye+3]),Je.Td=oe[ye+4]>>6,Je.i=16383&(oe[ye+6]<<8|oe[ye+5]),Je.Ud=oe[ye+6]>>6,ye+=7,Ne-=7,U.za=Je.c+15>>4,U.Ub=Je.i+15>>4,Z.width=Je.c,Z.height=Je.i,Z.Da=0,Z.j=0,Z.v=0,Z.va=Z.width,Z.o=Z.height,Z.da=0,Z.ib=Z.width,Z.hb=Z.height,Z.U=Z.width,Z.T=Z.height,a((Be=U.Pa).jb,0,255,Be.jb.length),t((Be=U.Qa)!=null),Be.Cb=0,Be.Bb=0,Be.Fb=1,a(Be.Zb,0,0,Be.Zb.length),a(Be.Lb,0,0,Be.Lb)}if($e.ub>Ne)return Pa(U,7,"bad partition length");Qe(Be=U.m,oe,ye,$e.ub),ye+=$e.ub,Ne-=$e.ub,$e.Rb&&(Je.Ld=mt(Be),Je.Kd=mt(Be)),Je=U.Qa;var rt,ft=U.Pa;if(t(Be!=null),t(Je!=null),Je.Cb=mt(Be),Je.Cb){if(Je.Bb=mt(Be),mt(Be)){for(Je.Fb=mt(Be),rt=0;4>rt;++rt)Je.Zb[rt]=mt(Be)?je(Be,7):0;for(rt=0;4>rt;++rt)Je.Lb[rt]=mt(Be)?je(Be,6):0}if(Je.Bb)for(rt=0;3>rt;++rt)ft.jb[rt]=mt(Be)?et(Be,8):255}else Je.Bb=0;if(Be.Ka)return Pa(U,3,"cannot parse segment header");if((Je=U.ed).zd=mt(Be),Je.Tb=et(Be,6),Je.wb=et(Be,3),Je.Pc=mt(Be),Je.Pc&&mt(Be)){for(ft=0;4>ft;++ft)mt(Be)&&(Je.vd[ft]=je(Be,6));for(ft=0;4>ft;++ft)mt(Be)&&(Je.od[ft]=je(Be,6))}if(U.L=Je.Tb==0?0:Je.zd?1:2,Be.Ka)return Pa(U,3,"cannot parse filter header");var Bt=Ne;if(Ne=rt=ye,ye=rt+Bt,Je=Bt,U.Xb=(1<<et(U.m,2))-1,Bt<3*(ft=U.Xb))oe=7;else{for(rt+=3*ft,Je-=3*ft,Bt=0;Bt<ft;++Bt){var pn=oe[Ne+0]|oe[Ne+1]<<8|oe[Ne+2]<<16;pn>Je&&(pn=Je),Qe(U.Jc[+Bt],oe,rt,pn),rt+=pn,Je-=pn,Ne+=3}Qe(U.Jc[+ft],oe,rt,Je),oe=rt<ye?0:5}if(oe!=0)return Pa(U,oe,"cannot parse partitions");for(oe=et(rt=U.m,7),Ne=mt(rt)?je(rt,4):0,ye=mt(rt)?je(rt,4):0,Je=mt(rt)?je(rt,4):0,ft=mt(rt)?je(rt,4):0,rt=mt(rt)?je(rt,4):0,Bt=U.Qa,pn=0;4>pn;++pn){if(Bt.Cb){var pt=Bt.Zb[pn];Bt.Fb||(pt+=oe)}else{if(0<pn){U.pb[pn]=U.pb[0];continue}pt=oe}var Gt=U.pb[pn];Gt.Sc[0]=qp[bs(pt+Ne,127)],Gt.Sc[1]=lg[bs(pt+0,127)],Gt.Eb[0]=2*qp[bs(pt+ye,127)],Gt.Eb[1]=101581*lg[bs(pt+Je,127)]>>16,8>Gt.Eb[1]&&(Gt.Eb[1]=8),Gt.Qc[0]=qp[bs(pt+ft,117)],Gt.Qc[1]=lg[bs(pt+rt,127)],Gt.lc=pt+rt}if(!$e.Rb)return Pa(U,4,"Not a key frame.");for(mt(Be),$e=U.Pa,oe=0;4>oe;++oe){for(Ne=0;8>Ne;++Ne)for(ye=0;3>ye;++ye)for(Je=0;11>Je;++Je)ft=Pt(Be,zv[oe][Ne][ye][Je])?et(Be,8):Hp[oe][Ne][ye][Je],$e.Wc[oe][Ne].Yb[ye][Je]=ft;for(Ne=0;17>Ne;++Ne)$e.Xc[oe][Ne]=$e.Wc[oe][Ux[Ne]]}return U.kc=mt(Be),U.kc&&(U.Bd=et(Be,8)),U.cb=1}function oc(U,Z,oe,ye,Ne,Be,$e){var Je=Z[Ne].Yb[oe];for(oe=0;16>Ne;++Ne){if(!Pt(U,Je[oe+0]))return Ne;for(;!Pt(U,Je[oe+1]);)if(Je=Z[++Ne].Yb[0],oe=0,Ne==16)return 16;var rt=Z[Ne+1].Yb;if(Pt(U,Je[oe+2])){var ft=U,Bt=0;if(Pt(ft,(pt=Je)[(pn=oe)+3]))if(Pt(ft,pt[pn+6])){for(Je=0,pn=2*(Bt=Pt(ft,pt[pn+8]))+(pt=Pt(ft,pt[pn+9+Bt])),Bt=0,pt=Gp[pn];pt[Je];++Je)Bt+=Bt+Pt(ft,pt[Je]);Bt+=3+(8<<pn)}else Pt(ft,pt[pn+7])?(Bt=7+2*Pt(ft,165),Bt+=Pt(ft,145)):Bt=5+Pt(ft,159);else Bt=Pt(ft,pt[pn+4])?3+Pt(ft,pt[pn+5]):2;Je=rt[2]}else Bt=1,Je=rt[1];rt=$e+jy[Ne],0>(ft=U).b&&At(ft);var pn,pt=ft.b,Gt=(pn=ft.Ca>>1)-(ft.I>>pt)>>31;--ft.b,ft.Ca+=Gt,ft.Ca|=1,ft.I-=(pn+1&Gt)<<pt,Be[rt]=((Bt^Gt)-Gt)*ye[(0<Ne)+0]}return 16}function Iu(U){var Z=U.rb[U.sb-1];Z.la=0,Z.Na=0,a(U.zc,0,0,U.zc.length),U.ja=0}function $l(U,Z,oe,ye,Ne){Ne=U[Z+oe+32*ye]+(Ne>>3),U[Z+oe+32*ye]=-256&Ne?0>Ne?0:255:Ne}function lc(U,Z,oe,ye,Ne,Be){$l(U,Z,0,oe,ye+Ne),$l(U,Z,1,oe,ye+Be),$l(U,Z,2,oe,ye-Be),$l(U,Z,3,oe,ye-Ne)}function ka(U){return(20091*U>>16)+U}function Mf(U,Z,oe,ye){var Ne,Be=0,$e=l(16);for(Ne=0;4>Ne;++Ne){var Je=U[Z+0]+U[Z+8],rt=U[Z+0]-U[Z+8],ft=(35468*U[Z+4]>>16)-ka(U[Z+12]),Bt=ka(U[Z+4])+(35468*U[Z+12]>>16);$e[Be+0]=Je+Bt,$e[Be+1]=rt+ft,$e[Be+2]=rt-ft,$e[Be+3]=Je-Bt,Be+=4,Z++}for(Ne=Be=0;4>Ne;++Ne)Je=(U=$e[Be+0]+4)+$e[Be+8],rt=U-$e[Be+8],ft=(35468*$e[Be+4]>>16)-ka($e[Be+12]),$l(oe,ye,0,0,Je+(Bt=ka($e[Be+4])+(35468*$e[Be+12]>>16))),$l(oe,ye,1,0,rt+ft),$l(oe,ye,2,0,rt-ft),$l(oe,ye,3,0,Je-Bt),Be++,ye+=32}function Yc(U,Z,oe,ye){var Ne=U[Z+0]+4,Be=35468*U[Z+4]>>16,$e=ka(U[Z+4]),Je=35468*U[Z+1]>>16;lc(oe,ye,0,Ne+$e,U=ka(U[Z+1]),Je),lc(oe,ye,1,Ne+Be,U,Je),lc(oe,ye,2,Ne-Be,U,Je),lc(oe,ye,3,Ne-$e,U,Je)}function eg(U,Z,oe,ye,Ne){Mf(U,Z,oe,ye),Ne&&Mf(U,Z+16,oe,ye+4)}function Rp(U,Z,oe,ye){pc(U,Z+0,oe,ye,1),pc(U,Z+32,oe,ye+128,1)}function Qa(U,Z,oe,ye){var Ne;for(U=U[Z+0]+4,Ne=0;4>Ne;++Ne)for(Z=0;4>Z;++Z)$l(oe,ye,Z,Ne,U)}function cc(U,Z,oe,ye){U[Z+0]&&ia(U,Z+0,oe,ye),U[Z+16]&&ia(U,Z+16,oe,ye+4),U[Z+32]&&ia(U,Z+32,oe,ye+128),U[Z+48]&&ia(U,Z+48,oe,ye+128+4)}function Xc(U,Z,oe,ye){var Ne,Be=l(16);for(Ne=0;4>Ne;++Ne){var $e=U[Z+0+Ne]+U[Z+12+Ne],Je=U[Z+4+Ne]+U[Z+8+Ne],rt=U[Z+4+Ne]-U[Z+8+Ne],ft=U[Z+0+Ne]-U[Z+12+Ne];Be[0+Ne]=$e+Je,Be[8+Ne]=$e-Je,Be[4+Ne]=ft+rt,Be[12+Ne]=ft-rt}for(Ne=0;4>Ne;++Ne)$e=(U=Be[0+4*Ne]+3)+Be[3+4*Ne],Je=Be[1+4*Ne]+Be[2+4*Ne],rt=Be[1+4*Ne]-Be[2+4*Ne],ft=U-Be[3+4*Ne],oe[ye+0]=$e+Je>>3,oe[ye+16]=ft+rt>>3,oe[ye+32]=$e-Je>>3,oe[ye+48]=ft-rt>>3,ye+=64}function Xo(U,Z,oe){var ye,Ne=Z-32,Be=kl,$e=255-U[Ne-1];for(ye=0;ye<oe;++ye){var Je,rt=Be,ft=$e+U[Z-1];for(Je=0;Je<oe;++Je)U[Z+Je]=rt[ft+U[Ne+Je]];Z+=32}}function Po(U,Z){Xo(U,Z,4)}function Yd(U,Z){Xo(U,Z,8)}function tg(U,Z){Xo(U,Z,16)}function Lf(U,Z){var oe;for(oe=0;16>oe;++oe)r(U,Z+32*oe,U,Z-32,16)}function Jc(U,Z){var oe;for(oe=16;0<oe;--oe)a(U,Z,U[Z-1],16),Z+=32}function Nu(U,Z,oe){var ye;for(ye=0;16>ye;++ye)a(Z,oe+32*ye,U,16)}function Qc(U,Z){var oe,ye=16;for(oe=0;16>oe;++oe)ye+=U[Z-1+32*oe]+U[Z+oe-32];Nu(ye>>5,U,Z)}function Rh(U,Z){var oe,ye=8;for(oe=0;16>oe;++oe)ye+=U[Z-1+32*oe];Nu(ye>>4,U,Z)}function qo(U,Z){var oe,ye=8;for(oe=0;16>oe;++oe)ye+=U[Z+oe-32];Nu(ye>>4,U,Z)}function Df(U,Z){Nu(128,U,Z)}function Li(U,Z,oe){return U+2*Z+oe+2>>2}function jh(U,Z){var oe,ye=Z-32;for(ye=new Uint8Array([Li(U[ye-1],U[ye+0],U[ye+1]),Li(U[ye+0],U[ye+1],U[ye+2]),Li(U[ye+1],U[ye+2],U[ye+3]),Li(U[ye+2],U[ye+3],U[ye+4])]),oe=0;4>oe;++oe)r(U,Z+32*oe,ye,0,ye.length)}function jp(U,Z){var oe=U[Z-1],ye=U[Z-1+32],Ne=U[Z-1+64],Be=U[Z-1+96];Ht(U,Z+0,16843009*Li(U[Z-1-32],oe,ye)),Ht(U,Z+32,16843009*Li(oe,ye,Ne)),Ht(U,Z+64,16843009*Li(ye,Ne,Be)),Ht(U,Z+96,16843009*Li(Ne,Be,Be))}function ng(U,Z){var oe,ye=4;for(oe=0;4>oe;++oe)ye+=U[Z+oe-32]+U[Z-1+32*oe];for(ye>>=3,oe=0;4>oe;++oe)a(U,Z+32*oe,ye,4)}function Op(U,Z){var oe=U[Z-1+0],ye=U[Z-1+32],Ne=U[Z-1+64],Be=U[Z-1-32],$e=U[Z+0-32],Je=U[Z+1-32],rt=U[Z+2-32],ft=U[Z+3-32];U[Z+0+96]=Li(ye,Ne,U[Z-1+96]),U[Z+1+96]=U[Z+0+64]=Li(oe,ye,Ne),U[Z+2+96]=U[Z+1+64]=U[Z+0+32]=Li(Be,oe,ye),U[Z+3+96]=U[Z+2+64]=U[Z+1+32]=U[Z+0+0]=Li($e,Be,oe),U[Z+3+64]=U[Z+2+32]=U[Z+1+0]=Li(Je,$e,Be),U[Z+3+32]=U[Z+2+0]=Li(rt,Je,$e),U[Z+3+0]=Li(ft,rt,Je)}function mi(U,Z){var oe=U[Z+1-32],ye=U[Z+2-32],Ne=U[Z+3-32],Be=U[Z+4-32],$e=U[Z+5-32],Je=U[Z+6-32],rt=U[Z+7-32];U[Z+0+0]=Li(U[Z+0-32],oe,ye),U[Z+1+0]=U[Z+0+32]=Li(oe,ye,Ne),U[Z+2+0]=U[Z+1+32]=U[Z+0+64]=Li(ye,Ne,Be),U[Z+3+0]=U[Z+2+32]=U[Z+1+64]=U[Z+0+96]=Li(Ne,Be,$e),U[Z+3+32]=U[Z+2+64]=U[Z+1+96]=Li(Be,$e,Je),U[Z+3+64]=U[Z+2+96]=Li($e,Je,rt),U[Z+3+96]=Li(Je,rt,rt)}function uc(U,Z){var oe=U[Z-1+0],ye=U[Z-1+32],Ne=U[Z-1+64],Be=U[Z-1-32],$e=U[Z+0-32],Je=U[Z+1-32],rt=U[Z+2-32],ft=U[Z+3-32];U[Z+0+0]=U[Z+1+64]=Be+$e+1>>1,U[Z+1+0]=U[Z+2+64]=$e+Je+1>>1,U[Z+2+0]=U[Z+3+64]=Je+rt+1>>1,U[Z+3+0]=rt+ft+1>>1,U[Z+0+96]=Li(Ne,ye,oe),U[Z+0+64]=Li(ye,oe,Be),U[Z+0+32]=U[Z+1+96]=Li(oe,Be,$e),U[Z+1+32]=U[Z+2+96]=Li(Be,$e,Je),U[Z+2+32]=U[Z+3+96]=Li($e,Je,rt),U[Z+3+32]=Li(Je,rt,ft)}function Cy(U,Z){var oe=U[Z+0-32],ye=U[Z+1-32],Ne=U[Z+2-32],Be=U[Z+3-32],$e=U[Z+4-32],Je=U[Z+5-32],rt=U[Z+6-32],ft=U[Z+7-32];U[Z+0+0]=oe+ye+1>>1,U[Z+1+0]=U[Z+0+64]=ye+Ne+1>>1,U[Z+2+0]=U[Z+1+64]=Ne+Be+1>>1,U[Z+3+0]=U[Z+2+64]=Be+$e+1>>1,U[Z+0+32]=Li(oe,ye,Ne),U[Z+1+32]=U[Z+0+96]=Li(ye,Ne,Be),U[Z+2+32]=U[Z+1+96]=Li(Ne,Be,$e),U[Z+3+32]=U[Z+2+96]=Li(Be,$e,Je),U[Z+3+64]=Li($e,Je,rt),U[Z+3+96]=Li(Je,rt,ft)}function Ey(U,Z){var oe=U[Z-1+0],ye=U[Z-1+32],Ne=U[Z-1+64],Be=U[Z-1+96];U[Z+0+0]=oe+ye+1>>1,U[Z+2+0]=U[Z+0+32]=ye+Ne+1>>1,U[Z+2+32]=U[Z+0+64]=Ne+Be+1>>1,U[Z+1+0]=Li(oe,ye,Ne),U[Z+3+0]=U[Z+1+32]=Li(ye,Ne,Be),U[Z+3+32]=U[Z+1+64]=Li(Ne,Be,Be),U[Z+3+64]=U[Z+2+64]=U[Z+0+96]=U[Z+1+96]=U[Z+2+96]=U[Z+3+96]=Be}function Xd(U,Z){var oe=U[Z-1+0],ye=U[Z-1+32],Ne=U[Z-1+64],Be=U[Z-1+96],$e=U[Z-1-32],Je=U[Z+0-32],rt=U[Z+1-32],ft=U[Z+2-32];U[Z+0+0]=U[Z+2+32]=oe+$e+1>>1,U[Z+0+32]=U[Z+2+64]=ye+oe+1>>1,U[Z+0+64]=U[Z+2+96]=Ne+ye+1>>1,U[Z+0+96]=Be+Ne+1>>1,U[Z+3+0]=Li(Je,rt,ft),U[Z+2+0]=Li($e,Je,rt),U[Z+1+0]=U[Z+3+32]=Li(oe,$e,Je),U[Z+1+32]=U[Z+3+64]=Li(ye,oe,$e),U[Z+1+64]=U[Z+3+96]=Li(Ne,ye,oe),U[Z+1+96]=Li(Be,Ne,ye)}function eu(U,Z){var oe;for(oe=0;8>oe;++oe)r(U,Z+32*oe,U,Z-32,8)}function tu(U,Z){var oe;for(oe=0;8>oe;++oe)a(U,Z,U[Z-1],8),Z+=32}function pd(U,Z,oe){var ye;for(ye=0;8>ye;++ye)a(Z,oe+32*ye,U,8)}function Jd(U,Z){var oe,ye=8;for(oe=0;8>oe;++oe)ye+=U[Z+oe-32]+U[Z-1+32*oe];pd(ye>>4,U,Z)}function Py(U,Z){var oe,ye=4;for(oe=0;8>oe;++oe)ye+=U[Z+oe-32];pd(ye>>3,U,Z)}function Mu(U,Z){var oe,ye=4;for(oe=0;8>oe;++oe)ye+=U[Z-1+32*oe];pd(ye>>3,U,Z)}function Fp(U,Z){pd(128,U,Z)}function Qd(U,Z,oe){var ye=U[Z-oe],Ne=U[Z+0],Be=3*(Ne-ye)+Vf[1020+U[Z-2*oe]-U[Z+oe]],$e=Dc[112+(Be+4>>3)];U[Z-oe]=kl[255+ye+Dc[112+(Be+3>>3)]],U[Z+0]=kl[255+Ne-$e]}function nu(U,Z,oe,ye){var Ne=U[Z+0],Be=U[Z+oe];return Ga[255+U[Z-2*oe]-U[Z-oe]]>ye||Ga[255+Be-Ne]>ye}function Oh(U,Z,oe,ye){return 4*Ga[255+U[Z-oe]-U[Z+0]]+Ga[255+U[Z-2*oe]-U[Z+oe]]<=ye}function El(U,Z,oe,ye,Ne){var Be=U[Z-3*oe],$e=U[Z-2*oe],Je=U[Z-oe],rt=U[Z+0],ft=U[Z+oe],Bt=U[Z+2*oe],pn=U[Z+3*oe];return 4*Ga[255+Je-rt]+Ga[255+$e-ft]>ye?0:Ga[255+U[Z-4*oe]-Be]<=Ne&&Ga[255+Be-$e]<=Ne&&Ga[255+$e-Je]<=Ne&&Ga[255+pn-Bt]<=Ne&&Ga[255+Bt-ft]<=Ne&&Ga[255+ft-rt]<=Ne}function eh(U,Z,oe,ye){var Ne=2*ye+1;for(ye=0;16>ye;++ye)Oh(U,Z+ye,oe,Ne)&&Qd(U,Z+ye,oe)}function md(U,Z,oe,ye){var Ne=2*ye+1;for(ye=0;16>ye;++ye)Oh(U,Z+ye*oe,1,Ne)&&Qd(U,Z+ye*oe,1)}function Pl(U,Z,oe,ye){var Ne;for(Ne=3;0<Ne;--Ne)eh(U,Z+=4*oe,oe,ye)}function gd(U,Z,oe,ye){var Ne;for(Ne=3;0<Ne;--Ne)md(U,Z+=4,oe,ye)}function ho(U,Z,oe,ye,Ne,Be,$e,Je){for(Be=2*Be+1;0<Ne--;){if(El(U,Z,oe,Be,$e))if(nu(U,Z,oe,Je))Qd(U,Z,oe);else{var rt=U,ft=Z,Bt=oe,pn=rt[ft-2*Bt],pt=rt[ft-Bt],Gt=rt[ft+0],tn=rt[ft+Bt],In=rt[ft+2*Bt],sn=27*(jn=Vf[1020+3*(Gt-pt)+Vf[1020+pn-tn]])+63>>7,Dn=18*jn+63>>7,jn=9*jn+63>>7;rt[ft-3*Bt]=kl[255+rt[ft-3*Bt]+jn],rt[ft-2*Bt]=kl[255+pn+Dn],rt[ft-Bt]=kl[255+pt+sn],rt[ft+0]=kl[255+Gt-sn],rt[ft+Bt]=kl[255+tn-Dn],rt[ft+2*Bt]=kl[255+In-jn]}Z+=ye}}function Lu(U,Z,oe,ye,Ne,Be,$e,Je){for(Be=2*Be+1;0<Ne--;){if(El(U,Z,oe,Be,$e))if(nu(U,Z,oe,Je))Qd(U,Z,oe);else{var rt=U,ft=Z,Bt=oe,pn=rt[ft-Bt],pt=rt[ft+0],Gt=rt[ft+Bt],tn=Dc[112+(4+(In=3*(pt-pn))>>3)],In=Dc[112+(In+3>>3)],sn=tn+1>>1;rt[ft-2*Bt]=kl[255+rt[ft-2*Bt]+sn],rt[ft-Bt]=kl[255+pn+In],rt[ft+0]=kl[255+pt-tn],rt[ft+Bt]=kl[255+Gt-sn]}Z+=ye}}function Rf(U,Z,oe,ye,Ne,Be){ho(U,Z,oe,1,16,ye,Ne,Be)}function zp(U,Z,oe,ye,Ne,Be){ho(U,Z,1,oe,16,ye,Ne,Be)}function Ii(U,Z,oe,ye,Ne,Be){var $e;for($e=3;0<$e;--$e)Lu(U,Z+=4*oe,oe,1,16,ye,Ne,Be)}function Bp(U,Z,oe,ye,Ne,Be){var $e;for($e=3;0<$e;--$e)Lu(U,Z+=4,1,oe,16,ye,Ne,Be)}function re(U,Z,oe,ye,Ne,Be,$e,Je){ho(U,Z,Ne,1,8,Be,$e,Je),ho(oe,ye,Ne,1,8,Be,$e,Je)}function Pe(U,Z,oe,ye,Ne,Be,$e,Je){ho(U,Z,1,Ne,8,Be,$e,Je),ho(oe,ye,1,Ne,8,Be,$e,Je)}function qe(U,Z,oe,ye,Ne,Be,$e,Je){Lu(U,Z+4*Ne,Ne,1,8,Be,$e,Je),Lu(oe,ye+4*Ne,Ne,1,8,Be,$e,Je)}function Rt(U,Z,oe,ye,Ne,Be,$e,Je){Lu(U,Z+4,1,Ne,8,Be,$e,Je),Lu(oe,ye+4,1,Ne,8,Be,$e,Je)}function Zt(){this.ba=new ts,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new xs,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function kn(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Wn(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Mr(){this.ua=0,this.Wa=new Or,this.vb=new Or,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Re,this.yc=new Ce}function ln(){this.xb=this.a=0,this.l=new ac,this.ca=new ts,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Ye,this.Pb=0,this.wd=new Ye,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Mr,this.ab=0,this.gc=h(4,Wn),this.Oc=0}function lr(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ac,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ur(U,Z,oe,ye,Ne,Be,$e){for(U=U==null?0:U[Z+0],Z=0;Z<$e;++Z)Ne[Be+Z]=U+oe[ye+Z]&255,U=Ne[Be+Z]}function $i(U,Z,oe,ye,Ne,Be,$e){var Je;if(U==null)ur(null,null,oe,ye,Ne,Be,$e);else for(Je=0;Je<$e;++Je)Ne[Be+Je]=U[Z+Je]+oe[ye+Je]&255}function aa(U,Z,oe,ye,Ne,Be,$e){if(U==null)ur(null,null,oe,ye,Ne,Be,$e);else{var Je,rt=U[Z+0],ft=rt,Bt=rt;for(Je=0;Je<$e;++Je)ft=Bt+(rt=U[Z+Je])-ft,Bt=oe[ye+Je]+(-256&ft?0>ft?0:255:ft)&255,ft=rt,Ne[Be+Je]=Bt}}function Hr(U,Z,oe,ye){var Ne=Z.width,Be=Z.o;if(t(U!=null&&Z!=null),0>oe||0>=ye||oe+ye>Be)return null;if(!U.Cc){if(U.ga==null){var $e;if(U.ga=new lr,($e=U.ga==null)||($e=Z.width*Z.o,t(U.Gb.length==0),U.Gb=l($e),U.Uc=0,U.Gb==null?$e=0:(U.mb=U.Gb,U.nb=U.Uc,U.rc=null,$e=1),$e=!$e),!$e){$e=U.ga;var Je=U.Fa,rt=U.P,ft=U.qc,Bt=U.mb,pn=U.nb,pt=rt+1,Gt=ft-1,tn=$e.l;if(t(Je!=null&&Bt!=null&&Z!=null),su[0]=null,su[1]=ur,su[2]=$i,su[3]=aa,$e.ca=Bt,$e.tb=pn,$e.c=Z.width,$e.i=Z.height,t(0<$e.c&&0<$e.i),1>=ft)Z=0;else if($e.$a=3&Je[rt+0],$e.Z=Je[rt+0]>>2&3,$e.Lc=Je[rt+0]>>4&3,rt=Je[rt+0]>>6&3,0>$e.$a||1<$e.$a||4<=$e.Z||1<$e.Lc||rt)Z=0;else if(tn.put=qr,tn.ac=ja,tn.bc=lt,tn.ma=$e,tn.width=Z.width,tn.height=Z.height,tn.Da=Z.Da,tn.v=Z.v,tn.va=Z.va,tn.j=Z.j,tn.o=Z.o,$e.$a)e:{t($e.$a==1),Z=vr();t:for(;;){if(Z==null){Z=0;break e}if(t($e!=null),$e.mc=Z,Z.c=$e.c,Z.i=$e.i,Z.l=$e.l,Z.l.ma=$e,Z.l.width=$e.c,Z.l.height=$e.i,Z.a=0,De(Z.m,Je,pt,Gt),!Gr($e.c,$e.i,1,Z,null)||(Z.ab==1&&Z.gc[0].hc==3&&Et(Z.s)?($e.ic=1,Je=Z.c*Z.i,Z.Ta=null,Z.Ua=0,Z.V=l(Je),Z.Ba=0,Z.V==null?(Z.a=1,Z=0):Z=1):($e.ic=0,Z=Fr(Z,$e.c)),!Z))break t;Z=1;break e}$e.mc=null,Z=0}else Z=Gt>=$e.c*$e.i;$e=!Z}if($e)return null;U.ga.Lc!=1?U.Ga=0:ye=Be-oe}t(U.ga!=null),t(oe+ye<=Be);e:{if(Z=(Je=U.ga).c,Be=Je.l.o,Je.$a==0){if(pt=U.rc,Gt=U.Vc,tn=U.Fa,rt=U.P+1+oe*Z,ft=U.mb,Bt=U.nb+oe*Z,t(rt<=U.P+U.qc),Je.Z!=0)for(t(su[Je.Z]!=null),$e=0;$e<ye;++$e)su[Je.Z](pt,Gt,tn,rt,ft,Bt,Z),pt=ft,Gt=Bt,Bt+=Z,rt+=Z;else for($e=0;$e<ye;++$e)r(ft,Bt,tn,rt,Z),pt=ft,Gt=Bt,Bt+=Z,rt+=Z;U.rc=pt,U.Vc=Gt}else{if(t(Je.mc!=null),Z=oe+ye,t(($e=Je.mc)!=null),t(Z<=$e.i),$e.C>=Z)Z=1;else if(Je.ic||Cs(),Je.ic){Je=$e.V,pt=$e.Ba,Gt=$e.c;var In=$e.i,sn=(tn=1,rt=$e.$/Gt,ft=$e.$%Gt,Bt=$e.m,pn=$e.s,$e.$),Dn=Gt*In,jn=Gt*Z,rr=pn.wc,Hn=sn<jn?We(pn,ft,rt):null;t(sn<=Dn),t(Z<=In),t(Et(pn));t:for(;;){for(;!Bt.h&&sn<jn;){if(ft&rr||(Hn=We(pn,ft,rt)),t(Hn!=null),dt(Bt),256>(In=Xe(Hn.G[0],Hn.H[0],Bt)))Je[pt+sn]=In,++sn,++ft>=Gt&&(ft=0,++rt<=Z&&!(rt%16)&&Yt($e,rt));else{if(!(280>In)){tn=0;break t}In=_e(In-256,Bt);var ei,Rr=Xe(Hn.G[4],Hn.H[4],Bt);if(dt(Bt),!(sn>=(Rr=Ie(Gt,Rr=_e(Rr,Bt)))&&Dn-sn>=In)){tn=0;break t}for(ei=0;ei<In;++ei)Je[pt+sn+ei]=Je[pt+sn+ei-Rr];for(sn+=In,ft+=In;ft>=Gt;)ft-=Gt,++rt<=Z&&!(rt%16)&&Yt($e,rt);sn<jn&&ft&rr&&(Hn=We(pn,ft,rt))}t(Bt.h==vt(Bt))}Yt($e,rt>Z?Z:rt);break t}!tn||Bt.h&&sn<Dn?(tn=0,$e.a=Bt.h?5:3):$e.$=sn,Z=tn}else Z=Vn($e,$e.V,$e.Ba,$e.c,$e.i,Z,pi);if(!Z){ye=0;break e}}oe+ye>=Be&&(U.Cc=1),ye=1}if(!ye)return null;if(U.Cc&&((ye=U.ga)!=null&&(ye.mc=null),U.ga=null,0<U.Ga))return alert("todo:WebPDequantizeLevels"),null}return U.nb+oe*Ne}function oa(U,Z,oe,ye,Ne,Be){for(;0<Ne--;){var $e,Je=U,rt=Z+(oe?1:0),ft=U,Bt=Z+(oe?0:3);for($e=0;$e<ye;++$e){var pn=ft[Bt+4*$e];pn!=255&&(pn*=32897,Je[rt+4*$e+0]=Je[rt+4*$e+0]*pn>>23,Je[rt+4*$e+1]=Je[rt+4*$e+1]*pn>>23,Je[rt+4*$e+2]=Je[rt+4*$e+2]*pn>>23)}Z+=Be}}function Aa(U,Z,oe,ye,Ne){for(;0<ye--;){var Be;for(Be=0;Be<oe;++Be){var $e=U[Z+2*Be+0],Je=15&(ft=U[Z+2*Be+1]),rt=4369*Je,ft=(240&ft|ft>>4)*rt>>16;U[Z+2*Be+0]=(240&$e|$e>>4)*rt>>16&240|(15&$e|$e<<4)*rt>>16>>4&15,U[Z+2*Be+1]=240&ft|Je}Z+=Ne}}function Oa(U,Z,oe,ye,Ne,Be,$e,Je){var rt,ft,Bt=255;for(ft=0;ft<Ne;++ft){for(rt=0;rt<ye;++rt){var pn=U[Z+rt];Be[$e+4*rt]=pn,Bt&=pn}Z+=oe,$e+=Je}return Bt!=255}function Bs(U,Z,oe,ye,Ne){var Be;for(Be=0;Be<Ne;++Be)oe[ye+Be]=U[Z+Be]>>8}function Cs(){zf=oa,sg=Aa,mc=Oa,ag=Bs}function dc(U,Z,oe){he[U]=function(ye,Ne,Be,$e,Je,rt,ft,Bt,pn,pt,Gt,tn,In,sn,Dn,jn,rr){var Hn,ei=rr-1>>1,Rr=Je[rt+0]|ft[Bt+0]<<16,Di=pn[pt+0]|Gt[tn+0]<<16;t(ye!=null);var ri=3*Rr+Di+131074>>2;for(Z(ye[Ne+0],255&ri,ri>>16,In,sn),Be!=null&&(ri=3*Di+Rr+131074>>2,Z(Be[$e+0],255&ri,ri>>16,Dn,jn)),Hn=1;Hn<=ei;++Hn){var ps=Je[rt+Hn]|ft[Bt+Hn]<<16,mo=pn[pt+Hn]|Gt[tn+Hn]<<16,Zi=Rr+ps+Di+mo+524296,ti=Zi+2*(ps+Di)>>3;ri=ti+Rr>>1,Rr=(Zi=Zi+2*(Rr+mo)>>3)+ps>>1,Z(ye[Ne+2*Hn-1],255&ri,ri>>16,In,sn+(2*Hn-1)*oe),Z(ye[Ne+2*Hn-0],255&Rr,Rr>>16,In,sn+(2*Hn-0)*oe),Be!=null&&(ri=Zi+Di>>1,Rr=ti+mo>>1,Z(Be[$e+2*Hn-1],255&ri,ri>>16,Dn,jn+(2*Hn-1)*oe),Z(Be[$e+2*Hn+0],255&Rr,Rr>>16,Dn,jn+(2*Hn+0)*oe)),Rr=ps,Di=mo}1&rr||(ri=3*Rr+Di+131074>>2,Z(ye[Ne+rr-1],255&ri,ri>>16,In,sn+(rr-1)*oe),Be!=null&&(ri=3*Di+Rr+131074>>2,Z(Be[$e+rr-1],255&ri,ri>>16,Dn,jn+(rr-1)*oe)))}}function Fh(){jc[gi]=Vx,jc[nh]=rh,jc[Fx]=$x,jc[My]=Uv,jc[$f]=Vv,jc[Rv]=qx,jc[Ls]=e2,jc[Ly]=rh,jc[og]=Uv,jc[Dy]=Vv,jc[jv]=qx}function zh(U){return U&~$v?0>U?0:255:U>>Oy}function Du(U,Z){return zh((19077*U>>8)+(26149*Z>>8)-14234)}function ru(U,Z,oe){return zh((19077*U>>8)-(6419*Z>>8)-(13320*oe>>8)+8708)}function hc(U,Z){return zh((19077*U>>8)+(33050*Z>>8)-17685)}function yd(U,Z,oe,ye,Ne){ye[Ne+0]=Du(U,oe),ye[Ne+1]=ru(U,Z,oe),ye[Ne+2]=hc(U,Z)}function eo(U,Z,oe,ye,Ne){ye[Ne+0]=hc(U,Z),ye[Ne+1]=ru(U,Z,oe),ye[Ne+2]=Du(U,oe)}function Ta(U,Z,oe,ye,Ne){var Be=ru(U,Z,oe);Z=Be<<3&224|hc(U,Z)>>3,ye[Ne+0]=248&Du(U,oe)|Be>>5,ye[Ne+1]=Z}function fo(U,Z,oe,ye,Ne){var Be=240&hc(U,Z)|15;ye[Ne+0]=240&Du(U,oe)|ru(U,Z,oe)>>4,ye[Ne+1]=Be}function Bh(U,Z,oe,ye,Ne){ye[Ne+0]=255,yd(U,Z,oe,ye,Ne+1)}function vd(U,Z,oe,ye,Ne){eo(U,Z,oe,ye,Ne),ye[Ne+3]=255}function Ca(U,Z,oe,ye,Ne){yd(U,Z,oe,ye,Ne),ye[Ne+3]=255}function bs(U,Z){return 0>U?0:U>Z?Z:U}function kr(U,Z,oe){he[U]=function(ye,Ne,Be,$e,Je,rt,ft,Bt,pn){for(var pt=Bt+(-2&pn)*oe;Bt!=pt;)Z(ye[Ne+0],Be[$e+0],Je[rt+0],ft,Bt),Z(ye[Ne+1],Be[$e+0],Je[rt+0],ft,Bt+oe),Ne+=2,++$e,++rt,Bt+=2*oe;1&pn&&Z(ye[Ne+0],Be[$e+0],Je[rt+0],ft,Bt)}}function Ln(U,Z,oe){return oe==0?U==0?Z==0?6:5:Z==0?4:0:oe}function Uh(U,Z,oe,ye,Ne){switch(U>>>30){case 3:pc(Z,oe,ye,Ne,0);break;case 2:Jo(Z,oe,ye,Ne);break;case 1:ia(Z,oe,ye,Ne)}}function sr(U,Z){var oe,ye,Ne=Z.M,Be=Z.Nb,$e=U.oc,Je=U.pc+40,rt=U.oc,ft=U.pc+584,Bt=U.oc,pn=U.pc+600;for(oe=0;16>oe;++oe)$e[Je+32*oe-1]=129;for(oe=0;8>oe;++oe)rt[ft+32*oe-1]=129,Bt[pn+32*oe-1]=129;for(0<Ne?$e[Je-1-32]=rt[ft-1-32]=Bt[pn-1-32]=129:(a($e,Je-32-1,127,21),a(rt,ft-32-1,127,9),a(Bt,pn-32-1,127,9)),ye=0;ye<U.za;++ye){var pt=Z.ya[Z.aa+ye];if(0<ye){for(oe=-1;16>oe;++oe)r($e,Je+32*oe-4,$e,Je+32*oe+12,4);for(oe=-1;8>oe;++oe)r(rt,ft+32*oe-4,rt,ft+32*oe+4,4),r(Bt,pn+32*oe-4,Bt,pn+32*oe+4,4)}var Gt=U.Gd,tn=U.Hd+ye,In=pt.ad,sn=pt.Hc;if(0<Ne&&(r($e,Je-32,Gt[tn].y,0,16),r(rt,ft-32,Gt[tn].f,0,8),r(Bt,pn-32,Gt[tn].ea,0,8)),pt.Za){var Dn=$e,jn=Je-32+16;for(0<Ne&&(ye>=U.za-1?a(Dn,jn,Gt[tn].y[15],4):r(Dn,jn,Gt[tn+1].y,0,4)),oe=0;4>oe;oe++)Dn[jn+128+oe]=Dn[jn+256+oe]=Dn[jn+384+oe]=Dn[jn+0+oe];for(oe=0;16>oe;++oe,sn<<=2)Dn=$e,jn=Je+hg[oe],gc[pt.Ob[oe]](Dn,jn),Uh(sn,In,16*+oe,Dn,jn)}else if(Dn=Ln(ye,Ne,pt.Ob[0]),Rc[Dn]($e,Je),sn!=0)for(oe=0;16>oe;++oe,sn<<=2)Uh(sn,In,16*+oe,$e,Je+hg[oe]);for(oe=pt.Gc,Dn=Ln(ye,Ne,pt.Dd),iu[Dn](rt,ft),iu[Dn](Bt,pn),sn=In,Dn=rt,jn=ft,255&(pt=0|oe)&&(170&pt?Ad(sn,256,Dn,jn):sa(sn,256,Dn,jn)),pt=Bt,sn=pn,255&(oe>>=8)&&(170&oe?Ad(In,320,pt,sn):sa(In,320,pt,sn)),Ne<U.Ub-1&&(r(Gt[tn].y,0,$e,Je+480,16),r(Gt[tn].f,0,rt,ft+224,8),r(Gt[tn].ea,0,Bt,pn+224,8)),oe=8*Be*U.B,Gt=U.sa,tn=U.ta+16*ye+16*Be*U.R,In=U.qa,pt=U.ra+8*ye+oe,sn=U.Ha,Dn=U.Ia+8*ye+oe,oe=0;16>oe;++oe)r(Gt,tn+oe*U.R,$e,Je+32*oe,16);for(oe=0;8>oe;++oe)r(In,pt+oe*U.B,rt,ft+32*oe,8),r(sn,Dn+oe*U.B,Bt,pn+32*oe,8)}}function Nc(U,Z,oe,ye,Ne,Be,$e,Je,rt){var ft=[0],Bt=[0],pn=0,pt=rt!=null?rt.kd:0,Gt=rt??new kn;if(U==null||12>oe)return 7;Gt.data=U,Gt.w=Z,Gt.ha=oe,Z=[Z],oe=[oe],Gt.gb=[Gt.gb];e:{var tn=Z,In=oe,sn=Gt.gb;if(t(U!=null),t(In!=null),t(sn!=null),sn[0]=0,12<=In[0]&&!n(U,tn[0],"RIFF")){if(n(U,tn[0]+8,"WEBP")){sn=3;break e}var Dn=Kt(U,tn[0]+4);if(12>Dn||4294967286<Dn){sn=3;break e}if(pt&&Dn>In[0]-8){sn=7;break e}sn[0]=Dn,tn[0]+=12,In[0]-=12}sn=0}if(sn!=0)return sn;for(Dn=0<Gt.gb[0],oe=oe[0];;){e:{var jn=U;In=Z,sn=oe;var rr=ft,Hn=Bt,ei=tn=[0];if((ri=pn=[pn])[0]=0,8>sn[0])sn=7;else{if(!n(jn,In[0],"VP8X")){if(Kt(jn,In[0]+4)!=10){sn=3;break e}if(18>sn[0]){sn=7;break e}var Rr=Kt(jn,In[0]+8),Di=1+Un(jn,In[0]+12);if(2147483648<=Di*(jn=1+Un(jn,In[0]+15))){sn=3;break e}ei!=null&&(ei[0]=Rr),rr!=null&&(rr[0]=Di),Hn!=null&&(Hn[0]=jn),In[0]+=18,sn[0]-=18,ri[0]=1}sn=0}}if(pn=pn[0],tn=tn[0],sn!=0)return sn;if(In=!!(2&tn),!Dn&&pn)return 3;if(Be!=null&&(Be[0]=!!(16&tn)),$e!=null&&($e[0]=In),Je!=null&&(Je[0]=0),$e=ft[0],tn=Bt[0],pn&&In&&rt==null){sn=0;break}if(4>oe){sn=7;break}if(Dn&&pn||!Dn&&!pn&&!n(U,Z[0],"ALPH")){oe=[oe],Gt.na=[Gt.na],Gt.P=[Gt.P],Gt.Sa=[Gt.Sa];e:{Rr=U,sn=Z,Dn=oe;var ri=Gt.gb;rr=Gt.na,Hn=Gt.P,ei=Gt.Sa,Di=22,t(Rr!=null),t(Dn!=null),jn=sn[0];var ps=Dn[0];for(t(rr!=null),t(ei!=null),rr[0]=null,Hn[0]=null,ei[0]=0;;){if(sn[0]=jn,Dn[0]=ps,8>ps){sn=7;break e}var mo=Kt(Rr,jn+4);if(4294967286<mo){sn=3;break e}var Zi=8+mo+1&-2;if(Di+=Zi,0<ri&&Di>ri){sn=3;break e}if(!n(Rr,jn,"VP8 ")||!n(Rr,jn,"VP8L")){sn=0;break e}if(ps[0]<Zi){sn=7;break e}n(Rr,jn,"ALPH")||(rr[0]=Rr,Hn[0]=jn+8,ei[0]=mo),jn+=Zi,ps-=Zi}}if(oe=oe[0],Gt.na=Gt.na[0],Gt.P=Gt.P[0],Gt.Sa=Gt.Sa[0],sn!=0)break}oe=[oe],Gt.Ja=[Gt.Ja],Gt.xa=[Gt.xa];e:if(ri=U,sn=Z,Dn=oe,rr=Gt.gb[0],Hn=Gt.Ja,ei=Gt.xa,Rr=sn[0],jn=!n(ri,Rr,"VP8 "),Di=!n(ri,Rr,"VP8L"),t(ri!=null),t(Dn!=null),t(Hn!=null),t(ei!=null),8>Dn[0])sn=7;else{if(jn||Di){if(ri=Kt(ri,Rr+4),12<=rr&&ri>rr-12){sn=3;break e}if(pt&&ri>Dn[0]-8){sn=7;break e}Hn[0]=ri,sn[0]+=8,Dn[0]-=8,ei[0]=Di}else ei[0]=5<=Dn[0]&&ri[Rr+0]==47&&!(ri[Rr+4]>>5),Hn[0]=Dn[0];sn=0}if(oe=oe[0],Gt.Ja=Gt.Ja[0],Gt.xa=Gt.xa[0],Z=Z[0],sn!=0)break;if(4294967286<Gt.Ja)return 3;if(Je==null||In||(Je[0]=Gt.xa?2:1),$e=[$e],tn=[tn],Gt.xa){if(5>oe){sn=7;break}Je=$e,pt=tn,In=Be,U==null||5>oe?U=0:5<=oe&&U[Z+0]==47&&!(U[Z+4]>>5)?(Dn=[0],ri=[0],rr=[0],De(Hn=new Ye,U,Z,oe),de(Hn,Dn,ri,rr)?(Je!=null&&(Je[0]=Dn[0]),pt!=null&&(pt[0]=ri[0]),In!=null&&(In[0]=rr[0]),U=1):U=0):U=0}else{if(10>oe){sn=7;break}Je=tn,U==null||10>oe||!Qm(U,Z+3,oe-3)?U=0:(pt=U[Z+0]|U[Z+1]<<8|U[Z+2]<<16,In=16383&(U[Z+7]<<8|U[Z+6]),U=16383&(U[Z+9]<<8|U[Z+8]),1&pt||3<(pt>>1&7)||!(pt>>4&1)||pt>>5>=Gt.Ja||!In||!U?U=0:($e&&($e[0]=In),Je&&(Je[0]=U),U=1))}if(!U||($e=$e[0],tn=tn[0],pn&&(ft[0]!=$e||Bt[0]!=tn)))return 3;rt!=null&&(rt[0]=Gt,rt.offset=Z-rt.w,t(4294967286>Z-rt.w),t(rt.offset==rt.ha-oe));break}return sn==0||sn==7&&pn&&rt==null?(Be!=null&&(Be[0]|=Gt.na!=null&&0<Gt.na.length),ye!=null&&(ye[0]=$e),Ne!=null&&(Ne[0]=tn),0):sn}function _d(U,Z,oe){var ye=Z.width,Ne=Z.height,Be=0,$e=0,Je=ye,rt=Ne;if(Z.Da=U!=null&&0<U.Da,Z.Da&&(Je=U.cd,rt=U.bd,Be=U.v,$e=U.j,11>oe||(Be&=-2,$e&=-2),0>Be||0>$e||0>=Je||0>=rt||Be+Je>ye||$e+rt>Ne))return 0;if(Z.v=Be,Z.j=$e,Z.va=Be+Je,Z.o=$e+rt,Z.U=Je,Z.T=rt,Z.da=U!=null&&0<U.da,Z.da){if(!Br(Je,rt,oe=[U.ib],Be=[U.hb]))return 0;Z.ib=oe[0],Z.hb=Be[0]}return Z.ob=U!=null&&U.ob,Z.Kb=U==null||!U.Sd,Z.da&&(Z.ob=Z.ib<3*ye/4&&Z.hb<3*Ne/4,Z.Kb=0),1}function hr(U){if(U==null)return 2;if(11>U.S){var Z=U.f.RGBA;Z.fb+=(U.height-1)*Z.A,Z.A=-Z.A}else Z=U.f.kb,U=U.height,Z.O+=(U-1)*Z.fa,Z.fa=-Z.fa,Z.N+=(U-1>>1)*Z.Ab,Z.Ab=-Z.Ab,Z.W+=(U-1>>1)*Z.Db,Z.Db=-Z.Db,Z.F!=null&&(Z.J+=(U-1)*Z.lb,Z.lb=-Z.lb);return 0}function xd(U,Z,oe,ye){if(ye==null||0>=U||0>=Z)return 2;if(oe!=null){if(oe.Da){var Ne=oe.cd,Be=oe.bd,$e=-2&oe.v,Je=-2&oe.j;if(0>$e||0>Je||0>=Ne||0>=Be||$e+Ne>U||Je+Be>Z)return 2;U=Ne,Z=Be}if(oe.da){if(!Br(U,Z,Ne=[oe.ib],Be=[oe.hb]))return 2;U=Ne[0],Z=Be[0]}}ye.width=U,ye.height=Z;e:{var rt=ye.width,ft=ye.height;if(U=ye.S,0>=rt||0>=ft||!(U>=gi&&13>U))U=2;else{if(0>=ye.Rd&&ye.sd==null){$e=Be=Ne=Z=0;var Bt=(Je=rt*Kp[U])*ft;if(11>U||(Be=(ft+1)/2*(Z=(rt+1)/2),U==12&&($e=(Ne=rt)*ft)),(ft=l(Bt+2*Be+$e))==null){U=1;break e}ye.sd=ft,11>U?((rt=ye.f.RGBA).eb=ft,rt.fb=0,rt.A=Je,rt.size=Bt):((rt=ye.f.kb).y=ft,rt.O=0,rt.fa=Je,rt.Fd=Bt,rt.f=ft,rt.N=0+Bt,rt.Ab=Z,rt.Cd=Be,rt.ea=ft,rt.W=0+Bt+Be,rt.Db=Z,rt.Ed=Be,U==12&&(rt.F=ft,rt.J=0+Bt+2*Be),rt.Tc=$e,rt.lb=Ne)}if(Z=1,Ne=ye.S,Be=ye.width,$e=ye.height,Ne>=gi&&13>Ne)if(11>Ne)U=ye.f.RGBA,Z&=(Je=Math.abs(U.A))*($e-1)+Be<=U.size,Z&=Je>=Be*Kp[Ne],Z&=U.eb!=null;else{U=ye.f.kb,Je=(Be+1)/2,Bt=($e+1)/2,rt=Math.abs(U.fa),ft=Math.abs(U.Ab);var pn=Math.abs(U.Db),pt=Math.abs(U.lb),Gt=pt*($e-1)+Be;Z&=rt*($e-1)+Be<=U.Fd,Z&=ft*(Bt-1)+Je<=U.Cd,Z=(Z&=pn*(Bt-1)+Je<=U.Ed)&rt>=Be&ft>=Je&pn>=Je,Z&=U.y!=null,Z&=U.f!=null,Z&=U.ea!=null,Ne==12&&(Z&=pt>=Be,Z&=Gt<=U.Tc,Z&=U.F!=null)}else Z=0;U=Z?0:2}}return U!=0||oe!=null&&oe.fd&&(U=hr(ye)),U}var Ru=64,dl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ql=24,ju=32,Ms=8,bd=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];wt("Predictor0","PredictorAdd0"),he.Predictor0=function(){return 4278190080},he.Predictor1=function(U){return U},he.Predictor2=function(U,Z,oe){return Z[oe+0]},he.Predictor3=function(U,Z,oe){return Z[oe+1]},he.Predictor4=function(U,Z,oe){return Z[oe-1]},he.Predictor5=function(U,Z,oe){return xn(xn(U,Z[oe+1]),Z[oe+0])},he.Predictor6=function(U,Z,oe){return xn(U,Z[oe-1])},he.Predictor7=function(U,Z,oe){return xn(U,Z[oe+0])},he.Predictor8=function(U,Z,oe){return xn(Z[oe-1],Z[oe+0])},he.Predictor9=function(U,Z,oe){return xn(Z[oe+0],Z[oe+1])},he.Predictor10=function(U,Z,oe){return xn(xn(U,Z[oe-1]),xn(Z[oe+0],Z[oe+1]))},he.Predictor11=function(U,Z,oe){var ye=Z[oe+0];return 0>=Mn(ye>>24&255,U>>24&255,(Z=Z[oe-1])>>24&255)+Mn(ye>>16&255,U>>16&255,Z>>16&255)+Mn(ye>>8&255,U>>8&255,Z>>8&255)+Mn(255&ye,255&U,255&Z)?ye:U},he.Predictor12=function(U,Z,oe){var ye=Z[oe+0];return(Rn((U>>24&255)+(ye>>24&255)-((Z=Z[oe-1])>>24&255))<<24|Rn((U>>16&255)+(ye>>16&255)-(Z>>16&255))<<16|Rn((U>>8&255)+(ye>>8&255)-(Z>>8&255))<<8|Rn((255&U)+(255&ye)-(255&Z)))>>>0},he.Predictor13=function(U,Z,oe){var ye=Z[oe-1];return(Sn((U=xn(U,Z[oe+0]))>>24&255,ye>>24&255)<<24|Sn(U>>16&255,ye>>16&255)<<16|Sn(U>>8&255,ye>>8&255)<<8|Sn(255&U,255&ye))>>>0};var Mc=he.PredictorAdd0;he.PredictorAdd1=Ar,wt("Predictor2","PredictorAdd2"),wt("Predictor3","PredictorAdd3"),wt("Predictor4","PredictorAdd4"),wt("Predictor5","PredictorAdd5"),wt("Predictor6","PredictorAdd6"),wt("Predictor7","PredictorAdd7"),wt("Predictor8","PredictorAdd8"),wt("Predictor9","PredictorAdd9"),wt("Predictor10","PredictorAdd10"),wt("Predictor11","PredictorAdd11"),wt("Predictor12","PredictorAdd12"),wt("Predictor13","PredictorAdd13");var po=he.PredictorAdd2;dr("ColorIndexInverseTransform","MapARGB","32b",function(U){return U>>8&255},function(U){return U}),dr("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(U){return U},function(U){return U>>8&255});var fa,to=he.ColorIndexInverseTransform,Ou=he.MapARGB,fc=he.VP8LColorIndexInverseTransformAlpha,rg=he.MapAlpha,Vh=he.VP8LPredictorsAdd=[];Vh.length=16,(he.VP8LPredictors=[]).length=16,(he.VP8LPredictorsAdd_C=[]).length=16,(he.VP8LPredictors_C=[]).length=16;var wd,Gl,$h,Lc,th,Sd,Fu,pc,Jo,Ad,ia,sa,no,ro,ko,Up,jf,ig,qh,Vp,ky,Iy,Of,Ff,zf,sg,mc,ag,yn=l(511),Ny=l(2041),Bf=l(225),Uf=l(767),$p=0,Vf=Ny,Dc=Bf,kl=Uf,Ga=yn,gi=0,nh=1,Fx=2,My=3,$f=4,Rv=5,Ls=6,Ly=7,og=8,Dy=9,jv=10,Yw=[2,3,7],Xw=[3,3,11],Ov=[280,256,256,256,40],Jw=[0,1,1,1,0],Ry=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Qw=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],zx=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Fv=8,qp=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],lg=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],zu=null,Gp=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],jy=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],cg=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Hp=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Bx=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],zv=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Ux=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Rc=[],gc=[],iu=[],Bv=1,ug=2,su=[],jc=[];dc("UpsampleRgbLinePair",yd,3),dc("UpsampleBgrLinePair",eo,3),dc("UpsampleRgbaLinePair",Ca,4),dc("UpsampleBgraLinePair",vd,4),dc("UpsampleArgbLinePair",Bh,4),dc("UpsampleRgba4444LinePair",fo,2),dc("UpsampleRgb565LinePair",Ta,2);var Vx=he.UpsampleRgbLinePair,$x=he.UpsampleBgrLinePair,rh=he.UpsampleRgbaLinePair,Uv=he.UpsampleBgraLinePair,Vv=he.UpsampleArgbLinePair,qx=he.UpsampleRgba4444LinePair,e2=he.UpsampleRgb565LinePair,Wp=16,qf=1<<Wp-1,Gh=-227,Td=482,Oy=6,$v=(256<<Oy)-1,Gx=0,Gf=l(256),Hf=l(256),Hx=l(256),Oc=l(256),Fy=l(Td-Gh),dg=l(Td-Gh);kr("YuvToRgbRow",yd,3),kr("YuvToBgrRow",eo,3),kr("YuvToRgbaRow",Ca,4),kr("YuvToBgraRow",vd,4),kr("YuvToArgbRow",Bh,4),kr("YuvToRgba4444Row",fo,2),kr("YuvToRgb565Row",Ta,2);var hg=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Zp=[0,2,8],qv=[8,7,6,4,4,2,2,2,1,1,1,1],zy=1;this.WebPDecodeRGBA=function(U,Z,oe,ye,Ne){var Be=nh,$e=new Zt,Je=new ts;$e.ba=Je,Je.S=Be,Je.width=[Je.width],Je.height=[Je.height];var rt=Je.width,ft=Je.height,Bt=new _i;if(Bt==null||U==null)var pn=2;else t(Bt!=null),pn=Nc(U,Z,oe,Bt.width,Bt.height,Bt.Pd,Bt.Qd,Bt.format,null);if(pn!=0?rt=0:(rt!=null&&(rt[0]=Bt.width[0]),ft!=null&&(ft[0]=Bt.height[0]),rt=1),rt){Je.width=Je.width[0],Je.height=Je.height[0],ye!=null&&(ye[0]=Je.width),Ne!=null&&(Ne[0]=Je.height);e:{if(ye=new ac,(Ne=new kn).data=U,Ne.w=Z,Ne.ha=oe,Ne.kd=1,Z=[0],t(Ne!=null),((U=Nc(Ne.data,Ne.w,Ne.ha,null,null,null,Z,null,Ne))==0||U==7)&&Z[0]&&(U=4),(Z=U)==0){if(t($e!=null),ye.data=Ne.data,ye.w=Ne.w+Ne.offset,ye.ha=Ne.ha-Ne.offset,ye.put=qr,ye.ac=ja,ye.bc=lt,ye.ma=$e,Ne.xa){if((U=vr())==null){$e=1;break e}if(function(pt,Gt){var tn=[0],In=[0],sn=[0];t:for(;;){if(pt==null)return 0;if(Gt==null)return pt.a=2,0;if(pt.l=Gt,pt.a=0,De(pt.m,Gt.data,Gt.w,Gt.ha),!de(pt.m,tn,In,sn)){pt.a=3;break t}if(pt.xb=ug,Gt.width=tn[0],Gt.height=In[0],!Gr(tn[0],In[0],1,pt,null))break t;return 1}return t(pt.a!=0),0}(U,ye)){if(ye=(Z=xd(ye.width,ye.height,$e.Oa,$e.ba))==0){t:{ye=U;n:for(;;){if(ye==null){ye=0;break t}if(t(ye.s.yc!=null),t(ye.s.Ya!=null),t(0<ye.s.Wb),t((oe=ye.l)!=null),t((Ne=oe.ma)!=null),ye.xb!=0){if(ye.ca=Ne.ba,ye.tb=Ne.tb,t(ye.ca!=null),!_d(Ne.Oa,oe,My)){ye.a=2;break n}if(!Fr(ye,oe.width)||oe.da)break n;if((oe.da||Ur(ye.ca.S))&&Cs(),11>ye.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ye.ca.f.kb.F!=null&&Cs()),ye.Pb&&0<ye.s.ua&&ye.s.vb.X==null&&!st(ye.s.vb,ye.s.Wa.Xa)){ye.a=1;break n}ye.xb=0}if(!Vn(ye,ye.V,ye.Ba,ye.c,ye.i,oe.o,ot))break n;Ne.Dc=ye.Ma,ye=1;break t}t(ye.a!=0),ye=0}ye=!ye}ye&&(Z=U.a)}else Z=U.a}else{if((U=new $o)==null){$e=1;break e}if(U.Fa=Ne.na,U.P=Ne.P,U.qc=Ne.Sa,ku(U,ye)){if((Z=xd(ye.width,ye.height,$e.Oa,$e.ba))==0){if(U.Aa=0,oe=$e.Oa,t((Ne=U)!=null),oe!=null){if(0<(rt=0>(rt=oe.Md)?0:100<rt?255:255*rt/100)){for(ft=Bt=0;4>ft;++ft)12>(pn=Ne.pb[ft]).lc&&(pn.ia=rt*qv[0>pn.lc?0:pn.lc]>>3),Bt|=pn.ia;Bt&&(alert("todo:VP8InitRandom"),Ne.ia=1)}Ne.Ga=oe.Id,100<Ne.Ga?Ne.Ga=100:0>Ne.Ga&&(Ne.Ga=0)}(function(pt,Gt){if(pt==null)return 0;if(Gt==null)return Pa(pt,2,"NULL VP8Io parameter in VP8Decode().");if(!pt.cb&&!ku(pt,Gt))return 0;if(t(pt.cb),Gt.ac==null||Gt.ac(Gt)){Gt.ob&&(pt.L=0);var tn=Zp[pt.L];if(pt.L==2?(pt.yb=0,pt.zb=0):(pt.yb=Gt.v-tn>>4,pt.zb=Gt.j-tn>>4,0>pt.yb&&(pt.yb=0),0>pt.zb&&(pt.zb=0)),pt.Va=Gt.o+15+tn>>4,pt.Hb=Gt.va+15+tn>>4,pt.Hb>pt.za&&(pt.Hb=pt.za),pt.Va>pt.Ub&&(pt.Va=pt.Ub),0<pt.L){var In=pt.ed;for(tn=0;4>tn;++tn){var sn;if(pt.Qa.Cb){var Dn=pt.Qa.Lb[tn];pt.Qa.Fb||(Dn+=In.Tb)}else Dn=In.Tb;for(sn=0;1>=sn;++sn){var jn=pt.gd[tn][sn],rr=Dn;if(In.Pc&&(rr+=In.vd[0],sn&&(rr+=In.od[0])),0<(rr=0>rr?0:63<rr?63:rr)){var Hn=rr;0<In.wb&&(Hn=4<In.wb?Hn>>2:Hn>>1)>9-In.wb&&(Hn=9-In.wb),1>Hn&&(Hn=1),jn.dd=Hn,jn.tc=2*rr+Hn,jn.ld=40<=rr?2:15<=rr?1:0}else jn.tc=0;jn.La=sn}}}tn=0}else Pa(pt,6,"Frame setup failed"),tn=pt.a;if(tn=tn==0){if(tn){pt.$c=0,0<pt.Aa||(pt.Ic=zy);t:{tn=pt.Ic,In=4*(Hn=pt.za);var ei=32*Hn,Rr=Hn+1,Di=0<pt.L?Hn*(0<pt.Aa?2:1):0,ri=(pt.Aa==2?2:1)*Hn;if((jn=In+832+(sn=3*(16*tn+Zp[pt.L])/2*ei)+(Dn=pt.Fa!=null&&0<pt.Fa.length?pt.Kc.c*pt.Kc.i:0))!=jn)tn=0;else{if(jn>pt.Vb){if(pt.Vb=0,pt.Ec=l(jn),pt.Fc=0,pt.Ec==null){tn=Pa(pt,1,"no memory during frame initialization.");break t}pt.Vb=jn}jn=pt.Ec,rr=pt.Fc,pt.Ac=jn,pt.Bc=rr,rr+=In,pt.Gd=h(ei,Vo),pt.Hd=0,pt.rb=h(Rr+1,Ns),pt.sb=1,pt.wa=Di?h(Di,bi):null,pt.Y=0,pt.D.Nb=0,pt.D.wa=pt.wa,pt.D.Y=pt.Y,0<pt.Aa&&(pt.D.Y+=Hn),t(!0),pt.oc=jn,pt.pc=rr,rr+=832,pt.ya=h(ri,as),pt.aa=0,pt.D.ya=pt.ya,pt.D.aa=pt.aa,pt.Aa==2&&(pt.D.aa+=Hn),pt.R=16*Hn,pt.B=8*Hn,Hn=(ei=Zp[pt.L])*pt.R,ei=ei/2*pt.B,pt.sa=jn,pt.ta=rr+Hn,pt.qa=pt.sa,pt.ra=pt.ta+16*tn*pt.R+ei,pt.Ha=pt.qa,pt.Ia=pt.ra+8*tn*pt.B+ei,pt.$c=0,rr+=sn,pt.mb=Dn?jn:null,pt.nb=Dn?rr:null,t(rr+Dn<=pt.Fc+pt.Vb),Iu(pt),a(pt.Ac,pt.Bc,0,In),tn=1}}if(tn){if(Gt.ka=0,Gt.y=pt.sa,Gt.O=pt.ta,Gt.f=pt.qa,Gt.N=pt.ra,Gt.ea=pt.Ha,Gt.Vd=pt.Ia,Gt.fa=pt.R,Gt.Rc=pt.B,Gt.F=null,Gt.J=0,!$p){for(tn=-255;255>=tn;++tn)yn[255+tn]=0>tn?-tn:tn;for(tn=-1020;1020>=tn;++tn)Ny[1020+tn]=-128>tn?-128:127<tn?127:tn;for(tn=-112;112>=tn;++tn)Bf[112+tn]=-16>tn?-16:15<tn?15:tn;for(tn=-255;510>=tn;++tn)Uf[255+tn]=0>tn?0:255<tn?255:tn;$p=1}Fu=Xc,pc=eg,Ad=Rp,ia=Qa,sa=cc,Jo=Yc,no=Rf,ro=zp,ko=re,Up=Pe,jf=Ii,ig=Bp,qh=qe,Vp=Rt,ky=eh,Iy=md,Of=Pl,Ff=gd,gc[0]=ng,gc[1]=Po,gc[2]=jh,gc[3]=jp,gc[4]=Op,gc[5]=uc,gc[6]=mi,gc[7]=Cy,gc[8]=Xd,gc[9]=Ey,Rc[0]=Qc,Rc[1]=tg,Rc[2]=Lf,Rc[3]=Jc,Rc[4]=Rh,Rc[5]=qo,Rc[6]=Df,iu[0]=Jd,iu[1]=Yd,iu[2]=eu,iu[3]=tu,iu[4]=Mu,iu[5]=Py,iu[6]=Fp,tn=1}else tn=0}tn&&(tn=function(ps,mo){for(ps.M=0;ps.M<ps.Va;++ps.M){var Zi,ti=ps.Jc[ps.M&ps.Xb],_r=ps.m,Ha=ps;for(Zi=0;Zi<Ha.za;++Zi){var Fi=_r,ds=Ha,Ia=ds.Ac,Fa=ds.Bc+4*Zi,Il=ds.zc,io=ds.ya[ds.aa+Zi];if(ds.Qa.Bb?io.$b=Pt(Fi,ds.Pa.jb[0])?2+Pt(Fi,ds.Pa.jb[2]):Pt(Fi,ds.Pa.jb[1]):io.$b=0,ds.kc&&(io.Ad=Pt(Fi,ds.Bd)),io.Za=!Pt(Fi,145)+0,io.Za){var Go=io.Ob,hl=0;for(ds=0;4>ds;++ds){var pa,ms=Il[0+ds];for(pa=0;4>pa;++pa){ms=Bx[Ia[Fa+pa]][ms];for(var ws=cg[Pt(Fi,ms[0])];0<ws;)ws=cg[2*ws+Pt(Fi,ms[ws])];ms=-ws,Ia[Fa+pa]=ms}r(Go,hl,Ia,Fa,4),hl+=4,Il[0+ds]=ms}}else ms=Pt(Fi,156)?Pt(Fi,128)?1:3:Pt(Fi,163)?2:0,io.Ob[0]=ms,a(Ia,Fa,ms,4),a(Il,0,ms,4);io.Dd=Pt(Fi,142)?Pt(Fi,114)?Pt(Fi,183)?1:3:2:0}if(Ha.m.Ka)return Pa(ps,7,"Premature end-of-partition0 encountered.");for(;ps.ja<ps.za;++ps.ja){if(Ha=ti,Fi=(_r=ps).rb[_r.sb-1],Ia=_r.rb[_r.sb+_r.ja],Zi=_r.ya[_r.aa+_r.ja],Fa=_r.kc?Zi.Ad:0)Fi.la=Ia.la=0,Zi.Za||(Fi.Na=Ia.Na=0),Zi.Hc=0,Zi.Gc=0,Zi.ia=0;else{var za,Ws;if(Fi=Ia,Ia=Ha,Fa=_r.Pa.Xc,Il=_r.ya[_r.aa+_r.ja],io=_r.pb[Il.$b],ds=Il.ad,Go=0,hl=_r.rb[_r.sb-1],ms=pa=0,a(ds,Go,0,384),Il.Za)var Io=0,Hl=Fa[3];else{ws=l(16);var Ba=Fi.Na+hl.Na;if(Ba=zu(Ia,Fa[1],Ba,io.Eb,0,ws,0),Fi.Na=hl.Na=(0<Ba)+0,1<Ba)Fu(ws,0,ds,Go);else{var Wl=ws[0]+3>>3;for(ws=0;256>ws;ws+=16)ds[Go+ws]=Wl}Io=1,Hl=Fa[0]}var Us=15&Fi.la,Ua=15&hl.la;for(ws=0;4>ws;++ws){var Pn=1&Ua;for(Wl=Ws=0;4>Wl;++Wl)Us=Us>>1|(Pn=(Ba=zu(Ia,Hl,Ba=Pn+(1&Us),io.Sc,Io,ds,Go))>Io)<<7,Ws=Ws<<2|(3<Ba?3:1<Ba?2:ds[Go+0]!=0),Go+=16;Us>>=4,Ua=Ua>>1|Pn<<7,pa=(pa<<8|Ws)>>>0}for(Hl=Us,Io=Ua>>4,za=0;4>za;za+=2){for(Ws=0,Us=Fi.la>>4+za,Ua=hl.la>>4+za,ws=0;2>ws;++ws){for(Pn=1&Ua,Wl=0;2>Wl;++Wl)Ba=Pn+(1&Us),Us=Us>>1|(Pn=0<(Ba=zu(Ia,Fa[2],Ba,io.Qc,0,ds,Go)))<<3,Ws=Ws<<2|(3<Ba?3:1<Ba?2:ds[Go+0]!=0),Go+=16;Us>>=2,Ua=Ua>>1|Pn<<5}ms|=Ws<<4*za,Hl|=Us<<4<<za,Io|=(240&Ua)<<za}Fi.la=Hl,hl.la=Io,Il.Hc=pa,Il.Gc=ms,Il.ia=43690&ms?0:io.ia,Fa=!(pa|ms)}if(0<_r.L&&(_r.wa[_r.Y+_r.ja]=_r.gd[Zi.$b][Zi.Za],_r.wa[_r.Y+_r.ja].La|=!Fa),Ha.Ka)return Pa(ps,7,"Premature end-of-file encountered.")}if(Iu(ps),_r=mo,Ha=1,Zi=(ti=ps).D,Fi=0<ti.L&&ti.M>=ti.zb&&ti.M<=ti.Va,ti.Aa==0)t:{if(Zi.M=ti.M,Zi.uc=Fi,sr(ti,Zi),Ha=1,Zi=(Ws=ti.D).Nb,Fi=(ms=Zp[ti.L])*ti.R,Ia=ms/2*ti.B,ws=16*Zi*ti.R,Wl=8*Zi*ti.B,Fa=ti.sa,Il=ti.ta-Fi+ws,io=ti.qa,ds=ti.ra-Ia+Wl,Go=ti.Ha,hl=ti.Ia-Ia+Wl,Ua=(Us=Ws.M)==0,pa=Us>=ti.Va-1,ti.Aa==2&&sr(ti,Ws),Ws.uc)for(Pn=(Ba=ti).D.M,t(Ba.D.uc),Ws=Ba.yb;Ws<Ba.Hb;++Ws){Io=Ws,Hl=Pn;var fl=(go=(pl=Ba).D).Nb;za=pl.R;var go=go.wa[go.Y+Io],No=pl.sa,yo=pl.ta+16*fl*za+16*Io,nr=go.dd,ma=go.tc;if(ma!=0)if(t(3<=ma),pl.L==1)0<Io&&Iy(No,yo,za,ma+4),go.La&&Ff(No,yo,za,ma),0<Hl&&ky(No,yo,za,ma+4),go.La&&Of(No,yo,za,ma);else{var yc=pl.B,vc=pl.qa,Cd=pl.ra+8*fl*yc+8*Io,au=pl.Ha,pl=pl.Ia+8*fl*yc+8*Io;fl=go.ld,0<Io&&(ro(No,yo,za,ma+4,nr,fl),Up(vc,Cd,au,pl,yc,ma+4,nr,fl)),go.La&&(ig(No,yo,za,ma,nr,fl),Vp(vc,Cd,au,pl,yc,ma,nr,fl)),0<Hl&&(no(No,yo,za,ma+4,nr,fl),ko(vc,Cd,au,pl,yc,ma+4,nr,fl)),go.La&&(jf(No,yo,za,ma,nr,fl),qh(vc,Cd,au,pl,yc,ma,nr,fl))}}if(ti.ia&&alert("todo:DitherRow"),_r.put!=null){if(Ws=16*Us,Us=16*(Us+1),Ua?(_r.y=ti.sa,_r.O=ti.ta+ws,_r.f=ti.qa,_r.N=ti.ra+Wl,_r.ea=ti.Ha,_r.W=ti.Ia+Wl):(Ws-=ms,_r.y=Fa,_r.O=Il,_r.f=io,_r.N=ds,_r.ea=Go,_r.W=hl),pa||(Us-=ms),Us>_r.o&&(Us=_r.o),_r.F=null,_r.J=null,ti.Fa!=null&&0<ti.Fa.length&&Ws<Us&&(_r.J=Hr(ti,_r,Ws,Us-Ws),_r.F=ti.mb,_r.F==null&&_r.F.length==0)){Ha=Pa(ti,3,"Could not decode alpha data.");break t}Ws<_r.j&&(ms=_r.j-Ws,Ws=_r.j,t(!(1&ms)),_r.O+=ti.R*ms,_r.N+=ti.B*(ms>>1),_r.W+=ti.B*(ms>>1),_r.F!=null&&(_r.J+=_r.width*ms)),Ws<Us&&(_r.O+=_r.v,_r.N+=_r.v>>1,_r.W+=_r.v>>1,_r.F!=null&&(_r.J+=_r.v),_r.ka=Ws-_r.j,_r.U=_r.va-_r.v,_r.T=Us-Ws,Ha=_r.put(_r))}Zi+1!=ti.Ic||pa||(r(ti.sa,ti.ta-Fi,Fa,Il+16*ti.R,Fi),r(ti.qa,ti.ra-Ia,io,ds+8*ti.B,Ia),r(ti.Ha,ti.Ia-Ia,Go,hl+8*ti.B,Ia))}if(!Ha)return Pa(ps,6,"Output aborted.")}return 1}(pt,Gt)),Gt.bc!=null&&Gt.bc(Gt),tn&=1}return tn?(pt.cb=0,tn):0})(U,ye)||(Z=U.a)}}else Z=U.a}Z==0&&$e.Oa!=null&&$e.Oa.fd&&(Z=hr($e.ba))}$e=Z}Be=$e!=0?null:11>Be?Je.f.RGBA.eb:Je.f.kb.y}else Be=null;return Be};var Kp=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function x(he,we){for(var fe="",ge=0;ge<4;ge++)fe+=String.fromCharCode(he[we++]);return fe}function w(he,we){return he[we+0]|he[we+1]<<8}function C(he,we){return(he[we+0]|he[we+1]<<8|he[we+2]<<16)>>>0}function P(he,we){return(he[we+0]|he[we+1]<<8|he[we+2]<<16|he[we+3]<<24)>>>0}new y;var E=[0],j=[0],D=[],B=new y,F=e,$=function(he,we){var fe={},ge=0,Ce=!1,xe=0,Re=0;if(fe.frames=[],!function(me,Ye){for(var nt=0;nt<4;nt++)if(me[Ye+nt]!="RIFF".charCodeAt(nt))return!0;return!1}(he,we)){for(P(he,we+=4),we+=8;we<he.length;){var Qe=x(he,we),et=P(he,we+=4);we+=4;var je=et+(1&et);switch(Qe){case"VP8 ":case"VP8L":fe.frames[ge]===void 0&&(fe.frames[ge]={}),(xt=fe.frames[ge]).src_off=Ce?Re:we-8,xt.src_size=xe+et+8,ge++,Ce&&(Ce=!1,xe=0,Re=0);break;case"VP8X":(xt=fe.header={}).feature_flags=he[we];var De=we+4;xt.canvas_width=1+C(he,De),De+=3,xt.canvas_height=1+C(he,De),De+=3;break;case"ALPH":Ce=!0,xe=je+8,Re=we-8;break;case"ANIM":(xt=fe.header).bgcolor=P(he,we),De=we+4,xt.loop_count=w(he,De),De+=2;break;case"ANMF":var Ct,xt;(xt=fe.frames[ge]={}).offset_x=2*C(he,we),we+=3,xt.offset_y=2*C(he,we),we+=3,xt.width=1+C(he,we),we+=3,xt.height=1+C(he,we),we+=3,xt.duration=C(he,we),we+=3,Ct=he[we++],xt.dispose=1&Ct,xt.blend=Ct>>1&1}Qe!="ANMF"&&(we+=je)}return fe}}(F,0);$.response=F,$.rgbaoutput=!0,$.dataurl=!1;var H=$.header?$.header:null,J=$.frames?$.frames:null;if(H){H.loop_counter=H.loop_count,E=[H.canvas_height],j=[H.canvas_width];for(var ee=0;ee<J.length&&J[ee].blend!=0;ee++);}var Q=J[0],ne=B.WebPDecodeRGBA(F,Q.src_off,Q.src_size,j,E);Q.rgba=ne,Q.imgwidth=j[0],Q.imgheight=E[0];for(var pe=0;pe<j[0]*E[0]*4;pe++)D[pe]=ne[pe];return this.width=j,this.height=E,this.data=D,this}(function(e){var t,n,r,a,l,h,i,y,x,w=function(me){return me=me||{},this.isStrokeTransparent=me.isStrokeTransparent||!1,this.strokeOpacity=me.strokeOpacity||1,this.strokeStyle=me.strokeStyle||"#000000",this.fillStyle=me.fillStyle||"#000000",this.isFillTransparent=me.isFillTransparent||!1,this.fillOpacity=me.fillOpacity||1,this.font=me.font||"10px sans-serif",this.textBaseline=me.textBaseline||"alphabetic",this.textAlign=me.textAlign||"left",this.lineWidth=me.lineWidth||1,this.lineJoin=me.lineJoin||"miter",this.lineCap=me.lineCap||"butt",this.path=me.path||[],this.transform=me.transform!==void 0?me.transform.clone():new y,this.globalCompositeOperation=me.globalCompositeOperation||"normal",this.globalAlpha=me.globalAlpha||1,this.clip_path=me.clip_path||[],this.currentPoint=me.currentPoint||new h,this.miterLimit=me.miterLimit||10,this.lastPoint=me.lastPoint||new h,this.lineDashOffset=me.lineDashOffset||0,this.lineDash=me.lineDash||[],this.margin=me.margin||[0,0,0,0],this.prevPageLastElemOffset=me.prevPageLastElemOffset||0,this.ignoreClearRect=typeof me.ignoreClearRect!="boolean"||me.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new C(this),t=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,l=this.internal.getVerticalCoordinate,h=this.internal.Point,i=this.internal.Rectangle,y=this.internal.Matrix,x=new w}]);var C=function(me){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Ye=me;Object.defineProperty(this,"pdf",{get:function(){return Ye}});var nt=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return nt},set:function(Kt){nt=!!Kt}});var vt=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return vt},set:function(Kt){vt=!!Kt}});var gt=0;Object.defineProperty(this,"posX",{get:function(){return gt},set:function(Kt){isNaN(Kt)||(gt=Kt)}});var dt=0;Object.defineProperty(this,"posY",{get:function(){return dt},set:function(Kt){isNaN(Kt)||(dt=Kt)}}),Object.defineProperty(this,"margin",{get:function(){return x.margin},set:function(Kt){var st;typeof Kt=="number"?st=[Kt,Kt,Kt,Kt]:((st=new Array(4))[0]=Kt[0],st[1]=Kt.length>=2?Kt[1]:st[0],st[2]=Kt.length>=3?Kt[2]:st[0],st[3]=Kt.length>=4?Kt[3]:st[1]),x.margin=st}});var At=!1;Object.defineProperty(this,"autoPaging",{get:function(){return At},set:function(Kt){At=Kt}});var mt=0;Object.defineProperty(this,"lastBreak",{get:function(){return mt},set:function(Kt){mt=Kt}});var Pt=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Pt},set:function(Kt){Pt=Kt}}),Object.defineProperty(this,"ctx",{get:function(){return x},set:function(Kt){Kt instanceof w&&(x=Kt)}}),Object.defineProperty(this,"path",{get:function(){return x.path},set:function(Kt){x.path=Kt}});var Ht=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ht},set:function(Kt){Ht=Kt}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Kt){var st;st=P(Kt),this.ctx.fillStyle=st.style,this.ctx.isFillTransparent=st.a===0,this.ctx.fillOpacity=st.a,this.pdf.setFillColor(st.r,st.g,st.b,{a:st.a}),this.pdf.setTextColor(st.r,st.g,st.b,{a:st.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Kt){var st=P(Kt);this.ctx.strokeStyle=st.style,this.ctx.isStrokeTransparent=st.a===0,this.ctx.strokeOpacity=st.a,st.a===0?this.pdf.setDrawColor(255,255,255):(st.a,this.pdf.setDrawColor(st.r,st.g,st.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Kt){["butt","round","square"].indexOf(Kt)!==-1&&(this.ctx.lineCap=Kt,this.pdf.setLineCap(Kt))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Kt){isNaN(Kt)||(this.ctx.lineWidth=Kt,this.pdf.setLineWidth(Kt))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Kt){["bevel","round","miter"].indexOf(Kt)!==-1&&(this.ctx.lineJoin=Kt,this.pdf.setLineJoin(Kt))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Kt){isNaN(Kt)||(this.ctx.miterLimit=Kt,this.pdf.setMiterLimit(Kt))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Kt){this.ctx.textBaseline=Kt}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Kt){["right","end","center","left","start"].indexOf(Kt)!==-1&&(this.ctx.textAlign=Kt)}});var Ot=null,Un=null;Object.defineProperty(this,"fontFaces",{get:function(){return Un},set:function(Kt){Ot=null,Un=Kt}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Kt){var st;if(this.ctx.font=Kt,(st=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Kt))!==null){var Dr=st[1];st[2];var Or=st[3],Br=st[4];st[5];var On=st[6],ht=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Br)[2];Br=Math.floor(ht==="px"?parseFloat(Br)*this.pdf.internal.scaleFactor:ht==="em"?parseFloat(Br)*this.pdf.getFontSize():parseFloat(Br)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Br);var wt=function(Qr){var dr,Hi,Bi=[],Cr=Qr.trim();if(Cr==="")return K4;if(Cr in pY)return[pY[Cr]];for(;Cr!=="";){switch(Hi=null,dr=(Cr=gY(Cr)).charAt(0)){case'"':case"'":Hi=zKe(Cr.substring(1),dr);break;default:Hi=BKe(Cr)}if(Hi===null||(Bi.push(Hi[0]),(Cr=gY(Hi[1]))!==""&&Cr.charAt(0)!==","))return K4;Cr=Cr.replace(/^,/,"")}return Bi}(On);if(this.fontFaces){var Wt=function(Qr,dr){if(Ot===null){var Hi=function(Bi){var Cr=[];return Object.keys(Bi).forEach(function(fi){Bi[fi].forEach(function(Cn){var bn=null;switch(Cn){case"bold":bn={family:fi,weight:"bold"};break;case"italic":bn={family:fi,style:"italic"};break;case"bolditalic":bn={family:fi,weight:"bold",style:"italic"};break;case"":case"normal":bn={family:fi}}bn!==null&&(bn.ref={name:fi,style:Cn},Cr.push(bn))})}),Cr}(Qr.getFontList());Ot=function(Bi){for(var Cr={},fi=0;fi<Bi.length;++fi){var Cn=Z4(Bi[fi]),bn=Cn.family,fr=Cn.stretch,Ur=Cn.style,Xs=Cn.weight;Cr[bn]=Cr[bn]||{},Cr[bn][fr]=Cr[bn][fr]||{},Cr[bn][fr][Ur]=Cr[bn][fr][Ur]||{},Cr[bn][fr][Ur][Xs]=Cn}return Cr}(Hi.concat(dr))}return Ot}(this.pdf,this.fontFaces),xn=wt.map(function(Qr){return{family:Qr,stretch:"normal",weight:Or,style:Dr}}),Rn=function(Qr,dr,Hi){for(var Bi=(Hi=Hi||{}).defaultFontFamily||"times",Cr=Object.assign({},FKe,Hi.genericFontFamilies||{}),fi=null,Cn=null,bn=0;bn<dr.length;++bn)if(Cr[(fi=Z4(dr[bn])).family]&&(fi.family=Cr[fi.family]),Qr.hasOwnProperty(fi.family)){Cn=Qr[fi.family];break}if(!(Cn=Cn||Qr[Bi]))throw new Error("Could not find a font-family for the rule '"+mY(fi)+"' and default family '"+Bi+"'.");if(Cn=function(fr,Ur){if(Ur[fr])return Ur[fr];var Xs=mO[fr],_a=Xs<=mO.normal?-1:1,ts=fY(Ur,Hhe,Xs,_a);if(!ts)throw new Error("Could not find a matching font-stretch value for "+fr);return ts}(fi.stretch,Cn),Cn=function(fr,Ur){if(Ur[fr])return Ur[fr];for(var Xs=Ghe[fr],_a=0;_a<Xs.length;++_a)if(Ur[Xs[_a]])return Ur[Xs[_a]];throw new Error("Could not find a matching font-style for "+fr)}(fi.style,Cn),!(Cn=function(fr,Ur){if(Ur[fr])return Ur[fr];if(fr===400&&Ur[500])return Ur[500];if(fr===500&&Ur[400])return Ur[400];var Xs=OKe[fr],_a=fY(Ur,Whe,Xs,fr<400?-1:1);if(!_a)throw new Error("Could not find a matching font-weight for value "+fr);return _a}(fi.weight,Cn)))throw new Error("Failed to resolve a font for the rule '"+mY(fi)+"'.");return Cn}(Wt,xn);this.pdf.setFont(Rn.ref.name,Rn.ref.style)}else{var Sn="";(Or==="bold"||parseInt(Or,10)>=700||Dr==="bold")&&(Sn="bold"),Dr==="italic"&&(Sn+="italic"),Sn.length===0&&(Sn="normal");for(var Mn="",Ar={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Pr=0;Pr<wt.length;Pr++){if(this.pdf.internal.getFont(wt[Pr],Sn,{noFallback:!0,disableWarning:!0})!==void 0){Mn=wt[Pr];break}if(Sn==="bolditalic"&&this.pdf.internal.getFont(wt[Pr],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Mn=wt[Pr],Sn="bold";else if(this.pdf.internal.getFont(wt[Pr],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Mn=wt[Pr],Sn="normal";break}}if(Mn===""){for(var wr=0;wr<wt.length;wr++)if(Ar[wt[wr]]){Mn=Ar[wt[wr]];break}}Mn=Mn===""?"Times":Mn,this.pdf.setFont(Mn,Sn)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Kt){this.ctx.globalCompositeOperation=Kt}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Kt){this.ctx.globalAlpha=Kt}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Kt){this.ctx.lineDashOffset=Kt,xt.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Kt){this.ctx.lineDash=Kt,xt.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Kt){this.ctx.ignoreClearRect=!!Kt}})};C.prototype.setLineDash=function(me){this.lineDash=me},C.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},C.prototype.fill=function(){J.call(this,"fill",!1)},C.prototype.stroke=function(){J.call(this,"stroke",!1)},C.prototype.beginPath=function(){this.path=[{type:"begin"}]},C.prototype.moveTo=function(me,Ye){if(isNaN(me)||isNaN(Ye))throw Ka.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var nt=this.ctx.transform.applyToPoint(new h(me,Ye));this.path.push({type:"mt",x:nt.x,y:nt.y}),this.ctx.lastPoint=new h(me,Ye)},C.prototype.closePath=function(){var me=new h(0,0),Ye=0;for(Ye=this.path.length-1;Ye!==-1;Ye--)if(this.path[Ye].type==="begin"&&Da(this.path[Ye+1])==="object"&&typeof this.path[Ye+1].x=="number"){me=new h(this.path[Ye+1].x,this.path[Ye+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new h(me.x,me.y)},C.prototype.lineTo=function(me,Ye){if(isNaN(me)||isNaN(Ye))throw Ka.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var nt=this.ctx.transform.applyToPoint(new h(me,Ye));this.path.push({type:"lt",x:nt.x,y:nt.y}),this.ctx.lastPoint=new h(nt.x,nt.y)},C.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),J.call(this,null,!0)},C.prototype.quadraticCurveTo=function(me,Ye,nt,vt){if(isNaN(nt)||isNaN(vt)||isNaN(me)||isNaN(Ye))throw Ka.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var gt=this.ctx.transform.applyToPoint(new h(nt,vt)),dt=this.ctx.transform.applyToPoint(new h(me,Ye));this.path.push({type:"qct",x1:dt.x,y1:dt.y,x:gt.x,y:gt.y}),this.ctx.lastPoint=new h(gt.x,gt.y)},C.prototype.bezierCurveTo=function(me,Ye,nt,vt,gt,dt){if(isNaN(gt)||isNaN(dt)||isNaN(me)||isNaN(Ye)||isNaN(nt)||isNaN(vt))throw Ka.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var At=this.ctx.transform.applyToPoint(new h(gt,dt)),mt=this.ctx.transform.applyToPoint(new h(me,Ye)),Pt=this.ctx.transform.applyToPoint(new h(nt,vt));this.path.push({type:"bct",x1:mt.x,y1:mt.y,x2:Pt.x,y2:Pt.y,x:At.x,y:At.y}),this.ctx.lastPoint=new h(At.x,At.y)},C.prototype.arc=function(me,Ye,nt,vt,gt,dt){if(isNaN(me)||isNaN(Ye)||isNaN(nt)||isNaN(vt)||isNaN(gt))throw Ka.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(dt=!!dt,!this.ctx.transform.isIdentity){var At=this.ctx.transform.applyToPoint(new h(me,Ye));me=At.x,Ye=At.y;var mt=this.ctx.transform.applyToPoint(new h(0,nt)),Pt=this.ctx.transform.applyToPoint(new h(0,0));nt=Math.sqrt(Math.pow(mt.x-Pt.x,2)+Math.pow(mt.y-Pt.y,2))}Math.abs(gt-vt)>=2*Math.PI&&(vt=0,gt=2*Math.PI),this.path.push({type:"arc",x:me,y:Ye,radius:nt,startAngle:vt,endAngle:gt,counterclockwise:dt})},C.prototype.arcTo=function(me,Ye,nt,vt,gt){throw new Error("arcTo not implemented.")},C.prototype.rect=function(me,Ye,nt,vt){if(isNaN(me)||isNaN(Ye)||isNaN(nt)||isNaN(vt))throw Ka.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(me,Ye),this.lineTo(me+nt,Ye),this.lineTo(me+nt,Ye+vt),this.lineTo(me,Ye+vt),this.lineTo(me,Ye),this.lineTo(me+nt,Ye),this.lineTo(me,Ye)},C.prototype.fillRect=function(me,Ye,nt,vt){if(isNaN(me)||isNaN(Ye)||isNaN(nt)||isNaN(vt))throw Ka.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!E.call(this)){var gt={};this.lineCap!=="butt"&&(gt.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(gt.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(me,Ye,nt,vt),this.fill(),gt.hasOwnProperty("lineCap")&&(this.lineCap=gt.lineCap),gt.hasOwnProperty("lineJoin")&&(this.lineJoin=gt.lineJoin)}},C.prototype.strokeRect=function(me,Ye,nt,vt){if(isNaN(me)||isNaN(Ye)||isNaN(nt)||isNaN(vt))throw Ka.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");j.call(this)||(this.beginPath(),this.rect(me,Ye,nt,vt),this.stroke())},C.prototype.clearRect=function(me,Ye,nt,vt){if(isNaN(me)||isNaN(Ye)||isNaN(nt)||isNaN(vt))throw Ka.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(me,Ye,nt,vt))},C.prototype.save=function(me){me=typeof me!="boolean"||me;for(var Ye=this.pdf.internal.getCurrentPageInfo().pageNumber,nt=0;nt<this.pdf.internal.getNumberOfPages();nt++)this.pdf.setPage(nt+1),this.pdf.internal.out("q");if(this.pdf.setPage(Ye),me){this.ctx.fontSize=this.pdf.internal.getFontSize();var vt=new w(this.ctx);this.ctxStack.push(this.ctx),this.ctx=vt}},C.prototype.restore=function(me){me=typeof me!="boolean"||me;for(var Ye=this.pdf.internal.getCurrentPageInfo().pageNumber,nt=0;nt<this.pdf.internal.getNumberOfPages();nt++)this.pdf.setPage(nt+1),this.pdf.internal.out("Q");this.pdf.setPage(Ye),me&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},C.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var P=function(me){var Ye,nt,vt,gt;if(me.isCanvasGradient===!0&&(me=me.getColor()),!me)return{r:0,g:0,b:0,a:0,style:me};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(me))Ye=0,nt=0,vt=0,gt=0;else{var dt=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(me);if(dt!==null)Ye=parseInt(dt[1]),nt=parseInt(dt[2]),vt=parseInt(dt[3]),gt=1;else if((dt=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(me))!==null)Ye=parseInt(dt[1]),nt=parseInt(dt[2]),vt=parseInt(dt[3]),gt=parseFloat(dt[4]);else{if(gt=1,typeof me=="string"&&me.charAt(0)!=="#"){var At=new Fhe(me);me=At.ok?At.toHex():"#000000"}me.length===4?(Ye=me.substring(1,2),Ye+=Ye,nt=me.substring(2,3),nt+=nt,vt=me.substring(3,4),vt+=vt):(Ye=me.substring(1,3),nt=me.substring(3,5),vt=me.substring(5,7)),Ye=parseInt(Ye,16),nt=parseInt(nt,16),vt=parseInt(vt,16)}}return{r:Ye,g:nt,b:vt,a:gt,style:me}},E=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},j=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};C.prototype.fillText=function(me,Ye,nt,vt){if(isNaN(Ye)||isNaN(nt)||typeof me!="string")throw Ka.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(vt=isNaN(vt)?void 0:vt,!E.call(this)){var gt=je(this.ctx.transform.rotation),dt=this.ctx.transform.scaleX;ge.call(this,{text:me,x:Ye,y:nt,scale:dt,angle:gt,align:this.textAlign,maxWidth:vt})}},C.prototype.strokeText=function(me,Ye,nt,vt){if(isNaN(Ye)||isNaN(nt)||typeof me!="string")throw Ka.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!j.call(this)){vt=isNaN(vt)?void 0:vt;var gt=je(this.ctx.transform.rotation),dt=this.ctx.transform.scaleX;ge.call(this,{text:me,x:Ye,y:nt,scale:dt,renderingMode:"stroke",angle:gt,align:this.textAlign,maxWidth:vt})}},C.prototype.measureText=function(me){if(typeof me!="string")throw Ka.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Ye=this.pdf,nt=this.pdf.internal.scaleFactor,vt=Ye.internal.getFontSize(),gt=Ye.getStringUnitWidth(me)*vt/Ye.internal.scaleFactor;return new function(dt){var At=(dt=dt||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return At}}),this}({width:gt*=Math.round(96*nt/72*1e4)/1e4})},C.prototype.scale=function(me,Ye){if(isNaN(me)||isNaN(Ye))throw Ka.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var nt=new y(me,0,0,Ye,0,0);this.ctx.transform=this.ctx.transform.multiply(nt)},C.prototype.rotate=function(me){if(isNaN(me))throw Ka.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Ye=new y(Math.cos(me),Math.sin(me),-Math.sin(me),Math.cos(me),0,0);this.ctx.transform=this.ctx.transform.multiply(Ye)},C.prototype.translate=function(me,Ye){if(isNaN(me)||isNaN(Ye))throw Ka.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var nt=new y(1,0,0,1,me,Ye);this.ctx.transform=this.ctx.transform.multiply(nt)},C.prototype.transform=function(me,Ye,nt,vt,gt,dt){if(isNaN(me)||isNaN(Ye)||isNaN(nt)||isNaN(vt)||isNaN(gt)||isNaN(dt))throw Ka.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var At=new y(me,Ye,nt,vt,gt,dt);this.ctx.transform=this.ctx.transform.multiply(At)},C.prototype.setTransform=function(me,Ye,nt,vt,gt,dt){me=isNaN(me)?1:me,Ye=isNaN(Ye)?0:Ye,nt=isNaN(nt)?0:nt,vt=isNaN(vt)?1:vt,gt=isNaN(gt)?0:gt,dt=isNaN(dt)?0:dt,this.ctx.transform=new y(me,Ye,nt,vt,gt,dt)};var D=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};C.prototype.drawImage=function(me,Ye,nt,vt,gt,dt,At,mt,Pt){var Ht=this.pdf.getImageProperties(me),Ot=1,Un=1,Kt=1,st=1;vt!==void 0&&mt!==void 0&&(Kt=mt/vt,st=Pt/gt,Ot=Ht.width/vt*mt/vt,Un=Ht.height/gt*Pt/gt),dt===void 0&&(dt=Ye,At=nt,Ye=0,nt=0),vt!==void 0&&mt===void 0&&(mt=vt,Pt=gt),vt===void 0&&mt===void 0&&(mt=Ht.width,Pt=Ht.height);for(var Dr,Or=this.ctx.transform.decompose(),Br=je(Or.rotate.shx),On=new y,ht=(On=(On=(On=On.multiply(Or.translate)).multiply(Or.skew)).multiply(Or.scale)).applyToRectangle(new i(dt-Ye*Kt,At-nt*st,vt*Ot,gt*Un)),wt=B.call(this,ht),Wt=[],xn=0;xn<wt.length;xn+=1)Wt.indexOf(wt[xn])===-1&&Wt.push(wt[xn]);if(H(Wt),this.autoPaging)for(var Rn=Wt[0],Sn=Wt[Wt.length-1],Mn=Rn;Mn<Sn+1;Mn++){this.pdf.setPage(Mn);var Ar=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Pr=Mn===1?this.posY+this.margin[0]:this.margin[0],wr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Qr=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],dr=Mn===1?0:wr+(Mn-2)*Qr;if(this.ctx.clip_path.length!==0){var Hi=this.path;Dr=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=$(Dr,this.posX+this.margin[3],-dr+Pr+this.ctx.prevPageLastElemOffset),ee.call(this,"fill",!0),this.path=Hi}var Bi=JSON.parse(JSON.stringify(ht));Bi=$([Bi],this.posX+this.margin[3],-dr+Pr+this.ctx.prevPageLastElemOffset)[0];var Cr=(Mn>Rn||Mn<Sn)&&D.call(this);Cr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ar,Qr,null).clip().discardPath()),this.pdf.addImage(me,"JPEG",Bi.x,Bi.y,Bi.w,Bi.h,null,null,Br),Cr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(me,"JPEG",ht.x,ht.y,ht.w,ht.h,null,null,Br)};var B=function(me,Ye,nt){var vt=[];Ye=Ye||this.pdf.internal.pageSize.width,nt=nt||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var gt=this.posY+this.ctx.prevPageLastElemOffset;switch(me.type){default:case"mt":case"lt":vt.push(Math.floor((me.y+gt)/nt)+1);break;case"arc":vt.push(Math.floor((me.y+gt-me.radius)/nt)+1),vt.push(Math.floor((me.y+gt+me.radius)/nt)+1);break;case"qct":var dt=De(this.ctx.lastPoint.x,this.ctx.lastPoint.y,me.x1,me.y1,me.x,me.y);vt.push(Math.floor((dt.y+gt)/nt)+1),vt.push(Math.floor((dt.y+dt.h+gt)/nt)+1);break;case"bct":var At=Ct(this.ctx.lastPoint.x,this.ctx.lastPoint.y,me.x1,me.y1,me.x2,me.y2,me.x,me.y);vt.push(Math.floor((At.y+gt)/nt)+1),vt.push(Math.floor((At.y+At.h+gt)/nt)+1);break;case"rect":vt.push(Math.floor((me.y+gt)/nt)+1),vt.push(Math.floor((me.y+me.h+gt)/nt)+1)}for(var mt=0;mt<vt.length;mt+=1)for(;this.pdf.internal.getNumberOfPages()<vt[mt];)F.call(this);return vt},F=function(){var me=this.fillStyle,Ye=this.strokeStyle,nt=this.font,vt=this.lineCap,gt=this.lineWidth,dt=this.lineJoin;this.pdf.addPage(),this.fillStyle=me,this.strokeStyle=Ye,this.font=nt,this.lineCap=vt,this.lineWidth=gt,this.lineJoin=dt},$=function(me,Ye,nt){for(var vt=0;vt<me.length;vt++)switch(me[vt].type){case"bct":me[vt].x2+=Ye,me[vt].y2+=nt;case"qct":me[vt].x1+=Ye,me[vt].y1+=nt;default:me[vt].x+=Ye,me[vt].y+=nt}return me},H=function(me){return me.sort(function(Ye,nt){return Ye-nt})},J=function(me,Ye){for(var nt,vt,gt=this.fillStyle,dt=this.strokeStyle,At=this.lineCap,mt=this.lineWidth,Pt=Math.abs(mt*this.ctx.transform.scaleX),Ht=this.lineJoin,Ot=JSON.parse(JSON.stringify(this.path)),Un=JSON.parse(JSON.stringify(this.path)),Kt=[],st=0;st<Un.length;st++)if(Un[st].x!==void 0)for(var Dr=B.call(this,Un[st]),Or=0;Or<Dr.length;Or+=1)Kt.indexOf(Dr[Or])===-1&&Kt.push(Dr[Or]);for(var Br=0;Br<Kt.length;Br++)for(;this.pdf.internal.getNumberOfPages()<Kt[Br];)F.call(this);if(H(Kt),this.autoPaging)for(var On=Kt[0],ht=Kt[Kt.length-1],wt=On;wt<ht+1;wt++){this.pdf.setPage(wt),this.fillStyle=gt,this.strokeStyle=dt,this.lineCap=At,this.lineWidth=Pt,this.lineJoin=Ht;var Wt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],xn=wt===1?this.posY+this.margin[0]:this.margin[0],Rn=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Sn=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Mn=wt===1?0:Rn+(wt-2)*Sn;if(this.ctx.clip_path.length!==0){var Ar=this.path;nt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=$(nt,this.posX+this.margin[3],-Mn+xn+this.ctx.prevPageLastElemOffset),ee.call(this,me,!0),this.path=Ar}if(vt=JSON.parse(JSON.stringify(Ot)),this.path=$(vt,this.posX+this.margin[3],-Mn+xn+this.ctx.prevPageLastElemOffset),Ye===!1||wt===0){var Pr=(wt>On||wt<ht)&&D.call(this);Pr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Wt,Sn,null).clip().discardPath()),ee.call(this,me,Ye),Pr&&this.pdf.restoreGraphicsState()}this.lineWidth=mt}else this.lineWidth=Pt,ee.call(this,me,Ye),this.lineWidth=mt;this.path=Ot},ee=function(me,Ye){if((me!=="stroke"||Ye||!j.call(this))&&(me==="stroke"||Ye||!E.call(this))){for(var nt,vt,gt=[],dt=this.path,At=0;At<dt.length;At++){var mt=dt[At];switch(mt.type){case"begin":gt.push({begin:!0});break;case"close":gt.push({close:!0});break;case"mt":gt.push({start:mt,deltas:[],abs:[]});break;case"lt":var Pt=gt.length;if(dt[At-1]&&!isNaN(dt[At-1].x)&&(nt=[mt.x-dt[At-1].x,mt.y-dt[At-1].y],Pt>0)){for(;Pt>=0;Pt--)if(gt[Pt-1].close!==!0&&gt[Pt-1].begin!==!0){gt[Pt-1].deltas.push(nt),gt[Pt-1].abs.push(mt);break}}break;case"bct":nt=[mt.x1-dt[At-1].x,mt.y1-dt[At-1].y,mt.x2-dt[At-1].x,mt.y2-dt[At-1].y,mt.x-dt[At-1].x,mt.y-dt[At-1].y],gt[gt.length-1].deltas.push(nt);break;case"qct":var Ht=dt[At-1].x+2/3*(mt.x1-dt[At-1].x),Ot=dt[At-1].y+2/3*(mt.y1-dt[At-1].y),Un=mt.x+2/3*(mt.x1-mt.x),Kt=mt.y+2/3*(mt.y1-mt.y),st=mt.x,Dr=mt.y;nt=[Ht-dt[At-1].x,Ot-dt[At-1].y,Un-dt[At-1].x,Kt-dt[At-1].y,st-dt[At-1].x,Dr-dt[At-1].y],gt[gt.length-1].deltas.push(nt);break;case"arc":gt.push({deltas:[],abs:[],arc:!0}),Array.isArray(gt[gt.length-1].abs)&&gt[gt.length-1].abs.push(mt)}}vt=Ye?null:me==="stroke"?"stroke":"fill";for(var Or=!1,Br=0;Br<gt.length;Br++)if(gt[Br].arc)for(var On=gt[Br].abs,ht=0;ht<On.length;ht++){var wt=On[ht];wt.type==="arc"?pe.call(this,wt.x,wt.y,wt.radius,wt.startAngle,wt.endAngle,wt.counterclockwise,void 0,Ye,!Or):Ce.call(this,wt.x,wt.y),Or=!0}else if(gt[Br].close===!0)this.pdf.internal.out("h"),Or=!1;else if(gt[Br].begin!==!0){var Wt=gt[Br].start.x,xn=gt[Br].start.y;xe.call(this,gt[Br].deltas,Wt,xn),Or=!0}vt&&he.call(this,vt),Ye&&we.call(this)}},Q=function(me){var Ye=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,nt=Ye*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return me-nt;case"top":return me+Ye-nt;case"hanging":return me+Ye-2*nt;case"middle":return me+Ye/2-nt;default:return me}},ne=function(me){return me+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};C.prototype.createLinearGradient=function(){var me=function(){};return me.colorStops=[],me.addColorStop=function(Ye,nt){this.colorStops.push([Ye,nt])},me.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},me.isCanvasGradient=!0,me},C.prototype.createPattern=function(){return this.createLinearGradient()},C.prototype.createRadialGradient=function(){return this.createLinearGradient()};var pe=function(me,Ye,nt,vt,gt,dt,At,mt,Pt){for(var Ht=Qe.call(this,nt,vt,gt,dt),Ot=0;Ot<Ht.length;Ot++){var Un=Ht[Ot];Ot===0&&(Pt?fe.call(this,Un.x1+me,Un.y1+Ye):Ce.call(this,Un.x1+me,Un.y1+Ye)),Re.call(this,me,Ye,Un.x2,Un.y2,Un.x3,Un.y3,Un.x4,Un.y4)}mt?we.call(this):he.call(this,At)},he=function(me){switch(me){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},we=function(){this.pdf.clip(),this.pdf.discardPath()},fe=function(me,Ye){this.pdf.internal.out(n(me)+" "+r(Ye)+" m")},ge=function(me){var Ye;switch(me.align){case"right":case"end":Ye="right";break;case"center":Ye="center";break;default:Ye="left"}var nt=this.pdf.getTextDimensions(me.text),vt=Q.call(this,me.y),gt=ne.call(this,vt)-nt.h,dt=this.ctx.transform.applyToPoint(new h(me.x,vt)),At=this.ctx.transform.decompose(),mt=new y;mt=(mt=(mt=mt.multiply(At.translate)).multiply(At.skew)).multiply(At.scale);for(var Pt,Ht,Ot,Un=this.ctx.transform.applyToRectangle(new i(me.x,vt,nt.w,nt.h)),Kt=mt.applyToRectangle(new i(me.x,gt,nt.w,nt.h)),st=B.call(this,Kt),Dr=[],Or=0;Or<st.length;Or+=1)Dr.indexOf(st[Or])===-1&&Dr.push(st[Or]);if(H(Dr),this.autoPaging)for(var Br=Dr[0],On=Dr[Dr.length-1],ht=Br;ht<On+1;ht++){this.pdf.setPage(ht);var wt=ht===1?this.posY+this.margin[0]:this.margin[0],Wt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],xn=this.pdf.internal.pageSize.height-this.margin[2],Rn=xn-this.margin[0],Sn=this.pdf.internal.pageSize.width-this.margin[1],Mn=Sn-this.margin[3],Ar=ht===1?0:Wt+(ht-2)*Rn;if(this.ctx.clip_path.length!==0){var Pr=this.path;Pt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=$(Pt,this.posX+this.margin[3],-1*Ar+wt),ee.call(this,"fill",!0),this.path=Pr}var wr=$([JSON.parse(JSON.stringify(Kt))],this.posX+this.margin[3],-Ar+wt+this.ctx.prevPageLastElemOffset)[0];me.scale>=.01&&(Ht=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ht*me.scale),Ot=this.lineWidth,this.lineWidth=Ot*me.scale);var Qr=this.autoPaging!=="text";if(Qr||wr.y+wr.h<=xn){if(Qr||wr.y>=wt&&wr.x<=Sn){var dr=Qr?me.text:this.pdf.splitTextToSize(me.text,me.maxWidth||Sn-wr.x)[0],Hi=$([JSON.parse(JSON.stringify(Un))],this.posX+this.margin[3],-Ar+wt+this.ctx.prevPageLastElemOffset)[0],Bi=Qr&&(ht>Br||ht<On)&&D.call(this);Bi&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Mn,Rn,null).clip().discardPath()),this.pdf.text(dr,Hi.x,Hi.y,{angle:me.angle,align:Ye,renderingMode:me.renderingMode}),Bi&&this.pdf.restoreGraphicsState()}}else wr.y<xn&&(this.ctx.prevPageLastElemOffset+=xn-wr.y);me.scale>=.01&&(this.pdf.setFontSize(Ht),this.lineWidth=Ot)}else me.scale>=.01&&(Ht=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ht*me.scale),Ot=this.lineWidth,this.lineWidth=Ot*me.scale),this.pdf.text(me.text,dt.x+this.posX,dt.y+this.posY,{angle:me.angle,align:Ye,renderingMode:me.renderingMode,maxWidth:me.maxWidth}),me.scale>=.01&&(this.pdf.setFontSize(Ht),this.lineWidth=Ot)},Ce=function(me,Ye,nt,vt){nt=nt||0,vt=vt||0,this.pdf.internal.out(n(me+nt)+" "+r(Ye+vt)+" l")},xe=function(me,Ye,nt){return this.pdf.lines(me,Ye,nt,null,null)},Re=function(me,Ye,nt,vt,gt,dt,At,mt){this.pdf.internal.out([t(a(nt+me)),t(l(vt+Ye)),t(a(gt+me)),t(l(dt+Ye)),t(a(At+me)),t(l(mt+Ye)),"c"].join(" "))},Qe=function(me,Ye,nt,vt){for(var gt=2*Math.PI,dt=Math.PI/2;Ye>nt;)Ye-=gt;var At=Math.abs(nt-Ye);At<gt&&vt&&(At=gt-At);for(var mt=[],Pt=vt?-1:1,Ht=Ye;At>1e-5;){var Ot=Ht+Pt*Math.min(At,dt);mt.push(et.call(this,me,Ht,Ot)),At-=Math.abs(Ot-Ht),Ht=Ot}return mt},et=function(me,Ye,nt){var vt=(nt-Ye)/2,gt=me*Math.cos(vt),dt=me*Math.sin(vt),At=gt,mt=-dt,Pt=At*At+mt*mt,Ht=Pt+At*gt+mt*dt,Ot=4/3*(Math.sqrt(2*Pt*Ht)-Ht)/(At*dt-mt*gt),Un=At-Ot*mt,Kt=mt+Ot*At,st=Un,Dr=-Kt,Or=vt+Ye,Br=Math.cos(Or),On=Math.sin(Or);return{x1:me*Math.cos(Ye),y1:me*Math.sin(Ye),x2:Un*Br-Kt*On,y2:Un*On+Kt*Br,x3:st*Br-Dr*On,y3:st*On+Dr*Br,x4:me*Math.cos(nt),y4:me*Math.sin(nt)}},je=function(me){return 180*me/Math.PI},De=function(me,Ye,nt,vt,gt,dt){var At=me+.5*(nt-me),mt=Ye+.5*(vt-Ye),Pt=gt+.5*(nt-gt),Ht=dt+.5*(vt-dt),Ot=Math.min(me,gt,At,Pt),Un=Math.max(me,gt,At,Pt),Kt=Math.min(Ye,dt,mt,Ht),st=Math.max(Ye,dt,mt,Ht);return new i(Ot,Kt,Un-Ot,st-Kt)},Ct=function(me,Ye,nt,vt,gt,dt,At,mt){var Pt,Ht,Ot,Un,Kt,st,Dr,Or,Br,On,ht,wt,Wt,xn,Rn=nt-me,Sn=vt-Ye,Mn=gt-nt,Ar=dt-vt,Pr=At-gt,wr=mt-dt;for(Ht=0;Ht<41;Ht++)Br=(Dr=(Ot=me+(Pt=Ht/40)*Rn)+Pt*((Kt=nt+Pt*Mn)-Ot))+Pt*(Kt+Pt*(gt+Pt*Pr-Kt)-Dr),On=(Or=(Un=Ye+Pt*Sn)+Pt*((st=vt+Pt*Ar)-Un))+Pt*(st+Pt*(dt+Pt*wr-st)-Or),Ht==0?(ht=Br,wt=On,Wt=Br,xn=On):(ht=Math.min(ht,Br),wt=Math.min(wt,On),Wt=Math.max(Wt,Br),xn=Math.max(xn,On));return new i(Math.round(ht),Math.round(wt),Math.round(Wt-ht),Math.round(xn-wt))},xt=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var me,Ye,nt=(me=this.ctx.lineDash,Ye=this.ctx.lineDashOffset,JSON.stringify({lineDash:me,lineDashOffset:Ye}));this.prevLineDash!==nt&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=nt)}}})(Ci.API),function(e){var t=function(h){var i,y,x,w,C,P,E,j,D,B;for(y=[],x=0,w=(h+=i="\0\0\0\0".slice(h.length%4||4)).length;w>x;x+=4)(C=(h.charCodeAt(x)<<24)+(h.charCodeAt(x+1)<<16)+(h.charCodeAt(x+2)<<8)+h.charCodeAt(x+3))!==0?(P=(C=((C=((C=((C=(C-(B=C%85))/85)-(D=C%85))/85)-(j=C%85))/85)-(E=C%85))/85)%85,y.push(P+33,E+33,j+33,D+33,B+33)):y.push(122);return function(F,$){for(var H=$;H>0;H--)F.pop()}(y,i.length),String.fromCharCode.apply(String,y)+"~>"},n=function(h){var i,y,x,w,C,P=String,E="length",j=255,D="charCodeAt",B="slice",F="replace";for(h[B](-2),h=h[B](0,-2)[F](/\s/g,"")[F]("z","!!!!!"),x=[],w=0,C=(h+=i="uuuuu"[B](h[E]%5||5))[E];C>w;w+=5)y=52200625*(h[D](w)-33)+614125*(h[D](w+1)-33)+7225*(h[D](w+2)-33)+85*(h[D](w+3)-33)+(h[D](w+4)-33),x.push(j&y>>24,j&y>>16,j&y>>8,j&y);return function($,H){for(var J=H;J>0;J--)$.pop()}(x,i[E]),P.fromCharCode.apply(P,x)},r=function(h){return h.split("").map(function(i){return("0"+i.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(h){var i=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((h=h.replace(/\s/g,"")).indexOf(">")!==-1&&(h=h.substr(0,h.indexOf(">"))),h.length%2&&(h+="0"),i.test(h)===!1)return"";for(var y="",x=0;x<h.length;x+=2)y+=String.fromCharCode("0x"+(h[x]+h[x+1]));return y},l=function(h){for(var i=new Uint8Array(h.length),y=h.length;y--;)i[y]=h.charCodeAt(y);return(i=nO(i)).reduce(function(x,w){return x+String.fromCharCode(w)},"")};e.processDataByFilters=function(h,i){var y=0,x=h||"",w=[];for(typeof(i=i||[])=="string"&&(i=[i]),y=0;y<i.length;y+=1)switch(i[y]){case"ASCII85Decode":case"/ASCII85Decode":x=n(x),w.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":x=t(x),w.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":x=a(x),w.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":x=r(x),w.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":x=l(x),w.push("/FlateDecode");break;default:throw new Error('The filter: "'+i[y]+'" is not implemented')}return{data:x,reverseChain:w.reverse().join(" ")}}}(Ci.API),function(e){e.loadFile=function(t,n,r){return function(a,l,h){l=l!==!1,h=typeof h=="function"?h:function(){};var i=void 0;try{i=function(y,x,w){var C=new XMLHttpRequest,P=0,E=function(j){var D=j.length,B=[],F=String.fromCharCode;for(P=0;P<D;P+=1)B.push(F(255&j.charCodeAt(P)));return B.join("")};if(C.open("GET",y,!x),C.overrideMimeType("text/plain; charset=x-user-defined"),x===!1&&(C.onload=function(){C.status===200?w(E(this.responseText)):w(void 0)}),C.send(null),x&&C.status===200)return E(C.responseText)}(a,l,h)}catch{}return i}(t,n,r)},e.loadImageFile=e.loadFile}(Ci.API),function(e){function t(){return(Ji.html2canvas?Promise.resolve(Ji.html2canvas):A4(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(i){return Promise.reject(new Error("Could not load html2canvas: "+i))}).then(function(i){return i.default?i.default:i})}function n(){return(Ji.DOMPurify?Promise.resolve(Ji.DOMPurify):A4(()=>import("./purify.es-DfngIMfA.js"),[])).catch(function(i){return Promise.reject(new Error("Could not load dompurify: "+i))}).then(function(i){return i.default?i.default:i})}var r=function(i){var y=Da(i);return y==="undefined"?"undefined":y==="string"||i instanceof String?"string":y==="number"||i instanceof Number?"number":y==="function"||i instanceof Function?"function":i&&i.constructor===Array?"array":i&&i.nodeType===1?"element":y==="object"?"object":"unknown"},a=function(i,y){var x=document.createElement(i);for(var w in y.className&&(x.className=y.className),y.innerHTML&&y.dompurify&&(x.innerHTML=y.dompurify.sanitize(y.innerHTML)),y.style)x.style[w]=y.style[w];return x},l=function i(y,x){for(var w=y.nodeType===3?document.createTextNode(y.nodeValue):y.cloneNode(!1),C=y.firstChild;C;C=C.nextSibling)x!==!0&&C.nodeType===1&&C.nodeName==="SCRIPT"||w.appendChild(i(C,x));return y.nodeType===1&&(y.nodeName==="CANVAS"?(w.width=y.width,w.height=y.height,w.getContext("2d").drawImage(y,0,0)):y.nodeName!=="TEXTAREA"&&y.nodeName!=="SELECT"||(w.value=y.value),w.addEventListener("load",function(){w.scrollTop=y.scrollTop,w.scrollLeft=y.scrollLeft},!0)),w},h=function i(y){var x=Object.assign(i.convert(Promise.resolve()),JSON.parse(JSON.stringify(i.template))),w=i.convert(Promise.resolve(),x);return(w=w.setProgress(1,i,1,[i])).set(y)};(h.prototype=Object.create(Promise.prototype)).constructor=h,h.convert=function(i,y){return i.__proto__=y||h.prototype,i},h.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},h.prototype.from=function(i,y){return this.then(function(){switch(y=y||function(x){switch(r(x)){case"string":return"string";case"element":return x.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(i),y){case"string":return this.then(n).then(function(x){return this.set({src:a("div",{innerHTML:i,dompurify:x})})});case"element":return this.set({src:i});case"canvas":return this.set({canvas:i});case"img":return this.set({img:i});default:return this.error("Unknown source type.")}})},h.prototype.to=function(i){switch(i){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},h.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var i={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},y=l(this.prop.src,this.opt.html2canvas.javascriptEnabled);y.tagName==="BODY"&&(i.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:i}),this.prop.container.appendChild(y),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},h.prototype.toCanvas=function(){var i=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(i).then(t).then(function(y){var x=Object.assign({},this.opt.html2canvas);return delete x.onrendered,y(this.prop.container,x)}).then(function(y){(this.opt.html2canvas.onrendered||function(){})(y),this.prop.canvas=y,document.body.removeChild(this.prop.overlay)})},h.prototype.toContext2d=function(){var i=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(i).then(t).then(function(y){var x=this.opt.jsPDF,w=this.opt.fontFaces,C=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,P=Object.assign({async:!0,allowTaint:!0,scale:C,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete P.onrendered,x.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,x.context2d.posX=this.opt.x,x.context2d.posY=this.opt.y,x.context2d.margin=this.opt.margin,x.context2d.fontFaces=w,w)for(var E=0;E<w.length;++E){var j=w[E],D=j.src.find(function(B){return B.format==="truetype"});D&&x.addFont(D.url,j.ref.name,j.ref.style)}return P.windowHeight=P.windowHeight||0,P.windowHeight=P.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):P.windowHeight,x.context2d.save(!0),y(this.prop.container,P)}).then(function(y){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(y),this.prop.canvas=y,document.body.removeChild(this.prop.overlay)})},h.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var i=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=i})},h.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},h.prototype.output=function(i,y,x){return(x=x||"pdf").toLowerCase()==="img"||x.toLowerCase()==="image"?this.outputImg(i,y):this.outputPdf(i,y)},h.prototype.outputPdf=function(i,y){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(i,y)})},h.prototype.outputImg=function(i){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(i){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+i+'" is not supported.'}})},h.prototype.save=function(i){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(i?{filename:i}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},h.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},h.prototype.set=function(i){if(r(i)!=="object")return this;var y=Object.keys(i||{}).map(function(x){if(x in h.template.prop)return function(){this.prop[x]=i[x]};switch(x){case"margin":return this.setMargin.bind(this,i.margin);case"jsPDF":return function(){return this.opt.jsPDF=i.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,i.pageSize);default:return function(){this.opt[x]=i[x]}}},this);return this.then(function(){return this.thenList(y)})},h.prototype.get=function(i,y){return this.then(function(){var x=i in h.template.prop?this.prop[i]:this.opt[i];return y?y(x):x})},h.prototype.setMargin=function(i){return this.then(function(){switch(r(i)){case"number":i=[i,i,i,i];case"array":if(i.length===2&&(i=[i[0],i[1],i[0],i[1]]),i.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=i}).then(this.setPageSize)},h.prototype.setPageSize=function(i){function y(x,w){return Math.floor(x*w/72*96)}return this.then(function(){(i=i||Ci.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(i.inner={width:i.width-this.opt.margin[1]-this.opt.margin[3],height:i.height-this.opt.margin[0]-this.opt.margin[2]},i.inner.px={width:y(i.inner.width,i.k),height:y(i.inner.height,i.k)},i.inner.ratio=i.inner.height/i.inner.width),this.prop.pageSize=i})},h.prototype.setProgress=function(i,y,x,w){return i!=null&&(this.progress.val=i),y!=null&&(this.progress.state=y),x!=null&&(this.progress.n=x),w!=null&&(this.progress.stack=w),this.progress.ratio=this.progress.val/this.progress.state,this},h.prototype.updateProgress=function(i,y,x,w){return this.setProgress(i?this.progress.val+i:null,y||null,x?this.progress.n+x:null,w?this.progress.stack.concat(w):null)},h.prototype.then=function(i,y){var x=this;return this.thenCore(i,y,function(w,C){return x.updateProgress(null,null,1,[w]),Promise.prototype.then.call(this,function(P){return x.updateProgress(null,w),P}).then(w,C).then(function(P){return x.updateProgress(1),P})})},h.prototype.thenCore=function(i,y,x){x=x||Promise.prototype.then;var w=this;i&&(i=i.bind(w)),y&&(y=y.bind(w));var C=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?w:h.convert(Object.assign({},w),Promise.prototype),P=x.call(C,i,y);return h.convert(P,w.__proto__)},h.prototype.thenExternal=function(i,y){return Promise.prototype.then.call(this,i,y)},h.prototype.thenList=function(i){var y=this;return i.forEach(function(x){y=y.thenCore(x)}),y},h.prototype.catch=function(i){i&&(i=i.bind(this));var y=Promise.prototype.catch.call(this,i);return h.convert(y,this)},h.prototype.catchExternal=function(i){return Promise.prototype.catch.call(this,i)},h.prototype.error=function(i){return this.then(function(){throw new Error(i)})},h.prototype.using=h.prototype.set,h.prototype.saveAs=h.prototype.save,h.prototype.export=h.prototype.output,h.prototype.run=h.prototype.then,Ci.getPageSize=function(i,y,x){if(Da(i)==="object"){var w=i;i=w.orientation,y=w.unit||y,x=w.format||x}y=y||"mm",x=x||"a4",i=(""+(i||"P")).toLowerCase();var C,P=(""+x).toLowerCase(),E={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(y){case"pt":C=1;break;case"mm":C=72/25.4;break;case"cm":C=72/2.54;break;case"in":C=72;break;case"px":C=.75;break;case"pc":case"em":C=12;break;case"ex":C=6;break;default:throw"Invalid unit: "+y}var j,D=0,B=0;if(E.hasOwnProperty(P))D=E[P][1]/C,B=E[P][0]/C;else try{D=x[1],B=x[0]}catch{throw new Error("Invalid format: "+x)}if(i==="p"||i==="portrait")i="p",B>D&&(j=B,B=D,D=j);else{if(i!=="l"&&i!=="landscape")throw"Invalid orientation: "+i;i="l",D>B&&(j=B,B=D,D=j)}return{width:B,height:D,unit:y,k:C,orientation:i}},e.html=function(i,y){(y=y||{}).callback=y.callback||function(){},y.html2canvas=y.html2canvas||{},y.html2canvas.canvas=y.html2canvas.canvas||this.canvas,y.jsPDF=y.jsPDF||this,y.fontFaces=y.fontFaces?y.fontFaces.map(Z4):null;var x=new h(y);return y.worker?x:x.from(i).doCallback()}}(Ci.API),Ci.API.addJS=function(e){return vY=e,this.internal.events.subscribe("postPutResources",function(){PE=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(PE+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),yY=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+vY+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){PE!==void 0&&yY!==void 0&&this.internal.out("/Names <</JavaScript "+PE+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var n=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=n.outline.render().split(/\r\n/),l=0;l<a.length;l++){var h=a[l],i=r.exec(h);if(i!=null){var y=i[1];n.internal.newObjectDeferredBegin(y,!1)}n.internal.write(h)}if(this.outline.createNamedDestinations){var x=this.internal.pages.length,w=[];for(l=0;l<x;l++){var C=n.internal.newObject();w.push(C);var P=n.internal.getPageInfo(l+1);n.internal.write("<< /D["+P.objId+" 0 R /XYZ null null null]>> endobj")}var E=n.internal.newObject();for(n.internal.write("<< /Names [ "),l=0;l<w.length;l++)n.internal.write("(page_"+(l+1)+")"+w[l]+" 0 R");n.internal.write(" ] >>","endobj"),t=n.internal.newObject(),n.internal.write("<< /Dests "+E+" 0 R"),n.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var n=this;n.outline.root.children.length>0&&(n.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&n.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(r,a,l){var h={title:a,options:l,children:[]};return r==null&&(r=this.root),r.children.push(h),h},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(r){r.id=n.internal.newObjectDeferred();for(var a=0;a<r.children.length;a++)this.genIds_r(r.children[a])},n.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},n.outline.renderItems=function(r){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,l=0;l<r.children.length;l++){var h=r.children[l];this.objStart(h),this.line("/Title "+this.makeString(h.title)),this.line("/Parent "+this.makeRef(r)),l>0&&this.line("/Prev "+this.makeRef(r.children[l-1])),l<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[l+1])),h.children.length>0&&(this.line("/First "+this.makeRef(h.children[0])),this.line("/Last "+this.makeRef(h.children[h.children.length-1])));var i=this.count=this.count_r({count:0},h);if(i>0&&this.line("/Count "+i),h.options&&h.options.pageNumber){var y=n.internal.getPageInfo(h.options.pageNumber);this.line("/Dest ["+y.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var x=0;x<r.children.length;x++)this.renderItems(r.children[x])},n.outline.line=function(r){this.ctx.val+=r+`\r
`},n.outline.makeRef=function(r){return r.id+" 0 R"},n.outline.makeString=function(r){return"("+n.internal.pdfEscape(r)+")"},n.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(r,a){for(var l=0;l<a.children.length;l++)r.count++,this.count_r(r,a.children[l]);return r.count}}])}(Ci.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(n,r,a,l,h,i){var y,x=this.decode.DCT_DECODE,w=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=h||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,y=function(C){for(var P,E=256*C.charCodeAt(4)+C.charCodeAt(5),j=C.length,D={width:0,height:0,numcomponents:1},B=4;B<j;B+=2){if(B+=E,t.indexOf(C.charCodeAt(B+1))!==-1){P=256*C.charCodeAt(B+5)+C.charCodeAt(B+6),D={width:256*C.charCodeAt(B+7)+C.charCodeAt(B+8),height:P,numcomponents:C.charCodeAt(B+9)};break}E=256*C.charCodeAt(B+2)+C.charCodeAt(B+3)}return D}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n),y.numcomponents){case 1:i=this.color_spaces.DEVICE_GRAY;break;case 4:i=this.color_spaces.DEVICE_CMYK;break;case 3:i=this.color_spaces.DEVICE_RGB}w={data:n,width:y.width,height:y.height,colorSpace:i,bitsPerComponent:8,filter:x,index:r,alias:a}}return w}}(Ci.API),Ci.API.processPNG=function(e,t,n,r){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var a,l=SKe(e,{checkCrc:!0}),h=l.width,i=l.height,y=l.channels,x=l.palette,w=l.depth;a=x&&y===1?function(pe){for(var he=pe.width,we=pe.height,fe=pe.data,ge=pe.palette,Ce=pe.depth,xe=!1,Re=[],Qe=[],et=void 0,je=!1,De=0,Ct=0;Ct<ge.length;Ct++){var xt=hK(ge[Ct],4),me=xt[0],Ye=xt[1],nt=xt[2],vt=xt[3];Re.push(me,Ye,nt),vt!=null&&(vt===0?(De++,Qe.length<1&&Qe.push(Ct)):vt<255&&(je=!0))}if(je||De>1){xe=!0,Qe=void 0;var gt=he*we;et=new Uint8Array(gt);for(var dt=new DataView(fe.buffer),At=0;At<gt;At++){var mt=Y4(dt,At,Ce),Pt=hK(ge[mt],4)[3];et[At]=Pt}}else De===0&&(Qe=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:xe?8:void 0,colorBytes:fe,alphaBytes:et,needSMask:xe,palette:Re,mask:Qe}}(l):y===2||y===4?function(pe){for(var he=pe.data,we=pe.width,fe=pe.height,ge=pe.channels,Ce=pe.depth,xe=ge===2?"DeviceGray":"DeviceRGB",Re=ge-1,Qe=we*fe,et=Re,je=Qe*et,De=1*Qe,Ct=Math.ceil(je*Ce/8),xt=Math.ceil(De*Ce/8),me=new Uint8Array(Ct),Ye=new Uint8Array(xt),nt=new DataView(he.buffer),vt=new DataView(me.buffer),gt=new DataView(Ye.buffer),dt=!1,At=0;At<Qe;At++){for(var mt=At*ge,Pt=0;Pt<et;Pt++)EY(vt,Y4(nt,mt+Pt,Ce),At*et+Pt,Ce);var Ht=Y4(nt,mt+et,Ce);Ht<(1<<Ce)-1&&(dt=!0),EY(gt,Ht,1*At,Ce)}return{colorSpace:xe,colorsPerPixel:Re,sMaskBitsPerComponent:dt?Ce:void 0,colorBytes:me,alphaBytes:Ye,needSMask:dt}}(l):function(pe){var he=pe.data,we=pe.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:we,colorsPerPixel:we==="DeviceGray"?1:3,colorBytes:he instanceof Uint16Array?function(fe){for(var ge=fe.length,Ce=new Uint8Array(2*ge),xe=new DataView(Ce.buffer,Ce.byteOffset,Ce.byteLength),Re=0;Re<ge;Re++)xe.setUint16(2*Re,fe[Re],!1);return Ce}(he):he,needSMask:!1}}(l);var C,P,E,j=a,D=j.colorSpace,B=j.colorsPerPixel,F=j.sMaskBitsPerComponent,$=j.colorBytes,H=j.alphaBytes,J=j.needSMask,ee=j.palette,Q=j.mask,ne=null;return r!==Ci.API.image_compression.NONE&&typeof nO=="function"?(ne=function(pe){var he;switch(pe){case Ci.API.image_compression.FAST:he=11;break;case Ci.API.image_compression.MEDIUM:he=13;break;case Ci.API.image_compression.SLOW:he=14;break;default:he=12}return he}(r),C=this.decode.FLATE_DECODE,P="/Predictor ".concat(ne," /Colors ").concat(B," /BitsPerComponent ").concat(w," /Columns ").concat(h),e=wY($,Math.ceil(h*B*w/8),B,w,r),J&&(E=wY(H,Math.ceil(h*F/8),1,F,r))):(C=void 0,P=void 0,e=$,J&&(E=H)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(E&&this.__addimage__.isArrayBuffer(E)||this.__addimage__.isArrayBufferView(E))&&(E=this.__addimage__.arrayBufferToBinaryString(E)),{alias:n,data:e,index:t,filter:C,decodeParameters:P,transparency:Q,palette:ee,sMask:E,predictor:ne,width:h,height:i,bitsPerComponent:w,sMaskBitsPerComponent:F,colorSpace:D}}},function(e){e.processGIF89A=function(t,n,r,a){var l=new qKe(t),h=l.width,i=l.height,y=[];l.decodeAndBlitFrameRGBA(0,y);var x={data:y,width:h,height:i},w=new X4(100).encode(x,100);return e.processJPEG.call(this,w,n,r,a)},e.processGIF87A=e.processGIF89A}(Ci.API),ap.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:r,blue:n,quad:l}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ap.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(n){Ka.log("bit decode error:"+n)}},ap.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),n=t%4;for(e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var l=this.datav.getUint8(this.pos++,!0),h=r*this.width*4+8*a*4,i=0;i<8&&8*a+i<this.width;i++){var y=this.palette[l>>7-i&1];this.data[h+4*i]=y.blue,this.data[h+4*i+1]=y.green,this.data[h+4*i+2]=y.red,this.data[h+4*i+3]=255}n!==0&&(this.pos+=4-n)}},ap.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,a=0;a<e;a++){var l=this.datav.getUint8(this.pos++,!0),h=r*this.width*4+2*a*4,i=l>>4,y=15&l,x=this.palette[i];if(this.data[h]=x.blue,this.data[h+1]=x.green,this.data[h+2]=x.red,this.data[h+3]=255,2*a+1>=this.width)break;x=this.palette[y],this.data[h+4]=x.blue,this.data[h+4+1]=x.green,this.data[h+4+2]=x.red,this.data[h+4+3]=255}t!==0&&(this.pos+=4-t)}},ap.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),l=n*this.width*4+4*r;if(a<this.palette.length){var h=this.palette[a];this.data[l]=h.red,this.data[l+1]=h.green,this.data[l+2]=h.blue,this.data[l+3]=255}else this.data[l]=255,this.data[l+1]=255,this.data[l+2]=255,this.data[l+3]=255}e!==0&&(this.pos+=4-e)}},ap.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var h=(l&t)/t*255|0,i=(l>>5&t)/t*255|0,y=(l>>10&t)/t*255|0,x=l>>15?255:0,w=r*this.width*4+4*a;this.data[w]=y,this.data[w+1]=i,this.data[w+2]=h,this.data[w+3]=x}this.pos+=e}},ap.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,l=0;l<this.width;l++){var h=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(h&t)/t*255|0,y=(h>>5&n)/n*255|0,x=(h>>11)/t*255|0,w=a*this.width*4+4*l;this.data[w]=x,this.data[w+1]=y,this.data[w+2]=i,this.data[w+3]=255}this.pos+=e}},ap.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),h=t*this.width*4+4*n;this.data[h]=l,this.data[h+1]=a,this.data[h+2]=r,this.data[h+3]=255}this.pos+=this.width%4}},ap.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),h=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*n;this.data[i]=l,this.data[i+1]=a,this.data[i+2]=r,this.data[i+3]=h}},ap.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,n,r,a){var l=new ap(t,!1),h=l.width,i=l.height,y={data:l.getData(),width:h,height:i},x=new X4(100).encode(y,100);return e.processJPEG.call(this,x,n,r,a)}}(Ci.API),kY.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,n,r,a){var l=new kY(t),h=l.width,i=l.height,y={data:l.getData(),width:h,height:i},x=new X4(100).encode(y,100);return e.processJPEG.call(this,x,n,r,a)}}(Ci.API),Ci.API.processRGBA=function(e,t,n){for(var r=e.data,a=r.length,l=new Uint8Array(a/4*3),h=new Uint8Array(a/4),i=0,y=0,x=0;x<a;x+=4){var w=r[x],C=r[x+1],P=r[x+2],E=r[x+3];l[i++]=w,l[i++]=C,l[i++]=P,h[y++]=E}var j=this.__addimage__.arrayBufferToBinaryString(l);return{alpha:this.__addimage__.arrayBufferToBinaryString(h),data:j,index:t,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Ci.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},D1=Ci.API,kE=D1.getCharWidthsArray=function(e,t){var n,r,a=(t=t||{}).font||this.internal.getFont(),l=t.fontSize||this.internal.getFontSize(),h=t.charSpace||this.internal.getCharSpace(),i=t.widths?t.widths:a.metadata.Unicode.widths,y=i.fof?i.fof:1,x=t.kerning?t.kerning:a.metadata.Unicode.kerning,w=x.fof?x.fof:1,C=t.doKerning!==!1,P=0,E=e.length,j=0,D=i[0]||y,B=[];for(n=0;n<E;n++)r=e.charCodeAt(n),typeof a.metadata.widthOfString=="function"?B.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(r))+h*(1e3/l)||0)/1e3):(P=C&&Da(x[r])==="object"&&!isNaN(parseInt(x[r][j],10))?x[r][j]/w:0,B.push((i[r]||D)/y+P)),j=r;return B},_Y=D1.getStringUnitWidth=function(e,t){var n=(t=t||{}).fontSize||this.internal.getFontSize(),r=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return D1.processArabic&&(e=D1.processArabic(e)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(e,n,a)/n:kE.apply(this,arguments).reduce(function(l,h){return l+h},0)},xY=function(e,t,n,r){for(var a=[],l=0,h=e.length,i=0;l!==h&&i+t[l]<n;)i+=t[l],l++;a.push(e.slice(0,l));var y=l;for(i=0;l!==h;)i+t[l]>r&&(a.push(e.slice(y,l)),i=0,y=l),i+=t[l],l++;return y!==l&&a.push(e.slice(y,l)),a},bY=function(e,t,n){n||(n={});var r,a,l,h,i,y,x,w=[],C=[w],P=n.textIndent||0,E=0,j=0,D=e.split(" "),B=kE.apply(this,[" ",n])[0];if(y=n.lineIndent===-1?D[0].length+2:n.lineIndent||0){var F=Array(y).join(" "),$=[];D.map(function(J){(J=J.split(/\s*\n/)).length>1?$=$.concat(J.map(function(ee,Q){return(Q&&ee.length?`
`:"")+ee})):$.push(J[0])}),D=$,y=_Y.apply(this,[F,n])}for(l=0,h=D.length;l<h;l++){var H=0;if(r=D[l],y&&r[0]==`
`&&(r=r.substr(1),H=1),P+E+(j=(a=kE.apply(this,[r,n])).reduce(function(J,ee){return J+ee},0))>t||H){if(j>t){for(i=xY.apply(this,[r,a,t-(P+E),t]),w.push(i.shift()),w=[i.pop()];i.length;)C.push([i.shift()]);j=a.slice(r.length-(w[0]?w[0].length:0)).reduce(function(J,ee){return J+ee},0)}else w=[r];C.push(w),P=j+y,E=B}else w.push(r),P+=E+j,E=B}return x=y?function(J,ee){return(ee?F:"")+J.join(" ")}:function(J){return J.join(" ")},C.map(x)},D1.splitTextToSize=function(e,t,n){var r,a=(n=n||{}).fontSize||this.internal.getFontSize(),l=(function(w){if(w.widths&&w.kerning)return{widths:w.widths,kerning:w.kerning};var C=this.internal.getFont(w.fontName,w.fontStyle),P="Unicode";return C.metadata[P]?{widths:C.metadata[P].widths||{0:1},kerning:C.metadata[P].kerning||{}}:{font:C.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);r=Array.isArray(e)?e:String(e).split(/\r?\n/);var h=1*this.internal.scaleFactor*t/a;l.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/a:0,l.lineIndent=n.lineIndent;var i,y,x=[];for(i=0,y=r.length;i<y;i++)x=x.concat(bY.apply(this,[r[i],h,l]));return x},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",n="klmnopqrstuvwxyz",r={},a={},l=0;l<16;l++)r[n[l]]=t[l],a[t[l]]=n[l];var h=function(P){return"0x"+parseInt(P,10).toString(16)},i=e.__fontmetrics__.compress=function(P){var E,j,D,B,F=["{"];for(var $ in P){if(E=P[$],isNaN(parseInt($,10))?j="'"+$+"'":($=parseInt($,10),j=(j=h($).slice(2)).slice(0,-1)+a[j.slice(-1)]),typeof E=="number")E<0?(D=h(E).slice(3),B="-"):(D=h(E).slice(2),B=""),D=B+D.slice(0,-1)+a[D.slice(-1)];else{if(Da(E)!=="object")throw new Error("Don't know what to do with value type "+Da(E)+".");D=i(E)}F.push(j+D)}return F.push("}"),F.join("")},y=e.__fontmetrics__.uncompress=function(P){if(typeof P!="string")throw new Error("Invalid argument passed to uncompress.");for(var E,j,D,B,F={},$=1,H=F,J=[],ee="",Q="",ne=P.length-1,pe=1;pe<ne;pe+=1)(B=P[pe])=="'"?E?(D=E.join(""),E=void 0):E=[]:E?E.push(B):B=="{"?(J.push([H,D]),H={},D=void 0):B=="}"?((j=J.pop())[0][j[1]]=H,D=void 0,H=j[0]):B=="-"?$=-1:D===void 0?r.hasOwnProperty(B)?(ee+=r[B],D=parseInt(ee,16)*$,$=1,ee=""):ee+=B:r.hasOwnProperty(B)?(Q+=r[B],H[D]=parseInt(Q,16)*$,$=1,D=void 0,Q=""):Q+=B;return F},x={codePages:["WinAnsiEncoding"],WinAnsiEncoding:y("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},w={Unicode:{Courier:x,"Courier-Bold":x,"Courier-BoldOblique":x,"Courier-Oblique":x,Helvetica:x,"Helvetica-Bold":x,"Helvetica-BoldOblique":x,"Helvetica-Oblique":x,"Times-Roman":x,"Times-Bold":x,"Times-BoldItalic":x,"Times-Italic":x}},C={Unicode:{"Courier-Oblique":y("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":y("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":y("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:y("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":y("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":y("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:y("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:y("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":y("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:y("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":y("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":y("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":y("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":y("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(P){var E=P.font,j=C.Unicode[E.postScriptName];j&&(E.metadata.Unicode={},E.metadata.Unicode.widths=j.widths,E.metadata.Unicode.kerning=j.kerning);var D=w.Unicode[E.postScriptName];D&&(E.metadata.Unicode.encoding=D,E.encoding=D.codePages[0])}])}(Ci.API),function(e){var t=function(n){for(var r=n.length,a=new Uint8Array(r),l=0;l<r;l++)a[l]=n.charCodeAt(l);return a};e.API.events.push(["addFont",function(n){var r=void 0,a=n.font,l=n.instance;if(!a.isStandardFont){if(l===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(r=l.existsFileInVFS(a.postScriptName)===!1?l.loadFile(a.postScriptName):l.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(h,i){i=/^\x00\x01\x00\x00/.test(i)?t(i):t(lP(i)),h.metadata=e.API.TTFFont.open(i),h.metadata.Unicode=h.metadata.Unicode||{encoding:{},kerning:{},widths:[]},h.metadata.glyIdsUsed=[0]})(a,r)}}])}(Ci),Ci.API.addSvgAsImage=function(e,t,n,r,a,l,h,i){if(isNaN(t)||isNaN(n))throw Ka.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(a))throw Ka.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var y=document.createElement("canvas");y.width=r,y.height=a;var x=y.getContext("2d");x.fillStyle="#fff",x.fillRect(0,0,y.width,y.height);var w={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},C=this;return(Ji.canvg?Promise.resolve(Ji.canvg):A4(()=>import("./index.es-B7juLAus.js"),[])).catch(function(P){return Promise.reject(new Error("Could not load canvg: "+P))}).then(function(P){return P.default?P.default:P}).then(function(P){return P.fromString(x,e,w)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(P){return P.render(w)}).then(function(){C.addImage(y.toDataURL("image/jpeg",1),t,n,r,a,h,i)})},Ci.API.putTotalPages=function(e){var t,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),n=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var a=0;a<this.internal.pages[r].length;a++)this.internal.pages[r][a]=this.internal.pages[r][a].replace(t,n);return this},Ci.API.viewerPreferences=function(e,t){var n;e=e||{},t=t||!1;var r,a,l,h={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},i=Object.keys(h),y=[],x=0,w=0,C=0;function P(j,D){var B,F=!1;for(B=0;B<j.length;B+=1)j[B]===D&&(F=!0);return F}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(h)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var E=i.length;for(C=0;C<E;C+=1)n[i[C]].value=n[i[C]].defaultValue,n[i[C]].explicitSet=!1}if(Da(e)==="object"){for(a in e)if(l=e[a],P(i,a)&&l!==void 0){if(n[a].type==="boolean"&&typeof l=="boolean")n[a].value=l;else if(n[a].type==="name"&&P(n[a].valueSet,l))n[a].value=l;else if(n[a].type==="integer"&&Number.isInteger(l))n[a].value=l;else if(n[a].type==="array"){for(x=0;x<l.length;x+=1)if(r=!0,l[x].length===1&&typeof l[x][0]=="number")y.push(String(l[x]-1));else if(l[x].length>1){for(w=0;w<l[x].length;w+=1)typeof l[x][w]!="number"&&(r=!1);r===!0&&y.push([l[x][0]-1,l[x][1]-1].join(" "))}n[a].value="["+y.join(" ")+"]"}else n[a].value=n[a].defaultValue;n[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var j,D=[];for(j in n)n[j].explicitSet===!0&&(n[j].type==="name"?D.push("/"+j+" /"+n[j].value):D.push("/"+j+" "+n[j].value));D.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+D.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(e){var t=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),l=unescape(encodeURIComponent(r)),h=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),i=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),y=unescape(encodeURIComponent("</x:xmpmeta>")),x=l.length+h.length+i.length+a.length+y.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+x+" >>"),this.internal.write("stream"),this.internal.write(a+l+h+i+y),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(r,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",t)),this}}(Ci.API),function(e){var t=e.API,n=t.pdfEscape16=function(l,h){for(var i,y=h.metadata.Unicode.widths,x=["","0","00","000","0000"],w=[""],C=0,P=l.length;C<P;++C){if(i=h.metadata.characterToGlyph(l.charCodeAt(C)),h.metadata.glyIdsUsed.push(i),h.metadata.toUnicode[i]=l.charCodeAt(C),y.indexOf(i)==-1&&(y.push(i),y.push([parseInt(h.metadata.widthOfGlyph(i),10)])),i=="0")return w.join("");i=i.toString(16),w.push(x[4-i.length],i)}return w.join("")},r=function(l){var h,i,y,x,w,C,P;for(w=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,y=[],C=0,P=(i=Object.keys(l).sort(function(E,j){return E-j})).length;C<P;C++)h=i[C],y.length>=100&&(w+=`
`+y.length+` beginbfchar
`+y.join(`
`)+`
endbfchar`,y=[]),l[h]!==void 0&&l[h]!==null&&typeof l[h].toString=="function"&&(x=("0000"+l[h].toString(16)).slice(-4),h=("0000"+(+h).toString(16)).slice(-4),y.push("<"+h+"><"+x+">"));return y.length&&(w+=`
`+y.length+` beginbfchar
`+y.join(`
`)+`
endbfchar
`),w+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(l){(function(h){var i=h.font,y=h.out,x=h.newObject,w=h.putStream;if(i.metadata instanceof e.API.TTFFont&&i.encoding==="Identity-H"){for(var C=i.metadata.Unicode.widths,P=i.metadata.subset.encode(i.metadata.glyIdsUsed,1),E="",j=0;j<P.length;j++)E+=String.fromCharCode(P[j]);var D=x();w({data:E,addLength1:!0,objectId:D}),y("endobj");var B=x();w({data:r(i.metadata.toUnicode),addLength1:!0,objectId:B}),y("endobj");var F=x();y("<<"),y("/Type /FontDescriptor"),y("/FontName /"+F1(i.fontName)),y("/FontFile2 "+D+" 0 R"),y("/FontBBox "+e.API.PDFObject.convert(i.metadata.bbox)),y("/Flags "+i.metadata.flags),y("/StemV "+i.metadata.stemV),y("/ItalicAngle "+i.metadata.italicAngle),y("/Ascent "+i.metadata.ascender),y("/Descent "+i.metadata.decender),y("/CapHeight "+i.metadata.capHeight),y(">>"),y("endobj");var $=x();y("<<"),y("/Type /Font"),y("/BaseFont /"+F1(i.fontName)),y("/FontDescriptor "+F+" 0 R"),y("/W "+e.API.PDFObject.convert(C)),y("/CIDToGIDMap /Identity"),y("/DW 1000"),y("/Subtype /CIDFontType2"),y("/CIDSystemInfo"),y("<<"),y("/Supplement 0"),y("/Registry (Adobe)"),y("/Ordering ("+i.encoding+")"),y(">>"),y(">>"),y("endobj"),i.objectNumber=x(),y("<<"),y("/Type /Font"),y("/Subtype /Type0"),y("/ToUnicode "+B+" 0 R"),y("/BaseFont /"+F1(i.fontName)),y("/Encoding /"+i.encoding),y("/DescendantFonts ["+$+" 0 R]"),y(">>"),y("endobj"),i.isAlreadyPutted=!0}})(l)}]),t.events.push(["putFont",function(l){(function(h){var i=h.font,y=h.out,x=h.newObject,w=h.putStream;if(i.metadata instanceof e.API.TTFFont&&i.encoding==="WinAnsiEncoding"){for(var C=i.metadata.rawData,P="",E=0;E<C.length;E++)P+=String.fromCharCode(C[E]);var j=x();w({data:P,addLength1:!0,objectId:j}),y("endobj");var D=x();w({data:r(i.metadata.toUnicode),addLength1:!0,objectId:D}),y("endobj");var B=x();y("<<"),y("/Descent "+i.metadata.decender),y("/CapHeight "+i.metadata.capHeight),y("/StemV "+i.metadata.stemV),y("/Type /FontDescriptor"),y("/FontFile2 "+j+" 0 R"),y("/Flags 96"),y("/FontBBox "+e.API.PDFObject.convert(i.metadata.bbox)),y("/FontName /"+F1(i.fontName)),y("/ItalicAngle "+i.metadata.italicAngle),y("/Ascent "+i.metadata.ascender),y(">>"),y("endobj"),i.objectNumber=x();for(var F=0;F<i.metadata.hmtx.widths.length;F++)i.metadata.hmtx.widths[F]=parseInt(i.metadata.hmtx.widths[F]*(1e3/i.metadata.head.unitsPerEm));y("<</Subtype/TrueType/Type/Font/ToUnicode "+D+" 0 R/BaseFont/"+F1(i.fontName)+"/FontDescriptor "+B+" 0 R/Encoding/"+i.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(i.metadata.hmtx.widths)+">>"),y("endobj"),i.isAlreadyPutted=!0}})(l)}]);var a=function(l){var h,i=l.text||"",y=l.x,x=l.y,w=l.options||{},C=l.mutex||{},P=C.pdfEscape,E=C.activeFontKey,j=C.fonts,D=E,B="",F=0,$="",H=j[D].encoding;if(j[D].encoding!=="Identity-H")return{text:i,x:y,y:x,options:w,mutex:C};for($=i,D=E,Array.isArray(i)&&($=i[0]),F=0;F<$.length;F+=1)j[D].metadata.hasOwnProperty("cmap")&&(h=j[D].metadata.cmap.unicode.codeMap[$[F].charCodeAt(0)]),h||$[F].charCodeAt(0)<256&&j[D].metadata.hasOwnProperty("Unicode")?B+=$[F]:B+="";var J="";return parseInt(D.slice(1))<14||H==="WinAnsiEncoding"?J=P(B,D).split("").map(function(ee){return ee.charCodeAt(0).toString(16)}).join(""):H==="Identity-H"&&(J=n(B,j[D])),C.isHex=!0,{text:J,x:y,y:x,options:w,mutex:C}};t.events.push(["postProcessText",function(l){var h=l.text||"",i=[],y={text:h,x:l.x,y:l.y,options:l.options,mutex:l.mutex};if(Array.isArray(h)){var x=0;for(x=0;x<h.length;x+=1)Array.isArray(h[x])&&h[x].length===3?i.push([a(Object.assign({},y,{text:h[x][0]})).text,h[x][1],h[x][2]]):i.push(a(Object.assign({},y,{text:h[x]})).text);l.text=i}else l.text=a(Object.assign({},y,{text:h})).text}])}(Ci),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0},e.addFileToVFS=function(n,r){return t.call(this),this.internal.vFS[n]=r,this},e.getFileFromVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(Ci.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(r){var a,l,h,i,y,x,w,C=t,P=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],E=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],j={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},D={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},B=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],F=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),$=!1,H=0;this.__bidiEngine__={};var J=function(fe){var ge=fe.charCodeAt(),Ce=ge>>8,xe=D[Ce];return xe!==void 0?C[256*xe+(255&ge)]:Ce===252||Ce===253?"AL":F.test(Ce)?"L":Ce===8?"R":"N"},ee=function(fe){for(var ge,Ce=0;Ce<fe.length;Ce++){if((ge=J(fe.charAt(Ce)))==="L")return!1;if(ge==="R")return!0}return!1},Q=function(fe,ge,Ce,xe){var Re,Qe,et,je,De=ge[xe];switch(De){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":$=!1;break;case"N":case"AN":break;case"EN":$&&(De="AN");break;case"AL":$=!0,De="R";break;case"WS":case"BN":De="N";break;case"CS":xe<1||xe+1>=ge.length||(Re=Ce[xe-1])!=="EN"&&Re!=="AN"||(Qe=ge[xe+1])!=="EN"&&Qe!=="AN"?De="N":$&&(Qe="AN"),De=Qe===Re?Qe:"N";break;case"ES":De=(Re=xe>0?Ce[xe-1]:"B")==="EN"&&xe+1<ge.length&&ge[xe+1]==="EN"?"EN":"N";break;case"ET":if(xe>0&&Ce[xe-1]==="EN"){De="EN";break}if($){De="N";break}for(et=xe+1,je=ge.length;et<je&&ge[et]==="ET";)et++;De=et<je&&ge[et]==="EN"?"EN":"N";break;case"NSM":if(h&&!i){for(je=ge.length,et=xe+1;et<je&&ge[et]==="NSM";)et++;if(et<je){var Ct=fe[xe],xt=Ct>=1425&&Ct<=2303||Ct===64286;if(Re=ge[et],xt&&(Re==="R"||Re==="AL")){De="R";break}}}De=xe<1||(Re=ge[xe-1])==="B"?"N":Ce[xe-1];break;case"B":$=!1,a=!0,De=H;break;case"S":l=!0,De="N"}return De},ne=function(fe,ge,Ce){var xe=fe.split("");return Ce&&pe(xe,Ce,{hiLevel:H}),xe.reverse(),ge&&ge.reverse(),xe.join("")},pe=function(fe,ge,Ce){var xe,Re,Qe,et,je,De=-1,Ct=fe.length,xt=0,me=[],Ye=H?E:P,nt=[];for($=!1,a=!1,l=!1,Re=0;Re<Ct;Re++)nt[Re]=J(fe[Re]);for(Qe=0;Qe<Ct;Qe++){if(je=xt,me[Qe]=Q(fe,nt,me,Qe),xe=240&(xt=Ye[je][j[me[Qe]]]),xt&=15,ge[Qe]=et=Ye[xt][5],xe>0)if(xe===16){for(Re=De;Re<Qe;Re++)ge[Re]=1;De=-1}else De=-1;if(Ye[xt][6])De===-1&&(De=Qe);else if(De>-1){for(Re=De;Re<Qe;Re++)ge[Re]=et;De=-1}nt[Qe]==="B"&&(ge[Qe]=0),Ce.hiLevel|=et}l&&function(vt,gt,dt){for(var At=0;At<dt;At++)if(vt[At]==="S"){gt[At]=H;for(var mt=At-1;mt>=0&&vt[mt]==="WS";mt--)gt[mt]=H}}(nt,ge,Ct)},he=function(fe,ge,Ce,xe,Re){if(!(Re.hiLevel<fe)){if(fe===1&&H===1&&!a)return ge.reverse(),void(Ce&&Ce.reverse());for(var Qe,et,je,De,Ct=ge.length,xt=0;xt<Ct;){if(xe[xt]>=fe){for(je=xt+1;je<Ct&&xe[je]>=fe;)je++;for(De=xt,et=je-1;De<et;De++,et--)Qe=ge[De],ge[De]=ge[et],ge[et]=Qe,Ce&&(Qe=Ce[De],Ce[De]=Ce[et],Ce[et]=Qe);xt=je}xt++}}},we=function(fe,ge,Ce){var xe=fe.split(""),Re={hiLevel:H};return Ce||(Ce=[]),pe(xe,Ce,Re),function(Qe,et,je){if(je.hiLevel!==0&&w)for(var De,Ct=0;Ct<Qe.length;Ct++)et[Ct]===1&&(De=B.indexOf(Qe[Ct]))>=0&&(Qe[Ct]=B[De+1])}(xe,Ce,Re),he(2,xe,ge,Ce,Re),he(1,xe,ge,Ce,Re),xe.join("")};return this.__bidiEngine__.doBidiReorder=function(fe,ge,Ce){if(function(Re,Qe){if(Qe)for(var et=0;et<Re.length;et++)Qe[et]=et;i===void 0&&(i=ee(Re)),x===void 0&&(x=ee(Re))}(fe,ge),h||!y||x)if(h&&y&&i^x)H=i?1:0,fe=ne(fe,ge,Ce);else if(!h&&y&&x)H=i?1:0,fe=we(fe,ge,Ce),fe=ne(fe,ge);else if(!h||i||y||x){if(h&&!y&&i^x)fe=ne(fe,ge),i?(H=0,fe=we(fe,ge,Ce)):(H=1,fe=we(fe,ge,Ce),fe=ne(fe,ge));else if(h&&i&&!y&&x)H=1,fe=we(fe,ge,Ce),fe=ne(fe,ge);else if(!h&&!y&&i^x){var xe=w;i?(H=1,fe=we(fe,ge,Ce),H=0,w=!1,fe=we(fe,ge,Ce),w=xe):(H=0,fe=we(fe,ge,Ce),fe=ne(fe,ge),H=1,w=!1,fe=we(fe,ge,Ce),w=xe,fe=ne(fe,ge))}}else H=0,fe=we(fe,ge,Ce);else H=i?1:0,fe=we(fe,ge,Ce);return fe},this.__bidiEngine__.setOptions=function(fe){fe&&(h=fe.isInputVisual,y=fe.isOutputVisual,i=fe.isInputRtl,x=fe.isOutputRtl,w=fe.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(r){var a=r.text;r.x,r.y;var l=r.options||{};r.mutex,l.lang;var h=[];if(l.isInputVisual=typeof l.isInputVisual!="boolean"||l.isInputVisual,n.setOptions(l),Object.prototype.toString.call(a)==="[object Array]"){var i=0;for(h=[],i=0;i<a.length;i+=1)Object.prototype.toString.call(a[i])==="[object Array]"?h.push([n.doBidiReorder(a[i][0]),a[i][1],a[i][2]]):h.push([n.doBidiReorder(a[i])]);r.text=h}else r.text=n.doBidiReorder(a);n.setOptions({isInputVisual:!0})}])}(Ci),Ci.API.TTFFont=function(){function e(t){var n;if(this.rawData=t,n=this.contents=new _v(t),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new sYe(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new GKe(this.contents),this.head=new WKe(this),this.name=new JKe(this),this.cmap=new Khe(this),this.toUnicode={},this.hhea=new ZKe(this),this.maxp=new QKe(this),this.hmtx=new eYe(this),this.post=new YKe(this),this.os2=new KKe(this),this.loca=new iYe(this),this.glyf=new tYe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,n,r,a,l;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var h,i,y,x;for(x=[],h=0,i=(y=this.bbox).length;h<i;h++)t=y[h],x.push(Math.round(t*this.scaleFactor));return x}).call(this),this.stemV=0,this.post.exists?(r=255&(a=this.post.italic_angle),32768&(n=a>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(l=this.familyClass)===1||l===2||l===3||l===4||l===5||l===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var n;return((n=this.cmap.unicode)!=null?n.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*n},e.prototype.widthOfString=function(t,n,r){var a,l,h,i;for(h=0,l=0,i=(t=""+t).length;0<=i?l<i:l>i;l=0<=i?++l:--l)a=t.charCodeAt(l),h+=this.widthOfGlyph(this.characterToGlyph(a))+r*(1e3/n)||0;return h*(n/1e3)},e.prototype.lineHeight=function(t,n){var r;return n==null&&(n=!1),r=n?this.lineGap:0,(this.ascender+r-this.decender)/1e3*t},e}();var Dp,_v=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var n,r;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r[n]=String.fromCharCode(this.readByte());return r.join("")},e.prototype.writeString=function(t){var n,r,a;for(a=[],n=0,r=t.length;0<=r?n<r:n>r;n=0<=r?++n:--n)a.push(this.writeByte(t.charCodeAt(n)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,n,r,a,l,h,i,y;return t=this.readByte(),n=this.readByte(),r=this.readByte(),a=this.readByte(),l=this.readByte(),h=this.readByte(),i=this.readByte(),y=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^n)+1099511627776*(255^r)+4294967296*(255^a)+16777216*(255^l)+65536*(255^h)+256*(255^i)+(255^y)+1):72057594037927940*t+281474976710656*n+1099511627776*r+4294967296*a+16777216*l+65536*h+256*i+y},e.prototype.writeLongLong=function(t){var n,r;return n=Math.floor(t/4294967296),r=4294967295&t,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var n,r;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n.push(this.readByte());return n},e.prototype.write=function(t){var n,r,a,l;for(l=[],r=0,a=t.length;r<a;r++)n=t[r],l.push(this.writeByte(n));return l},e}(),GKe=function(){var e;function t(n){var r,a,l;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},a=0,l=this.tableCount;0<=l?a<l:a>l;a=0<=l?++a:--a)r={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[r.tag]=r}return t.prototype.encode=function(n){var r,a,l,h,i,y,x,w,C,P,E,j,D;for(D in E=Object.keys(n).length,y=Math.log(2),C=16*Math.floor(Math.log(E)/y),h=Math.floor(C/y),w=16*E-C,(a=new _v).writeInt(this.scalarType),a.writeShort(E),a.writeShort(C),a.writeShort(h),a.writeShort(w),l=16*E,x=a.pos+l,i=null,j=[],n)for(P=n[D],a.writeString(D),a.writeInt(e(P)),a.writeInt(x),a.writeInt(P.length),j=j.concat(P),D==="head"&&(i=x),x+=P.length;x%4;)j.push(0),x++;return a.write(j),r=2981146554-e(a.data),a.pos=i+8,a.writeUInt32(r),a.data},e=function(n){var r,a,l,h;for(n=Yhe.call(n);n.length%4;)n.push(0);for(l=new _v(n),a=0,r=0,h=n.length;r<h;r=r+=4)a+=l.readUInt32();return 4294967295&a},t}(),HKe={}.hasOwnProperty,Jm=function(e,t){for(var n in t)HKe.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};Dp=function(){function e(t){var n;this.file=t,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var WKe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Jm(e,Dp),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var n;return(n=new _v).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(t),n.writeShort(this.glyphDataFormat),n.data},e}(),IY=function(){function e(t,n){var r,a,l,h,i,y,x,w,C,P,E,j,D,B,F,$,H;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=n+t.readInt(),C=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(y=0;y<256;++y)this.codeMap[y]=t.readByte();break;case 4:for(E=t.readUInt16(),P=E/2,t.pos+=6,l=function(){var J,ee;for(ee=[],y=J=0;0<=P?J<P:J>P;y=0<=P?++J:--J)ee.push(t.readUInt16());return ee}(),t.pos+=2,D=function(){var J,ee;for(ee=[],y=J=0;0<=P?J<P:J>P;y=0<=P?++J:--J)ee.push(t.readUInt16());return ee}(),x=function(){var J,ee;for(ee=[],y=J=0;0<=P?J<P:J>P;y=0<=P?++J:--J)ee.push(t.readUInt16());return ee}(),w=function(){var J,ee;for(ee=[],y=J=0;0<=P?J<P:J>P;y=0<=P?++J:--J)ee.push(t.readUInt16());return ee}(),a=(this.length-t.pos+this.offset)/2,i=function(){var J,ee;for(ee=[],y=J=0;0<=a?J<a:J>a;y=0<=a?++J:--J)ee.push(t.readUInt16());return ee}(),y=F=0,H=l.length;F<H;y=++F)for(B=l[y],r=$=j=D[y];j<=B?$<=B:$>=B;r=j<=B?++$:--$)w[y]===0?h=r+x[y]:(h=i[w[y]/2+(r-j)-(P-y)]||0)!==0&&(h+=x[y]),this.codeMap[r]=65535&h}t.pos=C}return e.encode=function(t,n){var r,a,l,h,i,y,x,w,C,P,E,j,D,B,F,$,H,J,ee,Q,ne,pe,he,we,fe,ge,Ce,xe,Re,Qe,et,je,De,Ct,xt,me,Ye,nt,vt,gt,dt,At,mt,Pt,Ht,Ot;switch(xe=new _v,h=Object.keys(t).sort(function(Un,Kt){return Un-Kt}),n){case"macroman":for(D=0,B=function(){var Un=[];for(j=0;j<256;++j)Un.push(0);return Un}(),$={0:0},l={},Re=0,De=h.length;Re<De;Re++)$[mt=t[a=h[Re]]]==null&&($[mt]=++D),l[a]={old:t[a],new:$[t[a]]},B[a]=$[t[a]];return xe.writeUInt16(1),xe.writeUInt16(0),xe.writeUInt32(12),xe.writeUInt16(0),xe.writeUInt16(262),xe.writeUInt16(0),xe.write(B),{charMap:l,subtable:xe.data,maxGlyphID:D+1};case"unicode":for(ge=[],C=[],H=0,$={},r={},F=x=null,Qe=0,Ct=h.length;Qe<Ct;Qe++)$[ee=t[a=h[Qe]]]==null&&($[ee]=++H),r[a]={old:ee,new:$[ee]},i=$[ee]-a,F!=null&&i===x||(F&&C.push(F),ge.push(a),x=i),F=a;for(F&&C.push(F),C.push(65535),ge.push(65535),we=2*(he=ge.length),pe=2*Math.pow(Math.log(he)/Math.LN2,2),P=Math.log(pe/2)/Math.LN2,ne=2*he-pe,y=[],Q=[],E=[],j=et=0,xt=ge.length;et<xt;j=++et){if(fe=ge[j],w=C[j],fe===65535){y.push(0),Q.push(0);break}if(fe-(Ce=r[fe].new)>=32768)for(y.push(0),Q.push(2*(E.length+he-j)),a=je=fe;fe<=w?je<=w:je>=w;a=fe<=w?++je:--je)E.push(r[a].new);else y.push(Ce-fe),Q.push(0)}for(xe.writeUInt16(3),xe.writeUInt16(1),xe.writeUInt32(12),xe.writeUInt16(4),xe.writeUInt16(16+8*he+2*E.length),xe.writeUInt16(0),xe.writeUInt16(we),xe.writeUInt16(pe),xe.writeUInt16(P),xe.writeUInt16(ne),dt=0,me=C.length;dt<me;dt++)a=C[dt],xe.writeUInt16(a);for(xe.writeUInt16(0),At=0,Ye=ge.length;At<Ye;At++)a=ge[At],xe.writeUInt16(a);for(Pt=0,nt=y.length;Pt<nt;Pt++)i=y[Pt],xe.writeUInt16(i);for(Ht=0,vt=Q.length;Ht<vt;Ht++)J=Q[Ht],xe.writeUInt16(J);for(Ot=0,gt=E.length;Ot<gt;Ot++)D=E[Ot],xe.writeUInt16(D);return{charMap:r,subtable:xe.data,maxGlyphID:H+1}}},e}(),Khe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Jm(e,Dp),e.prototype.tag="cmap",e.prototype.parse=function(t){var n,r,a;for(t.pos=this.offset,this.version=t.readUInt16(),a=t.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=a?r<a:r>a;r=0<=a?++r:--r)n=new IY(t,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(t,n){var r,a;return n==null&&(n="macroman"),r=IY.encode(t,n),(a=new _v).writeUInt16(0),a.writeUInt16(1),r.table=a.data.concat(r.subtable),r},e}(),ZKe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Jm(e,Dp),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),KKe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Jm(e,Dp),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var n,r;for(r=[],n=0;n<10;++n)r.push(t.readByte());return r}(),this.charRange=function(){var n,r;for(r=[],n=0;n<4;++n)r.push(t.readInt());return r}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var n,r;for(r=[],n=0;n<2;n=++n)r.push(t.readInt());return r}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),YKe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Jm(e,Dp),e.prototype.tag="post",e.prototype.parse=function(t){var n,r,a;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var l;for(r=t.readUInt16(),this.glyphNameIndex=[],l=0;0<=r?l<r:l>r;l=0<=r?++l:--l)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],a=[];t.pos<this.offset+this.length;)n=t.readByte(),a.push(this.names.push(t.readString(n)));return a;case 151552:return r=t.readUInt16(),this.offsets=t.read(r);case 262144:return this.map=(function(){var h,i,y;for(y=[],l=h=0,i=this.file.maxp.numGlyphs;0<=i?h<i:h>i;l=0<=i?++h:--h)y.push(t.readUInt32());return y}).call(this)}},e}(),XKe=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},JKe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Jm(e,Dp),e.prototype.tag="name",e.prototype.parse=function(t){var n,r,a,l,h,i,y,x,w,C,P;for(t.pos=this.offset,t.readShort(),n=t.readShort(),i=t.readShort(),r=[],l=0;0<=n?l<n:l>n;l=0<=n?++l:--l)r.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+i+t.readShort()});for(y={},l=w=0,C=r.length;w<C;l=++w)a=r[l],t.pos=a.offset,x=t.readString(a.length),h=new XKe(x,a),y[P=a.nameID]==null&&(y[P]=[]),y[a.nameID].push(h);this.strings=y,this.copyright=y[0],this.fontFamily=y[1],this.fontSubfamily=y[2],this.uniqueSubfamily=y[3],this.fontName=y[4],this.version=y[5];try{this.postscriptName=y[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=y[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=y[7],this.manufacturer=y[8],this.designer=y[9],this.description=y[10],this.vendorUrl=y[11],this.designerUrl=y[12],this.license=y[13],this.licenseUrl=y[14],this.preferredFamily=y[15],this.preferredSubfamily=y[17],this.compatibleFull=y[18],this.sampleText=y[19]},e}(),QKe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Jm(e,Dp),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),eYe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Jm(e,Dp),e.prototype.tag="hmtx",e.prototype.parse=function(t){var n,r,a,l,h,i,y;for(t.pos=this.offset,this.metrics=[],n=0,i=this.file.hhea.numberOfMetrics;0<=i?n<i:n>i;n=0<=i?++n:--n)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var x,w;for(w=[],n=x=0;0<=a?x<a:x>a;n=0<=a?++x:--x)w.push(t.readInt16());return w}(),this.widths=(function(){var x,w,C,P;for(P=[],x=0,w=(C=this.metrics).length;x<w;x++)l=C[x],P.push(l.advance);return P}).call(this),r=this.widths[this.widths.length-1],y=[],n=h=0;0<=a?h<a:h>a;n=0<=a?++h:--h)y.push(this.widths.push(r));return y},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),Yhe=[].slice,tYe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Jm(e,Dp),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var n,r,a,l,h,i,y,x,w,C;return t in this.cache?this.cache[t]:(l=this.file.loca,n=this.file.contents,r=l.indexOf(t),(a=l.lengthOf(t))===0?this.cache[t]=null:(n.pos=this.offset+r,h=(i=new _v(n.read(a))).readShort(),x=i.readShort(),C=i.readShort(),y=i.readShort(),w=i.readShort(),this.cache[t]=h===-1?new rYe(i,x,C,y,w):new nYe(i,h,x,C,y,w),this.cache[t]))},e.prototype.encode=function(t,n,r){var a,l,h,i,y;for(h=[],l=[],i=0,y=n.length;i<y;i++)a=t[n[i]],l.push(h.length),a&&(h=h.concat(a.encode(r)));return l.push(h.length),{table:h,offsets:l}},e}(),nYe=function(){function e(t,n,r,a,l,h){this.raw=t,this.numberOfContours=n,this.xMin=r,this.yMin=a,this.xMax=l,this.yMax=h,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),rYe=function(){function e(t,n,r,a,l){var h,i;for(this.raw=t,this.xMin=n,this.yMin=r,this.xMax=a,this.yMax=l,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],h=this.raw;i=h.readShort(),this.glyphOffsets.push(h.pos),this.glyphIDs.push(h.readUInt16()),32&i;)h.pos+=1&i?4:2,128&i?h.pos+=8:64&i?h.pos+=4:8&i&&(h.pos+=2)}return e.prototype.encode=function(){var t,n,r;for(n=new _v(Yhe.call(this.raw.data)),t=0,r=this.glyphIDs.length;t<r;++t)n.pos=this.glyphOffsets[t];return n.data},e}(),iYe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Jm(e,Dp),e.prototype.tag="loca",e.prototype.parse=function(t){var n,r;return t.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var a,l;for(l=[],r=0,a=this.length;r<a;r+=2)l.push(2*t.readUInt16());return l}).call(this):(function(){var a,l;for(l=[],r=0,a=this.length;r<a;r+=4)l.push(t.readUInt32());return l}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,n){for(var r=new Uint32Array(this.offsets.length),a=0,l=0,h=0;h<r.length;++h)if(r[h]=a,l<n.length&&n[l]==h){++l,r[h]=a;var i=this.offsets[h],y=this.offsets[h+1]-i;y>0&&(a+=y)}for(var x=new Array(4*r.length),w=0;w<r.length;++w)x[4*w+3]=255&r[w],x[4*w+2]=(65280&r[w])>>8,x[4*w+1]=(16711680&r[w])>>16,x[4*w]=(4278190080&r[w])>>24;return x},e}(),sYe=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,n,r,a,l;for(n in a=this.font.cmap.tables[0].codeMap,t={},l=this.subset)r=l[n],t[n]=a[r];return t},e.prototype.glyphsFor=function(t){var n,r,a,l,h,i,y;for(a={},h=0,i=t.length;h<i;h++)a[l=t[h]]=this.font.glyf.glyphFor(l);for(l in n=[],a)(r=a[l])!=null&&r.compound&&n.push.apply(n,r.glyphIDs);if(n.length>0)for(l in y=this.glyphsFor(n))r=y[l],a[l]=r;return a},e.prototype.encode=function(t,n){var r,a,l,h,i,y,x,w,C,P,E,j,D,B,F;for(a in r=Khe.encode(this.generateCmap(),"unicode"),h=this.glyphsFor(t),E={0:0},F=r.charMap)E[(y=F[a]).old]=y.new;for(j in P=r.maxGlyphID,h)j in E||(E[j]=P++);return w=function($){var H,J;for(H in J={},$)J[$[H]]=H;return J}(E),C=Object.keys(w).sort(function($,H){return $-H}),D=function(){var $,H,J;for(J=[],$=0,H=C.length;$<H;$++)i=C[$],J.push(w[i]);return J}(),l=this.font.glyf.encode(h,D,E),x=this.font.loca.encode(l.offsets,D),B={cmap:this.font.cmap.raw(),glyf:l.table,loca:x,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(B["OS/2"]=this.font.os2.raw()),this.font.directory.encode(B)},e}();Ci.API.PDFObject=function(){var e;function t(){}return e=function(n,r){return(Array(r+1).join("0")+n).slice(-r)},t.convert=function(n){var r,a,l,h;if(Array.isArray(n))return"["+function(){var i,y,x;for(x=[],i=0,y=n.length;i<y;i++)r=n[i],x.push(t.convert(r));return x}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+e(n.getUTCFullYear(),4)+e(n.getUTCMonth(),2)+e(n.getUTCDate(),2)+e(n.getUTCHours(),2)+e(n.getUTCMinutes(),2)+e(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(a in l=["<<"],n)h=n[a],l.push("/"+a+" "+t.convert(h));return l.push(">>"),l.join(`
`)}return""+n},t}();const Xhe=L.forwardRef(({className:e,...t},n)=>v.jsx("div",{className:"relative w-full overflow-auto",children:v.jsx("table",{ref:n,className:Xn("w-full caption-bottom text-sm",e),...t})}));Xhe.displayName="Table";const Jhe=L.forwardRef(({className:e,...t},n)=>v.jsx("thead",{ref:n,className:Xn("[&_tr]:border-b",e),...t}));Jhe.displayName="TableHeader";const Qhe=L.forwardRef(({className:e,...t},n)=>v.jsx("tbody",{ref:n,className:Xn("[&_tr:last-child]:border-0",e),...t}));Qhe.displayName="TableBody";const aYe=L.forwardRef(({className:e,...t},n)=>v.jsx("tfoot",{ref:n,className:Xn("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));aYe.displayName="TableFooter";const fP=L.forwardRef(({className:e,...t},n)=>v.jsx("tr",{ref:n,className:Xn("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",e),...t}));fP.displayName="TableRow";const z1=L.forwardRef(({className:e,...t},n)=>v.jsx("th",{ref:n,className:Xn("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));z1.displayName="TableHead";const A_=L.forwardRef(({className:e,...t},n)=>v.jsx("td",{ref:n,className:Xn("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));A_.displayName="TableCell";const oYe=L.forwardRef(({className:e,...t},n)=>v.jsx("caption",{ref:n,className:Xn("mt-4 text-sm text-muted-foreground",e),...t}));oYe.displayName="TableCaption";const lYe=e=>{const t=e.toLowerCase();return t.includes("netflix")?{icon:"",bgColor:"bg-red-500",textColor:"text-white"}:t.includes("starbucks")||t.includes("starbucks coffee")?{icon:"",bgColor:"bg-green-600",textColor:"text-white"}:t.includes("amazon")?{icon:"",bgColor:"bg-orange-500",textColor:"text-white"}:t.includes("mcdonald")||t.includes("mcdonalds")?{icon:"",bgColor:"bg-yellow-500",textColor:"text-white"}:t.includes("uber")||t.includes("lyft")?{icon:"",bgColor:"bg-black",textColor:"text-white"}:t.includes("spotify")?{icon:"",bgColor:"bg-green-500",textColor:"text-white"}:t.includes("apple")||t.includes("app store")?{icon:"",bgColor:"bg-gray-800",textColor:"text-white"}:t.includes("google")||t.includes("google play")?{icon:"",bgColor:"bg-blue-500",textColor:"text-white"}:t.includes("shell")||t.includes("gas")?{icon:"",bgColor:"bg-yellow-400",textColor:"text-black"}:t.includes("target")?{icon:"",bgColor:"bg-red-600",textColor:"text-white"}:t.includes("walmart")?{icon:"",bgColor:"bg-blue-600",textColor:"text-white"}:t.includes("kroger")?{icon:"",bgColor:"bg-red-700",textColor:"text-white"}:t.includes("taco bell")||t.includes("tacobell")?{icon:"",bgColor:"bg-purple-600",textColor:"text-white"}:t.includes("subway")?{icon:"",bgColor:"bg-green-600",textColor:"text-white"}:t.includes("kfc")||t.includes("kentucky fried chicken")?{icon:"",bgColor:"bg-red-600",textColor:"text-white"}:t.includes("pizza hut")||t.includes("pizzahut")?{icon:"",bgColor:"bg-red-500",textColor:"text-white"}:t.includes("domino")||t.includes("dominos")?{icon:"",bgColor:"bg-blue-600",textColor:"text-white"}:t.includes("chipotle")?{icon:"",bgColor:"bg-orange-600",textColor:"text-white"}:t.includes("panera")||t.includes("panera bread")?{icon:"",bgColor:"bg-yellow-600",textColor:"text-white"}:t.includes("chick-fil-a")||t.includes("chickfila")?{icon:"",bgColor:"bg-red-500",textColor:"text-white"}:t.includes("wendy")?{icon:"",bgColor:"bg-red-600",textColor:"text-white"}:t.includes("burger king")||t.includes("burgerking")?{icon:"",bgColor:"bg-yellow-500",textColor:"text-black"}:t.includes("whole foods")||t.includes("wholefoods")?{icon:"",bgColor:"bg-green-600",textColor:"text-white"}:t.includes("safeway")?{icon:"",bgColor:"bg-red-600",textColor:"text-white"}:t.includes("costco")?{icon:"",bgColor:"bg-red-500",textColor:"text-white"}:t.includes("trader joe")||t.includes("traderjoe")?{icon:"",bgColor:"bg-green-500",textColor:"text-white"}:t.includes("exxon")||t.includes("mobil")?{icon:"",bgColor:"bg-red-600",textColor:"text-white"}:t.includes("bp")||t.includes("british petroleum")?{icon:"",bgColor:"bg-green-600",textColor:"text-white"}:t.includes("chevron")?{icon:"",bgColor:"bg-blue-600",textColor:"text-white"}:t.includes("hulu")?{icon:"",bgColor:"bg-green-500",textColor:"text-white"}:t.includes("disney")||t.includes("disney+")?{icon:"",bgColor:"bg-blue-600",textColor:"text-white"}:t.includes("hbo")||t.includes("max")?{icon:"",bgColor:"bg-purple-600",textColor:"text-white"}:t.includes("youtube")||t.includes("youtube premium")?{icon:"",bgColor:"bg-red-600",textColor:"text-white"}:t.includes("delta")?{icon:"",bgColor:"bg-blue-600",textColor:"text-white"}:t.includes("american airlines")||t.includes("americanairlines")?{icon:"",bgColor:"bg-blue-500",textColor:"text-white"}:t.includes("southwest")?{icon:"",bgColor:"bg-orange-500",textColor:"text-white"}:t.includes("amtrak")?{icon:"",bgColor:"bg-blue-700",textColor:"text-white"}:t.includes("best buy")||t.includes("bestbuy")?{icon:"",bgColor:"bg-yellow-500",textColor:"text-black"}:t.includes("home depot")||t.includes("homedepot")?{icon:"",bgColor:"bg-orange-600",textColor:"text-white"}:t.includes("lowes")?{icon:"",bgColor:"bg-blue-600",textColor:"text-white"}:t.includes("ikea")?{icon:"",bgColor:"bg-yellow-500",textColor:"text-black"}:t.includes("nike")?{icon:"",bgColor:"bg-black",textColor:"text-white"}:t.includes("adidas")?{icon:"",bgColor:"bg-black",textColor:"text-white"}:t.includes("regal")||t.includes("regal cinemas")?{icon:"",bgColor:"bg-blue-700",textColor:"text-white"}:t.includes("amc")||t.includes("amc theaters")?{icon:"",bgColor:"bg-red-700",textColor:"text-white"}:t.includes("cinemark")?{icon:"",bgColor:"bg-indigo-700",textColor:"text-white"}:t.includes("imax")?{icon:"",bgColor:"bg-purple-700",textColor:"text-white"}:t.includes("virginia tech")||t.includes("vt")||t.includes("vtech")?{icon:"",bgColor:"bg-orange-700",textColor:"text-white"}:t.includes("university")||t.includes("college")||t.includes("school")?{icon:"",bgColor:"bg-blue-800",textColor:"text-white"}:t.includes("library")?{icon:"",bgColor:"bg-yellow-700",textColor:"text-white"}:t.includes("bookstore")||t.includes("campus store")?{icon:"",bgColor:"bg-green-700",textColor:"text-white"}:t.includes("dining hall")||t.includes("cafeteria")||t.includes("dining commons")?{icon:"",bgColor:"bg-orange-600",textColor:"text-white"}:t.includes("electric")||t.includes("power")||t.includes("energy")||t.includes("duke energy")||t.includes("dominion")?{icon:"",bgColor:"bg-yellow-500",textColor:"text-black"}:t.includes("water")||t.includes("sewer")?{icon:"",bgColor:"bg-blue-500",textColor:"text-white"}:t.includes("gas")||t.includes("natural gas")?{icon:"",bgColor:"bg-orange-500",textColor:"text-white"}:t.includes("internet")||t.includes("wifi")||t.includes("comcast")||t.includes("verizon")?{icon:"",bgColor:"bg-blue-600",textColor:"text-white"}:t.includes("phone")||t.includes("cellular")||t.includes("at&t")||t.includes("t-mobile")?{icon:"",bgColor:"bg-purple-600",textColor:"text-white"}:null},cYe=[{id:"1",merchant:"Starbucks Coffee",amount:5.47,date:"2024-01-15",category:"Food & Dining",icon:vF,status:"completed",location:"Main St, Blacksburg"},{id:"2",merchant:"Amazon",amount:129.99,date:"2024-01-14",category:"Shopping",icon:S5,status:"completed",location:"Online"},{id:"3",merchant:"Shell Gas Station",amount:45.2,date:"2024-01-14",category:"Transportation",icon:gF,status:"completed",location:"University Blvd"},{id:"4",merchant:"Electric Company",amount:156.78,date:"2024-01-13",category:"Utilities",icon:_F,status:"completed",location:"Monthly Bill"},{id:"5",merchant:"McDonald's",amount:12.34,date:"2024-01-13",category:"Food & Dining",icon:VQ,status:"completed",location:"South Main St"}],J4=[{name:"Food & Dining",value:486,color:Qu("Food & Dining")},{name:"Shopping",value:329,color:Qu("Shopping")},{name:"Transportation",value:245,color:Qu("Transportation")},{name:"Utilities",value:187,color:Qu("Utilities")},{name:"Entertainment",value:156,color:Qu("Entertainment")}];function uYe(){var D,B,F,$,H,J,ee,Q;const[e,t]=L.useState(""),[n,r]=L.useState("all"),[a,l]=L.useState(!1),h=cYe.filter(ne=>{const pe=ne.merchant.toLowerCase().includes(e.toLowerCase())||ne.category.toLowerCase().includes(e.toLowerCase())||ne.location.toLowerCase().includes(e.toLowerCase()),he=n==="all"||ne.category===n;return pe&&he}),i=h.reduce((ne,pe)=>{var we;const he=ne.find(fe=>fe.name===pe.category);return he?he.value+=pe.amount:ne.push({name:pe.category,value:pe.amount,color:((we=J4.find(fe=>fe.name===pe.category))==null?void 0:we.color)||"#6B7280"}),ne},[]);console.log("Category data:",J4);const[y,x]=L.useState({merchant:"",amount:"",category:"Food & Dining"}),[w,C]=L.useState(null),P=ZSe(),E=async()=>{if(!(!y.merchant||!y.amount))try{const ne=await P.mutateAsync({merchant:y.merchant,amount:parseFloat(y.amount),category:y.category});C(ne.data)}catch(ne){console.error("Simulation failed:",ne)}},j=async()=>{l(!0);try{const ne=new Ci("p","mm","a4"),pe=ne.internal.pageSize.getWidth(),he=ne.internal.pageSize.getHeight();let we=20;const fe=xt=>we+xt>he-20?(ne.addPage(),we=20,!0):!1,ge=xt=>{ne.setLineWidth(.5),ne.setDrawColor(200,200,200),ne.line(20,xt,pe-20,xt)};ne.setFontSize(24),ne.setFont("helvetica","bold"),ne.setTextColor(50,50,50),ne.text("Transaction Report",20,we),we+=15,ne.setFontSize(10),ne.setFont("helvetica","normal"),ne.setTextColor(100,100,100);const Ce=new Date().toLocaleDateString(),xe=new Date().toLocaleTimeString();ne.text(`Generated on ${Ce} at ${xe}`,20,we),we+=20,ne.setFontSize(16),ne.setFont("helvetica","bold"),ne.setTextColor(50,50,50),ne.text("Summary",20,we),we+=10,ge(we),we+=5;const Re=h.reduce((xt,me)=>xt+me.amount,0),Qe=h.reduce((xt,me)=>(xt[me.category]=(xt[me.category]||0)+me.amount,xt),{});ne.setFontSize(12),ne.setFont("helvetica","normal"),ne.text(`Total Transactions: ${h.length}`,20,we),we+=8,ne.text(`Total Amount: $${Re.toFixed(2)}`,20,we),we+=8,ne.text(`Average Transaction: $${h.length>0?(Re/h.length).toFixed(2):"0.00"}`,20,we),we+=15,ne.setFontSize(14),ne.setFont("helvetica","bold"),ne.text("Spending by Category",20,we),we+=10,ge(we),we+=5,Object.entries(Qe).forEach(([xt,me])=>{we>he-30&&(ne.addPage(),we=20),ne.setFontSize(10),ne.setFont("helvetica","normal"),ne.text(`${xt}: $${me.toFixed(2)}`,20,we),we+=6}),we+=10,fe(30)&&(we=20),ne.setFontSize(16),ne.setFont("helvetica","bold"),ne.text("Transaction Details",20,we),we+=10,ge(we),we+=5,ne.setFontSize(10),ne.setFont("helvetica","bold"),ne.setTextColor(50,50,50);const et=[60,40,30,30,30],je=[20,80,120,150,180],De=["Merchant","Category","Amount","Date","Status"];De.forEach((xt,me)=>{ne.text(xt,je[me],we)}),we+=8,ge(we),we+=5,ne.setFont("helvetica","normal"),ne.setFontSize(9),h.forEach(xt=>{fe(15)&&(we=20,ne.setFont("helvetica","bold"),ne.setFontSize(10),De.forEach((nt,vt)=>{ne.text(nt,je[vt],we)}),we+=8,ge(we),we+=5,ne.setFont("helvetica","normal"),ne.setFontSize(9));const me=xt.merchant.length>20?xt.merchant.substring(0,17)+"...":xt.merchant;ne.text(me,je[0],we),ne.text(xt.category,je[1],we),ne.text(`$${xt.amount.toFixed(2)}`,je[2],we);const Ye=new Date(xt.date).toLocaleDateString();ne.text(Ye,je[3],we),ne.text("Completed",je[4],we),we+=6}),we=he-20,ne.setFontSize(8),ne.setFont("helvetica","normal"),ne.setTextColor(150,150,150),ne.text("Generated by MoneyLens - Financial Tracking System",20,we);const Ct=new Date().toISOString().split("T")[0];ne.save(`transactions-report-${Ct}.pdf`)}catch(ne){console.error("Export failed:",ne)}finally{l(!1)}};return v.jsxs(ol.div,{className:"h-full min-h-screen space-y-6 p-6",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("h1",{className:"text-3xl font-bold",children:"Transactions"}),v.jsx("p",{className:"text-muted-foreground",children:"Manage and simulate your financial transactions"})]}),v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsxs($n,{variant:"outline",onClick:j,disabled:a,children:[v.jsx(D3,{className:"w-4 h-4 mr-2"}),a?"Exporting...":"Export"]}),v.jsxs($n,{children:[v.jsx(Yb,{className:"w-4 h-4 mr-2"}),"Simulate Transaction"]})]})]}),v.jsx(xr,{className:"card-gradient",children:v.jsx(br,{className:"p-6",children:v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsxs("div",{className:"relative flex-1 max-w-md",children:[v.jsx(gb,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),v.jsx(ss,{placeholder:"Search transactions...",value:e,onChange:ne=>t(ne.target.value),className:"pl-10"})]}),v.jsxs($n,{variant:"outline",size:"sm",children:[v.jsx(exe,{className:"w-4 h-4 mr-2"}),"Filters"]}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx(Is,{variant:n==="all"?"default":"outline",className:"cursor-pointer",onClick:()=>r("all"),children:"All"}),J4.map(ne=>v.jsx(Is,{variant:n===ne.name?"default":"outline",className:"cursor-pointer",onClick:()=>r(ne.name),children:ne.name},ne.name))]})]})})}),v.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[v.jsx("div",{className:"lg:col-span-2",children:v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsx(di,{children:"Recent Transactions"})}),v.jsx(br,{children:v.jsxs(Xhe,{children:[v.jsx(Jhe,{children:v.jsxs(fP,{children:[v.jsx(z1,{children:"Merchant"}),v.jsx(z1,{children:"Category"}),v.jsx(z1,{children:"Amount"}),v.jsx(z1,{children:"Date"}),v.jsx(z1,{children:"Status"})]})}),v.jsx(Qhe,{children:h.length===0?v.jsx(fP,{children:v.jsx(A_,{colSpan:5,className:"text-center py-8",children:v.jsxs("div",{className:"flex flex-col items-center gap-2",children:[v.jsx("div",{className:"w-12 h-12 rounded-full bg-muted/20 flex items-center justify-center",children:v.jsx(gb,{className:"w-6 h-6 text-muted-foreground"})}),v.jsx("p",{className:"text-muted-foreground",children:"No transactions found"}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"Try adjusting your search or filter criteria"})]})})}):h.map(ne=>{const pe=lYe(ne.merchant),he=ne.icon;return v.jsxs(fP,{className:"hover:bg-muted/20",children:[v.jsx(A_,{children:v.jsxs("div",{className:"flex items-center gap-3",children:[pe?v.jsx("div",{className:`p-2 rounded-lg ${pe.bgColor} ${pe.textColor} flex items-center justify-center w-8 h-8`,children:v.jsx("span",{className:"text-lg",children:pe.icon})}):v.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:v.jsx(he,{className:"w-4 h-4 text-primary"})}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium",children:ne.merchant}),v.jsx("p",{className:"text-xs text-muted-foreground",children:ne.location})]})]})}),v.jsx(A_,{children:v.jsx(Is,{variant:"outline",children:ne.category})}),v.jsxs(A_,{className:"font-semibold",children:["$",ne.amount.toFixed(2)]}),v.jsx(A_,{className:"text-muted-foreground",children:new Date(ne.date).toLocaleDateString()}),v.jsx(A_,{children:v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(wl,{className:"w-4 h-4 text-success"}),v.jsx("span",{className:"text-sm text-success",children:"Completed"})]})})]},ne.id)})})]})})]})}),v.jsxs("div",{className:"space-y-6",children:[v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(cx,{className:"w-5 h-5"}),"Transaction Simulator"]})}),v.jsxs(br,{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"text-sm font-medium",children:"Merchant"}),v.jsx(ss,{placeholder:"Enter merchant name...",value:y.merchant,onChange:ne=>x({...y,merchant:ne.target.value})})]}),v.jsxs("div",{children:[v.jsx("label",{className:"text-sm font-medium",children:"Amount"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground",children:"$"}),v.jsx(ss,{placeholder:"0.00",className:"pl-8",type:"number",step:"0.01",value:y.amount,onChange:ne=>x({...y,amount:ne.target.value})})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"text-sm font-medium",children:"Category"}),v.jsxs("select",{className:"w-full p-2 border border-input rounded-md bg-background",value:y.category,onChange:ne=>x({...y,category:ne.target.value}),children:[v.jsx("option",{value:"Food & Dining",children:"Food & Dining"}),v.jsx("option",{value:"Shopping",children:"Shopping"}),v.jsx("option",{value:"Transportation",children:"Transportation"}),v.jsx("option",{value:"Utilities",children:"Utilities"}),v.jsx("option",{value:"Entertainment",children:"Entertainment"}),v.jsx("option",{value:"Healthcare",children:"Healthcare"}),v.jsx("option",{value:"Education",children:"Education"})]})]}),v.jsxs($n,{className:"w-full",onClick:E,disabled:P.isPending||!y.merchant||!y.amount,children:[P.isPending?v.jsx(J0,{className:"w-4 h-4 mr-2 animate-spin"}):v.jsx(cx,{className:"w-4 h-4 mr-2"}),"Simulate Transaction"]}),v.jsxs("div",{className:"mt-4",children:[v.jsx("h4",{className:"text-sm font-medium mb-2",children:"Spending by Category"}),v.jsx("div",{className:"h-[150px] w-full flex items-center justify-center",children:i.length===0?v.jsxs("div",{className:"flex flex-col items-center gap-2 text-muted-foreground",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-muted/20 flex items-center justify-center",children:v.jsx(gb,{className:"w-4 h-4"})}),v.jsx("p",{className:"text-xs",children:"No data available"})]}):v.jsxs(zue,{width:150,height:150,children:[v.jsx(HB,{data:i,cx:75,cy:75,innerRadius:30,outerRadius:60,paddingAngle:2,dataKey:"value",children:i.map((ne,pe)=>v.jsx(Kg,{fill:ne.color},`cell-${pe}`))}),v.jsx(Ku,{animationDuration:0,isAnimationActive:!1})]})}),v.jsx("div",{className:"space-y-1 mt-2",children:i.slice(0,3).map(ne=>v.jsxs("div",{className:"flex items-center justify-between text-xs",children:[v.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[v.jsx("div",{className:"w-2 h-2 rounded-sm flex-shrink-0",style:{backgroundColor:ne.color}}),v.jsx("span",{className:"truncate",children:ne.name})]}),v.jsxs("span",{className:"font-semibold ml-2 flex-shrink-0",children:["$",ne.value]})]},ne.name))})]}),w&&v.jsxs("div",{className:"space-y-3",children:[w.wouldBeApproved?v.jsxs(wp,{className:"border-green-200 bg-green-50",children:[v.jsx(wl,{className:"h-4 w-4 text-green-600"}),v.jsxs(Sp,{className:"text-green-800",children:[v.jsx("strong",{children:" Transaction would be approved"}),((D=w.warnings)==null?void 0:D.length)>0&&v.jsxs("p",{className:"text-sm mt-1",children:[" With ",w.warnings.length," warning(s)"]})]})]}):v.jsxs(wp,{className:"border-red-200 bg-red-50",children:[v.jsx(mb,{className:"h-4 w-4 text-red-600"}),v.jsxs(Sp,{className:"text-red-800",children:[v.jsx("strong",{children:" Transaction would be rejected"}),v.jsxs("p",{className:"text-sm mt-1",children:[(B=w.violations)==null?void 0:B.length," violation(s) found"]})]})]}),((F=w.violations)==null?void 0:F.length)>0&&v.jsxs("div",{className:"space-y-2",children:[v.jsx("h4",{className:"text-sm font-medium text-red-700",children:"Violations:"}),w.violations.map((ne,pe)=>{var he,we;return v.jsxs("div",{className:"p-2 bg-red-50 border border-red-200 rounded text-sm",children:[v.jsx("div",{className:"font-medium text-red-800",children:ne.name}),v.jsxs("div",{className:"text-red-600",children:["Would exceed by $",(he=ne.wouldExceed)==null?void 0:he.toFixed(2),"(",(we=ne.percentage)==null?void 0:we.toFixed(1),"% of limit)"]})]},pe)})]}),(($=w.warnings)==null?void 0:$.length)>0&&v.jsxs("div",{className:"space-y-2",children:[v.jsx("h4",{className:"text-sm font-medium text-yellow-700",children:"Warnings:"}),w.warnings.map((ne,pe)=>{var he;return v.jsxs("div",{className:"p-2 bg-yellow-50 border border-yellow-200 rounded text-sm",children:[v.jsx("div",{className:"font-medium text-yellow-800",children:ne.name}),v.jsxs("div",{className:"text-yellow-600",children:[(he=ne.percentage)==null?void 0:he.toFixed(1),"% of limit used"]})]},pe)})]}),v.jsxs("div",{className:"p-3 bg-muted/20 rounded-lg text-sm",children:[v.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[v.jsxs("div",{children:[v.jsx("span",{className:"text-muted-foreground",children:"Current Spending:"}),v.jsxs("div",{className:"font-medium",children:["$",(H=w.currentSpending)==null?void 0:H.toFixed(2)]})]}),v.jsxs("div",{children:[v.jsx("span",{className:"text-muted-foreground",children:"After Transaction:"}),v.jsxs("div",{className:"font-medium",children:["$",(J=w.wouldSpend)==null?void 0:J.toFixed(2)]})]})]}),w.monthlyBudget&&v.jsxs("div",{className:"mt-2 pt-2 border-t",children:[v.jsx("span",{className:"text-muted-foreground",children:"Monthly Budget:"}),v.jsxs("div",{className:"font-medium",children:["$",w.monthlyBudget.toFixed(2)]})]})]}),v.jsxs("div",{className:"mt-4",children:[v.jsx("h4",{className:"text-sm font-medium mb-2",children:"Quick Stats"}),v.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[v.jsxs("div",{className:"p-2 bg-muted/20 rounded text-center",children:[v.jsxs("div",{className:"font-semibold text-primary",children:["$",(ee=w.currentSpending)==null?void 0:ee.toFixed(0)]}),v.jsx("div",{className:"text-muted-foreground",children:"Current"})]}),v.jsxs("div",{className:"p-2 bg-muted/20 rounded text-center",children:[v.jsxs("div",{className:"font-semibold text-primary",children:["$",(Q=w.wouldSpend)==null?void 0:Q.toFixed(0)]}),v.jsx("div",{className:"text-muted-foreground",children:"After"})]}),v.jsxs("div",{className:"p-2 bg-muted/20 rounded text-center",children:[v.jsx("div",{className:"font-semibold text-primary",children:i.length}),v.jsx("div",{className:"text-muted-foreground",children:"Categories"})]}),v.jsxs("div",{className:"p-2 bg-muted/20 rounded text-center",children:[v.jsx("div",{className:"font-semibold text-primary",children:w.monthlyBudget?(w.wouldSpend/w.monthlyBudget*100).toFixed(0)+"%":"N/A"}),v.jsx("div",{className:"text-muted-foreground",children:"Budget Used"})]})]})]})]})]})]}),v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsx(di,{children:"Quick Stats"})}),v.jsxs(br,{className:"space-y-3",children:[v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-sm",children:"Total Transactions"}),v.jsx("span",{className:"font-semibold",children:"247"})]}),v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-sm",children:"Average Transaction"}),v.jsx("span",{className:"font-semibold",children:"$45.67"})]}),v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-sm",children:"Top Merchant"}),v.jsx("span",{className:"font-semibold",children:"Starbucks"})]}),v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-sm",children:"This Month"}),v.jsx("span",{className:"font-semibold",children:"$2,847"})]})]})]})]})]})]})}const Q4=[{value:"bar",label:"Bar Chart",icon:Kb},{value:"pie",label:"Pie Chart",icon:W_e},{value:"line",label:"Line Chart",icon:Ju},{value:"area",label:"Area Chart",icon:H_e}],dYe=[{value:"7",label:"Last 7 days"},{value:"30",label:"Last 30 days"},{value:"90",label:"Last 3 months"},{value:"180",label:"Last 6 months"},{value:"365",label:"Last year"}],hYe=["Dining","Shopping","Transport","Entertainment","Utilities","Healthcare","Education","Travel","Other"];function fYe({className:e}){var Ce;const[t,n]=L.useState({chartType:"bar",categories:["Dining","Shopping","Transport","Entertainment","Utilities","Healthcare"],period:"30",title:"Spending Analysis"}),[r,a]=L.useState([]),[l,h]=L.useState(!1),[i,y]=L.useState(!1),[x,w]=L.useState(null),[C,P]=L.useState(!1),[E,j]=L.useState([]),[D,B]=L.useState([]),{data:F,isLoading:$}=nAe(t.period),{data:H,isLoading:J}=tAe(t.period),ee=(xe,Re,Qe)=>{const et=[];if(xe.length===0)return et;const je=xe.reduce((me,Ye)=>me+Ye.value,0),De=xe.reduce((me,Ye)=>Ye.value>me.value?Ye:me,xe[0]);if(je/xe.length,xe.length>1){const Ye=[...xe].sort((vt,gt)=>gt.value-vt.value).slice(0,2),nt=(Ye[0].value/je*100).toFixed(0);et.push({type:"summary",title:"Spending Breakdown",description:`Your ${Ye[0].name} spending represents ${nt}% of total expenses, followed by ${Ye[1].name} at ${(Ye[1].value/je*100).toFixed(0)}%.`,icon:Q_e,color:"text-blue-600"})}const Ct=parseInt(Qe),xt=je/Ct;return xt>50?et.push({type:"trend",title:"High Spending Alert",description:`You're averaging $${xt.toFixed(2)} per day over the last ${Ct} days. Consider reviewing your spending patterns.`,icon:Ju,color:"text-orange-600"}):xt<20&&et.push({type:"trend",title:"Conservative Spending",description:`Great job! You're maintaining a healthy spending average of $${xt.toFixed(2)} per day.`,icon:SF,color:"text-green-600"}),De.value>je*.4&&et.push({type:"summary",title:"Category Focus",description:`${De.name} dominates your spending at ${(De.value/je*100).toFixed(0)}%. Consider diversifying your expenses.`,icon:CA,color:"text-purple-600"}),et},Q=xe=>{const Re=[];if(xe.length<3)return Re;const Qe=xe.map(xt=>xt.value),et=Qe.reduce((xt,me)=>xt+me,0)/Qe.length,je=Qe.reduce((xt,me)=>xt+Math.pow(me-et,2),0)/Qe.length,De=Math.sqrt(je),Ct=et+2*De;return xe.forEach(xt=>{if(xt.value>Ct){const me=(xt.value-et)/et*100;Re.push({category:xt.name,amount:xt.value,date:new Date().toISOString().split("T")[0],deviation:Math.round(me),description:`Unusual spike detected: ${xt.name} spending is ${Math.round(me)}% above average`})}}),Re};L.useEffect(()=>{if(r.length>0){const xe=ee(r,t.categories,t.period),Re=Q(r);j(xe),B(Re)}},[r,t.categories,t.period]);const ne=(xe,Re,Qe)=>{if(xe.length===0)return null;xe.reduce((Ct,xt)=>Ct+xt.value,0);const et=Qe!=="7"&&xe.length>3,je=Re.length>1&&Re.length<=5;return Re.length>=3&&Re.length>=3?"pie":et&&Re.length<=3?"line":je&&Re.length<=4?"bar":et&&Re.length>3?"area":"bar"};L.useEffect(()=>{if(r.length>0){const xe=ne(r,t.categories,t.period);w(xe),P(!0)}},[r,t.categories,t.period]);const pe=()=>{h(!0);try{let xe=[];t.chartType==="pie"||t.chartType==="bar"?F&&(xe=F.filter(Re=>t.categories.includes(Re.category)).map(Re=>({name:Re.category,value:Re.amount,color:Re.color}))):H&&(xe=H.filter(Re=>t.categories.includes(Re.category)).map(Re=>({name:Re.category,value:Re.amount,color:Qu(Re.category)}))),a(xe)}catch(xe){console.error("Error generating visualization:",xe)}finally{h(!1)}};L.useEffect(()=>{t.categories.length>0&&(F||H)&&pe()},[t,F,H]);const he=()=>{if(r.length===0)return v.jsx("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:v.jsxs("div",{className:"text-center",children:[v.jsx(kA,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),v.jsx("p",{className:"text-sm",children:"Select categories to generate visualization"})]})});const xe=r.reduce((Re,Qe)=>(Re[Qe.name.toLowerCase()]={label:Qe.name,color:Qe.color||Qu(Qe.name)},Re),{});switch(t.chartType){case"bar":return v.jsx(Zu,{config:xe,className:"h-[300px] w-full",children:v.jsxs(DS,{data:r,children:[v.jsx(Od,{dataKey:"name"}),v.jsx(Fd,{}),v.jsx(Ku,{content:v.jsx(gh,{}),animationDuration:0,isAnimationActive:!1}),v.jsx(Nd,{dataKey:"value",fill:"#3B82F6"})]})});case"pie":return v.jsx(Zu,{config:xe,className:"h-[300px] w-full",children:v.jsxs(zue,{children:[v.jsx(HB,{data:r,cx:"50%",cy:"50%",outerRadius:100,dataKey:"value",label:({name:Re,percent:Qe})=>`${Re} ${(Qe*100).toFixed(0)}%`,children:r.map((Re,Qe)=>v.jsx(Kg,{fill:Re.color},`cell-${Qe}`))}),v.jsx(Ku,{content:v.jsx(gh,{}),animationDuration:0,isAnimationActive:!1})]})});case"line":return v.jsx(Zu,{config:xe,className:"h-[300px] w-full",children:v.jsxs(Fue,{data:r,children:[v.jsx(Od,{dataKey:"name"}),v.jsx(Fd,{}),v.jsx(Ku,{content:v.jsx(gh,{}),animationDuration:0,isAnimationActive:!1}),v.jsx(cN,{type:"monotone",dataKey:"value",stroke:"#3B82F6",strokeWidth:2})]})});case"area":return v.jsx(Zu,{config:xe,className:"h-[300px] w-full",children:v.jsxs(RS,{data:r,children:[v.jsx(Od,{dataKey:"name"}),v.jsx(Fd,{}),v.jsx(Ku,{content:v.jsx(gh,{}),animationDuration:0,isAnimationActive:!1}),v.jsx(jo,{type:"monotone",dataKey:"value",stroke:"#3B82F6",fill:"#3B82F6",fillOpacity:.6})]})});default:return null}},we=xe=>{n(Re=>({...Re,categories:Re.categories.includes(xe)?Re.categories.filter(Qe=>Qe!==xe):[...Re.categories,xe]}))},fe=()=>{x&&(n(xe=>({...xe,chartType:x})),P(!1))},ge=()=>{console.log("Download chart functionality")};return v.jsx(ol.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:e,children:v.jsxs(xr,{className:"card-gradient border-2 border-primary/20",children:[v.jsx(ui,{className:"pb-4",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(kA,{className:"w-5 h-5 text-primary"}),"Auto Visualization Agent"]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs($n,{variant:"outline",size:"sm",onClick:()=>y(!i),children:[v.jsx(xF,{className:"w-4 h-4"}),i?"Hide":"Configure"]}),v.jsxs($n,{variant:"outline",size:"sm",onClick:pe,disabled:l,children:[v.jsx(J1,{className:`w-4 h-4 ${l?"animate-spin":""}`}),l?"Generating...":"Refresh"]}),v.jsxs($n,{variant:"outline",size:"sm",onClick:ge,children:[v.jsx(D3,{className:"w-4 h-4"}),"Export"]})]})]})}),v.jsxs(br,{className:"space-y-6",children:[i&&v.jsxs(ol.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4 p-4 bg-muted/50 rounded-lg",children:[v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{children:"Chart Type"}),v.jsxs(Ep,{value:t.chartType,onValueChange:xe=>n(Re=>({...Re,chartType:xe})),children:[v.jsx(Af,{children:v.jsx(Pp,{})}),v.jsx(Tf,{children:Q4.map(xe=>v.jsx(So,{value:xe.value,children:v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(xe.icon,{className:"w-4 h-4"}),xe.label]})},xe.value))})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{children:"Time Period"}),v.jsxs(Ep,{value:t.period,onValueChange:xe=>n(Re=>({...Re,period:xe})),children:[v.jsx(Af,{children:v.jsx(Pp,{})}),v.jsx(Tf,{children:dYe.map(xe=>v.jsx(So,{value:xe.value,children:xe.label},xe.value))})]})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{children:"Categories"}),v.jsx("div",{className:"flex flex-wrap gap-2",children:hYe.map(xe=>v.jsx(Is,{variant:t.categories.includes(xe)?"default":"outline",className:"cursor-pointer hover:bg-primary/10",onClick:()=>we(xe),children:xe},xe))})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{children:"Chart Title"}),v.jsx(ss,{value:t.title,onChange:xe=>n(Re=>({...Re,title:xe.target.value})),placeholder:"Enter custom chart title"})]})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("h3",{className:"text-lg font-semibold",children:t.title}),v.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[v.jsx(RQ,{className:"w-4 h-4"}),r.length," categories"]})]}),he()]}),E.length>0&&v.jsxs(ol.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"space-y-2",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[v.jsx(pb,{className:"w-4 h-4 text-primary"}),v.jsx("h4",{className:"text-sm font-semibold",children:"AI Insights"})]}),v.jsx("div",{className:"space-y-2",children:E.map((xe,Re)=>v.jsx(ol.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:Re*.05},className:"border-blue-800 bg-blue-900/20 hover:border-white hover:ring-2 hover:ring-white rounded-lg p-3 transition-all duration-200",children:v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(xe.icon,{className:`w-4 h-4 ${xe.color}`}),v.jsxs("span",{className:"text-sm font-medium text-blue-100",children:[xe.title,":"]}),v.jsx("span",{className:"text-sm text-blue-200",children:xe.description})]})},Re))})]}),D.length>0&&v.jsxs(ol.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"space-y-2",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[v.jsx(Os,{className:"w-4 h-4 text-orange-500"}),v.jsx("h4",{className:"text-sm font-semibold",children:"Anomalies"}),v.jsx(Is,{variant:"destructive",className:"text-xs",children:D.length})]}),v.jsx("div",{className:"space-y-2",children:D.map((xe,Re)=>v.jsx(ol.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:Re*.05},className:"border-orange-800 bg-orange-900/20 hover:border-white hover:ring-2 hover:ring-white rounded-lg p-3 transition-all duration-200",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(Os,{className:"w-4 h-4 text-orange-400"}),v.jsxs("span",{className:"text-sm font-medium text-orange-100",children:[xe.category," +",xe.deviation,"%"]})]}),v.jsxs("div",{className:"flex items-center gap-2 text-xs text-orange-200",children:[v.jsxs("span",{children:["$",xe.amount.toFixed(2)]}),v.jsx("span",{children:""}),v.jsx("span",{children:xe.date})]})]})},Re))})]}),C&&x&&x!==t.chartType&&v.jsx(ol.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"border-blue-800 bg-blue-900/20 hover:border-white hover:ring-2 hover:ring-white rounded-lg p-3 transition-all duration-200",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(pb,{className:"w-4 h-4 text-blue-400"}),v.jsxs("span",{className:"text-sm font-medium text-blue-100",children:["Try ",(Ce=Q4.find(xe=>xe.value===x))==null?void 0:Ce.label,"?"]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs($n,{size:"sm",onClick:fe,className:"h-7 px-3 bg-blue-600 hover:bg-blue-700 text-white text-xs",children:[v.jsx(AF,{className:"w-3 h-3 mr-1"}),"Apply"]}),v.jsx($n,{size:"sm",variant:"ghost",onClick:()=>P(!1),className:"h-7 px-2 text-blue-300 hover:text-blue-100 hover:bg-blue-800/30",children:""})]})]})}),v.jsxs("div",{className:"flex items-center gap-1 pt-4 border-t",children:[v.jsx("span",{className:"text-sm text-muted-foreground mr-2",children:"Chart:"}),Q4.map(xe=>v.jsxs($n,{variant:t.chartType===xe.value?"default":"ghost",size:"sm",onClick:()=>n(Re=>({...Re,chartType:xe.value})),className:`h-8 px-3 text-xs ${t.chartType===xe.value?"bg-primary text-primary-foreground":"hover:bg-muted"}`,children:[v.jsx(xe.icon,{className:"w-3 h-3 mr-1"}),xe.label]},xe.value)),x&&x!==t.chartType&&v.jsxs($n,{variant:"outline",size:"sm",onClick:()=>n(xe=>({...xe,chartType:x})),className:"h-8 px-3 text-xs border-blue-800 bg-blue-900/20 text-blue-100 hover:border-white hover:ring-2 hover:ring-white hover:bg-blue-800/30",children:[v.jsx(pb,{className:"w-3 h-3 mr-1"}),"Smart"]})]})]})]})})}function g_({shortDescription:e,longDescription:t,insights:n=[],className:r=""}){const[a,l]=L.useState(!1);return v.jsx(xr,{className:`mt-4 border-primary/20 bg-gradient-to-r from-primary/5 to-primary/10 ${r}`,children:v.jsx(br,{className:"p-4",children:v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:v.jsx(kA,{className:"w-4 h-4 text-primary"})}),v.jsxs("div",{className:"flex-1",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[v.jsx("h4",{className:"font-semibold text-primary text-sm",children:"AI Analysis"}),v.jsx($n,{variant:"ghost",size:"sm",onClick:()=>l(!a),className:"h-6 px-2 text-xs text-primary hover:bg-primary/10",children:a?v.jsxs(v.Fragment,{children:[v.jsx("span",{className:"mr-1",children:"Less"}),v.jsx(DQ,{className:"w-3 h-3"})]}):v.jsxs(v.Fragment,{children:[v.jsx("span",{className:"mr-1",children:"More"}),v.jsx(yF,{className:"w-3 h-3"})]})})]}),v.jsx("p",{className:"text-sm text-foreground mb-2",children:e}),v.jsx(une,{children:a&&v.jsx(ol.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"overflow-hidden",children:v.jsxs("div",{className:"border-t border-primary/20 pt-3",children:[v.jsx("p",{className:"text-sm text-foreground mb-3",children:t}),n.length>0&&v.jsxs("div",{className:"space-y-2",children:[v.jsx("h5",{className:"font-medium text-sm text-primary",children:"Key Insights:"}),v.jsx("ul",{className:"space-y-1",children:n.map((h,i)=>v.jsxs("li",{className:"text-xs text-foreground flex items-start gap-2",children:[v.jsx("span",{className:"text-primary mt-1",children:""}),v.jsx("span",{children:h})]},i))})]})]})})})]})]})})})}const pYe=()=>{const e=[],t=new Date("2024-01-01"),n=new Date("2024-06-30"),r=[{name:"Starbucks",category:"Dining",frequency:.15,avgAmount:8.5,locations:["Downtown","Mall","Airport"]},{name:"McDonald's",category:"Dining",frequency:.12,avgAmount:12.3,locations:["Highway","Mall"]},{name:"Chipotle",category:"Dining",frequency:.08,avgAmount:14.75,locations:["Downtown","Mall"]},{name:"Subway",category:"Dining",frequency:.06,avgAmount:9.25,locations:["Downtown","Mall"]},{name:"Pizza Hut",category:"Dining",frequency:.05,avgAmount:18.9,locations:["Downtown"]},{name:"Local Restaurant",category:"Dining",frequency:.04,avgAmount:35,locations:["Downtown"]},{name:"Amazon",category:"Shopping",frequency:.2,avgAmount:45,locations:["Online"]},{name:"Target",category:"Shopping",frequency:.08,avgAmount:65,locations:["Mall","Downtown"]},{name:"Walmart",category:"Shopping",frequency:.06,avgAmount:55,locations:["Highway"]},{name:"Best Buy",category:"Shopping",frequency:.03,avgAmount:120,locations:["Mall"]},{name:"Nike",category:"Shopping",frequency:.02,avgAmount:85,locations:["Mall"]},{name:"Shell",category:"Transport",frequency:.1,avgAmount:35,locations:["Highway","Downtown"]},{name:"Exxon",category:"Transport",frequency:.08,avgAmount:32,locations:["Highway"]},{name:"Uber",category:"Transport",frequency:.05,avgAmount:15.5,locations:["Downtown","Airport"]},{name:"Lyft",category:"Transport",frequency:.04,avgAmount:16,locations:["Downtown"]},{name:"Parking Garage",category:"Transport",frequency:.03,avgAmount:8,locations:["Downtown"]},{name:"Electric Company",category:"Utilities",frequency:.02,avgAmount:120,locations:["Online"]},{name:"Water Company",category:"Utilities",frequency:.02,avgAmount:45,locations:["Online"]},{name:"Internet Provider",category:"Utilities",frequency:.02,avgAmount:65,locations:["Online"]},{name:"Phone Company",category:"Utilities",frequency:.02,avgAmount:85,locations:["Online"]},{name:"CVS Pharmacy",category:"Healthcare",frequency:.03,avgAmount:25,locations:["Downtown","Mall"]},{name:"Walgreens",category:"Healthcare",frequency:.02,avgAmount:22,locations:["Downtown"]},{name:"Doctor's Office",category:"Healthcare",frequency:.01,avgAmount:150,locations:["Downtown"]},{name:"Netflix",category:"Entertainment",frequency:.02,avgAmount:15.99,locations:["Online"]},{name:"Spotify",category:"Entertainment",frequency:.02,avgAmount:9.99,locations:["Online"]},{name:"Movie Theater",category:"Entertainment",frequency:.01,avgAmount:25,locations:["Mall"]},{name:"Whole Foods",category:"Groceries",frequency:.08,avgAmount:85,locations:["Downtown"]},{name:"Kroger",category:"Groceries",frequency:.06,avgAmount:75,locations:["Highway"]},{name:"Trader Joe's",category:"Groceries",frequency:.04,avgAmount:65,locations:["Downtown"]}],a=new Date(t);for(;a<=n;){const l=a.toLocaleDateString("en-US",{weekday:"long"});a.toLocaleDateString("en-US",{month:"short"});const h=mYe(a),y=l==="Saturday"||l==="Sunday"?Math.floor(Math.random()*4)+4:Math.floor(Math.random()*3)+2;for(let x=0;x<y;x++){const w=r[Math.floor(Math.random()*r.length)],C=gYe(w.avgAmount,w.category),P=yYe();e.push({id:`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,merchant:w.name,amount:C,category:w.category,description:vYe(w.name,w.category),location:w.locations[Math.floor(Math.random()*w.locations.length)],latitude:_Ye(),longitude:xYe(),date:new Date(a).toISOString(),status:"COMPLETED",isSimulated:!1,createdAt:new Date(a).toISOString(),updatedAt:new Date(a).toISOString(),userId:"test-user-id",dayOfWeek:l,timeOfDay:P,season:h})}a.setDate(a.getDate()+1)}return e.sort((l,h)=>new Date(l.date).getTime()-new Date(h.date).getTime())};function mYe(e){const t=e.getMonth();return t>=2&&t<=4?"Spring":t>=5&&t<=7?"Summer":t>=8&&t<=10?"Fall":"Winter"}function gYe(e,t){const n=t==="Dining"?.3:t==="Shopping"?.5:t==="Transport"?.2:.4,r=1+(Math.random()-.5)*n;return Math.round(e*r*100)/100}function yYe(){const e=Math.floor(Math.random()*24);return e>=6&&e<12?"Morning":e>=12&&e<18?"Afternoon":e>=18&&e<22?"Evening":"Night"}function vYe(e,t){const r={Dining:["Food purchase","Meal","Coffee","Lunch","Dinner"],Shopping:["Purchase","Online order","Retail purchase","Shopping"],Transport:["Gas","Fuel","Ride","Parking","Transportation"],Utilities:["Bill payment","Service charge","Monthly bill"],Healthcare:["Medical","Pharmacy","Health services"],Entertainment:["Subscription","Entertainment","Movie","Music"],Groceries:["Grocery shopping","Food purchase","Groceries"]}[t]||["Purchase"];return r[Math.floor(Math.random()*r.length)]}function _Ye(){return 40.7+(Math.random()-.5)*.1}function xYe(){return-74+(Math.random()-.5)*.1}const bYe=e=>{const t=[];["Jan","Feb","Mar","Apr","May","Jun"].forEach((w,C)=>{const P=e.filter(j=>new Date(j.date).getMonth()===C),E={month:w,dining:0,shopping:0,transport:0,utilities:0,healthcare:0,entertainment:0,groceries:0,total:0};P.forEach(j=>{const D=j.amount;E[j.category.toLowerCase()]+=D,E.total+=D}),t.push(E)});const r=new Map;e.forEach(w=>{const C=r.get(w.merchant);C?(C.amount+=w.amount,C.visits+=1):r.set(w.merchant,{amount:w.amount,visits:1,category:w.category})});const a=Array.from(r.entries()).map(([w,C])=>({name:w,amount:C.amount,visits:C.visits,category:C.category,color:wYe(w,C.category),averageSpent:C.amount/C.visits})).sort((w,C)=>C.amount-w.amount).slice(0,10),l=new Map;e.forEach(w=>{const C=l.get(w.category);l.set(w.category,(C||0)+w.amount)});const h=[{category:"Dining",spent:l.get("Dining")||0,cap:500,target:450},{category:"Shopping",spent:l.get("Shopping")||0,cap:400,target:350},{category:"Transport",spent:l.get("Transport")||0,cap:300,target:250},{category:"Utilities",spent:l.get("Utilities")||0,cap:200,target:180},{category:"Healthcare",spent:l.get("Healthcare")||0,cap:300,target:250},{category:"Entertainment",spent:l.get("Entertainment")||0,cap:150,target:120},{category:"Groceries",spent:l.get("Groceries")||0,cap:400,target:350}].map(w=>({...w,percentage:Math.round(w.spent/w.cap*100)})),i=e.reduce((w,C)=>w+C.amount,0),y=i/6,x=[{month:"Jul",actual:null,projected:y*1.02,trend:"increasing"},{month:"Aug",actual:null,projected:y*1.05,trend:"increasing"},{month:"Sep",actual:null,projected:y*1.08,trend:"increasing"},{month:"Oct",actual:null,projected:y*1.12,trend:"increasing"},{month:"Nov",actual:null,projected:y*1.15,trend:"increasing"},{month:"Dec",actual:null,projected:y*1.25,trend:"holiday_spike"}];return{monthlySpending:t,topMerchants:a,spendingVsCaps:h,spendingProjection:x,totalTransactions:e.length,totalSpent:i,averageMonthly:y}};function wYe(e,t){return{Amazon:"#6366F1",Target:"#8B5CF6",Starbucks:"#059669","McDonald's":"#DC2626",Shell:"#EA580C",Exxon:"#B91C1C",Uber:"#1F2937",Lyft:"#7C3AED",Netflix:"#BE185D",Spotify:"#16A34A","Best Buy":"#2563EB",Nike:"#0891B2","Whole Foods":"#65A30D",Kroger:"#7C2D12",Walmart:"#1D4ED8","CVS Pharmacy":"#9333EA",Walgreens:"#C2410C","Doctor's Office":"#374151","Electric Company":"#B45309","Water Company":"#0369A1","Internet Provider":"#7C2D12","Phone Company":"#BE185D","Movie Theater":"#1E40AF","Trader Joe's":"#059669"}[e]||"#6B7280"}const SYe=pYe(),_N=bYe(SYe),AYe="http://api.nessieisreal.com",TYe="0930c18c98be17fc632445ca890c85de",eD=[{_id:"demo-customer-1",first_name:"Alex",last_name:"Johnson",address:{street_number:"123",street_name:"Main Street",city:"Blacksburg",state:"VA",zip:"24060"}},{_id:"demo-customer-2",first_name:"Sarah",last_name:"Williams",address:{street_number:"456",street_name:"College Avenue",city:"Blacksburg",state:"VA",zip:"24061"}}],CYe=[{_id:"demo-account-1",type:"Checking",nickname:"Primary Checking",rewards:1250,balance:2847.5,customer_id:"demo-customer-1"},{_id:"demo-account-2",type:"Savings",nickname:"Emergency Fund",rewards:0,balance:5420.75,customer_id:"demo-customer-1"},{_id:"demo-account-3",type:"Checking",nickname:"Student Account",rewards:850,balance:1234.25,customer_id:"demo-customer-2"}],EYe=[{_id:"demo-tx-1",type:"purchase",transaction_date:"2024-09-25T14:30:00Z",status:"COMPLETED",payee_id:"Starbucks",medium:"balance",amount:8.5,description:"Coffee purchase"},{_id:"demo-tx-2",type:"purchase",transaction_date:"2024-09-24T19:15:00Z",status:"COMPLETED",payee_id:"Amazon",medium:"balance",amount:45.99,description:"Online shopping"},{_id:"demo-tx-3",type:"purchase",transaction_date:"2024-09-23T12:00:00Z",status:"COMPLETED",payee_id:"Shell",medium:"balance",amount:35,description:"Gas station"},{_id:"demo-tx-4",type:"purchase",transaction_date:"2024-09-22T18:45:00Z",status:"COMPLETED",payee_id:"Target",medium:"balance",amount:67.5,description:"Grocery shopping"},{_id:"demo-tx-5",type:"purchase",transaction_date:"2024-09-21T09:30:00Z",status:"COMPLETED",payee_id:"McDonald's",medium:"balance",amount:12.3,description:"Fast food"}];class PYe{constructor(){ni(this,"baseUrl");ni(this,"apiKey");this.baseUrl=AYe,this.apiKey=TYe}async request(t,n={}){const r=`${this.baseUrl}${t}?key=${this.apiKey}`;try{const a=await fetch(r,{headers:{"Content-Type":"application/json",...n.headers},...n});if(!a.ok)throw new Error(`Nessie API Error: ${a.status} ${a.statusText}`);return await a.json()}catch(a){throw console.error("Nessie API Request Failed:",a),a}}async getCustomers(){return console.log("API Key:",this.apiKey),this.apiKey==="demo-key"?(console.log("Using demo customers:",eD),Promise.resolve(eD)):this.request("/customers")}async getCustomer(t){if(this.apiKey==="demo-key"){const n=eD.find(r=>r._id===t);if(!n)throw new Error("Customer not found");return Promise.resolve(n)}return this.request(`/customers/${t}`)}async createCustomer(t){return this.request("/customers",{method:"POST",body:JSON.stringify(t)})}async getAccounts(t){if(this.apiKey==="demo-key"){const n=CYe.filter(r=>r.customer_id===t);return console.log("Demo accounts for customer",t,":",n),Promise.resolve(n)}return this.request(`/customers/${t}/accounts`)}async getAccount(t){return this.request(`/accounts/${t}`)}async createAccount(t,n){return this.request(`/customers/${t}/accounts`,{method:"POST",body:JSON.stringify(n)})}async getTransactions(t){return this.apiKey==="demo-key"?Promise.resolve(EYe):this.request(`/accounts/${t}/transactions`)}async createTransaction(t,n){return this.request(`/accounts/${t}/transactions`,{method:"POST",body:JSON.stringify(n)})}async transferMoney(t,n,r,a){return this.request(`/accounts/${t}/transfers/accounts/${n}`,{method:"POST",body:JSON.stringify({medium:"balance",amount:r,description:a})})}async getBills(t){return this.request(`/accounts/${t}/bills`)}async createBill(t,n){return this.request(`/accounts/${t}/bills`,{method:"POST",body:JSON.stringify(n)})}async payBill(t,n){return this.request(`/accounts/${n}/bills/${t}`,{method:"PUT"})}async getATMs(){return this.request("/enterprise/atms")}async getBranches(){return this.request("/enterprise/branches")}async getATMsByLocation(t,n,r=10){return(await this.getATMs()).filter(l=>this.calculateDistance(t,n,l.coordinates.lat,l.coordinates.lng)<=r)}async getBranchesByLocation(t,n,r=10){return(await this.getBranches()).filter(l=>this.calculateDistance(t,n,l.coordinates.lat,l.coordinates.lng)<=r)}calculateDistance(t,n,r,a){const h=this.toRadians(r-t),i=this.toRadians(a-n),y=Math.sin(h/2)*Math.sin(h/2)+Math.cos(this.toRadians(t))*Math.cos(this.toRadians(r))*Math.sin(i/2)*Math.sin(i/2);return 3959*(2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y)))}toRadians(t){return t*(Math.PI/180)}async getSpendingAnalysis(t,n=30){const r=await this.getAccounts(t),a=[];for(const E of r){const j=await this.getTransactions(E._id);a.push(...j)}if(this.apiKey==="demo-key"){const E=[{_id:"demo-tx-6",type:"purchase",transaction_date:"2024-09-20T16:20:00Z",status:"COMPLETED",payee_id:"Chipotle",medium:"balance",amount:14.75,description:"Lunch"},{_id:"demo-tx-7",type:"purchase",transaction_date:"2024-09-19T11:30:00Z",status:"COMPLETED",payee_id:"Uber",medium:"balance",amount:15.5,description:"Ride share"},{_id:"demo-tx-8",type:"purchase",transaction_date:"2024-09-18T20:00:00Z",status:"COMPLETED",payee_id:"Netflix",medium:"balance",amount:15.99,description:"Subscription"}];a.push(...E)}const l=new Date;l.setDate(l.getDate()-n);const h=a.filter(E=>new Date(E.transaction_date)>=l&&E.amount>0),i=h.reduce((E,j)=>E+j.amount,0),y=i/n,x={};h.forEach(E=>{const j=this.categorizeTransaction(E.description);x[j]=(x[j]||0)+E.amount});const w=new Map;h.forEach(E=>{const j=E.payee_id||"Unknown",D=w.get(j);D?(D.amount+=E.amount,D.count+=1):w.set(j,{amount:E.amount,count:1})});const C=Array.from(w.entries()).map(([E,j])=>({merchant:E,...j})).sort((E,j)=>j.amount-E.amount).slice(0,10),P=[];for(let E=n-1;E>=0;E--){const j=new Date;j.setDate(j.getDate()-E);const D=j.toISOString().split("T")[0],F=h.filter($=>$.transaction_date.startsWith(D)).reduce(($,H)=>$+H.amount,0);P.push({date:D,amount:F})}return{totalSpent:i,averageDaily:y,categoryBreakdown:x,topMerchants:C,spendingTrend:P}}categorizeTransaction(t){const n=t.toLowerCase();return n.includes("restaurant")||n.includes("food")||n.includes("coffee")||n.includes("starbucks")?"Dining":n.includes("gas")||n.includes("fuel")||n.includes("uber")||n.includes("lyft")?"Transport":n.includes("amazon")||n.includes("target")||n.includes("walmart")||n.includes("shopping")?"Shopping":n.includes("electric")||n.includes("water")||n.includes("internet")||n.includes("phone")?"Utilities":n.includes("medical")||n.includes("pharmacy")||n.includes("doctor")?"Healthcare":n.includes("netflix")||n.includes("spotify")||n.includes("entertainment")?"Entertainment":n.includes("grocery")||n.includes("food")||n.includes("supermarket")?"Groceries":"Other"}}const Kw=new PYe,Lm={customers:["nessie","customers"],customer:e=>["nessie","customers",e],accounts:e=>["nessie","accounts",e],account:e=>["nessie","accounts",e],transactions:e=>["nessie","transactions",e],bills:e=>["nessie","bills",e],atms:["nessie","atms"],branches:["nessie","branches"],spendingAnalysis:(e,t)=>["nessie","spending",e,t]},kYe=()=>Lh({queryKey:Lm.customers,queryFn:()=>Kw.getCustomers(),staleTime:5*60*1e3}),IYe=e=>Lh({queryKey:Lm.customer(e),queryFn:()=>Kw.getCustomer(e),enabled:!!e}),NYe=e=>Lh({queryKey:Lm.accounts(e),queryFn:()=>Kw.getAccounts(e),enabled:!!e}),MYe=()=>{const e=gy();return Av({mutationFn:({accountId:t,transactionData:n})=>Kw.createTransaction(t,n),onSuccess:(t,{accountId:n})=>{e.invalidateQueries({queryKey:Lm.transactions(n)}),e.invalidateQueries({queryKey:Lm.account(n)})}})},LYe=()=>{const e=gy();return Av({mutationFn:({fromAccountId:t,toAccountId:n,amount:r,description:a})=>Kw.transferMoney(t,n,r,a),onSuccess:(t,{fromAccountId:n,toAccountId:r})=>{e.invalidateQueries({queryKey:Lm.account(n)}),e.invalidateQueries({queryKey:Lm.account(r)}),e.invalidateQueries({queryKey:Lm.transactions(n)}),e.invalidateQueries({queryKey:Lm.transactions(r)})}})},DYe=(e,t=30)=>Lh({queryKey:Lm.spendingAnalysis(e,t),queryFn:()=>Kw.getSpendingAnalysis(e,t),enabled:!!e,staleTime:5*60*1e3}),RYe=e=>{const t=IYe(e),n=NYe(e),r=DYe(e);return{customer:t,accounts:n,spendingAnalysis:r,isLoading:t.isLoading||n.isLoading||r.isLoading,error:t.error||n.error||r.error}};function jYe(){const[e,t]=L.useState(""),[n,r]=L.useState(""),[a,l]=L.useState(""),[h,i]=L.useState(""),[y,x]=L.useState(""),{data:w,isLoading:C}=kYe(),{customer:P,accounts:E,spendingAnalysis:j,isLoading:D,error:B}=RYe(e);console.log("Customers:",w),console.log("Selected Customer ID:",e),console.log("Customer data:",P),console.log("Accounts data:",E),console.log("Spending analysis:",j);const F=LYe(),$=MYe(),H=async()=>{if(!e||!n||!a){Gn.error("Please fill in all transfer fields");return}if(E.data&&E.data.length>=2)try{await F.mutateAsync({fromAccountId:E.data[0]._id,toAccountId:E.data[1]._id,amount:parseFloat(n),description:a}),Gn.success("Transfer completed successfully!"),r(""),l("")}catch{Gn.error("Transfer failed. Please try again.")}else Gn.error("Need at least 2 accounts to transfer between")},J=async()=>{if(!e||!h||!y){Gn.error("Please fill in all transaction fields");return}if(E.data&&E.data.length>0)try{await $.mutateAsync({accountId:E.data[0]._id,transactionData:{type:"purchase",amount:parseFloat(h),description:y,medium:"balance",status:"completed",transaction_date:new Date().toISOString()}}),Gn.success("Transaction created successfully!"),i(""),x("")}catch{Gn.error("Transaction creation failed. Please try again.")}};return C?v.jsx(xr,{className:"card-gradient",children:v.jsx(br,{className:"p-6",children:v.jsxs("div",{className:"flex items-center justify-center",children:[v.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),v.jsx("span",{className:"ml-2",children:"Loading Nessie API data..."})]})})}):B?v.jsx(xr,{className:"card-gradient border-destructive",children:v.jsx(br,{className:"p-6",children:v.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[v.jsx(FP,{className:"w-5 h-5"}),v.jsx("span",{children:"Failed to load Nessie API data. Please check your API key."})]})})}):v.jsxs("div",{className:"space-y-6",children:[v.jsxs(xr,{className:"card-gradient border-2 border-primary/20",children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(MQ,{className:"w-6 h-6 text-primary"}),"Capital One Nessie API Integration",v.jsx(Is,{variant:"secondary",className:"ml-auto",children:"Real Banking Data"})]})}),v.jsx(br,{children:v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[v.jsxs("div",{children:[v.jsx(Qi,{htmlFor:"customer-select",children:"Select Customer"}),v.jsxs(Ep,{value:e,onValueChange:t,children:[v.jsx(Af,{children:v.jsx(Pp,{placeholder:"Choose a customer"})}),v.jsx(Tf,{children:w==null?void 0:w.map(ee=>v.jsxs(So,{value:ee._id,children:[ee.first_name," ",ee.last_name]},ee._id))})]})]}),v.jsx("div",{className:"flex items-end",children:v.jsxs($n,{onClick:()=>window.open("http://api.nessieisreal.com/","_blank"),variant:"outline",className:"w-full",children:[v.jsx(J_e,{className:"w-4 h-4 mr-2"}),"View Nessie API Docs"]})})]})})]}),e&&v.jsxs(v.Fragment,{children:[P.data&&v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(WE,{className:"w-5 h-5 text-primary"}),"Customer Information"]})}),v.jsx(br,{children:v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[v.jsxs("div",{children:[v.jsx("p",{className:"text-sm text-muted-foreground",children:"Name"}),v.jsxs("p",{className:"font-semibold",children:[P.data.first_name," ",P.data.last_name]})]}),v.jsxs("div",{children:[v.jsx("p",{className:"text-sm text-muted-foreground",children:"Address"}),v.jsxs("p",{className:"font-semibold",children:[P.data.address.street_number," ",P.data.address.street_name]}),v.jsxs("p",{className:"text-sm text-muted-foreground",children:[P.data.address.city,", ",P.data.address.state," ",P.data.address.zip]})]})]})})]}),E.data&&E.data.length>0&&v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(w5,{className:"w-5 h-5 text-primary"}),"Accounts (",E.data.length,")"]})}),v.jsx(br,{children:v.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:E.data.map(ee=>v.jsxs("div",{className:"p-4 border rounded-lg bg-muted/20",children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("h4",{className:"font-semibold",children:ee.nickname}),v.jsx(Is,{variant:ee.balance>=0?"default":"destructive",children:ee.balance>=0?"Positive":"Negative"})]}),v.jsxs("p",{className:"text-2xl font-bold text-primary",children:["$",ee.balance.toFixed(2)]}),v.jsxs("p",{className:"text-sm text-muted-foreground capitalize",children:[ee.type,"  ",ee.rewards," rewards"]})]},ee._id))})})]}),j.data&&v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(Ju,{className:"w-5 h-5 text-primary"}),"Spending Analysis (Last 30 Days)"]})}),v.jsxs(br,{children:[v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[v.jsxs("div",{className:"text-center",children:[v.jsxs("p",{className:"text-2xl font-bold text-primary",children:["$",j.data.totalSpent.toFixed(2)]}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Spent"})]}),v.jsxs("div",{className:"text-center",children:[v.jsxs("p",{className:"text-2xl font-bold text-primary",children:["$",j.data.averageDaily.toFixed(2)]}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"Daily Average"})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-2xl font-bold text-primary",children:j.data.topMerchants.length}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Merchants"})]})]}),v.jsxs("div",{className:"mt-6",children:[v.jsx("h4",{className:"font-semibold mb-3",children:"Spending by Category"}),v.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Object.entries(j.data.categoryBreakdown).map(([ee,Q])=>v.jsxs("div",{className:"p-3 border rounded-lg bg-muted/10",children:[v.jsx("p",{className:"text-sm text-muted-foreground capitalize",children:ee}),v.jsxs("p",{className:"font-semibold",children:["$",Q.toFixed(2)]})]},ee))})]}),v.jsxs("div",{className:"mt-6",children:[v.jsx("h4",{className:"font-semibold mb-3",children:"Top Merchants"}),v.jsx("div",{className:"space-y-2",children:j.data.topMerchants.slice(0,5).map((ee,Q)=>v.jsxs("div",{className:"flex items-center justify-between p-2 border rounded-lg",children:[v.jsxs("div",{children:[v.jsx("p",{className:"font-medium",children:ee.merchant}),v.jsxs("p",{className:"text-sm text-muted-foreground",children:[ee.count," transactions"]})]}),v.jsxs("p",{className:"font-semibold",children:["$",ee.amount.toFixed(2)]})]},Q))})]})]})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(V_e,{className:"w-5 h-5 text-primary"}),"Transfer Money"]})}),v.jsxs(br,{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx(Qi,{htmlFor:"transfer-amount",children:"Amount"}),v.jsx(ss,{id:"transfer-amount",type:"number",placeholder:"0.00",value:n,onChange:ee=>r(ee.target.value)})]}),v.jsxs("div",{children:[v.jsx(Qi,{htmlFor:"transfer-description",children:"Description"}),v.jsx(ss,{id:"transfer-description",placeholder:"Transfer description",value:a,onChange:ee=>l(ee.target.value)})]}),v.jsx($n,{onClick:H,disabled:F.isPending,className:"w-full",children:F.isPending?"Processing...":"Transfer Money"})]})]}),v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(Yb,{className:"w-5 h-5 text-primary"}),"Create Transaction"]})}),v.jsxs(br,{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx(Qi,{htmlFor:"transaction-amount",children:"Amount"}),v.jsx(ss,{id:"transaction-amount",type:"number",placeholder:"0.00",value:h,onChange:ee=>i(ee.target.value)})]}),v.jsxs("div",{children:[v.jsx(Qi,{htmlFor:"transaction-description",children:"Description"}),v.jsx(ss,{id:"transaction-description",placeholder:"Transaction description",value:y,onChange:ee=>x(ee.target.value)})]}),v.jsx($n,{onClick:J,disabled:$.isPending,className:"w-full",children:$.isPending?"Processing...":"Create Transaction"})]})]})]})]})]})}const SS=_N.monthlySpending,efe=_N.topMerchants,NY=_N.spendingVsCaps,OYe=_N.spendingProjection,tD=efe.map(e=>({...e,amount:Number(e.amount),visits:Number(e.visits)})),is={dining:{label:"Dining",color:Qu("Dining")},shopping:{label:"Shopping",color:Qu("Shopping")},transport:{label:"Transport",color:Qu("Transport")},utilities:{label:"Utilities",color:Qu("Utilities")},healthcare:{label:"Healthcare",color:Qu("Healthcare")},entertainment:{label:"Entertainment",color:Qu("Entertainment")},groceries:{label:"Groceries",color:Qu("Groceries")}},IE={projected:{label:"Projected Spending",color:"#8B5CF6"},actual:{label:"Actual Spending",color:"#3B82F6"}};function FYe(){L.useState(!1);const[e,t]=L.useState("6months"),[n,r]=L.useState(!1),[a,l]=L.useState(0),[h,i]=L.useState(""),[y,x]=L.useState(!1),[w,C]=L.useState(null),[P,E]=L.useState(!1),j=[{id:"ava",name:"Auto Visualization Agent",icon:kA,component:"ava"},{id:"ava-chat",name:"AVA Chat Assistant",icon:ixe,component:"ava-chat"},{id:"nessie",name:"Real Banking Data",icon:MQ,component:"nessie"},{id:"monthly",name:"Monthly Trends",icon:Kb,component:"monthly"},{id:"merchants",name:"Top Merchants",icon:Wd,component:"merchants"},{id:"caps",name:"Spending vs Caps",icon:Os,component:"caps"},{id:"projection",name:"Spending Projection",icon:Ju,component:"projection"}],D=()=>{l(Q=>(Q+1)%j.length)},B=()=>{l(Q=>(Q-1+j.length)%j.length)},F=[{id:1,type:"alert",icon:FP,title:"Spending Pattern Alert",description:"Your dining expenses have increased 15% compared to last month. Consider setting a stricter cap to maintain your budget goals.",category:"Dining",impact:"High",recommendation:"Set dining cap to $400/month"},{id:2,type:"success",icon:wl,title:"Savings Opportunity",description:"You're consistently under budget on transportation. You could reallocate $50/month to your savings goal.",category:"Transportation",impact:"Medium",recommendation:"Increase transportation cap by $50"},{id:3,type:"warning",icon:Os,title:"Budget Risk Warning",description:"Shopping expenses typically increase 20% in December. Consider adjusting your caps accordingly.",category:"Shopping",impact:"High",recommendation:"Prepare for holiday spending surge"},{id:4,type:"info",icon:PA,title:"Spending Trend Analysis",description:"Your monthly spending has decreased by 8% over the past 3 months. Great job maintaining budget discipline!",category:"Overall",impact:"Positive",recommendation:"Continue current spending patterns"},{id:5,type:"alert",icon:FP,title:"Merchant Concentration Risk",description:"45% of your spending is concentrated at just 3 merchants. Consider diversifying your spending for better budget control.",category:"Merchants",impact:"Medium",recommendation:"Set individual merchant spending limits"},{id:6,type:"success",icon:Ju,title:"Goal Achievement",description:"You're on track to save $2,400 this year, exceeding your goal by $400. Consider increasing your savings target.",category:"Savings",impact:"High",recommendation:"Increase annual savings goal to $3,000"},{id:7,type:"warning",icon:Os,title:"Weekend Spending Spike",description:"Your weekend spending is 35% higher than weekdays. Monitor weekend activities to maintain budget balance.",category:"Timing",impact:"Medium",recommendation:"Set weekend-specific spending caps"},{id:8,type:"info",icon:zP,title:"Optimization Opportunity",description:"Switching to bulk purchases for groceries could save you $80/month based on your current patterns.",category:"Groceries",impact:"High",recommendation:"Plan monthly bulk grocery trips"}],$=Q=>{t(Q),Gn.success(`Analytics updated for ${H(Q)}`)},H=Q=>{switch(Q){case"1month":return"Last Month";case"3months":return"Last 3 Months";case"6months":return"Last 6 Months";case"1year":return"Last Year";case"all":return"All Time";default:return"Last 6 Months"}},J=async()=>{if(!h.trim()){Gn.error("Please enter a query");return}x(!0);try{await new Promise(we=>setTimeout(we,1500));const Q=h.toLowerCase();let ne=null;const pe=Q.match(/(\d+)%/)||Q.match(/(\d+)\s*percent/),he=pe?parseInt(pe[1]):20;if(console.log("Query:",Q,"Percentage detected:",he),Q.includes("healthcare")&&Q.includes("shopping"))ne={type:"comparison",title:"Healthcare vs Shopping Spending",data:[{category:"Healthcare",amount:150,color:"#8B5CF6"},{category:"Shopping",amount:329,color:"#3B82F6"}],summary:"Your shopping spending ($329) is higher than healthcare ($150) this month."};else if(Q.includes("dining")&&(Q.includes("reduce")||Q.includes("cut")||Q.includes("decrease"))){const fe=486*he/100,ge=486-fe,Ce=fe,xe=Ce*12;ne={type:"scenario",title:`Dining Reduction Scenario (${he}%)`,data:[{period:"Current",dining:486,projected:486},{period:`With ${he}% Reduction`,dining:ge,projected:ge}],summary:`Reducing dining by ${he}% would save you $${Ce.toFixed(0)}/month, totaling $${xe.toFixed(0)} annually.`}}else if(Q.includes("shopping")&&(Q.includes("reduce")||Q.includes("cut")||Q.includes("decrease"))){const fe=329*he/100,ge=329-fe,Ce=fe,xe=Ce*12;ne={type:"scenario",title:`Shopping Reduction Scenario (${he}%)`,data:[{period:"Current",shopping:329,projected:329},{period:`With ${he}% Reduction`,shopping:ge,projected:ge}],summary:`Reducing shopping by ${he}% would save you $${Ce.toFixed(0)}/month, totaling $${xe.toFixed(0)} annually.`}}else if(Q.includes("transport")&&(Q.includes("reduce")||Q.includes("cut")||Q.includes("decrease"))){const fe=245*he/100,ge=245-fe,Ce=fe,xe=Ce*12;ne={type:"scenario",title:`Transport Reduction Scenario (${he}%)`,data:[{period:"Current",transport:245,projected:245},{period:`With ${he}% Reduction`,transport:ge,projected:ge}],summary:`Reducing transport by ${he}% would save you $${Ce.toFixed(0)}/month, totaling $${xe.toFixed(0)} annually.`}}else if(Q.includes("trend")||Q.includes("over time"))ne={type:"trend",title:"Spending Trends Over Time",data:SS,summary:"Your spending shows a gradual increase trend with seasonal variations."};else if(Q.includes("merchant")||Q.includes("store"))ne={type:"merchants",title:"Top Merchants Analysis",data:tD,summary:"Amazon leads your spending at $892, followed by Target at $523."};else if(Q.includes("compare")||Q.includes("vs")||Q.includes("versus")){const we=[];Q.includes("dining")&&we.push({category:"Dining",amount:486,color:"#EF4444"}),Q.includes("shopping")&&we.push({category:"Shopping",amount:329,color:"#3B82F6"}),Q.includes("transport")&&we.push({category:"Transport",amount:245,color:"#10B981"}),Q.includes("utilities")&&we.push({category:"Utilities",amount:187,color:"#F59E0B"}),Q.includes("healthcare")&&we.push({category:"Healthcare",amount:150,color:"#8B5CF6"}),Q.includes("entertainment")&&we.push({category:"Entertainment",amount:120,color:"#EC4899"}),we.length>=2?ne={type:"comparison",title:`${we[0].category} vs ${we[1].category} Spending`,data:we.slice(0,2),summary:`${we[0].category} spending ($${we[0].amount}) is ${we[0].amount>we[1].amount?"higher":"lower"} than ${we[1].category} ($${we[1].amount}).`}:ne={type:"general",title:"Spending Analysis",data:SS,summary:"Based on your query, here's your spending analysis with key insights."}}else ne={type:"general",title:"Spending Analysis",data:SS,summary:"Based on your query, here's your spending analysis with key insights."};console.log("Query result:",ne),C(ne),Gn.success("Query processed successfully!")}catch{Gn.error("Failed to process query. Please try again.")}finally{x(!1)}},ee=async()=>{r(!0);try{console.log("Starting PDF export...");const Q=new Ci("p","mm","a4"),ne=Q.internal.pageSize.getWidth(),pe=Q.internal.pageSize.getHeight();let he=20;const we=et=>he+et>pe-20?(Q.addPage(),he=20,!0):!1,fe=et=>{Q.setLineWidth(.5),Q.setDrawColor(200,200,200),Q.line(20,et,ne-20,et)};Q.setFontSize(24),Q.setFont("helvetica","bold"),Q.setTextColor(50,50,50),Q.text("Financial Analytics Report",20,he),he+=15,Q.setFontSize(10),Q.setFont("helvetica","normal"),Q.setTextColor(100,100,100);const ge=new Date().toLocaleDateString(),Ce=new Date().toLocaleTimeString();Q.text(`Generated on ${ge} at ${Ce}`,20,he),he+=8,Q.text(`Report Period: ${H(e)}`,20,he),he+=20,Q.setFontSize(16),Q.setFont("helvetica","bold"),Q.setTextColor(50,50,50),Q.text("Executive Summary",20,he),he+=10,fe(he),he+=5;const xe={totalSpending:2847.5,averageMonthly:474.58,topCategory:"Dining",topMerchant:"Starbucks Coffee",savingsRate:12.5};Q.setFontSize(12),Q.setFont("helvetica","normal"),Q.text(`Total Spending: $${xe.totalSpending.toFixed(2)}`,20,he),he+=8,Q.text(`Average Monthly Spending: $${xe.averageMonthly.toFixed(2)}`,20,he),he+=8,Q.text(`Top Spending Category: ${xe.topCategory}`,20,he),he+=8,Q.text(`Top Merchant: ${xe.topMerchant}`,20,he),he+=8,Q.text(`Savings Rate: ${xe.savingsRate}%`,20,he),he+=15,Q.setFontSize(16),Q.setFont("helvetica","bold"),Q.text("Key Insights & Recommendations",20,he),he+=10,fe(he),he+=5,F.slice(0,5).forEach((et,je)=>{we(20)&&(he=20),Q.setFontSize(11),Q.setFont("helvetica","bold"),Q.setTextColor(50,50,50),Q.text(`${je+1}. ${et.title||"Insight"}`,20,he),he+=6,Q.setFontSize(9),Q.setFont("helvetica","normal"),Q.setTextColor(80,80,80);const De=(et.description||"").length>80?(et.description||"").substring(0,77)+"...":et.description||"No description available";Q.text(De,20,he),he+=5,Q.setFontSize(8),Q.setTextColor(100,100,100),Q.text(`Category: ${et.category||"N/A"} | Impact: ${et.impact||"N/A"}`,20,he),he+=4,Q.text(`Recommendation: ${et.recommendation||"No recommendation"}`,20,he),he+=8}),he+=10,we(30)&&(he=20),Q.setFontSize(16),Q.setFont("helvetica","bold"),Q.text("Spending Analysis",20,he),he+=10,fe(he),he+=5,Q.setFontSize(12),Q.setFont("helvetica","bold"),Q.text("Monthly Spending Trends:",20,he),he+=8,Q.setFontSize(9),Q.setFont("helvetica","normal"),(SS||[]).forEach((et,je)=>{he>pe-30&&(Q.addPage(),he=20);const De=(et.dining||0)+(et.shopping||0)+(et.transport||0)+(et.utilities||0);Q.text(`${et.month||"Unknown"}: $${De.toFixed(2)}`,30,he),he+=5}),he+=10,we(20)&&(he=20),Q.setFontSize(12),Q.setFont("helvetica","bold"),Q.text("Top Merchants:",20,he),he+=8,Q.setFontSize(9),Q.setFont("helvetica","normal"),(efe||[]).forEach((et,je)=>{he>pe-30&&(Q.addPage(),he=20),Q.text(`${je+1}. ${et.name||"Unknown"}: $${(et.amount||0).toFixed(2)}`,30,he),he+=5}),he+=10,we(20)&&(he=20),Q.setFontSize(12),Q.setFont("helvetica","bold"),Q.text("Spending vs Budget Caps:",20,he),he+=8,Q.setFontSize(9),Q.setFont("helvetica","normal"),(NY||[]).forEach((et,je)=>{he>pe-30&&(Q.addPage(),he=20);const De=et.spent||0,Ct=et.cap||1,xt=(De/Ct*100).toFixed(1);Q.text(`${et.category||"Unknown"}: $${De.toFixed(2)} / $${Ct.toFixed(2)} (${xt}%)`,30,he),he+=5}),he=pe-20,Q.setFontSize(8),Q.setFont("helvetica","normal"),Q.setTextColor(150,150,150),Q.text("Generated by MoneyLens - Financial Analytics System",20,he);const Qe=new Date().toISOString().split("T")[0];console.log("Saving PDF..."),Q.save(`analytics-report-${e}-${Qe}.pdf`),console.log("PDF export completed successfully"),Gn.success("Analytics report exported successfully!")}catch(Q){console.error("Export failed:",Q),console.error("Error details:",{message:Q.message,stack:Q.stack,name:Q.name}),Gn.error("Failed to export report. Please try again.")}finally{r(!1)}};return v.jsxs(ol.div,{className:"h-full min-h-screen space-y-6 p-6",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[v.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-6",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("h1",{className:"text-2xl lg:text-3xl font-bold bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:"Financial Analytics"}),v.jsx("p",{className:"text-muted-foreground text-sm",children:"Comprehensive insights into your spending patterns"})]}),v.jsxs("div",{className:"flex flex-wrap items-center gap-2 lg:gap-3",children:[v.jsxs(Ep,{value:e,onValueChange:$,children:[v.jsx(Af,{className:"w-[140px] h-9",children:v.jsx(Pp,{placeholder:"Select period"})}),v.jsxs(Tf,{children:[v.jsx(So,{value:"1month",children:"Last Month"}),v.jsx(So,{value:"3months",children:"Last 3 Months"}),v.jsx(So,{value:"6months",children:"Last 6 Months"}),v.jsx(So,{value:"1year",children:"Last Year"}),v.jsx(So,{value:"all",children:"All Time"})]})]}),v.jsxs($n,{size:"sm",className:"h-9",onClick:ee,disabled:n,children:[v.jsx(D3,{className:"w-4 h-4 mr-2"}),v.jsx("span",{className:"hidden sm:inline",children:n?"Exporting...":"Export Report"}),v.jsx("span",{className:"sm:hidden",children:n?"...":"Export"})]})]})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[v.jsx(xr,{className:"card-gradient",children:v.jsx(br,{className:"p-6",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:v.jsx(Tu,{className:"w-5 h-5 text-primary"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Daily Spending"}),v.jsx("p",{className:"text-2xl font-bold",children:"$94.90"}),v.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[v.jsx(SF,{className:"w-3 h-3 text-success"}),v.jsx("span",{className:"text-success",children:"-5.2%"})]})]})]})})}),v.jsx(xr,{className:"card-gradient",children:v.jsx(br,{className:"p-6",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"p-2 bg-success/10 rounded-lg",children:v.jsx(Wd,{className:"w-5 h-5 text-success"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-sm text-muted-foreground",children:"Budget Adherence"}),v.jsx("p",{className:"text-2xl font-bold",children:"87%"}),v.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[v.jsx(Ju,{className:"w-3 h-3 text-success"}),v.jsx("span",{className:"text-success",children:"+2.1%"})]})]})]})})}),v.jsx(xr,{className:"card-gradient",children:v.jsx(br,{className:"p-6",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"p-2 bg-warning/10 rounded-lg",children:v.jsx(Ju,{className:"w-5 h-5 text-warning"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-sm text-muted-foreground",children:"Spending Velocity"}),v.jsx("p",{className:"text-2xl font-bold",children:"+3.4%"}),v.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[v.jsx(Ju,{className:"w-3 h-3 text-warning"}),v.jsx("span",{className:"text-warning",children:"Increasing"})]})]})]})})}),v.jsx(xr,{className:"card-gradient",children:v.jsx(br,{className:"p-6",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"p-2 bg-success/10 rounded-lg",children:v.jsx(Tu,{className:"w-5 h-5 text-success"})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-sm text-muted-foreground",children:"Savings Rate"}),v.jsx("p",{className:"text-2xl font-bold",children:"18.5%"}),v.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[v.jsx(Ju,{className:"w-3 h-3 text-success"}),v.jsx("span",{className:"text-success",children:"+1.8%"})]})]})]})})})]}),v.jsxs(xr,{className:"card-gradient border-2 border-primary/20",children:[v.jsx(ui,{className:"pb-4",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs(di,{className:"flex items-center gap-2",children:[ir.createElement(j[a].icon,{className:"w-5 h-5 text-primary"}),j[a].name]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx($n,{variant:"outline",size:"sm",onClick:B,className:"h-8 w-8 p-0",children:v.jsx(Z_e,{className:"w-4 h-4"})}),v.jsx("div",{className:"flex items-center gap-1",children:j.map((Q,ne)=>v.jsx("div",{className:`w-2 h-2 rounded-full ${ne===a?"bg-primary":"bg-muted"}`},ne))}),v.jsx($n,{variant:"outline",size:"sm",onClick:D,className:"h-8 w-8 p-0",children:v.jsx(LQ,{className:"w-4 h-4"})})]})]})}),v.jsx(br,{className:"pt-0",children:v.jsxs(ol.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"min-h-[400px]",children:[j[a].component==="ava"&&v.jsxs("div",{children:[v.jsx(fYe,{}),v.jsx(g_,{shortDescription:"The Auto Visualization Agent intelligently analyzes your spending data and automatically generates the most relevant charts and insights based on your financial patterns and trends.",longDescription:"This advanced AI-powered agent continuously monitors your financial data to identify patterns, anomalies, and trends. It automatically selects the most appropriate visualization type (bar charts, pie charts, line graphs, or area charts) based on the data characteristics and your spending behavior. The agent can detect spending anomalies, seasonal patterns, budget deviations, and emerging trends. It provides real-time insights and recommendations, helping you understand your financial habits without manual analysis. The system learns from your spending patterns to provide increasingly personalized and relevant visualizations over time.",insights:["Automatically selects optimal chart types based on data patterns","Detects spending anomalies and unusual patterns","Provides real-time insights and recommendations","Learns from your spending behavior for personalized analysis"]})]}),j[a].component==="ava-chat"&&v.jsxs("div",{children:[v.jsx("div",{className:"flex justify-end mb-4",children:v.jsx($n,{variant:"outline",size:"sm",onClick:()=>E(!0),className:"rounded-full w-8 h-8 p-0 bg-primary/10 hover:bg-primary/20 border-primary/30",children:v.jsx(PA,{className:"w-4 h-4 text-primary"})})}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"flex gap-2",children:[v.jsx(ss,{placeholder:"Try: 'What if I reduce dining by 60%?' or 'Compare dining vs shopping spending'",value:h,onChange:Q=>i(Q.target.value),onKeyPress:Q=>Q.key==="Enter"&&J(),className:"flex-1",disabled:y}),v.jsx($n,{onClick:J,disabled:y||!h.trim(),className:"px-6",children:y?v.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):v.jsx(oxe,{className:"w-4 h-4"})})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[v.jsx($n,{variant:"outline",size:"sm",onClick:()=>i("Compare dining vs shopping spending"),className:"text-left justify-start h-auto p-3",disabled:y,children:v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-xs",children:"Dining vs Shopping"}),v.jsx("p",{className:"text-xs text-muted-foreground",children:"Compare categories"})]})}),v.jsx($n,{variant:"outline",size:"sm",onClick:()=>i("What if I reduce dining by 60%?"),className:"text-left justify-start h-auto p-3",disabled:y,children:v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-xs",children:"Dining Reduction"}),v.jsx("p",{className:"text-xs text-muted-foreground",children:"Scenario simulation"})]})}),v.jsx($n,{variant:"outline",size:"sm",onClick:()=>i("Show me my spending trends over time"),className:"text-left justify-start h-auto p-3",disabled:y,children:v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-xs",children:"Spending Trends"}),v.jsx("p",{className:"text-xs text-muted-foreground",children:"Time series analysis"})]})})]}),w&&v.jsx(ol.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"mt-6",children:v.jsxs(xr,{className:"border-primary/20",children:[v.jsxs(ui,{className:"pb-3",children:[v.jsx(di,{className:"text-lg",children:w.title}),v.jsx("p",{className:"text-sm text-muted-foreground",children:w.summary})]}),v.jsx(br,{children:v.jsxs("div",{className:"h-[300px]",children:[w.type==="comparison"&&v.jsx(Zu,{config:{},className:"h-full w-full",children:v.jsxs(DS,{data:w.data,children:[v.jsx(Od,{dataKey:"category"}),v.jsx(Fd,{}),v.jsx(Ku,{content:v.jsx(gh,{}),animationDuration:0,isAnimationActive:!1}),v.jsx(Nd,{dataKey:"amount",radius:[4,4,0,0],children:w.data.map((Q,ne)=>v.jsx(Kg,{fill:Q.color},`cell-${ne}`))})]})}),w.type==="scenario"&&v.jsx(Zu,{config:{},className:"h-full w-full",children:v.jsxs(DS,{data:w.data,children:[v.jsx(Od,{dataKey:"period"}),v.jsx(Fd,{}),v.jsx(Ku,{content:v.jsx(gh,{}),animationDuration:0,isAnimationActive:!1}),w.data[0].dining!==void 0&&v.jsx(Nd,{dataKey:"dining",fill:"#EF4444",radius:[4,4,0,0]}),w.data[0].shopping!==void 0&&v.jsx(Nd,{dataKey:"shopping",fill:"#3B82F6",radius:[4,4,0,0]}),w.data[0].transport!==void 0&&v.jsx(Nd,{dataKey:"transport",fill:"#10B981",radius:[4,4,0,0]}),w.data[0].utilities!==void 0&&v.jsx(Nd,{dataKey:"utilities",fill:"#F59E0B",radius:[4,4,0,0]}),w.data[0].healthcare!==void 0&&v.jsx(Nd,{dataKey:"healthcare",fill:"#8B5CF6",radius:[4,4,0,0]}),w.data[0].entertainment!==void 0&&v.jsx(Nd,{dataKey:"entertainment",fill:"#EC4899",radius:[4,4,0,0]}),w.data[0].groceries!==void 0&&v.jsx(Nd,{dataKey:"groceries",fill:"#06B6D4",radius:[4,4,0,0]})]})}),w.type==="trend"&&v.jsx(Zu,{config:is,className:"h-full w-full",children:v.jsxs(RS,{data:w.data,children:[v.jsx(Od,{dataKey:"month"}),v.jsx(Fd,{}),v.jsx(Ku,{content:v.jsx(gh,{}),animationDuration:0,isAnimationActive:!1}),v.jsx(jo,{type:"monotone",dataKey:"dining",stackId:"1",stroke:is.dining.color,fill:is.dining.color,fillOpacity:.6}),v.jsx(jo,{type:"monotone",dataKey:"shopping",stackId:"1",stroke:is.shopping.color,fill:is.shopping.color,fillOpacity:.6}),v.jsx(jo,{type:"monotone",dataKey:"transport",stackId:"1",stroke:is.transport.color,fill:is.transport.color,fillOpacity:.6}),v.jsx(jo,{type:"monotone",dataKey:"utilities",stackId:"1",stroke:is.utilities.color,fill:is.utilities.color,fillOpacity:.6}),v.jsx(jo,{type:"monotone",dataKey:"healthcare",stackId:"1",stroke:is.healthcare.color,fill:is.healthcare.color,fillOpacity:.6}),v.jsx(jo,{type:"monotone",dataKey:"entertainment",stackId:"1",stroke:is.entertainment.color,fill:is.entertainment.color,fillOpacity:.6}),v.jsx(jo,{type:"monotone",dataKey:"groceries",stackId:"1",stroke:is.groceries.color,fill:is.groceries.color,fillOpacity:.6})]})}),w.type==="merchants"&&v.jsx(Zu,{config:{},className:"h-full w-full",children:v.jsxs(DS,{data:w.data,children:[v.jsx(Od,{dataKey:"name",angle:-45,textAnchor:"end",height:60}),v.jsx(Fd,{}),v.jsx(Ku,{content:v.jsx(gh,{}),animationDuration:0,isAnimationActive:!1}),v.jsx(Nd,{dataKey:"amount",radius:[4,4,0,0],children:w.data.map((Q,ne)=>v.jsx(Kg,{fill:Q.color},`cell-${ne}`))})]})}),w.type==="general"&&v.jsx(Zu,{config:is,className:"h-full w-full",children:v.jsxs(RS,{data:w.data,children:[v.jsx(Od,{dataKey:"month"}),v.jsx(Fd,{}),v.jsx(Ku,{content:v.jsx(gh,{}),animationDuration:0,isAnimationActive:!1}),v.jsx(jo,{type:"monotone",dataKey:"dining",stackId:"1",stroke:is.dining.color,fill:is.dining.color,fillOpacity:.6}),v.jsx(jo,{type:"monotone",dataKey:"shopping",stackId:"1",stroke:is.shopping.color,fill:is.shopping.color,fillOpacity:.6}),v.jsx(jo,{type:"monotone",dataKey:"transport",stackId:"1",stroke:is.transport.color,fill:is.transport.color,fillOpacity:.6}),v.jsx(jo,{type:"monotone",dataKey:"utilities",stackId:"1",stroke:is.utilities.color,fill:is.utilities.color,fillOpacity:.6}),v.jsx(jo,{type:"monotone",dataKey:"healthcare",stackId:"1",stroke:is.healthcare.color,fill:is.healthcare.color,fillOpacity:.6}),v.jsx(jo,{type:"monotone",dataKey:"entertainment",stackId:"1",stroke:is.entertainment.color,fill:is.entertainment.color,fillOpacity:.6}),v.jsx(jo,{type:"monotone",dataKey:"groceries",stackId:"1",stroke:is.groceries.color,fill:is.groceries.color,fillOpacity:.6})]})})]})})]})})]}),v.jsx(g_,{shortDescription:"The AVA Chat Assistant allows you to ask questions in natural language and automatically generates the perfect chart to answer your query. Simply type what you want to know about your spending patterns.",longDescription:"This intelligent chat interface understands natural language queries about your financial data and automatically selects the most appropriate visualization. Whether you want to compare categories, simulate scenarios, analyze trends, or explore merchant spending, AVA will generate the right chart type and provide meaningful insights. The system processes your questions using advanced natural language understanding and creates dynamic, interactive visualizations that help you understand your spending patterns better than ever before.",insights:["Ask questions in plain English - no technical knowledge required","Automatically selects the best chart type for your query","Supports comparison, scenario simulation, and trend analysis","Provides instant insights and recommendations"]})]}),j[a].component==="nessie"&&v.jsxs("div",{children:[v.jsx(jYe,{}),v.jsx(g_,{shortDescription:"Real banking data integration using Capital One's Nessie API. View actual account balances, transaction history, and spending patterns from real bank accounts.",longDescription:"This integration connects to Capital One's Nessie API to provide real banking data including customer accounts, transaction history, spending analysis, and financial insights. Users can view actual account balances, transfer money between accounts, create new transactions, and analyze spending patterns using real bank data. The system automatically categorizes transactions and provides detailed financial analytics based on actual banking activity.",insights:["Real account balances and transaction history from Capital One API","Live spending analysis with automatic transaction categorization","Money transfer capabilities between accounts","Bill payment and transaction creation features"]})]}),j[a].component==="monthly"&&v.jsxs("div",{children:[v.jsx(Zu,{config:is,className:"h-[400px] w-full",children:v.jsxs(RS,{data:SS,children:[v.jsx(Od,{dataKey:"month",tick:{fontSize:12},axisLine:{stroke:"#e5e7eb"},tickLine:{stroke:"#e5e7eb"}}),v.jsx(Fd,{tick:{fontSize:12},axisLine:{stroke:"#e5e7eb"},tickLine:{stroke:"#e5e7eb"}}),v.jsx(Ku,{content:v.jsx(gh,{}),animationDuration:0,isAnimationActive:!1,labelStyle:{color:"#374151",fontSize:"14px",fontWeight:"600",lineHeight:"1.5"},contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",padding:"8px 12px"}}),v.jsx(jo,{type:"monotone",dataKey:"dining",stackId:"1",stroke:is.dining.color,fill:is.dining.color,fillOpacity:.6,strokeWidth:2}),v.jsx(jo,{type:"monotone",dataKey:"shopping",stackId:"1",stroke:is.shopping.color,fill:is.shopping.color,fillOpacity:.6,strokeWidth:2}),v.jsx(jo,{type:"monotone",dataKey:"transport",stackId:"1",stroke:is.transport.color,fill:is.transport.color,fillOpacity:.6,strokeWidth:2}),v.jsx(jo,{type:"monotone",dataKey:"utilities",stackId:"1",stroke:is.utilities.color,fill:is.utilities.color,fillOpacity:.6,strokeWidth:2}),v.jsx(jo,{type:"monotone",dataKey:"healthcare",stackId:"1",stroke:is.healthcare.color,fill:is.healthcare.color,fillOpacity:.6,strokeWidth:2}),v.jsx(jo,{type:"monotone",dataKey:"entertainment",stackId:"1",stroke:is.entertainment.color,fill:is.entertainment.color,fillOpacity:.6,strokeWidth:2}),v.jsx(jo,{type:"monotone",dataKey:"groceries",stackId:"1",stroke:is.groceries.color,fill:is.groceries.color,fillOpacity:.6,strokeWidth:2})]})}),v.jsx(g_,{shortDescription:"Your spending shows a consistent pattern with dining being your highest category, averaging $502/month. There's a notable increase in shopping expenses during March and May.",longDescription:"The monthly trends reveal several key patterns in your spending behavior. Dining expenses consistently lead your spending categories, with an average of $502 per month and a peak of $567 in June. Shopping expenses show seasonal variation, with significant increases in March ($398) and May ($423), likely reflecting seasonal purchases or lifestyle changes. Transportation costs remain relatively stable around $250-280 per month, while utilities show minimal fluctuation, indicating good budget discipline in essential expenses. The overall trend suggests you maintain consistent spending habits with occasional spikes in discretionary categories.",insights:["Dining expenses are 25% higher than other categories on average","Shopping spikes in March and May suggest seasonal spending patterns","Transportation costs are well-controlled with minimal variance","Utilities spending is the most predictable category"]})]}),j[a].component==="merchants"&&v.jsxs("div",{children:[v.jsx(Zu,{config:{},className:"h-[400px] w-full",children:v.jsxs(DS,{data:tD,margin:{top:20,right:30,left:20,bottom:5},children:[v.jsx(Od,{dataKey:"name",tick:{fontSize:9},axisLine:{stroke:"#e5e7eb"},tickLine:{stroke:"#e5e7eb"},angle:-45,textAnchor:"end",height:100,interval:0,tickFormatter:Q=>Q&&Q.length>12?Q.substring(0,12)+"...":Q}),v.jsx(Fd,{tick:{fontSize:12},axisLine:{stroke:"#e5e7eb"},tickLine:{stroke:"#e5e7eb"}}),v.jsx(Ku,{content:v.jsx(gh,{}),animationDuration:0,isAnimationActive:!1,labelStyle:{color:"#374151",fontSize:"14px",fontWeight:"600",lineHeight:"1.5"},contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",padding:"8px 12px"},formatter:(Q,ne)=>[`$${Number(Q).toFixed(2)}`,"Amount Spent"]}),v.jsx(Nd,{dataKey:"amount",radius:[4,4,0,0],name:"Amount Spent",children:tD.map((Q,ne)=>v.jsx(Kg,{fill:Q.color},`cell-${ne}`))})]})}),v.jsx(g_,{shortDescription:"Amazon dominates your spending at $892, representing 40% of your top merchant expenses. You have a good mix of shopping, dining, and transport merchants with Starbucks showing high visit frequency.",longDescription:"Your merchant spending reveals a concentrated pattern with Amazon accounting for the largest portion of your expenses at $892. This suggests you rely heavily on online shopping for various needs. Target follows as your second-largest merchant at $523, indicating a preference for retail shopping. Interestingly, while Shell has the highest visit frequency (15 visits), your spending per visit is lower, suggesting frequent but smaller fuel purchases. Starbucks shows the highest visit frequency among dining establishments (18 visits), indicating regular coffee purchases. McDonald's represents smaller individual transactions but frequent visits, suggesting convenience-based dining choices.",insights:["Amazon represents 40% of your top merchant spending","High visit frequency at Shell suggests regular commuting patterns","Starbucks visits indicate a daily coffee habit","Merchant diversity is good across shopping, dining, and transport"]})]}),j[a].component==="caps"&&v.jsxs("div",{children:[v.jsx(Zu,{config:{},className:"h-[400px] w-full",children:v.jsxs(qqe,{data:NY,children:[v.jsx(Od,{dataKey:"category",tick:{fontSize:12},axisLine:{stroke:"#e5e7eb"},tickLine:{stroke:"#e5e7eb"}}),v.jsx(Fd,{tick:{fontSize:12},axisLine:{stroke:"#e5e7eb"},tickLine:{stroke:"#e5e7eb"}}),v.jsx(Ku,{content:v.jsx(gh,{}),animationDuration:0,isAnimationActive:!1,labelStyle:{color:"#374151",fontSize:"14px",fontWeight:"600",lineHeight:"1.5"},contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",padding:"8px 12px"}}),v.jsx(Nd,{dataKey:"spent",fill:"#3B82F6",name:"Spent",radius:[4,4,0,0]}),v.jsx(Nd,{dataKey:"cap",fill:"#10B981",name:"Cap",radius:[4,4,0,0]}),v.jsx(cN,{type:"monotone",dataKey:"target",stroke:"#F59E0B",strokeWidth:2,name:"Target",dot:{fill:"#F59E0B",strokeWidth:2,r:4}})]})}),v.jsx(g_,{shortDescription:"Excellent budget control! You're under your caps in all categories, with dining at 97% of cap and utilities at 94%. Your targets are well-calibrated and achievable.",longDescription:"Your spending vs caps analysis reveals strong financial discipline across all categories. Dining expenses are at 97% of your cap ($486/$500), showing excellent control while still allowing for lifestyle spending. Shopping is well-managed at 82% of cap ($329/$400), indicating good restraint in discretionary purchases. Transportation spending is at 82% of cap ($245/$300), suggesting efficient travel management. Utilities are at 94% of cap ($187/$200), showing consistent and predictable essential spending. Your target lines are well-positioned between actual spending and caps, providing a healthy buffer for unexpected expenses while maintaining budget discipline.",insights:["All categories are under budget caps - excellent financial discipline","Dining is closest to cap at 97% - monitor for potential overruns","Target lines provide good buffer zones for each category","Utilities spending is most predictable and well-controlled"]})]}),j[a].component==="projection"&&v.jsxs("div",{children:[v.jsx(Zu,{config:IE,className:"h-[400px] w-full",children:v.jsxs(RS,{data:OYe,margin:{top:20,right:30,left:20,bottom:5},children:[v.jsx(Od,{dataKey:"month",tick:{fontSize:12},axisLine:{stroke:"#e5e7eb"},tickLine:{stroke:"#e5e7eb"}}),v.jsx(Fd,{tick:{fontSize:12},axisLine:{stroke:"#e5e7eb"},tickLine:{stroke:"#e5e7eb"},domain:[2500,3500]}),v.jsx(Ku,{content:({active:Q,payload:ne,label:pe})=>Q&&ne&&ne.length?v.jsxs("div",{style:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",padding:"8px 12px",lineHeight:"1.5"},children:[v.jsxs("p",{style:{color:"#374151",fontSize:"14px",fontWeight:"600",margin:"0 0 4px 0"},children:[pe," 2024"]}),v.jsxs("p",{style:{color:"#374151",fontSize:"14px",margin:"0"},children:["$",ne[0].value," Actual"]})]}):null}),v.jsx(jo,{type:"monotone",dataKey:"projected",stroke:IE.projected.color,fill:IE.projected.color,fillOpacity:.3,strokeWidth:3,name:"Projected Spending",dot:{fill:IE.projected.color,strokeWidth:2,r:4}})]})}),v.jsxs("div",{className:"mt-4 p-3 bg-primary/10 rounded-lg border border-primary/20",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[v.jsx(Ju,{className:"w-4 h-4 text-primary"}),v.jsx("h4",{className:"font-semibold text-primary text-sm",children:"Projection Insights"})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[v.jsxs("div",{children:[v.jsx("p",{className:"text-muted-foreground",children:"Current Average"}),v.jsx("p",{className:"font-semibold text-primary",children:"$2,847"})]}),v.jsxs("div",{children:[v.jsx("p",{className:"text-muted-foreground",children:"Year-End"}),v.jsx("p",{className:"font-semibold text-primary",children:"$3,289"})]})]}),v.jsx("div",{className:"mt-2 p-2 bg-background/50 rounded border border-primary/10",children:v.jsxs("p",{className:"text-xs text-foreground",children:[v.jsx("strong",{className:"text-primary",children:"Forecast:"})," Gradual increase with holiday spike in December."]})})]}),v.jsx(g_,{shortDescription:"Your spending is projected to increase gradually from $2,847 to $3,289 by December, with a notable holiday spike. The trend suggests seasonal spending patterns and lifestyle inflation.",longDescription:"The spending projection reveals a steady upward trend in your monthly expenses, increasing from $2,847 in July to $3,289 by December. This represents a 15.5% increase over six months, averaging 2.6% growth per month. The gradual increase suggests normal lifestyle inflation and seasonal spending patterns. The December spike to $3,289 indicates anticipated holiday spending, which is typical for most households. The consistent upward trend suggests you may need to adjust your budget caps or spending targets to accommodate this growth. The projection is based on historical spending patterns and seasonal trends, providing a realistic forecast for budget planning.",insights:["15.5% spending increase projected over 6 months","December holiday spike expected at $3,289","Average monthly growth rate of 2.6%","Consider adjusting budget caps for projected increases"]})]})]},a)})]}),v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsx(di,{children:"Spending Patterns Analysis"})}),v.jsx(br,{children:v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("h3",{className:"text-2xl font-bold text-primary",children:"Tuesday"}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"Highest Spending Day"}),v.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Avg: $127.45"})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("h3",{className:"text-2xl font-bold text-success",children:"3:00 PM"}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"Peak Spending Time"}),v.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"23% of daily transactions"})]}),v.jsxs("div",{className:"text-center",children:[v.jsx("h3",{className:"text-2xl font-bold text-warning",children:"Coffee Shops"}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"Most Frequent Category"}),v.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"45 visits this month"})]})]})})]}),v.jsx(Gg,{open:P,onOpenChange:E,children:v.jsxs(km,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[v.jsx(Im,{children:v.jsxs(Nm,{className:"flex items-center gap-2",children:[v.jsx(kA,{className:"w-5 h-5 text-primary"}),"Automation & Agent Behavior"]})}),v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:v.jsx(zP,{className:"w-4 h-4 text-primary"})}),v.jsx("h3",{className:"font-semibold text-primary",children:"Natural Language Queries"})]}),v.jsx("p",{className:"text-sm text-muted-foreground",children:'Let users type "Show me my healthcare spending vs shopping in September". AVA generates the right chart + summary.'}),v.jsxs("div",{className:"p-3 bg-primary/5 rounded-lg border border-primary/20",children:[v.jsx("p",{className:"text-xs text-foreground font-medium mb-1",children:"Example Query:"}),v.jsx("p",{className:"text-xs text-muted-foreground italic",children:'"Show me my healthcare spending vs shopping in September"'})]})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:"p-2 bg-warning/10 rounded-lg",children:v.jsx(Os,{className:"w-4 h-4 text-warning"})}),v.jsx("h3",{className:"font-semibold text-warning",children:"Alerting System"})]}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"Email/Slack/notification when spending crosses a threshold."}),v.jsxs("div",{className:"p-3 bg-warning/5 rounded-lg border border-warning/20",children:[v.jsx("p",{className:"text-xs text-foreground font-medium mb-1",children:"Smart Alerts:"}),v.jsxs("p",{className:"text-xs text-muted-foreground",children:[" Budget threshold breaches",v.jsx("br",{})," Unusual spending patterns",v.jsx("br",{})," Category cap warnings"]})]})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:"p-2 bg-success/10 rounded-lg",children:v.jsx(Wd,{className:"w-4 h-4 text-success"})}),v.jsx("h3",{className:"font-semibold text-success",children:"Scenario Simulations"})]}),v.jsx("p",{className:"text-sm text-muted-foreground",children:'"What if I reduce dining by 20%?"  AVA updates chart & shows savings impact.'}),v.jsxs("div",{className:"p-3 bg-success/5 rounded-lg border border-success/20",children:[v.jsx("p",{className:"text-xs text-foreground font-medium mb-1",children:"Simulation Example:"}),v.jsx("p",{className:"text-xs text-muted-foreground italic",children:'"What if I reduce dining by 20%?"'}),v.jsx("p",{className:"text-xs text-success mt-1",children:" Shows potential savings: $100/month"})]})]})]}),v.jsxs("div",{className:"mt-6 p-4 bg-primary/5 rounded-lg border border-primary/20",children:[v.jsx("h4",{className:"font-semibold text-primary mb-2",children:"How It Works"}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"The AVA Chat Assistant combines all three automation features into one intelligent interface. Simply type your question in natural language, and AVA will automatically determine whether you want a comparison, scenario simulation, or trend analysis, then generate the perfect chart and insights."})]})]})]})})]})}var tfe="AlertDialog",[zYe,JXe]=dd(tfe,[qre]),Ty=qre(),nfe=e=>{const{__scopeAlertDialog:t,...n}=e,r=Ty(t);return v.jsx(F6,{...r,...n,modal:!0})};nfe.displayName=tfe;var BYe="AlertDialogTrigger",rfe=L.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Ty(n);return v.jsx(aie,{...a,...r,ref:t})});rfe.displayName=BYe;var UYe="AlertDialogPortal",ife=e=>{const{__scopeAlertDialog:t,...n}=e,r=Ty(t);return v.jsx(z6,{...r,...n})};ife.displayName=UYe;var VYe="AlertDialogOverlay",sfe=L.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Ty(n);return v.jsx(j5,{...a,...r,ref:t})});sfe.displayName=VYe;var kb="AlertDialogContent",[$Ye,qYe]=zYe(kb),GYe=sQ("AlertDialogContent"),afe=L.forwardRef((e,t)=>{const{__scopeAlertDialog:n,children:r,...a}=e,l=Ty(n),h=L.useRef(null),i=_s(t,h),y=L.useRef(null);return v.jsx(p3e,{contentName:kb,titleName:ofe,docsSlug:"alert-dialog",children:v.jsx($Ye,{scope:n,cancelRef:y,children:v.jsxs(O5,{role:"alertdialog",...l,...a,ref:i,onOpenAutoFocus:Sr(a.onOpenAutoFocus,x=>{var w;x.preventDefault(),(w=y.current)==null||w.focus({preventScroll:!0})}),onPointerDownOutside:x=>x.preventDefault(),onInteractOutside:x=>x.preventDefault(),children:[v.jsx(GYe,{children:r}),v.jsx(WYe,{contentRef:h})]})})})});afe.displayName=kb;var ofe="AlertDialogTitle",lfe=L.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Ty(n);return v.jsx(F5,{...a,...r,ref:t})});lfe.displayName=ofe;var cfe="AlertDialogDescription",ufe=L.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Ty(n);return v.jsx(z5,{...a,...r,ref:t})});ufe.displayName=cfe;var HYe="AlertDialogAction",dfe=L.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=Ty(n);return v.jsx(aI,{...a,...r,ref:t})});dfe.displayName=HYe;var hfe="AlertDialogCancel",ffe=L.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,{cancelRef:a}=qYe(hfe,n),l=Ty(n),h=_s(t,a);return v.jsx(aI,{...l,...r,ref:h})});ffe.displayName=hfe;var WYe=({contentRef:e})=>{const t=`\`${kb}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${kb}\` by passing a \`${cfe}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${kb}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return L.useEffect(()=>{var r;document.getElementById((r=e.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},ZYe=nfe,KYe=rfe,YYe=ife,pfe=sfe,mfe=afe,gfe=dfe,yfe=ffe,vfe=lfe,_fe=ufe;const XYe=ZYe,JYe=KYe,QYe=YYe,xfe=L.forwardRef(({className:e,...t},n)=>v.jsx(pfe,{className:Xn("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));xfe.displayName=pfe.displayName;const bfe=L.forwardRef(({className:e,...t},n)=>v.jsxs(QYe,{children:[v.jsx(xfe,{}),v.jsx(mfe,{ref:n,className:Xn("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));bfe.displayName=mfe.displayName;const wfe=({className:e,...t})=>v.jsx("div",{className:Xn("flex flex-col space-y-2 text-center sm:text-left",e),...t});wfe.displayName="AlertDialogHeader";const Sfe=({className:e,...t})=>v.jsx("div",{className:Xn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Sfe.displayName="AlertDialogFooter";const Afe=L.forwardRef(({className:e,...t},n)=>v.jsx(vfe,{ref:n,className:Xn("text-lg font-semibold",e),...t}));Afe.displayName=vfe.displayName;const Tfe=L.forwardRef(({className:e,...t},n)=>v.jsx(_fe,{ref:n,className:Xn("text-sm text-muted-foreground",e),...t}));Tfe.displayName=_fe.displayName;const Cfe=L.forwardRef(({className:e,...t},n)=>v.jsx(gfe,{ref:n,className:Xn(T6(),e),...t}));Cfe.displayName=gfe.displayName;const Efe=L.forwardRef(({className:e,...t},n)=>v.jsx(yfe,{ref:n,className:Xn(T6({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));Efe.displayName=yfe.displayName;function eXe(e){const t=new Ci,n=t.internal.pageSize.getWidth(),r=t.internal.pageSize.getHeight();let a=20;const l=7,h=20,i=(P,E,j,D)=>{if(D){const B=t.splitTextToSize(P,D);return t.text(B,E,j),j+B.length*l}else return t.text(P,E,j),j+l},y=P=>{a+P>r-h&&(t.addPage(),a=20)};t.setFontSize(20),t.setFont("helvetica","bold"),a=i("MoneyLens Data Export",h,a),a+=10,t.setFontSize(12),t.setFont("helvetica","normal"),a=i(`Exported on: ${new Date(e.exportedAt).toLocaleDateString()}`,h,a),a=i(`Version: ${e.version}`,h,a),a+=15,t.setFontSize(16),t.setFont("helvetica","bold"),a=i("User Profile",h,a),a+=5,t.setFontSize(10),t.setFont("helvetica","normal");const x=e.user.profile;a=i(`Name: ${x.firstName} ${x.lastName}`,h,a),a=i(`Email: ${x.email}`,h,a),a=i(`Monthly Budget Goal: $${x.monthlyBudgetGoal||"Not set"}`,h,a),a=i(`Two-Factor Authentication: ${x.twoFactorEnabled?"Enabled":"Disabled"}`,h,a),a=i(`Account Created: ${new Date(x.createdAt).toLocaleDateString()}`,h,a),a+=15,y(50),t.setFontSize(16),t.setFont("helvetica","bold"),a=i(`Transactions (${e.user.transactions.length})`,h,a),a+=5,t.setFontSize(10),t.setFont("helvetica","normal"),e.user.transactions.length===0?a=i("No transactions found.",h,a):(t.setFont("helvetica","bold"),a=i("Date | Merchant | Amount | Category | Status",h,a),t.setFont("helvetica","normal"),e.user.transactions.slice(0,20).forEach(P=>{y(15);const E=new Date(P.date).toLocaleDateString(),j=`$${P.amount.toFixed(2)}`,D=P.isSimulated?"Simulated":"Real",B=`${E} | ${P.merchant} | ${j} | ${P.category} | ${D}`;a=i(B,h,a,n-2*h)}),e.user.transactions.length>20&&(a+=5,a=i(`... and ${e.user.transactions.length-20} more transactions`,h,a))),a+=15,y(50),t.setFontSize(16),t.setFont("helvetica","bold"),a=i(`Spending Caps (${e.user.spendingCaps.length})`,h,a),a+=5,t.setFontSize(10),t.setFont("helvetica","normal"),e.user.spendingCaps.length===0?a=i("No spending caps found.",h,a):e.user.spendingCaps.forEach(P=>{y(20),a=i(` ${P.name}`,h,a),a=i(`  Type: ${P.type} | Limit: $${P.limit} | Period: ${P.period}`,h,a),a=i(`  Status: ${P.enabled?"Enabled":"Disabled"}`,h,a),P.category&&(a=i(`  Category: ${P.category}`,h,a)),P.merchant&&(a=i(`  Merchant: ${P.merchant}`,h,a)),a+=5}),a+=15,y(50),t.setFontSize(16),t.setFont("helvetica","bold"),a=i(`Notifications (${e.user.notifications.length})`,h,a),a+=5,t.setFontSize(10),t.setFont("helvetica","normal"),e.user.notifications.length===0?a=i("No notifications found.",h,a):(e.user.notifications.slice(0,10).forEach(P=>{y(20),a=i(` ${P.title}`,h,a),a=i(`  ${P.message}`,h,a,n-2*h),a=i(`  Type: ${P.type} | Read: ${P.read?"Yes":"No"}`,h,a),a=i(`  Date: ${new Date(P.createdAt).toLocaleDateString()}`,h,a),a+=5}),e.user.notifications.length>10&&(a+=5,a=i(`... and ${e.user.notifications.length-10} more notifications`,h,a)));const w=t.getNumberOfPages();for(let P=1;P<=w;P++)t.setPage(P),t.setFontSize(8),t.setFont("helvetica","normal"),t.text(`Page ${P} of ${w}`,n-30,r-10);const C=`moneylens-export-${new Date().toISOString().split("T")[0]}.pdf`;t.save(C)}function tXe(){const[e,t]=L.useState([]),[n,r]=L.useState([]),[a,l]=L.useState(!1),[h,i]=L.useState(!1);L.useEffect(()=>{(async()=>{i(!0);try{const C=await vs.getAvailableBanks();t(C.banks)}catch(C){console.error("Error fetching banks:",C),Gn.error("Failed to load available banks")}finally{i(!1)}})()},[]),L.useEffect(()=>{(async()=>{var C;try{const P=await vs.getPlaidAccounts();if((C=P.data)!=null&&C.accounts&&P.data.accounts.length>0){const E=new Map;P.data.accounts.forEach(j=>{var $;const D=(($=j.bankName)==null?void 0:$.toLowerCase().replace(/\s+/g,"_"))||"unknown",B=j.bankName||"Unknown Bank",F=j.bankLogo||"";E.has(D)||E.set(D,{id:D,name:B,logo:F,connectedAt:j.connectedAt||new Date().toISOString(),accounts:[]}),E.get(D).accounts.push({id:j.id,name:j.name,type:j.type,balance:j.balance,mask:j.mask})}),r(Array.from(E.values()))}else r([])}catch(P){console.error("Error checking connected banks:",P),r([])}})()},[]);const y=async w=>{var C;l(!0);try{await vs.connectBank(w),Gn.success("Bank account connected successfully!");const P=await vs.getPlaidAccounts();if((C=P.data)!=null&&C.accounts&&P.data.accounts.length>0){const E=new Map;P.data.accounts.forEach(j=>{var $;const D=(($=j.bankName)==null?void 0:$.toLowerCase().replace(/\s+/g,"_"))||"unknown",B=j.bankName||"Unknown Bank",F=j.bankLogo||"";E.has(D)||E.set(D,{id:D,name:B,logo:F,connectedAt:j.connectedAt||new Date().toISOString(),accounts:[]}),E.get(D).accounts.push({id:j.id,name:j.name,type:j.type,balance:j.balance,mask:j.mask})}),r(Array.from(E.values()))}}catch(P){console.error("Error connecting bank:",P),Gn.error("Failed to connect bank account")}finally{l(!1)}},x=async w=>{l(!0);try{await vs.removePlaidConnection(),r([]),Gn.success("Bank account disconnected")}catch(C){console.error("Error disconnecting:",C),Gn.error("Failed to disconnect bank account")}finally{l(!1)}};return n.length>0?v.jsxs(xr,{className:"border-green-200 bg-green-50/50",children:[v.jsxs(ui,{children:[v.jsxs(di,{className:"flex items-center gap-2 text-green-700",children:[v.jsx(wl,{className:"w-5 h-5"}),"Bank Accounts Connected"]}),v.jsx(cy,{children:"Your bank accounts are connected and syncing transactions."})]}),v.jsx(br,{className:"space-y-4",children:n.map(w=>v.jsxs("div",{className:"p-4 bg-white rounded-lg border",children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("span",{className:"text-2xl",children:w.logo}),v.jsxs("div",{children:[v.jsx("div",{className:"font-medium",children:w.name}),v.jsxs("div",{className:"text-sm text-muted-foreground",children:["Connected ",new Date(w.connectedAt).toLocaleDateString()]})]})]}),v.jsxs($n,{variant:"outline",size:"sm",onClick:()=>x(w.id),disabled:a,className:"border-red-200 text-red-600 hover:bg-red-50",children:[a?v.jsx(J0,{className:"w-4 h-4 animate-spin"}):v.jsx(dxe,{className:"w-4 h-4"}),"Disconnect"]})]}),v.jsx("div",{className:"space-y-2",children:w.accounts.map(C=>v.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(w5,{className:"w-4 h-4 text-gray-600"}),v.jsxs("div",{children:[v.jsx("div",{className:"font-medium text-sm",children:C.name}),v.jsxs("div",{className:"text-xs text-muted-foreground",children:[C.type,"  ****",C.mask]})]})]}),v.jsxs(Is,{variant:"secondary",className:"bg-green-100 text-green-700",children:["$",C.balance.toLocaleString()]})]},C.id))})]},w.id))})]}):v.jsxs(xr,{children:[v.jsxs(ui,{children:[v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(NQ,{className:"w-5 h-5"}),"Connect Your Bank Account"]}),v.jsx(cy,{children:"Choose from popular banks to connect your account and automatically import transactions."})]}),v.jsx(br,{children:v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(wl,{className:"w-4 h-4 text-green-600"}),v.jsx("span",{children:"Secure connection"})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(wl,{className:"w-4 h-4 text-green-600"}),v.jsx("span",{children:"Real-time transactions"})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(wl,{className:"w-4 h-4 text-green-600"}),v.jsx("span",{children:"Automatic categorization"})]})]}),h?v.jsxs("div",{className:"flex items-center justify-center py-8",children:[v.jsx(J0,{className:"w-6 h-6 animate-spin"}),v.jsx("span",{className:"ml-2",children:"Loading banks..."})]}):v.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e==null?void 0:e.map(w=>v.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>y(w.id),children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("span",{className:"text-2xl",children:w.logo}),v.jsxs("div",{children:[v.jsx("div",{className:"font-medium",children:w.name}),v.jsxs("div",{className:"text-sm text-muted-foreground",children:[w.accountCount," account",w.accountCount!==1?"s":""," available"]})]})]}),v.jsxs($n,{size:"sm",disabled:a,className:"ml-auto",children:[a?v.jsx(J0,{className:"w-4 h-4 animate-spin"}):v.jsx(Yb,{className:"w-4 h-4"}),"Connect"]})]},w.id))}),v.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Demo Mode  No real bank connections required"})]})})]})}class nXe extends L.Component{constructor(n){super(n);ni(this,"handleReset",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("ErrorBoundary caught an error:",n,r),this.setState({error:n,errorInfo:r})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:v.jsxs(xr,{className:"border-red-200 bg-red-50/50",children:[v.jsxs(ui,{children:[v.jsxs(di,{className:"flex items-center gap-2 text-red-700",children:[v.jsx(Os,{className:"w-5 h-5"}),"Something went wrong"]}),v.jsx(cy,{children:"An unexpected error occurred. Please try refreshing the page."})]}),v.jsxs(br,{className:"space-y-4",children:[!1,v.jsxs("div",{className:"flex gap-2",children:[v.jsxs($n,{onClick:this.handleReset,variant:"outline",size:"sm",children:[v.jsx(J1,{className:"w-4 h-4 mr-2"}),"Try Again"]}),v.jsx($n,{onClick:()=>window.location.reload(),variant:"default",size:"sm",children:"Refresh Page"})]})]})]}):this.props.children}}const rXe=[{name:"Financial Blue",colors:["#3B82F6","#1D4ED8","#1E40AF","#1E3A8A"]},{name:"Success Green",colors:["#10B981","#059669","#047857","#065F46"]},{name:"Warning Orange",colors:["#F59E0B","#D97706","#B45309","#92400E"]},{name:"Danger Red",colors:["#EF4444","#DC2626","#B91C1C","#991B1B"]},{name:"Purple Premium",colors:["#8B5CF6","#7C3AED","#6D28D9","#5B21B6"]},{name:"Teal Modern",colors:["#14B8A6","#0D9488","#0F766E","#115E59"]},{name:"Pink Elegant",colors:["#EC4899","#DB2777","#BE185D","#9D174D"]},{name:"Indigo Deep",colors:["#6366F1","#4F46E5","#4338CA","#3730A3"]},{name:"Forest Green",colors:["#22C55E","#16A34A","#15803D","#166534"]},{name:"Ocean Blue",colors:["#06B6D4","#0891B2","#0E7490","#155E75"]},{name:"Sunset Orange",colors:["#F97316","#EA580C","#DC2626","#B91C1C"]},{name:"Earth Brown",colors:["#A3A3A3","#737373","#525252","#404040"]},{name:"Slate Gray",colors:["#64748B","#475569","#334155","#1E293B"]},{name:"Neutral Gray",colors:["#6B7280","#4B5563","#374151","#1F2937"]},{name:"Warm Gray",colors:["#78716C","#57534E","#44403C","#292524"]},{name:"Cool Gray",colors:["#6B7280","#4B5563","#374151","#1F2937"]}];function MY(e){let t=e;if(e.startsWith("#")&&(t=e.slice(1)),t.length===3&&(t=t.split("").map(w=>w+w).join("")),!/^[A-Fa-f0-9]{6}$/.test(t))throw new Error("Invalid hex color format");const n=parseInt(t.slice(0,2),16)/255,r=parseInt(t.slice(2,4),16)/255,a=parseInt(t.slice(4,6),16)/255,l=Math.max(n,r,a),h=Math.min(n,r,a);let i=0,y=0,x=(l+h)/2;if(l!==h){const w=l-h;switch(y=x>.5?w/(2-l-h):w/(l+h),l){case n:i=(r-a)/w+(r<a?6:0);break;case r:i=(a-n)/w+2;break;case a:i=(n-r)/w+4;break}i/=6}return`${Math.round(i*360)} ${Math.round(y*100)}% ${Math.round(x*100)}%`}function iXe(e){const t=e.split(" ");if(t.length!==3)throw new Error("Invalid HSL format");const n=parseInt(t[0]),r=parseFloat(t[1].replace("%",""))/100,a=parseFloat(t[2].replace("%",""))/100;if(isNaN(n)||isNaN(r)||isNaN(a))throw new Error("Invalid HSL values");if(n<0||n>=360||r<0||r>1||a<0||a>1)throw new Error("HSL values out of range");const l=(1-Math.abs(2*a-1))*r,h=l*(1-Math.abs(n/60%2-1)),i=a-l/2;let y=0,x=0,w=0;0<=n&&n<60?(y=l,x=h,w=0):60<=n&&n<120?(y=h,x=l,w=0):120<=n&&n<180?(y=0,x=l,w=h):180<=n&&n<240?(y=0,x=h,w=l):240<=n&&n<300?(y=h,x=0,w=l):300<=n&&n<360&&(y=l,x=0,w=h);const C=P=>{const E=Math.round(Math.max(0,Math.min(255,(P+i)*255))).toString(16);return E.length===1?"0"+E:E};return`#${C(y)}${C(x)}${C(w)}`}function sXe({value:e,onChange:t,label:n,className:r}){const[a,l]=L.useState(!1),[h,i]=L.useState(""),[y,x]=L.useState(!0);L.useEffect(()=>{try{const P=iXe(e);i(P),x(!0)}catch{e.startsWith("#")?(i(e),x(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(e))):(i("#3B82F6"),x(!1))}},[e]);const w=P=>{i(P);const j=/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(P);if(x(j),j){const D=MY(P);t(D)}},C=P=>{const E=MY(P);t(E),i(P),x(!0)};return v.jsxs("div",{className:r,children:[n&&v.jsx(Qi,{className:"text-sm font-medium mb-2 block",children:n}),v.jsxs(Gg,{open:a,onOpenChange:l,children:[v.jsx(iA,{asChild:!0,children:v.jsxs($n,{variant:"outline",className:"w-full justify-start gap-2",children:[v.jsx("div",{className:"w-4 h-4 rounded border",style:{backgroundColor:`hsl(${e})`}}),v.jsxs("span",{className:"truncate",children:[h," ",!y&&"(Invalid)"]})]})}),v.jsxs(km,{className:"sm:max-w-md",children:[v.jsx(Im,{children:v.jsxs(Nm,{className:"flex items-center gap-2",children:[v.jsx(FQ,{className:"w-4 h-4"}),"Choose Color"]})}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx(Qi,{htmlFor:"hex-input",children:"Hex Code"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx(ss,{id:"hex-input",value:h,onChange:P=>w(P.target.value),placeholder:"#3B82F6",className:y?"":"border-red-500"}),v.jsx($n,{size:"sm",onClick:()=>C(h),disabled:!y,children:v.jsx(L3,{className:"w-4 h-4"})})]}),!y&&v.jsx("p",{className:"text-xs text-red-500 mt-1",children:"Invalid hex color"})]}),v.jsxs("div",{children:[v.jsx(Qi,{className:"text-sm font-medium mb-2 block",children:"Color Palettes"}),v.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:rXe.map((P,E)=>v.jsxs("div",{className:"space-y-2",children:[v.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:P.name}),v.jsx("div",{className:"flex gap-1",children:P.colors.map((j,D)=>v.jsx("button",{onClick:()=>C(j),className:"w-8 h-8 rounded border-2 border-border hover:border-primary transition-all hover:scale-110",style:{backgroundColor:j},title:j},D))})]},E))})]}),v.jsxs("div",{children:[v.jsx(Qi,{className:"text-sm font-medium mb-2 block",children:"Quick Colors"}),v.jsx("div",{className:"grid grid-cols-8 gap-1",children:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#14B8A6","#EC4899","#6366F1","#22C55E","#06B6D4","#F97316","#A3A3A3","#64748B","#6B7280","#78716C","#6B7280"].map((P,E)=>v.jsx("button",{onClick:()=>C(P),className:"w-6 h-6 rounded border border-border hover:border-primary transition-all hover:scale-110",style:{backgroundColor:P},title:P},E))})]})]})]})]})]})}function aXe(){var fi;W3();const{data:e,isLoading:t}=cte(),{theme:n,setTheme:r,resolvedTheme:a,primaryColor:l,setPrimaryColor:h,colorSchemes:i}=fte(),[y,x]=L.useState({firstName:"",lastName:"",email:"",monthlyBudgetGoal:""}),[w,C]=L.useState({capAlerts:!0,weeklyReports:!0,budgetWarnings:!0,transactionAlerts:!1}),[P,E]=L.useState({defaultLocation:"Blacksburg, VA",mapboxToken:"",showHeatmap:!0,showMerchantPins:!0}),[j,D]=L.useState(!1),[B,F]=L.useState(!1),[$,H]=L.useState(!1),[J,ee]=L.useState(!1),[Q,ne]=L.useState(!1),[pe,he]=L.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[we,fe]=L.useState(!1),[ge,Ce]=L.useState(!1),[xe,Re]=L.useState(!1),[Qe,et]=L.useState(!1),[je,De]=L.useState(!1),[Ct,xt]=L.useState(""),[me,Ye]=L.useState(""),[nt,vt]=L.useState(""),[gt,dt]=L.useState(""),[At,mt]=L.useState(!1),[Pt,Ht]=L.useState(!1),[Ot,Un]=L.useState(!1),[Kt,st]=L.useState(!1),[Dr,Or]=L.useState(!1),[Br,On]=L.useState(!1),[ht,wt]=L.useState(null),[Wt,xn]=L.useState({totalTransactions:0,activeCaps:0,totalNotifications:0,accountAgeDays:0,monthlyBudgetGoal:0});L.useEffect(()=>{e&&x({firstName:e.firstName||"",lastName:e.lastName||"",email:e.email||"",monthlyBudgetGoal:e.monthlyBudgetGoal||0})},[e]),L.useEffect(()=>{(async()=>{try{const bn=await vs.get2FAStatus();bn.success&&De(bn.data.enabled)}catch(bn){console.error("Failed to load 2FA status:",bn)}})()},[]),L.useEffect(()=>{(async()=>{try{const bn=await vs.getDataStats();bn.success&&xn(bn.data)}catch(bn){console.error("Failed to load data stats:",bn)}})()},[]);const Rn=(Cn,bn)=>{x(fr=>({...fr,[Cn]:bn})),ee(!0)},Sn=async()=>{if(!e)return;if(!y.monthlyBudgetGoal||y.monthlyBudgetGoal===""||y.monthlyBudgetGoal===0){Gn.error("Invalid budget goal",{description:"Please enter a valid monthly budget goal greater than $0",duration:5e3});return}D(!0);const Cn=Gn.loading("Saving your changes...",{description:"Please wait while we update your profile"});try{const bn={...y,monthlyBudgetGoal:typeof y.monthlyBudgetGoal=="string"?parseFloat(y.monthlyBudgetGoal):y.monthlyBudgetGoal},fr=await vs.updateProfile(bn);fr.success?(Gn.dismiss(Cn),Gn.success("Profile updated successfully!",{description:"Your account changes have been saved",duration:4e3}),ee(!1),setTimeout(()=>{window.location.reload()},1e3)):(Gn.dismiss(Cn),Gn.error("Failed to update profile",{description:fr.message||"Please try again",duration:5e3}))}catch(bn){console.error("Profile update error:",bn),Gn.dismiss(Cn),Gn.error("Failed to update profile",{description:bn.message||"Please check your connection and try again",duration:5e3})}finally{D(!1)}},Mn=async()=>{F(!0);const Cn=Gn.loading("Saving notification preferences...",{description:"Updating your notification settings"});try{await new Promise(bn=>setTimeout(bn,1e3)),Gn.dismiss(Cn),Gn.success("Notification preferences saved!",{description:"Your notification settings have been updated",duration:3e3})}catch{Gn.dismiss(Cn),Gn.error("Failed to save notifications",{description:"Please try again",duration:4e3})}finally{F(!1)}},Ar=async()=>{H(!0);const Cn=Gn.loading("Saving map settings...",{description:"Updating your map configuration"});try{await new Promise(bn=>setTimeout(bn,1e3)),Gn.dismiss(Cn),Gn.success("Map settings saved!",{description:"Your map configuration has been updated",duration:3e3})}catch{Gn.dismiss(Cn),Gn.error("Failed to save map settings",{description:"Please try again",duration:4e3})}finally{H(!1)}},Pr=async()=>{if(pe.newPassword!==pe.confirmPassword){Gn.error("Passwords do not match",{description:"Please ensure both new passwords are identical",duration:4e3});return}if(pe.newPassword.length<6){Gn.error("Password too short",{description:"Password must be at least 6 characters long",duration:4e3});return}ne(!0);const Cn=Gn.loading("Changing password...",{description:"Please wait while we update your password"});try{const bn=await vs.changePassword({currentPassword:pe.currentPassword,newPassword:pe.newPassword});bn.success?(Gn.dismiss(Cn),Gn.success("Password changed successfully!",{description:"Your password has been updated",duration:4e3}),he({currentPassword:"",newPassword:"",confirmPassword:""}),fe(!1)):(Gn.dismiss(Cn),Gn.error("Failed to change password",{description:bn.message||"Please check your current password and try again",duration:5e3}))}catch(bn){console.error("Password change error:",bn),Gn.dismiss(Cn),Gn.error("Failed to change password",{description:bn.message||"Please check your current password and try again",duration:5e3})}finally{ne(!1)}},wr=async()=>{Ce(!0);const Cn=Gn.loading("Setting up 2FA...",{description:"Generating QR code and secret"});try{const bn=await vs.setup2FA();bn.success?(xt(bn.data.secret),Ye(bn.data.qrCode),vt(bn.data.manualEntryKey),mt(!0),Gn.dismiss(Cn),Gn.success("2FA setup initiated!",{description:"Scan the QR code with your authenticator app",duration:4e3})):(Gn.dismiss(Cn),Gn.error("Failed to setup 2FA",{description:bn.message||"Please try again",duration:5e3}))}catch(bn){console.error("2FA setup error:",bn),Gn.dismiss(Cn),Gn.error("Failed to setup 2FA",{description:bn.message||"Please try again",duration:5e3})}finally{Ce(!1)}},Qr=async()=>{if(!gt){Gn.error("Please enter verification code",{description:"Enter the 6-digit code from your authenticator app",duration:4e3});return}Re(!0);const Cn=Gn.loading("Verifying 2FA...",{description:"Please wait while we verify your code"});try{const bn=await vs.verify2FASetup(gt);bn.success?(De(!0),mt(!1),Ht(!1),dt(""),Gn.dismiss(Cn),Gn.success("2FA enabled successfully!",{description:"Your account is now protected with two-factor authentication",duration:5e3})):(Gn.dismiss(Cn),Gn.error("Verification failed",{description:bn.message||"Please check your code and try again",duration:5e3}))}catch(bn){console.error("2FA verification error:",bn),Gn.dismiss(Cn),Gn.error("Verification failed",{description:bn.message||"Please check your code and try again",duration:5e3})}finally{Re(!1)}},dr=async()=>{if(!gt){Gn.error("Please enter verification code",{description:"Enter the 6-digit code from your authenticator app",duration:4e3});return}et(!0);const Cn=Gn.loading("Disabling 2FA...",{description:"Please wait while we disable two-factor authentication"});try{const bn=await vs.disable2FA(gt);bn.success?(De(!1),Ht(!1),dt(""),Gn.dismiss(Cn),Gn.success("2FA disabled successfully!",{description:"Your account is no longer protected with two-factor authentication",duration:5e3})):(Gn.dismiss(Cn),Gn.error("Failed to disable 2FA",{description:bn.message||"Please check your code and try again",duration:5e3}))}catch(bn){console.error("2FA disable error:",bn),Gn.dismiss(Cn),Gn.error("Failed to disable 2FA",{description:bn.message||"Please check your code and try again",duration:5e3})}finally{et(!1)}},Hi=async()=>{Un(!0);const Cn=Gn.loading("Exporting your data...",{description:"Preparing your data for download"});try{const bn=await vs.exportData();bn.success?(eXe(bn.data),Gn.dismiss(Cn),Gn.success("Data exported successfully!",{description:"Your data has been downloaded as PDF",duration:4e3})):(Gn.dismiss(Cn),Gn.error("Failed to export data",{description:bn.message||"Please try again",duration:5e3}))}catch(bn){console.error("Data export error:",bn),Gn.dismiss(Cn),Gn.error("Failed to export data",{description:bn.message||"Please try again",duration:5e3})}finally{Un(!1)}},Bi=async()=>{if(!ht){Gn.error("Please select a file to import",{description:"Choose a valid JSON export file",duration:4e3});return}st(!0);const Cn=Gn.loading("Importing your data...",{description:"Please wait while we process your data"});try{const bn=await ht.text(),fr=JSON.parse(bn),Ur=await vs.importData(fr);if(Ur.success){On(!1),wt(null),Gn.dismiss(Cn),Gn.success("Data imported successfully!",{description:"Your data has been restored",duration:5e3});const Xs=await vs.getDataStats();Xs.success&&xn(Xs.data),setTimeout(()=>{window.location.reload()},2e3)}else Gn.dismiss(Cn),Gn.error("Failed to import data",{description:Ur.message||"Please check your file and try again",duration:5e3})}catch(bn){console.error("Data import error:",bn),Gn.dismiss(Cn),Gn.error("Failed to import data",{description:bn.message||"Invalid file format. Please use a valid export file.",duration:5e3})}finally{st(!1)}},Cr=async()=>{Or(!0);const Cn=Gn.loading("Deleting all data...",{description:"This action cannot be undone"});try{const bn=await vs.deleteAllData();if(bn.success){Gn.dismiss(Cn),Gn.success("All data deleted successfully!",{description:"Your account has been reset",duration:5e3});const fr=await vs.getDataStats();fr.success&&xn(fr.data),setTimeout(()=>{window.location.reload()},2e3)}else Gn.dismiss(Cn),Gn.error("Failed to delete data",{description:bn.message||"Please try again",duration:5e3})}catch(bn){console.error("Data deletion error:",bn),Gn.dismiss(Cn),Gn.error("Failed to delete data",{description:bn.message||"Please try again",duration:5e3})}finally{Or(!1)}};return v.jsxs(ol.div,{className:"h-full min-h-screen space-y-6 p-6",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[v.jsxs("div",{children:[v.jsx("h1",{className:"text-3xl font-bold",children:"Settings"}),v.jsx("p",{className:"text-muted-foreground",children:"Manage your preferences and application configuration"})]}),v.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[v.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[v.jsx(nXe,{children:v.jsx(tXe,{})}),v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(UQ,{className:"w-5 h-5"}),"Profile Settings"]})}),v.jsxs(br,{className:"space-y-4",children:[v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"text-sm font-medium",children:"First Name"}),v.jsx(ss,{value:y.firstName,onChange:Cn=>Rn("firstName",Cn.target.value),disabled:t})]}),v.jsxs("div",{children:[v.jsx("label",{className:"text-sm font-medium",children:"Last Name"}),v.jsx(ss,{value:y.lastName,onChange:Cn=>Rn("lastName",Cn.target.value),disabled:t})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"text-sm font-medium",children:"Email Address"}),v.jsx(ss,{value:y.email,onChange:Cn=>Rn("email",Cn.target.value),type:"email",disabled:t})]}),v.jsxs("div",{children:[v.jsx("label",{className:"text-sm font-medium",children:"Monthly Budget Goal"}),v.jsxs("div",{className:"relative",children:[v.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground",children:"$"}),v.jsx(ss,{value:y.monthlyBudgetGoal===0?"":y.monthlyBudgetGoal,onChange:Cn=>{const bn=Cn.target.value;if(bn==="")Rn("monthlyBudgetGoal","");else{const fr=parseFloat(bn);!isNaN(fr)&&fr>0&&Rn("monthlyBudgetGoal",fr)}},className:"pl-8",type:"number",min:"0.01",step:"0.01",placeholder:"Enter your monthly budget goal",disabled:t})]})]}),v.jsx($n,{onClick:Sn,disabled:j||t,className:`w-full ${J?"ring-2 ring-primary ring-opacity-50":""}`,children:j?"Saving...":J?"Save Profile Changes ":"Save Profile Changes"})]})]}),v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(lv,{className:"w-5 h-5"}),"Notification Preferences"]})}),v.jsxs(br,{className:"space-y-4",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("p",{className:"font-medium",children:"Spending Cap Alerts"}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"Get notified when you approach spending limits"})]}),v.jsx(wm,{checked:w.capAlerts,onCheckedChange:Cn=>C({...w,capAlerts:Cn})})]}),v.jsx(of,{}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("p",{className:"font-medium",children:"Weekly Reports"}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive weekly spending summaries"})]}),v.jsx(wm,{checked:w.weeklyReports,onCheckedChange:Cn=>C({...w,weeklyReports:Cn})})]}),v.jsx(of,{}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("p",{className:"font-medium",children:"Budget Warnings"}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"Alert when approaching monthly budget limit"})]}),v.jsx(wm,{checked:w.budgetWarnings,onCheckedChange:Cn=>C({...w,budgetWarnings:Cn})})]}),v.jsx(of,{}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("p",{className:"font-medium",children:"Transaction Alerts"}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"Instant notifications for all transactions"})]}),v.jsx(wm,{checked:w.transactionAlerts,onCheckedChange:Cn=>C({...w,transactionAlerts:Cn})})]}),v.jsx($n,{onClick:Mn,disabled:B,className:"w-full",children:B?"Saving...":"Save Notification Preferences"})]})]}),v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(R3,{className:"w-5 h-5"}),"Map Configuration"]})}),v.jsxs(br,{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"text-sm font-medium",children:"Default Location"}),v.jsx(ss,{value:P.defaultLocation,onChange:Cn=>E({...P,defaultLocation:Cn.target.value})})]}),v.jsxs("div",{children:[v.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:["Mapbox Access Token",v.jsx(Is,{variant:"outline",className:"text-xs",children:"Required"})]}),v.jsx(ss,{type:"password",placeholder:"pk.eyJ1...",value:P.mapboxToken,onChange:Cn=>E({...P,mapboxToken:Cn.target.value})}),v.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Get your free token from ",v.jsx("a",{href:"https://mapbox.com",target:"_blank",className:"text-primary underline",children:"mapbox.com"})]})]}),v.jsx(of,{}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("p",{className:"font-medium",children:"Show Spending Heatmap"}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"Display color-coded spending intensity"})]}),v.jsx(wm,{checked:P.showHeatmap,onCheckedChange:Cn=>E({...P,showHeatmap:Cn})})]}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("p",{className:"font-medium",children:"Show Merchant Pins"}),v.jsx("p",{className:"text-sm text-muted-foreground",children:"Display clickable merchant markers"})]}),v.jsx(wm,{checked:P.showMerchantPins,onCheckedChange:Cn=>E({...P,showMerchantPins:Cn})})]}),v.jsx($n,{onClick:Ar,disabled:$,className:"w-full",children:$?"Saving...":"Save Map Settings"})]})]}),v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(GE,{className:"w-5 h-5"}),"Data Management"]})}),v.jsxs(br,{className:"space-y-6",children:[v.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[v.jsxs("div",{className:"text-center p-3 bg-muted/30 rounded-lg",children:[v.jsx("div",{className:"text-2xl font-bold text-primary",children:Wt.totalTransactions}),v.jsx("div",{className:"text-xs text-muted-foreground",children:"Transactions"})]}),v.jsxs("div",{className:"text-center p-3 bg-muted/30 rounded-lg",children:[v.jsx("div",{className:"text-2xl font-bold text-primary",children:Wt.activeCaps}),v.jsx("div",{className:"text-xs text-muted-foreground",children:"Active Caps"})]}),v.jsxs("div",{className:"text-center p-3 bg-muted/30 rounded-lg",children:[v.jsx("div",{className:"text-2xl font-bold text-primary",children:Wt.totalNotifications}),v.jsx("div",{className:"text-xs text-muted-foreground",children:"Notifications"})]}),v.jsxs("div",{className:"text-center p-3 bg-muted/30 rounded-lg",children:[v.jsx("div",{className:"text-2xl font-bold text-primary",children:Wt.accountAgeDays}),v.jsx("div",{className:"text-xs text-muted-foreground",children:"Days Old"})]})]}),v.jsx(of,{}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[v.jsxs($n,{variant:"outline",className:"flex items-center gap-2",onClick:Hi,disabled:Ot,children:[v.jsx(D3,{className:"w-4 h-4"}),Ot?"Exporting...":"Export as PDF"]}),v.jsxs(Gg,{open:Br,onOpenChange:On,children:[v.jsx(iA,{asChild:!0,children:v.jsxs($n,{variant:"outline",className:"flex items-center gap-2",children:[v.jsx(hxe,{className:"w-4 h-4"}),"Import Data"]})}),v.jsxs(km,{className:"sm:max-w-md",children:[v.jsx(Im,{children:v.jsx(Nm,{children:"Import Data"})}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx(Qi,{htmlFor:"importFile",className:"text-sm font-medium",children:"Select Export File"}),v.jsx(ss,{id:"importFile",type:"file",accept:".json",onChange:Cn=>{var bn;return wt(((bn=Cn.target.files)==null?void 0:bn[0])||null)},className:"mt-2"}),v.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Choose a MoneyLens export file (.json)"})]}),v.jsxs("div",{className:"p-3 bg-warning/10 rounded-lg border border-warning/20",children:[v.jsx("p",{className:"text-sm text-warning font-medium mb-1",children:" Warning"}),v.jsx("p",{className:"text-xs text-muted-foreground",children:"Importing data will replace all your current data. This action cannot be undone."})]}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx($n,{onClick:Bi,disabled:Kt||!ht,className:"flex-1",children:Kt?"Importing...":"Import Data"}),v.jsx($n,{variant:"outline",onClick:()=>{On(!1),wt(null)},disabled:Kt,children:"Cancel"})]})]})]})]})]}),v.jsx(of,{}),v.jsxs("div",{className:"p-4 bg-danger/10 rounded-lg border border-danger/20",children:[v.jsx("h4",{className:"font-semibold text-danger mb-2",children:"Danger Zone"}),v.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"This action cannot be undone. All your data will be permanently deleted."}),v.jsxs(XYe,{children:[v.jsx(JYe,{asChild:!0,children:v.jsxs($n,{variant:"destructive",size:"sm",className:"flex items-center gap-2",disabled:Dr,children:[v.jsx(wF,{className:"w-4 h-4"}),Dr?"Deleting...":"Delete All Data"]})}),v.jsxs(bfe,{children:[v.jsxs(wfe,{children:[v.jsx(Afe,{children:"Are you absolutely sure?"}),v.jsxs(Tfe,{children:["This action cannot be undone. This will permanently delete all your:",v.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[v.jsxs("li",{children:["Transactions (",Wt.totalTransactions,")"]}),v.jsxs("li",{children:["Spending caps (",Wt.activeCaps,")"]}),v.jsxs("li",{children:["Notifications (",Wt.totalNotifications,")"]}),v.jsx("li",{children:"Account preferences and settings"})]}),v.jsx("br",{}),"Your account will remain but all data will be reset to default values."]})]}),v.jsxs(Sfe,{children:[v.jsx(Efe,{disabled:Dr,children:"Cancel"}),v.jsx(Cfe,{onClick:Cr,disabled:Dr,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:Dr?"Deleting...":"Yes, delete all data"})]})]})]})]})]})]})]}),v.jsxs("div",{className:"space-y-6",children:[v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(FQ,{className:"w-5 h-5"}),"Appearance"]})}),v.jsxs(br,{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"text-sm font-medium mb-3 block",children:"Theme"}),v.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[v.jsxs($n,{variant:n==="light"?"default":"outline",size:"sm",onClick:()=>r("light"),className:"flex items-center gap-2",children:[v.jsx(BQ,{className:"w-4 h-4"}),"Light"]}),v.jsxs($n,{variant:n==="dark"?"default":"outline",size:"sm",onClick:()=>r("dark"),className:"flex items-center gap-2",children:[v.jsx(OQ,{className:"w-4 h-4"}),"Dark"]}),v.jsxs($n,{variant:n==="system"?"default":"outline",size:"sm",onClick:()=>r("system"),className:"flex items-center gap-2",children:[v.jsx(jQ,{className:"w-4 h-4"}),"System"]})]}),v.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Current theme: ",a," ",n==="system"&&"(follows system)"]})]}),v.jsx(of,{}),v.jsxs("div",{children:[v.jsx("label",{className:"text-sm font-medium mb-3 block",children:"Primary Color"}),v.jsx("div",{className:"grid grid-cols-2 gap-2 mb-4",children:i.map(Cn=>v.jsxs("button",{onClick:()=>{h(Cn.primary),Gn.success("Primary color updated!",{description:`Switched to ${Cn.name} theme`,duration:2e3})},className:`p-3 rounded-lg border-2 transition-all hover:scale-105 ${l===Cn.primary?"border-primary ring-2 ring-primary ring-opacity-50":"border-border hover:border-primary/50"}`,title:Cn.description,children:[v.jsx("div",{className:"w-full h-6 rounded-md mb-2",style:{backgroundColor:`hsl(${Cn.primary})`}}),v.jsx("div",{className:"text-xs font-medium text-left",children:Cn.name})]},Cn.primary))}),v.jsx("div",{className:"mb-4",children:v.jsx(sXe,{value:l,onChange:Cn=>{h(Cn),Gn.success("Custom color applied!",{description:"Primary color updated with custom selection",duration:2e3})},label:"Custom Primary Color"})}),v.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Current: ",((fi=i.find(Cn=>Cn.primary===l))==null?void 0:fi.name)||"Custom Color"]})]})]})]}),v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx($m,{className:"w-5 h-5"}),"Security"]})}),v.jsxs(br,{className:"space-y-4",children:[v.jsxs(Gg,{open:we,onOpenChange:fe,children:[v.jsx(iA,{asChild:!0,children:v.jsx($n,{variant:"outline",className:"w-full",children:"Change Password"})}),v.jsxs(km,{className:"sm:max-w-md",children:[v.jsx(Im,{children:v.jsx(Nm,{children:"Change Password"})}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx(Qi,{htmlFor:"currentPassword",children:"Current Password"}),v.jsx(ss,{id:"currentPassword",type:"password",value:pe.currentPassword,onChange:Cn=>he(bn=>({...bn,currentPassword:Cn.target.value})),placeholder:"Enter your current password"})]}),v.jsxs("div",{children:[v.jsx(Qi,{htmlFor:"newPassword",children:"New Password"}),v.jsx(ss,{id:"newPassword",type:"password",value:pe.newPassword,onChange:Cn=>he(bn=>({...bn,newPassword:Cn.target.value})),placeholder:"Enter your new password"})]}),v.jsxs("div",{children:[v.jsx(Qi,{htmlFor:"confirmPassword",children:"Confirm New Password"}),v.jsx(ss,{id:"confirmPassword",type:"password",value:pe.confirmPassword,onChange:Cn=>he(bn=>({...bn,confirmPassword:Cn.target.value})),placeholder:"Confirm your new password"})]}),v.jsxs("div",{className:"flex gap-2 pt-2",children:[v.jsx($n,{onClick:Pr,disabled:Q||!pe.currentPassword||!pe.newPassword||!pe.confirmPassword,className:"flex-1",children:Q?"Changing...":"Change Password"}),v.jsx($n,{variant:"outline",onClick:()=>fe(!1),disabled:Q,children:"Cancel"})]})]})]})]}),v.jsxs(Gg,{open:Pt,onOpenChange:Ht,children:[v.jsx(iA,{asChild:!0,children:v.jsx($n,{variant:"outline",className:"w-full",onClick:()=>Ht(!0),children:je?"Disable 2FA":"Enable 2FA"})}),v.jsxs(km,{className:"sm:max-w-md",children:[v.jsx(Im,{className:"pb-4",children:v.jsx(Nm,{children:je?"Disable Two-Factor Authentication":"Enable Two-Factor Authentication"})}),v.jsx("div",{className:"space-y-6",children:je?v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"text-center space-y-3",children:[v.jsx("p",{className:"text-sm font-medium text-destructive",children:" Disabling 2FA will reduce your account security"}),v.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter the 6-digit code from your authenticator app to disable 2FA."})]}),v.jsx("div",{className:"space-y-3",children:v.jsxs("div",{children:[v.jsx(Qi,{htmlFor:"disableToken",className:"text-sm font-medium",children:"Verification Code"}),v.jsx(ss,{id:"disableToken",type:"text",value:gt,onChange:Cn=>dt(Cn.target.value),placeholder:"000000",maxLength:6,className:"mt-2 text-center text-lg font-mono tracking-widest"})]})}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx($n,{onClick:dr,disabled:Qe||!gt,variant:"destructive",className:"flex-1",size:"lg",children:Qe?"Disabling...":"Disable 2FA"}),v.jsx($n,{variant:"outline",onClick:()=>Ht(!1),disabled:Qe,size:"lg",children:"Cancel"})]})]}):v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"text-center space-y-3",children:[v.jsx("p",{className:"text-sm font-medium",children:"Ready to secure your account?"}),v.jsx("p",{className:"text-xs text-muted-foreground",children:'Click "Setup 2FA" to generate a QR code for your authenticator app.'})]}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx($n,{onClick:wr,disabled:ge,className:"flex-1",size:"lg",children:ge?"Setting up...":"Setup 2FA"}),v.jsx($n,{variant:"outline",onClick:()=>Ht(!1),disabled:ge,size:"lg",children:"Cancel"})]})]})})]})]}),v.jsx(Gg,{open:At,onOpenChange:mt,children:v.jsxs(km,{className:"sm:max-w-lg",children:[v.jsx(Im,{className:"pb-4",children:v.jsx(Nm,{children:"Complete 2FA Setup"})}),v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{className:"text-center space-y-4",children:[v.jsxs("div",{children:[v.jsx("p",{className:"text-sm font-medium mb-2",children:"Scan this QR code with your authenticator app:"}),v.jsx("p",{className:"text-xs text-muted-foreground",children:"Use Google Authenticator, Authy, or any TOTP-compatible app"})]}),me&&v.jsx("div",{className:"flex justify-center p-4 bg-muted/30 rounded-lg border-2 border-dashed border-muted-foreground/25",children:v.jsx("img",{src:me,alt:"2FA QR Code",className:"w-40 h-40 rounded-lg shadow-sm"})})]}),v.jsx("div",{className:"space-y-3",children:v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-sm font-medium mb-2",children:"Can't scan the QR code?"}),v.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Enter this key manually in your authenticator app:"}),v.jsx("div",{className:"bg-muted p-3 rounded-lg border",children:v.jsx("code",{className:"text-sm font-mono break-all text-foreground",children:nt})})]})}),v.jsxs("div",{className:"space-y-3",children:[v.jsx(of,{}),v.jsxs("div",{children:[v.jsx(Qi,{htmlFor:"verifyToken",className:"text-sm font-medium",children:"Verification Code"}),v.jsx(ss,{id:"verifyToken",type:"text",value:gt,onChange:Cn=>dt(Cn.target.value),placeholder:"000000",maxLength:6,className:"mt-2 text-center text-lg font-mono tracking-widest"}),v.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Enter the 6-digit code from your authenticator app"})]})]}),v.jsxs("div",{className:"flex gap-3 pt-2",children:[v.jsx($n,{onClick:Qr,disabled:xe||!gt,className:"flex-1",size:"lg",children:xe?"Verifying...":"Verify & Enable 2FA"}),v.jsx($n,{variant:"outline",onClick:()=>{mt(!1),dt("")},disabled:xe,size:"lg",children:"Cancel"})]})]})]})}),v.jsx(of,{}),v.jsxs("div",{className:"text-center space-y-2",children:[v.jsx(Is,{variant:je?"default":"secondary",className:"text-xs",children:je?"2FA Enabled":"2FA Disabled"}),v.jsx("div",{children:v.jsx(Is,{variant:"secondary",className:"text-xs",children:"Last login: 2 hours ago"})})]})]})]}),v.jsxs(xr,{className:"card-gradient",children:[v.jsx(ui,{children:v.jsx(di,{children:"Account Overview"})}),v.jsxs(br,{className:"space-y-3",children:[v.jsxs("div",{className:"flex justify-between text-sm",children:[v.jsx("span",{children:"Total Transactions"}),v.jsx("span",{className:"font-semibold",children:Wt.totalTransactions})]}),v.jsxs("div",{className:"flex justify-between text-sm",children:[v.jsx("span",{children:"Active Caps"}),v.jsx("span",{className:"font-semibold",children:Wt.activeCaps})]}),v.jsxs("div",{className:"flex justify-between text-sm",children:[v.jsx("span",{children:"Account Age"}),v.jsxs("span",{className:"font-semibold",children:[Wt.accountAgeDays," days"]})]}),v.jsxs("div",{className:"flex justify-between text-sm",children:[v.jsx("span",{children:"Monthly Budget"}),v.jsxs("span",{className:"font-semibold",children:["$",Wt.monthlyBudgetGoal]})]})]})]})]})]})]})}const oXe=()=>{const{isActive:e,isTracking:t,currentLocation:n,lastRiskAssessment:r,activateAgent:a,deactivateAgent:l,startLocationTracking:h,stopLocationTracking:i,getSpendingPatterns:y,getHighRiskMerchants:x,getLocationHistory:w,updatePreferences:C,getPreferences:P,getGeofences:E,getNearbyGeofences:j,alerts:D}=yy(),[B,F]=L.useState(!1),[$,H]=L.useState(P()),[J,ee]=L.useState(y()),[Q,ne]=L.useState(x()),[pe,he]=L.useState(E()),[we,fe]=L.useState(j());L.useEffect(()=>{const Re=setInterval(()=>{ee(y()),ne(x()),he(E()),fe(j())},5e3);return()=>clearInterval(Re)},[y,x,E,j]);const ge=(Re,Qe)=>{const et={...$,[Re]:Qe};H(et),C(et)},Ce=Re=>{switch(Re){case"critical":return"bg-red-500";case"danger":return"bg-orange-500";case"warning":return"bg-yellow-500";case"caution":return"bg-blue-500";case"safe":return"bg-green-500";default:return"bg-gray-500"}},xe=Re=>{switch(Re){case"critical":return v.jsx(mb,{className:"w-4 h-4"});case"danger":return v.jsx(Os,{className:"w-4 h-4"});case"warning":return v.jsx(Os,{className:"w-4 h-4"});case"caution":return v.jsx(RQ,{className:"w-4 h-4"});case"safe":return v.jsx(wl,{className:"w-4 h-4"});default:return v.jsx(CA,{className:"w-4 h-4"})}};return v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center space-x-3",children:[v.jsx($m,{className:"w-8 h-8 text-blue-600"}),v.jsxs("div",{children:[v.jsx("h2",{className:"text-2xl font-bold",children:"Financial Bodyguard"}),v.jsx("p",{className:"text-muted-foreground",children:"AI-powered spending protection"})]})]}),v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsxs($n,{variant:e?"destructive":"default",onClick:e?l:a,className:"flex items-center space-x-2",children:[e?v.jsx(mb,{className:"w-4 h-4"}):v.jsx($m,{className:"w-4 h-4"}),v.jsx("span",{children:e?"Deactivate":"Activate"})]}),v.jsxs($n,{variant:"outline",onClick:()=>F(!B),className:"flex items-center space-x-2",children:[v.jsx(xF,{className:"w-4 h-4"}),v.jsx("span",{children:"Settings"})]})]})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[v.jsxs(xr,{children:[v.jsx(ui,{className:"pb-2",children:v.jsx(di,{className:"text-sm font-medium",children:"Agent Status"})}),v.jsx(br,{children:v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx("div",{className:`w-3 h-3 rounded-full ${e?"bg-green-500":"bg-gray-400"}`}),v.jsx("span",{className:"text-sm",children:e?"Active":"Inactive"})]})})]}),v.jsxs(xr,{children:[v.jsx(ui,{className:"pb-2",children:v.jsx(di,{className:"text-sm font-medium",children:"Location Tracking"})}),v.jsx(br,{children:v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx("div",{className:`w-3 h-3 rounded-full ${t?"bg-green-500":"bg-gray-400"}`}),v.jsx("span",{className:"text-sm",children:t?"Tracking":"Stopped"})]})})]}),v.jsxs(xr,{children:[v.jsx(ui,{className:"pb-2",children:v.jsx(di,{className:"text-sm font-medium",children:"Current Location"})}),v.jsx(br,{children:v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx(od,{className:"w-4 h-4 text-muted-foreground"}),v.jsx("span",{className:"text-sm",children:n?`${n.lat.toFixed(4)}, ${n.lng.toFixed(4)}`:"Unknown"})]})})]})]}),r&&v.jsxs(xr,{children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center space-x-2",children:[xe(r.level),v.jsx("span",{children:"Latest Risk Assessment"})]})}),v.jsx(br,{children:v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx(Is,{className:`${Ce(r.level)} text-white`,children:r.level.toUpperCase()}),v.jsxs("span",{className:"text-2xl font-bold",children:[r.score,"/100"]})]}),v.jsxs(wp,{children:[v.jsx(Os,{className:"h-4 w-4"}),v.jsx(Sp,{children:r.recommendation})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("h4",{className:"font-medium",children:"Risk Factors:"}),r.factors.map((Re,Qe)=>v.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted rounded",children:[v.jsx("span",{className:"text-sm",children:Re.message}),v.jsx(Is,{variant:"outline",children:Re.severity})]},Qe))]})]})})]}),v.jsxs(xr,{children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center space-x-2",children:[v.jsx(Ju,{className:"w-5 h-5"}),v.jsx("span",{children:"Spending Patterns"})]})}),v.jsx(br,{children:v.jsx("div",{className:"space-y-3",children:J.length>0?J.map((Re,Qe)=>v.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[v.jsxs("div",{children:[v.jsx("div",{className:"font-medium",children:Re.merchant}),v.jsxs("div",{className:"text-sm text-muted-foreground",children:["$",Re.totalSpent.toFixed(2),"  ",Re.visitCount," visits"]})]}),v.jsx(Is,{className:Re.riskLevel==="high"?"bg-red-500":Re.riskLevel==="medium"?"bg-yellow-500":"bg-green-500",children:Re.riskLevel})]},`dashboard-pattern-${Re.merchant}-${Qe}`)):v.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No spending patterns detected yet"})})})]}),Q.length>0&&v.jsxs(xr,{children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center space-x-2",children:[v.jsx(Os,{className:"w-5 h-5 text-red-500"}),v.jsx("span",{children:"High-Risk Merchants"})]})}),v.jsx(br,{children:v.jsx("div",{className:"space-y-2",children:Q.map((Re,Qe)=>v.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-red-50 border border-red-200 rounded",children:[v.jsx(mb,{className:"w-4 h-4 text-red-500"}),v.jsx("span",{className:"text-sm font-medium",children:Re})]},`dashboard-risk-${Re}-${Qe}`))})})]}),v.jsxs(xr,{children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center space-x-2",children:[v.jsx(od,{className:"w-5 h-5"}),v.jsx("span",{children:"Geofences"})]})}),v.jsx(br,{children:v.jsx("div",{className:"space-y-3",children:pe.length>0?pe.map((Re,Qe)=>v.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[v.jsxs("div",{children:[v.jsx("div",{className:"font-medium",children:Re.name}),v.jsxs("div",{className:"text-sm text-muted-foreground",children:[Re.type,"  ",Re.radius,"m radius"]})]}),v.jsx(Is,{variant:"outline",children:Re.type})]},`dashboard-geofence-${Re.id}-${Qe}`)):v.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No geofences configured"})})})]}),B&&v.jsxs(xr,{children:[v.jsx(ui,{children:v.jsx(di,{children:"Settings"})}),v.jsxs(br,{className:"space-y-4",children:[v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{htmlFor:"dailyLimit",children:"Daily Limit ($)"}),v.jsx(ss,{id:"dailyLimit",type:"number",value:$.dailyLimit,onChange:Re=>ge("dailyLimit",parseInt(Re.target.value))})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{htmlFor:"weeklyLimit",children:"Weekly Limit ($)"}),v.jsx(ss,{id:"weeklyLimit",type:"number",value:$.weeklyLimit,onChange:Re=>ge("weeklyLimit",parseInt(Re.target.value))})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{htmlFor:"monthlyLimit",children:"Monthly Limit ($)"}),v.jsx(ss,{id:"monthlyLimit",type:"number",value:$.monthlyLimit,onChange:Re=>ge("monthlyLimit",parseInt(Re.target.value))})]})]}),v.jsx(of,{}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx(Qi,{htmlFor:"locationTracking",children:"Location Tracking"}),v.jsx(wm,{id:"locationTracking",checked:$.enableLocationTracking,onCheckedChange:Re=>ge("enableLocationTracking",Re)})]}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx(Qi,{htmlFor:"realTimeAlerts",children:"Real-time Alerts"}),v.jsx(wm,{id:"realTimeAlerts",checked:$.enableRealTimeAlerts,onCheckedChange:Re=>ge("enableRealTimeAlerts",Re)})]})]})]})]}),D.length>0&&v.jsxs(xr,{children:[v.jsx(ui,{children:v.jsx(di,{children:"Recent Alerts"})}),v.jsx(br,{children:v.jsx("div",{className:"space-y-2",children:D.slice(-5).map(Re=>v.jsxs(wp,{className:Re.dismissed?"opacity-50":"",children:[v.jsx(Os,{className:"h-4 w-4"}),v.jsx(Sp,{children:Re.message})]},`dashboard-alert-${Re.id}`))})})]})]})},lXe=()=>{const e=yy();if(!e)return v.jsxs(xr,{children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx($m,{className:"w-5 h-5"}),"Financial Bodyguard Controls"]})}),v.jsx(br,{children:v.jsx("p",{className:"text-sm text-muted-foreground",children:"Financial Bodyguard context not available. Please ensure the agent is properly initialized."})})]});const{isActive:t,isTracking:n,currentLocation:r,activateAgent:a,deactivateAgent:l,startLocationTracking:h,stopLocationTracking:i,assessTransactionRisk:y,addTransaction:x,getSpendingPatterns:w,getHighRiskMerchants:C,alerts:P}=e,[E,j]=L.useState("50"),[D,B]=L.useState("Starbucks"),[F,$]=L.useState("Food & Dining"),[H,J]=L.useState(null),ee=()=>{a()},Q=()=>{l()},ne=async()=>{try{await h()}catch(Ce){console.error("Failed to start location tracking:",Ce)}},pe=()=>{i()},he=()=>{const Ce=parseFloat(E);if(isNaN(Ce))return;const xe={id:Date.now().toString(),amount:-Ce,merchant:D,category:F,timestamp:Date.now(),location:r};x(xe);const Re=y(Ce,D,F);J(Re)},we=Ce=>{switch(Ce){case"critical":return"bg-red-500";case"danger":return"bg-orange-500";case"warning":return"bg-yellow-500";case"caution":return"bg-blue-500";case"safe":return"bg-green-500";default:return"bg-gray-500"}},fe=w(),ge=C();return v.jsxs("div",{className:"space-y-6",children:[v.jsxs(xr,{children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx($m,{className:"w-5 h-5"}),"Financial Bodyguard Controls"]})}),v.jsxs(br,{className:"space-y-4",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:`w-3 h-3 rounded-full ${t?"bg-green-500":"bg-gray-400"}`}),v.jsxs("span",{className:"font-medium",children:["Agent Status: ",t?"Active":"Inactive"]})]}),v.jsxs($n,{onClick:t?Q:ee,variant:t?"destructive":"default",className:"flex items-center gap-2",children:[t?v.jsx(BP,{className:"w-4 h-4"}):v.jsx(cx,{className:"w-4 h-4"}),t?"Deactivate":"Activate"]})]}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:`w-3 h-3 rounded-full ${n?"bg-green-500":"bg-gray-400"}`}),v.jsxs("span",{className:"font-medium",children:["Location Tracking: ",n?"Active":"Stopped"]})]}),v.jsxs($n,{onClick:n?pe:ne,variant:n?"destructive":"default",className:"flex items-center gap-2",children:[n?v.jsx(BP,{className:"w-4 h-4"}):v.jsx(od,{className:"w-4 h-4"}),n?"Stop Tracking":"Start Tracking"]})]}),r&&v.jsxs(wp,{children:[v.jsx(od,{className:"h-4 w-4"}),v.jsxs(Sp,{children:["Current Location: ",r.lat.toFixed(4),", ",r.lng.toFixed(4),r.accuracy&&` (Accuracy: ${Math.round(r.accuracy)}m)`]})]})]})]}),v.jsxs(xr,{children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(Tu,{className:"w-5 h-5"}),"Test Transaction Risk Assessment"]})}),v.jsxs(br,{className:"space-y-4",children:[v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[v.jsxs("div",{children:[v.jsx(Qi,{htmlFor:"testAmount",children:"Amount ($)"}),v.jsx(ss,{id:"testAmount",type:"number",value:E,onChange:Ce=>j(Ce.target.value),placeholder:"50.00"})]}),v.jsxs("div",{children:[v.jsx(Qi,{htmlFor:"testMerchant",children:"Merchant"}),v.jsx(ss,{id:"testMerchant",value:D,onChange:Ce=>B(Ce.target.value),placeholder:"Starbucks"})]}),v.jsxs("div",{children:[v.jsx(Qi,{htmlFor:"testCategory",children:"Category"}),v.jsx(ss,{id:"testCategory",value:F,onChange:Ce=>$(Ce.target.value),placeholder:"Food & Dining"})]})]}),v.jsxs($n,{onClick:he,className:"w-full",disabled:!t,children:[v.jsx(CA,{className:"w-4 h-4 mr-2"}),"Test Transaction Risk"]}),H&&v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx(Is,{className:`${we(H.level)} text-white`,children:H.level.toUpperCase()}),v.jsxs("span",{className:"text-2xl font-bold",children:[H.score,"/100"]})]}),v.jsxs(wp,{className:H.level==="critical"||H.level==="danger"?"border-red-500":"",children:[v.jsx(Os,{className:"h-4 w-4"}),v.jsx(Sp,{children:H.recommendation})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("h4",{className:"font-medium",children:"Risk Factors:"}),H.factors.map((Ce,xe)=>v.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted rounded",children:[v.jsx("span",{className:"text-sm",children:Ce.message}),v.jsx(Is,{variant:"outline",children:Ce.severity})]},xe))]})]})]})]}),v.jsxs(xr,{children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(CA,{className:"w-5 h-5"}),"Detected Spending Patterns"]})}),v.jsx(br,{children:fe.length>0?v.jsx("div",{className:"space-y-3",children:fe.map((Ce,xe)=>v.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[v.jsxs("div",{children:[v.jsx("div",{className:"font-medium",children:Ce.merchant}),v.jsxs("div",{className:"text-sm text-muted-foreground",children:["$",Ce.totalSpent.toFixed(2),"  ",Ce.visitCount," visits"]})]}),v.jsx(Is,{className:Ce.riskLevel==="high"?"bg-red-500":Ce.riskLevel==="medium"?"bg-yellow-500":"bg-green-500",children:Ce.riskLevel})]},`pattern-${Ce.merchant}-${xe}`))}):v.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No spending patterns detected yet. Test some transactions to build patterns!"})})]}),ge.length>0&&v.jsxs(xr,{children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(Os,{className:"w-5 h-5 text-red-500"}),"High-Risk Merchants"]})}),v.jsx(br,{children:v.jsx("div",{className:"space-y-2",children:ge.map((Ce,xe)=>v.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-red-50 border border-red-200 rounded",children:[v.jsx(Os,{className:"w-4 h-4 text-red-500"}),v.jsx("span",{className:"text-sm font-medium",children:Ce})]},`risk-${Ce}-${xe}`))})})]}),P.length>0&&v.jsxs(xr,{children:[v.jsx(ui,{children:v.jsx(di,{children:"Recent Alerts"})}),v.jsx(br,{children:v.jsx("div",{className:"space-y-2",children:P.slice(-3).map(Ce=>v.jsxs(wp,{className:Ce.dismissed?"opacity-50":"",children:[v.jsx(Os,{className:"h-4 w-4"}),v.jsx(Sp,{children:Ce.message})]},`alert-${Ce.id}`))})})]})]})},cXe=()=>{const e=yy();if(!e)return v.jsxs(xr,{children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(GE,{className:"w-5 h-5"}),"Sample Data Loader"]})}),v.jsx(br,{children:v.jsx("p",{className:"text-sm text-muted-foreground",children:"Financial Bodyguard context not available. Please ensure the agent is properly initialized."})})]});const{addTransaction:t,addGeofence:n,getSpendingPatterns:r,getGeofences:a}=e,[l,h]=L.useState(!1),[i,y]=L.useState(!1),[x,w]=L.useState(!1),[C,P]=L.useState(!1),[E,j]=L.useState(!1),D=async()=>{h(!0),P(!1);try{await new Promise(ee=>setTimeout(ee,1e3));const J=[{id:"1",amount:-45.67,merchant:"Starbucks",category:"Food & Dining",timestamp:Date.now()-2*60*60*1e3,location:{lat:37.2296,lng:-80.4139,accuracy:10,timestamp:Date.now()-2*60*60*1e3}},{id:"2",amount:-120,merchant:"Shell Gas Station",category:"Transportation",timestamp:Date.now()-5*60*60*1e3,location:{lat:37.23,lng:-80.414,accuracy:15,timestamp:Date.now()-5*60*60*1e3}},{id:"3",amount:-89.99,merchant:"Amazon",category:"Shopping",timestamp:Date.now()-24*60*60*1e3,location:{lat:37.229,lng:-80.4145,accuracy:20,timestamp:Date.now()-24*60*60*1e3}},{id:"4",amount:-25.5,merchant:"McDonald's",category:"Food & Dining",timestamp:Date.now()-2*24*60*60*1e3,location:{lat:37.2305,lng:-80.4135,accuracy:12,timestamp:Date.now()-2*24*60*60*1e3}},{id:"5",amount:-15.99,merchant:"Netflix",category:"Entertainment",timestamp:Date.now()-3*24*60*60*1e3,location:{lat:37.2295,lng:-80.4142,accuracy:8,timestamp:Date.now()-3*24*60*60*1e3}},{id:"6",amount:-200,merchant:"Target",category:"Shopping",timestamp:Date.now()-4*24*60*60*1e3,location:{lat:37.231,lng:-80.413,accuracy:25,timestamp:Date.now()-4*24*60*60*1e3}},{id:"7",amount:-75,merchant:"Uber",category:"Transportation",timestamp:Date.now()-5*24*60*60*1e3,location:{lat:37.2285,lng:-80.4148,accuracy:18,timestamp:Date.now()-5*24*60*60*1e3}},{id:"8",amount:-12.5,merchant:"CVS Pharmacy",category:"Healthcare",timestamp:Date.now()-6*24*60*60*1e3,location:{lat:37.2302,lng:-80.4138,accuracy:14,timestamp:Date.now()-6*24*60*60*1e3}}];J.forEach(ee=>{t(ee)}),P(!0),Gn.success("Sample transactions loaded successfully!",{description:`${J.length} transactions added to the system`})}catch(J){Gn.error("Failed to load sample transactions"),console.error("Error loading transactions:",J)}finally{h(!1)}},B=async()=>{y(!0),j(!1);try{await new Promise(ee=>setTimeout(ee,800));const J=[{id:"starbucks-1",name:"Starbucks Downtown",center:{lat:37.2296,lng:-80.4139,timestamp:Date.now()},radius:50,type:"merchant",merchantId:"starbucks"},{id:"target-1",name:"Target Store",center:{lat:37.231,lng:-80.413,timestamp:Date.now()},radius:100,type:"merchant",merchantId:"target"},{id:"high-risk-zone",name:"High-Risk Shopping Area",center:{lat:37.23,lng:-80.414,timestamp:Date.now()},radius:200,type:"high_risk"},{id:"safe-zone",name:"Safe Zone - Home",center:{lat:37.2295,lng:-80.4142,timestamp:Date.now()},radius:150,type:"safe_zone"}];J.forEach(ee=>{n(ee)}),j(!0),Gn.success("Sample geofences loaded successfully!",{description:`${J.length} geofences added to the system`})}catch(J){Gn.error("Failed to load sample geofences"),console.error("Error loading geofences:",J)}finally{y(!1)}},F=async()=>{w(!0),P(!1),j(!1);try{await D(),await B(),Gn.success("All sample data loaded successfully!",{description:"Transactions and geofences are now ready for AI analysis"})}catch(J){Gn.error("Failed to load sample data"),console.error("Error loading all data:",J)}finally{w(!1)}},$=r(),H=a();return v.jsxs(xr,{children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(GE,{className:"w-5 h-5"}),"Sample Data Loader"]})}),v.jsxs(br,{className:"space-y-4",children:[v.jsx("p",{className:"text-sm text-muted-foreground",children:"Load sample transactions and geofences to test the Financial Bodyguard AI agent."}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[v.jsxs($n,{onClick:D,variant:"outline",disabled:l||x,className:"flex items-center gap-2",children:[l?v.jsx(J0,{className:"w-4 h-4 animate-spin"}):C?v.jsx(wl,{className:"w-4 h-4 text-green-500"}):v.jsx(Tu,{className:"w-4 h-4"}),l?"Loading...":C?"Loaded!":"Load Sample Transactions"]}),v.jsxs($n,{onClick:B,variant:"outline",disabled:i||x,className:"flex items-center gap-2",children:[i?v.jsx(J0,{className:"w-4 h-4 animate-spin"}):E?v.jsx(wl,{className:"w-4 h-4 text-green-500"}):v.jsx(od,{className:"w-4 h-4"}),i?"Loading...":E?"Loaded!":"Load Sample Geofences"]}),v.jsxs($n,{onClick:F,disabled:x||l||i,className:"flex items-center gap-2",children:[x?v.jsx(J0,{className:"w-4 h-4 animate-spin"}):C&&E?v.jsx(wl,{className:"w-4 h-4 text-green-500"}):v.jsx(GE,{className:"w-4 h-4"}),x?"Loading All...":C&&E?"All Loaded!":"Load All Sample Data"]})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx("h4",{className:"font-medium",children:"Current Data"}),v.jsxs("div",{className:"space-y-1",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-sm",children:"Spending Patterns:"}),v.jsx(Is,{variant:"outline",children:$.length})]}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("span",{className:"text-sm",children:"Geofences:"}),v.jsx(Is,{variant:"outline",children:H.length})]})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("h4",{className:"font-medium",children:"Sample Data Includes"}),v.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[v.jsx("li",{children:" 8 sample transactions"}),v.jsx("li",{children:" 4 geofences (merchants & zones)"}),v.jsx("li",{children:" Various spending patterns"}),v.jsx("li",{children:" Location data for testing"})]})]})]})]})]})},uXe=()=>{const[e,t]=L.useState([]),[n,r]=L.useState([]),[a,l]=L.useState([]),[h,i]=L.useState(!1);L.useEffect(()=>{const E=[{id:"1",type:"spending_trend",title:"High Daily Spending Detected",description:"Average daily spending is $85.50, which is 25% above your normal levels.",severity:"high",confidence:85,timestamp:Date.now()-3e5,actionable:!0,suggestedAction:"Consider setting daily spending limits or reviewing recent purchases."},{id:"2",type:"pattern_anomaly",title:"Unusual Spending Pattern at Starbucks",description:"High average spending of $12.50 with 8 visits this week.",severity:"medium",confidence:75,timestamp:Date.now()-6e5,actionable:!0,suggestedAction:"Review spending at this merchant and consider setting spending caps."},{id:"3",type:"recommendation",title:"Food Spending Optimization",description:"Food spending represents 45% of total spending this month.",severity:"medium",confidence:80,timestamp:Date.now()-9e5,actionable:!0,suggestedAction:"Consider meal planning or cooking at home to reduce food expenses."}],j=[{type:"spending_forecast",value:450,confidence:70,timeframe:"next_week",factors:["Historical patterns","Seasonal trends","Recent behavior"]},{type:"merchant_visit_probability",value:.6,confidence:65,timeframe:"next_3_days",factors:["Visit frequency","Location proximity","Spending patterns"]}],D=[{id:"1",type:"auto_alert",description:"Autonomous alert triggered for high Starbucks spending",executed:!0,timestamp:Date.now()-12e4,parameters:{merchant:"Starbucks",amount:45.67}},{id:"2",type:"auto_geofence",description:"Auto-created geofence for high-risk shopping area",executed:!0,timestamp:Date.now()-3e5,parameters:{location:"downtown",radius:200}}];t(E),r(j),l(D)},[]);const y=E=>{switch(E){case"critical":return"bg-red-500";case"high":return"bg-orange-500";case"medium":return"bg-yellow-500";case"low":return"bg-blue-500";default:return"bg-gray-500"}},x=E=>{switch(E){case"spending_trend":return v.jsx(Ju,{className:"w-4 h-4"});case"risk_alert":return v.jsx(Os,{className:"w-4 h-4"});case"pattern_anomaly":return v.jsx(Kb,{className:"w-4 h-4"});case"recommendation":return v.jsx(zP,{className:"w-4 h-4"});case"prediction":return v.jsx(Wd,{className:"w-4 h-4"});default:return v.jsx(pb,{className:"w-4 h-4"})}},w=E=>{switch(E){case"auto_block":return v.jsx(mb,{className:"w-4 h-4"});case"auto_approve":return v.jsx(wl,{className:"w-4 h-4"});case"auto_alert":return v.jsx(Os,{className:"w-4 h-4"});case"auto_geofence":return v.jsx(Wd,{className:"w-4 h-4"});case"auto_limit_adjust":return v.jsx(Kb,{className:"w-4 h-4"});default:return v.jsx(AF,{className:"w-4 h-4"})}},C=E=>{const D=Date.now()-E,B=Math.floor(D/6e4),F=Math.floor(D/36e5);return B<60?`${B}m ago`:F<24?`${F}h ago`:`${Math.floor(F/24)}d ago`},P=()=>{i(!0),setTimeout(()=>{i(!1);const E={id:Date.now().toString(),type:"recommendation",title:"AI Analysis Complete",description:"Deep analysis completed. New patterns and insights have been generated.",severity:"low",confidence:90,timestamp:Date.now(),actionable:!1};t(j=>[E,...j])},3e3)};return v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx(G_e,{className:"w-8 h-8 text-purple-600"}),v.jsxs("div",{children:[v.jsx("h2",{className:"text-2xl font-bold",children:"AI Insights Dashboard"}),v.jsx("p",{className:"text-muted-foreground",children:"Advanced agentic AI analysis and autonomous actions"})]})]}),v.jsxs($n,{onClick:P,disabled:h,className:"flex items-center gap-2",children:[h?v.jsx(CA,{className:"w-4 h-4 animate-spin"}):v.jsx(pb,{className:"w-4 h-4"}),h?"Analyzing...":"Run AI Analysis"]})]}),v.jsxs(eI,{defaultValue:"insights",className:"space-y-4",children:[v.jsxs(D5,{className:"grid w-full grid-cols-3",children:[v.jsx(ed,{value:"insights",children:"AI Insights"}),v.jsx(ed,{value:"predictions",children:"Predictions"}),v.jsx(ed,{value:"actions",children:"Autonomous Actions"})]}),v.jsx(td,{value:"insights",className:"space-y-4",children:v.jsx("div",{className:"grid gap-4",children:e.map(E=>v.jsxs(xr,{className:"border-l-4 border-l-blue-500",children:[v.jsx(ui,{className:"pb-3",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[x(E.type),v.jsx(di,{className:"text-lg",children:E.title})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(Is,{className:`${y(E.severity)} text-white`,children:E.severity}),v.jsx("span",{className:"text-sm text-muted-foreground",children:C(E.timestamp)})]})]})}),v.jsxs(br,{className:"space-y-3",children:[v.jsx("p",{className:"text-sm text-muted-foreground",children:E.description}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"text-sm font-medium",children:"Confidence:"}),v.jsx(s3,{value:E.confidence,className:"flex-1"}),v.jsxs("span",{className:"text-sm",children:[E.confidence,"%"]})]}),E.actionable&&E.suggestedAction&&v.jsxs(wp,{children:[v.jsx(zP,{className:"h-4 w-4"}),v.jsxs(Sp,{children:[v.jsx("strong",{children:"Suggested Action:"})," ",E.suggestedAction]})]})]})]},`insight-${E.id}`))})}),v.jsx(td,{value:"predictions",className:"space-y-4",children:v.jsx("div",{className:"grid gap-4",children:n.map((E,j)=>v.jsxs(xr,{children:[v.jsx(ui,{children:v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(Wd,{className:"w-5 h-5"}),v.jsx(di,{className:"text-lg",children:E.type.replace("_"," ").toUpperCase()})]})}),v.jsxs(br,{className:"space-y-3",children:[v.jsx("div",{className:"text-2xl font-bold",children:E.type==="merchant_visit_probability"?`${(E.value*100).toFixed(0)}%`:`$${E.value.toFixed(2)}`}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"text-sm font-medium",children:"Confidence:"}),v.jsx(s3,{value:E.confidence,className:"flex-1"}),v.jsxs("span",{className:"text-sm",children:[E.confidence,"%"]})]}),v.jsxs("div",{className:"text-sm text-muted-foreground",children:[v.jsx("strong",{children:"Timeframe:"})," ",E.timeframe.replace("_"," ")]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("span",{className:"text-sm font-medium",children:"Factors:"}),v.jsx("ul",{className:"text-sm text-muted-foreground list-disc list-inside",children:E.factors.map((D,B)=>v.jsx("li",{children:D},B))})]})]})]},`prediction-${E.type}-${j}`))})}),v.jsx(td,{value:"actions",className:"space-y-4",children:v.jsx("div",{className:"grid gap-4",children:a.map(E=>v.jsxs(xr,{className:"border-gray-700 bg-gray-800",children:[v.jsx(ui,{className:"pb-3",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[w(E.type),v.jsxs(di,{className:"text-lg text-white",children:[E.type.replace("auto_","").toUpperCase()," Action"]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[E.executed?v.jsxs(Is,{className:"bg-green-600 text-white border-green-700",children:[v.jsx(wl,{className:"w-3 h-3 mr-1"}),"Executed"]}):v.jsxs(Is,{className:"bg-yellow-600 text-white border-yellow-700",children:[v.jsx(Y_e,{className:"w-3 h-3 mr-1"}),"Pending"]}),v.jsx("span",{className:"text-sm text-white",children:C(E.timestamp)})]})]})}),v.jsxs(br,{children:[v.jsx("p",{className:"text-sm text-white mb-3",children:E.description}),E.parameters&&v.jsxs("div",{className:"text-xs text-white bg-gray-700 p-2 rounded",children:[v.jsx("strong",{className:"text-white",children:"Parameters:"})," ",JSON.stringify(E.parameters,null,2)]})]})]},`action-${E.id}`))})})]})]})},ob=[{name:"Starbucks",category:"Coffee & Tea",riskLevel:"medium"},{name:"Target",category:"Retail",riskLevel:"high"},{name:"Kroger",category:"Grocery",riskLevel:"low"},{name:"McDonald's",category:"Fast Food",riskLevel:"low"},{name:"Apple Store",category:"Electronics",riskLevel:"high"},{name:"Gas Station",category:"Fuel",riskLevel:"low"},{name:"Amazon",category:"Online",riskLevel:"high"},{name:"Local Bar",category:"Entertainment",riskLevel:"high"}],dXe=["Coffee & Tea","Retail","Grocery","Fast Food","Electronics","Fuel","Online","Entertainment","Transportation","Healthcare"],hXe=({isSimulating:e,simulationSpeed:t,manualTransaction:n,onStartSimulation:r,onStopSimulation:a,onResetSimulation:l,onSpeedChange:h,onManualTransactionChange:i,onAddManualTransaction:y,isActive:x})=>v.jsxs(xr,{children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center space-x-2",children:[v.jsx(w5,{className:"w-5 h-5"}),v.jsx("span",{children:"Transaction Simulator"})]})}),v.jsxs(br,{className:"space-y-4",children:[v.jsxs("div",{className:"flex items-center space-x-4",children:[v.jsxs($n,{onClick:e?a:r,disabled:!x,className:"flex items-center space-x-2",children:[e?v.jsx(axe,{className:"w-4 h-4"}):v.jsx(cx,{className:"w-4 h-4"}),v.jsxs("span",{children:[e?"Stop":"Start"," Simulation"]})]}),v.jsxs($n,{onClick:l,variant:"outline",className:"flex items-center space-x-2",children:[v.jsx(zQ,{className:"w-4 h-4"}),v.jsx("span",{children:"Reset"})]}),v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx(Qi,{htmlFor:"speed",children:"Speed:"}),v.jsxs(Ep,{value:t.toString(),onValueChange:w=>h(parseInt(w)),children:[v.jsx(Af,{className:"w-32",children:v.jsx(Pp,{})}),v.jsxs(Tf,{children:[v.jsx(So,{value:"1000",children:"1s"}),v.jsx(So,{value:"3000",children:"3s"}),v.jsx(So,{value:"5000",children:"5s"}),v.jsx(So,{value:"10000",children:"10s"})]})]})]})]}),!x&&v.jsxs(wp,{children:[v.jsx(Os,{className:"h-4 w-4"}),v.jsx(Sp,{children:"Financial Bodyguard must be active to simulate transactions"})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{htmlFor:"amount",children:"Amount ($)"}),v.jsx(ss,{id:"amount",type:"number",placeholder:"0.00",value:n.amount,onChange:w=>i("amount",w.target.value)})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{htmlFor:"merchant",children:"Merchant"}),v.jsx(ss,{id:"merchant",placeholder:"Merchant name",value:n.merchant,onChange:w=>i("merchant",w.target.value)})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(Qi,{htmlFor:"category",children:"Category"}),v.jsxs(Ep,{value:n.category,onValueChange:w=>i("category",w),children:[v.jsx(Af,{children:v.jsx(Pp,{placeholder:"Select category"})}),v.jsx(Tf,{children:dXe.map(w=>v.jsx(So,{value:w,children:w},w))})]})]})]}),v.jsx($n,{onClick:y,disabled:!x,className:"w-full",children:"Add Manual Transaction"})]})]}),fXe=({simulatedTransactions:e,lastRiskAssessment:t})=>{const[n,r]=L.useState(!1),[a,l]=L.useState(!1),[h,i]=L.useState(!1),[y,x]=L.useState(!1),w=j=>{switch(j){case"critical":return"bg-red-500";case"danger":return"bg-orange-500";case"warning":return"bg-yellow-500";case"caution":return"bg-blue-500";case"safe":return"bg-green-500";default:return"bg-gray-500"}},C=j=>{switch(j){case"critical":return v.jsx(mb,{className:"w-4 h-4"});case"danger":return v.jsx(Os,{className:"w-4 h-4"});case"warning":return v.jsx(Os,{className:"w-4 h-4"});case"caution":return v.jsx(wl,{className:"w-4 h-4"});case"safe":return v.jsx(wl,{className:"w-4 h-4"});default:return v.jsx(wl,{className:"w-4 h-4"})}},P=e.reduce((j,D)=>{const B=D.category;return j[B]||(j[B]={total:0,count:0,average:0,merchants:new Set}),j[B].total+=D.amount,j[B].count+=1,j[B].average=j[B].total/j[B].count,j[B].merchants.add(D.merchant),j},{}),E=e.reduce((j,D)=>j+D.amount,0);return e.length>0&&E/e.length,new Set(e.map(j=>j.merchant)).size,new Set(e.map(j=>j.category)).size,e.length>0&&Math.max(...e.map(j=>j.amount)),e.length>0&&Math.min(...e.map(j=>j.amount)),e.filter(j=>Date.now()-j.timestamp<24*60*60*1e3).length,e.filter(j=>j.amount>100).length,v.jsx("div",{className:"w-full overflow-hidden",children:v.jsxs("div",{className:"flex w-full gap-4",children:[v.jsxs(xr,{className:"flex-1 flex flex-col min-w-0 max-w-none overflow-hidden",children:[v.jsx(ui,{className:"pb-3",children:v.jsx(di,{className:"text-xl font-semibold",children:"Recent Transactions"})}),v.jsx(br,{className:"overflow-hidden",children:v.jsx("div",{className:"space-y-3",children:e.length>0?v.jsxs(v.Fragment,{children:[(n?e:e.slice(0,3)).map(j=>v.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/30 rounded-lg border max-w-full overflow-hidden",children:[v.jsxs("div",{className:"flex-1 min-w-0 pr-3 max-w-full overflow-hidden",children:[v.jsx("div",{className:"font-medium text-base break-words leading-tight",style:{wordBreak:"break-word",whiteSpace:"normal"},children:j.merchant}),v.jsxs("div",{className:"text-sm text-muted-foreground break-words",children:[j.category,"  ",new Date(j.timestamp).toLocaleTimeString()]})]}),v.jsxs("div",{className:"text-right flex-shrink-0",children:[v.jsxs("div",{className:"font-bold text-base",children:["$",j.amount.toFixed(2)]}),j.location&&v.jsxs("div",{className:"text-xs text-muted-foreground flex items-center space-x-1",children:[v.jsx(od,{className:"w-3 h-3"}),v.jsx("span",{children:"Location tracked"})]})]})]},j.id)),e.length>3&&v.jsx($n,{variant:"outline",size:"sm",onClick:()=>r(!n),className:"w-full",children:n?"Show Less":`See All (${e.length})`})]}):v.jsx("div",{className:"flex items-center justify-center py-4",children:v.jsx("p",{className:"text-muted-foreground text-sm",children:"No transactions yet"})})})})]}),Object.keys(P).length>0&&v.jsxs(xr,{className:"flex-1 flex flex-col min-w-0 max-w-none overflow-hidden",children:[v.jsx(ui,{className:"pb-3",children:v.jsxs(di,{className:"flex items-center space-x-2 text-xl font-semibold",children:[v.jsx(Tu,{className:"w-6 h-6"}),v.jsx("span",{children:"Spending by Category"})]})}),v.jsx(br,{className:"overflow-hidden",children:v.jsxs("div",{className:"space-y-3",children:[(a?Object.entries(P):Object.entries(P).slice(0,3)).sort(([,j],[,D])=>D.total-j.total).map(([j,D])=>v.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/30 rounded-lg border max-w-full overflow-hidden",children:[v.jsxs("div",{className:"flex-1 min-w-0 pr-3 max-w-full overflow-hidden",children:[v.jsx("div",{className:"font-medium text-base break-words leading-tight",style:{wordBreak:"break-word",whiteSpace:"normal"},children:j}),v.jsxs("div",{className:"text-sm text-muted-foreground break-words",children:[D.count," transactions  ",D.merchants.size," merchants"]})]}),v.jsxs("div",{className:"text-right flex-shrink-0",children:[v.jsxs("div",{className:"font-bold text-base",children:["$",D.total.toFixed(2)]}),v.jsxs("div",{className:"text-sm text-muted-foreground",children:["Avg: $",D.average.toFixed(2)]})]})]},j)),Object.keys(P).length>3&&v.jsx($n,{variant:"outline",size:"sm",onClick:()=>l(!a),className:"w-full",children:a?"Show Less":`See All (${Object.keys(P).length})`})]})})]}),t&&v.jsxs(xr,{className:"flex-1 flex flex-col min-w-0 max-w-none overflow-hidden",children:[v.jsx(ui,{className:"pb-3",children:v.jsxs(di,{className:"flex items-center space-x-2 text-xl font-semibold",children:[C(t.level),v.jsx("span",{children:"Risk Assessment"})]})}),v.jsx(br,{className:"overflow-hidden",children:v.jsxs("div",{className:"space-y-3 flex flex-col",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx(Is,{className:`${w(t.level)} text-white px-2 py-1 text-xs`,children:t.level.toUpperCase()}),v.jsxs("span",{className:"text-xl font-bold",children:[t.score,"/100"]})]}),v.jsxs(wp,{className:"flex-shrink-0",children:[v.jsx(Os,{className:"h-4 w-4"}),v.jsx(Sp,{className:"text-sm",children:t.recommendation})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("h4",{className:"font-medium text-base",children:"Risk Factors:"}),(h?t.factors:t.factors.slice(0,3)).map((j,D)=>v.jsxs("div",{className:"flex items-start justify-between p-3 bg-muted/30 rounded-lg border max-w-full overflow-hidden",children:[v.jsx("span",{className:"text-sm flex-1 min-w-0 mr-2 break-words leading-tight max-w-full overflow-hidden",style:{wordBreak:"break-word",whiteSpace:"normal"},children:j.message}),v.jsx(Is,{variant:"outline",className:"text-xs flex-shrink-0",children:j.severity})]},D)),t.factors.length>3&&v.jsx($n,{variant:"outline",size:"sm",onClick:()=>i(!h),className:"w-full",children:h?"Show Less":`See All (${t.factors.length})`})]})]})})]}),v.jsxs(xr,{className:"flex-1 flex flex-col min-w-0 max-w-none overflow-hidden",children:[v.jsx(ui,{className:"pb-3",children:v.jsx(di,{className:"text-xl font-semibold",children:"Merchant Risk Levels"})}),v.jsx(br,{className:"overflow-hidden",children:v.jsxs("div",{className:"space-y-3",children:[(y?ob:ob.slice(0,3)).map((j,D)=>v.jsxs("div",{className:"p-3 bg-muted/30 rounded-lg border max-w-full overflow-hidden",children:[v.jsx("div",{className:"font-medium text-sm mb-1 break-words leading-tight max-w-full overflow-hidden",style:{wordBreak:"break-word",whiteSpace:"normal"},children:j.name}),v.jsx("div",{className:"text-sm text-muted-foreground mb-2 break-words leading-tight max-w-full overflow-hidden",style:{wordBreak:"break-word",whiteSpace:"normal"},children:j.category}),v.jsx(Is,{className:`${j.riskLevel==="high"?"bg-red-500 text-white":j.riskLevel==="medium"?"bg-yellow-500 text-white":"bg-green-500 text-white"} text-xs`,children:j.riskLevel})]},D)),ob.length>3&&v.jsx($n,{variant:"outline",size:"sm",onClick:()=>x(!y),className:"w-full",children:y?"Show Less":`See All (${ob.length})`})]})})]})]})})},pXe=()=>{const{assessTransactionRisk:e,addTransaction:t,currentLocation:n,isActive:r,showAlert:a}=yy(),[l,h]=L.useState(!1),[i,y]=L.useState(5e3),[x,w]=L.useState([]),[C,P]=L.useState(null),[E,j]=L.useState({amount:"",merchant:"",category:""});L.useEffect(()=>{if(!l||!r)return;const ee=setInterval(()=>{const Q=ob[Math.floor(Math.random()*ob.length)],ne=Math.floor(Math.random()*200)+5,pe={id:Date.now().toString(),amount:ne,merchant:Q.name,category:Q.category,timestamp:Date.now(),location:n?{lat:n.lat+(Math.random()-.5)*.01,lng:n.lng+(Math.random()-.5)*.01,accuracy:50,timestamp:Date.now()}:void 0},he=e(pe.amount,pe.merchant,pe.category);P(he),t(pe),w(we=>[pe,...we.slice(0,9)]),he.level==="critical"||he.level==="danger"?a(` High risk transaction: $${pe.amount} at ${pe.merchant}`,"error"):he.level==="warning"&&a(` Moderate risk: $${pe.amount} at ${pe.merchant}`,"warning")},i);return()=>clearInterval(ee)},[l,r,i,n,e,t,a]);const D=()=>{h(!0),a("Transaction simulation started","info")},B=()=>{h(!1),a("Transaction simulation stopped","info")},F=()=>{w([]),P(null),a("Simulation reset","info")},$=ee=>{y(ee)},H=(ee,Q)=>{j(ne=>({...ne,[ee]:Q}))},J=()=>{if(!E.amount||!E.merchant||!E.category){a("Please fill in all fields","error");return}const ee={id:Date.now().toString(),amount:parseFloat(E.amount),merchant:E.merchant,category:E.category,timestamp:Date.now(),location:n?{lat:n.lat,lng:n.lng,accuracy:n.accuracy||50,timestamp:Date.now()}:void 0},Q=e(ee.amount,ee.merchant,ee.category);P(Q),t(ee),w(ne=>[ee,...ne.slice(0,9)]),j({amount:"",merchant:"",category:""}),a(`Transaction added: $${ee.amount} at ${ee.merchant}`,"success")};return v.jsxs("div",{className:"w-full",children:[v.jsx("div",{className:"w-full mb-6",children:v.jsx(hXe,{isSimulating:l,simulationSpeed:i,manualTransaction:E,onStartSimulation:D,onStopSimulation:B,onResetSimulation:F,onSpeedChange:$,onManualTransactionChange:H,onAddManualTransaction:J,isActive:r})}),v.jsx(fXe,{simulatedTransactions:x,lastRiskAssessment:C})]})};class mXe{constructor(){ni(this,"locationTracker");ni(this,"notifications",[]);ni(this,"demoGeofences",[]);ni(this,"isActive",!1);ni(this,"onNotification");this.locationTracker=new pte,this.setupDemoGeofences()}setupDemoGeofences(){const t={id:"owens_ballroom_demo",name:"Owens Ballroom - VT Hacks Demo",center:{lat:37.22767,lng:-80.41794,accuracy:10,timestamp:Date.now()},radius:100,type:"merchant",merchantId:"owens_ballroom"},n={id:"squires_student_center",name:"Squires Student Center",center:{lat:37.2295,lng:-80.42,accuracy:10,timestamp:Date.now()},radius:80,type:"merchant",merchantId:"squires_student_center"},r={id:"downtown_blacksburg",name:"Downtown Blacksburg",center:{lat:37.229,lng:-80.41,accuracy:10,timestamp:Date.now()},radius:200,type:"high_risk",merchantId:"downtown_blacksburg"},a={id:"current_location_high_risk",name:"Current Location - High Risk Zone",center:{lat:37.2521,lng:-80.4097,accuracy:10,timestamp:Date.now()},radius:50,type:"high_risk",merchantId:"current_location"};this.demoGeofences=[t,n,r,a],this.demoGeofences.forEach(l=>{this.locationTracker.addGeofence(l)})}start(t){return this.onNotification=t,this.isActive=!0,this.locationTracker.startTracking(n=>this.handleLocationUpdate(n),n=>this.handleGeofenceEnter(n),n=>this.handleGeofenceExit(n)).then(()=>{console.log(" GeolocationNotificationAgent: Started successfully"),this.addDemoNotification({type:"location_based_insight",title:"Location Tracking Active",message:"MoneyLens is now tracking your location for smart financial insights.",location:{name:"Current Location",address:"Location tracking enabled",coordinates:{lat:0,lng:0}},geofenceId:"system",severity:"low",actionable:!1})}).catch(n=>{console.error(" GeolocationNotificationAgent: Failed to start:",n),this.addDemoNotification({type:"location_based_insight",title:"Demo Mode - Location Simulation",message:"Running in demo mode. Location-based notifications are simulated.",location:{name:"Demo Mode",address:"Simulated location tracking",coordinates:{lat:37.22767,lng:-80.41794}},geofenceId:"demo_mode",severity:"low",actionable:!1})})}stop(){this.isActive=!1,this.locationTracker.stopTracking(),console.log(" GeolocationNotificationAgent: Stopped")}handleLocationUpdate(t){this.isActive&&this.checkProximityAlerts(t)}handleGeofenceEnter(t){if(!this.isActive)return;console.log(` Entered geofence: ${t.name}`);let n;switch(t.id){case"owens_ballroom_demo":n={type:"geofence_enter",title:" Welcome to VT Hacks Demo!",message:"You've arrived at Owens Ballroom! This is where the MoneyLens demo is taking place. Check out the smart financial features!",location:{name:t.name,address:"150 Kent St, Blacksburg, VA",coordinates:{lat:t.center.lat,lng:t.center.lng}},geofenceId:t.id,timestamp:Date.now(),severity:"high",actionable:!0,suggestedAction:"Explore the MoneyLens features and try the interactive demo!"};break;case"squires_student_center":n={type:"geofence_enter",title:" Near Squires Student Center",message:"You're near a popular student area. This location typically has high spending activity.",location:{name:t.name,address:"Squires Student Center, Blacksburg, VA",coordinates:{lat:t.center.lat,lng:t.center.lng}},geofenceId:t.id,timestamp:Date.now(),severity:"medium",actionable:!0,suggestedAction:"Consider setting a spending cap for this area."};break;case"downtown_blacksburg":n={type:"geofence_enter",title:" Downtown Blacksburg - High Spending Zone",message:"You've entered downtown Blacksburg, a high-spending area with many restaurants and shops.",location:{name:t.name,address:"Downtown Blacksburg, VA",coordinates:{lat:t.center.lat,lng:t.center.lng}},geofenceId:t.id,timestamp:Date.now(),severity:"high",actionable:!0,suggestedAction:"Set a daily spending limit for downtown visits."};break;case"current_location_high_risk":n={type:"geofence_enter",title:" High Risk Location Detected!",message:"You've entered a high-risk spending zone! MoneyLens has detected unusual financial activity in this area.",location:{name:t.name,address:"Current Location - High Risk Zone",coordinates:{lat:t.center.lat,lng:t.center.lng}},geofenceId:t.id,timestamp:Date.now(),severity:"critical",actionable:!0,suggestedAction:"Enable enhanced monitoring and consider setting strict spending limits for this location."};break;default:n={type:"geofence_enter",title:` Entered ${t.name}`,message:`You've entered the ${t.name} area.`,location:{name:t.name,address:"Unknown address",coordinates:{lat:t.center.lat,lng:t.center.lng}},geofenceId:t.id,timestamp:Date.now(),severity:"low",actionable:!1}}this.addNotification(n)}handleGeofenceExit(t){if(!this.isActive)return;console.log(` Exited geofence: ${t.name}`);const n={type:"geofence_exit",title:` Left ${t.name}`,message:`You've left the ${t.name} area.`,location:{name:t.name,address:"Unknown address",coordinates:{lat:t.center.lat,lng:t.center.lng}},geofenceId:t.id,timestamp:Date.now(),severity:"low",actionable:!1};this.addNotification(n)}checkProximityAlerts(t){this.locationTracker.getNearbyGeofences(500).forEach(r=>{if(r.id==="owens_ballroom_demo"){const a=this.calculateDistance(t,r.center);a<=200&&a>100&&this.addNotification({type:"proximity_alert",title:" Approaching VT Hacks Demo!",message:"You're getting close to the MoneyLens demo at Owens Ballroom. Just a few more steps!",location:{name:r.name,address:"150 Kent St, Blacksburg, VA",coordinates:{lat:r.center.lat,lng:r.center.lng}},geofenceId:r.id,timestamp:Date.now(),severity:"medium",actionable:!0,suggestedAction:"Continue towards Owens Ballroom to see the full demo!"})}})}addNotification(t){this.notifications.push(t),this.notifications.length>50&&(this.notifications=this.notifications.slice(-50)),this.onNotification&&this.onNotification(t),console.log(` Geolocation Notification: ${t.title}`)}addDemoNotification(t){const n={...t,id:`demo_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};this.addNotification(n)}calculateDistance(t,n){const a=t.lat*Math.PI/180,l=n.lat*Math.PI/180,h=(n.lat-t.lat)*Math.PI/180,i=(n.lng-t.lng)*Math.PI/180,y=Math.sin(h/2)*Math.sin(h/2)+Math.cos(a)*Math.cos(l)*Math.sin(i/2)*Math.sin(i/2);return 6371e3*(2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y)))}simulateLocation(t){this.isActive&&(console.log(` Simulating location: ${t.lat}, ${t.lng}`),this.demoGeofences.forEach(n=>{this.calculateDistance(t,n.center)<=n.radius&&this.handleGeofenceEnter(n)}))}getNotifications(){return[...this.notifications]}getNotificationsByType(t){return this.notifications.filter(n=>n.type===t)}getRecentNotifications(){return this.notifications.sort((t,n)=>n.timestamp-t.timestamp).slice(0,10)}getIsActive(){return this.isActive}getCurrentLocation(){const t=this.locationTracker.getCurrentLocation();return t?{lat:t.lat,lng:t.lng,accuracy:t.accuracy}:null}getDemoGeofences(){return[...this.demoGeofences]}}const gXe=({className:e})=>{const[t,n]=L.useState(null),[r,a]=L.useState(!1),[l,h]=L.useState([]),[i,y]=L.useState(null),[x,w]=L.useState(!1),{addNotification:C}=E5(),{showBlockingNotification:P}=yy();L.useEffect(()=>{const Q=new mXe;return n(Q),()=>{Q.stop()}},[]);const E=L.useCallback(Q=>{if(h(ne=>[Q,...ne.slice(0,49)]),Q.severity==="critical"||Q.severity==="high"&&Q.title.includes("High Risk")||Q.severity==="high"&&Q.title.includes("High Spending")){let ne="warning",pe="Continue",he="Go Back";Q.severity==="critical"?(ne="critical",pe="Proceed with Caution",he="Turn Back"):Q.severity==="high"&&(ne="high",pe="Set Spending Limit",he="Avoid Area"),P({title:Q.title,message:Q.message+(Q.suggestedAction?`

${Q.suggestedAction}`:""),severity:ne,onConfirm:()=>{console.log("User confirmed to proceed in high-risk area"),Gn.success("Proceeding with enhanced monitoring",{description:"MoneyLens will closely monitor your spending in this area."})},onDismiss:()=>{console.log("User chose to avoid the high-risk area"),Gn.success("Smart choice!",{description:"Avoiding high-risk spending area."})},confirmText:pe,dismissText:he,showDismiss:!0})}else{C({type:Q.severity==="critical"?"error":Q.severity==="high"?"warning":(Q.severity==="medium","info"),title:Q.title,message:Q.message,category:"system",actionUrl:Q.actionable?"/map":void 0});const ne=Q.severity==="critical"?"error":Q.severity==="high"?"warning":(Q.severity==="medium","info");Gn[ne](Q.title,{description:Q.message,duration:8e3,style:{borderRadius:"0.5rem",padding:"0.75rem 1rem",margin:"0.5rem",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)"}})}},[C,P]),j=L.useCallback(async()=>{if(t)try{await t.start(E),a(!0),w(!1),Gn.success("Location tracking started!",{description:"MoneyLens is now monitoring your location for smart financial insights."})}catch(Q){console.error("Failed to start location tracking:",Q),w(!0),a(!0),Gn.info("Demo Mode Activated",{description:"Location tracking is simulated for demo purposes."})}},[t,E]),D=L.useCallback(()=>{t&&(t.stop(),a(!1),w(!1),Gn.info("Location tracking stopped"))},[t]),B=L.useCallback(Q=>{!t||!r||(t.simulateLocation(Q),y(Q))},[t,r]),F=L.useCallback(()=>{if(!t)return;const Q={lat:37.2521,lng:-80.4097};t.simulateLocation(Q),y(Q)},[t]),$=L.useCallback(()=>{P({title:" High Risk Location Detected!",message:`You've entered a high-risk spending zone! MoneyLens has detected unusual financial activity in this area. This location has been flagged for potential overspending risks.

Enable enhanced monitoring and consider setting strict spending limits for this location.`,severity:"critical",onConfirm:()=>{console.log("User confirmed to proceed with caution in high-risk area"),Gn.success("Proceeding with enhanced monitoring",{description:"MoneyLens will closely monitor your spending in this area."})},onDismiss:()=>{console.log("User chose to avoid the high-risk area"),Gn.success("Smart choice!",{description:"Avoiding high-risk spending area."})},confirmText:"Proceed with Caution",dismissText:"Turn Back",showDismiss:!0})},[P]),H=[{name:"Owens Ballroom (Demo)",location:{lat:37.22767,lng:-80.41794},description:"VT Hacks demo location"},{name:"Squires Student Center",location:{lat:37.2295,lng:-80.42},description:"Popular student area"},{name:"Downtown Blacksburg",location:{lat:37.229,lng:-80.41},description:"High spending zone"},{name:"Current Location (High Risk)",location:{lat:37.2521,lng:-80.4097},description:"Your current location - High risk zone"}],J=Q=>{switch(Q){case"critical":return v.jsx(Os,{className:"w-4 h-4 text-red-500"});case"high":return v.jsx(Os,{className:"w-4 h-4 text-orange-500"});case"medium":return v.jsx(PA,{className:"w-4 h-4 text-yellow-500"});case"low":return v.jsx(wl,{className:"w-4 h-4 text-green-500"});default:return v.jsx(PA,{className:"w-4 h-4 text-gray-500"})}},ee=Q=>{switch(Q){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return v.jsxs("div",{className:`space-y-4 ${e}`,children:[v.jsxs(xr,{children:[v.jsxs(ui,{children:[v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(od,{className:"w-5 h-5"}),"Geolocation Notifications"]}),v.jsx(cy,{children:"Smart location-based financial insights and alerts"})]}),v.jsxs(br,{className:"space-y-4",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("div",{className:`w-3 h-3 rounded-full ${r?"bg-green-500":"bg-gray-400"}`}),v.jsx("span",{className:"text-sm font-medium",children:r?x?"Demo Mode":"Active":"Inactive"})]}),v.jsxs("div",{className:"flex gap-2",children:[r?v.jsxs($n,{onClick:D,variant:"outline",size:"sm",children:[v.jsx(BP,{className:"w-4 h-4 mr-2"}),"Stop Tracking"]}):v.jsxs($n,{onClick:j,size:"sm",children:[v.jsx(cx,{className:"w-4 h-4 mr-2"}),"Start Tracking"]}),v.jsxs($n,{onClick:F,variant:"destructive",size:"sm",children:[v.jsx(Os,{className:"w-4 h-4 mr-2"}),"Test High Risk"]}),v.jsxs($n,{onClick:$,variant:"destructive",size:"sm",children:[v.jsx(lv,{className:"w-4 h-4 mr-2"}),"Test Spending Alert"]})]})]}),x&&v.jsxs("div",{className:"space-y-3",children:[v.jsx("div",{className:"text-sm text-muted-foreground",children:"Demo Mode: Simulate location to test notifications"}),v.jsx("div",{className:"grid grid-cols-1 gap-2",children:H.map((Q,ne)=>v.jsxs($n,{variant:"outline",size:"sm",onClick:()=>B(Q.location),className:"justify-start",children:[v.jsx(R3,{className:"w-4 h-4 mr-2"}),v.jsxs("div",{className:"text-left",children:[v.jsx("div",{className:"font-medium",children:Q.name}),v.jsx("div",{className:"text-xs text-muted-foreground",children:Q.description})]})]},ne))})]}),i&&v.jsxs("div",{className:"text-sm text-muted-foreground",children:[v.jsx("strong",{children:"Current Location:"})," ",i.lat.toFixed(6),", ",i.lng.toFixed(6),i.accuracy&&v.jsxs("span",{children:[" (",Math.round(i.accuracy),"m)"]})]})]})]}),l.length>0&&v.jsxs(xr,{children:[v.jsxs(ui,{children:[v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(lv,{className:"w-5 h-5"}),"Recent Location Notifications"]}),v.jsx(cy,{children:"Latest geolocation-based alerts and insights"})]}),v.jsx(br,{children:v.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:l.slice(0,10).map(Q=>v.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg border bg-card",children:[v.jsx("div",{className:"flex-shrink-0 mt-0.5",children:J(Q.severity)}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[v.jsx("h4",{className:"font-medium text-sm",children:Q.title}),v.jsx(Is,{className:`text-xs ${ee(Q.severity)}`,children:Q.severity})]}),v.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:Q.message}),v.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[v.jsx(od,{className:"w-3 h-3"}),v.jsx("span",{children:Q.location.name}),v.jsx("span",{children:""}),v.jsx("span",{children:new Date(Q.timestamp).toLocaleTimeString()})]}),Q.suggestedAction&&v.jsxs("div",{className:"mt-2 text-xs text-blue-600 bg-blue-50 p-2 rounded",children:[v.jsx("strong",{children:"Suggestion:"})," ",Q.suggestedAction]})]})]},Q.id))})})]})]})},yXe=()=>{const{showBlockingNotification:e}=yy(),t=()=>{e({title:" Critical Risk Detected!",message:"You've entered a high-risk spending zone! MoneyLens has detected unusual financial activity in this area. This location has been flagged for potential overspending risks.",severity:"critical",onConfirm:()=>{console.log("User confirmed to proceed with caution")},onDismiss:()=>{console.log("User dismissed the notification")},confirmText:"Proceed with Caution",dismissText:"Turn Back",showDismiss:!0})},n=()=>{e({title:" Danger Zone Alert!",message:"You're approaching a high-risk spending area. Previous users have reported overspending in this location. Consider setting a spending limit before proceeding.",severity:"danger",onConfirm:()=>{console.log("User confirmed to proceed")},onDismiss:()=>{console.log("User dismissed the notification")},confirmText:"Set Spending Limit",dismissText:"Avoid Area",showDismiss:!0})},r=()=>{e({title:" High-Risk Location",message:"You've entered a high-risk spending zone. MoneyLens recommends setting a daily spending limit for this area to prevent overspending.",severity:"high",onConfirm:()=>{console.log("User confirmed to proceed")},onDismiss:()=>{console.log("User dismissed the notification")},confirmText:"Continue",dismissText:"Go Back",showDismiss:!0})},a=()=>{e({title:" Spending Alert",message:"You're in a moderate-risk spending area. Consider setting a budget for this visit to avoid overspending.",severity:"warning",onConfirm:()=>{console.log("User confirmed to proceed")},onDismiss:()=>{console.log("User dismissed the notification")},confirmText:"Set Budget",dismissText:"Continue",showDismiss:!0})},l=()=>{e({title:" Security Alert",message:"Your account has been flagged for unusual activity. Please confirm your identity to continue using MoneyLens.",severity:"critical",onConfirm:()=>{console.log("User confirmed security check")},confirmText:"Verify Identity",showDismiss:!1})};return v.jsxs("div",{className:"p-6 bg-gray-900 rounded-lg border border-gray-700",children:[v.jsxs("div",{className:"flex items-center space-x-2 mb-6",children:[v.jsx(q_e,{className:"w-6 h-6 text-blue-500"}),v.jsx("h3",{className:"text-white font-semibold text-lg",children:"Spending Alert Demo"})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[v.jsxs($n,{onClick:t,className:"w-full bg-red-600 hover:bg-red-700 text-white flex items-center space-x-2",children:[v.jsx(Os,{className:"w-4 h-4"}),v.jsx("span",{children:"Critical Risk (Red)"})]}),v.jsxs($n,{onClick:n,className:"w-full bg-orange-600 hover:bg-orange-700 text-white flex items-center space-x-2",children:[v.jsx(Os,{className:"w-4 h-4"}),v.jsx("span",{children:"Danger Zone (Orange)"})]}),v.jsxs($n,{onClick:r,className:"w-full bg-yellow-600 hover:bg-yellow-700 text-white flex items-center space-x-2",children:[v.jsx($m,{className:"w-4 h-4"}),v.jsx("span",{children:"High Risk (Yellow)"})]}),v.jsxs($n,{onClick:a,className:"w-full bg-blue-600 hover:bg-blue-700 text-white flex items-center space-x-2",children:[v.jsx($m,{className:"w-4 h-4"}),v.jsx("span",{children:"Warning (Blue)"})]})]}),v.jsx("div",{className:"pt-4 border-t border-gray-700",children:v.jsxs($n,{onClick:l,className:"w-full bg-purple-600 hover:bg-purple-700 text-white flex items-center space-x-2",children:[v.jsx(AF,{className:"w-4 h-4"}),v.jsx("span",{children:"No Dismiss Option (Critical)"})]})}),v.jsx("div",{className:"mt-4 p-4 bg-gray-800 rounded-lg",children:v.jsxs("p",{className:"text-gray-300 text-sm",children:[v.jsx("strong",{children:"Features:"})," These spending alerts block the entire app until the user takes action, helping you make informed financial decisions. They prevent scrolling and require explicit user confirmation."]})})]})]})},vXe=()=>v.jsxs("div",{className:"w-full",children:[v.jsxs("div",{className:"mb-8",children:[v.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Financial Bodyguard Agent"}),v.jsx("p",{className:"text-muted-foreground",children:"AI-powered spending protection that monitors your location and spending patterns in real-time"})]}),v.jsxs(eI,{defaultValue:"activator",className:"space-y-6",children:[v.jsxs(D5,{className:"grid w-full grid-cols-6",children:[v.jsx(ed,{value:"activator",children:"Quick Start"}),v.jsx(ed,{value:"dashboard",children:"Dashboard"}),v.jsx(ed,{value:"ai-insights",children:"AI Insights"}),v.jsx(ed,{value:"simulator",children:"Transaction Simulator"}),v.jsx(ed,{value:"geolocation",children:"Location Notifications"}),v.jsx(ed,{value:"apple-notifications",children:"Spending Alerts"})]}),v.jsxs(td,{value:"activator",className:"space-y-6",children:[v.jsx(cXe,{}),v.jsx(lXe,{})]}),v.jsx(td,{value:"dashboard",children:v.jsx(oXe,{})}),v.jsx(td,{value:"ai-insights",children:v.jsx(uXe,{})}),v.jsx(td,{value:"simulator",className:"w-full",children:v.jsx(pXe,{})}),v.jsx(td,{value:"geolocation",children:v.jsx(gXe,{})}),v.jsx(td,{value:"apple-notifications",children:v.jsx(yXe,{})})]})]});function _Xe(){return xae.useSyncExternalStore(xXe,()=>!0,()=>!1)}function xXe(){return()=>{}}var _8="Avatar",[bXe,QXe]=dd(_8),[wXe,Pfe]=bXe(_8),kfe=L.forwardRef((e,t)=>{const{__scopeAvatar:n,...r}=e,[a,l]=L.useState("idle");return v.jsx(wXe,{scope:n,imageLoadingStatus:a,onImageLoadingStatusChange:l,children:v.jsx(Ei.span,{...r,ref:t})})});kfe.displayName=_8;var Ife="AvatarImage",Nfe=L.forwardRef((e,t)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:a=()=>{},...l}=e,h=Pfe(Ife,n),i=SXe(r,l),y=ll(x=>{a(x),h.onImageLoadingStatusChange(x)});return Sl(()=>{i!=="idle"&&y(i)},[i,y]),i==="loaded"?v.jsx(Ei.img,{...l,ref:t,src:r}):null});Nfe.displayName=Ife;var Mfe="AvatarFallback",Lfe=L.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:r,...a}=e,l=Pfe(Mfe,n),[h,i]=L.useState(r===void 0);return L.useEffect(()=>{if(r!==void 0){const y=window.setTimeout(()=>i(!0),r);return()=>window.clearTimeout(y)}},[r]),h&&l.imageLoadingStatus!=="loaded"?v.jsx(Ei.span,{...a,ref:t}):null});Lfe.displayName=Mfe;function LY(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function SXe(e,{referrerPolicy:t,crossOrigin:n}){const r=_Xe(),a=L.useRef(null),l=r?(a.current||(a.current=new window.Image),a.current):null,[h,i]=L.useState(()=>LY(l,e));return Sl(()=>{i(LY(l,e))},[l,e]),Sl(()=>{const y=C=>()=>{i(C)};if(!l)return;const x=y("loaded"),w=y("error");return l.addEventListener("load",x),l.addEventListener("error",w),t&&(l.referrerPolicy=t),typeof n=="string"&&(l.crossOrigin=n),()=>{l.removeEventListener("load",x),l.removeEventListener("error",w)}},[l,n,t]),h}var Dfe=kfe,Rfe=Nfe,jfe=Lfe;const gO=L.forwardRef(({className:e,...t},n)=>v.jsx(Dfe,{ref:n,className:Xn("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));gO.displayName=Dfe.displayName;const AXe=L.forwardRef(({className:e,...t},n)=>v.jsx(Rfe,{ref:n,className:Xn("aspect-square h-full w-full",e),...t}));AXe.displayName=Rfe.displayName;const yO=L.forwardRef(({className:e,...t},n)=>v.jsx(jfe,{ref:n,className:Xn("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));yO.displayName=jfe.displayName;function TXe(){var B,F;const[e,t]=L.useState("savings"),[n,r]=L.useState("30"),[a,l]=L.useState(""),[h,i]=L.useState(!1),{data:y,isLoading:x,error:w}=rAe(n,e),{data:C,isLoading:P}=iAe(),E=$=>{switch($){case 0:return v.jsx(X_e,{className:"w-5 h-5 text-yellow-500"});case 1:return v.jsx(rxe,{className:"w-5 h-5 text-gray-400"});case 2:return v.jsx($_e,{className:"w-5 h-5 text-amber-600"});default:return v.jsx("span",{className:"w-5 h-5 flex items-center justify-center text-sm font-bold text-muted-foreground",children:$+1})}},j=$=>{switch($){case 0:return"bg-gradient-to-r from-yellow-400 to-yellow-600 text-white";case 1:return"bg-gradient-to-r from-gray-300 to-gray-500 text-white";case 2:return"bg-gradient-to-r from-amber-400 to-amber-600 text-white";default:return"bg-muted"}},D=()=>{if(!a.trim()){Gn.error("Please enter an email address");return}Gn.success("Friend request sent successfully!"),l(""),i(!1)};return v.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[v.jsx(HE,{className:"w-8 h-8 text-primary"}),"Leaderboard"]}),v.jsx("p",{className:"text-muted-foreground mt-2",children:"Compete with friends and see who saves the most money"})]}),v.jsxs(Gg,{open:h,onOpenChange:i,children:[v.jsx(iA,{asChild:!0,children:v.jsxs($n,{className:"flex items-center gap-2",children:[v.jsx(fxe,{className:"w-4 h-4"}),"Invite Friends"]})}),v.jsxs(km,{children:[v.jsxs(Im,{children:[v.jsx(Nm,{children:"Invite a Friend"}),v.jsx(kde,{children:"Send a friend request to compete on the leaderboard"})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx(Qi,{htmlFor:"email",children:"Email Address"}),v.jsx(ss,{id:"email",type:"email",placeholder:"friend@example.com",value:a,onChange:$=>l($.target.value)})]}),v.jsxs("div",{className:"flex gap-2 justify-end",children:[v.jsx($n,{variant:"outline",onClick:()=>i(!1),children:"Cancel"}),v.jsx($n,{onClick:D,children:"Send Invite"})]})]})]})]})]}),v.jsxs(eI,{defaultValue:"leaderboard",className:"space-y-6",children:[v.jsxs(D5,{className:"grid w-full grid-cols-3",children:[v.jsx(ed,{value:"leaderboard",children:"Leaderboard"}),v.jsx(ed,{value:"friends",children:"Friends (0)"}),v.jsx(ed,{value:"requests",children:"Requests (0)"})]}),v.jsxs(td,{value:"leaderboard",className:"space-y-6",children:[v.jsxs("div",{className:"flex gap-4 items-center",children:[v.jsxs(Ep,{value:e,onValueChange:$=>t($),children:[v.jsx(Af,{className:"w-48",children:v.jsx(Pp,{})}),v.jsxs(Tf,{children:[v.jsx(So,{value:"savings",children:"Savings Leaderboard"}),v.jsx(So,{value:"spending",children:"Spending Leaderboard"})]})]}),v.jsxs(Ep,{value:n,onValueChange:r,children:[v.jsx(Af,{className:"w-32",children:v.jsx(Pp,{})}),v.jsxs(Tf,{children:[v.jsx(So,{value:"7",children:"7 days"}),v.jsx(So,{value:"30",children:"30 days"}),v.jsx(So,{value:"90",children:"90 days"})]})]})]}),v.jsxs(xr,{children:[v.jsxs(ui,{children:[v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(HE,{className:"w-5 h-5"}),e==="savings"?"Savings Leaderboard":"Spending Leaderboard"]}),v.jsx(cy,{children:e==="savings"?"Ranked by savings percentage (privacy-focused)":"Ranked by lowest spending (most frugal)"})]}),v.jsx(br,{children:v.jsx("div",{className:"space-y-4",children:x?v.jsx("div",{className:"space-y-4",children:[...Array(5)].map(($,H)=>v.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg",children:[v.jsx(Jl,{className:"w-8 h-8 rounded-full"}),v.jsxs("div",{className:"flex-1",children:[v.jsx(Jl,{className:"h-4 w-32 mb-2"}),v.jsx(Jl,{className:"h-3 w-24"})]}),v.jsx(Jl,{className:"h-6 w-16"})]},H))}):w?v.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[v.jsx(HE,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),v.jsx("p",{children:"Failed to load leaderboard data"}),v.jsx("p",{className:"text-sm",children:"Please try again later"})]}):((B=y==null?void 0:y.leaderboard)==null?void 0:B.length)===0?v.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[v.jsx(WE,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),v.jsx("p",{children:"No leaderboard data available"}),v.jsx("p",{className:"text-sm",children:"Check back later for updates"})]}):(F=y==null?void 0:y.leaderboard)==null?void 0:F.map(($,H)=>{var J;return v.jsxs("div",{className:`flex items-center gap-4 p-4 border rounded-lg transition-all hover:shadow-md ${H<3?j(H):"hover:bg-muted/50"}`,children:[v.jsx("div",{className:"flex items-center justify-center w-8 h-8",children:E(H)}),v.jsx(gO,{className:"w-10 h-10",children:v.jsx(yO,{className:"bg-primary/10 text-primary font-semibold",children:$.name.split(" ").map(ee=>ee[0]).join("").toUpperCase()})}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsx("div",{className:"font-semibold truncate",children:$.name}),v.jsx("div",{className:"text-sm opacity-75 truncate",children:$.email})]}),v.jsx("div",{className:"text-right",children:e==="savings"?v.jsxs("div",{children:[v.jsxs("div",{className:"font-bold text-lg",children:[$.savingsPercentage.toFixed(1),"%"]}),v.jsx("div",{className:"text-sm opacity-75",children:"of budget saved"})]}):v.jsxs("div",{children:[v.jsxs("div",{className:"font-bold text-lg",children:["$",$.spent.toLocaleString()]}),v.jsxs("div",{className:"text-sm opacity-75",children:["$",(J=$.remaining)==null?void 0:J.toLocaleString()," remaining"]})]})}),H<3&&v.jsxs(Is,{variant:"secondary",className:"ml-2",children:["#",H+1]})]},$.userId)})})})]})]}),v.jsx(td,{value:"friends",className:"space-y-6",children:v.jsxs(xr,{children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(WE,{className:"w-5 h-5"}),"Your Friends (",(C==null?void 0:C.length)||0,")"]})}),v.jsx(br,{children:P?v.jsx("div",{className:"space-y-4",children:[...Array(3)].map(($,H)=>v.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg",children:[v.jsx(Jl,{className:"w-10 h-10 rounded-full"}),v.jsxs("div",{className:"flex-1",children:[v.jsx(Jl,{className:"h-4 w-32 mb-2"}),v.jsx(Jl,{className:"h-3 w-24"})]})]},H))}):(C==null?void 0:C.length)===0?v.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[v.jsx(WE,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),v.jsx("p",{children:"No friends yet."}),v.jsx("p",{className:"text-sm",children:"Send friend requests to start competing!"})]}):v.jsx("div",{className:"space-y-4",children:C==null?void 0:C.map($=>v.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg hover:bg-muted/50",children:[v.jsx(gO,{className:"w-10 h-10",children:v.jsx(yO,{children:$.name.split(" ").map(H=>H[0]).join("")})}),v.jsxs("div",{className:"flex-1",children:[v.jsx("div",{className:"font-medium",children:$.name}),v.jsx("div",{className:"text-sm text-muted-foreground",children:$.email})]}),v.jsx("div",{className:"text-sm text-muted-foreground",children:"Active member"})]},$.id))})})]})}),v.jsx(td,{value:"requests",className:"space-y-6",children:v.jsxs(xr,{children:[v.jsx(ui,{children:v.jsxs(di,{className:"flex items-center gap-2",children:[v.jsx(k9,{className:"w-5 h-5"}),"Friend Requests (0)"]})}),v.jsx(br,{children:v.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[v.jsx(k9,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),v.jsx("p",{children:"No pending friend requests."})]})})]})})]})]})}const CXe=()=>{const e=Ix();return L.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),v.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-100",children:v.jsxs("div",{className:"text-center",children:[v.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),v.jsx("p",{className:"mb-4 text-xl text-gray-600",children:"Oops! Page not found"}),v.jsx("a",{href:"/",className:"text-blue-500 underline hover:text-blue-700",children:"Return to Home"})]})})},EXe=new Lwe({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}}),PXe=()=>{const e=()=>{const{isAuthenticated:t,isLoading:n,user:r}=W3();return console.log("AppRoutes render:",{isAuthenticated:t,isLoading:n,user:r}),n?v.jsx("div",{className:"min-h-screen flex items-center justify-center",children:v.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})}):t?v.jsx(Z2e,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:v.jsxs(B2e,{children:[v.jsxs(op,{path:"/",element:v.jsx(gMe,{}),children:[v.jsx(op,{index:!0,element:v.jsx(nGe,{})}),v.jsx(op,{path:"map",element:v.jsx(jGe,{})}),v.jsx(op,{path:"caps",element:v.jsx(eHe,{})}),v.jsx(op,{path:"transactions",element:v.jsx(uYe,{})}),v.jsx(op,{path:"analytics",element:v.jsx(FYe,{})}),v.jsx(op,{path:"leaderboard",element:v.jsx(TXe,{})}),v.jsx(op,{path:"settings",element:v.jsx(aXe,{})}),v.jsx(op,{path:"bodyguard",element:v.jsx(vXe,{})})]}),v.jsx(op,{path:"*",element:v.jsx(CXe,{})})]})}):v.jsx(dke,{})};return v.jsx(Fwe,{client:EXe,children:v.jsx(aAe,{children:v.jsx(sAe,{children:v.jsx(uAe,{children:v.jsx(cAe,{children:v.jsx(hAe,{children:v.jsxs(kee,{children:[v.jsx(Jxe,{}),v.jsx(I1e,{}),v.jsx(GSe,{position:"top-right",toastOptions:{duration:4e3,style:{background:"hsl(var(--card))",color:"hsl(var(--card-foreground))",border:"1px solid hsl(var(--border))",borderRadius:"0.5rem",padding:"0.75rem 1rem",margin:"0.5rem",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)"}}}),v.jsx(WEe,{}),v.jsx(e,{})]})})})})})})})};rQ(document.getElementById("root")).render(v.jsx(PXe,{}));export{Da as _,vye as c,Ip as g};
